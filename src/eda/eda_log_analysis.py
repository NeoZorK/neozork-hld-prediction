# src/eda/eda_log_analysis.py

from pathlib import Path

# This script analyzes the EDA log file generated by the EDA process.
def analyze_log(log_file: str) -> dict:
    """
    Analyze the EDA log file and return summary statistics.
    """
    stats = {
        "total_files": 0,
        "files_with_missing": 0,
        "files_with_duplicates": 0,
        "files_with_nan_columns": 0,
        "error_files": 0,
    }
    if not Path(log_file).exists():
        return stats

    with open(log_file, "r", encoding="utf-8") as f:
        for line in f:
            if "CHECKING:" in line:
                stats["total_files"] += 1
            if "Missing values:" in line and "Series([], dtype:" not in line:
                stats["files_with_missing"] += 1
            if "Number of duplicate rows:" in line and not line.rstrip().endswith("0"):
                stats["files_with_duplicates"] += 1
            if "Columns with NaN values:" in line and not line.rstrip().endswith("[]"):
                stats["files_with_nan_columns"] += 1
            if "ERROR processing" in line:
                stats["error_files"] += 1
    return stats