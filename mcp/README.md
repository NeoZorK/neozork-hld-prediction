# MCP Server для GitHub Copilot

Локальный MCP (Model Completion Protocol) сервер для расширения возможностей GitHub Copilot в PyCharm CE.

## Особенности

- Работает через стандартный ввод/вывод (STDIO)
- Обрабатывает запросы от GitHub Copilot MCP клиента
- Имеет доступ к локальному проекту
- Ведет детальное логгирование сессий
- Работает непрерывно, не завершая свою работу

## Установка

1. Убедитесь, что у вас установлен Python 3.8 или выше
2. Клонируйте репозиторий или убедитесь, что директория `mcp/` существует в вашем проекте
3. Создайте директорию `mcp/logs` (если она еще не существует):
   ```
   mkdir -p mcp/logs
   ```
4. Установите права на выполнение:
   ```
   chmod +x mcp/main.py
   ```

## Настройка PyCharm CE для работы с GitHub Copilot MCP

1. Откройте PyCharm CE
2. Установите плагин GitHub Copilot из маркетплейса JetBrains
3. Перейдите в Settings/Preferences -> Tools -> GitHub Copilot
4. В разделе "Advanced" найдите настройку "MCP Configuration"
5. Добавьте путь к файлу `mcp/mcp.json`, который должен содержать следующее:

```json
{
  "command": "python",
  "args": ["/полный/путь/к/mcp/main.py"],
  "stdio": true
}
```

Замените `/полный/путь/к/mcp/main.py` на абсолютный путь к файлу main.py в директории mcp.

## Запуск

При правильной настройке PyCharm CE будет автоматически запускать MCP сервер при использовании GitHub Copilot.

Для ручного запуска:

```
python mcp/main.py
```

## Структура проекта

После рефакторинга код MCP сервера разделен на логические модули:

- `mcp/__init__.py` - содержит информацию о пакете и его версию
- `mcp/logger.py` - настройка системы логирования
- `mcp/code_indexer.py` - класс для индексации и поиска кода в проекте
- `mcp/server.py` - основной класс MCP-сервера с базовой функциональностью
- `mcp/handlers.py` - обработчики различных типов запросов к серверу
- `mcp/utils.py` - вспомогательные функции для работы с автодополнением
- `mcp/main.py` - точка входа для запуска сервера
- `mcp/mcp.json` - файл конфигурации для интеграции с PyCharm

## Логгирование

Все логи сохраняются в директории `mcp/logs/` в файле `mcp_server.log`. Каждая сессия четко разделена в логе.

## Устранение неполадок

### Проблема: MCP сервер не запускается

- Проверьте, что файл `mcp/mcp.json` содержит правильный путь к серверу
- Убедитесь, что у файла `mcp/main.py` есть права на выполнение
- Проверьте, что директория `mcp/logs` существует и доступна для записи

### Проблема: GitHub Copilot не использует локальный MCP сервер

- Перезапустите PyCharm CE
- Проверьте логи на наличие ошибок подключения
- Убедитесь, что плагин GitHub Copilot активирован

## Дополнительная информация

- MCP сервер обрабатывает запросы через STDIO, что является рекомендуемым способом для плагинов IDE
- Сервер остается активным до получения команды завершения или закрытия IDE
- Реализация включает обработку основных команд протокола MCP
