# Рабочий процесс анализа данных: Генерация признаков, корреляционный анализ и анализ важности признаков

## Обзор

Этот документ описывает рекомендуемую последовательность проведения комплексного анализа данных в проекте Neozork HLD Prediction, с фокусом на генерацию признаков, корреляционный анализ и анализ важности признаков.

## Рекомендуемая последовательность анализа

### 1. Генерация признаков (Первый этап)

**Почему первым:**
- Создает основу для всех последующих анализов
- Генерирует "сырье" из исходных данных
- Без признаков невозможно провести корреляционный анализ или анализ важности

**Что включает:**
- Технические индикаторы (SMA, EMA, RSI, MACD, Bollinger Bands)
- Статистические признаки (волатильность, скос, эксцесс)
- Моментные признаки (ROC, Momentum)
- Ценовые признаки (доходность, изменения цен)
- Объемные признаки

**Реализация:**
```python
# Используя существующий FeatureEngineer
features = feature_engineer.generate_features(
    market_data, 
    feature_types=['technical', 'statistical', 'momentum', 'price', 'volume']
)
```

### 2. Корреляционный анализ (Второй этап)

**Почему после генерации признаков:**
- Анализирует взаимосвязи между всеми сгенерированными признаками
- Выявляет мультиколлинеарность (высокую корреляцию между признаками)
- Определяет, какие признаки дублируют друг друга

**Что включает:**
- Матрица корреляций Пирсона
- Анализ мультиколлинеарности
- Выявление сильно коррелированных пар признаков
- Рекомендации по удалению избыточных признаков

**Реализация:**
```python
# Используя существующие инструменты корреляционного анализа
correlation_analysis = correlation_analyzer.analyze_correlations(
    features, 
    methods=['pearson', 'spearman']
)
```

### 3. Анализ важности признаков (Третий этап)

**Почему в конце:**
- Оценивает вклад каждого признака в целевую переменную
- Выявляет наиболее информативные признаки
- Выбирает оптимальный набор признаков для моделирования

**Что включает:**
- Важность признаков Random Forest
- Важность признаков XGBoost
- Анализ взаимной информации
- Статистические тесты значимости
- Отбор признаков

**Реализация:**
```python
# Используя существующий FeatureSelector
importance_analysis = feature_importance_analyzer.analyze_importance(
    features, 
    target=target_variable,
    methods=['random_forest', 'xgboost', 'mutual_info']
)
```

## Полный рабочий процесс

```python
# 1. Генерация признаков
features = feature_engineer.generate_features(
    market_data, 
    feature_types=['technical', 'statistical', 'momentum', 'price', 'volume']
)

# 2. Анализ корреляций
correlation_analysis = correlation_analyzer.analyze_correlations(
    features, 
    methods=['pearson', 'spearman']
)

# 3. Анализ важности признаков
importance_analysis = feature_importance_analyzer.analyze_importance(
    features, 
    target=target_variable,
    methods=['random_forest', 'xgboost', 'mutual_info']
)
```

## Интеграция с существующими инструментами

### Доступные компоненты

1. **Генерация признаков:**
   - Класс `FeatureEngineer` в `src/pocket_hedge_fund/advanced_analytics/core/feature_engineer.py`
   - `RealMLModels.create_features()` в `src/ml/real_ml_models.py`

2. **Корреляционный анализ:**
   - `MultiMarketManager.get_cross_market_analysis()` в `src/global/multi_market_integration.py`
   - `QuantitativeResearcher.analyze_correlations()` в `src/research/quantitative_research.py`

3. **Анализ важности признаков:**
   - Класс `FeatureSelector` в `src/pocket_hedge_fund/advanced_analytics/ml/feature_selector.py`
   - `PricePredictor._get_feature_importance()` в `src/pocket_hedge_fund/ml/price_predictor.py`

### Точки интеграции

- **Статистический анализ:** `stat_analysis.py`
- **Анализ временных рядов:** `time_analysis.py`
- **Финансовый анализ:** `finance_analysis.py`

## Структура хранения данных

```
data/
├── fixed/
│   ├── features/           # Сгенерированные признаки
│   ├── correlations/       # Матрицы корреляций
│   └── feature_importance/ # Результаты анализа важности
├── analysis/
│   ├── feature_generation/ # Отчеты по генерации признаков
│   ├── correlation_analysis/ # Отчеты по корреляционному анализу
│   └── importance_analysis/ # Отчеты по анализу важности
```

## Лучшие практики

1. **Начните с чистых данных:**
   - Используйте данные из директории `data/fixed/`
   - Обеспечьте качество данных перед генерацией признаков

2. **Итеративный процесс:**
   - Генерация признаков → Анализ корреляций → Удаление избыточных признаков
   - Повторяйте до достижения оптимального набора признаков

3. **Документирование:**
   - Сохраняйте все промежуточные результаты
   - Ведите метаданные для воспроизводимости
   - Документируйте решения по инженерии признаков

4. **Валидация:**
   - Кросс-валидируйте результаты анализа важности признаков
   - Тестируйте стабильность корреляций во времени
   - Мониторьте производительность признаков в моделях

## Ожидаемые результаты

1. **Генерация признаков:**
   - Комплексный набор технических, статистических и моментных признаков
   - Правильно отформатированные и валидированные данные признаков

2. **Корреляционный анализ:**
   - Выявление избыточных признаков
   - Рекомендации по сокращению признаков
   - Понимание взаимосвязей между признаками

3. **Анализ важности признаков:**
   - Ранжированный список наиболее важных признаков
   - Оптимальное подмножество признаков для моделирования
   - Рекомендации по отбору признаков

## Следующие шаги

1. Реализовать рабочий процесс, используя существующие компоненты проекта
2. Создать автоматизированные пайплайны для последовательности анализа
3. Разработать инструменты визуализации для каждого этапа анализа
4. Интегрировать с существующими инструментами анализа (`stat_analysis.py`, `time_analysis.py`, `finance_analysis.py`)

## Ссылки

- [Документация по инструментам анализа](analysis-tools.md)
- [Руководство по инженерии признаков](feature-engineering.md)
- [Руководство по статистическому анализу](statistical-analysis.md)
- [Руководство по анализу временных рядов](time-series-analysis.md)
