# Seaborn SuperTrend Enhancement

## Обзор

Режим `-d sb` (seaborn) для индикатора SuperTrend был значительно улучшен, чтобы соответствовать современному и красивому стилю режима `-d mpl` (matplotlib). Теперь оба режима предоставляют одинаково высокое качество визуализации с современными цветовыми схемами и интерактивными элементами.

## Улучшения

### 1. **Современная цветовая схема**

Реализована единая цветовая палитра для всех режимов отображения:

- **Зеленый (Uptrend)**: `#00C851` - современный зеленый для восходящих трендов
- **Красный (Downtrend)**: `#FF4444` - современный красный для нисходящих трендов  
- **Золотой (Signal Change)**: `#FFC107` - золотистый для точек смены сигналов
- **Синий (Support)**: `#007BFF` - современный синий для линий поддержки
- **Красный (Resistance)**: `#DC3545` - современный красный для линий сопротивления

### 2. **Улучшенная сегментация линий**

Добавлена интеллектуальная сегментация SuperTrend линии:

- **Автоматическое определение точек смены сигналов**
- **Цветовое кодирование сегментов** в зависимости от направления тренда
- **Выделение точек смены сигналов** золотистым цветом
- **Плавные переходы** между сегментами

### 3. **Современные визуальные эффекты**

- **Эффект свечения** для основных линий
- **Pulse эффект** для сигналов покупки/продажи
- **Фоновые зоны трендов** для лучшего визуального контекста
- **Улучшенная прозрачность** и альфа-каналы

### 4. **Улучшенные сигналы**

- **Увеличенный размер маркеров** (120px вместо 100px)
- **Белые границы** для лучшей видимости
- **Двойные маркеры** с эффектом пульсации
- **Улучшенное позиционирование** относительно цены

### 5. **Современный стиль свечей**

- **Обновленные цвета** свечей с современной палитрой
- **Улучшенная прозрачность** и толщина линий
- **Более четкие границы** между телами свечей

### 6. **Улучшенные настройки стиля**

```python
# Современный seaborn стиль
sns.set_style("whitegrid", {
    'grid.linestyle': '--',
    'grid.alpha': 0.3,
    'axes.facecolor': '#f8f9fa',
    'figure.facecolor': 'white',
    'axes.spines.top': False,
    'axes.spines.right': False
})

# Современные шрифты
plt.rcParams['font.family'] = 'sans-serif'
plt.rcParams['font.sans-serif'] = ['Arial', 'DejaVu Sans', 'Liberation Sans']
```

## Использование

### Команда для тестирования

```bash
# Тест улучшенного режима seaborn
uv run run_analysis.py show csv gbp -d sb --rule supertrend:10,3

# Сравнение с режимом mpl
uv run run_analysis.py show csv gbp -d mpl --rule supertrend:10,3
```

### Другие индикаторы

Улучшения также применены к другим индикаторам в режиме seaborn:

```bash
# RSI с современным стилем
uv run run_analysis.py show csv gbp -d sb --rule rsi:14,30,70,close

# MACD с улучшенной цветовой схемой
uv run run_analysis.py show csv gbp -d sb --rule macd:12,26,9,close

# Bollinger Bands с современными цветами
uv run run_analysis.py show csv gbp -d sb --rule bb:20,2,close
```

## Технические детали

### Обработка данных SuperTrend

```python
# Определение направления тренда
trend = np.where(price_series > supertrend_values, 1, -1)

# Обнаружение точек смены сигналов
buy_signals = (trend == 1) & (trend.shift(1) == -1)
sell_signals = (trend == -1) & (trend.shift(1) == 1)
signal_changes = buy_signals | sell_signals

# Создание цветового массива
color_arr = np.where(trend == 1, uptrend_color, downtrend_color)
```

### Сегментация линий

```python
# Интеллектуальная сегментация
segments = []
for i in range(1, len(display_df.index)):
    current_color = color_arr[i]
    
    if signal_changes.iloc[i]:
        # Добавление точки смены сигнала
        segments.append(([display_df.index[i-1], display_df.index[i]], 
                       [supertrend_values.iloc[i-1], supertrend_values.iloc[i]], 
                       signal_change_color))
    elif current_color != last_color:
        # Обычная смена тренда
        segments.append((seg_x.copy(), seg_y.copy(), last_color))
```

## Сравнение режимов

| Аспект | `-d sb` (Seaborn) | `-d mpl` (Matplotlib) |
|--------|-------------------|----------------------|
| **Цветовая схема** | ✅ Современная | ✅ Современная |
| **Сегментация** | ✅ Интеллектуальная | ✅ Интеллектуальная |
| **Сигналы** | ✅ Улучшенные | ✅ Улучшенные |
| **Эффекты** | ✅ Pulse + Glow | ✅ Pulse + Glow |
| **Фоновые зоны** | ✅ Трендовые зоны | ✅ Трендовые зоны |
| **Производительность** | ⚡ Быстрая | ⚡ Быстрая |

## Заключение

Режим `-d sb` теперь предоставляет такой же высокий уровень визуализации, как и режим `-d mpl`, с современными цветовыми схемами, интерактивными эффектами и улучшенной читаемостью. Оба режима теперь являются равнозначными по качеству и могут использоваться в зависимости от предпочтений пользователя.

### Рекомендации

- **Для презентаций**: Используйте `-d sb` для более научного стиля
- **Для технического анализа**: Используйте `-d mpl` для классического стиля
- **Для отчетов**: Оба режима подходят одинаково хорошо 