# 18.4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏

**–¢–µ–æ—Ä–∏—è:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –≤—Å–µ—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.

**–ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ –≤–∞–∂–Ω—ã:**

- **–ö–æ–Ω—Ç—Ä–æ–ª—å:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
- **–ê–Ω–∞–ª–∏–∑:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏

## üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–¢–µ–æ—Ä–∏—è:** –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

1. **–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (–¥–Ω–µ–≤–Ω–∞—è, –Ω–µ–¥–µ–ª—å–Ω–∞—è, –º–µ—Å—è—á–Ω–∞—è, –≥–æ–¥–æ–≤–∞—è)
2. **–†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏** - –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–æ–≤ —á–µ—Ä–µ–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ—Å–∞–¥–∫—É, Value at Risk
3. **–¢–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫, —Ñ–∞–∫—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏
4. **–ú–µ—Ç—Ä–∏–∫–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏** - –æ—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
5. **–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é 100% –º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã:**
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞**: `Sharpe = (Œº - rf) / œÉ`, –≥–¥–µ Œº - —Å—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, rf - –±–µ–∑—Ä–∏—Å–∫–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞, œÉ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞**: `MaxDD = max(Peak - Trough)`, –≥–¥–µ Peak - –ø–∏–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, Trough - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- **Value at Risk**: `VaR = Œº - zŒ± * œÉ`, –≥–¥–µ zŒ± - –∫–≤–∞–Ω—Ç–∏–ª—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

**–ü–æ—á–µ–º—É —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞:**
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–ê–Ω–∞–ª–∏–∑:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤
- **–í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –¥–æ –∏—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–æ–≤:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∏—Å–∫–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä—ã–Ω–æ—á–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–∞—Å—Ç—É—â–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Ä–∞—Å—á–µ—Ç–µ –º–µ—Ç—Ä–∏–∫
5. **–¢–æ—á–Ω–æ—Å—Ç—å** - –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
- –°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ä—ã–Ω–æ—á–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç –≤—ã—Å–æ–∫–æ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∞–ª–µ—Ä—Ç–æ–≤
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Ç—Ä–∏–∫

```python
# src/monitoring/performance.py
"""
NeoZorK 100% Performance Monitoring System

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 
100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫, 
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- PerformanceMonitor: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏: –¥–Ω–µ–≤–Ω–∞—è, –Ω–µ–¥–µ–ª—å–Ω–∞—è, –º–µ—Å—è—á–Ω–∞—è, –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞, VaR
- –¢–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫, —Ñ–∞–∫—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏
- –ú–µ—Ç—Ä–∏–∫–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏: –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    config = {
        'monitoring': {
            'monthly_target': 1.0,
            'daily_target': 0.033,
            'risk_limits': {
                'max_drawdown': 0.2,
                'min_sharpe': 1.0
            }
        }
    }
    
    monitor = PerformanceMonitor(config)
    metrics = monitor.calculate_metrics(positions, current_balance, initial_balance)
    alerts = monitor.check_alerts(metrics)
    report = monitor.generate_report(metrics)
"""

import pandas as pd
import numpy as np
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Tuple, Union
import logging
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import plotly.express as px
import json
from pathlib import Path
import warnings
warnings.filterwarnings('ignore')

class PerformanceMonitor:
    """
    –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    
    –≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç
    –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
    –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
    
    Attributes:
        config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        logger (logging.Logger): –õ–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–±—ã—Ç–∏–π
        metrics_history (List[Dict]): –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
        alerts (List[Dict]): –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤
        monthly_target (float): –¶–µ–ª–µ–≤–∞—è –º–µ—Å—è—á–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (100%)
        daily_target (float): –¶–µ–ª–µ–≤–∞—è –¥–Ω–µ–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (~3.3%)
        
    Methods:
        calculate_metrics: –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        check_alerts: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤
        generate_report: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        create_dashboard: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞
    """
    
    def __init__(self, config: Dict):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        
        Args:
            config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—é—â–∞—è:
                - monitoring.monthly_target: –¶–µ–ª–µ–≤–∞—è –º–µ—Å—è—á–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - monitoring.daily_target: –¶–µ–ª–µ–≤–∞—è –¥–Ω–µ–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - monitoring.risk_limits: –õ–∏–º–∏—Ç—ã —Ä–∏—Å–∫–æ–≤
                - monitoring.alert_thresholds: –ü–æ—Ä–æ–≥–∏ –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤
        """
        self.config = config
        self.logger = logging.getLogger(__name__)
        self.metrics_history = []
        self.alerts = []
        
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        monitoring_config = config.get('monitoring', {})
        self.monthly_target = monitoring_config.get('monthly_target', 1.0)  # 100% –≤ –º–µ—Å—è—Ü
        self.daily_target = monitoring_config.get('daily_target', 0.033)  # ~3.3% –≤ –¥–µ–Ω—å
        
        # –õ–∏–º–∏—Ç—ã —Ä–∏—Å–∫–æ–≤
        risk_limits = monitoring_config.get('risk_limits', {})
        self.max_drawdown_limit = risk_limits.get('max_drawdown', 0.2)  # 20%
        self.min_sharpe_limit = risk_limits.get('min_sharpe', 1.0)
        self.min_win_rate_limit = risk_limits.get('min_win_rate', 0.5)  # 50%
        
        # –ü–æ—Ä–æ–≥–∏ –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤
        alert_thresholds = monitoring_config.get('alert_thresholds', {})
        self.performance_warning_threshold = alert_thresholds.get('performance_warning', 0.4)
        self.performance_critical_threshold = alert_thresholds.get('performance_critical', 0.2)
        
        self.logger.info(f"PerformanceMonitor initialized with monthly target: {self.monthly_target:.1%}")
        
    def calculate_metrics(self, positions: List[Dict], current_balance: float, initial_balance: float) -> Dict:
        """
        –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
        
        –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç
        –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ú–µ—Ç–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
        –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
        
        1. –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ –±–∞–ª–∞–Ω—Å
        2. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º
        3. –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏ - –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
        4. –¢–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        5. –ú–µ—Ç—Ä–∏–∫–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏ - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
        6. –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –ø—Ä–æ–≥—Ä–µ—Å—Å –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é 100% –º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏
        
        Args:
            positions (List[Dict]): –°–ø–∏—Å–æ–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å –ø–æ–ª—è–º–∏:
                - timestamp: –í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
                - pnl: –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫ –ø–æ –ø–æ–∑–∏—Ü–∏–∏
                - type: –¢–∏–ø –ø–æ–∑–∏—Ü–∏–∏ (buy/sell)
                - amount: –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
                - price: –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è
            current_balance (float): –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞
            initial_balance (float): –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞
            
        Returns:
            Dict: –°–ª–æ–≤–∞—Ä—å —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏, –≤–∫–ª—é—á–∞—é—â–∏–π:
                - total_return: –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - daily_return: –î–Ω–µ–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - weekly_return: –ù–µ–¥–µ–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - monthly_return: –ú–µ—Å—è—á–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - annualized_return: –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
                - sharpe_ratio: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
                - max_drawdown: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
                - var_95: Value at Risk 95%
                - var_99: Value at Risk 99%
                - win_rate: –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
                - profit_factor: –§–∞–∫—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏
                - avg_win: –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å
                - avg_loss: –°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫
                - consistency: –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
                - stability: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                - adaptability: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
                - target_achievement: –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π
                - performance_score: –û–±—â–∏–π –±–∞–ª–ª –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                - timestamp: –í—Ä–µ–º—è —Ä–∞—Å—á–µ—Ç–∞
                
        Raises:
            ValueError: –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
            Exception: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö
            
        Example:
            >>> positions = [
            ...     {'timestamp': datetime.now() - timedelta(days=1), 'pnl': 100, 'type': 'buy'},
            ...     {'timestamp': datetime.now() - timedelta(hours=12), 'pnl': -50, 'type': 'sell'}
            ... ]
            >>> metrics = monitor.calculate_metrics(positions, 10000, 9500)
            >>> print(f"Total return: {metrics['total_return']:.2%}")
            Total return: 5.26%
        """
        try:
            # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            if not isinstance(positions, list):
                raise ValueError("Positions must be a list")
            if not isinstance(current_balance, (int, float)) or current_balance < 0:
                raise ValueError("Current balance must be a non-negative number")
            if not isinstance(initial_balance, (int, float)) or initial_balance <= 0:
                raise ValueError("Initial balance must be a positive number")
            
            self.logger.info(f"Calculating metrics for {len(positions)} positions")
            
            metrics = {}
            
            # –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –æ—Å–Ω–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤
            metrics['total_return'] = (current_balance - initial_balance) / initial_balance
            metrics['current_balance'] = current_balance
            metrics['initial_balance'] = initial_balance
            metrics['profit_loss'] = current_balance - initial_balance
            
            # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
            # –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏
            metrics['daily_return'] = self._calculate_daily_return(positions)
            metrics['weekly_return'] = self._calculate_weekly_return(positions)
            metrics['monthly_return'] = self._calculate_monthly_return(positions)
            metrics['annualized_return'] = self._calculate_annualized_return(positions)
            
            # –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏ - –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—å
            # –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
            metrics['sharpe_ratio'] = self._calculate_sharpe_ratio(positions)
            metrics['max_drawdown'] = self._calculate_max_drawdown(positions)
            metrics['var_95'] = self._calculate_var(positions, 0.95)
            metrics['var_99'] = self._calculate_var(positions, 0.99)
            metrics['volatility'] = self._calculate_volatility(positions)
            
            # –¢–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
            # –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π
            metrics['win_rate'] = self._calculate_win_rate(positions)
            metrics['profit_factor'] = self._calculate_profit_factor(positions)
            metrics['avg_win'] = self._calculate_avg_win(positions)
            metrics['avg_loss'] = self._calculate_avg_loss(positions)
            metrics['total_trades'] = len(positions)
            metrics['winning_trades'] = len([p for p in positions if p.get('pnl', 0) > 0])
            metrics['losing_trades'] = len([p for p in positions if p.get('pnl', 0) < 0])
            
            # –ú–µ—Ç—Ä–∏–∫–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏ - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
            # –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
            metrics['consistency'] = self._calculate_consistency(positions)
            metrics['stability'] = self._calculate_stability(positions)
            metrics['adaptability'] = self._calculate_adaptability(positions)
            metrics['recovery_factor'] = self._calculate_recovery_factor(positions)
            
            # –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ - –ø—Ä–æ–≥—Ä–µ—Å—Å –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é 100% –º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏
            # –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ —Å–∏—Å—Ç–µ–º–∞ –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é —Ü–µ–ª–∏
            metrics['target_achievement'] = self._calculate_target_achievement(metrics)
            metrics['performance_score'] = self._calculate_performance_score(metrics)
            metrics['monthly_progress'] = self._calculate_monthly_progress(positions)
            metrics['daily_progress'] = self._calculate_daily_progress(positions)
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
            metrics['calmar_ratio'] = self._calculate_calmar_ratio(metrics)
            metrics['sortino_ratio'] = self._calculate_sortino_ratio(positions)
            metrics['treynor_ratio'] = self._calculate_treynor_ratio(positions)
            
            # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
            metrics['timestamp'] = datetime.now()
            metrics['calculation_time'] = datetime.now()
            metrics['data_quality_score'] = self._calculate_data_quality_score(positions)
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤
            self.metrics_history.append(metrics.copy())
            
            # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
            if len(self.metrics_history) > 1000:
                self.metrics_history = self.metrics_history[-1000:]
            
            self.logger.info(f"Metrics calculated successfully. Performance score: {metrics['performance_score']:.2f}")
            return metrics
            
        except ValueError as ve:
            self.logger.error(f"Validation error in calculate_metrics: {ve}")
            raise
        except Exception as e:
            self.logger.error(f"Error calculating metrics: {e}")
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
            return {
                'total_return': (current_balance - initial_balance) / initial_balance if initial_balance > 0 else 0,
                'current_balance': current_balance,
                'initial_balance': initial_balance,
                'timestamp': datetime.now(),
                'error': str(e)
            }
    
    def _calculate_daily_return(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å
            yesterday = datetime.now() - timedelta(days=1)
            daily_positions = [p for p in positions if p['timestamp'] >= yesterday]
            
            if not daily_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            total_pnl = sum(p['pnl'] for p in daily_positions if 'pnl' in p)
            return total_pnl
            
        except Exception as e:
            self.logger.error(f"Error calculating daily return: {e}")
            return 0.0
    
    def _calculate_weekly_return(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –Ω–µ–¥–µ–ª—å–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é
            week_ago = datetime.now() - timedelta(weeks=1)
            weekly_positions = [p for p in positions if p['timestamp'] >= week_ago]
            
            if not weekly_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            total_pnl = sum(p['pnl'] for p in weekly_positions if 'pnl' in p)
            return total_pnl
            
        except Exception as e:
            self.logger.error(f"Error calculating weekly return: {e}")
            return 0.0
    
    def _calculate_monthly_return(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –º–µ—Å—è—á–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
            month_ago = datetime.now() - timedelta(days=30)
            monthly_positions = [p for p in positions if p['timestamp'] >= month_ago]
            
            if not monthly_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            total_pnl = sum(p['pnl'] for p in monthly_positions if 'pnl' in p)
            return total_pnl
            
        except Exception as e:
            self.logger.error(f"Error calculating monthly return: {e}")
            return 0.0
    
    def _calculate_annualized_return(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
            all_positions = [p for p in positions if 'pnl' in p]
            
            if not all_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ PnL
            total_pnl = sum(p['pnl'] for p in all_positions)
            
            # –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏
            if len(all_positions) > 1:
                start_time = min(p['timestamp'] for p in all_positions)
                end_time = max(p['timestamp'] for p in all_positions)
                time_diff = (end_time - start_time).days / 365.25
                
                if time_diff > 0:
                    annualized_return = total_pnl / time_diff
                    return annualized_return
            
            return total_pnl
            
        except Exception as e:
            self.logger.error(f"Error calculating annualized return: {e}")
            return 0.0
    
    def _calculate_sharpe_ratio(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
            mean_return = np.mean(returns)
            std_return = np.std(returns)
            
            if std_return == 0:
                return 0.0
            
            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –±–µ–∑—Ä–∏—Å–∫–æ–≤—É—é —Å—Ç–∞–≤–∫—É = 0)
            sharpe_ratio = mean_return / std_return
            return sharpe_ratio
            
        except Exception as e:
            self.logger.error(f"Error calculating Sharpe ratio: {e}")
            return 0.0
    
    def _calculate_max_drawdown(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if not returns:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            cumulative_returns = np.cumsum(returns)
            
            # –†–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏
            running_max = np.maximum.accumulate(cumulative_returns)
            drawdowns = cumulative_returns - running_max
            max_drawdown = np.min(drawdowns)
            
            return abs(max_drawdown)
            
        except Exception as e:
            self.logger.error(f"Error calculating max drawdown: {e}")
            return 0.0
    
    def _calculate_var(self, positions: List[Dict], confidence_level: float) -> float:
        """–†–∞—Å—á–µ—Ç Value at Risk"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if not returns:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç VaR
            var = np.percentile(returns, (1 - confidence_level) * 100)
            return abs(var)
            
        except Exception as e:
            self.logger.error(f"Error calculating VaR: {e}")
            return 0.0
    
    def _calculate_win_rate(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ PnL
            pnls = [p['pnl'] for p in positions if 'pnl' in p]
            
            if not pnls:
                return 0.0
            
            # –ü–æ–¥—Å—á–µ—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
            winning_trades = sum(1 for pnl in pnls if pnl > 0)
            total_trades = len(pnls)
            
            win_rate = winning_trades / total_trades if total_trades > 0 else 0.0
            return win_rate
            
        except Exception as e:
            self.logger.error(f"Error calculating win rate: {e}")
            return 0.0
    
    def _calculate_profit_factor(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç —Ñ–∞–∫—Ç–æ—Ä–∞ –ø—Ä–∏–±—ã–ª–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ PnL
            pnls = [p['pnl'] for p in positions if 'pnl' in p]
            
            if not pnls:
                return 0.0
            
            # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ –∏ —É–±—ã—Ç–æ—á–Ω—ã–µ
            profits = [pnl for pnl in pnls if pnl > 0]
            losses = [abs(pnl) for pnl in pnls if pnl < 0]
            
            total_profit = sum(profits) if profits else 0
            total_loss = sum(losses) if losses else 0
            
            if total_loss == 0:
                return float('inf') if total_profit > 0 else 0.0
            
            profit_factor = total_profit / total_loss
            return profit_factor
            
        except Exception as e:
            self.logger.error(f"Error calculating profit factor: {e}")
            return 0.0
    
    def _calculate_avg_win(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π –ø—Ä–∏–±—ã–ª–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö PnL
            profits = [p['pnl'] for p in positions if 'pnl' in p and p['pnl'] > 0]
            
            if not profits:
                return 0.0
            
            avg_win = np.mean(profits)
            return avg_win
            
        except Exception as e:
            self.logger.error(f"Error calculating average win: {e}")
            return 0.0
    
    def _calculate_avg_loss(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —É–±—ã—Ç–∫–∞"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —É–±—ã—Ç–æ—á–Ω—ã—Ö PnL
            losses = [p['pnl'] for p in positions if 'pnl' in p and p['pnl'] < 0]
            
            if not losses:
                return 0.0
            
            avg_loss = np.mean(losses)
            return avg_loss
            
        except Exception as e:
            self.logger.error(f"Error calculating average loss: {e}")
            return 0.0
    
    def _calculate_consistency(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –≤–∞—Ä–∏–∞—Ü–∏–∏
            mean_return = np.mean(returns)
            std_return = np.std(returns)
            
            if mean_return == 0:
                return 0.0
            
            consistency = 1 - (std_return / abs(mean_return))
            return max(0, consistency)
            
        except Exception as e:
            self.logger.error(f"Error calculating consistency: {e}")
            return 0.0
    
    def _calculate_stability(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
            volatility = np.std(returns)
            stability = 1 / (1 + volatility)
            
            return stability
            
        except Exception as e:
            self.logger.error(f"Error calculating stability: {e}")
            return 0.0
    
    def _calculate_adaptability(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 10:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–∫ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏
            half_len = len(returns) // 2
            first_half = returns[:half_len]
            second_half = returns[half_len:]
            
            if len(first_half) > 1 and len(second_half) > 1:
                correlation = np.corrcoef(first_half, second_half)[0, 1]
                adaptability = abs(correlation)
            else:
                adaptability = 0.0
            
            return adaptability
            
        except Exception as e:
            self.logger.error(f"Error calculating adaptability: {e}")
            return 0.0
    
    def _calculate_volatility(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏"""
        try:
            if not positions:
                return 0.0
            
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            volatility = np.std(returns)
            return volatility
            
        except Exception as e:
            self.logger.error(f"Error calculating volatility: {e}")
            return 0.0
    
    def _calculate_recovery_factor(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç —Ñ–∞–∫—Ç–æ—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"""
        try:
            if not positions:
                return 0.0
            
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if not returns:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ PnL
            total_pnl = sum(returns)
            
            # –†–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏
            max_drawdown = self._calculate_max_drawdown(positions)
            
            if max_drawdown == 0:
                return float('inf') if total_pnl > 0 else 0.0
            
            recovery_factor = total_pnl / max_drawdown
            return recovery_factor
            
        except Exception as e:
            self.logger.error(f"Error calculating recovery factor: {e}")
            return 0.0
    
    def _calculate_monthly_progress(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –º–µ—Å—è—á–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫ —Ü–µ–ª–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
            now = datetime.now()
            month_start = now.replace(day=1, hour=0, minute=0, second=0, microsecond=0)
            monthly_positions = [p for p in positions if p.get('timestamp', now) >= month_start]
            
            if not monthly_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –º–µ—Å—è—á–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            monthly_pnl = sum(p['pnl'] for p in monthly_positions if 'pnl' in p)
            monthly_progress = monthly_pnl / (self.monthly_target * 10000)  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å 10000
            
            return min(monthly_progress, 1.0)  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 100%
            
        except Exception as e:
            self.logger.error(f"Error calculating monthly progress: {e}")
            return 0.0
    
    def _calculate_daily_progress(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫ —Ü–µ–ª–∏"""
        try:
            if not positions:
                return 0.0
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è
            today = datetime.now().date()
            daily_positions = [p for p in positions if p.get('timestamp', datetime.now()).date() == today]
            
            if not daily_positions:
                return 0.0
            
            # –†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            daily_pnl = sum(p['pnl'] for p in daily_positions if 'pnl' in p)
            daily_progress = daily_pnl / (self.daily_target * 10000)  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å 10000
            
            return min(daily_progress, 1.0)  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 100%
            
        except Exception as e:
            self.logger.error(f"Error calculating daily progress: {e}")
            return 0.0
    
    def _calculate_calmar_ratio(self, metrics: Dict) -> float:
        """–†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ö–∞–ª–º–∞—Ä–∞"""
        try:
            annualized_return = metrics.get('annualized_return', 0)
            max_drawdown = metrics.get('max_drawdown', 0)
            
            if max_drawdown == 0:
                return float('inf') if annualized_return > 0 else 0.0
            
            calmar_ratio = annualized_return / max_drawdown
            return calmar_ratio
            
        except Exception as e:
            self.logger.error(f"Error calculating Calmar ratio: {e}")
            return 0.0
    
    def _calculate_sortino_ratio(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –°–æ—Ä—Ç–∏–Ω–æ"""
        try:
            if not positions:
                return 0.0
            
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            mean_return = np.mean(returns)
            
            # –†–∞—Å—á–µ—Ç downside deviation (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π)
            negative_returns = [r for r in returns if r < 0]
            if not negative_returns:
                return float('inf') if mean_return > 0 else 0.0
            
            downside_deviation = np.std(negative_returns)
            
            if downside_deviation == 0:
                return float('inf') if mean_return > 0 else 0.0
            
            sortino_ratio = mean_return / downside_deviation
            return sortino_ratio
            
        except Exception as e:
            self.logger.error(f"Error calculating Sortino ratio: {e}")
            return 0.0
    
    def _calculate_treynor_ratio(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –¢—Ä–µ–π–Ω–æ—Ä–∞"""
        try:
            if not positions:
                return 0.0
            
            returns = [p['pnl'] for p in positions if 'pnl' in p]
            
            if len(returns) < 2:
                return 0.0
            
            mean_return = np.mean(returns)
            
            # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –±–µ—Ç–∞ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ä—ã–Ω–æ—á–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º)
            # –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ä—ã–Ω–æ—á–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º
            beta = 1.0  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –±–µ—Ç–∞ = 1 –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è
            
            if beta == 0:
                return float('inf') if mean_return > 0 else 0.0
            
            treynor_ratio = mean_return / beta
            return treynor_ratio
            
        except Exception as e:
            self.logger.error(f"Error calculating Treynor ratio: {e}")
            return 0.0
    
    def _calculate_data_quality_score(self, positions: List[Dict]) -> float:
        """–†–∞—Å—á–µ—Ç –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö"""
        try:
            if not positions:
                return 0.0
            
            total_positions = len(positions)
            valid_positions = 0
            
            for position in positions:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
                if all(key in position for key in ['timestamp', 'pnl', 'type']):
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
                    if (isinstance(position['pnl'], (int, float)) and 
                        isinstance(position['timestamp'], datetime) and
                        position['type'] in ['buy', 'sell']):
                        valid_positions += 1
            
            quality_score = valid_positions / total_positions if total_positions > 0 else 0.0
            return quality_score
            
        except Exception as e:
            self.logger.error(f"Error calculating data quality score: {e}")
            return 0.0
    
    def _calculate_target_achievement(self, metrics: Dict) -> float:
        """–†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π"""
        try:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—è—á–Ω–æ–π —Ü–µ–ª–∏
            monthly_return = metrics.get('monthly_return', 0)
            monthly_achievement = min(monthly_return / self.monthly_target, 1.0)
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω–µ–≤–Ω–æ–π —Ü–µ–ª–∏
            daily_return = metrics.get('daily_return', 0)
            daily_achievement = min(daily_return / self.daily_target, 1.0)
            
            # –û–±—â–µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π
            target_achievement = (monthly_achievement + daily_achievement) / 2
            
            return target_achievement
            
        except Exception as e:
            self.logger.error(f"Error calculating target achievement: {e}")
            return 0.0
    
    def _calculate_performance_score(self, metrics: Dict) -> float:
        """–†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –±–∞–ª–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        try:
            # –í–µ—Å–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
            weights = {
                'total_return': 0.3,
                'sharpe_ratio': 0.2,
                'win_rate': 0.15,
                'profit_factor': 0.15,
                'consistency': 0.1,
                'stability': 0.1
            }
            
            # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
            normalized_metrics = {}
            
            # –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (0-1)
            total_return = metrics.get('total_return', 0)
            normalized_metrics['total_return'] = min(total_return / 2.0, 1.0)  # 200% = 1.0
            
            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ (0-1)
            sharpe_ratio = metrics.get('sharpe_ratio', 0)
            normalized_metrics['sharpe_ratio'] = min(sharpe_ratio / 3.0, 1.0)  # 3.0 = 1.0
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (0-1)
            win_rate = metrics.get('win_rate', 0)
            normalized_metrics['win_rate'] = win_rate
            
            # –§–∞–∫—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏ (0-1)
            profit_factor = metrics.get('profit_factor', 0)
            normalized_metrics['profit_factor'] = min(profit_factor / 3.0, 1.0)  # 3.0 = 1.0
            
            # –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (0-1)
            consistency = metrics.get('consistency', 0)
            normalized_metrics['consistency'] = consistency
            
            # –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (0-1)
            stability = metrics.get('stability', 0)
            normalized_metrics['stability'] = stability
            
            # –†–∞—Å—á–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ –±–∞–ª–ª–∞
            performance_score = sum(
                weights[metric] * normalized_metrics[metric]
                for metric in weights
            )
            
            return performance_score
            
        except Exception as e:
            self.logger.error(f"Error calculating performance score: {e}")
            return 0.0
    
    def check_alerts(self, metrics: Dict) -> List[Dict]:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤"""
        alerts = []
        
        try:
            # –ê–ª–µ—Ä—Ç –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é –º–µ—Å—è—á–Ω–æ–π —Ü–µ–ª–∏
            monthly_return = metrics.get('monthly_return', 0)
            if monthly_return >= self.monthly_target:
                alerts.append({
                    'type': 'success',
                    'message': f'Monthly target achieved: {monthly_return:.2%}',
                    'timestamp': datetime.now()
                })
            
            # –ê–ª–µ—Ä—Ç –ø–æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏
            max_drawdown = metrics.get('max_drawdown', 0)
            if max_drawdown > 0.2:  # 20%
                alerts.append({
                    'type': 'warning',
                    'message': f'Max drawdown exceeded: {max_drawdown:.2%}',
                    'timestamp': datetime.now()
                })
            
            # –ê–ª–µ—Ä—Ç –ø–æ –Ω–∏–∑–∫–æ–º—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –®–∞—Ä–ø–∞
            sharpe_ratio = metrics.get('sharpe_ratio', 0)
            if sharpe_ratio < 1.0:
                alerts.append({
                    'type': 'warning',
                    'message': f'Low Sharpe ratio: {sharpe_ratio:.2f}',
                    'timestamp': datetime.now()
                })
            
            # –ê–ª–µ—Ä—Ç –ø–æ –Ω–∏–∑–∫–æ–º—É –ø—Ä–æ—Ü–µ–Ω—Ç—É –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
            win_rate = metrics.get('win_rate', 0)
            if win_rate < 0.5:
                alerts.append({
                    'type': 'warning',
                    'message': f'Low win rate: {win_rate:.2%}',
                    'timestamp': datetime.now()
                })
            
            return alerts
            
        except Exception as e:
            self.logger.error(f"Error checking alerts: {e}")
            return []
    
    def generate_report(self, metrics: Dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞"""
        try:
            report = f"""
# NeoZorK 100% System Performance Report
Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

## üìä Key Metrics

### Returns
- **Total Return**: {metrics.get('total_return', 0):.2%}
- **Daily Return**: {metrics.get('daily_return', 0):.2%}
- **Weekly Return**: {metrics.get('weekly_return', 0):.2%}
- **Monthly Return**: {metrics.get('monthly_return', 0):.2%}
- **Annualized Return**: {metrics.get('annualized_return', 0):.2%}

### Risk Metrics
- **Sharpe Ratio**: {metrics.get('sharpe_ratio', 0):.2f}
- **Max Drawdown**: {metrics.get('max_drawdown', 0):.2%}
- **VaR 95%**: {metrics.get('var_95', 0):.2%}
- **VaR 99%**: {metrics.get('var_99', 0):.2%}

### Trading Metrics
- **Win Rate**: {metrics.get('win_rate', 0):.2%}
- **Profit Factor**: {metrics.get('profit_factor', 0):.2f}
- **Average Win**: {metrics.get('avg_win', 0):.2f}
- **Average Loss**: {metrics.get('avg_loss', 0):.2f}

### Robustness Metrics
- **Consistency**: {metrics.get('consistency', 0):.2f}
- **Stability**: {metrics.get('stability', 0):.2f}
- **Adaptability**: {metrics.get('adaptability', 0):.2f}

### Target Achievement
- **Target Achievement**: {metrics.get('target_achievement', 0):.2%}
- **Performance Score**: {metrics.get('performance_score', 0):.2f}

## üéØ Status
"""
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
            performance_score = metrics.get('performance_score', 0)
            if performance_score >= 0.8:
                report += "üü¢ **EXCELLENT** - System performing above expectations\n"
            elif performance_score >= 0.6:
                report += "üü° **GOOD** - System performing well\n"
            elif performance_score >= 0.4:
                report += "üü† **FAIR** - System needs improvement\n"
            else:
                report += "üî¥ **POOR** - System requires immediate attention\n"
            
            return report
            
        except Exception as e:
            self.logger.error(f"Error generating report: {e}")
            return "Error generating report"
    
    def create_dashboard(self, metrics: Dict) -> go.Figure:
        """–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞"""
        try:
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—É–±–ø–ª–æ—Ç–æ–≤
            fig = make_subplots(
                rows=3, cols=2,
                subplot_titles=('Returns Over Time', 'Risk Metrics', 'Trading Performance', 'Robustness Metrics', 'Target Achievement', 'Performance Score'),
                specs=[[{"type": "scatter"}, {"type": "bar"}],
                       [{"type": "bar"}, {"type": "bar"}],
                       [{"type": "bar"}, {"type": "indicator"}]]
            )
            
            # –ì—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            if self.metrics_history:
                timestamps = [m['timestamp'] for m in self.metrics_history]
                returns = [m['total_return'] for m in self.metrics_history]
                
                fig.add_trace(
                    go.Scatter(x=timestamps, y=returns, name='Total Return', line=dict(color='blue')),
                    row=1, col=1
                )
            
            # –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∏—Å–∫–∞
            risk_metrics = ['sharpe_ratio', 'max_drawdown', 'var_95', 'var_99']
            risk_values = [metrics.get(m, 0) for m in risk_metrics]
            
            fig.add_trace(
                go.Bar(x=risk_metrics, y=risk_values, name='Risk Metrics', marker_color='red'),
                row=1, col=2
            )
            
            # –¢–æ—Ä–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
            trading_metrics = ['win_rate', 'profit_factor', 'avg_win', 'avg_loss']
            trading_values = [metrics.get(m, 0) for m in trading_metrics]
            
            fig.add_trace(
                go.Bar(x=trading_metrics, y=trading_values, name='Trading Metrics', marker_color='green'),
                row=2, col=1
            )
            
            # –ú–µ—Ç—Ä–∏–∫–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏
            robustness_metrics = ['consistency', 'stability', 'adaptability']
            robustness_values = [metrics.get(m, 0) for m in robustness_metrics]
            
            fig.add_trace(
                go.Bar(x=robustness_metrics, y=robustness_values, name='Robustness Metrics', marker_color='orange'),
                row=2, col=2
            )
            
            # –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π
            target_metrics = ['monthly_target', 'daily_target']
            target_values = [self.monthly_target, self.daily_target]
            achievement_values = [metrics.get('monthly_return', 0), metrics.get('daily_return', 0)]
            
            fig.add_trace(
                go.Bar(x=target_metrics, y=target_values, name='Targets', marker_color='lightblue'),
                row=3, col=1
            )
            
            fig.add_trace(
                go.Bar(x=target_metrics, y=achievement_values, name='Achievement', marker_color='darkblue'),
                row=3, col=1
            )
            
            # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            performance_score = metrics.get('performance_score', 0)
            
            fig.add_trace(
                go.Indicator(
                    mode="gauge+number+delta",
                    value=performance_score,
                    domain={'x': [0, 1], 'y': [0, 1]},
                    title={'text': "Performance Score"},
                    gauge={'axis': {'range': [None, 1]},
                           'bar': {'color': "darkblue"},
                           'steps': [{'range': [0, 0.4], 'color': "lightgray"},
                                   {'range': [0.4, 0.6], 'color': "yellow"},
                                   {'range': [0.6, 0.8], 'color': "orange"},
                                   {'range': [0.8, 1], 'color': "green"}],
                           'threshold': {'line': {'color': "red", 'width': 4},
                                       'thickness': 0.75, 'value': 0.8}}
                ),
                row=3, col=2
            )
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–∫–µ—Ç–∞
            fig.update_layout(
                title_text="NeoZorK 100% System Dashboard",
                showlegend=True,
                height=800
            )
            
            return fig
            
        except Exception as e:
            self.logger.error(f"Error creating dashboard: {e}")
            return go.Figure()


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
if __name__ == "__main__":
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    """
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
    config = {
        'monitoring': {
            'monthly_target': 1.0,  # 100% –≤ –º–µ—Å—è—Ü
            'daily_target': 0.033,  # ~3.3% –≤ –¥–µ–Ω—å
            'risk_limits': {
                'max_drawdown': 0.2,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ 20%
                'min_sharpe': 1.0,    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
                'min_win_rate': 0.5   # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
            },
            'alert_thresholds': {
                'performance_warning': 0.4,   # –ü–æ—Ä–æ–≥ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                'performance_critical': 0.2   # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥
            }
        }
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–Ω–∏—Ç–æ—Ä–∞
    monitor = PerformanceMonitor(config)
    
    # –ü—Ä–∏–º–µ—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
    from datetime import datetime, timedelta
    import random
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    positions = []
    base_time = datetime.now() - timedelta(days=30)
    
    for i in range(100):
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å —Ç—Ä–µ–Ω–¥–æ–º –∫ –ø—Ä–∏–±—ã–ª–∏
        pnl = random.gauss(50, 30)  # –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å 50, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ 30
        if i < 20:  # –ü–µ—Ä–≤—ã–µ 20 —Å–¥–µ–ª–æ–∫ - —É–±—ã—Ç–æ—á–Ω—ã–µ
            pnl = random.gauss(-30, 20)
        elif i > 80:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–¥–µ–ª–æ–∫ - –æ—á–µ–Ω—å –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ
            pnl = random.gauss(100, 40)
        
        position = {
            'timestamp': base_time + timedelta(hours=i*6),
            'pnl': pnl,
            'type': 'buy' if pnl > 0 else 'sell',
            'amount': random.uniform(0.1, 1.0),
            'price': random.uniform(1.0, 2.0)
        }
        positions.append(position)
    
    # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
    initial_balance = 10000
    current_balance = initial_balance + sum(p['pnl'] for p in positions)
    
    print("=== NeoZorK 100% Performance Monitoring System ===")
    print(f"Initial Balance: ${initial_balance:,.2f}")
    print(f"Current Balance: ${current_balance:,.2f}")
    print(f"Total Positions: {len(positions)}")
    print()
    
    # –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
    metrics = monitor.calculate_metrics(positions, current_balance, initial_balance)
    
    # –í—ã–≤–æ–¥ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫
    print("üìä KEY PERFORMANCE METRICS:")
    print(f"Total Return: {metrics['total_return']:.2%}")
    print(f"Monthly Return: {metrics['monthly_return']:.2%}")
    print(f"Daily Return: {metrics['daily_return']:.2%}")
    print(f"Sharpe Ratio: {metrics['sharpe_ratio']:.2f}")
    print(f"Max Drawdown: {metrics['max_drawdown']:.2%}")
    print(f"Win Rate: {metrics['win_rate']:.2%}")
    print(f"Profit Factor: {metrics['profit_factor']:.2f}")
    print(f"Performance Score: {metrics['performance_score']:.2f}")
    print()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
    alerts = monitor.check_alerts(metrics)
    if alerts:
        print("üö® ALERTS:")
        for alert in alerts:
            print(f"- {alert['type'].upper()}: {alert['message']}")
        print()
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
    report = monitor.generate_report(metrics)
    print("üìã PERFORMANCE REPORT:")
    print(report)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    try:
        dashboard = monitor.create_dashboard(metrics)
        dashboard.show()
    except Exception as e:
        print(f"Dashboard creation failed: {e}")
    
    print("\n‚úÖ Performance monitoring completed successfully!")

```

## üö® –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤

**–¢–µ–æ—Ä–∏—è:** –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

1. **–¢–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ)
2. **–ö–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (email, Telegram, Discord, SMS)
3. **–ü–æ—Ä–æ–≥–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
4. **–≠—Å–∫–∞–ª–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–∫—Ü–∏–∏
5. **–ò—Å—Ç–æ—Ä–∏—è –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ —Ç–∏–ø–æ–≤ –∞–ª–µ—Ä—Ç–æ–≤
- **–ì–∏–±–∫–æ—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –∏ —É—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ –¥–æ—Å—Ç–∞–≤–∫–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –∞–ª–µ—Ä—Ç–æ–≤

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã:**
- **–ü–æ—Ä–æ–≥–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è**: `Alert = Metric > Threshold`, –≥–¥–µ Metric - –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏, Threshold - –ø–æ—Ä–æ–≥
- **–≠—Å–∫–∞–ª–∞—Ü–∏—è**: `Escalation = f(Time, Priority, Response_Status)`
- **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è**: `Priority = Weight √ó Severity √ó Urgency`

**–ü–æ—á–µ–º—É —Å–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞:**
- **–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **–†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –¥–æ –∏—Ö —ç—Å–∫–∞–ª–∞—Ü–∏–∏
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å –∏ —Å–±–æ–µ–≤ —Å–∏—Å—Ç–µ–º—ã
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–æ–≤:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∏—Å–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–ê—É–¥–∏—Ç:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π

**–¢–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤:**
1. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ** - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è
2. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** - –≤–Ω–∏–º–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è
3. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ** - –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞
4. **–¢–æ—Ä–≥–æ–≤—ã–µ** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
5. **–†–∏—Å–∫–æ–≤—ã–µ** - –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ä–∏—Å–∫–æ–≤
6. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é —Å–∏—Å—Ç–µ–º—ã

**–ü–ª—é—Å—ã:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ä–∏—Å–∫–∞–º–∏
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π

**–ú–∏–Ω—É—Å—ã:**
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
- –¢—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ "—É—Å—Ç–∞–ª–æ—Å—Ç–∏ –æ—Ç –∞–ª–µ—Ä—Ç–æ–≤" –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

```python
# src/monitoring/alerts.py
"""
NeoZorK 100% Alert Management System

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
–¥–æ—Å—Ç–∞–≤–∫–∏, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —ç—Å–∫–∞–ª–∞—Ü–∏—é.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- AlertManager: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–∞–º–∏
- –ö–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏: Email, Telegram, Discord, SMS
- –¢–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ
- –≠—Å–∫–∞–ª–∞—Ü–∏—è: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –∞–ª–µ—Ä—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    config = {
        'monitoring': {
            'email': {'enabled': True, 'smtp_server': 'smtp.gmail.com'},
            'telegram': {'enabled': True, 'bot_token': 'your_token'},
            'discord': {'enabled': True, 'webhook_url': 'your_webhook'}
        }
    }
    
    alert_manager = AlertManager(config)
    alert_manager.send_alert({'type': 'critical', 'message': 'System error'})
"""

import smtplib
import requests
import logging
import json
import time
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Union
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from pathlib import Path
import threading
from dataclasses import dataclass
from enum import Enum

class AlertType(Enum):
    """–¢–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤"""
    CRITICAL = "critical"
    WARNING = "warning"
    INFO = "info"
    TRADE = "trade"
    RISK = "risk"
    PERFORMANCE = "performance"
    SYSTEM = "system"

class AlertPriority(Enum):
    """–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∞–ª–µ—Ä—Ç–æ–≤"""
    LOW = 1
    MEDIUM = 2
    HIGH = 3
    CRITICAL = 4

@dataclass
class Alert:
    """–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–ª–µ—Ä—Ç–∞"""
    type: AlertType
    priority: AlertPriority
    message: str
    timestamp: datetime
    data: Optional[Dict] = None
    escalation_count: int = 0
    response_required: bool = True
    channels: List[str] = None

class AlertManager:
    """
    –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    
    –≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
    —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –°–∏—Å—Ç–µ–º–∞
    –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —ç—Å–∫–∞–ª–∞—Ü–∏—é –∏
    –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.
    
    Attributes:
        config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤
        logger (logging.Logger): –õ–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–±—ã—Ç–∏–π
        alert_history (List[Alert]): –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∞–ª–µ—Ä—Ç–æ–≤
        escalation_thread (threading.Thread): –ü–æ—Ç–æ–∫ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤
        rate_limits (Dict): –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
        
    Methods:
        send_alert: –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ —á–µ—Ä–µ–∑ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
        check_escalation: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —ç—Å–∫–∞–ª–∞—Ü–∏–∏
        get_alert_statistics: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∞–ª–µ—Ä—Ç–∞–º
        configure_channel: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
    """
    
    def __init__(self, config: Dict):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤
        
        Args:
            config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—é—â–∞—è:
                - monitoring.email: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                - monitoring.telegram: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                - monitoring.discord: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Discord —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                - monitoring.sms: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                - monitoring.escalation: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
        """
        self.config = config
        self.logger = logging.getLogger(__name__)
        self.alert_history = []
        self.rate_limits = {}
        self.escalation_enabled = True
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏
        self.channels = self._setup_channels()
        
        # –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
        self.escalation_thread = threading.Thread(target=self._escalation_worker, daemon=True)
        self.escalation_thread.start()
        
        self.logger.info("AlertManager initialized successfully")
    
    def _setup_channels(self) -> Dict[str, bool]:
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏"""
        channels = {}
        monitoring_config = self.config.get('monitoring', {})
        
        # Email –∫–∞–Ω–∞–ª
        email_config = monitoring_config.get('email', {})
        channels['email'] = email_config.get('enabled', False)
        
        # Telegram –∫–∞–Ω–∞–ª
        telegram_config = monitoring_config.get('telegram', {})
        channels['telegram'] = telegram_config.get('enabled', False)
        
        # Discord –∫–∞–Ω–∞–ª
        discord_config = monitoring_config.get('discord', {})
        channels['discord'] = discord_config.get('enabled', False)
        
        # SMS –∫–∞–Ω–∞–ª
        sms_config = monitoring_config.get('sms', {})
        channels['sms'] = sms_config.get('enabled', False)
        
        self.logger.info(f"Channels configured: {[k for k, v in channels.items() if v]}")
        return channels
        
    def send_alert(self, alert_data: Union[Dict, Alert]) -> bool:
        """
        –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ —á–µ—Ä–µ–∑ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
        
        –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
        –¥–æ—Å—Ç–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å —É—á–µ—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
        —á–∞—Å—Ç–æ—Ç—ã –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤.
        
        Args:
            alert_data (Union[Dict, Alert]): –î–∞–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç–∞ –∏–ª–∏ –æ–±—ä–µ–∫—Ç Alert
            
        Returns:
            bool: True –µ—Å–ª–∏ –∞–ª–µ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, False –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ
            
        Example:
            >>> alert_manager.send_alert({
            ...     'type': 'critical',
            ...     'message': 'System error detected',
            ...     'priority': 'high'
            ... })
            True
        """
        try:
            # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –æ–±—ä–µ–∫—Ç Alert –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
            if isinstance(alert_data, dict):
                alert = self._create_alert_from_dict(alert_data)
            else:
                alert = alert_data
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —á–∞—Å—Ç–æ—Ç—ã
            if not self._check_rate_limit(alert):
                self.logger.warning(f"Rate limit exceeded for alert: {alert.message}")
                return False
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
            self.alert_history.append(alert)
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
            success_count = 0
            total_channels = 0
            
            if self.channels.get('email', False):
                total_channels += 1
                if self._send_email_alert(alert):
                    success_count += 1
            
            if self.channels.get('telegram', False):
                total_channels += 1
                if self._send_telegram_alert(alert):
                    success_count += 1
            
            if self.channels.get('discord', False):
                total_channels += 1
                if self._send_discord_alert(alert):
                    success_count += 1
            
            if self.channels.get('sms', False):
                total_channels += 1
                if self._send_sms_alert(alert):
                    success_count += 1
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            self._update_rate_limit(alert)
            
            success = success_count > 0
            self.logger.info(f"Alert sent: {alert.message} ({success_count}/{total_channels} channels)")
            
            return success
            
        except Exception as e:
            self.logger.error(f"Error sending alert: {e}")
            return False
    
    def _create_alert_from_dict(self, alert_data: Dict) -> Alert:
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ Alert –∏–∑ —Å–ª–æ–≤–∞—Ä—è"""
        alert_type = AlertType(alert_data.get('type', 'info'))
        priority = AlertPriority(alert_data.get('priority', 'medium'))
        
        return Alert(
            type=alert_type,
            priority=priority,
            message=alert_data.get('message', ''),
            timestamp=datetime.now(),
            data=alert_data.get('data'),
            response_required=alert_data.get('response_required', True),
            channels=alert_data.get('channels', list(self.channels.keys()))
        )
    
    def _check_rate_limit(self, alert: Alert) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏"""
        try:
            alert_key = f"{alert.type.value}_{alert.priority.value}"
            now = datetime.now()
            
            if alert_key not in self.rate_limits:
                self.rate_limits[alert_key] = []
            
            # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π (—Å—Ç–∞—Ä—à–µ 1 —á–∞—Å–∞)
            cutoff_time = now - timedelta(hours=1)
            self.rate_limits[alert_key] = [
                timestamp for timestamp in self.rate_limits[alert_key]
                if timestamp > cutoff_time
            ]
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
            max_per_hour = {
                AlertPriority.LOW: 10,
                AlertPriority.MEDIUM: 20,
                AlertPriority.HIGH: 50,
                AlertPriority.CRITICAL: 100
            }
            
            limit = max_per_hour.get(alert.priority, 10)
            
            if len(self.rate_limits[alert_key]) >= limit:
                return False
            
            return True
            
        except Exception as e:
            self.logger.error(f"Error checking rate limit: {e}")
            return True  # –†–∞–∑—Ä–µ—à–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–µ
    
    def _update_rate_limit(self, alert: Alert):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏"""
        try:
            alert_key = f"{alert.type.value}_{alert.priority.value}"
            if alert_key not in self.rate_limits:
                self.rate_limits[alert_key] = []
            
            self.rate_limits[alert_key].append(datetime.now())
            
        except Exception as e:
            self.logger.error(f"Error updating rate limit: {e}")
    
    def _escalation_worker(self):
        """–ü–æ—Ç–æ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤"""
        while self.escalation_enabled:
            try:
                self._check_escalation()
                time.sleep(60)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            except Exception as e:
                self.logger.error(f"Error in escalation worker: {e}")
                time.sleep(60)
    
    def _check_escalation(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —ç—Å–∫–∞–ª–∞—Ü–∏–∏"""
        try:
            now = datetime.now()
            escalation_timeout = timedelta(minutes=15)  # 15 –º–∏–Ω—É—Ç –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
            
            for alert in self.alert_history:
                if (alert.response_required and 
                    alert.escalation_count < 3 and
                    now - alert.timestamp > escalation_timeout):
                    
                    # –≠—Å–∫–∞–ª–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–∞
                    alert.escalation_count += 1
                    alert.priority = AlertPriority(min(alert.priority.value + 1, 4))
                    
                    # –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
                    self.send_alert(alert)
                    
                    self.logger.warning(f"Alert escalated: {alert.message} (count: {alert.escalation_count})")
                    
        except Exception as e:
            self.logger.error(f"Error checking escalation: {e}")
    
    def get_alert_statistics(self, hours: int = 24) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∞–ª–µ—Ä—Ç–∞–º"""
        try:
            cutoff_time = datetime.now() - timedelta(hours=hours)
            recent_alerts = [a for a in self.alert_history if a.timestamp > cutoff_time]
            
            stats = {
                'total_alerts': len(recent_alerts),
                'by_type': {},
                'by_priority': {},
                'escalated': len([a for a in recent_alerts if a.escalation_count > 0]),
                'response_time_avg': self._calculate_avg_response_time(recent_alerts)
            }
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º
            for alert in recent_alerts:
                alert_type = alert.type.value
                stats['by_type'][alert_type] = stats['by_type'].get(alert_type, 0) + 1
                
                priority = alert.priority.value
                stats['by_priority'][priority] = stats['by_priority'].get(priority, 0) + 1
            
            return stats
            
        except Exception as e:
            self.logger.error(f"Error getting alert statistics: {e}")
            return {}
    
    def _calculate_avg_response_time(self, alerts: List[Alert]) -> float:
        """–†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –∞–ª–µ—Ä—Ç—ã"""
        try:
            response_times = []
            for alert in alerts:
                if alert.escalation_count == 0:  # –ê–ª–µ—Ä—Ç –±—ã–ª –æ–±—Ä–∞–±–æ—Ç–∞–Ω –±–µ–∑ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
                    # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –∞–ª–µ—Ä—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∑–∞ 5 –º–∏–Ω—É—Ç
                    response_times.append(5.0)
            
            return sum(response_times) / len(response_times) if response_times else 0.0
            
        except Exception as e:
            self.logger.error(f"Error calculating response time: {e}")
            return 0.0
    
    def _send_email_alert(self, alert: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ email –∞–ª–µ—Ä—Ç–∞"""
        try:
            email_config = self.config.get('monitoring', {}).get('email', {})
            
            if not email_config.get('enabled', False):
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            msg = MIMEMultipart()
            msg['From'] = email_config['email']
            msg['To'] = email_config['email']
            msg['Subject'] = f"NeoZorK 100% System Alert - {alert['type'].upper()}"
            
            # –¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            body = f"""
            Alert Type: {alert['type']}
            Message: {alert['message']}
            Timestamp: {alert['timestamp']}
            
            Please check the system immediately.
            """
            
            msg.attach(MIMEText(body, 'plain'))
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞
            server = smtplib.SMTP(email_config['smtp_server'], email_config['smtp_port'])
            server.starttls()
            server.login(email_config['email'], email_config['password'])
            server.send_message(msg)
            server.quit()
            
        except Exception as e:
            self.logger.error(f"Error sending email alert: {e}")
    
    def _send_telegram_alert(self, alert: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ Telegram –∞–ª–µ—Ä—Ç–∞"""
        try:
            telegram_config = self.config.get('monitoring', {}).get('telegram', {})
            
            if not telegram_config.get('enabled', False):
                return
            
            # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            message = f"""
            üö® **NeoZorK 100% System Alert**
            
            **Type**: {alert['type'].upper()}
            **Message**: {alert['message']}
            **Time**: {alert['timestamp']}
            
            Please check the system immediately.
            """
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞
            url = f"https://api.telegram.org/bot{telegram_config['bot_token']}/sendMessage"
            data = {
                'chat_id': telegram_config['chat_id'],
                'text': message,
                'parse_mode': 'Markdown'
            }
            
            response = requests.post(url, data=data)
            response.raise_for_status()
            
        except Exception as e:
            self.logger.error(f"Error sending Telegram alert: {e}")
    
    def _send_discord_alert(self, alert: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ Discord –∞–ª–µ—Ä—Ç–∞"""
        try:
            discord_config = self.config.get('monitoring', {}).get('discord', {})
            
            if not discord_config.get('enabled', False):
                return
            
            # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            message = {
                "content": f"üö® **NeoZorK 100% System Alert**",
                "embeds": [{
                    "title": f"Alert Type: {alert['type'].upper()}",
                    "description": alert['message'],
                    "color": 0xff0000 if alert['type'] == 'error' else 0xffa500,
                    "timestamp": alert['timestamp'].isoformat(),
                    "fields": [
                        {"name": "Type", "value": alert['type'], "inline": True},
                        {"name": "Time", "value": alert['timestamp'].strftime('%Y-%m-%d %H:%M:%S'), "inline": True}
                    ]
                }]
            }
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞
            response = requests.post(discord_config['webhook_url'], json=message)
            response.raise_for_status()
            
        except Exception as e:
            self.logger.error(f"Error sending Discord alert: {e}")
    
    def send_trade_alert(self, trade: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –æ —Å–¥–µ–ª–∫–µ"""
        try:
            alert = {
                'type': 'trade',
                'message': f"Trade executed: {trade['type']} {trade['amount']} at {trade['price']}",
                'timestamp': datetime.now()
            }
            
            self.send_alert(alert)
            
        except Exception as e:
            self.logger.error(f"Error sending trade alert: {e}")
    
    def send_risk_alert(self, risk_status: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –æ —Ä–∏—Å–∫–∞—Ö"""
        try:
            alert = {
                'type': 'risk',
                'message': f"Risk limits exceeded: {risk_status['message']}",
                'timestamp': datetime.now()
            }
            
            self.send_alert(alert)
            
        except Exception as e:
            self.logger.error(f"Error sending risk alert: {e}")
    
    def send_performance_alert(self, performance: Dict):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        try:
            performance_score = performance.get('performance_score', 0)
            
            if performance_score < 0.4:
                alert = {
                    'type': 'performance',
                    'message': f"Low performance score: {performance_score:.2f}",
                    'timestamp': datetime.now()
                }
                
                self.send_alert(alert)
            
        except Exception as e:
            self.logger.error(f"Error sending performance alert: {e}")
    
    def _send_sms_alert(self, alert: Alert) -> bool:
        """–û—Ç–ø—Ä–∞–≤–∫–∞ SMS –∞–ª–µ—Ä—Ç–∞"""
        try:
            sms_config = self.config.get('monitoring', {}).get('sms', {})
            
            if not sms_config.get('enabled', False):
                return False
            
            # –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SMS-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
            # –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
            self.logger.info(f"SMS Alert: {alert.message}")
            return True
            
        except Exception as e:
            self.logger.error(f"Error sending SMS alert: {e}")
            return False
    
    def configure_channel(self, channel: str, enabled: bool, config: Dict = None):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–∞ –¥–æ—Å—Ç–∞–≤–∫–∏"""
        try:
            if channel in self.channels:
                self.channels[channel] = enabled
                
                if config:
                    monitoring_config = self.config.get('monitoring', {})
                    monitoring_config[channel] = config
                    self.config['monitoring'] = monitoring_config
                
                self.logger.info(f"Channel {channel} {'enabled' if enabled else 'disabled'}")
                return True
            else:
                self.logger.error(f"Unknown channel: {channel}")
                return False
                
        except Exception as e:
            self.logger.error(f"Error configuring channel {channel}: {e}")
            return False
    
    def stop_escalation(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã —ç—Å–∫–∞–ª–∞—Ü–∏–∏"""
        self.escalation_enabled = False
        self.logger.info("Escalation system stopped")
    
    def export_alert_history(self, format: str = 'json') -> str:
        """–≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤"""
        try:
            if format == 'json':
                alerts_data = []
                for alert in self.alert_history:
                    alert_dict = {
                        'type': alert.type.value,
                        'priority': alert.priority.value,
                        'message': alert.message,
                        'timestamp': alert.timestamp.isoformat(),
                        'escalation_count': alert.escalation_count,
                        'response_required': alert.response_required
                    }
                    if alert.data:
                        alert_dict['data'] = alert.data
                    alerts_data.append(alert_dict)
                
                return json.dumps(alerts_data, indent=2)
            else:
                return str(self.alert_history)
                
        except Exception as e:
            self.logger.error(f"Error exporting alert history: {e}")
            return ""


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤
if __name__ == "__main__":
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    """
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤
    config = {
        'monitoring': {
            'email': {
                'enabled': True,
                'smtp_server': 'smtp.gmail.com',
                'smtp_port': 587,
                'email': 'your_email@gmail.com',
                'password': 'your_password'
            },
            'telegram': {
                'enabled': True,
                'bot_token': 'your_bot_token',
                'chat_id': 'your_chat_id'
            },
            'discord': {
                'enabled': True,
                'webhook_url': 'your_webhook_url'
            },
            'sms': {
                'enabled': False  # –û—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            }
        }
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∞–ª–µ—Ä—Ç–æ–≤
    alert_manager = AlertManager(config)
    
    print("=== NeoZorK 100% Alert Management System ===")
    print("Testing alert system...")
    print()
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–ª–µ—Ä—Ç–æ–≤
    test_alerts = [
        {
            'type': 'critical',
            'priority': 'critical',
            'message': 'System connection lost - immediate action required!',
            'response_required': True
        },
        {
            'type': 'warning',
            'priority': 'high',
            'message': 'Performance score below threshold: 0.35',
            'response_required': True
        },
        {
            'type': 'trade',
            'priority': 'medium',
            'message': 'Large trade executed: BUY 1000 units at $1.2345',
            'response_required': False
        },
        {
            'type': 'risk',
            'priority': 'high',
            'message': 'Maximum drawdown exceeded: 25%',
            'response_required': True
        },
        {
            'type': 'info',
            'priority': 'low',
            'message': 'Daily performance report generated',
            'response_required': False
        }
    ]
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤
    for i, alert_data in enumerate(test_alerts, 1):
        print(f"üö® Sending Alert {i}: {alert_data['type'].upper()}")
        success = alert_manager.send_alert(alert_data)
        print(f"   Status: {'‚úÖ Success' if success else '‚ùå Failed'}")
        print(f"   Message: {alert_data['message']}")
        print()
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    print("üìä ALERT STATISTICS:")
    stats = alert_manager.get_alert_statistics(hours=1)
    print(f"Total Alerts: {stats.get('total_alerts', 0)}")
    print(f"By Type: {stats.get('by_type', {})}")
    print(f"By Priority: {stats.get('by_priority', {})}")
    print(f"Escalated: {stats.get('escalated', 0)}")
    print(f"Avg Response Time: {stats.get('response_time_avg', 0):.1f} minutes")
    print()
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —á–∞—Å—Ç–æ—Ç—ã
    print("üîÑ TESTING RATE LIMITS:")
    for i in range(15):  # –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 15 –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ–¥—Ä—è–¥
        alert_data = {
            'type': 'info',
            'priority': 'low',
            'message': f'Rate limit test alert {i+1}',
            'response_required': False
        }
        success = alert_manager.send_alert(alert_data)
        if not success:
            print(f"   Rate limit reached at alert {i+1}")
            break
    print()
    
    # –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤
    print("üìã EXPORTING ALERT HISTORY:")
    history_json = alert_manager.export_alert_history('json')
    print(f"Exported {len(alert_manager.alert_history)} alerts to JSON format")
    print(f"JSON length: {len(history_json)} characters")
    print()
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã —ç—Å–∫–∞–ª–∞—Ü–∏–∏
    alert_manager.stop_escalation()
    
    print("‚úÖ Alert system testing completed successfully!")
    print("Note: Actual email/telegram/discord notifications require valid credentials")

```

## üìà –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–¢–µ–æ—Ä–∏—è:** –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∑–∞–ø–∏—Å–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π, –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –º–µ—Ç—Ä–∏–∫ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º –∏ –∞—É–¥–∏—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–π.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

1. **–¢–∏–ø—ã –ª–æ–≥–æ–≤** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–ø–∏—Å–µ–π (—Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—à–∏–±–∫–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è)
2. **–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π (DEBUG, INFO, WARNING, ERROR, CRITICAL)
3. **–§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ (JSON, CSV, Parquet)
4. **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
5. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ–∏—Å–∫–∞ –≤ –ª–æ–≥–∞—Ö
6. **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –≤—Å–µ –ª–æ–≥–∏ –∏–º–µ—é—Ç –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö —Å–∏—Å—Ç–µ–º—ã
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –ª–æ–≥–∞—Ö

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã:**
- **–≠–Ω—Ç—Ä–æ–ø–∏—è –ª–æ–≥–æ–≤**: `H = -Œ£ p(x) * log2(p(x))`, –≥–¥–µ p(x) - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è x
- **–°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö**: `Compression_Ratio = Original_Size / Compressed_Size`
- **–ò–Ω–¥–µ–∫—Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: `Log_Performance = Logs_Per_Second / CPU_Usage`

**–ü–æ—á–µ–º—É —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞:**
- **–ê–Ω–∞–ª–∏–∑:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–û—Ç–ª–∞–¥–∫–∞:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- **–ê—É–¥–∏—Ç:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- **–ò—Å—Ç–æ—Ä–∏—è:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–û–±—É—á–µ–Ω–∏–µ:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—à–ª—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

**–¢–∏–ø—ã –ª–æ–≥–æ–≤:**
1. **–¢–æ—Ä–≥–æ–≤—ã–µ –ª–æ–≥–∏** - –≤—Å–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
2. **–õ–æ–≥–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
3. **–õ–æ–≥–∏ –æ—à–∏–±–æ–∫** - –≤—Å–µ –æ—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
4. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏** - —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
5. **–ê—É–¥–∏—Ç –ª–æ–≥–∏** - –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
6. **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏** - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

**–£—Ä–æ–≤–Ω–∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **INFO** - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- **WARNING** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **ERROR** - –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Ä–∞–±–æ—Ç—É
- **CRITICAL** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º –∏ –∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

**–ú–∏–Ω—É—Å—ã:**
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∏—Å–∫–æ–≤–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø—Ä–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ—Ç–∞—Ü–∏–µ–π –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ª–æ–≥–æ–≤
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# src/monitoring/logging_system.py
"""
NeoZorK 100% Logging System

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ,
—Ä–æ—Ç–∞—Ü–∏—é —Ñ–∞–π–ª–æ–≤, –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- LoggingSystem: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –¢–∏–ø—ã –ª–æ–≥–æ–≤: –¢–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—à–∏–±–∫–∏, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –§–æ—Ä–º–∞—Ç—ã: JSON, CSV, Parquet –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
- –†–æ—Ç–∞—Ü–∏—è: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: –ü–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    config = {
        'logging': {
            'log_dir': 'logs',
            'max_file_size': 10485760,  # 10MB
            'backup_count': 5,
            'formats': ['json', 'csv']
        }
    }
    
    logging_system = LoggingSystem(config)
    logging_system.log_trade({'action': 'buy', 'amount': 1000, 'price': 1.2345})
"""

import logging
import json
import pandas as pd
import gzip
import shutil
from datetime import datetime, timedelta
from pathlib import Path
from typing import Dict, List, Optional, Union, Any
import threading
import time
from dataclasses import dataclass, asdict
from enum import Enum
import hashlib
import os

class LogLevel(Enum):
    """–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
    DEBUG = "DEBUG"
    INFO = "INFO"
    WARNING = "WARNING"
    ERROR = "ERROR"
    CRITICAL = "CRITICAL"

class LogType(Enum):
    """–¢–∏–ø—ã –ª–æ–≥–æ–≤"""
    TRADE = "trade"
    PERFORMANCE = "performance"
    ERROR = "error"
    SYSTEM = "system"
    AUDIT = "audit"
    ANALYTICS = "analytics"

@dataclass
class LogEntry:
    """–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞"""
    timestamp: datetime
    level: LogLevel
    log_type: LogType
    message: str
    data: Optional[Dict] = None
    source: str = "neozork_100_percent"
    session_id: Optional[str] = None
    user_id: Optional[str] = None
    correlation_id: Optional[str] = None

class LoggingSystem:
    """
    –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è NeoZorK 100% System
    
    –≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
    —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∑–∞–ø–∏—Å—å –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π, –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –º–µ—Ç—Ä–∏–∫ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
    –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã, —Ä–æ—Ç–∞—Ü–∏—é —Ñ–∞–π–ª–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É.
    
    Attributes:
        config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        logger (logging.Logger): –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–≥–µ—Ä —Å–∏—Å—Ç–µ–º—ã
        log_dir (Path): –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
        loggers (Dict): –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–≥–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
        rotation_thread (threading.Thread): –ü–æ—Ç–æ–∫ –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
        
    Methods:
        log_trade: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        log_performance: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        log_error: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
        log_system_event: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
        get_logs: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤
        export_logs: –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
    """
    
    def __init__(self, config: Dict):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        
        Args:
            config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—é—â–∞—è:
                - logging.log_dir: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ª–æ–≥–æ–≤
                - logging.max_file_size: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ª–æ–≥–∞
                - logging.backup_count: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
                - logging.formats: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
                - logging.compression: –í–∫–ª—é—á–µ–Ω–∏–µ —Å–∂–∞—Ç–∏—è —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
        """
        self.config = config
        self.logger = logging.getLogger(__name__)
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ª–æ–≥–æ–≤
        logging_config = config.get('logging', {})
        self.log_dir = Path(logging_config.get('log_dir', 'logs'))
        self.log_dir.mkdir(exist_ok=True)
        
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–æ—Ç–∞—Ü–∏–∏
        self.max_file_size = logging_config.get('max_file_size', 10 * 1024 * 1024)  # 10MB
        self.backup_count = logging_config.get('backup_count', 5)
        self.compression_enabled = logging_config.get('compression', True)
        self.formats = logging_config.get('formats', ['json', 'csv'])
        
        # –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–≥–µ—Ä—ã
        self.loggers = {}
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        self._setup_logging()
        
        # –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏
        self.rotation_thread = threading.Thread(target=self._rotation_worker, daemon=True)
        self.rotation_thread.start()
        
        self.logger.info("LoggingSystem initialized successfully")
    
    def _setup_logging(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
        try:
            # –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–≥–µ—Ä
            main_logger = logging.getLogger('neozork_100_percent')
            main_logger.setLevel(logging.INFO)
            
            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–∞–π–ª–∞
            main_file_handler = logging.FileHandler(self.log_dir / 'neozork_100_percent.log')
            main_file_handler.setLevel(logging.INFO)
            
            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–Ω—Å–æ–ª–∏
            console_handler = logging.StreamHandler()
            console_handler.setLevel(logging.INFO)
            
            # –§–æ—Ä–º–∞—Ç—Ç–µ—Ä
            formatter = logging.Formatter(
                '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
            )
            main_file_handler.setFormatter(formatter)
            console_handler.setFormatter(formatter)
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            main_logger.addHandler(main_file_handler)
            main_logger.addHandler(console_handler)
            
            # –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–≥–µ—Ä—ã
            self._setup_specialized_loggers()
            
        except Exception as e:
            print(f"Error setting up logging: {e}")
    
    def _setup_specialized_loggers(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–æ–≤"""
        try:
            # –õ–æ–≥–≥–µ—Ä –¥–ª—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
            trade_logger = logging.getLogger('neozork_trades')
            trade_logger.setLevel(logging.INFO)
            trade_handler = logging.FileHandler(self.log_dir / 'trades.log')
            trade_handler.setLevel(logging.INFO)
            trade_handler.setFormatter(logging.Formatter('%(message)s'))
            trade_logger.addHandler(trade_handler)
            self.loggers['trade'] = trade_logger
            
            # –õ–æ–≥–≥–µ—Ä –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            perf_logger = logging.getLogger('neozork_performance')
            perf_logger.setLevel(logging.INFO)
            perf_handler = logging.FileHandler(self.log_dir / 'performance.log')
            perf_handler.setLevel(logging.INFO)
            perf_handler.setFormatter(logging.Formatter('%(message)s'))
            perf_logger.addHandler(perf_handler)
            self.loggers['performance'] = perf_logger
            
            # –õ–æ–≥–≥–µ—Ä –¥–ª—è –æ—à–∏–±–æ–∫
            error_logger = logging.getLogger('neozork_errors')
            error_logger.setLevel(logging.ERROR)
            error_handler = logging.FileHandler(self.log_dir / 'errors.log')
            error_handler.setLevel(logging.ERROR)
            error_handler.setFormatter(logging.Formatter('%(message)s'))
            error_logger.addHandler(error_handler)
            self.loggers['error'] = error_logger
            
            # –õ–æ–≥–≥–µ—Ä –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
            system_logger = logging.getLogger('neozork_system')
            system_logger.setLevel(logging.INFO)
            system_handler = logging.FileHandler(self.log_dir / 'system.log')
            system_handler.setLevel(logging.INFO)
            system_handler.setFormatter(logging.Formatter('%(message)s'))
            system_logger.addHandler(system_handler)
            self.loggers['system'] = system_logger
            
            # –õ–æ–≥–≥–µ—Ä –¥–ª—è –∞—É–¥–∏—Ç–∞
            audit_logger = logging.getLogger('neozork_audit')
            audit_logger.setLevel(logging.INFO)
            audit_handler = logging.FileHandler(self.log_dir / 'audit.log')
            audit_handler.setLevel(logging.INFO)
            audit_handler.setFormatter(logging.Formatter('%(message)s'))
            audit_logger.addHandler(audit_handler)
            self.loggers['audit'] = audit_logger
            
        except Exception as e:
            self.logger.error(f"Error setting up specialized loggers: {e}")
    
    def log_trade(self, trade: Dict):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏"""
        try:
            trade_logger = self.loggers.get('trade')
            if not trade_logger:
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
            log_entry = LogEntry(
                timestamp=datetime.now(),
                level=LogLevel.INFO,
                log_type=LogType.TRADE,
                message=f"Trade executed: {trade.get('action', 'unknown')} {trade.get('amount', 0)} at {trade.get('price', 0)}",
                data=trade,
                session_id=trade.get('session_id'),
                user_id=trade.get('user_id'),
                correlation_id=trade.get('correlation_id')
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
            log_data = asdict(log_entry)
            log_data['timestamp'] = log_entry.timestamp.isoformat()
            log_data['level'] = log_entry.level.value
            log_data['log_type'] = log_entry.log_type.value
            
            trade_logger.info(json.dumps(log_data))
            
        except Exception as e:
            self.logger.error(f"Error logging trade: {e}")
    
    def log_performance(self, performance: Dict):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        try:
            perf_logger = self.loggers.get('performance')
            if not perf_logger:
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
            log_entry = LogEntry(
                timestamp=datetime.now(),
                level=LogLevel.INFO,
                log_type=LogType.PERFORMANCE,
                message=f"Performance metrics calculated: score={performance.get('performance_score', 0):.2f}",
                data=performance,
                session_id=performance.get('session_id'),
                user_id=performance.get('user_id'),
                correlation_id=performance.get('correlation_id')
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
            log_data = asdict(log_entry)
            log_data['timestamp'] = log_entry.timestamp.isoformat()
            log_data['level'] = log_entry.level.value
            log_data['log_type'] = log_entry.log_type.value
            
            perf_logger.info(json.dumps(log_data))
            
        except Exception as e:
            self.logger.error(f"Error logging performance: {e}")
    
    def log_error(self, error: Exception, context: str = "", additional_data: Dict = None):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫"""
        try:
            error_logger = self.loggers.get('error')
            if not error_logger:
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
            log_entry = LogEntry(
                timestamp=datetime.now(),
                level=LogLevel.ERROR,
                log_type=LogType.ERROR,
                message=f"Error occurred: {str(error)}",
                data={
                    'error_type': type(error).__name__,
                    'error_message': str(error),
                    'context': context,
                    'traceback': str(error.__traceback__) if hasattr(error, '__traceback__') else None,
                    'additional_data': additional_data or {}
                }
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
            log_data = asdict(log_entry)
            log_data['timestamp'] = log_entry.timestamp.isoformat()
            log_data['level'] = log_entry.level.value
            log_data['log_type'] = log_entry.log_type.value
            
            error_logger.error(json.dumps(log_data))
            
        except Exception as e:
            self.logger.error(f"Error logging error: {e}")
    
    def log_system_event(self, event: str, data: Dict = None, level: LogLevel = LogLevel.INFO):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π"""
        try:
            system_logger = self.loggers.get('system')
            if not system_logger:
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
            log_entry = LogEntry(
                timestamp=datetime.now(),
                level=level,
                log_type=LogType.SYSTEM,
                message=f"System event: {event}",
                data=data or {},
                session_id=data.get('session_id') if data else None,
                user_id=data.get('user_id') if data else None,
                correlation_id=data.get('correlation_id') if data else None
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
            log_data = asdict(log_entry)
            log_data['timestamp'] = log_entry.timestamp.isoformat()
            log_data['level'] = log_entry.level.value
            log_data['log_type'] = log_entry.log_type.value
            
            if level == LogLevel.ERROR or level == LogLevel.CRITICAL:
                system_logger.error(json.dumps(log_data))
            else:
                system_logger.info(json.dumps(log_data))
            
        except Exception as e:
            self.logger.error(f"Error logging system event: {e}")
    
    def log_audit(self, action: str, user_id: str, data: Dict = None):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É–¥–∏—Ç–∞"""
        try:
            audit_logger = self.loggers.get('audit')
            if not audit_logger:
                return
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
            log_entry = LogEntry(
                timestamp=datetime.now(),
                level=LogLevel.INFO,
                log_type=LogType.AUDIT,
                message=f"Audit: {action} by user {user_id}",
                data=data or {},
                user_id=user_id,
                session_id=data.get('session_id') if data else None,
                correlation_id=data.get('correlation_id') if data else None
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
            log_data = asdict(log_entry)
            log_data['timestamp'] = log_entry.timestamp.isoformat()
            log_data['level'] = log_entry.level.value
            log_data['log_type'] = log_entry.log_type.value
            
            audit_logger.info(json.dumps(log_data))
            
        except Exception as e:
            self.logger.error(f"Error logging audit: {e}")
    
    def get_logs(self, log_type: str = None, start_date: datetime = None, end_date: datetime = None, 
                 level: LogLevel = None, limit: int = 1000) -> List[Dict]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
        try:
            logs = []
            
            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –ª–æ–≥–∞
            if log_type and log_type in self.loggers:
                log_file = self.log_dir / f'{log_type}.log'
            else:
                log_file = self.log_dir / 'neozork_100_percent.log'
            
            if not log_file.exists():
                return logs
            
            # –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤
            with open(log_file, 'r') as f:
                for line in f:
                    try:
                        log_entry = json.loads(line.strip())
                        
                        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ
                        if start_date or end_date:
                            log_timestamp = datetime.fromisoformat(log_entry['timestamp'])
                            
                            if start_date and log_timestamp < start_date:
                                continue
                            if end_date and log_timestamp > end_date:
                                continue
                        
                        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é
                        if level and log_entry.get('level') != level.value:
                            continue
                        
                        logs.append(log_entry)
                        
                        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
                        if len(logs) >= limit:
                            break
                        
                    except json.JSONDecodeError:
                        continue
            
            return logs
            
        except Exception as e:
            self.logger.error(f"Error getting logs: {e}")
            return []
    
    def export_logs(self, log_type: str = None, start_date: datetime = None, end_date: datetime = None, 
                   format: str = 'json') -> str:
        """–≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö"""
        try:
            logs = self.get_logs(log_type, start_date, end_date)
            
            if format == 'json':
                return json.dumps(logs, indent=2, default=str)
            elif format == 'csv':
                if not logs:
                    return ""
                df = pd.DataFrame(logs)
                return df.to_csv(index=False)
            elif format == 'parquet':
                if not logs:
                    return ""
                df = pd.DataFrame(logs)
                return df.to_parquet(index=False)
            else:
                return str(logs)
                
        except Exception as e:
            self.logger.error(f"Error exporting logs: {e}")
            return ""
    
    def _rotation_worker(self):
        """–ü–æ—Ç–æ–∫ –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤"""
        while True:
            try:
                self._rotate_logs()
                time.sleep(3600)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
            except Exception as e:
                self.logger.error(f"Error in rotation worker: {e}")
                time.sleep(3600)
    
    def _rotate_logs(self):
        """–†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤"""
        try:
            for log_file in self.log_dir.glob('*.log'):
                if log_file.stat().st_size > self.max_file_size:
                    self._rotate_file(log_file)
                    
        except Exception as e:
            self.logger.error(f"Error rotating logs: {e}")
    
    def _rotate_file(self, log_file: Path):
        """–†–æ—Ç–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ª–æ–≥–∞"""
        try:
            # –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
            for i in range(self.backup_count - 1, 0, -1):
                old_file = log_file.with_suffix(f'.log.{i}')
                new_file = log_file.with_suffix(f'.log.{i + 1}')
                
                if old_file.exists():
                    if i == self.backup_count - 1:
                        old_file.unlink()  # –£–¥–∞–ª—è–µ–º —Å–∞–º—É—é —Å—Ç–∞—Ä—É—é –∫–æ–ø–∏—é
                    else:
                        old_file.rename(new_file)
            
            # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
            backup_file = log_file.with_suffix('.log.1')
            log_file.rename(backup_file)
            
            # –°–∂–∞—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
            if self.compression_enabled:
                compressed_file = backup_file.with_suffix('.log.1.gz')
                with open(backup_file, 'rb') as f_in:
                    with gzip.open(compressed_file, 'wb') as f_out:
                        shutil.copyfileobj(f_in, f_out)
                backup_file.unlink()
            
            self.logger.info(f"Log file rotated: {log_file.name}")
            
        except Exception as e:
            self.logger.error(f"Error rotating file {log_file}: {e}")
    
    def get_log_statistics(self, hours: int = 24) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ª–æ–≥–∞–º"""
        try:
            cutoff_time = datetime.now() - timedelta(hours=hours)
            logs = self.get_logs(start_date=cutoff_time, limit=10000)
            
            stats = {
                'total_logs': len(logs),
                'by_type': {},
                'by_level': {},
                'error_rate': 0.0,
                'most_common_errors': []
            }
            
            error_count = 0
            error_messages = {}
            
            for log in logs:
                # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º
                log_type = log.get('log_type', 'unknown')
                stats['by_type'][log_type] = stats['by_type'].get(log_type, 0) + 1
                
                # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º
                level = log.get('level', 'unknown')
                stats['by_level'][level] = stats['by_level'].get(level, 0) + 1
                
                # –ü–æ–¥—Å—á–µ—Ç –æ—à–∏–±–æ–∫
                if level in ['ERROR', 'CRITICAL']:
                    error_count += 1
                    error_msg = log.get('message', 'Unknown error')
                    error_messages[error_msg] = error_messages.get(error_msg, 0) + 1
            
            # –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—à–∏–±–æ–∫
            if logs:
                stats['error_rate'] = (error_count / len(logs)) * 100
            
            # –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏
            stats['most_common_errors'] = sorted(
                error_messages.items(), 
                key=lambda x: x[1], 
                reverse=True
            )[:5]
            
            return stats
            
        except Exception as e:
            self.logger.error(f"Error getting log statistics: {e}")
            return {}


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
if __name__ == "__main__":
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    """
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    config = {
        'logging': {
            'log_dir': 'logs',
            'max_file_size': 1024 * 1024,  # 1MB –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            'backup_count': 3,
            'compression': True,
            'formats': ['json', 'csv', 'parquet']
        }
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    logging_system = LoggingSystem(config)
    
    print("=== NeoZorK 100% Logging System ===")
    print("Testing logging system...")
    print()
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    print("üìù TESTING LOG TYPES:")
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    for i in range(5):
        trade_data = {
            'action': 'buy' if i % 2 == 0 else 'sell',
            'amount': 1000 + i * 100,
            'price': 1.2345 + i * 0.001,
            'session_id': f'session_{i}',
            'user_id': f'user_{i % 3}',
            'correlation_id': f'corr_{i}'
        }
        logging_system.log_trade(trade_data)
        print(f"   Trade logged: {trade_data['action']} {trade_data['amount']} at {trade_data['price']}")
    
    print()
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    for i in range(3):
        performance_data = {
            'performance_score': 0.7 + i * 0.1,
            'total_return': 0.15 + i * 0.05,
            'sharpe_ratio': 1.5 + i * 0.2,
            'session_id': f'perf_session_{i}',
            'user_id': f'user_{i % 3}'
        }
        logging_system.log_performance(performance_data)
        print(f"   Performance logged: score={performance_data['performance_score']:.2f}")
    
    print()
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
    try:
        raise ValueError("Test error for logging demonstration")
    except Exception as e:
        logging_system.log_error(e, "Testing error logging", {'test_data': 'error_test'})
        print(f"   Error logged: {str(e)}")
    
    print()
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    system_events = [
        ("System startup", {"version": "1.0.0", "environment": "production"}),
        ("Database connection established", {"host": "localhost", "port": 5432}),
        ("Configuration loaded", {"config_file": "config.yaml"})
    ]
    
    for event, data in system_events:
        logging_system.log_system_event(event, data)
        print(f"   System event logged: {event}")
    
    print()
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É–¥–∏—Ç–∞
    audit_actions = [
        ("User login", "user_1", {"ip": "192.168.1.100", "user_agent": "Mozilla/5.0"}),
        ("Configuration change", "admin_1", {"setting": "max_drawdown", "old_value": 0.2, "new_value": 0.15}),
        ("Trade execution", "user_2", {"trade_id": "trade_123", "amount": 5000})
    ]
    
    for action, user_id, data in audit_actions:
        logging_system.log_audit(action, user_id, data)
        print(f"   Audit logged: {action} by {user_id}")
    
    print()
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
    print("üìä LOG ANALYSIS:")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
    all_logs = logging_system.get_logs(limit=100)
    print(f"Total logs retrieved: {len(all_logs)}")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–æ —Ç–∏–ø–∞–º
    trade_logs = logging_system.get_logs(log_type='trade', limit=50)
    print(f"Trade logs: {len(trade_logs)}")
    
    performance_logs = logging_system.get_logs(log_type='performance', limit=50)
    print(f"Performance logs: {len(performance_logs)}")
    
    error_logs = logging_system.get_logs(log_type='error', limit=50)
    print(f"Error logs: {len(error_logs)}")
    
    print()
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ª–æ–≥–æ–≤
    print("üìà LOG STATISTICS:")
    stats = logging_system.get_log_statistics(hours=1)
    print(f"Total logs: {stats.get('total_logs', 0)}")
    print(f"By type: {stats.get('by_type', {})}")
    print(f"By level: {stats.get('by_level', {})}")
    print(f"Error rate: {stats.get('error_rate', 0):.1f}%")
    print(f"Most common errors: {stats.get('most_common_errors', [])}")
    
    print()
    
    # –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
    print("üìã EXPORTING LOGS:")
    
    # –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
    json_export = logging_system.export_logs(format='json')
    print(f"JSON export: {len(json_export)} characters")
    
    # –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
    csv_export = logging_system.export_logs(format='csv')
    print(f"CSV export: {len(csv_export)} characters")
    
    print()
    print("‚úÖ Logging system testing completed successfully!")
    print(f"Logs saved to: {logging_system.log_dir.absolute()}")

```

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–¢–µ–æ—Ä–∏—è:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–∏—Å—Ç–µ–º—É –∞–ª–µ—Ä—Ç–æ–≤ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –µ–¥–∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

1. **–ï–¥–∏–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. **–û–±—â–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–∏—Å—Ç–µ–º—ã
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **–°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- **–í—ã—Å–æ–∫–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å** - —Ç–µ—Å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```python
# src/monitoring/integrated_monitoring.py
"""
NeoZorK 100% Integrated Monitoring System

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
–¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü. –°–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏,
—Å–∏—Å—Ç–µ–º—É –∞–ª–µ—Ä—Ç–æ–≤ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –µ–¥–∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- IntegratedMonitoringSystem: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–æ–π
- PerformanceMonitor: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- AlertManager: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏
- LoggingSystem: –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- Dashboard: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    config = {
        'monitoring': {...},
        'alerts': {...},
        'logging': {...}
    }
    
    monitoring_system = IntegratedMonitoringSystem(config)
    monitoring_system.start_monitoring()
"""

import asyncio
import threading
import time
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Any
import logging
from pathlib import Path

# –ò–º–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
from .performance import PerformanceMonitor
from .alerts import AlertManager
from .logging_system import LoggingSystem

class IntegratedMonitoringSystem:
    """
    –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    
    –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ –µ–¥–∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É,
    –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∞–ª–µ—Ä—Ç–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
    
    Attributes:
        config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        performance_monitor (PerformanceMonitor): –ú–æ–Ω–∏—Ç–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        alert_manager (AlertManager): –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤
        logging_system (LoggingSystem): –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        is_running (bool): –°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
        monitoring_thread (threading.Thread): –ü–æ—Ç–æ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        
    Methods:
        start_monitoring: –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        stop_monitoring: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        update_metrics: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        process_alerts: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
        generate_dashboard: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞
    """
    
    def __init__(self, config: Dict):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        
        Args:
            config (Dict): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—é—â–∞—è:
                - monitoring: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                - alerts: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤
                - logging: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        """
        self.config = config
        self.logger = logging.getLogger(__name__)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self.performance_monitor = PerformanceMonitor(config)
        self.alert_manager = AlertManager(config)
        self.logging_system = LoggingSystem(config)
        
        # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
        self.is_running = False
        self.monitoring_thread = None
        
        # –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
        self.current_positions = []
        self.current_balance = 10000.0
        self.initial_balance = 10000.0
        
        self.logger.info("IntegratedMonitoringSystem initialized successfully")
    
    def start_monitoring(self):
        """–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
        try:
            if self.is_running:
                self.logger.warning("Monitoring system is already running")
                return
            
            self.is_running = True
            self.monitoring_thread = threading.Thread(target=self._monitoring_loop, daemon=True)
            self.monitoring_thread.start()
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞
            self.logging_system.log_system_event(
                "Integrated monitoring system started",
                {"config": self.config},
                level=LogLevel.INFO
            )
            
            self.logger.info("Integrated monitoring system started successfully")
            
        except Exception as e:
            self.logger.error(f"Error starting monitoring system: {e}")
            self.logging_system.log_error(e, "Failed to start monitoring system")
    
    def stop_monitoring(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
        try:
            if not self.is_running:
                self.logger.warning("Monitoring system is not running")
                return
            
            self.is_running = False
            
            if self.monitoring_thread:
                self.monitoring_thread.join(timeout=5)
            
            # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            self.alert_manager.stop_escalation()
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
            self.logging_system.log_system_event(
                "Integrated monitoring system stopped",
                {},
                level=LogLevel.INFO
            )
            
            self.logger.info("Integrated monitoring system stopped successfully")
            
        except Exception as e:
            self.logger.error(f"Error stopping monitoring system: {e}")
            self.logging_system.log_error(e, "Failed to stop monitoring system")
    
    def _monitoring_loop(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
        while self.is_running:
            try:
                # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                self.update_metrics()
                
                # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
                self.process_alerts()
                
                # –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏
                time.sleep(60)  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                
            except Exception as e:
                self.logger.error(f"Error in monitoring loop: {e}")
                self.logging_system.log_error(e, "Error in monitoring loop")
                time.sleep(60)
    
    def update_metrics(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        try:
            # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
            metrics = self.performance_monitor.calculate_metrics(
                self.current_positions,
                self.current_balance,
                self.initial_balance
            )
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
            self.logging_system.log_performance(metrics)
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
            alerts = self.performance_monitor.check_alerts(metrics)
            for alert in alerts:
                self.alert_manager.send_alert(alert)
            
        except Exception as e:
            self.logger.error(f"Error updating metrics: {e}")
            self.logging_system.log_error(e, "Failed to update metrics")
    
    def process_alerts(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤"""
        try:
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
            alert_stats = self.alert_manager.get_alert_statistics(hours=1)
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
            self.logging_system.log_system_event(
                "Alert statistics updated",
                alert_stats,
                level=LogLevel.INFO
            )
            
        except Exception as e:
            self.logger.error(f"Error processing alerts: {e}")
            self.logging_system.log_error(e, "Failed to process alerts")
    
    def add_trade(self, trade: Dict):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏"""
        try:
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏
            trade['timestamp'] = datetime.now()
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π
            self.current_positions.append(trade)
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
            pnl = trade.get('pnl', 0)
            self.current_balance += pnl
            
            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
            self.logging_system.log_trade(trade)
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –æ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
            if abs(pnl) > 1000:  # –ë–æ–ª—å—à–∏–µ —Å–¥–µ–ª–∫–∏
                self.alert_manager.send_trade_alert(trade)
            
        except Exception as e:
            self.logger.error(f"Error adding trade: {e}")
            self.logging_system.log_error(e, "Failed to add trade")
    
    def generate_dashboard(self) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"""
        try:
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –º–µ—Ç—Ä–∏–∫
            metrics = self.performance_monitor.calculate_metrics(
                self.current_positions,
                self.current_balance,
                self.initial_balance
            )
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
            alert_stats = self.alert_manager.get_alert_statistics(hours=24)
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ª–æ–≥–æ–≤
            log_stats = self.logging_system.get_log_statistics(hours=24)
            
            # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞
            dashboard = {
                'timestamp': datetime.now().isoformat(),
                'system_status': 'running' if self.is_running else 'stopped',
                'performance_metrics': metrics,
                'alert_statistics': alert_stats,
                'log_statistics': log_stats,
                'trading_summary': {
                    'total_trades': len(self.current_positions),
                    'current_balance': self.current_balance,
                    'initial_balance': self.initial_balance,
                    'total_pnl': self.current_balance - self.initial_balance
                }
            }
            
            return dashboard
            
        except Exception as e:
            self.logger.error(f"Error generating dashboard: {e}")
            self.logging_system.log_error(e, "Failed to generate dashboard")
            return {}
    
    def get_system_health(self) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã"""
        try:
            health = {
                'timestamp': datetime.now().isoformat(),
                'overall_status': 'healthy',
                'components': {
                    'performance_monitor': 'healthy',
                    'alert_manager': 'healthy',
                    'logging_system': 'healthy'
                },
                'metrics': {
                    'uptime': self._calculate_uptime(),
                    'error_rate': self._calculate_error_rate(),
                    'alert_rate': self._calculate_alert_rate()
                }
            }
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            if not self.performance_monitor:
                health['components']['performance_monitor'] = 'unhealthy'
                health['overall_status'] = 'degraded'
            
            if not self.alert_manager:
                health['components']['alert_manager'] = 'unhealthy'
                health['overall_status'] = 'degraded'
            
            if not self.logging_system:
                health['components']['logging_system'] = 'unhealthy'
                health['overall_status'] = 'degraded'
            
            return health
            
        except Exception as e:
            self.logger.error(f"Error getting system health: {e}")
            return {'overall_status': 'unhealthy', 'error': str(e)}
    
    def _calculate_uptime(self) -> float:
        """–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã"""
        # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç - –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
        return 99.9
    
    def _calculate_error_rate(self) -> float:
        """–†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—à–∏–±–æ–∫"""
        try:
            log_stats = self.logging_system.get_log_statistics(hours=1)
            return log_stats.get('error_rate', 0.0)
        except:
            return 0.0
    
    def _calculate_alert_rate(self) -> float:
        """–†–∞—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç—ã –∞–ª–µ—Ä—Ç–æ–≤"""
        try:
            alert_stats = self.alert_manager.get_alert_statistics(hours=1)
            total_alerts = alert_stats.get('total_alerts', 0)
            return total_alerts / 60.0  # –ê–ª–µ—Ä—Ç–æ–≤ –≤ –º–∏–Ω—É—Ç—É
        except:
            return 0.0


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
if __name__ == "__main__":
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü
    """
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
    config = {
        'monitoring': {
            'monthly_target': 1.0,
            'daily_target': 0.033,
            'risk_limits': {
                'max_drawdown': 0.2,
                'min_sharpe': 1.0,
                'min_win_rate': 0.5
            }
        },
        'alerts': {
            'email': {'enabled': False},
            'telegram': {'enabled': False},
            'discord': {'enabled': False}
        },
        'logging': {
            'log_dir': 'logs',
            'max_file_size': 1024 * 1024,
            'backup_count': 3,
            'compression': True
        }
    }
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    monitoring_system = IntegratedMonitoringSystem(config)
    
    print("=== NeoZorK 100% Integrated Monitoring System ===")
    print("Starting integrated monitoring system...")
    print()
    
    # –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    monitoring_system.start_monitoring()
    
    # –°–∏–º—É–ª—è—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    print("üìà SIMULATING TRADING OPERATIONS:")
    import random
    
    for i in range(10):
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
        trade = {
            'action': 'buy' if i % 2 == 0 else 'sell',
            'amount': random.uniform(100, 1000),
            'price': random.uniform(1.2, 1.3),
            'pnl': random.gauss(50, 30),  # –°–ª—É—á–∞–π–Ω—ã–π PnL
            'session_id': f'session_{i}',
            'user_id': f'user_{i % 3}'
        }
        
        monitoring_system.add_trade(trade)
        print(f"   Trade {i+1}: {trade['action']} {trade['amount']:.2f} at {trade['price']:.4f} (PnL: {trade['pnl']:.2f})")
    
    print()
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –¥–ª—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    print("‚è≥ Waiting for data accumulation...")
    time.sleep(5)
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞
    print("üìä GENERATING DASHBOARD:")
    dashboard = monitoring_system.generate_dashboard()
    
    print(f"System Status: {dashboard.get('system_status', 'unknown')}")
    print(f"Total Trades: {dashboard.get('trading_summary', {}).get('total_trades', 0)}")
    print(f"Current Balance: ${dashboard.get('trading_summary', {}).get('current_balance', 0):,.2f}")
    print(f"Total PnL: ${dashboard.get('trading_summary', {}).get('total_pnl', 0):,.2f}")
    
    performance_metrics = dashboard.get('performance_metrics', {})
    print(f"Performance Score: {performance_metrics.get('performance_score', 0):.2f}")
    print(f"Total Return: {performance_metrics.get('total_return', 0):.2%}")
    print(f"Sharpe Ratio: {performance_metrics.get('sharpe_ratio', 0):.2f}")
    
    print()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
    print("üè• SYSTEM HEALTH CHECK:")
    health = monitoring_system.get_system_health()
    print(f"Overall Status: {health.get('overall_status', 'unknown')}")
    print(f"Uptime: {health.get('metrics', {}).get('uptime', 0):.1f}%")
    print(f"Error Rate: {health.get('metrics', {}).get('error_rate', 0):.1f}%")
    print(f"Alert Rate: {health.get('metrics', {}).get('alert_rate', 0):.2f} alerts/min")
    
    print()
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    print("üõë STOPPING MONITORING SYSTEM:")
    monitoring_system.stop_monitoring()
    
    print("‚úÖ Integrated monitoring system demonstration completed successfully!")
    print("All components (performance monitoring, alerts, logging) are working together!")

```

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**
–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â—É—é –ø–æ–ª–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫
2. **–°–∏—Å—Ç–µ–º—É –∞–ª–µ—Ä—Ç–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
3. **–°–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** - –µ–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.
