# 08. üé≤ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è

**–¶–µ–ª—å:** –ù–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—é –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤ –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π.

## –ß—Ç–æ —Ç–∞–∫–æ–µ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è?

**–¢–µ–æ—Ä–∏—è:** –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è - —ç—Ç–æ –º–æ—â–Ω—ã–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏. –í —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ñ–µ—Ä–µ –æ–Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–Ω–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–∞.

**–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è** - —ç—Ç–æ –º–µ—Ç–æ–¥ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏.

**–ü–æ—á–µ–º—É –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º:**
- **–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Ä–∏—Å–∫–æ–≤
- **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞:** –ü–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π
- **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:** –û—Ü–µ–Ω–∏–≤–∞–µ—Ç —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è?

**–¢–µ–æ—Ä–∏—è:** –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è —Ä–µ—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å—é –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é —Ä—ã–Ω–æ—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –û–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∏—Å–∫–æ–≤ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

- **–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤** - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
  - **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä—ã–Ω–∫–∏ –ø–æ–ª–Ω—ã –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω–∏–º–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
  - **–ü–ª—é—Å—ã:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏
  - **–ú–∏–Ω—É—Å—ã:** –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ–π –≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

- **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π
  - **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–æ–º –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –≤—ã–∂–∏–≤–∞–Ω–∏—è –Ω–∞ —Ä—ã–Ω–∫–µ
  - **–ü–ª—é—Å—ã:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π, —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤
  - **–ú–∏–Ω—É—Å—ã:** –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

- **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
  - **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –†—ã–Ω–∫–∏ –º–æ–≥—É—Ç –∏—Å–ø—ã—Ç—ã–≤–∞—Ç—å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
  - **–ü–ª—é—Å—ã:** –í—ã—è–≤–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∫—Ä–∏–∑–∏—Å–∞–º
  - **–ú–∏–Ω—É—Å—ã:** –ú–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —Ö—É–¥—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏
  - **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
  - **–ü–ª—é—Å—ã:** –û—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
  - **–ú–∏–Ω—É—Å—ã:** –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏:**
- **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–Ω–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:** –î–∞–µ—Ç —Ç–æ—á–Ω—ã–µ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–≥–ª—è–¥–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ä–∏—Å–∫–∏

## –û—Å–Ω–æ–≤—ã –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏

**–¢–µ–æ—Ä–∏—è:** –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏. –í —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ñ–µ—Ä–µ —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∏—Å–∫–æ–≤ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

### 1. –ü—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è

**–¢–µ–æ—Ä–∏—è:** –ü—Ä–æ—Å—Ç–∞—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π. –≠—Ç–æ –±–∞–∑–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è —É—á–µ—Ç–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –ø—Ä–æ—Å—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** R ~ N(Œº, œÉ¬≤), –≥–¥–µ Œº - —Å—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, œÉ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- **–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å:** C = ‚àè(1 + R_i) - 1, –≥–¥–µ R_i - –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ i
- **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞:** –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É
- **–ó–∞–∫–æ–Ω –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª:** –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–π —Å—Ö–æ–¥–∏—Ç—Å—è –∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –æ–∂–∏–¥–∞–Ω–∏—é

**–ü–æ—á–µ–º—É –ø—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –≤–∞–∂–Ω–∞:**
- **–ë–∞–∑–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:** –°–ª—É–∂–∏—Ç –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- **–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **–ë—ã—Å—Ç—Ä–æ—Ç–∞:** –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∞–∂–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ—Å—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**
1. **–û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –í—ã—á–∏—Å–ª—è–µ–º Œº –∏ œÉ –∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª:** –°–æ–∑–¥–∞–µ–º n_simulations –Ω–∞–±–æ—Ä–æ–≤ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
3. **–†–∞—Å—á–µ—Ç –ø—É—Ç–µ–π:** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—ã—á–∏—Å–ª—è–µ–º –∫—É–º—É–ª—è—Ç–∏–≤–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
4. **–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:** –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü–ª—é—Å—ã –ø—Ä–æ—Å—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–∂–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –•–æ—Ä–æ—à–∞—è –±–∞–∑–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å
- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã –ø—Ä–æ—Å—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –ú–æ–∂–µ—Ç –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–µ—Ä–∏–æ–¥–∞–º–∏
- –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å –≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–æ—Å—Ç–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**

–ö–æ–¥ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—é –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç —á–µ—Ç–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

```python
import numpy as np
import pandas as pd
from scipy import stats
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings('ignore')

def monte_carlo_simulation(returns, n_simulations=10000, time_horizon=252):
    """
    –ü—Ä–æ—Å—Ç–∞—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –±–∞–∑–æ–≤—É—é –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π. –û–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç n_simulations –ø—É—Ç–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - –ö–∞–∂–¥—ã–π –ø—É—Ç—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ time_horizon –ø–µ—Ä–∏–æ–¥–æ–≤
    - –î–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ R ~ N(Œº, œÉ¬≤)
    - –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: C = ‚àè(1 + R_i) - 1
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252 - —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - numpy array —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π
    """
    
    # –®–∞–≥ 1: –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    # –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ - –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–∏
    mean_return = returns.mean()
    std_return = returns.std()
    
    print(f"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏:")
    print(f"  –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {mean_return:.4f} ({mean_return*100:.2f}%)")
    print(f"  –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {std_return:.4f} ({std_return*100:.2f}%)")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    
    # –®–∞–≥ 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    simulation_results = []
    
    # –®–∞–≥ 3: –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å–∏–º—É–ª—è—Ü–∏–∏
    for i in range(n_simulations):
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—É—Ç–∏
        # np.random.normal –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞
        random_returns = np.random.normal(mean_return, std_return, time_horizon)
        
        # –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—É—Ç–∏
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É: (1 + r1) * (1 + r2) * ... * (1 + rn) - 1
        cumulative_return = np.prod(1 + random_returns) - 1
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        simulation_results.append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–∏–º—É–ª—è—Ü–∏–π
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    print(f"–°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(simulation_results):,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    return np.array(simulation_results)

def analyze_simulation_results(results):
    """
    –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏. –û–Ω–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å —Ä–∏—Å–∫–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.
    
    –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
    - –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å—Ä–µ–¥–Ω–µ–µ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
    - –ö–≤–∞–Ω—Ç–∏–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (5%, 25%, 50%, 75%, 95%)
    - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    - –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫)
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - results: –º–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
    """
    
    print("–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏:")
    print(f"  –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: {len(results):,}")
    
    # –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
    mean_return = np.mean(results)
    std_return = np.std(results)
    
    # –ö–≤–∞–Ω—Ç–∏–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤
    percentiles = [5, 25, 50, 75, 95]
    percentile_values = {f'percentile_{p}': np.percentile(results, p) for p in percentiles}
    
    # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    probability_positive = np.mean(results > 0)
    probability_loss = np.mean(results < 0)
    
    # –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    max_loss = np.min(results)
    max_gain = np.max(results)
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
    skewness = stats.skew(results)  # –ê—Å–∏–º–º–µ—Ç—Ä–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    kurtosis = stats.kurtosis(results)  # –≠–∫—Å—Ü–µ—Å—Å (–æ—Å—Ç—Ä–æ–≤–µ—Ä—à–∏–Ω–Ω–æ—Å—Ç—å)
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
    coefficient_of_variation = std_return / abs(mean_return) if mean_return != 0 else np.inf
    
    print(f"  –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {mean_return:.4f} ({mean_return*100:.2f}%)")
    print(f"  –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {std_return:.4f} ({std_return*100:.2f}%)")
    print(f"  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏: {coefficient_of_variation:.2f}")
    print(f"  –ê—Å–∏–º–º–µ—Ç—Ä–∏—è: {skewness:.4f}")
    print(f"  –≠–∫—Å—Ü–µ—Å—Å: {kurtosis:.4f}")
    print(f"  –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã–ª–∏: {probability_positive:.2%}")
    print(f"  –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–±—ã—Ç–∫–∞: {probability_loss:.2%}")
    print(f"  –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å: {max_gain:.4f} ({max_gain*100:.2f}%)")
    print(f"  –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫: {max_loss:.4f} ({max_loss*100:.2f}%)")
    
    return {
        'mean_return': mean_return,
        'std_return': std_return,
        'coefficient_of_variation': coefficient_of_variation,
        'skewness': skewness,
        'kurtosis': kurtosis,
        **percentile_values,
        'probability_positive': probability_positive,
        'probability_loss': probability_loss,
        'max_loss': max_loss,
        'max_gain': max_gain
    }
```

### 2. Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è

**–¢–µ–æ—Ä–∏—è:** Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø—É—Ç–µ–º —Å–ª—É—á–∞–π–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º. –≠—Ç–æ –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã Bootstrap:**
- **–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** FÃÇ(x) = (1/n)‚àëI(X_i ‚â§ x), –≥–¥–µ I - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- **Bootstrap –≤—ã–±–æ—Ä–∫–∞:** X* = {X*_1, X*_2, ..., X*_n} ~ FÃÇ (–≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º)
- **Bootstrap –æ—Ü–µ–Ω–∫–∞:** Œ∏ÃÇ* = T(X*) - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –Ω–∞ bootstrap –≤—ã–±–æ—Ä–∫–µ
- **Bootstrap —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Œ∏ÃÇ* –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö bootstrap –≤—ã–±–æ—Ä–∫–∞—Ö

**–ü–æ—á–µ–º—É Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –≤–∞–∂–Ω–∞:**
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö
- **–ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
- **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
- **–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å:** –ú–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ –∞–Ω–æ–º–∞–ª–∏—è–º

**–ê–ª–≥–æ—Ä–∏—Ç–º Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:** –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
2. **Bootstrap –≤—ã–±–æ—Ä–∫–∞:** –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º –∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É—Ç–∏:** –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞ –∏–∑ bootstrap –≤—ã–±–æ—Ä–∫–∏
4. **–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–≥–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
5. **–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:** –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

**–ü–ª—é—Å—ã Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
- –ì–∏–±–∫–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –∞–∫—Ç–∏–≤–æ–≤
- –£—á–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –ú–µ–Ω—å—à–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º

**–ú–∏–Ω—É—Å—ã Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –ø—Ä–∏ –º–∞–ª–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ú–æ–∂–µ—Ç –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä—ã–Ω–∫–µ
**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**

Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞.

```python
def bootstrap_monte_carlo(returns, n_simulations=10000, time_horizon=252):
    """
    Bootstrap –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç bootstrap –ø–æ–¥—Ö–æ–¥ –∫ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è
    –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ
    –ø–æ–¥—Ö–æ–¥–∞, bootstrap —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ FÃÇ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ
    - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç bootstrap –≤—ã–±–æ—Ä–∫–∏: X* ~ FÃÇ (–≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º)
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ —Ç–∏–ø–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Bootstrap:
    - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    - –ù–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
    - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    - –†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å: –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - numpy array —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ bootstrap —Å–∏–º—É–ª—è—Ü–∏–π
    """
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    if len(returns) == 0:
        raise ValueError("–ú–∞—Å—Å–∏–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
    
    if len(returns) < time_horizon:
        print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –î–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö ({len(returns)}) –º–µ–Ω—å—à–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ({time_horizon})")
        print("–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤—Å—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö")
        time_horizon = len(returns)
    
    print(f"Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è:")
    print(f"  –†–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {len(returns):,}")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    print(f"  –†–∞–∑–º–µ—Ä bootstrap –≤—ã–±–æ—Ä–∫–∏: {time_horizon}")
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    simulation_results = []
    
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏
    for i in range(n_simulations):
        # –®–∞–≥ 1: Bootstrap –≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
        # np.random.choice —Å replace=True —Å–æ–∑–¥–∞–µ—Ç –≤—ã–±–æ—Ä–∫—É —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
        # –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—é –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
        bootstrap_returns = np.random.choice(returns, size=time_horizon, replace=True)
        
        # –®–∞–≥ 2: –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è bootstrap –ø—É—Ç–∏
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ —Ñ–æ—Ä–º—É–ª—É: (1 + r1) * (1 + r2) * ... * (1 + rn) - 1
        cumulative_return = np.prod(1 + bootstrap_returns) - 1
        
        # –®–∞–≥ 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        simulation_results.append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ bootstrap —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    print(f"Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(simulation_results):,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è bootstrap –ø—Ä–æ—Ü–µ—Å—Å–∞
    bootstrap_results = np.array(simulation_results)
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ bootstrap —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:")
    print(f"    –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.mean(bootstrap_results):.4f} ({np.mean(bootstrap_results)*100:.2f}%)")
    print(f"    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {np.std(bootstrap_results):.4f} ({np.std(bootstrap_results)*100:.2f}%)")
    print(f"    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.min(bootstrap_results):.4f} ({np.min(bootstrap_results)*100:.2f}%)")
    print(f"    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.max(bootstrap_results):.4f} ({np.max(bootstrap_results)*100:.2f}%)")
    
    return bootstrap_results

def compare_simulation_methods(returns, n_simulations=5000):
    """
    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç—É—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é —Å–∏–º—É–ª—è—Ü–∏—é —Å bootstrap –º–µ—Ç–æ–¥–æ–º,
    –ø–æ–∫–∞–∑—ã–≤–∞—è —Ä–∞–∑–ª–∏—á–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∏ –∏—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤
    """
    
    print("=== –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ ===")
    
    # –ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n1. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è (–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ):")
    parametric_results = monte_carlo_simulation(returns, n_simulations)
    parametric_analysis = analyze_simulation_results(parametric_results)
    
    # Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n2. Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è (—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ):")
    bootstrap_results = bootstrap_monte_carlo(returns, n_simulations)
    bootstrap_analysis = analyze_simulation_results(bootstrap_results)
    
    # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    print("\n=== –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ===")
    print(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏: {bootstrap_analysis['mean_return'] - parametric_analysis['mean_return']:.4f}")
    print(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏: {bootstrap_analysis['std_return'] - parametric_analysis['std_return']:.4f}")
    print(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ 5% –∫–≤–∞–Ω—Ç–∏–ª–µ: {bootstrap_analysis['percentile_5'] - parametric_analysis['percentile_5']:.4f}")
    print(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ 95% –∫–≤–∞–Ω—Ç–∏–ª–µ: {bootstrap_analysis['percentile_95'] - parametric_analysis['percentile_95']:.4f}")
    
    return {
        'parametric': {
            'results': parametric_results,
            'analysis': parametric_analysis
        },
        'bootstrap': {
            'results': bootstrap_results,
            'analysis': bootstrap_analysis
        }
    }
```

### 3. Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è

**–¢–µ–æ—Ä–∏—è:** Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è —Ä–∞—Å—à–∏—Ä—è–µ—Ç –æ–±—ã—á–Ω—ã–π Bootstrap, —É—á–∏—Ç—ã–≤–∞—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —á—Ç–æ –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã Block Bootstrap:**
- **–ë–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:** B_i = {X_{i}, X_{i+1}, ..., X_{i+l-1}} –≥–¥–µ l - —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
- **Block Bootstrap –≤—ã–±–æ—Ä–∫–∞:** –í—ã–±–æ—Ä–∫–∞ –±–ª–æ–∫–æ–≤ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:** –í–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è:** œÅ(k) = E[(X_t - Œº)(X_{t+k} - Œº)] / œÉ¬≤

**–ü–æ—á–µ–º—É Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –≤–∞–∂–Ω–∞:**
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –£—á–∏—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–∞–Ω–Ω—ã—Ö
- **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –ø–æ–¥ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–£—á–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (GARCH —ç—Ñ—Ñ–µ–∫—Ç—ã)

**–ê–ª–≥–æ—Ä–∏—Ç–º Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. **–°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –±–ª–æ–∫–∏
3. **Bootstrap –≤—ã–±–æ—Ä–∫–∞ –±–ª–æ–∫–æ–≤:** –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –±–ª–æ–∫–æ–≤ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
4. **–°–±–æ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞:** –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤ –Ω–æ–≤—ã–π —Ä—è–¥
5. **–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

**–ü–ª—é—Å—ã Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–æ–≤
- –£—á–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤

**–ú–∏–Ω—É—Å—ã Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –¢—Ä–µ–±—É–µ—Ç –≤—ã–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–æ–≤
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- –í—ã—Å–æ–∫–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –í–æ–∑–º–æ–∂–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –±–ª–æ–∫–æ–≤
**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏:**

Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –±–ª–æ–∫–∏ –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.

```python
def block_bootstrap_monte_carlo(returns, n_simulations=10000, time_horizon=252, block_size=5):
    """
    Block Bootstrap –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç Block Bootstrap –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ
    –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –í–º–µ—Å—Ç–æ –≤—ã–±–æ—Ä–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,
    –º–µ—Ç–æ–¥ –≤—ã–±–∏—Ä–∞–µ—Ç –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ö—Ä–∞–Ω—è—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - –ë–ª–æ–∫–∏: B_i = {X_i, X_{i+1}, ..., X_{i+l-1}} –≥–¥–µ l = block_size
    - Block Bootstrap: –í—ã–±–æ—Ä–∫–∞ –±–ª–æ–∫–æ–≤ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
    - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: –í–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    - –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è: œÅ(k) = E[(X_t - Œº)(X_{t+k} - Œº)] / œÉ¬≤
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Block Bootstrap:
    - –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    - –£—á–µ—Ç GARCH —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252)
    - block_size: —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - numpy array —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ block bootstrap —Å–∏–º—É–ª—è—Ü–∏–π
    """
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    if len(returns) == 0:
        raise ValueError("–ú–∞—Å—Å–∏–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
    
    if len(returns) < block_size:
        print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö ({len(returns)}) –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞ ({block_size})")
        print("–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ —Ä–∞–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä—É –¥–∞–Ω–Ω—ã—Ö")
        block_size = len(returns)
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    if block_size is None or block_size <= 0:
        # –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
        autocorr = pd.Series(returns).autocorr(lag=1)
        if not np.isnan(autocorr):
            # –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ: —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ = 1 / (1 - –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)
            suggested_block_size = max(1, int(1 / (1 - abs(autocorr))))
            block_size = min(suggested_block_size, len(returns) // 4)
        else:
            block_size = 5
    
    print(f"Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è:")
    print(f"  –†–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {len(returns):,}")
    print(f"  –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: {block_size}")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    
    # –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    autocorr_1 = pd.Series(returns).autocorr(lag=1)
    autocorr_5 = pd.Series(returns).autocorr(lag=5)
    print(f"  –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (lag=1): {autocorr_1:.4f}")
    print(f"  –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (lag=5): {autocorr_5:.4f}")
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    simulation_results = []
    
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏
    for i in range(n_simulations):
        # –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤ –∏ bootstrap –≤—ã–±–æ—Ä–∫–∞
        n_blocks = time_horizon // block_size
        bootstrap_returns = []
        
        # –®–∞–≥ 2: –í—ã–±–æ—Ä–∫–∞ –±–ª–æ–∫–æ–≤ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
        for _ in range(n_blocks):
            # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –±–ª–æ–∫–∞
            # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –±–ª–æ–∫ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö
            max_start_idx = len(returns) - block_size
            if max_start_idx < 0:
                # –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                start_idx = 0
                block = returns[start_idx:]
            else:
                start_idx = np.random.randint(0, max_start_idx + 1)
                block = returns[start_idx:start_idx + block_size]
            
            bootstrap_returns.extend(block)
        
        # –®–∞–≥ 3: –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã
        while len(bootstrap_returns) < time_horizon:
            max_start_idx = len(returns) - block_size
            if max_start_idx < 0:
                start_idx = 0
                block = returns[start_idx:]
            else:
                start_idx = np.random.randint(0, max_start_idx + 1)
                block = returns[start_idx:start_idx + block_size]
            
            bootstrap_returns.extend(block)
        
        # –®–∞–≥ 4: –û–±—Ä–µ–∑–∫–∞ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã
        bootstrap_returns = np.array(bootstrap_returns[:time_horizon])
        
        # –®–∞–≥ 5: –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
        cumulative_return = np.prod(1 + bootstrap_returns) - 1
        
        # –®–∞–≥ 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        simulation_results.append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ block bootstrap —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    print(f"Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(simulation_results):,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    block_bootstrap_results = np.array(simulation_results)
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ block bootstrap —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:")
    print(f"    –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.mean(block_bootstrap_results):.4f} ({np.mean(block_bootstrap_results)*100:.2f}%)")
    print(f"    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {np.std(block_bootstrap_results):.4f} ({np.std(block_bootstrap_results)*100:.2f}%)")
    print(f"    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.min(block_bootstrap_results):.4f} ({np.min(block_bootstrap_results)*100:.2f}%)")
    print(f"    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.max(block_bootstrap_results):.4f} ({np.max(block_bootstrap_results)*100:.2f}%)")
    
    return block_bootstrap_results

def optimize_block_size(returns, max_block_size=20, n_simulations=1000):
    """
    –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞ –¥–ª—è Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é
    –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö –±–ª–æ–∫–æ–≤.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - max_block_size: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞
    """
    
    print("=== –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞ ===")
    
    # –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    autocorr_values = []
    for lag in range(1, min(20, len(returns) // 4)):
        autocorr = pd.Series(returns).autocorr(lag=lag)
        if not np.isnan(autocorr):
            autocorr_values.append((lag, autocorr))
    
    print("–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ –ª–∞–≥–∞–º:")
    for lag, autocorr in autocorr_values[:10]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 10
        print(f"  Lag {lag}: {autocorr:.4f}")
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –±–ª–æ–∫–æ–≤
    block_sizes = range(1, min(max_block_size + 1, len(returns) // 4))
    results_by_block_size = {}
    
    for block_size in block_sizes:
        print(f"\n–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞: {block_size}")
        
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å —Ç–µ–∫—É—â–∏–º —Ä–∞–∑–º–µ—Ä–æ–º –±–ª–æ–∫–∞
        results = block_bootstrap_monte_carlo(returns, n_simulations, 
                                            time_horizon=min(252, len(returns)), 
                                            block_size=block_size)
        
        # –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        mean_return = np.mean(results)
        std_return = np.std(results)
        coefficient_of_variation = std_return / abs(mean_return) if mean_return != 0 else np.inf
        
        results_by_block_size[block_size] = {
            'mean': mean_return,
            'std': std_return,
            'cv': coefficient_of_variation,
            'results': results
        }
        
        print(f"  –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {mean_return:.4f}")
        print(f"  –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {std_return:.4f}")
        print(f"  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏: {coefficient_of_variation:.2f}")
    
    # –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
    # –ö—Ä–∏—Ç–µ—Ä–∏–π: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–∞–∑—É–º–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    optimal_block_size = min(block_sizes, 
                           key=lambda x: results_by_block_size[x]['cv'])
    
    print(f"\n=== –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ===")
    print(f"–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: {optimal_block_size}")
    print(f"–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞—Ä–∏–∞—Ü–∏–∏: {results_by_block_size[optimal_block_size]['cv']:.4f}")
    
    return optimal_block_size, results_by_block_size
```

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

**–¢–µ–æ—Ä–∏—è:** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

### 1. –£—á–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

**–¢–µ–æ—Ä–∏—è:** –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –≤ —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–¥–æ–æ—Ü–µ–Ω–∫–µ —Ä–∏—Å–∫–æ–≤.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:**
- **AR(1) –ø—Ä–æ—Ü–µ—Å—Å:** X_t = œÜX_{t-1} + Œµ_t, –≥–¥–µ œÜ - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- **–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:** œÅ(k) = E[(X_t - Œº)(X_{t+k} - Œº)] / œÉ¬≤
- **–£—Å–ª–æ–≤–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è:** Var(X_t | X_{t-1}) = œÉ¬≤(1 - œÜ¬≤)
- **–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å:** |œÜ| < 1 –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ü–æ—á–µ–º—É —É—á–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –≤–∞–∂–µ–Ω:**
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é
- **–¢–æ—á–Ω–æ—Å—Ç—å —Ä–∏—Å–∫–æ–≤:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ —Ç—Ä–µ–±—É–µ—Ç —É—á–µ—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:** –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å–≤—è–∑–∞–Ω–∞ —Å GARCH —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
- **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ —É—á–µ—Ç–∞ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:**

```python
def autocorrelated_monte_carlo(returns, n_simulations=10000, time_horizon=252):
    """
    –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è —Å —É—á–µ—Ç–æ–º –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç AR(1) –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
    –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - AR(1) –ø—Ä–æ—Ü–µ—Å—Å: X_t = œÜX_{t-1} + Œµ_t
    - œÜ - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö)
    - Œµ_t ~ N(0, œÉ¬≤(1 - œÜ¬≤)) - –±–µ–ª—ã–π —à—É–º
    - –£—Å–ª–æ–≤–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è: Var(X_t | X_{t-1}) = œÉ¬≤(1 - œÜ¬≤)
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É—á–µ—Ç–∞ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:
    - –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –£—á–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - numpy array —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π —Å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
    """
    
    # –®–∞–≥ 1: –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ AR(1) –ø—Ä–æ—Ü–µ—Å—Å–∞
    returns_series = pd.Series(returns)
    
    # –†–∞—Å—á–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
    autocorr = returns_series.autocorr(lag=1)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å
    if abs(autocorr) >= 1:
        print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ({autocorr:.4f}) >= 1")
        print("–ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã–º. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ 0.9")
        autocorr = 0.9 if autocorr > 0 else -0.9
    
    # –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    mean_return = returns.mean()
    std_return = returns.std()
    
    # –£—Å–ª–æ–≤–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –¥–ª—è AR(1) –ø—Ä–æ—Ü–µ—Å—Å–∞
    conditional_std = std_return * np.sqrt(1 - autocorr**2)
    
    print(f"–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è:")
    print(f"  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (œÜ): {autocorr:.4f}")
    print(f"  –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {mean_return:.4f} ({mean_return*100:.2f}%)")
    print(f"  –ë–µ–∑—É—Å–ª–æ–≤–Ω–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {std_return:.4f} ({std_return*100:.2f}%)")
    print(f"  –£—Å–ª–æ–≤–Ω–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {conditional_std:.4f} ({conditional_std*100:.2f}%)")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    simulation_results = []
    
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å–∏–º—É–ª—è—Ü–∏–∏ —Å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
    for i in range(n_simulations):
        # –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞ —Å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
        simulated_returns = []
        
        # –®–∞–≥ 3: –ü–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–±–µ–∑—É—Å–ª–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
        first_return = np.random.normal(mean_return, std_return)
        simulated_returns.append(first_return)
        
        # –®–∞–≥ 4: –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
        for t in range(1, time_horizon):
            # AR(1) –ø—Ä–æ—Ü–µ—Å—Å: X_t = œÜX_{t-1} + Œµ_t
            # –≥–¥–µ Œµ_t ~ N(0, œÉ¬≤(1 - œÜ¬≤))
            error_term = np.random.normal(0, conditional_std)
            next_return = mean_return + autocorr * (simulated_returns[-1] - mean_return) + error_term
            simulated_returns.append(next_return)
        
        # –®–∞–≥ 5: –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
        cumulative_return = np.prod(1 + simulated_returns) - 1
        simulation_results.append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    print(f"–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(simulation_results):,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    autocorr_results = np.array(simulation_results)
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:")
    print(f"    –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.mean(autocorr_results):.4f} ({np.mean(autocorr_results)*100:.2f}%)")
    print(f"    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {np.std(autocorr_results):.4f} ({np.std(autocorr_results)*100:.2f}%)")
    print(f"    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.min(autocorr_results):.4f} ({np.min(autocorr_results)*100:.2f}%)")
    print(f"    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.max(autocorr_results):.4f} ({np.max(autocorr_results)*100:.2f}%)")
    
    return autocorr_results

def analyze_autocorrelation(returns, max_lags=20):
    """
    –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö,
    –ø–æ–º–æ–≥–∞—è –ø–æ–Ω—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –º–æ–¥–µ–ª—å.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - max_lags: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–≥–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    """
    
    print("=== –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ===")
    
    returns_series = pd.Series(returns)
    
    # –†–∞—Å—á–µ—Ç –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    autocorr_values = []
    for lag in range(1, min(max_lags + 1, len(returns) // 4)):
        autocorr = returns_series.autocorr(lag=lag)
        if not np.isnan(autocorr):
            autocorr_values.append((lag, autocorr))
    
    print("–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ –ª–∞–≥–∞–º:")
    for lag, autocorr in autocorr_values:
        significance = "***" if abs(autocorr) > 2/np.sqrt(len(returns)) else ""
        print(f"  Lag {lag:2d}: {autocorr:7.4f} {significance}")
    
    # –¢–µ—Å—Ç –Ω–∞ –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    significant_lags = [lag for lag, autocorr in autocorr_values 
                       if abs(autocorr) > 2/np.sqrt(len(returns))]
    
    print(f"\n–ó–Ω–∞—á–∏–º—ã–µ –ª–∞–≥–∏ (|œÅ| > 2/‚àön): {significant_lags}")
    
    # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é
    if significant_lags:
        print(f"\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print(f"  - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–Ω–∞—á–∏–º–∞—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è")
        print(f"  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AR(1) –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏")
        print(f"  - Block Bootstrap –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º –º–µ—Ç–æ–¥–æ–º")
    else:
        print(f"\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print(f"  - –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –Ω–µ–∑–Ω–∞—á–∏–º–∞")
        print(f"  - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é —Å–∏–º—É–ª—è—Ü–∏—é")
        print(f"  - Bootstrap –º–µ—Ç–æ–¥—ã —Ç–∞–∫–∂–µ –ø–æ–¥—Ö–æ–¥—è—Ç")
    
    return {
        'autocorr_values': autocorr_values,
        'significant_lags': significant_lags,
        'max_autocorr': max([abs(ac) for _, ac in autocorr_values]) if autocorr_values else 0
    }
```

### 2. –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (GARCH –º–æ–¥–µ–ª–∏)

**–¢–µ–æ—Ä–∏—è:** GARCH (Generalized Autoregressive Conditional Heteroskedasticity) –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ - —è–≤–ª–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –ø–µ—Ä–∏–æ–¥—ã –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–º–µ–Ω—è—é—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∞–º–∏ –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã GARCH:**
- **GARCH(1,1) –º–æ–¥–µ–ª—å:** œÉ¬≤_t = œâ + Œ±Œµ¬≤_{t-1} + Œ≤œÉ¬≤_{t-1}
- **–£—Å–ª–æ–≤–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:** œÉ_t = ‚àö(œÉ¬≤_t)
- **–£—Å–ª–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** r_t | F_{t-1} ~ N(Œº, œÉ¬≤_t)
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏:** z_t = (r_t - Œº) / œÉ_t

**–ü–æ—á–µ–º—É GARCH –º–æ–¥–µ–ª–∏ –≤–∞–∂–Ω—ã:**
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:** –£—á–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤
- **–¢–æ—á–Ω–æ—Å—Ç—å —Ä–∏—Å–∫–æ–≤:** –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ VaR –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç—Ä–∏–∫ —Ä–∏—Å–∫–∞
- **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è:** –£—á–µ—Ç –∏–∑–º–µ–Ω—è—é—â–µ–π—Å—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ GARCH –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**

```python
def garch_monte_carlo(returns, n_simulations=10000, time_horizon=252, garch_order=(1, 1)):
    """
    –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è —Å GARCH –º–æ–¥–µ–ª—å—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç GARCH –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. GARCH –º–æ–¥–µ–ª–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å
    –∏–∑–º–µ–Ω—è—é—â—É—é—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - GARCH(p,q) –º–æ–¥–µ–ª—å: œÉ¬≤_t = œâ + Œ£(Œ±_i * Œµ¬≤_{t-i}) + Œ£(Œ≤_j * œÉ¬≤_{t-j})
    - –£—Å–ª–æ–≤–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: œÉ_t = ‚àö(œÉ¬≤_t)
    - –£—Å–ª–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: r_t | F_{t-1} ~ N(Œº, œÉ¬≤_t)
    - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏: z_t = (r_t - Œº) / œÉ_t
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ GARCH –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è:
    - –£—á–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤
    - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
    - –£—á–µ—Ç –∏–∑–º–µ–Ω—è—é—â–µ–π—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252)
    - garch_order: –ø–æ—Ä—è–¥–æ–∫ GARCH –º–æ–¥–µ–ª–∏ (p, q) (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (1, 1))
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - numpy array —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ GARCH —Å–∏–º—É–ª—è—Ü–∏–π
    """
    
    try:
        from arch import arch_model
    except ImportError:
        print("–û—à–∏–±–∫–∞: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É arch")
        print("–í—ã–ø–æ–ª–Ω–∏—Ç–µ: pip install arch")
        return None
    
    print(f"GARCH —Å–∏–º—É–ª—è—Ü–∏—è:")
    print(f"  –ü–æ—Ä—è–¥–æ–∫ GARCH –º–æ–¥–µ–ª–∏: {garch_order}")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    
    # –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    returns_series = pd.Series(returns).dropna()
    
    if len(returns_series) < 50:
        print("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è GARCH –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è")
        print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è")
        return monte_carlo_simulation(returns, n_simulations, time_horizon)
    
    # –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ GARCH –º–æ–¥–µ–ª–∏
    print("–û–±—É—á–µ–Ω–∏–µ GARCH –º–æ–¥–µ–ª–∏...")
    
    try:
        # –°–æ–∑–¥–∞–Ω–∏–µ GARCH –º–æ–¥–µ–ª–∏
        model = arch_model(returns_series, vol='Garch', p=garch_order[0], q=garch_order[1])
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        fitted_model = model.fit(disp='off')
        
        print(f"GARCH –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ:")
        print(f"  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏:")
        for param, value in fitted_model.params.items():
            print(f"    {param}: {value:.6f}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç–∏
        if garch_order == (1, 1):
            alpha = fitted_model.params.get('alpha[1]', 0)
            beta = fitted_model.params.get('beta[1]', 0)
            if alpha + beta >= 1:
                print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: GARCH –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–π (Œ± + Œ≤ = {alpha + beta:.4f})")
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ GARCH –º–æ–¥–µ–ª–∏: {e}")
        print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è")
        return monte_carlo_simulation(returns, n_simulations, time_horizon)
    
    # –®–∞–≥ 3: –°–∏–º—É–ª—è—Ü–∏—è —Å GARCH –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é
    simulation_results = []
    
    print("–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ GARCH —Å–∏–º—É–ª—è—Ü–∏–π...")
    
    for i in range(n_simulations):
        try:
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–º—É–ª—è—Ü–∏–∏ —Å GARCH –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é
            simulated_returns = fitted_model.forecast(horizon=time_horizon, method='simulation')
            
            # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏
            if hasattr(simulated_returns, 'values'):
                returns_values = simulated_returns.values.flatten()
            else:
                returns_values = simulated_returns
            
            # –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            cumulative_return = np.prod(1 + returns_values) - 1
            simulation_results.append(cumulative_return)
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ —Å–∏–º—É–ª—è—Ü–∏–∏ {i}: {e}")
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é —Å–∏–º—É–ª—è—Ü–∏—é –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
            simple_return = np.random.normal(returns.mean(), returns.std(), time_horizon)
            cumulative_return = np.prod(1 + simple_return) - 1
            simulation_results.append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ GARCH —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    print(f"GARCH —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(simulation_results):,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    garch_results = np.array(simulation_results)
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ GARCH —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:")
    print(f"    –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.mean(garch_results):.4f} ({np.mean(garch_results)*100:.2f}%)")
    print(f"    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {np.std(garch_results):.4f} ({np.std(garch_results)*100:.2f}%)")
    print(f"    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.min(garch_results):.4f} ({np.min(garch_results)*100:.2f}%)")
    print(f"    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.max(garch_results):.4f} ({np.max(garch_results)*100:.2f}%)")
    
    return garch_results

def analyze_volatility_clustering(returns, window=30):
    """
    –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö,
    –ø–æ–º–æ–≥–∞—è –ø–æ–Ω—è—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ GARCH –º–æ–¥–µ–ª—å –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - window: —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
    """
    
    print("=== –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ ===")
    
    returns_series = pd.Series(returns)
    
    # –†–∞—Å—á–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    rolling_vol = returns_series.rolling(window=window).std()
    
    # –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    vol_autocorr = rolling_vol.autocorr(lag=1)
    
    print(f"–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (lag=1): {vol_autocorr:.4f}")
    
    # –¢–µ—Å—Ç –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é (Ljung-Box —Ç–µ—Å—Ç –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π)
    from scipy import stats
    
    squared_returns = returns_series ** 2
    lb_stat, lb_pvalue = stats.jarque_bera(squared_returns.dropna())
    
    print(f"–¢–µ—Å—Ç –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é (Jarque-Bera –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π):")
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {lb_stat:.4f}")
    print(f"  p-value: {lb_pvalue:.4f}")
    
    # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    if vol_autocorr > 0.1 or lb_pvalue < 0.05:
        print(f"\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print(f"  - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏")
        print(f"  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GARCH –º–æ–¥–µ–ª–∏")
        print(f"  - Block Bootstrap —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–º")
    else:
        print(f"\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print(f"  - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ–∑–Ω–∞—á–∏–º–∞")
        print(f"  - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏")
        print(f"  - Bootstrap –º–µ—Ç–æ–¥—ã –ø–æ–¥—Ö–æ–¥—è—Ç")
    
    return {
        'vol_autocorr': vol_autocorr,
        'lb_stat': lb_stat,
        'lb_pvalue': lb_pvalue,
        'has_clustering': vol_autocorr > 0.1 or lb_pvalue < 0.05
    }
```

### 3. –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è

**–¢–µ–æ—Ä–∏—è:** –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–æ–≤.

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**
- **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:** Œ£ = E[(R - Œº)(R - Œº)·µÄ]
- **Cholesky —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ:** Œ£ = LL·µÄ, –≥–¥–µ L - –Ω–∏–∂–Ω—è—è —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
- **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:** Z = LŒµ, –≥–¥–µ Œµ ~ N(0, I)
- **–ú–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** R ~ N(Œº, Œ£)

**–ü–æ—á–µ–º—É –º–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –≤–∞–∂–Ω–∞:**
- **–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** –£—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏
- **–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏:** –¢–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤
- **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:**

```python
def multivariate_monte_carlo(returns_dict, n_simulations=10000, time_horizon=252):
    """
    –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–Ω–æ–≥–æ–º–µ—Ä–Ω—É—é —Å–∏–º—É–ª—è—Ü–∏—é, —É—á–∏—Ç—ã–≤–∞—é—â—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Cholesky —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
    –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω.
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:
    - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞: Œ£ = E[(R - Œº)(R - Œº)·µÄ]
    - Cholesky —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ: Œ£ = LL·µÄ
    - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: Z = LŒµ, –≥–¥–µ Œµ ~ N(0, I)
    - –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ: R ~ N(Œº, Œ£)
    
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏:
    - –£—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏
    - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
    - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    - –¢–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns_dict: —Å–ª–æ–≤–∞—Ä—å —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ –∞–∫—Ç–∏–≤–æ–≤ {asset_name: returns_array}
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 252)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞
    """
    
    print(f"–ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è:")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–æ–≤: {len(returns_dict)}")
    print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π: {n_simulations:,}")
    print(f"  –ì–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {time_horizon} –¥–Ω–µ–π")
    
    # –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    asset_names = list(returns_dict.keys())
    returns_df = pd.DataFrame(returns_dict)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
    if len(returns_df) < 30:
        print("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏")
        print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞")
        return independent_multivariate_simulation(returns_dict, n_simulations, time_horizon)
    
    # –®–∞–≥ 2: –†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
    correlation_matrix = returns_df.corr()
    
    print(f"–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:")
    print(correlation_matrix.round(3))
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
    try:
        # Cholesky —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
        chol_matrix = np.linalg.cholesky(correlation_matrix)
        print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞")
    except np.linalg.LinAlgError:
        print("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞")
        print("–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è")
        # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞–ª–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
        regularized_corr = correlation_matrix + 0.01 * np.eye(len(correlation_matrix))
        chol_matrix = np.linalg.cholesky(regularized_corr)
    
    # –®–∞–≥ 3: –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞
    asset_params = {}
    for asset in asset_names:
        asset_returns = returns_dict[asset]
        asset_params[asset] = {
            'mean': asset_returns.mean(),
            'std': asset_returns.std()
        }
    
    print(f"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–∫—Ç–∏–≤–æ–≤:")
    for asset, params in asset_params.items():
        print(f"  {asset}: Œº={params['mean']:.4f}, œÉ={params['std']:.4f}")
    
    # –®–∞–≥ 4: –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    simulation_results = {}
    
    print("–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö —Å–∏–º—É–ª—è—Ü–∏–π...")
    
    for i in range(n_simulations):
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
        # –†–∞–∑–º–µ—Ä: (time_horizon, n_assets)
        independent_random = np.random.normal(0, 1, (time_horizon, len(asset_names)))
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
        # Z = L * Œµ, –≥–¥–µ L - Cholesky –º–∞—Ç—Ä–∏—Ü–∞
        correlated_random = independent_random @ chol_matrix.T
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        for j, asset in enumerate(asset_names):
            params = asset_params[asset]
            
            # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏: R = Œº + œÉ * Z
            simulated_returns = params['mean'] + params['std'] * correlated_random[:, j]
            
            # –†–∞—Å—á–µ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
            cumulative_return = np.prod(1 + simulated_returns) - 1
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            if asset not in simulation_results:
                simulation_results[asset] = []
            simulation_results[asset].append(cumulative_return)
        
        # –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        if (i + 1) % 1000 == 0:
            print(f"  –í—ã–ø–æ–ª–Ω–µ–Ω–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö —Å–∏–º—É–ª—è—Ü–∏–π: {i + 1:,}/{n_simulations:,}")
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ numpy –º–∞—Å—Å–∏–≤—ã
    for asset in simulation_results:
        simulation_results[asset] = np.array(simulation_results[asset])
    
    print(f"–ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {n_simulations:,} —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:")
    for asset, results in simulation_results.items():
        print(f"  {asset}:")
        print(f"    –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {np.mean(results):.4f} ({np.mean(results)*100:.2f}%)")
        print(f"    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {np.std(results):.4f} ({np.std(results)*100:.2f}%)")
    
    return simulation_results

def independent_multivariate_simulation(returns_dict, n_simulations=10000, time_horizon=252):
    """
    –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è (–±–µ–∑ —É—á–µ—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π)
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ,
    –Ω–µ —É—á–∏—Ç—ã–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –Ω–∏–º–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback
    –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns_dict: —Å–ª–æ–≤–∞—Ä—å —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ –∞–∫—Ç–∏–≤–æ–≤
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π
    - time_horizon: –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–∏–º—É–ª—è—Ü–∏–π
    """
    
    print("–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–∏–º—É–ª—è—Ü–∏–π (–±–µ–∑ —É—á–µ—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π)...")
    
    simulation_results = {}
    
    for asset, returns in returns_dict.items():
        print(f"–°–∏–º—É–ª—è—Ü–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–∞: {asset}")
        results = monte_carlo_simulation(returns, n_simulations, time_horizon)
        simulation_results[asset] = results
    
    return simulation_results

def analyze_portfolio_correlations(simulation_results):
    """
    –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π
    —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤, –ø–æ–º–æ–≥–∞—è –ø–æ–Ω—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - simulation_results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å –∞–Ω–∞–ª–∏–∑–æ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    """
    
    print("=== –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—è ===")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π
    results_df = pd.DataFrame(simulation_results)
    
    # –†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    correlation_matrix = results_df.corr()
    
    print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–π:")
    print(correlation_matrix.round(3))
    
    # –ê–Ω–∞–ª–∏–∑ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    avg_correlation = correlation_matrix.values[np.triu_indices_from(correlation_matrix.values, k=1)].mean()
    
    print(f"–°—Ä–µ–¥–Ω—è—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏: {avg_correlation:.4f}")
    
    if avg_correlation < 0.3:
        print("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ù–∏–∑–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è - —Ö–æ—Ä–æ—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏")
    elif avg_correlation < 0.7:
        print("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –£–º–µ—Ä–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è - –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —á–∞—Å—Ç–∏—á–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞")
    else:
        print("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –í—ã—Å–æ–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏")
    
    return {
        'correlation_matrix': correlation_matrix,
        'avg_correlation': avg_correlation,
        'diversification_potential': 'high' if avg_correlation < 0.3 else 'medium' if avg_correlation < 0.7 else 'low'
    }
```

## –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤

### 1. Value at Risk (VaR)
```python
def calculate_var(simulation_results, confidence_level=0.05):
    """–†–∞—Å—á–µ—Ç Value at Risk"""
    
    var = np.percentile(simulation_results, confidence_level * 100)
    return var

def calculate_expected_shortfall(simulation_results, confidence_level=0.05):
    """–†–∞—Å—á–µ—Ç Expected Shortfall (Conditional VaR)"""
    
    var = calculate_var(simulation_results, confidence_level)
    tail_losses = simulation_results[simulation_results <= var]
    expected_shortfall = np.mean(tail_losses)
    
    return expected_shortfall
```

### 2. Maximum Drawdown
```python
def calculate_max_drawdown_distribution(simulation_results, time_horizon=252):
    """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏"""
    
    max_drawdowns = []
    
    for result in simulation_results:
        # –°–∏–º—É–ª—è—Ü–∏—è –ø—É—Ç–∏ –∫–∞–ø–∏—Ç–∞–ª–∞
        cumulative_returns = np.cumprod(1 + np.random.normal(0, 0.02, time_horizon))
        
        # –†–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏
        running_max = np.maximum.accumulate(cumulative_returns)
        drawdown = (cumulative_returns - running_max) / running_max
        max_drawdown = np.min(drawdown)
        
        max_drawdowns.append(max_drawdown)
    
    return np.array(max_drawdowns)
```

### 3. Stress Testing
```python
def stress_testing_monte_carlo(returns, stress_scenarios, n_simulations=10000):
    """–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ"""
    
    stress_results = {}
    
    for scenario_name, stress_params in stress_scenarios.items():
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–µ—Å—Å–∞
        stress_mean = stress_params.get('mean', returns.mean())
        stress_std = stress_params.get('std', returns.std() * stress_params.get('volatility_multiplier', 1))
        stress_correlation = stress_params.get('correlation', 1)
        
        scenario_results = []
        
        for _ in range(n_simulations):
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —Å—Ç—Ä–µ—Å—Å–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            stress_returns = np.random.normal(stress_mean, stress_std, len(returns))
            
            # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
            if stress_correlation != 1:
                stress_returns = stress_correlation * returns + np.sqrt(1 - stress_correlation**2) * stress_returns
            
            # –†–∞—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            cumulative_return = np.prod(1 + stress_returns) - 1
            scenario_results.append(cumulative_return)
        
        stress_results[scenario_name] = np.array(scenario_results)
    
    return stress_results
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
import matplotlib.pyplot as plt

def plot_simulation_distribution(simulation_results, title="–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è"):
    """–ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏"""
    
    plt.figure(figsize=(12, 8))
    
    # –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
    plt.hist(simulation_results, bins=50, alpha=0.7, density=True, edgecolor='black')
    
    # –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    mu, sigma = np.mean(simulation_results), np.std(simulation_results)
    x = np.linspace(simulation_results.min(), simulation_results.max(), 100)
    plt.plot(x, stats.norm.pdf(x, mu, sigma), 'r-', linewidth=2, label='–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ')
    
    # –ö–≤–∞–Ω—Ç–∏–ª–∏
    percentiles = [5, 25, 50, 75, 95]
    for p in percentiles:
        value = np.percentile(simulation_results, p)
        plt.axvline(value, color='red', linestyle='--', alpha=0.7, label=f'{p}%: {value:.3f}')
    
    plt.title(title)
    plt.xlabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    plt.ylabel('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å')
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.show()
```

### 2. –ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞
```python
def plot_risk_curve(simulation_results, confidence_levels):
    """–ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞ (VaR)"""
    
    var_values = []
    
    for cl in confidence_levels:
        var = np.percentile(simulation_results, cl * 100)
        var_values.append(var)
    
    plt.figure(figsize=(10, 6))
    plt.plot(confidence_levels, var_values, marker='o', linewidth=2)
    plt.title('–ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞ (VaR)')
    plt.xlabel('–£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è')
    plt.ylabel('VaR')
    plt.grid(True, alpha=0.3)
    plt.show()
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
```python
def plot_scenario_comparison(stress_results):
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"""
    
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))
    axes = axes.flatten()
    
    for i, (scenario_name, results) in enumerate(stress_results.items()):
        if i < len(axes):
            axes[i].hist(results, bins=30, alpha=0.7, edgecolor='black')
            axes[i].set_title(f'–°—Ü–µ–Ω–∞—Ä–∏–π: {scenario_name}')
            axes[i].set_xlabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
            axes[i].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
            axes[i].grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()
```

## –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–∏–º–µ—Ä —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–¢–µ–æ—Ä–∏—è:** –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –í—ã –º–æ–∂–µ—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–¥ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏–∫.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:**

```python
def generate_test_data(n_days=1000, assets=['AAPL', 'GOOGL', 'MSFT', 'TSLA']):
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–µ
    –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º–∏ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - n_days: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000)
    - assets: —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –∞–∫—Ç–∏–≤–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ['AAPL', 'GOOGL', 'MSFT', 'TSLA'])
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ –∞–∫—Ç–∏–≤–æ–≤
    """
    
    print(f"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è {len(assets)} –∞–∫—Ç–∏–≤–æ–≤ –Ω–∞ {n_days} –¥–Ω–µ–π...")
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞ (—Å—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
    asset_params = {
        'AAPL': {'mean': 0.0008, 'std': 0.02},
        'GOOGL': {'mean': 0.001, 'std': 0.025},
        'MSFT': {'mean': 0.0007, 'std': 0.018},
        'TSLA': {'mean': 0.0015, 'std': 0.04}
    }
    
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏
    correlation_matrix = np.array([
        [1.0, 0.7, 0.8, 0.6],  # AAPL
        [0.7, 1.0, 0.6, 0.5],  # GOOGL
        [0.8, 0.6, 1.0, 0.4],  # MSFT
        [0.6, 0.5, 0.4, 1.0]   # TSLA
    ])
    
    # Cholesky —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    chol_matrix = np.linalg.cholesky(correlation_matrix)
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
    independent_random = np.random.normal(0, 1, (n_days, len(assets)))
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    correlated_random = independent_random @ chol_matrix.T
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–∞
    returns_data = {}
    for i, asset in enumerate(assets):
        if asset in asset_params:
            params = asset_params[asset]
            # –î–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
            returns = []
            vol = params['std']
            
            for t in range(n_days):
                # –ü—Ä–æ—Å—Ç–∞—è GARCH-–ø–æ–¥–æ–±–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
                if t > 0:
                    vol = 0.95 * vol + 0.05 * params['std'] + 0.1 * abs(returns[-1])
                
                # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
                return_t = params['mean'] + vol * correlated_random[t, i]
                returns.append(return_t)
            
            returns_data[asset] = np.array(returns)
        else:
            # –ü—Ä–æ—Å—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
            returns_data[asset] = np.random.normal(0.001, 0.02, n_days)
    
    print("–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
    print("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∞–∫—Ç–∏–≤–∞–º:")
    for asset, returns in returns_data.items():
        print(f"  {asset}: Œº={np.mean(returns):.4f}, œÉ={np.std(returns):.4f}")
    
    return returns_data

def complete_monte_carlo_analysis(returns, n_simulations=5000):
    """
    –ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –∞–Ω–∞–ª–∏–∑
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏,
    –≤–∫–ª—é—á–∞—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤, –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - returns: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (pandas Series –∏–ª–∏ numpy array)
    - n_simulations: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º—É–ª—è—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5000)
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤—Å–µ—Ö –∞–Ω–∞–ª–∏–∑–æ–≤
    """
    
    print("=" * 60)
    print("–ü–û–õ–ù–´–ô –ú–û–ù–¢–ï-–ö–ê–†–õ–û –ê–ù–ê–õ–ò–ó")
    print("=" * 60)
    
    # 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
    print("\n1. –ê–ù–ê–õ–ò–ó –ò–°–•–û–î–ù–´–• –î–ê–ù–ù–´–•")
    print("-" * 30)
    
    returns_series = pd.Series(returns)
    print(f"–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {len(returns_series):,} –Ω–∞–±–ª—é–¥–µ–Ω–∏–π")
    print(f"–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {returns_series.mean():.4f} ({returns_series.mean()*100:.2f}%)")
    print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {returns_series.std():.4f} ({returns_series.std()*100:.2f}%)")
    print(f"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {returns_series.min():.4f} ({returns_series.min()*100:.2f}%)")
    print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {returns_series.max():.4f} ({returns_series.max()*100:.2f}%)")
    
    # –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
    autocorr_analysis = analyze_autocorrelation(returns)
    
    # –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    vol_clustering = analyze_volatility_clustering(returns)
    
    # 2. –ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n2. –ü–†–û–°–¢–ê–Ø –ü–ê–†–ê–ú–ï–¢–†–ò–ß–ï–°–ö–ê–Ø –°–ò–ú–£–õ–Ø–¶–ò–Ø")
    print("-" * 40)
    simple_results = monte_carlo_simulation(returns, n_simulations)
    simple_analysis = analyze_simulation_results(simple_results)
    
    # 3. Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n3. BOOTSTRAP –°–ò–ú–£–õ–Ø–¶–ò–Ø")
    print("-" * 25)
    bootstrap_results = bootstrap_monte_carlo(returns, n_simulations)
    bootstrap_analysis = analyze_simulation_results(bootstrap_results)
    
    # 4. Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n4. BLOCK BOOTSTRAP –°–ò–ú–£–õ–Ø–¶–ò–Ø")
    print("-" * 30)
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞
    optimal_block_size, block_optimization = optimize_block_size(returns, max_block_size=10, n_simulations=1000)
    block_bootstrap_results = block_bootstrap_monte_carlo(returns, n_simulations, block_size=optimal_block_size)
    block_analysis = analyze_simulation_results(block_bootstrap_results)
    
    # 5. –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    print("\n5. –ê–í–¢–û–ö–û–†–†–ï–õ–ò–†–û–í–ê–ù–ù–ê–Ø –°–ò–ú–£–õ–Ø–¶–ò–Ø")
    print("-" * 35)
    autocorr_results = autocorrelated_monte_carlo(returns, n_simulations)
    autocorr_analysis_results = analyze_simulation_results(autocorr_results)
    
    # 6. GARCH —Å–∏–º—É–ª—è—Ü–∏—è (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
    print("\n6. GARCH –°–ò–ú–£–õ–Ø–¶–ò–Ø")
    print("-" * 20)
    garch_results = garch_monte_carlo(returns, n_simulations)
    if garch_results is not None:
        garch_analysis = analyze_simulation_results(garch_results)
    else:
        garch_results = None
        garch_analysis = None
    
    # 7. –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤
    print("\n7. –ê–ù–ê–õ–ò–ó –†–ò–°–ö–û–í")
    print("-" * 20)
    
    # VaR –∏ Expected Shortfall
    var_95 = calculate_var(simple_results, 0.05)
    var_99 = calculate_var(simple_results, 0.01)
    es_95 = calculate_expected_shortfall(simple_results, 0.05)
    es_99 = calculate_expected_shortfall(simple_results, 0.01)
    
    print(f"Value at Risk (95%): {var_95:.4f} ({var_95*100:.2f}%)")
    print(f"Value at Risk (99%): {var_99:.4f} ({var_99*100:.2f}%)")
    print(f"Expected Shortfall (95%): {es_95:.4f} ({es_95*100:.2f}%)")
    print(f"Expected Shortfall (99%): {es_99:.4f} ({es_99*100:.2f}%)")
    
    # 8. –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    print("\n8. –°–¢–†–ï–°–°-–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï")
    print("-" * 25)
    
    stress_scenarios = {
        '–ö—Ä–∏–∑–∏—Å 2008': {'volatility_multiplier': 2.5, 'mean': -0.02},
        '–í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å': {'volatility_multiplier': 1.8},
        '–ù–∏–∑–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å': {'mean': 0.0005},
        '–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π –∫—Ä–∏–∑–∏—Å': {'volatility_multiplier': 3.0, 'mean': -0.05}
    }
    
    stress_results = stress_testing_monte_carlo(returns, stress_scenarios, n_simulations=2000)
    
    # 9. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–µ—Ç–æ–¥–æ–≤
    print("\n9. –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ú–ï–¢–û–î–û–í")
    print("-" * 35)
    
    methods_comparison = {
        '–ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è': simple_analysis,
        'Bootstrap': bootstrap_analysis,
        'Block Bootstrap': block_analysis,
        '–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è': autocorr_analysis_results
    }
    
    if garch_analysis is not None:
        methods_comparison['GARCH'] = garch_analysis
    
    print("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º:")
    print(f"{'–ú–µ—Ç–æ–¥':<25} {'–°—Ä–µ–¥–Ω—è—è':<10} {'–°—Ç–¥.–æ—Ç–∫–ª.':<10} {'5% VaR':<10} {'95% VaR':<10}")
    print("-" * 70)
    
    for method, analysis in methods_comparison.items():
        print(f"{method:<25} {analysis['mean_return']:<10.4f} {analysis['std_return']:<10.4f} "
              f"{analysis['percentile_5']:<10.4f} {analysis['percentile_95']:<10.4f}")
    
    # 10. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print("\n10. –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –†–ï–ó–£–õ–¨–¢–ê–¢–û–í")
    print("-" * 30)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    fig, axes = plt.subplots(2, 3, figsize=(18, 12))
    fig.suptitle('–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤', fontsize=16)
    
    # –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    axes[0, 0].hist(simple_results, bins=50, alpha=0.7, density=True, label='–ü—Ä–æ—Å—Ç–∞—è', color='blue')
    axes[0, 0].hist(bootstrap_results, bins=50, alpha=0.7, density=True, label='Bootstrap', color='red')
    axes[0, 0].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤')
    axes[0, 0].set_xlabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[0, 0].set_ylabel('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å')
    axes[0, 0].legend()
    axes[0, 0].grid(True, alpha=0.3)
    
    # –ì—Ä–∞—Ñ–∏–∫ 2: –ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞ (VaR)
    confidence_levels = np.linspace(0.01, 0.5, 50)
    var_values = [np.percentile(simple_results, cl * 100) for cl in confidence_levels]
    axes[0, 1].plot(confidence_levels, var_values, 'b-', linewidth=2, label='VaR')
    axes[0, 1].axhline(y=0, color='r', linestyle='--', alpha=0.7)
    axes[0, 1].set_title('–ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞ (VaR)')
    axes[0, 1].set_xlabel('–£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è')
    axes[0, 1].set_ylabel('VaR')
    axes[0, 1].grid(True, alpha=0.3)
    axes[0, 1].legend()
    
    # –ì—Ä–∞—Ñ–∏–∫ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏–ª–µ–π
    percentiles = [5, 10, 25, 50, 75, 90, 95]
    simple_quantiles = [np.percentile(simple_results, p) for p in percentiles]
    bootstrap_quantiles = [np.percentile(bootstrap_results, p) for p in percentiles]
    
    x = np.arange(len(percentiles))
    width = 0.35
    
    axes[0, 2].bar(x - width/2, simple_quantiles, width, label='–ü—Ä–æ—Å—Ç–∞—è', alpha=0.7)
    axes[0, 2].bar(x + width/2, bootstrap_quantiles, width, label='Bootstrap', alpha=0.7)
    axes[0, 2].set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏–ª–µ–π')
    axes[0, 2].set_xlabel('–ö–≤–∞–Ω—Ç–∏–ª—å (%)')
    axes[0, 2].set_ylabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[0, 2].set_xticks(x)
    axes[0, 2].set_xticklabels(percentiles)
    axes[0, 2].legend()
    axes[0, 2].grid(True, alpha=0.3)
    
    # –ì—Ä–∞—Ñ–∏–∫ 4: –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    stress_names = list(stress_results.keys())
    stress_means = [np.mean(stress_results[name]) for name in stress_names]
    stress_stds = [np.std(stress_results[name]) for name in stress_names]
    
    axes[1, 0].bar(stress_names, stress_means, yerr=stress_stds, capsize=5, alpha=0.7)
    axes[1, 0].set_title('–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ')
    axes[1, 0].set_ylabel('–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[1, 0].tick_params(axis='x', rotation=45)
    axes[1, 0].grid(True, alpha=0.3)
    
    # –ì—Ä–∞—Ñ–∏–∫ 5: QQ-plot –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏
    from scipy import stats
    stats.probplot(simple_results, dist="norm", plot=axes[1, 1])
    axes[1, 1].set_title('Q-Q Plot (–ü—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è)')
    axes[1, 1].grid(True, alpha=0.3)
    
    # –ì—Ä–∞—Ñ–∏–∫ 6: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    axes[1, 2].plot(returns_series.index, returns_series.values, alpha=0.7)
    axes[1, 2].set_title('–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏')
    axes[1, 2].set_xlabel('–í—Ä–µ–º—è')
    axes[1, 2].set_ylabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[1, 2].grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()
    
    # 11. –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
    print("\n11. –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢")
    print("-" * 20)
    
    print("–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:")
    print(f"‚Ä¢ –°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {simple_analysis['mean_return']:.2%}")
    print(f"‚Ä¢ –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: {simple_analysis['std_return']:.2%}")
    print(f"‚Ä¢ 5% VaR: {var_95:.2%}")
    print(f"‚Ä¢ 1% VaR: {var_99:.2%}")
    print(f"‚Ä¢ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã–ª–∏: {simple_analysis['probability_positive']:.1%}")
    print(f"‚Ä¢ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–±—ã—Ç–∫–∞: {simple_analysis['probability_loss']:.1%}")
    
    if autocorr_analysis['max_autocorr'] > 0.1:
        print("‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–Ω–∞—á–∏–º–∞—è –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Block Bootstrap")
    
    if vol_clustering['has_clustering']:
        print("‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è GARCH")
    
    print("\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –º–µ—Ç–æ–¥–∞:")
    if autocorr_analysis['max_autocorr'] > 0.1 and vol_clustering['has_clustering']:
        print("‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: Block Bootstrap + GARCH –º–æ–¥–µ–ª–∏")
    elif autocorr_analysis['max_autocorr'] > 0.1:
        print("‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è")
    elif vol_clustering['has_clustering']:
        print("‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: GARCH —Å–∏–º—É–ª—è—Ü–∏—è")
    else:
        print("‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∏–ª–∏ Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è")
    
    return {
        'data_analysis': {
            'autocorr': autocorr_analysis,
            'vol_clustering': vol_clustering
        },
        'simulation_results': {
            'simple': simple_results,
            'bootstrap': bootstrap_results,
            'block_bootstrap': block_bootstrap_results,
            'autocorr': autocorr_results,
            'garch': garch_results
        },
        'analysis_results': methods_comparison,
        'risk_metrics': {
            'var_95': var_95,
            'var_99': var_99,
            'es_95': es_95,
            'es_99': es_99
        },
        'stress_results': stress_results,
        'recommendations': {
            'optimal_method': 'Block Bootstrap + GARCH' if autocorr_analysis['max_autocorr'] > 0.1 and vol_clustering['has_clustering'] 
                            else 'Block Bootstrap' if autocorr_analysis['max_autocorr'] > 0.1
                            else 'GARCH' if vol_clustering['has_clustering']
                            else 'Bootstrap'
        }
    }

# –ü–û–õ–ù–´–ô –ü–†–ò–ú–ï–† –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
def run_complete_example():
    """
    –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    """
    
    print("=" * 80)
    print("–ü–û–õ–ù–´–ô –ü–†–ò–ú–ï–† –ú–û–ù–¢–ï-–ö–ê–†–õ–û –°–ò–ú–£–õ–Ø–¶–ò–ò")
    print("=" * 80)
    print("–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏")
    print("–Ω–∞ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.")
    print("=" * 80)
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    test_data = generate_test_data(n_days=1000, assets=['AAPL', 'GOOGL', 'MSFT', 'TSLA'])
    
    # –í—ã–±–æ—Ä –æ–¥–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    asset_name = 'AAPL'
    returns = test_data[asset_name]
    
    print(f"\n–í—ã–±—Ä–∞–Ω –∞–∫—Ç–∏–≤: {asset_name}")
    print(f"–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {len(returns):,} –¥–Ω–µ–π")
    
    # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
    results = complete_monte_carlo_analysis(returns, n_simulations=5000)
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏
    print("\n" + "=" * 60)
    print("–ú–ù–û–ì–û–ú–ï–†–ù–ê–Ø –°–ò–ú–£–õ–Ø–¶–ò–Ø –ü–û–†–¢–§–ï–õ–Ø")
    print("=" * 60)
    
    # –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–æ–≤
    portfolio_results = multivariate_monte_carlo(test_data, n_simulations=3000)
    
    # –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—è
    correlation_analysis = analyze_portfolio_correlations(portfolio_results)
    
    print("\n–ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω!")
    print(f"–°—Ä–µ–¥–Ω—è—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏: {correlation_analysis['avg_correlation']:.3f}")
    print(f"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: {correlation_analysis['diversification_potential']}")
    
    return {
        'single_asset_analysis': results,
        'portfolio_analysis': {
            'results': portfolio_results,
            'correlations': correlation_analysis
        }
    }

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–∞ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
    example_results = run_complete_example()
    
    print("\n" + "=" * 80)
    print("–ü–†–ò–ú–ï–† –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!")
    print("=" * 80)
    print("–í—Å–µ –º–µ—Ç–æ–¥—ã –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã.")
    print("–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥ –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è —Å–≤–æ–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤.")
    print("=" * 80)
```

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
```bash
pip install numpy pandas matplotlib scipy arch
```

2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–¥:**
```python
# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
results = run_complete_example()
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:**
```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
import pandas as pd
your_data = pd.read_csv('your_data.csv')
your_returns = your_data['returns_column']

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞
results = complete_monte_carlo_analysis(your_returns, n_simulations=10000)
```

**–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ (VaR, Expected Shortfall)
- ‚úÖ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –º–µ—Ç–æ–¥–∞

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã

**–¢–µ–æ—Ä–∏—è:** –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏.

### 1. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤

```python
def generate_monte_carlo_report(results, title="–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –∞–Ω–∞–ª–∏–∑"):
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏,
    –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Å–∏–º—É–ª—è—Ü–∏–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ú–æ–Ωte-–ö–∞—Ä–ª–æ
    - title: –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á–µ—Ç–∞
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - HTML –æ—Ç—á–µ—Ç (—Å—Ç—Ä–æ–∫–∞)
    """
    
    report = f"""
    <!DOCTYPE html>
    <html>
    <head>
        <title>{title}</title>
        <style>
            body {{ font-family: Arial, sans-serif; margin: 40px; }}
            .header {{ background-color: #2c3e50; color: white; padding: 20px; text-align: center; }}
            .section {{ margin: 20px 0; padding: 15px; border-left: 4px solid #3498db; }}
            .metric {{ display: inline-block; margin: 10px; padding: 10px; background-color: #ecf0f1; border-radius: 5px; }}
            .warning {{ background-color: #f39c12; color: white; padding: 10px; border-radius: 5px; }}
            .success {{ background-color: #27ae60; color: white; padding: 10px; border-radius: 5px; }}
            table {{ border-collapse: collapse; width: 100%; }}
            th, td {{ border: 1px solid #ddd; padding: 8px; text-align: left; }}
            th {{ background-color: #34495e; color: white; }}
        </style>
    </head>
    <body>
        <div class="header">
            <h1>{title}</h1>
            <p>–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {pd.Timestamp.now().strftime('%Y-%m-%d %H:%M:%S')}</p>
        </div>
        
        <div class="section">
            <h2>–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h2>
            <div class="metric">
                <strong>–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å:</strong><br>
                {results['analysis_results']['–ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è']['mean_return']:.2%}
            </div>
            <div class="metric">
                <strong>–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:</strong><br>
                {results['analysis_results']['–ü—Ä–æ—Å—Ç–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è']['std_return']:.2%}
            </div>
            <div class="metric">
                <strong>5% VaR:</strong><br>
                {results['risk_metrics']['var_95']:.2%}
            </div>
            <div class="metric">
                <strong>1% VaR:</strong><br>
                {results['risk_metrics']['var_99']:.2%}
            </div>
        </div>
        
        <div class="section">
            <h2>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
            <div class="success">
                <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–µ—Ç–æ–¥:</strong> {results['recommendations']['optimal_method']}
            </div>
        </div>
        
        <div class="section">
            <h2>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤</h2>
            <table>
                <tr>
                    <th>–ú–µ—Ç–æ–¥</th>
                    <th>–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</th>
                    <th>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                    <th>5% VaR</th>
                    <th>95% VaR</th>
                </tr>
    """
    
    for method, analysis in results['analysis_results'].items():
        report += f"""
                <tr>
                    <td>{method}</td>
                    <td>{analysis['mean_return']:.4f}</td>
                    <td>{analysis['std_return']:.4f}</td>
                    <td>{analysis['percentile_5']:.4f}</td>
                    <td>{analysis['percentile_95']:.4f}</td>
                </tr>
        """
    
    report += """
            </table>
        </div>
    </body>
    </html>
    """
    
    return report

def save_report_to_file(results, filename="monte_carlo_report.html"):
    """
    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –≤ —Ñ–∞–π–ª
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
    - filename: –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    """
    
    report = generate_monte_carlo_report(results)
    
    with open(filename, 'w', encoding='utf-8') as f:
        f.write(report)
    
    print(f"–û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {filename}")
```

### 2. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```python
def create_interactive_dashboard(results):
    """
    –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Plotly
    –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - –æ–±—ä–µ–∫—Ç Plotly dashboard
    """
    
    try:
        import plotly.graph_objects as go
        from plotly.subplots import make_subplots
        import plotly.express as px
    except ImportError:
        print("–î–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ plotly: pip install plotly")
        return None
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–≥—Ä–∞—Ñ–∏–∫–æ–≤
    fig = make_subplots(
        rows=3, cols=2,
        subplot_titles=('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤', '–ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞ (VaR)', 
                       '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤', '–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
                       'Q-Q Plot', '–í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥'),
        specs=[[{"secondary_y": False}, {"secondary_y": False}],
               [{"secondary_y": False}, {"secondary_y": False}],
               [{"secondary_y": False}, {"secondary_y": False}]]
    )
    
    # –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    simple_results = results['simulation_results']['simple']
    bootstrap_results = results['simulation_results']['bootstrap']
    
    fig.add_trace(
        go.Histogram(x=simple_results, name='–ü—Ä–æ—Å—Ç–∞—è', opacity=0.7, nbinsx=50),
        row=1, col=1
    )
    fig.add_trace(
        go.Histogram(x=bootstrap_results, name='Bootstrap', opacity=0.7, nbinsx=50),
        row=1, col=1
    )
    
    # –ì—Ä–∞—Ñ–∏–∫ 2: –ö—Ä–∏–≤–∞—è —Ä–∏—Å–∫–∞
    confidence_levels = np.linspace(0.01, 0.5, 50)
    var_values = [np.percentile(simple_results, cl * 100) for cl in confidence_levels]
    
    fig.add_trace(
        go.Scatter(x=confidence_levels, y=var_values, mode='lines', name='VaR'),
        row=1, col=2
    )
    
    # –ì—Ä–∞—Ñ–∏–∫ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤
    methods = list(results['analysis_results'].keys())
    means = [results['analysis_results'][method]['mean_return'] for method in methods]
    stds = [results['analysis_results'][method]['std_return'] for method in methods]
    
    fig.add_trace(
        go.Bar(x=methods, y=means, name='–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å', error_y=dict(type='data', array=stds)),
        row=2, col=1
    )
    
    # –ì—Ä–∞—Ñ–∏–∫ 4: –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    stress_names = list(results['stress_results'].keys())
    stress_means = [np.mean(results['stress_results'][name]) for name in stress_names]
    
    fig.add_trace(
        go.Bar(x=stress_names, y=stress_means, name='–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ'),
        row=2, col=2
    )
    
    # –ì—Ä–∞—Ñ–∏–∫ 5: Q-Q Plot
    from scipy import stats
    qq_data = stats.probplot(simple_results, dist="norm")
    
    fig.add_trace(
        go.Scatter(x=qq_data[0][0], y=qq_data[0][1], mode='markers', name='Q-Q Plot'),
        row=3, col=1
    )
    
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–∫–µ—Ç–∞
    fig.update_layout(
        title_text="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏",
        showlegend=True,
        height=1200
    )
    
    return fig

def export_results_to_excel(results, filename="monte_carlo_results.xlsx"):
    """
    –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel —Ñ–∞–π–ª
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
    - filename: –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
    """
    
    try:
        import openpyxl
    except ImportError:
        print("–î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ openpyxl: pip install openpyxl")
        return
    
    with pd.ExcelWriter(filename, engine='openpyxl') as writer:
        # –õ–∏—Å—Ç —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
        summary_data = []
        for method, analysis in results['analysis_results'].items():
            summary_data.append({
                '–ú–µ—Ç–æ–¥': method,
                '–°—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å': analysis['mean_return'],
                '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ': analysis['std_return'],
                '5% VaR': analysis['percentile_5'],
                '95% VaR': analysis['percentile_95'],
                '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã–ª–∏': analysis['probability_positive'],
                '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–±—ã—Ç–∫–∞': analysis['probability_loss']
            })
        
        summary_df = pd.DataFrame(summary_data)
        summary_df.to_excel(writer, sheet_name='–°–≤–æ–¥–∫–∞', index=False)
        
        # –õ–∏—Å—Ç —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∏–º—É–ª—è—Ü–∏–π
        for method, sim_results in results['simulation_results'].items():
            if sim_results is not None:
                sim_df = pd.DataFrame({method: sim_results})
                sim_df.to_excel(writer, sheet_name=f'{method}_—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', index=False)
        
        # –õ–∏—Å—Ç —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Ä–∏—Å–∫–∞
        risk_data = {
            '–ú–µ—Ç—Ä–∏–∫–∞': ['5% VaR', '1% VaR', 'Expected Shortfall 95%', 'Expected Shortfall 99%'],
            '–ó–Ω–∞—á–µ–Ω–∏–µ': [
                results['risk_metrics']['var_95'],
                results['risk_metrics']['var_99'],
                results['risk_metrics']['es_95'],
                results['risk_metrics']['es_99']
            ]
        }
        risk_df = pd.DataFrame(risk_data)
        risk_df.to_excel(writer, sheet_name='–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∏—Å–∫–∞', index=False)
    
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª: {filename}")
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
def run_monte_carlo_tests():
    """
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏
    
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏.
    """
    
    print("–ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏...")
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    test_returns = np.random.normal(0.001, 0.02, 1000)
    
    tests_passed = 0
    total_tests = 0
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    total_tests += 1
    try:
        results = monte_carlo_simulation(test_returns, n_simulations=1000)
        assert len(results) == 1000
        assert not np.isnan(results).any()
        print("‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå –ü—Ä–æ—Å—Ç–∞—è —Å–∏–º—É–ª—è—Ü–∏—è: –û–®–ò–ë–ö–ê - {e}")
    
    # –¢–µ—Å—Ç 2: Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è
    total_tests += 1
    try:
        results = bootstrap_monte_carlo(test_returns, n_simulations=1000)
        assert len(results) == 1000
        assert not np.isnan(results).any()
        print("‚úÖ Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è: –û–®–ò–ë–ö–ê - {e}")
    
    # –¢–µ—Å—Ç 3: Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è
    total_tests += 1
    try:
        results = block_bootstrap_monte_carlo(test_returns, n_simulations=1000)
        assert len(results) == 1000
        assert not np.isnan(results).any()
        print("‚úÖ Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå Block Bootstrap —Å–∏–º—É–ª—è—Ü–∏—è: –û–®–ò–ë–ö–ê - {e}")
    
    # –¢–µ—Å—Ç 4: –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
    total_tests += 1
    try:
        results = autocorrelated_monte_carlo(test_returns, n_simulations=1000)
        assert len(results) == 1000
        assert not np.isnan(results).any()
        print("‚úÖ –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è: –û–®–ò–ë–ö–ê - {e}")
    
    # –¢–µ—Å—Ç 5: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    total_tests += 1
    try:
        results = monte_carlo_simulation(test_returns, n_simulations=1000)
        analysis = analyze_simulation_results(results)
        assert 'mean_return' in analysis
        assert 'std_return' in analysis
        print("‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: –û–®–ò–ë–ö–ê - {e}")
    
    # –¢–µ—Å—Ç 6: VaR —Ä–∞—Å—á–µ—Ç
    total_tests += 1
    try:
        results = monte_carlo_simulation(test_returns, n_simulations=1000)
        var_95 = calculate_var(results, 0.05)
        var_99 = calculate_var(results, 0.01)
        assert var_95 < 0  # VaR –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
        assert var_99 < var_95  # 99% VaR –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö—É–∂–µ 95% VaR
        print("‚úÖ VaR —Ä–∞—Å—á–µ—Ç: –ü–†–û–ô–î–ï–ù")
        tests_passed += 1
    except Exception as e:
        print(f"‚ùå VaR —Ä–∞—Å—á–µ—Ç: –û–®–ò–ë–ö–ê - {e}")
    
    # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
    print(f"\n{'='*50}")
    print(f"–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø")
    print(f"{'='*50}")
    print(f"–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: {tests_passed}/{total_tests}")
    print(f"–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {tests_passed/total_tests*100:.1f}%")
    
    if tests_passed == total_tests:
        print("üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!")
    else:
        print("‚ö†Ô∏è  –ù–ï–ö–û–¢–û–†–´–ï –¢–ï–°–¢–´ –ù–ï –ü–†–û–ô–î–ï–ù–´")
    
    return tests_passed == total_tests
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:
- **[09_risk_management.md](09_risk_management.md)** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏
- **[10_blockchain_deployment.md](10_blockchain_deployment.md)** - –ë–ª–æ–∫—á–µ–π–Ω –¥–µ–ø–ª–æ–π

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è** - –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤ –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
2. **Bootstrap –º–µ—Ç–æ–¥—ã** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. **Block Bootstrap** —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
4. **GARCH –º–æ–¥–µ–ª–∏** —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
5. **–ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è** –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
6. **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
7. **VaR –∏ Expected Shortfall** - –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–∏—Å–∫–∞
8. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
9. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞
10. **–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:**
- –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Bootstrap –¥–ª—è –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –í—Å–µ–≥–¥–∞ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Block Bootstrap –∏–ª–∏ GARCH –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—É—é —Å–∏–º—É–ª—è—Ü–∏—é –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
- –†–µ–≥—É–ª—è—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º—É–ª—è—Ü–∏–π
- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã

---

**–í–∞–∂–Ω–æ:** –ú–æ–Ωte-–ö–∞—Ä–ª–æ —Å–∏–º—É–ª—è—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –≤–æ–∑–º–æ–∂–Ω—É—é –ø—Ä–∏–±—ã–ª—å, –Ω–æ –∏ —Ä–∏—Å–∫–∏ –ø–æ—Ç–µ—Ä—å! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ –≤—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.
