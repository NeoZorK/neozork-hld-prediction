# –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ AutoML Gluon

**–ê–≤—Ç–æ—Ä:** Shcherbyna Rostyslav  
**–î–∞—Ç–∞:** 2024  

## –ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞

**–ü–æ—á–µ–º—É 70% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏–∑-–∑–∞ –ø–ª–æ—Ö–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–æ –∫–∞–∫ —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π.

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏?
- **–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª—å –∫–∞–∂–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π, –Ω–æ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ**: –ú–æ–¥–µ–ª—å –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ –∏–∑—É—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ø–ª–æ—Ö—É—é –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–æ —Ö–æ—Ä–æ—à–µ–π
- **–ë–∏–∑–Ω–µ—Å-–ø—Ä–æ–≤–∞–ª—ã**: –ú–æ–¥–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

### –ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è?
- **–†–µ–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**: –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è**: –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –æ–±–æ–±—â–∞—Ç—å, –∞ –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å
- **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä**: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–¥–∞—á–∏
- **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**: –ú–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é

<img src="images/optimized/validation_methods.png" alt="–ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 1: –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ AutoML Gluon*

<img src="images/optimized/walk_forward_analysis.png" alt="Walk-Forward –∞–Ω–∞–ª–∏–∑" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 2: Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å—Ö–µ–º–∞, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤*

**–ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏"?** –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–æ—Ç–æ–≤–∞ –ª–∏ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –º–∏—Ä—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç–µ –ø–∏–ª–æ—Ç–∞ –∫ –ø–æ–ª–µ—Ç—É - –≤–∞–ª–∏–¥–∞—Ü–∏—è —ç—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –æ–Ω –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.

–í–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ML-–º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –í AutoML Gluon –¥–æ—Å—Ç—É–ø–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á.

## –¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

<img src="images/optimized/robustness_analysis.png" alt="–¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 3: –†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ*

**–ü–æ—á–µ–º—É AutoML Gluon –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.

### üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –Ω–∞–¥–µ–∂–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π:

- **Holdout Validation**: –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test (70/30)
- **Cross-Validation**: K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
- **Time Series Split**: –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- **Stratified Split**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∫–ª–∞—Å—Å–æ–≤ –ø—Ä–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏
- **Walk-Forward Analysis**: –°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- **Bootstrap Validation**: –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
- **Monte Carlo Validation**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### 1. Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–ü–æ—á–µ–º—É Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Ç–æ–¥?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞: –≤—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª—è–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ - –æ–¥–Ω—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –¥—Ä—É–≥—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –≠—Ç–æ –∫–∞–∫ —ç–∫–∑–∞–º–µ–Ω –≤ —à–∫–æ–ª–µ - –≤—ã —É—á–∏—Ç–µ—Å—å –ø–æ —É—á–µ–±–Ω–∏–∫—É, –∞ —ç–∫–∑–∞–º–µ–Ω —Å–¥–∞–µ—Ç–µ –ø–æ –Ω–æ–≤—ã–º –∑–∞–¥–∞—á–∞–º.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ü–æ–Ω—è—Ç–Ω–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: 20% –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –æ–±—É—á–µ–Ω–∏–∏
- **–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å**: –ü–ª–æ—Ö–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–∫–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```python
from autogluon.tabular import TabularPredictor

# –ü—Ä–æ—Å—Ç–∞—è holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è
predictor = TabularPredictor(label='target')
predictor.fit(
    train_data,
    holdout_frac=0.2  # 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–ü–∞—Ä–∞–º–µ—Ç—Ä holdout_frac:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö, –≤—ã–¥–µ–ª—è–µ–º—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–¢–∏–ø**: float
- **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[0.0, 1.0)` (0% - 100%)
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 0.1 (10%)
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ú–∞–ª—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (< 1000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 0.2-0.3 (20-30%)
  - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (1000-10000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 0.15-0.25 (15-25%)
  - **–ë–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (> 10000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 0.1-0.2 (10-20%)
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ**:
  - **–ë–æ–ª—å—à–µ holdout_frac**: –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
  - **–ú–µ–Ω—å—à–µ holdout_frac**: –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - **–ë–∞–ª–∞–Ω—Å**: –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - **–°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
  - **–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤
  - **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ

**–ü–æ—á–µ–º—É 20% –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –≠—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

### 2. K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è

<img src="images/optimized/metrics_comparison.png" alt="K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 4: K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞*

**–ü–æ—á–µ–º—É K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞, —á–µ–º Holdout?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –≠—Ç–æ –∫–∞–∫ —Å–¥–∞—Ç—å 5 —ç–∫–∑–∞–º–µ–Ω–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º.

### üîÑ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã K-Fold

**–ü–æ—á–µ–º—É K-Fold –¥–∞–µ—Ç –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?** –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–≤—É–µ—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–∏, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

- **–ü–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –æ–±—É—á–µ–Ω–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏**: –ú–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
- **–õ—É—á—à–∞—è –æ—Ü–µ–Ω–∫–∞ –æ–±–æ–±—â–µ–Ω–∏—è**: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è:**
1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ K —á–∞—Å—Ç–µ–π**: –î–∞–Ω–Ω—ã–µ –¥–µ–ª—è—Ç—Å—è –Ω–∞ K —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π (–æ–±—ã—á–Ω–æ K=5 –∏–ª–∏ K=10)
2. **K –∏—Ç–µ—Ä–∞—Ü–∏–π**: –í –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–∞ —á–∞—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –æ—Å—Ç–∞–ª—å–Ω—ã–µ K-1 –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
3. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**: –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ K-1 —á–∞—Å—Ç—è—Ö
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ú–æ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏
5. **–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ - —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º K –∏—Ç–µ—Ä–∞—Ü–∏—è–º

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö**: –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–≤—É–µ—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–∏, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –º–æ–¥–µ–ª—å
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- **–í—Ä–µ–º—è**: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ K —Ä–∞–∑ –¥–æ–ª—å—à–µ
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- **–ü–∞–º—è—Ç—å**: –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å K –º–æ–¥–µ–ª–µ–π

```python
# K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
predictor.fit(
    train_data,
    num_bag_folds=5,  # 5-fold CV
    num_bag_sets=1
)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–ü–∞—Ä–∞–º–µ—Ç—Ä num_bag_folds:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–¢–∏–ø**: int
- **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[2, 20]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3-10)
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 8
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ú–∞–ª—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (< 1000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 3-5 —Ñ–æ–ª–¥–æ–≤
  - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (1000-10000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 5-7 —Ñ–æ–ª–¥–æ–≤
  - **–ë–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (> 10000 –ø—Ä–∏–º–µ—Ä–æ–≤)**: 7-10 —Ñ–æ–ª–¥–æ–≤
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ**:
  - **–ë–æ–ª—å—à–µ —Ñ–æ–ª–¥–æ–≤**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è
  - **–ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤**: –ë—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ñ–æ–ª–¥ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π
  - **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–æ–ª—å—à–µ —Ñ–æ–ª–¥–æ–≤ = –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - **–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤
  - **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
  - **–ü–∞–º—è—Ç—å**: –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

**–ü–∞—Ä–∞–º–µ—Ç—Ä num_bag_sets:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **–¢–∏–ø**: int
- **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[1, 10]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1-3)
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 1
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ë—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 1 –Ω–∞–±–æ—Ä
  - **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 2-3 –Ω–∞–±–æ—Ä–∞
  - **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: 3-5 –Ω–∞–±–æ—Ä–æ–≤
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ**:
  - **–ë–æ–ª—å—à–µ –Ω–∞–±–æ—Ä–æ–≤**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
  - **–ú–µ–Ω—å—à–µ –Ω–∞–±–æ—Ä–æ–≤**: –ë—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
  - **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ–∞–∑–∞**: 1 –Ω–∞–±–æ—Ä –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - **–§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 2-3 –Ω–∞–±–æ—Ä–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
  - **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã**: 3-5 –Ω–∞–±–æ—Ä–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

**–ü–æ—á–µ–º—É –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç 5 –∏–ª–∏ 10 —Ñ–æ–ª–¥–æ–≤?** –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é.

### 3. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ 100 —Ä–∞–∑ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–≥–æ. –≠—Ç–æ –∫–∞–∫ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≤—Ä–∞—á–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∑–¥–æ—Ä–æ–≤—ã–º –ø–∞—Ü–∏–µ–Ω—Ç–∞–º.

**–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
- **–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: 99% –∑–¥–æ—Ä–æ–≤—ã—Ö, 1% –±–æ–ª—å–Ω—ã—Ö
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞**: 99.9% –ª–µ–≥–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, 0.1% –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö
- **–°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä—ã**: 90% –æ–±—ã—á–Ω—ã—Ö –ø–∏—Å–µ–º, 10% —Å–ø–∞–º–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
1. **–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**: AutoML Gluon –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π**: –í –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
3. **–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**: –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**: –ü–æ–ª—É—á–∞–µ–º —Ç–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ö–æ–≥–¥–∞ –∫–ª–∞—Å—Å—ã –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ > 10:1)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Å—ã (–º–µ–¥–∏—Ü–∏–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã
- **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã

```python
# –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
predictor.fit(
    train_data,
    num_bag_folds=5,
    num_bag_sets=1,
    stratify=True  # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ
)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–ü–∞—Ä–∞–º–µ—Ç—Ä stratify:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–¢–∏–ø**: bool
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: False
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**:
  - **–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ > 10:1
  - **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã**: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Å—ã (–º–µ–¥–∏—Ü–∏–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
  - **–ú–∞–ª—ã–µ –∫–ª–∞—Å—Å—ã**: –ö–æ–≥–¥–∞ –º–∏–Ω–æ—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–º–µ—é—Ç < 100 –ø—Ä–∏–º–µ—Ä–æ–≤
  - **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**: –î–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**:
  - **–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ < 3:1
  - **–¢–æ–ª—å–∫–æ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã**: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã
  - **–†–µ–≥—Ä–µ—Å—Å–∏—è**: –°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–∞ –∫ –∑–∞–¥–∞—á–∞–º —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –º–∏–Ω–æ—Ä–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
  - **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**: –¢–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ precision, recall, F1-score
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**:
  - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä**: –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –º–∏–Ω–∏–º—É–º 2 –ø—Ä–∏–º–µ—Ä–∞ –Ω–∞ —Ñ–æ–ª–¥
  - **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü—Ä–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω—É–∂–Ω–∞ –Ω–µ –≤—Å–µ–≥–¥–∞?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞.
```

## Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è

<img src="images/optimized/monte_carlo_analysis.png" alt="–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 5: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏ backtest –∞–Ω–∞–ª–∏–∑*

**–ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞?** –ü–æ—Ç–æ–º—É —á—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–ª—å–∑—è –Ω–∞—Ä—É—à–∞—Ç—å:

- **–í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö**: –ë—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ—à–ª—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–Ω–¥—ã**: –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö

### –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

```python
from sklearn.model_selection import TimeSeriesSplit
import pandas as pd
import numpy as np

def time_series_backtest(data, target_col, n_splits=5):
    """Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤"""
    
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    data = data.sort_values('timestamp')
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ–ª–¥–æ–≤
    tscv = TimeSeriesSplit(n_splits=n_splits)
    
    results = []
    
    for fold, (train_idx, val_idx) in enumerate(tscv.split(data)):
        print(f"Fold {fold + 1}/{n_splits}")
        
        # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        train_fold = data.iloc[train_idx]
        val_fold = data.iloc[val_idx]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_fold, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(val_fold)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(val_fold)
        
        results.append({
            'fold': fold + 1,
            'performance': performance,
            'predictions': predictions
        })
    
    return results

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
backtest_results = time_series_backtest(data, 'target', n_splits=5)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è time_series_backtest:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü 'timestamp' –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω–¥–µ–∫—Å
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–ü—Ä–∏–º–µ—Ä—ã**: 'price', 'return', 'target'
  - **`n_splits`**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ–ª–¥–æ–≤
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[2, 20]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3-10)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 5
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä—è–¥—ã (< 1000 —Ç–æ—á–µ–∫)**: 3-5 —Ñ–æ–ª–¥–æ–≤
      - **–°—Ä–µ–¥–Ω–∏–µ —Ä—è–¥—ã (1000-10000 —Ç–æ—á–µ–∫)**: 5-7 —Ñ–æ–ª–¥–æ–≤
      - **–î–ª–∏–Ω–Ω—ã–µ —Ä—è–¥—ã (> 10000 —Ç–æ—á–µ–∫)**: 7-10 —Ñ–æ–ª–¥–æ–≤
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ–ª–¥–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`fold`**: –ù–æ–º–µ—Ä —Ñ–æ–ª–¥–∞ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
  - **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞**: –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
  - **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ç–µ—á–∫–∏**: –ë—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ—à–ª—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
  - **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**: –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**: –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –¥–∞–Ω–Ω—ã—Ö

**–ü–∞—Ä–∞–º–µ—Ç—Ä n_splits (TimeSeriesSplit):**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–¢–∏–ø**: int
- **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[2, 20]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3-10)
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ —Ñ–æ–ª–¥–æ–≤**: –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ñ–æ–ª–¥
  - **–ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤**: –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ñ–æ–ª–¥, –Ω–æ –º–µ–Ω–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ñ–æ–ª–¥ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π
  - **–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–Ω–¥—ã
  - **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã**: –ë–æ–ª—å—à–µ —Ñ–æ–ª–¥–æ–≤ = –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest

```python
def advanced_backtest(data, target_col, window_size=1000, step_size=100):
    """–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest —Å —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º"""
    
    results = []
    n_samples = len(data)
    
    for start in range(0, n_samples - window_size, step_size):
        end = start + window_size
        
        # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation
        train_data = data.iloc[start:end-100]
        val_data = data.iloc[end-100:end]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(val_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(val_data)
        
        results.append({
            'start': start,
            'end': end,
            'performance': performance,
            'predictions': predictions
        })
    
    return results
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ backtest:**

**–§—É–Ω–∫—Ü–∏—è advanced_backtest:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest —Å —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **`window_size`**: –†–∞–∑–º–µ—Ä —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[100, 10000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 500-2000)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 1000
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä—è–¥—ã**: 200-500 —Ç–æ—á–µ–∫
      - **–°—Ä–µ–¥–Ω–∏–µ —Ä—è–¥—ã**: 500-1000 —Ç–æ—á–µ–∫
      - **–î–ª–∏–Ω–Ω—ã–µ —Ä—è–¥—ã**: 1000-2000 —Ç–æ—á–µ–∫
  - **`step_size`**: –®–∞–≥ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –æ–∫–Ω–∞
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[10, window_size//2]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50-200)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 100
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑**: 50-100 —Ç–æ—á–µ–∫
      - **–ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑**: 100-200 —Ç–æ—á–µ–∫
      - **–û–±—â–∏–π –∞–Ω–∞–ª–∏–∑**: 200-500 —Ç–æ—á–µ–∫
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫–Ω–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`start`**: –ù–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –æ–∫–Ω–∞ (int)
  - **`end`**: –ö–æ–Ω–µ—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å –æ–∫–Ω–∞ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞**:
  - **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑**: –ë–æ–ª—å—à–µ —Ç–æ—á–µ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –¥–∞–Ω–Ω—ã—Ö
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  - **–¢—Ä–µ–Ω–¥—ã**: –í—ã—è–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä window_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ –æ–∫–Ω–æ**: –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –º–µ–Ω–µ–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å
  - **–ú–µ–Ω—å—à–µ –æ–∫–Ω–æ**: –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –±–æ–ª–µ–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ –æ–∫–Ω–∞
  - **–ò–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è –∏–∑–º–µ–Ω—á–∏–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ –æ–∫–Ω–∞
  - **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–µ—Ä–∏–æ–¥—ã —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö

**–ü–∞—Ä–∞–º–µ—Ç—Ä step_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –®–∞–≥ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –æ–∫–Ω–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ú–µ–Ω—å—à–µ —à–∞–≥**: –ë–æ–ª—å—à–µ —Ç–æ—á–µ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
  - **–ë–æ–ª—å—à–µ —à–∞–≥**: –ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –Ω–æ –±—ã—Å—Ç—Ä–µ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–î–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ —à–∞–≥–∏
  - **–°–∫–æ—Ä–æ—Å—Ç—å**: –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —à–∞–≥–∏
  - **–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É –æ–∫–Ω–∞–º–∏

## Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –ë–∞–∑–æ–≤–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
def walk_forward_validation(data, target_col, train_size=1000, test_size=100):
    """Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è"""
    
    results = []
    n_samples = len(data)
    
    for i in range(train_size, n_samples - test_size, test_size):
        # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞
        train_data = data.iloc[i-train_size:i]
        
        # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞
        test_data = data.iloc[i:i+test_size]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(test_data)
        
        results.append({
            'train_start': i-train_size,
            'train_end': i,
            'test_start': i,
            'test_end': i+test_size,
            'performance': performance,
            'predictions': predictions
        })
    
    return results

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
wf_results = walk_forward_validation(data, 'target', train_size=1000, test_size=100)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è walk_forward_validation:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–æ–∫
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **`train_size`**: –†–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[100, 10000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 500-2000)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 1000
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä—è–¥—ã**: 200-500 —Ç–æ—á–µ–∫
      - **–°—Ä–µ–¥–Ω–∏–µ —Ä—è–¥—ã**: 500-1000 —Ç–æ—á–µ–∫
      - **–î–ª–∏–Ω–Ω—ã–µ —Ä—è–¥—ã**: 1000-2000 —Ç–æ—á–µ–∫
  - **`test_size`**: –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[10, train_size//2]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50-200)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 100
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**: 50-100 —Ç–æ—á–µ–∫
      - **–ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞**: 100-200 —Ç–æ—á–µ–∫
      - **–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞**: 200-500 —Ç–æ—á–µ–∫
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`train_start`**: –ù–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ (int)
  - **`train_end`**: –ö–æ–Ω–µ—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ (int)
  - **`test_start`**: –ù–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (int)
  - **`test_end`**: –ö–æ–Ω–µ—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
  - **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –¥–∞–Ω–Ω—ã—Ö
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  - **–¢—Ä–µ–Ω–¥—ã**: –í—ã—è–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä train_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –º–µ–Ω–µ–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å
  - **–ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –±–æ–ª–µ–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–ò–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è –∏–∑–º–µ–Ω—á–∏–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–µ—Ä–∏–æ–¥—ã —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö

**–ü–∞—Ä–∞–º–µ—Ç—Ä test_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –º–µ–Ω—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **–ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π, –Ω–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –î–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–î–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–ë–∞–ª–∞–Ω—Å**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é –∏ –¥–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å—é

### –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
def adaptive_walk_forward(data, target_col, min_train_size=500, max_train_size=2000):
    """–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –æ–∫–Ω–∞"""
    
    results = []
    n_samples = len(data)
    current_train_size = min_train_size
    
    for i in range(min_train_size, n_samples - 100, 100):
        # –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
        if i > n_samples // 2:
            current_train_size = min(max_train_size, current_train_size + 100)
        
        # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞
        train_data = data.iloc[i-current_train_size:i]
        
        # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞
        test_data = data.iloc[i:i+100]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(test_data)
        
        results.append({
            'train_size': current_train_size,
            'performance': performance,
            'predictions': predictions
        })
    
    return results
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è adaptive_walk_forward:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **`min_train_size`**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[100, 1000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 200-500)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 500
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä—è–¥—ã**: 100-200 —Ç–æ—á–µ–∫
      - **–°—Ä–µ–¥–Ω–∏–µ —Ä—è–¥—ã**: 200-500 —Ç–æ—á–µ–∫
      - **–î–ª–∏–Ω–Ω—ã–µ —Ä—è–¥—ã**: 500-1000 —Ç–æ—á–µ–∫
  - **`max_train_size`**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[min_train_size, 10000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1000-5000)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 2000
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ä—è–¥—ã**: 500-1000 —Ç–æ—á–µ–∫
      - **–°—Ä–µ–¥–Ω–∏–µ —Ä—è–¥—ã**: 1000-2000 —Ç–æ—á–µ–∫
      - **–î–ª–∏–Ω–Ω—ã–µ —Ä—è–¥—ã**: 2000-5000 —Ç–æ—á–µ–∫
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`train_size`**: –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
  - **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º
  - **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–µ—Ä–µ –∏—Ö –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  - **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä min_train_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –≤ –Ω–∞—á–∞–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –º–µ–Ω—å—à–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - **–ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª–µ–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤ –Ω–∞—á–∞–ª–µ
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –Ω–∞—á–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –î–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–ë–∞–ª–∞–Ω—Å**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å—é

**–ü–∞—Ä–∞–º–µ—Ç—Ä max_train_size:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –≤ –∫–æ–Ω—Ü–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∫–æ–Ω–µ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è
  - **–ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä**: –ë—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∫–æ–Ω–µ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∫–æ–Ω–µ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–°–∫–æ—Ä–æ—Å—Ç—å**: –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã
  - **–†–µ—Å—É—Ä—Å—ã**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

## Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–π Monte Carlo

```python
def monte_carlo_validation(data, target_col, n_iterations=100, train_frac=0.8):
    """Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Å–ª—É—á–∞–π–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö"""
    
    results = []
    
    for iteration in range(n_iterations):
        # –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        train_data = data.sample(frac=train_frac, random_state=iteration)
        test_data = data.drop(train_data.index)
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(test_data)
        
        results.append({
            'iteration': iteration,
            'performance': performance,
            'predictions': predictions
        })
    
    return results

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
mc_results = monte_carlo_validation(data, 'target', n_iterations=100)
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è monte_carlo_validation:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **`n_iterations`**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[10, 1000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50-200)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 100
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ë—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 20-50 –∏—Ç–µ—Ä–∞—Ü–∏–π
      - **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 50-100 –∏—Ç–µ—Ä–∞—Ü–∏–π
      - **–¢—â–∞—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 100-200 –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **`train_frac`**: –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
    - **–¢–∏–ø**: float
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[0.5, 0.9]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.7-0.8)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 0.8
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ú–∞–ª—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã**: 0.7-0.8 (70-80%)
      - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã**: 0.8-0.85 (80-85%)
      - **–ë–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã**: 0.85-0.9 (85-90%)
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`iteration`**: –ù–æ–º–µ—Ä –∏—Ç–µ—Ä–∞—Ü–∏–∏ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
  - **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
  - **–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
  - **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å**: –ë–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  - **–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å**: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–ª—É—á–∞–π–Ω—ã–º —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—è–º

**–ü–∞—Ä–∞–º–µ—Ç—Ä n_iterations:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π**: –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
  - **–ú–µ–Ω—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π**: –ë—ã—Å—Ç—Ä–µ–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å**: –î–ª—è –∑–Ω–∞—á–∏–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 100+ –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **–í—Ä–µ–º—è**: –î–ª—è –±—ã—Å—Ç—Ä–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 20-50 –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **–†–µ—Å—É—Ä—Å—ã**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä train_frac:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ –¥–æ–ª—è**: –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –º–µ–Ω—å—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - **–ú–µ–Ω—å—à–µ –¥–æ–ª—è**: –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–æ –±–æ–ª—å—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è
  - **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 0.8-0.85
  - **–ë–∞–ª–∞–Ω—Å**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –æ–±—É—á–µ–Ω–∏–µ–º –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
def bootstrap_validation(data, target_col, n_bootstrap=100):
    """Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è"""
    
    results = []
    n_samples = len(data)
    
    for i in range(n_bootstrap):
        # Bootstrap –≤—ã–±–æ—Ä–∫–∞
        bootstrap_indices = np.random.choice(n_samples, size=n_samples, replace=True)
        bootstrap_data = data.iloc[bootstrap_indices]
        
        # Out-of-bag –≤—ã–±–æ—Ä–∫–∞
        oob_indices = np.setdiff1d(np.arange(n_samples), np.unique(bootstrap_indices))
        oob_data = data.iloc[oob_indices]
        
        if len(oob_data) == 0:
            continue
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(bootstrap_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ OOB –¥–∞–Ω–Ω—ã—Ö
        predictions = predictor.predict(oob_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        performance = predictor.evaluate(oob_data)
        
        results.append({
            'bootstrap': i,
            'performance': performance,
            'predictions': predictions
        })
    
    return results
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è bootstrap_validation:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Å–ª—É—á–∞–π–Ω–æ–π –≤—ã–±–æ—Ä–∫–æ–π —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`data`**: –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢–∏–ø**: DataFrame
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: –î–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
  - **`target_col`**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **`n_bootstrap`**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ bootstrap –∏—Ç–µ—Ä–∞—Ü–∏–π
    - **–¢–∏–ø**: int
    - **–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π**: `[10, 1000]` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50-200)
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 100
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
      - **–ë—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 20-50 –∏—Ç–µ—Ä–∞—Ü–∏–π
      - **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 50-100 –∏—Ç–µ—Ä–∞—Ü–∏–π
      - **–¢—â–∞—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 100-200 –∏—Ç–µ—Ä–∞—Ü–∏–π
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: list - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π bootstrap –∏—Ç–µ—Ä–∞—Ü–∏–∏
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
  - **`bootstrap`**: –ù–æ–º–µ—Ä bootstrap –∏—Ç–µ—Ä–∞—Ü–∏–∏ (int)
  - **`performance`**: –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (dict)
  - **`predictions`**: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:
  - **–°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º**: –ö–∞–∂–¥–∞—è bootstrap –≤—ã–±–æ—Ä–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ
  - **Out-of-bag –æ—Ü–µ–Ω–∫–∞**: –ú–æ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–≤—à–∏—Ö –≤ –æ–±—É—á–µ–Ω–∏–∏
  - **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
  - **–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

**–ü–∞—Ä–∞–º–µ—Ç—Ä n_bootstrap:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ bootstrap –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
  - **–ë–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π**: –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –Ω–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
  - **–ú–µ–Ω—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π**: –ë—ã—Å—Ç—Ä–µ–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å**: –î–ª—è –∑–Ω–∞—á–∏–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 100+ –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **–í—Ä–µ–º—è**: –î–ª—è –±—ã—Å—Ç—Ä–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 20-50 –∏—Ç–µ—Ä–∞—Ü–∏–π
  - **–†–µ—Å—É—Ä—Å—ã**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Bootstrap**:
  - **–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –≤—ã–±–æ—Ä–∫—É
  - **–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö
  - **Out-of-bag**: –î–∞–Ω–Ω—ã–µ, –Ω–µ –ø–æ–ø–∞–≤—à–∏–µ –≤ bootstrap –≤—ã–±–æ—Ä–∫—É, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### Ensemble –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
def ensemble_validation(data, target_col, validation_methods=['holdout', 'kfold', 'monte_carlo']):
    """–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏"""
    
    results = {}
    
    # Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if 'holdout' in validation_methods:
        predictor = TabularPredictor(label=target_col)
        predictor.fit(data, holdout_frac=0.2)
        results['holdout'] = predictor.evaluate(data)
    
    # K-fold –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if 'kfold' in validation_methods:
        predictor = TabularPredictor(label=target_col)
        predictor.fit(data, num_bag_folds=5, num_bag_sets=1)
        results['kfold'] = predictor.evaluate(data)
    
    # Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if 'monte_carlo' in validation_methods:
        mc_results = monte_carlo_validation(data, target_col, n_iterations=50)
        results['monte_carlo'] = mc_results
    
    return results
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
def financial_validation(data, target_col, lookback_window=252, forward_window=21):
    """–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    results = []
    n_samples = len(data)
    
    for i in range(lookback_window, n_samples - forward_window, forward_window):
        # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (lookback_window –¥–Ω–µ–π)
        train_data = data.iloc[i-lookback_window:i]
        
        # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (forward_window –¥–Ω–µ–π)
        test_data = data.iloc[i:i+forward_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        predictor = TabularPredictor(label=target_col)
        predictor.fit(train_data, time_limit=300)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = predictor.predict(test_data)
        
        # –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        returns = test_data[target_col].pct_change().dropna()
        predicted_returns = predictions.pct_change().dropna()
        
        # Sharpe Ratio
        sharpe_ratio = returns.mean() / returns.std() * np.sqrt(252)
        
        # Maximum Drawdown
        cumulative_returns = (1 + returns).cumprod()
        peak = cumulative_returns.expanding().max()
        drawdown = (cumulative_returns - peak) / peak
        max_drawdown = drawdown.min()
        
        results.append({
            'start_date': test_data.index[0],
            'end_date': test_data.index[-1],
            'sharpe_ratio': sharpe_ratio,
            'max_drawdown': max_drawdown,
            'predictions': predictions
        })
    
    return results
```

## –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

```python
def analyze_validation_results(results):
    """–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"""
    
    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    metrics = []
    for result in results:
        if 'performance' in result:
            metrics.append(result['performance'])
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
    analysis = {}
    
    for metric in metrics[0].keys():
        values = [m[metric] for m in metrics]
        analysis[metric] = {
            'mean': np.mean(values),
            'std': np.std(values),
            'min': np.min(values),
            'max': np.max(values),
            'median': np.median(values),
            'q25': np.percentile(values, 25),
            'q75': np.percentile(values, 75)
        }
    
    return analysis

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
analysis = analyze_validation_results(backtest_results)
print("Validation Analysis:")
for metric, stats in analysis.items():
    print(f"{metric}: {stats['mean']:.4f} ¬± {stats['std']:.4f}")
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è analyze_validation_results:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`results`**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢–∏–ø**: list
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 'performance' —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: dict - —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–Ω–∞–ª–∏–∑–∞**:
  - **`mean`**: –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`std`**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`min`**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`max`**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`median`**: –ú–µ–¥–∏–∞–Ω–∞ –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`q25`**: 25-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –º–µ—Ç—Ä–∏–∫–∏ (float)
  - **`q75`**: 75-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –º–µ—Ç—Ä–∏–∫–∏ (float)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
  - **–û—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏**: –ê–Ω–∞–ª–∏–∑ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –º–µ—Ç—Ä–∏–∫
  - **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - **–í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º**: –ü–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - **–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –æ –∫–∞—á–µ—Å—Ç–≤–µ –º–æ–¥–µ–ª–∏

**–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:**
- **`mean`**: –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
  - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
  - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
- **`std`**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
  - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
  - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –û—Ü–µ–Ω–∫–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
- **`min`/`max`**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ/–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: –î–∏–∞–ø–∞–∑–æ–Ω –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
  - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –û—Ü–µ–Ω–∫–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **`median`**: –ú–µ–¥–∏–∞–Ω–∞ –º–µ—Ç—Ä–∏–∫–∏
  - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: –£—Å—Ç–æ–π—á–∏–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —Å—Ä–µ–¥–Ω–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
- **`q25`/`q75`**: 25-–π/75-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å
  - **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
  - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –û—Ü–µ–Ω–∫–∞ —Ä–∞–∑–±—Ä–æ—Å–∞ –∑–Ω–∞—á–µ–Ω–∏–π

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
import matplotlib.pyplot as plt
import seaborn as sns

def plot_validation_results(results, metric='accuracy'):
    """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"""
    
    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    values = []
    for result in results:
        if 'performance' in result and metric in result['performance']:
            values.append(result['performance'][metric])
    
    # –ì—Ä–∞—Ñ–∏–∫
    plt.figure(figsize=(12, 8))
    
    # –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –º–µ—Ç—Ä–∏–∫–∏
    plt.subplot(2, 2, 1)
    plt.plot(values)
    plt.title(f'{metric} over time')
    plt.xlabel('Fold/Iteration')
    plt.ylabel(metric)
    
    # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
    plt.subplot(2, 2, 2)
    plt.hist(values, bins=20, alpha=0.7)
    plt.title(f'Distribution of {metric}')
    plt.xlabel(metric)
    plt.ylabel('Frequency')
    
    # Box plot
    plt.subplot(2, 2, 3)
    plt.boxplot(values)
    plt.title(f'Box plot of {metric}')
    plt.ylabel(metric)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    plt.subplot(2, 2, 4)
    stats_text = f"""
    Mean: {np.mean(values):.4f}
    Std: {np.std(values):.4f}
    Min: {np.min(values):.4f}
    Max: {np.max(values):.4f}
    """
    plt.text(0.1, 0.5, stats_text, transform=plt.gca().transAxes, fontsize=12)
    plt.axis('off')
    
    plt.tight_layout()
    plt.show()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
plot_validation_results(backtest_results, metric='accuracy')
```

**üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**

**–§—É–Ω–∫—Ü–∏—è plot_validation_results:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - **`results`**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–¢–∏–ø**: list
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    - **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 'performance' —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
  - **`metric`**: –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
    - **–¢–∏–ø**: str
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    - **–ü—Ä–∏–º–µ—Ä—ã**: 'accuracy', 'f1', 'roc_auc', 'rmse', 'mae'
    - **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 'accuracy'
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: None (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫)
- **–¢–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤**:
  - **–í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - **–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –º–µ—Ç—Ä–∏–∫–∏
  - **Box plot**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–µ—Ç—Ä–∏–∫–∏ (–º–µ–¥–∏–∞–Ω–∞, –∫–≤–∞—Ä—Ç–∏–ª–∏, –≤—ã–±—Ä–æ—Å—ã)
  - **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**: –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
  - **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤**: –í—ã—è–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–æ–¥–µ–ª–∏
  - **–û—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏**: –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–±—Ä–æ—Å–∞ –∑–Ω–∞—á–µ–Ω–∏–π –º–µ—Ç—Ä–∏–∫–∏
  - **–í—ã—è–≤–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤**: –ü–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - **–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

**–ü–∞—Ä–∞–º–µ—Ç—Ä metric:**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**:
  - **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: 'accuracy', 'f1', 'precision', 'recall', 'roc_auc'
  - **–†–µ–≥—Ä–µ—Å—Å–∏—è**: 'rmse', 'mae', 'r2', 'mse'
  - **–ö–∞—Å—Ç–æ–º–Ω—ã–µ**: –õ—é–±—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏**:
  - **–û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –º–µ—Ç—Ä–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ**: –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
  - **–ê–Ω–∞–ª–∏–∑**: –í—ã–±–∏—Ä–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏, –≤–∞–∂–Ω—ã–µ –¥–ª—è –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```python
from autogluon.tabular import TabularPredictor
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
X, y = make_classification(
    n_samples=10000,
    n_features=20,
    n_informative=15,
    n_redundant=5,
    n_classes=2,
    random_state=42
)

data = pd.DataFrame(X, columns=[f'feature_{i}' for i in range(20)])
data['target'] = y

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏
data['timestamp'] = pd.date_range('2020-01-01', periods=len(data), freq='D')
data = data.set_index('timestamp')

# –†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
print("=== Holdout Validation ===")
predictor_holdout = TabularPredictor(label='target')
predictor_holdout.fit(data, holdout_frac=0.2, time_limit=300)
holdout_performance = predictor_holdout.evaluate(data)
print(f"Holdout Performance: {holdout_performance}")

print("\n=== K-Fold Validation ===")
predictor_kfold = TabularPredictor(label='target')
predictor_kfold.fit(data, num_bag_folds=5, num_bag_sets=1, time_limit=300)
kfold_performance = predictor_kfold.evaluate(data)
print(f"K-Fold Performance: {kfold_performance}")

print("\n=== Time Series Backtest ===")
backtest_results = time_series_backtest(data, 'target', n_splits=5)
backtest_analysis = analyze_validation_results(backtest_results)
print(f"Backtest Analysis: {backtest_analysis}")

print("\n=== Monte Carlo Validation ===")
mc_results = monte_carlo_validation(data, 'target', n_iterations=50)
mc_analysis = analyze_validation_results(mc_results)
print(f"Monte Carlo Analysis: {mc_analysis}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
plot_validation_results(backtest_results, metric='accuracy')
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

<img src="images/optimized/advanced_topics_overview.png" alt="–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 6: –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω—ã –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –Ω–∞–¥–µ–∂–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π:

- **–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–¥–∞—á–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∞–Ω—Å–∞–º–±–ª–µ–π**: –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è
- **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ò–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–æ–∫**: –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Å–ø–æ—Å–æ–±—ã –∏—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è

### –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```python
def choose_validation_method(data_type, problem_type, data_size):
    """–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"""
    
    if data_type == 'time_series':
        return 'time_series_backtest'
    elif data_size < 1000:
        return 'kfold'
    elif data_size < 10000:
        return 'holdout'
    else:
        return 'monte_carlo'
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```python
def optimize_validation_params(data, target_col):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"""
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ–ª–¥–æ–≤
    n_samples = len(data)
    if n_samples < 100:
        n_folds = 3
    elif n_samples < 1000:
        n_folds = 5
    else:
        n_folds = 10
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ holdout
    if n_samples < 1000:
        holdout_frac = 0.3
    else:
        holdout_frac = 0.2
    
    return {
        'n_folds': n_folds,
        'holdout_frac': holdout_frac,
        'n_monte_carlo': min(100, n_samples // 10)
    }
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏

<img src="images/optimized/troubleshooting_flowchart.png" alt="–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 7: –î–∏–∞–≥—Ä–∞–º–º–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, –∫–∞–∫ —É—Å—Ç—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∏ –ø—Ä–æ–±–ª–µ–º—ã –≤–æ–∑–Ω–∏–∫–∞—é—Ç —á–∞—Å—Ç–æ:

- **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (Overfitting)**: –ú–æ–¥–µ–ª—å –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ (Underfitting)**: –ú–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: –ë–æ–ª—å—à–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –º–µ–∂–¥—É —Ñ–æ–ª–¥–∞–º–∏
- **–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Data Leakage)**: –ë—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ—à–ª—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫**: –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –±–∏–∑–Ω–µ—Å-—Ü–µ–ª—è–º
- **–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏**: –ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### üîß –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**–ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ–¥–≤–æ–¥–Ω—ã—Ö –∫–∞–º–Ω–µ–π:

- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ ‚Üí **–†–µ—à–µ–Ω–∏–µ**: –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è, –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ—â–µ –º–æ–¥–µ–ª—å
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ ‚Üí **–†–µ—à–µ–Ω–∏–µ**: –°–ª–æ–∂–Ω–µ–µ –º–æ–¥–µ–ª—å, –±–æ–ª—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí **–†–µ—à–µ–Ω–∏–µ**: –ë–æ–ª—å—à–µ —Ñ–æ–ª–¥–æ–≤, —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–±–ª–µ–º–∞**: –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –≤—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ ‚Üí **–†–µ—à–µ–Ω–∏–µ**: –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –ø–æ –±–∏–∑–Ω–µ—Å-—Ü–µ–ª—è–º

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:
- [–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é](./06_production.md)
- [–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π](./07_retraining.md)
- [–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º](./08_best_practices.md)
