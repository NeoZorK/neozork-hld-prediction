# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon (M1/M2/M3)

**–ê–≤—Ç–æ—Ä:** Shcherbyna Rostyslav  
**–î–∞—Ç–∞:** 2024  

## –ü–æ—á–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞

**–ü–æ—á–µ–º—É Apple Silicon - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–∏ —á–∏–ø—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è ML-–∑–∞–¥–∞—á, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤ 3-5 —Ä–∞–∑ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –º–µ–Ω—å—à–µ–º —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Apple Silicon –¥–ª—è ML
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å**: CPU –∏ GPU –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â—É—é –ø–∞–º—è—Ç—å (–¥–æ 128GB)
- **–í—ã—Å–æ–∫–∞—è —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –í 2-3 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —è–¥—Ä–∞**: Neural Engine –¥–ª—è ML-–æ–ø–µ—Ä–∞—Ü–∏–π
- **Metal Performance Shaders**: GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –í 3-5 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –º–æ–≥–ª–æ –±—ã –±—ã—Ç—å
- **–í—ã—Å–æ–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ**: –ë–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è –∑–∞ —á–∞—Å—ã
- **–ü–µ—Ä–µ–≥—Ä–µ–≤**: –°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–º–æ–∑–∏—Ç –∏–∑-–∑–∞ —Ç–µ–ø–ª–æ–≤–æ–≥–æ –¥—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**: –¢–æ–ª—å–∫–æ CPU, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ GPU

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è Apple Silicon

<img src="images/optimized/apple_silicon_optimization.png" alt="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É Apple Silicon —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞?** –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ARM, –∞ –Ω–µ x86, –∏ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

Apple Silicon MacBook —Å —á–∏–ø–∞–º–∏ M1, M2, M3 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑:
- **MLX** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Apple Silicon
- **Ray** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon
- **OpenMP** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- **Metal Performance Shaders (MPS)** - GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon

<img src="images/optimized/advanced_topics_overview.png" alt="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 2: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è?** –ü–æ—Ç–æ–º—É —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –¥–ª—è x86, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ —á–µ—Ä–µ–∑ —ç–º—É–ª—è—Ü–∏—é Rosetta.

**–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
- **–ù–∞—Ç–∏–≤–Ω—ã–µ ARM64 –ø–∞–∫–µ—Ç—ã**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ conda –≤–º–µ—Å—Ç–æ pip
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**: NumPy, SciPy —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Accelerate
- **Metal Performance Shaders**: GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **OpenMP**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ CPU
- **MLX**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è ML
- **Ray**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon

### 1. –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π

**–ü–æ—á–µ–º—É conda –ª—É—á—à–µ pip –¥–ª—è Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ conda –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–µ ARM64 –ø–∞–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ 2-3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ conda –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon
conda create -n autogluon-m1 python=3.9
conda activate autogluon-m1

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - –Ω–∞—Ç–∏–≤–Ω—ã–µ ARM64 –≤–µ—Ä—Å–∏–∏
conda install -c conda-forge numpy pandas scikit-learn matplotlib seaborn

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MPS (Metal Performance Shaders)
pip install torch torchvision torchaudio

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon
pip install autogluon
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX –¥–ª—è Apple Silicon

**–ü–æ—á–µ–º—É MLX - —ç—Ç–æ –±—É–¥—É—â–µ–µ ML –Ω–∞ Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π Apple –¥–ª—è –∏—Ö —á–∏–ø–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ MLX:**
- **–ù–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Apple Silicon
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –í 2-3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ PyTorch
- **–≠–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ú–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: API –ø–æ—Ö–æ–∂ –Ω–∞ NumPy

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è ML
pip install mlx mlx-lm

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö MLX –ø–∞–∫–µ—Ç–æ–≤ - –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏
pip install mlx-optimizers mlx-nn
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray –¥–ª—è Apple Silicon

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon
pip install ray[default]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Apple Silicon
python -c "import ray; print(ray.__version__)"
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenMP –¥–ª—è macOS
brew install libomp

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –±–∏–Ω–¥–∏–Ω–≥–æ–≤
pip install openmp-python
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon

<img src="images/optimized/metrics_detailed.png" alt="–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 3: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç —Å–Ω–∏–∑–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ 2-3 —Ä–∞–∑–∞:

**–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
- **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MPS –≤–º–µ—Å—Ç–æ CUDA –¥–ª—è GPU
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ç–æ–∫–æ–≤**: –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU –ø–æ—Ç–æ–∫–æ–≤
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
- **Metal Performance Shaders**: GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **OpenMP**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ CPU
- **MLX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö Apple –±–∏–±–ª–∏–æ—Ç–µ–∫

### 1. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MPS

```python
import os
import torch
import numpy as np

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA
os.environ['CUDA_VISIBLE_DEVICES'] = ''
os.environ['CUDA_DEVICE_ORDER'] = 'PCI_BUS_ID'

# –í–∫–ª—é—á–µ–Ω–∏–µ MPS (Metal Performance Shaders) –¥–ª—è Apple Silicon
if torch.backends.mps.is_available():
    os.environ['PYTORCH_ENABLE_MPS_FALLBACK'] = '1'
    print("MPS (Metal Performance Shaders) –¥–æ—Å—Ç—É–ø–µ–Ω")
else:
    print("MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon
os.environ['OMP_NUM_THREADS'] = str(torch.get_num_threads())
os.environ['MKL_NUM_THREADS'] = str(torch.get_num_threads())
os.environ['OPENBLAS_NUM_THREADS'] = str(torch.get_num_threads())

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
print(f"PyTorch version: {torch.__version__}")
print(f"MPS available: {torch.backends.mps.is_available()}")
print(f"MPS built: {torch.backends.mps.is_built()}")
print(f"CPU threads: {torch.get_num_threads()}")
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è Apple Silicon

```python
from autogluon.tabular import TabularPredictor
import autogluon as ag

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon
def configure_apple_silicon():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è Apple Silicon"""
    
    # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA
    ag.set_config({
        'num_gpus': 0,
        'num_cpus': torch.get_num_threads(),
        'memory_limit': 8,  # GB
        'time_limit': 3600
    })
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è MPS
    if torch.backends.mps.is_available():
        print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ")
    else:
        print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU")
    
    return ag

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
configure_apple_silicon()
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MLX

### 1. –°–æ–∑–¥–∞–Ω–∏–µ MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

```python
import mlx.core as mx
import mlx.nn as nn
from autogluon.tabular import TabularPredictor
import numpy as np

class MLXOptimizedPredictor:
    """MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –¥–ª—è Apple Silicon"""
    
    def __init__(self, model_path: str):
        self.model_path = model_path
        self.mlx_model = None
        self.feature_names = None
    
    def load_mlx_model(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –≤ MLX"""
        try:
            # –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
            weights = mx.load(f"{self.model_path}/mlx_weights.npz")
            
            # –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏
            self.mlx_model = self.create_mlx_architecture(weights)
            
            print("MLX –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
            return True
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ MLX –º–æ–¥–µ–ª–∏: {e}")
            return False
    
    def create_mlx_architecture(self, weights):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã MLX –º–æ–¥–µ–ª–∏"""
        
        class MLXTabularModel(nn.Module):
            def __init__(self, input_size, hidden_sizes, output_size):
                super().__init__()
                self.layers = []
                
                # –í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
                self.layers.append(nn.Linear(input_size, hidden_sizes[0]))
                
                # –°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏
                for i in range(len(hidden_sizes) - 1):
                    self.layers.append(nn.Linear(hidden_sizes[i], hidden_sizes[i + 1]))
                    self.layers.append(nn.ReLU())
                
                # –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
                self.layers.append(nn.Linear(hidden_sizes[-1], output_size))
            
            def __call__(self, x):
                for layer in self.layers:
                    x = layer(x)
                return x
        
        return MLXTabularModel
    
    def predict_mlx(self, data: np.ndarray) -> np.ndarray:
        """–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MLX"""
        if self.mlx_model is None:
            raise ValueError("MLX –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ MLX –º–∞—Å—Å–∏–≤
        mlx_data = mx.array(data.astype(np.float32))
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        with mx.eval():
            predictions = self.mlx_model(mlx_data)
        
        return np.array(predictions)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
def create_mlx_predictor(model_path: str):
    """–°–æ–∑–¥–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞"""
    predictor = MLXOptimizedPredictor(model_path)
    
    if predictor.load_mlx_model():
        return predictor
    else:
        return None
```

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MLX

```python
def optimize_data_for_mlx(data: pd.DataFrame) -> np.ndarray:
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MLX"""
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ numpy —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º
    data_array = data.select_dtypes(include=[np.number]).values.astype(np.float32)
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è MLX
    data_array = (data_array - data_array.mean(axis=0)) / (data_array.std(axis=0) + 1e-8)
    
    return data_array

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
def train_with_mlx_optimization(train_data: pd.DataFrame):
    """–û–±—É—á–µ–Ω–∏–µ —Å MLX –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π"""
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    optimized_data = optimize_data_for_mlx(train_data)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label='target',
        problem_type='auto',
        eval_metric='auto',
        path='./mlx_models'
    )
    
    # –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è Apple Silicon
    predictor.fit(
        train_data,
        ag_args_fit={
            'num_cpus': torch.get_num_threads(),
            'num_gpus': 0,
            'memory_limit': 8
        },
        time_limit=3600
    )
    
    return predictor
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple Silicon

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ray –∫–ª–∞—Å—Ç–µ—Ä–∞

```python
import ray
from ray import tune
import autogluon as ag

def configure_ray_apple_silicon():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple Silicon"""
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Apple Silicon
    ray.init(
        num_cpus=torch.get_num_threads(),
        num_gpus=0,  # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ GPU –¥–ª—è Apple Silicon
        object_store_memory=2 * 1024 * 1024 * 1024,  # 2GB
        ignore_reinit_error=True
    )
    
    print(f"Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: {ray.is_initialized()}")
    print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã: {ray.cluster_resources()}")
    
    return ray

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray
ray_cluster = configure_ray_apple_silicon()
```

### 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å Ray

```python
@ray.remote
def train_model_remote(data_chunk, model_config):
    """–£–¥–∞–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏"""
    
    from autogluon.tabular import TabularPredictor
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label=model_config['label'],
        problem_type=model_config['problem_type'],
        eval_metric=model_config['eval_metric']
    )
    
    # –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
    predictor.fit(
        data_chunk,
        time_limit=model_config['time_limit'],
        presets=model_config['presets']
    )
    
    return predictor

def distributed_training_apple_silicon(data: pd.DataFrame, n_workers: int = 4):
    """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon"""
    
    # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏
    chunk_size = len(data) // n_workers
    data_chunks = [data.iloc[i:i+chunk_size] for i in range(0, len(data), chunk_size)]
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
    model_config = {
        'label': 'target',
        'problem_type': 'auto',
        'eval_metric': 'auto',
        'time_limit': 1800,
        'presets': 'medium_quality'
    }
    
    # –ó–∞–ø—É—Å–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    futures = []
    for chunk in data_chunks:
        future = train_model_remote.remote(chunk, model_config)
        futures.append(future)
    
    # –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    results = ray.get(futures)
    
    return results

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
def run_distributed_training(data: pd.DataFrame):
    """–ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è"""
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray
    configure_ray_apple_silicon()
    
    # –ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
    models = distributed_training_apple_silicon(data, n_workers=4)
    
    print(f"–û–±—É—á–µ–Ω–æ {len(models)} –º–æ–¥–µ–ª–µ–π")
    
    return models
```

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP

<img src="images/optimized/performance_comparison.png" alt="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP –¥–ª—è Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–∂–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ 2-4 —Ä–∞–∑–∞:

**–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ OpenMP:**
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ç–æ–∫–æ–≤**: –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU –ø–æ—Ç–æ–∫–æ–≤
- **–ü—Ä–∏–≤—è–∑–∫–∞ –ø–æ—Ç–æ–∫–æ–≤**: –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —è–¥—Ä–∞–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—ã—è–≤–ª–µ–Ω–∏–µ —É–∑–∫–∏—Ö –º–µ—Å—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon

```python
import os
import multiprocessing as mp

def configure_openmp_apple_silicon():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon"""
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä
    num_cores = mp.cpu_count()
    print(f"–î–æ—Å—Ç—É–ø–Ω–æ —è–¥–µ—Ä: {num_cores}")
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    os.environ['OMP_NUM_THREADS'] = str(num_cores)
    os.environ['MKL_NUM_THREADS'] = str(num_cores)
    os.environ['OPENBLAS_NUM_THREADS'] = str(num_cores)
    os.environ['VECLIB_MAXIMUM_THREADS'] = str(num_cores)
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Apple Silicon
    os.environ['OMP_SCHEDULE'] = 'dynamic'
    os.environ['OMP_DYNAMIC'] = 'TRUE'
    os.environ['OMP_NESTED'] = 'TRUE'
    
    print("OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Apple Silicon")
    
    return num_cores

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
num_cores = configure_openmp_apple_silicon()
```

### 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor
import numpy as np

def parallel_data_processing(data: pd.DataFrame, n_workers: int = None):
    """–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Apple Silicon"""
    
    if n_workers is None:
        n_workers = mp.cpu_count()
    
    def process_chunk(chunk):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö"""
        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
        chunk = chunk.fillna(chunk.median())
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        if len(chunk.columns) > 1:
            chunk['feature_sum'] = chunk.sum(axis=1)
            chunk['feature_mean'] = chunk.mean(axis=1)
        
        return chunk
    
    # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏
    chunk_size = len(data) // n_workers
    chunks = [data.iloc[i:i+chunk_size] for i in range(0, len(data), chunk_size)]
    
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    with ThreadPoolExecutor(max_workers=n_workers) as executor:
        processed_chunks = list(executor.map(process_chunk, chunks))
    
    # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    processed_data = pd.concat(processed_chunks, ignore_index=True)
    
    return processed_data

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
def optimize_data_processing(data: pd.DataFrame):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP
    configure_openmp_apple_silicon()
    
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    processed_data = parallel_data_processing(data)
    
    return processed_data
```

## –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon

### 1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã

```python
class AppleSiliconOptimizer:
    """–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –¥–ª—è Apple Silicon"""
    
    def __init__(self):
        self.num_cores = mp.cpu_count()
        self.mps_available = torch.backends.mps.is_available()
        self.ray_initialized = False
        
    def configure_system(self):
        """–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã"""
        
        # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA
        os.environ['CUDA_VISIBLE_DEVICES'] = ''
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP
        self.configure_openmp()
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch
        self.configure_pytorch()
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon
        self.configure_autogluon()
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray
        self.configure_ray()
        
        print("–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è Apple Silicon")
    
    def configure_openmp(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP"""
        os.environ['OMP_NUM_THREADS'] = str(self.num_cores)
        os.environ['MKL_NUM_THREADS'] = str(self.num_cores)
        os.environ['OPENBLAS_NUM_THREADS'] = str(self.num_cores)
        os.environ['VECLIB_MAXIMUM_THREADS'] = str(self.num_cores)
    
    def configure_pytorch(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch"""
        if self.mps_available:
            os.environ['PYTORCH_ENABLE_MPS_FALLBACK'] = '1'
            print("MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ")
        else:
            print("MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU")
    
    def configure_autogluon(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon"""
        ag.set_config({
            'num_cpus': self.num_cores,
            'num_gpus': 0,
            'memory_limit': 8,
            'time_limit': 3600
        })
    
    def configure_ray(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray"""
        try:
            ray.init(
                num_cpus=self.num_cores,
                num_gpus=0,
                object_store_memory=2 * 1024 * 1024 * 1024,
                ignore_reinit_error=True
            )
            self.ray_initialized = True
            print("Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Ray: {e}")
    
    def get_optimal_config(self, data_size: int) -> dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        
        if data_size < 1000:
            return {
                'presets': 'optimize_for_deployment',
                'num_bag_folds': 3,
                'num_bag_sets': 1,
                'time_limit': 600
            }
        elif data_size < 10000:
            return {
                'presets': 'medium_quality',
                'num_bag_folds': 5,
                'num_bag_sets': 1,
                'time_limit': 1800
            }
        else:
            return {
                'presets': 'high_quality',
                'num_bag_folds': 5,
                'num_bag_sets': 2,
                'time_limit': 3600
            }

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
optimizer = AppleSiliconOptimizer()
optimizer.configure_system()
```

### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

```python
def train_optimized_apple_silicon(data: pd.DataFrame, target_col: str):
    """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon"""
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
    optimizer = AppleSiliconOptimizer()
    optimizer.configure_system()
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    config = optimizer.get_optimal_config(len(data))
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label=target_col,
        problem_type='auto',
        eval_metric='auto',
        path='./apple_silicon_models'
    )
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    optimized_data = optimize_data_for_mlx(data)
    
    # –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
    predictor.fit(
        data,
        presets=config['presets'],
        num_bag_folds=config['num_bag_folds'],
        num_bag_sets=config['num_bag_sets'],
        time_limit=config['time_limit'],
        ag_args_fit={
            'num_cpus': optimizer.num_cores,
            'num_gpus': 0,
            'memory_limit': 8
        }
    )
    
    return predictor

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
def run_optimized_training():
    """–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è"""
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    from sklearn.datasets import make_classification
    X, y = make_classification(n_samples=10000, n_features=20, n_classes=2, random_state=42)
    
    data = pd.DataFrame(X, columns=[f'feature_{i}' for i in range(20)])
    data['target'] = y
    
    # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
    predictor = train_optimized_apple_silicon(data, 'target')
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    test_data = data.sample(1000)
    predictions = predictor.predict(test_data)
    
    print(f"–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {len(predictions)}")
    
    return predictor

# –ó–∞–ø—É—Å–∫
if __name__ == "__main__":
    predictor = run_optimized_training()
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è Apple Silicon

```python
import psutil
import time
from datetime import datetime

class AppleSiliconMonitor:
    """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è Apple Silicon"""
    
    def __init__(self):
        self.start_time = time.time()
        self.metrics = []
    
    def get_system_metrics(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫"""
        
        # CPU –º–µ—Ç—Ä–∏–∫–∏
        cpu_percent = psutil.cpu_percent(interval=1)
        cpu_freq = psutil.cpu_freq()
        
        # –ü–∞–º—è—Ç—å
        memory = psutil.virtual_memory()
        
        # –î–∏—Å–∫
        disk = psutil.disk_usage('/')
        
        # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
        try:
            temps = psutil.sensors_temperatures()
            cpu_temp = temps.get('cpu_thermal', [{}])[0].get('current', 0)
        except:
            cpu_temp = 0
        
        return {
            'timestamp': datetime.now().isoformat(),
            'cpu_percent': cpu_percent,
            'cpu_freq': cpu_freq.current if cpu_freq else 0,
            'memory_percent': memory.percent,
            'memory_available': memory.available / (1024**3),  # GB
            'disk_percent': disk.percent,
            'cpu_temp': cpu_temp,
            'elapsed_time': time.time() - self.start_time
        }
    
    def monitor_training(self, predictor, data):
        """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è"""
        
        print("–ù–∞—á–∞–ª–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è...")
        
        # –ù–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        initial_metrics = self.get_system_metrics()
        self.metrics.append(initial_metrics)
        
        # –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
        start_time = time.time()
        predictor.fit(data, time_limit=3600)
        training_time = time.time() - start_time
        
        # –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        final_metrics = self.get_system_metrics()
        final_metrics['training_time'] = training_time
        self.metrics.append(final_metrics)
        
        print(f"–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ {training_time:.2f} —Å–µ–∫—É–Ω–¥")
        
        return final_metrics
    
    def generate_report(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        
        if not self.metrics:
            return "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—á–µ—Ç–∞"
        
        # –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫
        cpu_usage = [m['cpu_percent'] for m in self.metrics]
        memory_usage = [m['memory_percent'] for m in self.metrics]
        
        report = {
            'total_time': self.metrics[-1]['elapsed_time'],
            'training_time': self.metrics[-1].get('training_time', 0),
            'avg_cpu_usage': sum(cpu_usage) / len(cpu_usage),
            'max_cpu_usage': max(cpu_usage),
            'avg_memory_usage': sum(memory_usage) / len(memory_usage),
            'max_memory_usage': max(memory_usage),
            'cpu_temp': self.metrics[-1]['cpu_temp']
        }
        
        return report

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
def run_with_monitoring():
    """–ó–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º"""
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞
    monitor = AppleSiliconMonitor()
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    from sklearn.datasets import make_classification
    X, y = make_classification(n_samples=5000, n_features=20, n_classes=2, random_state=42)
    data = pd.DataFrame(X, columns=[f'feature_{i}' for i in range(20)])
    data['target'] = y
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label='target',
        problem_type='binary',
        eval_metric='accuracy'
    )
    
    # –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
    final_metrics = monitor.monitor_training(predictor, data)
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
    report = monitor.generate_report()
    print("–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:")
    for key, value in report.items():
        print(f"{key}: {value}")
    
    return predictor, report
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```python
def complete_apple_silicon_example():
    """–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è Apple Silicon"""
    
    print("=== –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon ===")
    
    # 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
    optimizer = AppleSiliconOptimizer()
    optimizer.configure_system()
    
    # 2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    from sklearn.datasets import make_classification
    X, y = make_classification(
        n_samples=10000,
        n_features=50,
        n_informative=30,
        n_redundant=10,
        n_classes=2,
        random_state=42
    )
    
    data = pd.DataFrame(X, columns=[f'feature_{i}' for i in range(50)])
    data['target'] = y
    
    print(f"–°–æ–∑–¥–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç: {data.shape}")
    
    # 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    optimized_data = optimize_data_for_mlx(data)
    print("–î–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è MLX")
    
    # 4. –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
    monitor = AppleSiliconMonitor()
    
    predictor = TabularPredictor(
        label='target',
        problem_type='binary',
        eval_metric='accuracy',
        path='./apple_silicon_optimized'
    )
    
    # –û–±—É—á–µ–Ω–∏–µ
    final_metrics = monitor.monitor_training(predictor, data)
    
    # 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    test_data = data.sample(1000)
    predictions = predictor.predict(test_data)
    
    # 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
    performance = predictor.evaluate(test_data)
    
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
    print(f"–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {performance}")
    print(f"–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: {final_metrics['training_time']:.2f} —Å–µ–∫—É–Ω–¥")
    
    # 7. –û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    report = monitor.generate_report()
    print("–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:")
    for key, value in report.items():
        print(f"  {key}: {value}")
    
    return predictor, report

# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
if __name__ == "__main__":
    predictor, report = complete_apple_silicon_example()
```

### 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
def compare_performance():
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –∏ –±–µ–∑"""
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    from sklearn.datasets import make_classification
    X, y = make_classification(n_samples=5000, n_features=20, n_classes=2, random_state=42)
    data = pd.DataFrame(X, columns=[f'feature_{i}' for i in range(20)])
    data['target'] = y
    
    # –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    print("=== –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ===")
    start_time = time.time()
    
    predictor_basic = TabularPredictor(
        label='target',
        problem_type='binary',
        eval_metric='accuracy'
    )
    
    predictor_basic.fit(data, time_limit=600)
    basic_time = time.time() - start_time
    
    # –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
    print("=== –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π ===")
    start_time = time.time()
    
    optimizer = AppleSiliconOptimizer()
    optimizer.configure_system()
    
    predictor_optimized = TabularPredictor(
        label='target',
        problem_type='binary',
        eval_metric='accuracy'
    )
    
    predictor_optimized.fit(
        data,
        time_limit=600,
        ag_args_fit={
            'num_cpus': optimizer.num_cores,
            'num_gpus': 0,
            'memory_limit': 8
        }
    )
    optimized_time = time.time() - start_time
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print(f"–í—Ä–µ–º—è –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: {basic_time:.2f} —Å–µ–∫—É–Ω–¥")
    print(f"–í—Ä–µ–º—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: {optimized_time:.2f} —Å–µ–∫—É–Ω–¥")
    print(f"–£—Å–∫–æ—Ä–µ–Ω–∏–µ: {basic_time/optimized_time:.2f}x")
    
    return {
        'basic_time': basic_time,
        'optimized_time': optimized_time,
        'speedup': basic_time/optimized_time
    }

# –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
if __name__ == "__main__":
    results = compare_performance()
```

## Troubleshooting –¥–ª—è Apple Silicon

### 1. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

```python
def troubleshoot_apple_silicon():
    """–†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –¥–ª—è Apple Silicon"""
    
    print("=== Troubleshooting –¥–ª—è Apple Silicon ===")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MPS
    if torch.backends.mps.is_available():
        print("‚úì MPS –¥–æ—Å—Ç—É–ø–µ–Ω")
    else:
        print("‚úó MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Ray
    try:
        ray.init(ignore_reinit_error=True)
        print("‚úì Ray –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        ray.shutdown()
    except Exception as e:
        print(f"‚úó –û—à–∏–±–∫–∞ Ray: {e}")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenMP
    import os
    if 'OMP_NUM_THREADS' in os.environ:
        print(f"‚úì OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω: {os.environ['OMP_NUM_THREADS']} –ø–æ—Ç–æ–∫–æ–≤")
    else:
        print("‚úó OpenMP –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
    memory = psutil.virtual_memory()
    print(f"–ü–∞–º—è—Ç—å: {memory.percent}% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, {memory.available/(1024**3):.1f}GB –¥–æ—Å—Ç—É–ø–Ω–æ")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU
    cpu_count = mp.cpu_count()
    print(f"CPU —è–¥–µ—Ä: {cpu_count}")

# –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
if __name__ == "__main__":
    troubleshoot_apple_silicon()
```

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö

```python
def get_optimal_config_apple_silicon(data_size: int, data_type: str = 'tabular'):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Apple Silicon"""
    
    if data_size < 1000:
        return {
            'presets': 'optimize_for_deployment',
            'num_bag_folds': 3,
            'num_bag_sets': 1,
            'time_limit': 300,
            'ag_args_fit': {
                'num_cpus': min(4, mp.cpu_count()),
                'num_gpus': 0,
                'memory_limit': 4
            }
        }
    elif data_size < 10000:
        return {
            'presets': 'medium_quality',
            'num_bag_folds': 5,
            'num_bag_sets': 1,
            'time_limit': 1800,
            'ag_args_fit': {
                'num_cpus': min(8, mp.cpu_count()),
                'num_gpus': 0,
                'memory_limit': 8
            }
        }
    else:
        return {
            'presets': 'high_quality',
            'num_bag_folds': 5,
            'num_bag_sets': 2,
            'time_limit': 3600,
            'ag_args_fit': {
                'num_cpus': mp.cpu_count(),
                'num_gpus': 0,
                'memory_limit': 16
            }
        }

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
def train_with_optimal_config(data: pd.DataFrame, target_col: str):
    """–û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π"""
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    config = get_optimal_config_apple_silicon(len(data))
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label=target_col,
        problem_type='auto',
        eval_metric='auto'
    )
    
    # –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
    predictor.fit(
        data,
        presets=config['presets'],
        num_bag_folds=config['num_bag_folds'],
        num_bag_sets=config['num_bag_sets'],
        time_limit=config['time_limit'],
        ag_args_fit=config['ag_args_fit']
    )
    
    return predictor
```

## GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∏ Metal Performance Shaders

<img src="images/optimized/production_architecture.png" alt="GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è Apple Silicon" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 5: GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∏ Metal Performance Shaders –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ GPU –º–æ–∂–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ 5-10 —Ä–∞–∑:

**–ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã GPU —É—Å–∫–æ—Ä–µ–Ω–∏—è:**
- **Metal Performance Shaders**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ GPU –æ–ø–µ—Ä–∞—Ü–∏–∏
- **MPS Backend**: PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple GPU
- **MLX**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è ML
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É CPU –∏ GPU
- **Neural Engine**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —è–¥—Ä–∞ –¥–ª—è ML –æ–ø–µ—Ä–∞—Ü–∏–π
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏**: –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è Apple Silicon

<img src="images/optimized/robustness_analysis.png" alt="–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è Apple Silicon" style="max-width: 100%; height: auto; display: block; margin: 20px auto;">
*–†–∏—Å—É–Ω–æ–∫ 6: –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è Apple Silicon*

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω—ã –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è Apple Silicon?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç –¥–æ—Å—Ç–∏—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **–ù–∞—Ç–∏–≤–Ω—ã–µ ARM64 –ø–∞–∫–µ—Ç—ã**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ conda –≤–º–µ—Å—Ç–æ pip
- **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MPS
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
- **GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Metal Performance Shaders
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

### üéØ –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ü–æ—á–µ–º—É —Å–ª–µ–¥—É—é—Ç —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –æ–ø—ã—Ç–æ–º –∏ –¥–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- **–ü—Ä–∏–Ω—Ü–∏–ø "–ù–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏"**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ARM64 –ø–∞–∫–µ—Ç–æ–≤ –≤–º–µ—Å—Ç–æ x86
- **–ü—Ä–∏–Ω—Ü–∏–ø "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏"**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Apple-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
- **–ü—Ä–∏–Ω—Ü–∏–ø "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- **–ü—Ä–∏–Ω—Ü–∏–ø "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"**: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ü—Ä–∏–Ω—Ü–∏–ø "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"**: –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–ü—Ä–∏–Ω—Ü–∏–ø "–û–±–Ω–æ–≤–ª–µ–Ω–∏—è"**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é AutoML Gluon –¥–ª—è Apple Silicon MacBook M1/M2/M3, –≤–∫–ª—é—á–∞—è:

- **MLX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é** –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- **Ray –Ω–∞—Å—Ç—Ä–æ–π–∫—É** –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- **OpenMP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA** –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É MPS
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –¥–ª—è Apple Silicon
- **Troubleshooting** —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ Apple Silicon —Å —É—á–µ—Ç–æ–º –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã M1/M2/M3 —á–∏–ø–æ–≤.
