# –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∏–∫ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

**–ê–≤—Ç–æ—Ä:** Shcherbyna Rostyslav  
**–î–∞—Ç–∞:** 2024  

## –ü–æ—á–µ–º—É Walk-Forward –∞–Ω–∞–ª–∏–∑ - –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### üèÜ Walk-Forward –∞–Ω–∞–ª–∏–∑ –∫–∞–∫ –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```mermaid
graph TD
    A[ML-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è] --> B{–ú–µ—Ç–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏}
    
    B -->|–ü—Ä–æ—Å—Ç–æ–π –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥| C[‚ùå –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö]
    B -->|Out-of-sample| D[‚ö†Ô∏è –û–¥–∏–Ω —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö]
    B -->|Cross-validation| E[‚ö†Ô∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã]
    B -->|Walk-Forward –∞–Ω–∞–ª–∏–∑| F[‚úÖ –ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏]
    
    C --> G[–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å]
    C --> H[–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å]
    C --> I[–†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ]
    
    D --> J[–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è]
    E --> K[–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—É–¥—É—â–µ–≥–æ]
    
    F --> L[–ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏]
    F --> M[–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ]
    F --> N[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ]
    F --> O[–ò–∑–±–µ–∂–∞–Ω–∏–µ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö]
    
    L --> P[–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞]
    M --> P
    N --> P
    O --> P
    
    P --> Q[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º]
    P --> R[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏]
    P --> S[–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    
    Q --> T[‚úÖ –£—Å–ø–µ—à–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è]
    R --> T
    S --> T
    
    style A fill:#e3f2fd
    style F fill:#4caf50
    style C fill:#ffcdd2
    style D fill:#fff3e0
    style E fill:#fff3e0
    style T fill:#2e7d32
```

**–ü–æ—á–µ–º—É Walk-Forward –∞–Ω–∞–ª–∏–∑ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å–∞–º—ã–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é - –º–æ–¥–µ–ª—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ. –≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –∏–∑–±–µ–∂–∞—Ç—å "—É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—É–¥—É—â–µ–≥–æ".

### –ß—Ç–æ –¥–∞–µ—Ç Walk-Forward –∞–Ω–∞–ª–∏–∑?

- **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å**: –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- **–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å**: –í—ã—è–≤–ª—è–µ—Ç —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞?

- **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ**: –ú–æ–¥–µ–ª—å –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- **–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å**: –ó–∞–≤—ã—à–µ–Ω–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- **–†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏**: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

**Walk-Forward –∫–∞–∫ —Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ:**

```python
For t = train_window to T - test_window:
    train_data = data[t-train_window:t]
    test_data = data[t:t+test_window]
    
    model.fit(train_data)
    predictions = model.predict(test_data)
    
    performance[t] = evaluate(predictions, test_data)
```

–ì–¥–µ:

- `train_window` - —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è
- `test_window` - —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `T` - –æ–±—â–∞—è –¥–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
- `performance[t]` - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –ø–µ—Ä–∏–æ–¥–µ t

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ Walk-Forward:**

1. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: Var(performance) < threshold
2. **–¢—Ä–µ–Ω–¥**: performance –Ω–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –º–æ–¥–µ–ª—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –Ω–æ–≤—ã–º —É—Å–ª–æ–≤–∏—è–º
4. **–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö

### –¢–∏–ø—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TB
    A[–¢–∏–ø—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞] --> B[–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫–Ω–æ]
    A --> C[–†–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ]
    A --> D[–°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ]
    A --> E[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ]
    
    B --> B1[–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞]
    B --> B2[–ü—Ä–æ—Å—Ç–æ–π –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏]
    B --> B3[‚ùå –ú–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ–≤–∞—Ç—å]
    B --> B4[‚ö° –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ]
    B --> B5[üìä –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã]
    
    C --> C1[–û–∫–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç–µ—Ç]
    C --> C2[–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é]
    C --> C3[‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º]
    C --> C4[üìà –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º]
    C --> C5[üîÑ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π]
    
    D --> D1[–û–∫–Ω–æ —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è]
    D --> D2[–ë–∞–ª–∞–Ω—Å –∏—Å—Ç–æ—Ä–∏–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏]
    D --> D3[‚úÖ –ù–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π]
    D --> D4[‚öñÔ∏è –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å]
    D --> D5[üéØ –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å]
    
    E --> E1[–†–∞–∑–º–µ—Ä –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —É—Å–ª–æ–≤–∏—è–º]
    E --> E2[–°–ª–æ–∂–Ω—ã–π –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏]
    E --> E3[‚úÖ –ù–∞–∏–±–æ–ª–µ–µ –≥–∏–±–∫–∏–π]
    E --> E4[üß† –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è]
    E --> E5[üìä –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã]
    
    style A fill:#e3f2fd
    style B fill:#ffcdd2
    style C fill:#fff3e0
    style D fill:#c8e6c9
    style E fill:#4caf50
```

#### 1. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫–Ω–æ (Fixed Window)

- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è
- –ü—Ä–æ—Å—Ç–æ–π –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ú–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ–≤–∞—Ç—å

#### 2. –†–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ (Expanding Window)

- –û–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç–µ—Ç
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º

#### 3. –°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ (Rolling Window)

- –û–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è
- –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å—é
- –ù–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π

#### 4. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ (Adaptive Window)

- –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —É—Å–ª–æ–≤–∏—è–º
- –°–ª–æ–∂–Ω—ã–π –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ù–∞–∏–±–æ–ª–µ–µ –≥–∏–±–∫–∏–π

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### 1. –ë–∞–∑–æ–≤—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑

### üîÑ –ü—Ä–æ—Ü–µ—Å—Å Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TD
    A[–ò—Å—Ö–æ–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ] --> B[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    B --> C[train_window = 252<br/>test_window = 30<br/>step = 30]
    
    C --> D[–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–∞]
    D --> E[i = train_window]
    
    E --> F[–û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ<br/>data[i-train_window:i]]
    E --> G[–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ<br/>data[i:i+test_window]]
    
    F --> H[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏<br/>model.fit(train_data)]
    G --> I[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è<br/>model.predict(test_data)]
    
    H --> I
    I --> J[–†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏<br/>predictions * returns]
    
    J --> K[–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞]
    K --> L[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞]
    K --> M[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞]
    K --> N[–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å]
    
    L --> O[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    M --> O
    N --> O
    
    O --> P[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞<br/>i += step]
    P --> Q{i < len(data) - test_window?}
    
    Q -->|–î–∞| F
    Q -->|–ù–µ—Ç| R[–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    
    R --> S[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏]
    R --> T[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏]
    R --> U[–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    
    S --> V[–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    T --> V
    U --> V
    
    V --> W{–°—Ç—Ä–∞—Ç–µ–≥–∏—è —É—Å–ø–µ—à–Ω–∞?}
    W -->|–î–∞| X[‚úÖ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω]
    W -->|–ù–µ—Ç| Y[‚ùå –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    
    Y --> Z[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è]
    Z --> AA[–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ]
    AA --> B
    
    style A fill:#e3f2fd
    style F fill:#c8e6c9
    style G fill:#fff3e0
    style X fill:#4caf50
    style Y fill:#ff9800
```

**–ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```python
def walk_forward_analysis(data, model, train_window=252, test_window=30, step=30):
    """
    –ë–∞–∑–æ–≤—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ML-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π
    
    Parameters:
    -----------
    data : pandas.DataFrame
        –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'returns': –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ (float)
        - 'features': –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ (array-like)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (datetime)
        
    model : sklearn-compatible model
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
        - fit(X, y): –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        - predict(X): –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å sklearn API
        
    train_window : int, default=252
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 252: –æ–¥–∏–Ω —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 126: –ø–æ–ª–≥–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        - 504: –¥–≤–∞ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 50 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 1000 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
        
    test_window : int, default=30
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    step : int, default=30
        –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
        - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
        
    Returns:
    --------
    pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'start_date': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'end_date': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'predictions': –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ (array)
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ train_window < 50 –∏–ª–∏ test_window < 5
        –ï—Å–ª–∏ step > test_window
        –ï—Å–ª–∏ len(data) < train_window + test_window
        
    Examples:
    ---------
    >>> data = pd.read_csv('financial_data.csv', index_col=0, parse_dates=True)
    >>> model = RandomForestRegressor(n_estimators=100)
    >>> results = walk_forward_analysis(data, model, train_window=252, test_window=30)
    >>> print(f"–°—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: {results['sharpe'].mean():.2f}")
    """
    results = []
    
    for i in range(train_window, len(data) - test_window, step):
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        train_data = data[i-train_window:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        model.fit(train_data)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = model.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        results.append({
            'start_date': train_data.index[0],
            'end_date': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'sharpe': sharpe,
            'max_drawdown': max_drawdown,
            'total_return': total_return,
            'predictions': predictions
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
wf_results = walk_forward_analysis(data, model, train_window=252, test_window=30, step=30)
```

**–†–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ:**

```python
def expanding_window_analysis(data, model, initial_train_window=252, test_window=30, step=30):
    """
    Walk-Forward –∞–Ω–∞–ª–∏–∑ —Å —Ä–∞—Å—à–∏—Ä—è—é—â–∏–º—Å—è –æ–∫–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
    
    –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞, —Ä–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é
    –∏—Å—Ç–æ—Ä–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.
    
    Parameters:
    -----------
    data : pandas.DataFrame
        –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'returns': –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ (float)
        - 'features': –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ (array-like)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (datetime)
        
    model : sklearn-compatible model
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
        - fit(X, y): –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        - predict(X): –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å sklearn API
        
    initial_train_window : int, default=252
        –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 252: –æ–¥–∏–Ω —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 126: –ø–æ–ª–≥–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        - 504: –¥–≤–∞ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 50 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        - –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–∫–Ω–æ –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å—Å—è –Ω–∞ step –¥–Ω–µ–π –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é
        
    test_window : int, default=30
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    step : int, default=30
        –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
        - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
        
    Returns:
    --------
    pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'train_size': —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int) - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ initial_train_window < 50 –∏–ª–∏ test_window < 5
        –ï—Å–ª–∏ step > test_window
        –ï—Å–ª–∏ len(data) < initial_train_window + test_window
        
    Notes:
    ------
    - –†–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑-–∑–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏—è
      —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
    - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –≥–¥–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏
    - –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –Ω–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    Examples:
    ---------
    >>> data = pd.read_csv('financial_data.csv', index_col=0, parse_dates=True)
    >>> model = RandomForestRegressor(n_estimators=100)
    >>> results = expanding_window_analysis(data, model, initial_train_window=252)
    >>> print(f"–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞: {results['train_size'].iloc[-1]}")
    """
    results = []
    
    for i in range(initial_train_window, len(data) - test_window, step):
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (—Ä–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ)
        train_data = data[:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        model.fit(train_data)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = model.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        results.append({
            'train_start': train_data.index[0],
            'train_end': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'train_size': len(train_data),
            'sharpe': sharpe,
            'max_drawdown': max_drawdown,
            'total_return': total_return
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
expanding_results = expanding_window_analysis(data, model, initial_train_window=252, test_window=30)
```

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑

### üß† –ú–µ—Ö–∞–Ω–∏–∑–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–∫–Ω–∞

```mermaid
graph TD
    A[–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ] --> B[–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    B --> C[min_window = 100<br/>max_window = 500<br/>current_window = min_window]
    
    C --> D[–¶–∏–∫–ª Walk-Forward]
    D --> E[–û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ<br/>data[i-current_window:i]]
    E --> F[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏]
    F --> G[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏]
    
    G --> H[–†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>current_sharpe]
    H --> I{–ï—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?}
    
    I -->|–ù–µ—Ç| J[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤<br/>current_window –æ—Å—Ç–∞–µ—Ç—Å—è]
    I -->|–î–∞| K[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é<br/>recent_sharpe]
    
    K --> L{–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Ö—É–¥—à–∏–ª–∞—Å—å?<br/>current_sharpe < recent_sharpe * 0.9}
    L -->|–î–∞| M[–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–∫–Ω–∞<br/>current_window += 50]
    L -->|–ù–µ—Ç| N{–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∏–ª–∞—Å—å?<br/>current_sharpe > recent_sharpe * 1.1}
    
    N -->|–î–∞| O[–£–º–µ–Ω—å—à–µ–Ω–∏–µ –æ–∫–Ω–∞<br/>current_window -= 50]
    N -->|–ù–µ—Ç| P[–û–∫–Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π]
    
    M --> Q[–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü<br/>current_window = min(current_window, max_window)]
    O --> R[–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü<br/>current_window = max(current_window, min_window)]
    P --> S[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    Q --> S
    R --> S
    J --> S
    
    S --> T[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞<br/>i += step]
    T --> U{–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ü–∏–∫–ª?}
    U -->|–î–∞| E
    U -->|–ù–µ—Ç| V[–ê–Ω–∞–ª–∏–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏]
    
    V --> W[–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–∫–Ω–∞]
    V --> X[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ–∫–Ω–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    V --> Y[–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏]
    
    W --> Z[–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    X --> Z
    Y --> Z
    
    style A fill:#e3f2fd
    style M fill:#ff9800
    style O fill:#4caf50
    style P fill:#fff3e0
    style Z fill:#2e7d32
```

**–ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞:**

```python
def adaptive_window_analysis(data, model, min_window=100, max_window=500, 
                           test_window=30, step=30, stability_threshold=0.1):
    """
    Walk-Forward –∞–Ω–∞–ª–∏–∑ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –æ–∫–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
    
    –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    –º–æ–¥–µ–ª–∏. –ü—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–∫–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –ø—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ - —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è.
    
    Parameters:
    -----------
    data : pandas.DataFrame
        –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'returns': –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ (float)
        - 'features': –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ (array-like)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (datetime)
        
    model : sklearn-compatible model
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
        - fit(X, y): –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        - predict(X): –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å sklearn API
        
    min_window : int, default=100
        –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 100: –º–∏–Ω–∏–º—É–º –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 50: –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        - 200: –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        - –ú–∏–Ω–∏–º—É–º: 30 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 300 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
        
    max_window : int, default=500
        –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 500: –¥–≤–∞ –≥–æ–¥–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 252: –æ–¥–∏–Ω –≥–æ–¥ (–¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1000: —á–µ—Ç—ã—Ä–µ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: min_window + 100
        - –ú–∞–∫—Å–∏–º—É–º: 2000 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
        
    test_window : int, default=30
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    step : int, default=30
        –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
        - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
        
    stability_threshold : float, default=0.1
        –ü–æ—Ä–æ–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–∏–º–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
        - 0.1: 10% –∏–∑–º–µ–Ω–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 0.05: 5% –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 0.2: 20% –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 0.01 (1% –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
        - –ú–∞–∫—Å–∏–º—É–º: 0.5 (50% –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
        
    Returns:
    --------
    pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'window_size': —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int)
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ min_window < 30 –∏–ª–∏ max_window < min_window + 100
        –ï—Å–ª–∏ test_window < 5 –∏–ª–∏ step > test_window
        –ï—Å–ª–∏ stability_threshold < 0.01 –∏–ª–∏ stability_threshold > 0.5
        –ï—Å–ª–∏ len(data) < min_window + test_window
        
    Notes:
    ------
    - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º –≤ –Ω–∞—á–∞–ª–µ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
    - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å –∏–∑–º–µ–Ω—è—é—â–∏–º–∏—Å—è —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
    
    Examples:
    ---------
    >>> data = pd.read_csv('financial_data.csv', index_col=0, parse_dates=True)
    >>> model = RandomForestRegressor(n_estimators=100)
    >>> results = adaptive_window_analysis(data, model, min_window=100, max_window=500)
    >>> print(f"–°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞: {results['window_size'].mean():.0f}")
    """
    results = []
    current_window = min_window
    
    for i in range(min_window, len(data) - test_window, step):
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        train_data = data[i-current_window:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        model.fit(train_data)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = model.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        # –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        if len(results) > 0:
            recent_sharpe = results[-1]['sharpe']
            current_sharpe = sharpe
            
            # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Ö—É–¥—à–∞–µ—Ç—Å—è, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–∫–Ω–æ
            if current_sharpe < recent_sharpe * (1 - stability_threshold):
                current_window = min(current_window + 50, max_window)
            # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç—Å—è, —É–º–µ–Ω—å—à–∞–µ–º –æ–∫–Ω–æ
            elif current_sharpe > recent_sharpe * (1 + stability_threshold):
                current_window = max(current_window - 50, min_window)
        
        results.append({
            'train_start': train_data.index[0],
            'train_end': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'window_size': current_window,
            'sharpe': sharpe,
            'max_drawdown': max_drawdown,
            'total_return': total_return
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
adaptive_results = adaptive_window_analysis(data, model, min_window=100, max_window=500)
```

**–ê–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:**

```python
def volatility_adaptive_analysis(data, model, base_window=252, test_window=30, 
                                step=30, volatility_lookback=50):
    """
    Walk-Forward –∞–Ω–∞–ª–∏–∑ —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
    
    –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞:
    - –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –º–µ–Ω—å—à–µ –æ–∫–Ω–æ (–±—ã—Å—Ç—Ä–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è)
    - –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –±–æ–ª—å—à–µ –æ–∫–Ω–æ (—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å)
    
    Parameters:
    -----------
    data : pandas.DataFrame
        –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'returns': –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ (float) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
        - 'features': –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ (array-like)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (datetime)
        
    model : sklearn-compatible model
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
        - fit(X, y): –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        - predict(X): –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å sklearn API
        
    base_window : int, default=252
        –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 252: –æ–¥–∏–Ω —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 126: –ø–æ–ª–≥–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        - 504: –¥–≤–∞ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 50 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 1000 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
        
    test_window : int, default=30
        –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
        - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    step : int, default=30
        –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
        - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
        
    volatility_lookback : int, default=50
        –ü–µ—Ä–∏–æ–¥ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ç–µ–∫—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ –¥–Ω—è—Ö:
        - 50: –¥–≤–∞ –º–µ—Å—è—Ü–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏)
        - 100: —á–µ—Ç—ã—Ä–µ –º–µ—Å—è—Ü–∞ (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏)
        - –ú–∏–Ω–∏–º—É–º: 10 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
        - –ú–∞–∫—Å–∏–º—É–º: 200 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    Returns:
    --------
    pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
        - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
        - 'window_size': –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int)
        - 'volatility_ratio': –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (float)
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ base_window < 50 –∏–ª–∏ test_window < 5
        –ï—Å–ª–∏ step > test_window –∏–ª–∏ volatility_lookback < 10
        –ï—Å–ª–∏ len(data) < base_window + test_window + volatility_lookback
        
    Notes:
    ------
    - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ç–µ–∫—É—â–µ–π –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –ü—Ä–∏ volatility_ratio > 1.5: –æ–∫–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ 70% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ
    - –ü—Ä–∏ volatility_ratio < 0.7: –æ–∫–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ 130% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ
    - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
    
    Examples:
    ---------
    >>> data = pd.read_csv('financial_data.csv', index_col=0, parse_dates=True)
    >>> model = RandomForestRegressor(n_estimators=100)
    >>> results = volatility_adaptive_analysis(data, model, base_window=252)
    >>> print(f"–°—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏: {results['volatility_ratio'].mean():.2f}")
    """
    results = []
    
    for i in range(base_window, len(data) - test_window, step):
        # –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
        recent_volatility = data['returns'].iloc[i-volatility_lookback:i].std()
        long_term_volatility = data['returns'].iloc[:i].std()
        
        # –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
        volatility_ratio = recent_volatility / long_term_volatility
        
        if volatility_ratio > 1.5:  # –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
            window_size = int(base_window * 0.7)  # –ú–µ–Ω—å—à–µ –æ–∫–Ω–æ
        elif volatility_ratio < 0.7:  # –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
            window_size = int(base_window * 1.3)  # –ë–æ–ª—å—à–µ –æ–∫–Ω–æ
        else:
            window_size = base_window
        
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        train_data = data[i-window_size:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        model.fit(train_data)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predictions = model.predict(test_data)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        results.append({
            'train_start': train_data.index[0],
            'train_end': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'window_size': window_size,
            'volatility_ratio': volatility_ratio,
            'sharpe': sharpe,
            'max_drawdown': max_drawdown,
            'total_return': total_return
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
vol_adaptive_results = volatility_adaptive_analysis(data, model, base_window=252)
```

### 3. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TD
    A[–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ] --> B[–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑]
    
    B --> C[–£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏]
    C --> D[Random Forest]
    C --> E[XGBoost]
    C --> F[LightGBM]
    
    B --> G[–£—Ä–æ–≤–µ–Ω—å 2: –ê–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å]
    G --> H[Linear Regression]
    G --> I[Neural Network]
    G --> J[Stacking]
    
    D --> K[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π]
    E --> K
    F --> K
    
    K --> L[–ú–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–∏<br/>Meta-features]
    L --> M[–û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏]
    
    M --> N[–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è]
    N --> O[–†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    
    O --> P[–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞]
    P --> Q[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞]
    P --> R[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞]
    P --> S[–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å]
    
    Q --> T[–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–µ–π]
    R --> T
    S --> T
    
    T --> U[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    U --> V[–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å]
    U --> W[–°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å]
    U --> X[–ê–Ω—Å–∞–º–±–ª–µ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å]
    
    V --> Y[–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏]
    W --> Y
    X --> Y
    
    Y --> Z[–û—Ü–µ–Ω–∫–∞ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    Z --> AA{–°—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–æ—Ç–æ–≤–∞?}
    AA -->|–î–∞| BB[‚úÖ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω]
    AA -->|–ù–µ—Ç| CC[‚ùå –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–Ω—Å–∞–º–±–ª—è]
    
    CC --> DD[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–µ–π]
    DD --> EE[–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ]
    EE --> B
    
    style A fill:#e3f2fd
    style C fill:#c8e6c9
    style G fill:#fff3e0
    style BB fill:#4caf50
    style CC fill:#ff9800
```

**–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:**

```python
def hierarchical_walk_forward(data, models, train_window=252, test_window=30, step=30):
    """–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π Walk-Forward –∞–Ω–∞–ª–∏–∑"""
    results = []
    
    for i in range(train_window, len(data) - test_window, step):
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        train_data = data[i-train_window:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
        model_predictions = {}
        for name, model in models.items():
            model.fit(train_data)
            model_predictions[name] = model.predict(test_data)
        
        # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
        combined_predictions = np.mean(list(model_predictions.values()), axis=0)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = combined_predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        # –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–µ–π
        individual_metrics = {}
        for name, predictions in model_predictions.items():
            individual_returns = predictions * returns
            individual_metrics[name] = {
                'sharpe': individual_returns.mean() / individual_returns.std() * np.sqrt(252),
                'max_drawdown': calculate_max_drawdown(individual_returns),
                'total_return': individual_returns.sum()
            }
        
        results.append({
            'train_start': train_data.index[0],
            'train_end': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'combined_sharpe': sharpe,
            'combined_max_drawdown': max_drawdown,
            'combined_total_return': total_return,
            'individual_metrics': individual_metrics
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
models = {
    'model1': RandomForestRegressor(),
    'model2': XGBRegressor(),
    'model3': LGBMRegressor()
}
hierarchical_results = hierarchical_walk_forward(data, models, train_window=252)
```

**–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–π –∞–Ω–∞–ª–∏–∑:**

```python
def ensemble_walk_forward(data, base_models, ensemble_model, train_window=252, 
                         test_window=30, step=30):
    """Walk-Forward –∞–Ω–∞–ª–∏–∑ —Å –∞–Ω—Å–∞–º–±–ª–µ–º"""
    results = []
    
    for i in range(train_window, len(data) - test_window, step):
        # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        train_data = data[i-train_window:i]
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        test_data = data[i:i+test_window]
        
        # –û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
        base_predictions = []
        for name, model in base_models.items():
            model.fit(train_data)
            predictions = model.predict(test_data)
            base_predictions.append(predictions)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        meta_features = np.column_stack(base_predictions)
        
        # –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏
        ensemble_model.fit(meta_features, test_data['returns'])
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∞–Ω—Å–∞–º–±–ª—è
        ensemble_predictions = ensemble_model.predict(meta_features)
        
        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
        returns = test_data['returns']
        strategy_returns = ensemble_predictions * returns
        
        # –ú–µ—Ç—Ä–∏–∫–∏
        sharpe = strategy_returns.mean() / strategy_returns.std() * np.sqrt(252)
        max_drawdown = calculate_max_drawdown(strategy_returns)
        total_return = strategy_returns.sum()
        
        results.append({
            'train_start': train_data.index[0],
            'train_end': train_data.index[-1],
            'test_start': test_data.index[0],
            'test_end': test_data.index[-1],
            'sharpe': sharpe,
            'max_drawdown': max_drawdown,
            'total_return': total_return,
            'base_predictions': base_predictions,
            'ensemble_predictions': ensemble_predictions
        })
    
    return pd.DataFrame(results)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
base_models = {
    'rf': RandomForestRegressor(),
    'xgb': XGBRegressor(),
    'lgb': LGBMRegressor()
}
ensemble_model = LinearRegression()
ensemble_results = ensemble_walk_forward(data, base_models, ensemble_model)
```

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### üìä –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TD
    A[–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ Walk-Forward] --> B[–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏]
    A --> C[–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏]
    A --> D[–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏]
    
    B --> B1[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏]
    B1 --> B11[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞<br/>1 / (std / mean)]
    B1 --> B12[–¢—Ä–µ–Ω–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>polyfit slope]
    B1 --> B13[–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>rolling std]
    B1 --> B14[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏<br/>1 / volatility]
    
    B --> B2[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å]
    B2 --> B21[–°–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏<br/>abs(current - recent) / recent]
    B2 --> B22[–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏<br/>std adaptation_speed]
    B2 --> B23[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏<br/>mean_speed / volatility]
    
    C --> C1[–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å]
    C1 --> C11[–¢–µ—Å—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å<br/>Shapiro-Wilk p-value > 0.05]
    C1 --> C12[–¢–µ—Å—Ç –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å<br/>ADF p-value < 0.05]
    C1 --> C13[–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª<br/>t-distribution 95%]
    C1 --> C14[–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å<br/>ADF < 0.05 AND Shapiro > 0.05]
    
    C --> C2[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ä—ã–Ω–∫–æ–º]
    C2 --> C21[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é<br/>corr(sharpe, volatility)]
    C2 --> C22[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é<br/>corr(sharpe, returns)]
    C2 --> C23[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ç—Ä–µ–Ω–¥–æ–º<br/>corr(sharpe, trend)]
    
    D --> D1[–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å]
    D1 --> D11[–£—á–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–¥–µ—Ä–∂–µ–∫<br/>net_returns = returns - costs]
    D1 --> D12[–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞<br/>‚â• 1.0]
    D1 --> D13[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞<br/>‚â§ 20%]
    D1 --> D14[–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤<br/>‚â• 60%]
    
    D --> D2[–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å]
    D2 --> D21[–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>cumprod(1 + returns)]
    D2 --> D22[–§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è<br/>initial * cumulative]
    D2 --> D23[–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>annualized return]
    D2 --> D24[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞<br/>min drawdown]
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#f3e5f5
```

### 1. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏:**

```python
def calculate_temporal_stability(results):
    """
    –†–∞—Å—á–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
    
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ä–µ–º–µ–Ω–∏,
    —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    Returns:
    --------
    dict
        –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:
        - 'sharpe_stability': —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ (float)
          - > 2.0: –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - 1.0-2.0: —Ö–æ—Ä–æ—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - 0.5-1.0: —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - < 0.5: –Ω–∏–∑–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
        - 'sharpe_trend': —Ç—Ä–µ–Ω–¥ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ (float)
          - > 0: —É–ª—É—á—à–µ–Ω–∏–µ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
          - = 0: —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
          - < 0: —É—Ö—É–¥—à–µ–Ω–∏–µ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
        - 'performance_volatility': –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (float)
          - < 0.1: –Ω–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
          - 0.1-0.3: —É–º–µ—Ä–µ–Ω–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
          - > 0.3: –≤—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
        - 'stability_coefficient': –æ–±—â–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (float)
          - > 10: –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - 5-10: —Ö–æ—Ä–æ—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - 2-5: —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
          - < 2: –Ω–∏–∑–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫—É 'sharpe'
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    Notes:
    ------
    - –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –≤–∞—Ä–∏–∞—Ü–∏–∏
    - –¢—Ä–µ–Ω–¥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
    - –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 10 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> stability = calculate_temporal_stability(results)
    >>> print(f"–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –®–∞—Ä–ø–∞: {stability['sharpe_stability']:.2f}")
    """
    # –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞
    sharpe_std = results['sharpe'].std()
    sharpe_mean = results['sharpe'].mean()
    sharpe_stability = 1 / (sharpe_std / sharpe_mean) if sharpe_mean != 0 else 0
    
    # –¢—Ä–µ–Ω–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    sharpe_trend = np.polyfit(range(len(results)), results['sharpe'], 1)[0]
    
    # –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    performance_volatility = results['sharpe'].rolling(5).std().mean()
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    stability_coefficient = 1 / performance_volatility if performance_volatility > 0 else 0
    
    return {
        'sharpe_stability': sharpe_stability,
        'sharpe_trend': sharpe_trend,
        'performance_volatility': performance_volatility,
        'stability_coefficient': stability_coefficient
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
temporal_metrics = calculate_temporal_stability(wf_results)
```

**–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:**

```python
def calculate_adaptability(results, lookback=5):
    """
    –†–∞—Å—á–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º
    
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –Ω–æ–≤—ã–º —Ä—ã–Ω–æ—á–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º
    –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    lookback : int, default=5
        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:
        - 5: –ø—è—Ç—å –ø–µ—Ä–∏–æ–¥–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 3: —Ç—Ä–∏ –ø–µ—Ä–∏–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏)
        - 10: –¥–µ—Å—è—Ç—å –ø–µ—Ä–∏–æ–¥–æ–≤ (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏)
        - –ú–∏–Ω–∏–º—É–º: 2 –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
        - –ú–∞–∫—Å–∏–º—É–º: 20 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
        
    Returns:
    --------
    dict
        –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:
        - 'mean_adaptation_speed': —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ (float)
          - > 0.2: –≤—ã—Å–æ–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - 0.1-0.2: —É–º–µ—Ä–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - 0.05-0.1: –Ω–∏–∑–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - < 0.05: –æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
        - 'adaptation_volatility': –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ (float)
          - < 0.1: —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è
          - 0.1-0.3: —É–º–µ—Ä–µ–Ω–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
          - > 0.3: –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è
        - 'adaptability_coefficient': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ (float)
          - > 2.0: –æ—Ç–ª–∏—á–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - 1.0-2.0: —Ö–æ—Ä–æ—à–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - 0.5-1.0: —É–º–µ—Ä–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          - < 0.5: –Ω–∏–∑–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫—É 'sharpe'
        –ï—Å–ª–∏ lookback < 2 –∏–ª–∏ lookback > len(results) - 1
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    Notes:
    ------
    - –°–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
      –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
    - –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
    - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ - –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 10 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> adaptability = calculate_adaptability(results, lookback=5)
    >>> print(f"–°–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏: {adaptability['mean_adaptation_speed']:.3f}")
    """
    # –°–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
    adaptation_speed = []
    for i in range(lookback, len(results)):
        recent_performance = results['sharpe'].iloc[i-lookback:i].mean()
        current_performance = results['sharpe'].iloc[i]
        adaptation = abs(current_performance - recent_performance) / recent_performance
        adaptation_speed.append(adaptation)
    
    # –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
    mean_adaptation_speed = np.mean(adaptation_speed)
    
    # –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
    adaptation_volatility = np.std(adaptation_speed)
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
    adaptability_coefficient = mean_adaptation_speed / adaptation_volatility if adaptation_volatility > 0 else 0
    
    return {
        'mean_adaptation_speed': mean_adaptation_speed,
        'adaptation_volatility': adaptation_volatility,
        'adaptability_coefficient': adaptability_coefficient
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
adaptability_metrics = calculate_adaptability(wf_results, lookback=5)
```

### 2. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

**–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å:**

```python
def calculate_statistical_significance(results, confidence_level=0.95):
    """
    –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    
    –ü—Ä–æ–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
    - –¢–µ—Å—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å (Shapiro-Wilk)
    - –¢–µ—Å—Ç –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å (Augmented Dickey-Fuller)
    - –†–∞—Å—á–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    confidence_level : float, default=0.95
        –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è –¥–ª—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:
        - 0.95: 95% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 0.99: 99% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫)
        - 0.90: 90% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–ª—è –º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏—Ö –æ—Ü–µ–Ω–æ–∫)
        - –ú–∏–Ω–∏–º—É–º: 0.80 (80% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª)
        - –ú–∞–∫—Å–∏–º—É–º: 0.999 (99.9% –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª)
        
    Returns:
    --------
    dict
        –°–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤:
        - 'shapiro_statistic': —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ (float)
        - 'shapiro_pvalue': p-value —Ç–µ—Å—Ç–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å (float)
          - > 0.05: –¥–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
          - <= 0.05: –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
        - 'adf_statistic': —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∞ ADF (float)
        - 'adf_pvalue': p-value —Ç–µ—Å—Ç–∞ –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å (float)
          - < 0.05: –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã
          - >= 0.05: –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã
        - 'confidence_interval': –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (tuple)
          - (lower_bound, upper_bound) –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞
        - 'is_significant': –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å (bool)
          - True: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã
          - False: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫—É 'sharpe'
        –ï—Å–ª–∏ confidence_level < 0.80 –∏–ª–∏ confidence_level > 0.999
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    Notes:
    ------
    - –¢–µ—Å—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –®–∞—Ä–ø–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
    - –¢–µ—Å—Ç –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
    - –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º t-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 30 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –Ω–∞–¥–µ–∂–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> significance = calculate_statistical_significance(results, confidence_level=0.95)
    >>> print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ: {significance['is_significant']}")
    """
    from scipy import stats
    
    # –¢–µ—Å—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å
    shapiro_stat, shapiro_pvalue = stats.shapiro(results['sharpe'])
    
    # –¢–µ—Å—Ç –Ω–∞ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç—å
    adf_stat, adf_pvalue = stats.adfuller(results['sharpe'])
    
    # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
    mean_sharpe = results['sharpe'].mean()
    std_sharpe = results['sharpe'].std()
    n = len(results)
    
    t_value = stats.t.ppf((1 + confidence_level) / 2, n - 1)
    margin_error = t_value * std_sharpe / np.sqrt(n)
    
    confidence_interval = (mean_sharpe - margin_error, mean_sharpe + margin_error)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å
    is_significant = adf_pvalue < 0.05 and shapiro_pvalue > 0.05
    
    return {
        'shapiro_statistic': shapiro_stat,
        'shapiro_pvalue': shapiro_pvalue,
        'adf_statistic': adf_stat,
        'adf_pvalue': adf_pvalue,
        'confidence_interval': confidence_interval,
        'is_significant': is_significant
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
statistical_metrics = calculate_statistical_significance(wf_results)
```

**–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏:**

```python
def calculate_market_correlation(results, market_data):
    """–†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏"""
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é —Ä—ã–Ω–∫–∞
    market_volatility = market_data['returns'].rolling(30).std()
    volatility_correlation = results['sharpe'].corr(market_volatility.iloc[results.index])
    
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é —Ä—ã–Ω–∫–∞
    market_returns = market_data['returns'].rolling(30).mean()
    returns_correlation = results['sharpe'].corr(market_returns.iloc[results.index])
    
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ç—Ä–µ–Ω–¥–æ–º —Ä—ã–Ω–∫–∞
    market_trend = market_data['price'].rolling(30).apply(lambda x: np.polyfit(range(len(x)), x, 1)[0])
    trend_correlation = results['sharpe'].corr(market_trend.iloc[results.index])
    
    return {
        'volatility_correlation': volatility_correlation,
        'returns_correlation': returns_correlation,
        'trend_correlation': trend_correlation
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
market_correlation = calculate_market_correlation(wf_results, market_data)
```

### 3. –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

**–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å:**

```python
def calculate_economic_significance(results, transaction_costs=0.001, 
                                  min_sharpe=1.0, max_drawdown=0.2):
    """
    –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    
    –û—Ü–µ–Ω–∏–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫—É—é —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å —É—á–µ—Ç–æ–º
    —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–¥–µ—Ä–∂–µ–∫ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    transaction_costs : float, default=0.001
        –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –Ω–∞ –æ–¥–Ω—É —Å–¥–µ–ª–∫—É (–≤ –¥–æ–ª—è—Ö –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞):
        - 0.001: 0.1% (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∞–∫—Ü–∏–π)
        - 0.0005: 0.05% (–¥–ª—è ETF –∏ –∏–Ω–¥–µ–∫—Å–æ–≤)
        - 0.002: 0.2% (–¥–ª—è —Ñ–æ—Ä–µ–∫—Å–∞ –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç)
        - 0.005: 0.5% (–¥–ª—è —ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤)
        - –ú–∏–Ω–∏–º—É–º: 0.0001 (0.01%)
        - –ú–∞–∫—Å–∏–º—É–º: 0.01 (1%)
        
    min_sharpe : float, default=1.0
        –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–µ–º–ª–µ–º—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞:
        - 1.0: –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        - 1.5: —Ö–æ—Ä–æ—à–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        - 2.0: –æ—Ç–ª–∏—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        - 0.5: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        - –ú–∏–Ω–∏–º—É–º: 0.1
        - –ú–∞–∫—Å–∏–º—É–º: 5.0
        
    max_drawdown : float, default=0.2
        –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ (–≤ –¥–æ–ª—è—Ö –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞):
        - 0.2: 20% (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 0.1: 10% (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 0.3: 30% (–¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 0.05: 5% (–¥–ª—è –æ—á–µ–Ω—å –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - –ú–∏–Ω–∏–º—É–º: 0.01 (1%)
        - –ú–∞–∫—Å–∏–º—É–º: 0.5 (50%)
        
    Returns:
    --------
    dict
        –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏:
        - 'mean_sharpe': —Å—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ (float)
        - 'mean_max_drawdown': —Å—Ä–µ–¥–Ω—è—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ (float)
        - 'success_rate': –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ (float)
          - >= 0.7: –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
          - 0.5-0.7: —Ö–æ—Ä–æ—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
          - 0.3-0.5: —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
          - < 0.3: —Å–ª–∞–±–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
        - 'economically_significant': –æ–±—â–∞—è —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å (bool)
          - True: —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞
          - False: —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ 'sharpe', 'max_drawdown', 'total_return'
        –ï—Å–ª–∏ transaction_costs < 0 –∏–ª–∏ transaction_costs > 0.01
        –ï—Å–ª–∏ min_sharpe < 0.1 –∏–ª–∏ min_sharpe > 5.0
        –ï—Å–ª–∏ max_drawdown < 0.01 –∏–ª–∏ max_drawdown > 0.5
        
    Notes:
    ------
    - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –≤—ã—á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –æ–±—â–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    - –£—Å–ø–µ—à–Ω—ã–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –®–∞—Ä–ø–∞ >= min_sharpe
    - –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 20 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ü–µ–Ω–∫–∏
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> economic = calculate_economic_significance(results, transaction_costs=0.001)
    >>> print(f"–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞: {economic['economically_significant']}")
    """
    # –£—á–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–¥–µ—Ä–∂–µ–∫
    net_returns = results['total_return'] - transaction_costs
    
    # –ú–µ—Ç—Ä–∏–∫–∏
    mean_sharpe = results['sharpe'].mean()
    mean_max_drawdown = results['max_drawdown'].mean()
    success_rate = (results['sharpe'] > min_sharpe).mean()
    
    # –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å
    economically_significant = (
        mean_sharpe >= min_sharpe and 
        abs(mean_max_drawdown) <= max_drawdown and
        success_rate >= 0.6
    )
    
    return {
        'mean_sharpe': mean_sharpe,
        'mean_max_drawdown': mean_max_drawdown,
        'success_rate': success_rate,
        'economically_significant': economically_significant
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
economic_metrics = calculate_economic_significance(wf_results, transaction_costs=0.001)
```

**–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
def calculate_profitability(results, initial_capital=100000):
    """
    –†–∞—Å—á–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å —É—á–µ—Ç–æ–º
    –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞ –∏ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    initial_capital : float, default=100000
        –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏:
        - 100000: $100,000 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        - 10000: $10,000 (–¥–ª—è –º–∞–ª—ã—Ö —Å—á–µ—Ç–æ–≤)
        - 1000000: $1,000,000 (–¥–ª—è –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
        - 1000: $1,000 (–¥–ª—è –¥–µ–º–æ-—Å—á–µ—Ç–æ–≤)
        - –ú–∏–Ω–∏–º—É–º: 100 (–¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        - –ú–∞–∫—Å–∏–º—É–º: 10000000 (–¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π)
        
    Returns:
    --------
    dict
        –°–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏:
        - 'final_value': —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥ (float)
          - > 0.5: –æ—Ç–ª–∏—á–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (50%+)
          - 0.2-0.5: —Ö–æ—Ä–æ—à–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (20-50%)
          - 0.1-0.2: —É–º–µ—Ä–µ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (10-20%)
          - < 0.1: –Ω–∏–∑–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (<10%)
        - 'annual_return': –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (float)
          - > 0.2: –æ—Ç–ª–∏—á–Ω–∞—è –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (20%+)
          - 0.1-0.2: —Ö–æ—Ä–æ—à–∞—è –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (10-20%)
          - 0.05-0.1: —É–º–µ—Ä–µ–Ω–Ω–∞—è –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (5-10%)
          - < 0.05: –Ω–∏–∑–∫–∞—è –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (<5%)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥ (float)
          - < 0.1: –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (<10%)
          - 0.1-0.2: —Ö–æ—Ä–æ—à–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (10-20%)
          - 0.2-0.3: —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (20-30%)
          - > 0.3: –Ω–∏–∑–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (>30%)
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ 'total_return', 'max_drawdown'
        –ï—Å–ª–∏ initial_capital <= 0 –∏–ª–∏ initial_capital > 10000000
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    Notes:
    ------
    - –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (1 + returns)
    - –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å —É—á–µ—Ç–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–µ—Ç
    - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –±–µ—Ä–µ—Ç—Å—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º –∏–∑ –≤—Å–µ—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 12 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> profitability = calculate_profitability(results, initial_capital=100000)
    >>> print(f"–§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${profitability['final_value']:,.2f}")
    """
    # –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    cumulative_returns = (1 + results['total_return']).cumprod()
    
    # –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è
    final_value = initial_capital * cumulative_returns.iloc[-1]
    
    # –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    total_return = (final_value - initial_capital) / initial_capital
    
    # –ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    years = len(results) / 12  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –º–µ—Å—è—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    annual_return = (final_value / initial_capital) ** (1 / years) - 1
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
    max_drawdown = results['max_drawdown'].min()
    
    return {
        'final_value': final_value,
        'total_return': total_return,
        'annual_return': annual_return,
        'max_drawdown': max_drawdown
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
profitability_metrics = calculate_profitability(wf_results, initial_capital=100000)
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### üìà –î–∞—à–±–æ—Ä–¥ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TD
    A[–†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞] --> B[–î–∞—à–±–æ—Ä–¥ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏]
    
    B --> C[–í—Ä–µ–º–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏]
    C --> C1[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏<br/>—Å –ª–∏–Ω–∏–µ–π –º–∏–Ω–∏–º—É–º–∞ 1.0]
    C --> C2[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏<br/>—Å –ª–∏–Ω–∏–µ–π –º–∞–∫—Å–∏–º—É–º–∞ -20%]
    C --> C3[–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>—Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ –ø–µ—Ä–∏–æ–¥–æ–≤]
    
    B --> D[–†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏]
    D --> D1[–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞<br/>—Å –ª–∏–Ω–∏–µ–π —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è]
    D --> D2[Box plot –º–µ—Ç—Ä–∏–∫<br/>—Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –∏ –∫–≤–∞–Ω—Ç–∏–ª—è–º–∏]
    D --> D3[Q-Q plot –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏<br/>–¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤]
    
    B --> E[–¢–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã]
    E --> E1[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞<br/>–º–µ—Ç—Ä–∏–∫ –º–µ–∂–¥—É —Å–æ–±–æ–π]
    E --> E2[–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º<br/>–≥–æ–¥—ã √ó –º–µ—Å—è—Ü—ã]
    E --> E3[–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏<br/>–ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –º–µ—Ç—Ä–∏–∫–∞–º]
    
    B --> F[–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏]
    F --> F1[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤<br/>Fixed vs Expanding vs Adaptive]
    F --> F2[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π<br/>Individual vs Ensemble]
    F --> F3[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤<br/>Bull vs Bear markets]
    
    C1 --> G[–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã]
    C2 --> G
    C3 --> G
    D1 --> G
    D2 --> G
    D3 --> G
    E1 --> G
    E2 --> G
    E3 --> G
    F1 --> G
    F2 --> G
    F3 --> G
    
    G --> H[Zoom –∏ Pan —Ñ—É–Ω–∫—Ü–∏–∏]
    G --> I[–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º]
    G --> J[–≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã]
    G --> K[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤—ã—Ö —Å—Ö–µ–º]
    
    H --> L[–§–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥]
    I --> L
    J --> L
    K --> L
    
    L --> M[–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤]
    L --> N[–í—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π]
    L --> O[–û—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏]
    
    M --> P[–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    N --> P
    O --> P
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style G fill:#fff3e0
    style P fill:#4caf50
```

### 1. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏

```python
def visualize_walk_forward_results(results, save_path=None):
    """
    –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    
    –°–æ–∑–¥–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –≤–∫–ª—é—á–∞—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    save_path : str, optional
        –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞:
        - None: –≥—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        - 'path/to/file.png': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PNG —Ñ–æ—Ä–º–∞—Ç–µ
        - 'path/to/file.pdf': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PDF —Ñ–æ—Ä–º–∞—Ç–µ
        - 'path/to/file.svg': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SVG —Ñ–æ—Ä–º–∞—Ç–µ
        - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .png, .pdf, .svg, .jpg, .jpeg
        
    Returns:
    --------
    None
        –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ 'sharpe', 'max_drawdown', 'total_return'
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    ImportError
        –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã matplotlib –∏–ª–∏ seaborn
        
    Notes:
    ------
    - –°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∏–≥—É—Ä–∞ 2x2 —Å —á–µ—Ç—ã—Ä—å–º—è –≥—Ä–∞—Ñ–∏–∫–∞–º–∏:
      1. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ª–∏–Ω–∏–µ–π –º–∏–Ω–∏–º—É–º–∞ 1.0
      2. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ª–∏–Ω–∏–µ–π –º–∞–∫—Å–∏–º—É–º–∞ -20%
      3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ —Å –ª–∏–Ω–∏–µ–π —Å—Ä–µ–¥–Ω–µ–≥–æ
      4. –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∏–ª—å 'seaborn-v0_8' –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–∞
    - –ì—Ä–∞—Ñ–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 10 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> visualize_walk_forward_results(results)
    >>> visualize_walk_forward_results(results, save_path='results.png')
    """
    import matplotlib.pyplot as plt
    import seaborn as sns
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è
    plt.style.use('seaborn-v0_8')
    sns.set_palette("husl")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä—ã
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))
    
    # 1. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
    axes[0, 0].plot(results.index, results['sharpe'], marker='o')
    axes[0, 0].axhline(y=1.0, color='red', linestyle='--', label='–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Sharpe')
    axes[0, 0].set_title('–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏')
    axes[0, 0].set_xlabel('–ü–µ—Ä–∏–æ–¥')
    axes[0, 0].set_ylabel('–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞')
    axes[0, 0].legend()
    axes[0, 0].grid(True)
    
    # 2. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
    axes[0, 1].plot(results.index, results['max_drawdown'], marker='o', color='red')
    axes[0, 1].axhline(y=-0.2, color='red', linestyle='--', label='–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ 20%')
    axes[0, 1].set_title('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏')
    axes[0, 1].set_xlabel('–ü–µ—Ä–∏–æ–¥')
    axes[0, 1].set_ylabel('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞')
    axes[0, 1].legend()
    axes[0, 1].grid(True)
    
    # 3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞
    axes[1, 0].hist(results['sharpe'], bins=20, alpha=0.7, edgecolor='black')
    axes[1, 0].axvline(results['sharpe'].mean(), color='red', linestyle='--', 
                      label=f'–°—Ä–µ–¥–Ω–µ–µ: {results["sharpe"].mean():.2f}')
    axes[1, 0].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞')
    axes[1, 0].set_xlabel('–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞')
    axes[1, 0].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
    axes[1, 0].legend()
    axes[1, 0].grid(True)
    
    # 4. –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    cumulative_returns = (1 + results['total_return']).cumprod()
    axes[1, 1].plot(results.index, cumulative_returns, marker='o')
    axes[1, 1].set_title('–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[1, 1].set_xlabel('–ü–µ—Ä–∏–æ–¥')
    axes[1, 1].set_ylabel('–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[1, 1].grid(True)
    
    plt.tight_layout()
    
    if save_path:
        plt.savefig(save_path, dpi=300, bbox_inches='tight')
    
    plt.show()

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
visualize_walk_forward_results(wf_results, save_path='walk_forward_results.png')
```

### 2. –¢–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã

```python
def create_heatmap_analysis(results, save_path=None):
    """
    –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–ø–ª–æ–≤—ã—Ö –∫–∞—Ä—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Walk-Forward
    
    –°–æ–∑–¥–∞–µ—Ç —Ç–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –º–µ–∂–¥—É –º–µ—Ç—Ä–∏–∫–∞–º–∏
    –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º.
    
    Parameters:
    -----------
    results : pd.DataFrame
        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π –ø–µ—Ä–∏–æ–¥ (float)
        - 'window_size': —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (datetime)
        
    save_path : str, optional
        –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞:
        - None: –≥—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        - 'path/to/file.png': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PNG —Ñ–æ—Ä–º–∞—Ç–µ
        - 'path/to/file.pdf': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PDF —Ñ–æ—Ä–º–∞—Ç–µ
        - 'path/to/file.svg': —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SVG —Ñ–æ—Ä–º–∞—Ç–µ
        - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .png, .pdf, .svg, .jpg, .jpeg
        
    Returns:
    --------
    None
        –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ results –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ 'sharpe', 'max_drawdown', 'total_return'
        –ï—Å–ª–∏ results –ø—É—Å—Ç–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç NaN –∑–Ω–∞—á–µ–Ω–∏—è
        
    ImportError
        –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã matplotlib –∏–ª–∏ seaborn
        
    Notes:
    ------
    - –°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∏–≥—É—Ä–∞ 1x2 —Å –¥–≤—É–º—è —Ç–µ–ø–ª–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏:
      1. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –º–µ–∂–¥—É –º–µ—Ç—Ä–∏–∫–∞–º–∏ (sharpe, max_drawdown, total_return)
      2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º (–≥–æ–¥—ã √ó –º–µ—Å—è—Ü—ã) - –µ—Å–ª–∏ –µ—Å—Ç—å window_size
    - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É 'coolwarm' —Å —Ü–µ–Ω—Ç—Ä–æ–º –≤ 0
    - –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É 'RdYlGn' —Å —Ü–µ–Ω—Ç—Ä–æ–º –≤ 1.0
    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–ª–æ–Ω–∫–∏ window_size
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 12 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö —Ç–µ–ø–ª–æ–≤—ã—Ö –∫–∞—Ä—Ç
    
    Examples:
    ---------
    >>> results = walk_forward_analysis(data, model)
    >>> create_heatmap_analysis(results)
    >>> create_heatmap_analysis(results, save_path='heatmap.png')
    """
    import matplotlib.pyplot as plt
    import seaborn as sns
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    correlation_matrix = results[['sharpe', 'max_drawdown', 'total_return']].corr()
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä—ã
    fig, axes = plt.subplots(1, 2, figsize=(15, 6))
    
    # 1. –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0,
                square=True, ax=axes[0])
    axes[0].set_title('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –º–µ—Ç—Ä–∏–∫')
    
    # 2. –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
    if 'window_size' in results.columns:
        pivot_table = results.pivot_table(values='sharpe', 
                                        index=results.index // 12,  # –ì–æ–¥—ã
                                        columns=results.index % 12,  # –ú–µ—Å—è—Ü—ã
                                        fill_value=0)
        sns.heatmap(pivot_table, annot=True, cmap='RdYlGn', center=1.0,
                    ax=axes[1])
        axes[1].set_title('–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º')
        axes[1].set_xlabel('–ú–µ—Å—è—Ü')
        axes[1].set_ylabel('–ì–æ–¥')
    
    plt.tight_layout()
    
    if save_path:
        plt.savefig(save_path, dpi=300, bbox_inches='tight')
    
    plt.show()

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
create_heatmap_analysis(wf_results, save_path='walk_forward_heatmap.png')
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

### ü§ñ –ü–∞–π–ø–ª–∞–π–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```mermaid
graph TD
    A[–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ] --> B[WalkForwardPipeline]
    B --> C[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    
    C --> D[–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫–Ω–æ<br/>train_window: 252<br/>test_window: 30]
    C --> E[–†–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ<br/>initial_window: 252<br/>growing data]
    C --> F[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ<br/>min: 100, max: 500<br/>dynamic adjustment]
    
    D --> G[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏]
    E --> G
    F --> G
    
    G --> H[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è]
    H --> I[–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫]
    
    I --> J[–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞]
    I --> K[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞]
    I --> L[–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å]
    
    J --> M[–°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    K --> M
    L --> M
    
    M --> N[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞]
    N --> O[–°–≤–æ–¥–∫–∞ –ø–æ –º–µ—Ç–æ–¥–∞–º]
    N --> P[–î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã]
    N --> Q[–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]
    
    O --> R[–°—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞]
    O --> S[–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ]
    O --> T[–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π]
    O --> U[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞]
    O --> V[–¢—Ä–µ–Ω–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    
    P --> W[–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã]
    P --> X[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤]
    P --> Y[–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã]
    
    Q --> Z[–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    Z --> AA[–û—Ç–ª–∏—á–Ω–∞—è: Sharpe > 1.5, Success > 70%]
    Z --> BB[–•–æ—Ä–æ—à–∞—è: Sharpe > 1.0, Success > 50%]
    Z --> CC[–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è: –∏–Ω–∞—á–µ]
    
    AA --> DD[‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –¥–µ–ø–ª–æ—é]
    BB --> EE[‚ö†Ô∏è –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞]
    CC --> FF[‚ùå –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏]
    
    DD --> GG[–î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω]
    EE --> HH[–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ]
    FF --> II[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤]
    
    II --> JJ[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è]
    JJ --> KK[–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ]
    KK --> B
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style N fill:#fff3e0
    style DD fill:#4caf50
    style EE fill:#ff9800
    style FF fill:#ffcdd2
```

### 1. –ü–∞–π–ø–ª–∞–π–Ω Walk-Forward –∞–Ω–∞–ª–∏–∑–∞

```python
class WalkForwardPipeline:
    """
    –ü–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    
    –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
    —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á–µ—Ç–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
    
    Parameters:
    -----------
    data : pandas.DataFrame
        –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
        - 'returns': –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∞ (float)
        - 'features': –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏ (array-like)
        - index: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ (datetime)
        
    model : sklearn-compatible model
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
        - fit(X, y): –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        - predict(X): –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å sklearn API
        
    metrics_calculator : object
        –û–±—ä–µ–∫—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ —Å –º–µ—Ç–æ–¥–æ–º:
        - calculate(returns): —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
        –î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ (sharpe, max_drawdown, total_return)
        
    Attributes:
    -----------
    data : pandas.DataFrame
        –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        
    model : sklearn-compatible model
        –ú–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
        
    metrics_calculator : object
        –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞
        
    results : dict
        –°–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞:
        - 'fixed_window': —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
        - 'expanding_window': —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—à–∏—Ä—è—é—â–µ–≥–æ—Å—è –æ–∫–Ω–∞
        - 'adaptive_window': —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
        
    Methods:
    --------
    run_fixed_window_analysis(train_window, test_window, step)
        –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –æ–∫–Ω–æ–º
        
    run_expanding_window_analysis(initial_train_window, test_window, step)
        –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —Å —Ä–∞—Å—à–∏—Ä—è—é—â–∏–º—Å—è –æ–∫–Ω–æ–º
        
    run_adaptive_window_analysis(min_window, max_window, test_window, step)
        –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –æ–∫–Ω–æ–º
        
    generate_comprehensive_report()
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
        
    Raises:
    -------
    ValueError
        –ï—Å–ª–∏ data –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏
        –ï—Å–ª–∏ model –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–æ–≤ fit –∏ predict
        –ï—Å–ª–∏ metrics_calculator –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–∞ calculate
        
    Examples:
    ---------
    >>> from sklearn.ensemble import RandomForestRegressor
    >>> from src.metrics import MetricsCalculator
    >>> 
    >>> model = RandomForestRegressor(n_estimators=100)
    >>> metrics_calc = MetricsCalculator()
    >>> pipeline = WalkForwardPipeline(data, model, metrics_calc)
    >>> 
    >>> # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
    >>> pipeline.run_fixed_window_analysis()
    >>> pipeline.run_expanding_window_analysis()
    >>> pipeline.run_adaptive_window_analysis()
    >>> 
    >>> # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
    >>> report = pipeline.generate_comprehensive_report()
    """
    
    def __init__(self, data, model, metrics_calculator):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
        
        Parameters:
        -----------
        data : pandas.DataFrame
            –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ 'returns' –∏ 'features'
            
        model : sklearn-compatible model
            –ú–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –º–µ—Ç–æ–¥–∞–º–∏ fit –∏ predict
            
        metrics_calculator : object
            –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å –º–µ—Ç–æ–¥–æ–º calculate
        """
        self.data = data
        self.model = model
        self.metrics_calculator = metrics_calculator
        self.results = {}
    
    def run_fixed_window_analysis(self, train_window=252, test_window=30, step=30):
        """
        –ó–∞–ø—É—Å–∫ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –æ–∫–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
        
        Parameters:
        -----------
        train_window : int, default=252
            –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 252: –æ–¥–∏–Ω —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 126: –ø–æ–ª–≥–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
            - 504: –¥–≤–∞ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: 50 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            - –ú–∞–∫—Å–∏–º—É–º: 1000 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
            
        test_window : int, default=30
            –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
            - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
            
        step : int, default=30
            –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
            - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
            
        Returns:
        --------
        pd.DataFrame
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
            - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'window_size': —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int)
            - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            
        Raises:
        -------
        ValueError
            –ï—Å–ª–∏ train_window < 50 –∏–ª–∏ test_window < 5
            –ï—Å–ª–∏ step > test_window
            –ï—Å–ª–∏ len(data) < train_window + test_window
            
        Notes:
        ------
        - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ self.results['fixed_window']
        - –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
        - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
        """
        results = []
        
        for i in range(train_window, len(self.data) - test_window, step):
            # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            train_data = self.data[i-train_window:i]
            
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            test_data = self.data[i:i+test_window]
            
            # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
            self.model.fit(train_data)
            
            # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
            predictions = self.model.predict(test_data)
            
            # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
            returns = test_data['returns']
            strategy_returns = predictions * returns
            
            metrics = self.metrics_calculator.calculate(strategy_returns)
            metrics.update({
                'train_start': train_data.index[0],
                'train_end': train_data.index[-1],
                'test_start': test_data.index[0],
                'test_end': test_data.index[-1],
                'window_size': train_window
            })
            
            results.append(metrics)
        
        self.results['fixed_window'] = pd.DataFrame(results)
        return self.results['fixed_window']
    
    def run_expanding_window_analysis(self, initial_train_window=252, test_window=30, step=30):
        """
        –ó–∞–ø—É—Å–∫ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å —Ä–∞—Å—à–∏—Ä—è—é—â–∏–º—Å—è –æ–∫–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
        
        Parameters:
        -----------
        initial_train_window : int, default=252
            –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 252: –æ–¥–∏–Ω —Ç–æ—Ä–≥–æ–≤—ã–π –≥–æ–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 126: –ø–æ–ª–≥–æ–¥–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
            - 504: –¥–≤–∞ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: 50 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            - –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–∫–Ω–æ –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å—Å—è –Ω–∞ step –¥–Ω–µ–π –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é
            
        test_window : int, default=30
            –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
            - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
            
        step : int, default=30
            –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
            - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
            
        Returns:
        --------
        pd.DataFrame
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
            - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'window_size': —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int) - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
            - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            
        Raises:
        -------
        ValueError
            –ï—Å–ª–∏ initial_train_window < 50 –∏–ª–∏ test_window < 5
            –ï—Å–ª–∏ step > test_window
            –ï—Å–ª–∏ len(data) < initial_train_window + test_window
            
        Notes:
        ------
        - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ self.results['expanding_window']
        - –û–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é
        - –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–∑-–∑–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –≥–¥–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏
        """
        results = []
        
        for i in range(initial_train_window, len(self.data) - test_window, step):
            # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (—Ä–∞—Å—à–∏—Ä—è—é—â–µ–µ—Å—è –æ–∫–Ω–æ)
            train_data = self.data[:i]
            
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            test_data = self.data[i:i+test_window]
            
            # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
            self.model.fit(train_data)
            
            # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
            predictions = self.model.predict(test_data)
            
            # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
            returns = test_data['returns']
            strategy_returns = predictions * returns
            
            metrics = self.metrics_calculator.calculate(strategy_returns)
            metrics.update({
                'train_start': train_data.index[0],
                'train_end': train_data.index[-1],
                'test_start': test_data.index[0],
                'test_end': test_data.index[-1],
                'window_size': len(train_data)
            })
            
            results.append(metrics)
        
        self.results['expanding_window'] = pd.DataFrame(results)
        return self.results['expanding_window']
    
    def run_adaptive_window_analysis(self, min_window=100, max_window=500, 
                                   test_window=30, step=30):
        """
        –ó–∞–ø—É—Å–∫ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –æ–∫–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
        
        Parameters:
        -----------
        min_window : int, default=100
            –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 100: –º–∏–Ω–∏–º—É–º –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 50: –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            - 200: –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
            - –ú–∏–Ω–∏–º—É–º: 30 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
            - –ú–∞–∫—Å–∏–º—É–º: 300 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
            
        max_window : int, default=500
            –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 500: –¥–≤–∞ –≥–æ–¥–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 252: –æ–¥–∏–Ω –≥–æ–¥ (–¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 1000: —á–µ—Ç—ã—Ä–µ –≥–æ–¥–∞ (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: min_window + 100
            - –ú–∞–∫—Å–∏–º—É–º: 2000 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
            
        test_window : int, default=30
            –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö:
            - 30: –æ–¥–∏–Ω –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª (–¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - –ú–∏–Ω–∏–º—É–º: 5 –¥–Ω–µ–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
            - –ú–∞–∫—Å–∏–º—É–º: 180 –¥–Ω–µ–π –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è
            
        step : int, default=30
            –®–∞–≥ —Å–¥–≤–∏–≥–∞ –æ–∫–Ω–∞ –≤ –¥–Ω—è—Ö:
            - 30: –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            - 7: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 1: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - 90: –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
            - step <= test_window –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
            
        Returns:
        --------
        pd.DataFrame
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
            - 'train_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'train_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è (datetime)
            - 'test_start': –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'test_end': –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (datetime)
            - 'window_size': —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è (int)
            - 'sharpe': –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'max_drawdown': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            - 'total_return': –æ–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (float)
            
        Raises:
        -------
        ValueError
            –ï—Å–ª–∏ min_window < 30 –∏–ª–∏ max_window < min_window + 100
            –ï—Å–ª–∏ test_window < 5 –∏–ª–∏ step > test_window
            –ï—Å–ª–∏ len(data) < min_window + test_window
            
        Notes:
        ------
        - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ self.results['adaptive_window']
        - –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
        - –ü—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–∫–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
        - –ü—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–∫–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
        - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å –∏–∑–º–µ–Ω—è—é—â–∏–º–∏—Å—è —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
        """
        results = []
        current_window = min_window
        
        for i in range(min_window, len(self.data) - test_window, step):
            # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
            train_data = self.data[i-current_window:i]
            
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            test_data = self.data[i:i+test_window]
            
            # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
            self.model.fit(train_data)
            
            # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
            predictions = self.model.predict(test_data)
            
            # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
            returns = test_data['returns']
            strategy_returns = predictions * returns
            
            metrics = self.metrics_calculator.calculate(strategy_returns)
            metrics.update({
                'train_start': train_data.index[0],
                'train_end': train_data.index[-1],
                'test_start': test_data.index[0],
                'test_end': test_data.index[-1],
                'window_size': current_window
            })
            
            # –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            if len(results) > 0:
                recent_sharpe = results[-1]['sharpe']
                current_sharpe = metrics['sharpe']
                
                if current_sharpe < recent_sharpe * 0.9:
                    current_window = min(current_window + 50, max_window)
                elif current_sharpe > recent_sharpe * 1.1:
                    current_window = max(current_window - 50, min_window)
            
            results.append(metrics)
        
        self.results['adaptive_window'] = pd.DataFrame(results)
        return self.results['adaptive_window']
    
    def generate_comprehensive_report(self):
        """
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º Walk-Forward –∞–Ω–∞–ª–∏–∑–∞
        
        –°–æ–∑–¥–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å –∞–Ω–∞–ª–∏–∑–æ–º –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ Walk-Forward –∞–Ω–∞–ª–∏–∑–∞,
        –≤–∫–ª—é—á–∞—è —Å–≤–æ–¥–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
        
        Returns:
        --------
        dict
            –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–ª—é—á–∞–º–∏:
            - 'summary': —Å–ª–æ–≤–∞—Ä—å —Å —Å–≤–æ–¥–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞
              - 'fixed_window': –º–µ—Ç—Ä–∏–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
              - 'expanding_window': –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—à–∏—Ä—è—é—â–µ–≥–æ—Å—è –æ–∫–Ω–∞
              - 'adaptive_window': –º–µ—Ç—Ä–∏–∫–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
              - –ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç
                - 'mean_sharpe': —Å—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ (float)
                - 'std_sharpe': —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ (float)
                - 'mean_max_drawdown': —Å—Ä–µ–¥–Ω—è—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ (float)
                - 'success_rate': –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ (float)
                - 'sharpe_stability': —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ (float)
                - 'sharpe_trend': —Ç—Ä–µ–Ω–¥ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞ (float)
            - 'detailed_results': —Å–ª–æ–≤–∞—Ä—å —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
              - 'fixed_window': DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
              - 'expanding_window': DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ä–∞—Å—à–∏—Ä—è—é—â–µ–≥–æ—Å—è –æ–∫–Ω–∞
              - 'adaptive_window': DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
            - 'recommendations': —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (list)
              - –°—Ç—Ä–æ–∫–∏ —Å –æ—Ü–µ–Ω–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞
              - "–û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å": Sharpe > 1.5, Success > 70%
              - "–•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å": Sharpe > 1.0, Success > 50%
              - "–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è": –∏–Ω–∞—á–µ
        
        Raises:
        -------
        ValueError
            –ï—Å–ª–∏ self.results –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ –∫–ª—é—á–∏
            –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏
            
        Notes:
        ------
        - –û—Ç—á–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–æ–≤
        - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        - –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –≤–∞—Ä–∏–∞—Ü–∏–∏
        - –¢—Ä–µ–Ω–¥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
        - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á–µ—Ç–∞
        
        Examples:
        ---------
        >>> pipeline = WalkForwardPipeline(data, model, metrics_calc)
        >>> pipeline.run_fixed_window_analysis()
        >>> pipeline.run_expanding_window_analysis()
        >>> pipeline.run_adaptive_window_analysis()
        >>> 
        >>> report = pipeline.generate_comprehensive_report()
        >>> print("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:", report['recommendations'])
        """
        report = {
            'summary': {},
            'detailed_results': self.results,
            'recommendations': []
        }
        
        # –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞
        for method, results in self.results.items():
            if isinstance(results, pd.DataFrame):
                # –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
                mean_sharpe = results['sharpe'].mean()
                std_sharpe = results['sharpe'].std()
                mean_max_drawdown = results['max_drawdown'].mean()
                success_rate = (results['sharpe'] > 1.0).mean()
                
                # –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                sharpe_stability = 1 / (std_sharpe / mean_sharpe) if mean_sharpe != 0 else 0
                
                # –¢—Ä–µ–Ω–¥
                sharpe_trend = np.polyfit(range(len(results)), results['sharpe'], 1)[0]
                
                report['summary'][method] = {
                    'mean_sharpe': mean_sharpe,
                    'std_sharpe': std_sharpe,
                    'mean_max_drawdown': mean_max_drawdown,
                    'success_rate': success_rate,
                    'sharpe_stability': sharpe_stability,
                    'sharpe_trend': sharpe_trend
                }
                
                # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                if mean_sharpe > 1.5 and success_rate > 0.7:
                    report['recommendations'].append(f"{method}: –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å")
                elif mean_sharpe > 1.0 and success_rate > 0.5:
                    report['recommendations'].append(f"{method}: –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å")
                else:
                    report['recommendations'].append(f"{method}: –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è")
        
        return report

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
pipeline = WalkForwardPipeline(data, model, metrics_calculator)
pipeline.run_fixed_window_analysis()
pipeline.run_expanding_window_analysis()
pipeline.run_adaptive_window_analysis()
report = pipeline.generate_comprehensive_report()
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Walk-Forward –∞–Ω–∞–ª–∏–∑ - —ç—Ç–æ –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ML-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:

1. **–ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é** - –º–æ–¥–µ–ª—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è
2. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∏–∑–º–µ–Ω—è—é—â–∏—Ö—Å—è —É—Å–ª–æ–≤–∏—è—Ö
3. **–û—Ü–µ–Ω–∏–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
4. **–í—ã—è–≤–ª—è—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ** - –º–æ–¥–µ–ª—å –Ω–µ –¥–æ–ª–∂–Ω–∞ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –Ω–æ–≤—ã–º —É—Å–ª–æ–≤–∏—è–º
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å** - —É—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è Walk-Forward –∞–Ω–∞–ª–∏–∑–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:

- [Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è–º](./29_monte_carlo_simulations.md)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ](./30_portfolio_management.md)
