# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoML Gluon

**–ê–≤—Ç–æ—Ä:** Shcherbyna Rostyslav  
**–î–∞—Ç–∞:** 2024  

## –ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞

**–ü–æ—á–µ–º—É 90% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π AutoML Gluon –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, –∫–∞–∫—É—é –º–æ—â—å –æ–Ω–∏ —É–ø—É—Å–∫–∞—é—Ç. –≠—Ç–æ –∫–∞–∫ –≤–æ–¥–∏—Ç—å Ferrari –Ω–∞ –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–µ - –º–∞—à–∏–Ω–∞ –µ–¥–µ—Ç, –Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

### –ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è?
- **–¢–æ—á–Ω–æ—Å—Ç—å**: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ 10-30% –ª—É—á—à–µ
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –û–±—É—á–µ–Ω–∏–µ —É—Å–∫–æ—Ä—è–µ—Ç—Å—è –≤ 2-5 —Ä–∞–∑
- **–ö–æ–Ω—Ç—Ä–æ–ª—å**: –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –ú–æ–¥–µ–ª—å –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏?
- **–°—Ä–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç "–∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—Å—è"
- **–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –¢—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**: GPU –∏ CPU —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- **–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ**: –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –ø–æ—á–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ —É–ª—É—á—à–∞—é—Ç—Å—è

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü–æ—á–µ–º—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã - —ç—Ç–æ –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º —É—á–∏—Ç—Å—è. –≠—Ç–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–π –∑–≤—É–∫.

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã?** –ü–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö —Å–ª—É—á–∞–µ–≤, –∞ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Å–æ–±–µ–Ω–Ω—ã–º–∏.

```python
# –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
hyperparameters = {
    'GBM': [  # Gradient Boosting Machine - –æ–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
        {
            # –ë—ã—Å—Ç—Ä–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
            'num_boost_round': 100,        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ (–±–æ–ª—å—à–µ = —Ç–æ—á–Ω–µ–µ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ)
            'num_leaves': 31,               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç—å–µ–≤ –≤ –¥–µ—Ä–µ–≤–µ
            'learning_rate': 0.1,          # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–º–µ–Ω—å—à–µ = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)
            'feature_fraction': 0.9,        # –î–æ–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)
            'bagging_fraction': 0.8,        # –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞
            'bagging_freq': 5,              # –ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è bagging
            'min_data_in_leaf': 20,         # –ú–∏–Ω–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç–µ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)
            'min_sum_hessian_in_leaf': 1e-3, # –ú–∏–Ω–∏–º—É–º —Å—É–º–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤ –ª–∏—Å—Ç–µ
            'lambda_l1': 0.0,              # L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Lasso)
            'lambda_l2': 0.0,              # L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Ridge)
            'min_gain_to_split': 0.0,       # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
            'max_depth': -1,               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ (-1 = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
            'save_binary': True,            # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã
            'seed': 0,                     # –°–µ–º—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
            'feature_fraction_seed': 2,     # –°–µ–º—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
            'bagging_seed': 3,              # –°–µ–º—è –¥–ª—è bagging
            'drop_seed': 4,                 # –°–µ–º—è –¥–ª—è dropout
            'verbose': -1,                  # –£—Ä–æ–≤–µ–Ω—å –≤—ã–≤–æ–¥–∞ (-1 = —Ç–∏—Ö–æ)
            'keep_training_booster': False  # –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –º–æ–¥–µ–ª–∏
        },
        {
            # –¢—â–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
            'num_boost_round': 200,        # –ë–æ–ª—å—à–µ –¥–µ—Ä–µ–≤—å–µ–≤ –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
            'num_leaves': 63,               # –ë–æ–ª—å—à–µ –ª–∏—Å—Ç—å–µ–≤ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
            'learning_rate': 0.05,          # –ú–µ–Ω—å—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            'feature_fraction': 0.8,        # –ú–µ–Ω—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
            'bagging_fraction': 0.7,        # –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
            'bagging_freq': 5,              # –¢–∞ –∂–µ —á–∞—Å—Ç–æ—Ç–∞ bagging
            'min_data_in_leaf': 10,         # –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç–µ –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
            'min_sum_hessian_in_leaf': 1e-3, # –¢–æ—Ç –∂–µ –º–∏–Ω–∏–º—É–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
            'lambda_l1': 0.1,              # L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
            'lambda_l2': 0.1,              # L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
            'min_gain_to_split': 0.0,       # –¢–æ—Ç –∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç
            'max_depth': -1,               # –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≥–ª—É–±–∏–Ω—ã
            'save_binary': True,            # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã
            'seed': 0,                     # –°–µ–º—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
            'feature_fraction_seed': 2,     # –°–µ–º—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
            'bagging_seed': 3,              # –°–µ–º—è –¥–ª—è bagging
            'drop_seed': 4,                 # –°–µ–º—è –¥–ª—è dropout
            'verbose': -1,                  # –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º
            'keep_training_booster': False
        }
    ],
    'CAT': [  # CatBoost - –æ—Ç–ª–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        {
            # –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CatBoost
            'iterations': 100,           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π (–±–æ–ª—å—à–µ = —Ç–æ—á–Ω–µ–µ)
            'learning_rate': 0.1,        # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
            'depth': 6,                  # –ì–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤ (–±–æ–ª—å—à–µ = —Å–ª–æ–∂–Ω–µ–µ)
            'l2_leaf_reg': 3.0,          # L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ª–∏—Å—Ç—å–µ–≤
            'bootstrap_type': 'Bayesian',
            'random_strength': 1.0,
            'bagging_temperature': 1.0,
            'od_type': 'Iter',
            'od_wait': 20,
            'verbose': False
        },
        {
            'iterations': 200,
            'learning_rate': 0.05,
            'depth': 8,
            'l2_leaf_reg': 5.0,
            'bootstrap_type': 'Bayesian',
            'random_strength': 1.0,
            'bagging_temperature': 1.0,
            'od_type': 'Iter',
            'od_wait': 20,
            'verbose': False
        }
    ],
    'XGB': [
        {
            'n_estimators': 100,
            'max_depth': 6,
            'learning_rate': 0.1,
            'subsample': 0.8,
            'colsample_bytree': 0.8,
            'reg_alpha': 0.0,
            'reg_lambda': 1.0,
            'random_state': 0
        },
        {
            'n_estimators': 200,
            'max_depth': 8,
            'learning_rate': 0.05,
            'subsample': 0.9,
            'colsample_bytree': 0.9,
            'reg_alpha': 0.1,
            'reg_lambda': 1.0,
            'random_state': 0
        }
    ],
    'RF': [
        {
            'n_estimators': 100,
            'max_depth': 10,
            'min_samples_split': 2,
            'min_samples_leaf': 1,
            'max_features': 'sqrt',
            'bootstrap': True,
            'random_state': 0
        }
    ],
    'KNN': [
        {
            'n_neighbors': 5,
            'weights': 'uniform',
            'algorithm': 'auto',
            'leaf_size': 30,
            'p': 2,
            'metric': 'minkowski'
        }
    ]
}

predictor.fit(train_data, hyperparameters=hyperparameters)
```

#### üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã LightGBM (GBM):**

**`num_boost_round`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ (–±—É—Å—Ç–µ—Ä–æ–≤) –≤ –∞–Ω—Å–∞–º–±–ª–µ
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ë–æ–ª—å—à–µ –¥–µ—Ä–µ–≤—å–µ–≤ = –ª—É—á—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±—É—á–µ–Ω–∏–µ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ë—ã—Å—Ç—Ä—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã**: `50-100`
  - **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏**: `100-300`
  - **–í–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏**: `300-1000`
  - **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ**: `1000+`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
  - **–ú–∞–ª–æ –¥–µ—Ä–µ–≤—å–µ–≤**: –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ
  - **–ú–Ω–æ–≥–æ –¥–µ—Ä–µ–≤—å–µ–≤**: –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã**:
  - **–ü—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ**: `50-100` –¥–µ—Ä–µ–≤—å–µ–≤
  - **–°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `200-500` –¥–µ—Ä–µ–≤—å–µ–≤
  - **–û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `500+` –¥–µ—Ä–µ–≤—å–µ–≤

**`num_leaves`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç—å–µ–≤ –≤ –¥–µ—Ä–µ–≤–µ
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ë–æ–ª—å—à–µ –ª–∏—Å—Ç—å–µ–≤ = —Å–ª–æ–∂–Ω–µ–µ –º–æ–¥–µ–ª—å, –Ω–æ —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ü—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ**: `31-63`
  - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ**: `63-127`
  - **–°–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `127-255`
  - **–û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `255+`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª—å**:
  - **–ú–∞–ª–æ –ª–∏—Å—Ç—å–µ–≤**: –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å, –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–ú–Ω–æ–≥–æ –ª–∏—Å—Ç—å–µ–≤**: –°–ª–æ–∂–Ω–∞—è –º–æ–¥–µ–ª—å, –±–æ–ª—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º

**`learning_rate`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (—à–∞–≥ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞)
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ú–µ–Ω—å—à–µ —Å–∫–æ—Ä–æ—Å—Ç—å = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: `0.1-0.3`
  - **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: `0.05-0.1`
  - **–¢—â–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: `0.01-0.05`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ**:
  - **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º
  - **–ù–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**: –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤—å–µ–≤

**`feature_fraction`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –î–æ–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ú–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: `0.5-0.8`
  - **–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ**: `0.8-0.9`
  - **–ú–∞–ª–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: `0.9-1.0`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª—å**:
  - **–ú–∞–ª–µ–Ω—å–∫–∞—è –¥–æ–ª—è**: –ë–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è, –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–ë–æ–ª—å—à–∞—è –¥–æ–ª—è**: –ú–µ–Ω—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è, –±–æ–ª—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**`bagging_fraction`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ë–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ**: `0.5-0.8`
  - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ**: `0.8-0.9`
  - **–ú–∞–ª—ã–µ –¥–∞–Ω–Ω—ã–µ**: `0.9-1.0`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª—å**:
  - **–ú–∞–ª–µ–Ω—å–∫–∞—è –¥–æ–ª—è**: –ë–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è, –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–ë–æ–ª—å—à–∞—è –¥–æ–ª—è**: –ú–µ–Ω—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è, –±–æ–ª—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**`min_data_in_leaf`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç–µ –¥–µ—Ä–µ–≤–∞
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ, —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **–ë–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ**: `10-50`
  - **–°—Ä–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ**: `20-100`
  - **–ú–∞–ª—ã–µ –¥–∞–Ω–Ω—ã–µ**: `50-200`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª—å**:
  - **–ú–∞–ª–µ–Ω—å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å, —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–ë–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: –ë–æ–ª–µ–µ –æ–±–æ–±—â–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
  - **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏

**`lambda_l1` –∏ `lambda_l2`:**
- **–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç**: L1 –∏ L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- **–ó–∞—á–µ–º –Ω—É–∂–Ω—ã**: L1 –æ—Ç–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏, L2 —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
  - **L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è**: `0.0-0.1` (–æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
  - **L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è**: `0.0-0.1` (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–æ–¥–µ–ª—å**:
  - **L1 > 0**: –û—Ç–±–∏—Ä–∞–µ—Ç –Ω–µ–≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
  - **L2 > 0**: –°–≥–ª–∞–∂–∏–≤–∞–µ—Ç –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏
  - **–û–±–∞ > 0**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
from autogluon.core import Space

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞
hyperparameter_space = {
    'GBM': {
        'num_boost_round': Space(50, 500),
        'num_leaves': Space(31, 127),
        'learning_rate': Space(0.01, 0.3),
        'feature_fraction': Space(0.5, 1.0),
        'bagging_fraction': Space(0.5, 1.0)
    },
    'XGB': {
        'n_estimators': Space(50, 500),
        'max_depth': Space(3, 10),
        'learning_rate': Space(0.01, 0.3),
        'subsample': Space(0.5, 1.0),
        'colsample_bytree': Space(0.5, 1.0)
    }
}

predictor.fit(
    train_data,
    hyperparameter_tune_kwargs={
        'num_trials': 20,
        'scheduler': 'local',
        'searcher': 'auto'
    }
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∞–Ω—Å–∞–º–±–ª–∏

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∏–Ω–≥–∞
predictor.fit(
    train_data,
    num_bag_folds=5,        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞
    num_bag_sets=2,         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –±—ç–≥–≥–∏–Ω–≥–∞
    num_stack_levels=2,     # –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞
    stack_ensemble_levels=[0, 1],  # –ö–∞–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç–µ–∫–∏–Ω–≥–∞
    ag_args_fit={'num_gpus': 1, 'num_cpus': 4}  # –†–µ—Å—É—Ä—Å—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
)
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–∏

```python
from autogluon.tabular.models import AbstractModel

class CustomEnsembleModel(AbstractModel):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.models = []
    
    def _fit(self, X, y, **kwargs):
        # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è
        pass
    
    def _predict(self, X, **kwargs):
        # –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è
        pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è
predictor.fit(
    train_data,
    custom_ensemble_model=CustomEnsembleModel
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤

### CPU –∏ GPU –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
ag_args_fit = {
    'num_cpus': 8,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä
    'num_gpus': 1,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU
    'memory_limit': 16,     # –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ GB
    'time_limit': 3600      # –õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
}

predictor.fit(
    train_data,
    ag_args_fit=ag_args_fit
)
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
from autogluon.core import scheduler

# –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
local_scheduler = scheduler.LocalScheduler(
    num_cpus=8,
    num_gpus=1
)

predictor.fit(
    train_data,
    scheduler=local_scheduler
)
```

## –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

```python
# –û–±—É—á–µ–Ω–∏–µ –ø–æ —á–∞—Å—Ç—è–º
chunk_size = 10000
for i in range(0, len(train_data), chunk_size):
    chunk = train_data[i:i+chunk_size]
    if i == 0:
        predictor.fit(chunk)
    else:
        predictor.fit(chunk, refit_full=True)
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
from autogluon.core import scheduler

# Ray –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
ray_scheduler = scheduler.RayScheduler(
    num_cpus=32,
    num_gpus=4,
    ray_address='auto'
)

predictor.fit(
    train_data,
    scheduler=ray_scheduler
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```python
from sklearn.model_selection import TimeSeriesSplit

# –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
def time_series_split(X, y, n_splits=5):
    tscv = TimeSeriesSplit(n_splits=n_splits)
    for train_idx, val_idx in tscv.split(X):
        yield train_idx, val_idx

predictor.fit(
    train_data,
    validation_strategy='custom',
    custom_validation_strategy=time_series_split
)
```

### –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
from sklearn.model_selection import StratifiedKFold

# –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
def stratified_split(X, y, n_splits=5):
    skf = StratifiedKFold(n_splits=n_splits, shuffle=True, random_state=42)
    for train_idx, val_idx in skf.split(X, y):
        yield train_idx, val_idx

predictor.fit(
    train_data,
    validation_strategy='custom',
    custom_validation_strategy=stratified_split
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

```python
from autogluon.features import FeatureGenerator

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
class CustomFeatureGenerator(FeatureGenerator):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.custom_features = []
    
    def _generate_features(self, X):
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        X['feature_ratio'] = X['feature1'] / (X['feature2'] + 1e-8)
        X['feature_interaction'] = X['feature1'] * X['feature2']
        return X

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
feature_generator = CustomFeatureGenerator()
train_data_processed = feature_generator.fit_transform(train_data)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞
text_features = {
    'enable_text_special_features': True,
    'enable_text_ngram_features': True,
    'text_ngram_range': (1, 3),
    'text_max_features': 10000,
    'text_min_df': 2,
    'text_max_df': 0.95
}

predictor.fit(
    train_data,
    feature_generator_kwargs=text_features
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```python
from autogluon.core import Scorer

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏
def custom_metric(y_true, y_pred):
    """–ö–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"""
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫–∏
    return score

custom_scorer = Scorer(
    name='custom_metric',
    score_func=custom_metric,
    greater_is_better=True
)

predictor.fit(
    train_data,
    eval_metric=custom_scorer
)
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```python
# –û–±—É—á–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
predictor.fit(
    train_data,
    eval_metric=['accuracy', 'f1', 'roc_auc']
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
import logging

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('autogluon.log'),
        logging.StreamHandler()
    ]
)

# –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
predictor.fit(
    train_data,
    verbosity=3,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    log_to_file=True
)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

```python
# Callback –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
def training_monitor(epoch, logs):
    print(f"Epoch {epoch}: {logs}")

predictor.fit(
    train_data,
    callbacks=[training_monitor]
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
production_config = {
    'presets': 'optimize_for_deployment',
    'ag_args_fit': {
        'num_cpus': 4,
        'num_gpus': 0,
        'memory_limit': 8
    },
    'hyperparameters': {
        'GBM': [{'num_boost_round': 100}],
        'XGB': [{'n_estimators': 100}],
        'RF': [{'n_estimators': 100}]
    }
}

predictor.fit(train_data, **production_config)
```

### –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏

```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–π –º–æ–¥–µ–ª–∏
predictor.save(
    'production_model',
    save_space=True,
    compress=True
)
```

## –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```python
from autogluon.tabular import TabularPredictor
import pandas as pd

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
predictor = TabularPredictor(
    label='target',
    problem_type='auto',
    eval_metric='auto',
    path='./models',
    verbosity=2
)

# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
advanced_hyperparameters = {
    'GBM': [
        {
            'num_boost_round': 1000,
            'num_leaves': 31,
            'learning_rate': 0.1,
            'feature_fraction': 0.9,
            'bagging_fraction': 0.8,
            'bagging_freq': 5,
            'min_data_in_leaf': 20,
            'min_sum_hessian_in_leaf': 1e-3,
            'lambda_l1': 0.0,
            'lambda_l2': 0.0,
            'min_gain_to_split': 0.0,
            'max_depth': -1,
            'save_binary': True,
            'seed': 0,
            'feature_fraction_seed': 2,
            'bagging_seed': 3,
            'drop_seed': 4,
            'verbose': -1,
            'keep_training_booster': False
        }
    ],
    'CAT': [
        {
            'iterations': 1000,
            'learning_rate': 0.1,
            'depth': 6,
            'l2_leaf_reg': 3.0,
            'bootstrap_type': 'Bayesian',
            'random_strength': 1.0,
            'bagging_temperature': 1.0,
            'od_type': 'Iter',
            'od_wait': 20,
            'verbose': False
        }
    ],
    'XGB': [
        {
            'n_estimators': 1000,
            'max_depth': 6,
            'learning_rate': 0.1,
            'subsample': 0.8,
            'colsample_bytree': 0.8,
            'reg_alpha': 0.0,
            'reg_lambda': 1.0,
            'random_state': 0
        }
    ]
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
ag_args_fit = {
    'num_cpus': 8,
    'num_gpus': 1,
    'memory_limit': 16,
    'time_limit': 3600
}

# –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
predictor.fit(
    train_data,
    hyperparameters=advanced_hyperparameters,
    num_bag_folds=5,
    num_bag_sets=2,
    num_stack_levels=1,
    ag_args_fit=ag_args_fit,
    presets='best_quality',
    time_limit=3600,
    holdout_frac=0.2,
    verbosity=2
)
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:
- [–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏](./04_metrics.md)
- [–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏](./05_validation.md)
- [–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é](./06_production.md)
