# –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∏–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ, —É—Å–ø–µ—à–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ê–≤—Ç–æ—Ä:** Shcherbyna Rostyslav  
**–î–∞—Ç–∞:** 2024  

## –ü–æ—á–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ - –æ—Å–Ω–æ–≤–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üéØ –í–∞–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```mermaid
graph TD
    A[–ò–Ω–≤–µ—Å—Ç–æ—Ä] --> B{–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ?}
    
    B -->|–ù–µ—Ç| C[90% –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏]
    C --> D[‚ùå –í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏<br/>–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –≤ –æ–¥–Ω–æ–º –∞–∫—Ç–∏–≤–µ]
    C --> E[‚ùå –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å<br/>–†–µ–∑–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏]
    C --> F[‚ùå –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏<br/>–í–æ –≤—Ä–µ–º—è –∫—Ä–∏–∑–∏—Å–æ–≤]
    C --> G[‚ùå –ù–µ–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π<br/>–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ –≤ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö]
    
    B -->|–î–∞| H[10% —É—Å–ø–µ—à–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤]
    H --> I[‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å<br/>–°–Ω–∏–∂–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∏—Å–∫–æ–≤]
    H --> J[‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏<br/>–ü—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∏—Å–∫–∞]
    H --> K[‚úÖ –†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å<br/>–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º]
    H --> L[‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å<br/>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–∏–º–∏ –∫–∞–ø–∏—Ç–∞–ª–∞–º–∏]
    
    I --> M[–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤]
    J --> N[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤]
    K --> O[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏]
    L --> P[–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥]
    
    M --> Q[–£—Å–ø–µ—à–Ω—ã–π –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    N --> Q
    O --> Q
    P --> Q
    
    Q --> R[‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏]
    
    style A fill:#e3f2fd
    style H fill:#c8e6c9
    style C fill:#ffcdd2
    style R fill:#4caf50
```

**–ü–æ—á–µ–º—É 90% –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏?** –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø—Ä–∏–±—ã–ª—å–Ω—ã–π –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.

### –ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ?
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∏—Å–∫–æ–≤
- **–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∏—Å–∫–∞
- **–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å**: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–ª—å—à–∏–º–∏ –∫–∞–ø–∏—Ç–∞–ª–∞–º–∏

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ?
- **–í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏**: –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –≤ –æ–¥–Ω–æ–º –∞–∫—Ç–∏–≤–µ –∏–ª–∏ —Å–µ–∫—Ç–æ—Ä–µ
- **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –†–µ–∑–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
- **–ü–æ—Ç–µ—Ä–∏**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –≤–æ –≤—Ä–µ–º—è –∫—Ä–∏–∑–∏—Å–æ–≤
- **–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ**: –ù–µ–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∫–∞–∫ –∑–∞–¥–∞—á–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

```
max w^T Œº - Œª/2 * w^T Œ£ w
subject to: w^T 1 = 1, w ‚â• 0
```

–ì–¥–µ:
- `w` - –≤–µ—Å–∞ –∞–∫—Ç–∏–≤–æ–≤ –≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
- `Œº` - –æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–æ–≤
- `Œ£` - –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∞–∫—Ç–∏–≤–æ–≤
- `Œª` - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∏—Å–∫–∞

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ:**

1. **–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å**: E[R_p] = w^T Œº
2. **–†–∏—Å–∫**: Var[R_p] = w^T Œ£ w
3. **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞**: (E[R_p] - r_f) / ‚àöVar[R_p]
4. **VaR**: P(R_p ‚â§ VaR) = Œ±

### –¢–∏–ø—ã –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TB
    A[–¢–∏–ø—ã –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ] --> B[–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    A --> C[–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    A --> D[–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    A --> E[–î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    
    B --> B1[–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫, –Ω–∏–∑–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Risk: 5-10%, Return: 3-6%]
    B --> B2[–û–±–ª–∏–≥–∞—Ü–∏–∏, –¥–µ–ø–æ–∑–∏—Ç—ã<br/>Government bonds, CDs]
    B --> B3[‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤<br/>–ü–µ–Ω—Å–∏–æ–Ω–µ—Ä—ã, –Ω–æ–≤–∏—á–∫–∏]
    B --> B4[üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –∫–∞–ø–∏—Ç–∞–ª–∞<br/>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏]
    B --> B5[üìà –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç<br/>–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã]
    
    C --> C1[–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫, —Å—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Risk: 10-15%, Return: 6-10%]
    C --> C2[–°–º–µ—Å—å –∞–∫—Ü–∏–π –∏ –æ–±–ª–∏–≥–∞—Ü–∏–π<br/>60% Stocks, 40% Bonds]
    C --> C3[‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤<br/>–°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç, –æ–ø—ã—Ç]
    C --> C4[‚öñÔ∏è –ë–∞–ª–∞–Ω—Å —Ä–∏—Å–∫–∞ –∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏<br/>–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ]
    C --> C5[üîÑ –ì–∏–±–∫–æ—Å—Ç—å<br/>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏]
    
    D --> D1[–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫, –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Risk: 15-25%, Return: 10-15%]
    D --> D2[–ê–∫—Ü–∏–∏, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏<br/>Stocks, REITs, Commodities]
    D --> D3[‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤<br/>–ú–æ–ª–æ–¥—ã–µ, –æ–ø—ã—Ç–Ω—ã–µ]
    D --> D4[üöÄ –í—ã—Å–æ–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞<br/>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å]
    D --> D5[‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å<br/>–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è]
    
    E --> E1[–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∏—Å–∫/–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Risk: 8-12%, Return: 8-12%]
    E --> E2[–†–∞–∑–ª–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∞–∫—Ç–∏–≤–æ–≤<br/>Stocks, Bonds, REITs, Commodities, Cash]
    E --> E3[‚úÖ –ù–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ<br/>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–æ—Ä—ã]
    E --> E4[üéØ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π]
    E --> E5[üìä –ù–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥<br/>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è]
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#ffcdd2
    style E fill:#4caf50
```

**1. –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ**
- –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫, –Ω–∏–∑–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- –û–±–ª–∏–≥–∞—Ü–∏–∏, –¥–µ–ø–æ–∑–∏—Ç—ã
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

**2. –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ**
- –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫, —Å—Ä–µ–¥–Ω—è—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- –°–º–µ—Å—å –∞–∫—Ü–∏–π –∏ –æ–±–ª–∏–≥–∞—Ü–∏–π
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

**3. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ**
- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫, –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- –ê–∫—Ü–∏–∏, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

**4. –î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ**
- –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∏—Å–∫/–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- –†–∞–∑–ª–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∞–∫—Ç–∏–≤–æ–≤
- –ù–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### üîß –ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[–ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ] --> B[–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã]
    A --> C[–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã]
    A --> D[ML-–º–µ—Ç–æ–¥—ã]
    
    B --> B1[Markowitz Mean-Variance<br/>max w^T Œº - Œª/2 * w^T Œ£ w]
    B --> B2[Black-Litterman Model<br/>Incorporates market views]
    B --> B3[Capital Asset Pricing Model<br/>CAPM framework]
    
    C --> C1[Risk Parity Portfolio<br/>Equal risk contribution]
    C --> C2[Minimum Variance Portfolio<br/>Minimize portfolio variance]
    C --> C3[Maximum Sharpe Portfolio<br/>Maximize Sharpe ratio]
    C --> C4[Equal Weight Portfolio<br/>1/N allocation]
    
    D --> D1[Clustering-based Portfolio<br/>K-means, Hierarchical]
    D --> D2[ML-based Optimization<br/>Random Forest, Neural Networks]
    D --> D3[Factor-based Portfolio<br/>Fama-French factors]
    D --> D4[Reinforcement Learning<br/>Dynamic optimization]
    
    B1 --> E[–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è<br/>Utility = Return - Œª * Risk]
    B2 --> F[–í–∫–ª—é—á–µ–Ω–∏–µ –≤–∑–≥–ª—è–¥–æ–≤<br/>P * Œº = Q + Œµ]
    C1 --> G[–†–∞–≤–Ω—ã–π –≤–∫–ª–∞–¥ –≤ —Ä–∏—Å–∫<br/>w_i * œÉ_i = constant]
    C2 --> H[–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏<br/>min w^T Œ£ w]
    C3 --> I[–ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è Sharpe<br/>max (Œº - r_f) / œÉ]
    
    D1 --> J[–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤<br/>Similar assets grouped]
    D2 --> K[ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è<br/>Predict returns/risks]
    D3 --> L[–§–∞–∫—Ç–æ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å<br/>R = Œ± + Œ≤ * F + Œµ]
    D4 --> M[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ<br/>Q-learning, Policy gradient]
    
    E --> N[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    F --> N
    G --> N
    H --> N
    I --> N
    J --> N
    K --> N
    L --> N
    M --> N
    
    N --> O[–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞<br/>w* = argmax Utility]
    O --> P[–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>Sharpe, VaR, Max DD]
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style O fill:#4caf50
```

**Markowitz Mean-Variance Optimization:**

```python
def markowitz_optimization(expected_returns, cov_matrix, risk_aversion=1.0, 
                          target_return=None, target_volatility=None):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –ø–æ Markowitz"""
    from scipy.optimize import minimize
    
    n_assets = len(expected_returns)
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    constraints = [{'type': 'eq', 'fun': lambda w: np.sum(w) - 1}]  # –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1
    
    if target_return is not None:
        constraints.append({
            'type': 'eq', 
            'fun': lambda w: np.dot(w, expected_returns) - target_return
        })
    
    if target_volatility is not None:
        constraints.append({
            'type': 'eq', 
            'fun': lambda w: np.sqrt(np.dot(w, np.dot(cov_matrix, w))) - target_volatility
        })
    
    # –ì—Ä–∞–Ω–∏—Ü—ã
    bounds = [(0, 1) for _ in range(n_assets)]  # –í–µ—Å–∞ –æ—Ç 0 –¥–æ 1
    
    # –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    def objective(w):
        portfolio_return = np.dot(w, expected_returns)
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        return -portfolio_return + risk_aversion * portfolio_variance
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞
    x0 = np.ones(n_assets) / n_assets
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")
    
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights = markowitz_optimization(expected_returns, cov_matrix, risk_aversion=1.0)
```

**Black-Litterman Model:**

```python
def black_litterman_optimization(market_caps, cov_matrix, risk_aversion=3.0, 
                                views=None, view_confidences=None):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –ø–æ Black-Litterman"""
    n_assets = len(market_caps)
    
    # –†—ã–Ω–æ—á–Ω—ã–µ –≤–µ—Å–∞
    market_weights = market_caps / np.sum(market_caps)
    
    # –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Ä—ã–Ω–∫–∞
    market_return = risk_aversion * np.dot(cov_matrix, market_weights)
    
    if views is not None:
        # –ú–∞—Ç—Ä–∏—Ü–∞ –≤–∑–≥–ª—è–¥–æ–≤
        P = np.array(views)
        n_views = len(views)
        
        # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤–æ –≤–∑–≥–ª—è–¥–∞—Ö
        if view_confidences is None:
            view_confidences = np.ones(n_views) * 0.1
        
        # –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏ –≤–∑–≥–ª—è–¥–æ–≤
        Omega = np.diag(view_confidences)
        
        # –û–∂–∏–¥–∞–µ–º—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –≤–∑–≥–ª—è–¥–æ–≤
        Q = np.array([view[1] for view in views])
        
        # Black-Litterman —Ñ–æ—Ä–º—É–ª—ã
        tau = 1.0  # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä
        M1 = np.linalg.inv(tau * cov_matrix)
        M2 = np.dot(P.T, np.dot(np.linalg.inv(Omega), P))
        M3 = np.dot(P.T, np.dot(np.linalg.inv(Omega), Q))
        
        # –û–∂–∏–¥–∞–µ–º—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
        expected_returns = np.dot(np.linalg.inv(M1 + M2), 
                                np.dot(M1, market_return) + M3)
        
        # –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
        portfolio_cov = np.linalg.inv(M1 + M2)
    else:
        expected_returns = market_return
        portfolio_cov = cov_matrix
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Markowitz
    weights = markowitz_optimization(expected_returns, portfolio_cov, risk_aversion)
    
    return weights, expected_returns, portfolio_cov

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights, expected_returns, portfolio_cov = black_litterman_optimization(
    market_caps, cov_matrix, risk_aversion=3.0, views=views
)
```

### 2. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**Risk Parity Portfolio:**

```python
def risk_parity_optimization(cov_matrix, target_risk=None):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å —Ä–∞–≤–Ω—ã–º —Ä–∏—Å–∫–æ–º"""
    from scipy.optimize import minimize
    
    n_assets = len(cov_matrix)
    
    # –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Å—É–º–º—ã –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–∞–∑–Ω–æ—Å—Ç–µ–π —Ä–∏—Å–∫–æ–≤
    def objective(w):
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        individual_risks = np.sqrt(np.diag(cov_matrix))
        target_risks = w * individual_risks
        
        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
        if target_risk is not None:
            target_risks = target_risks / np.sum(target_risks) * target_risk
        
        return np.sum((target_risks - target_risks.mean()) ** 2)
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    constraints = [{'type': 'eq', 'fun': lambda w: np.sum(w) - 1}]
    bounds = [(0, 1) for _ in range(n_assets)]
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞
    x0 = np.ones(n_assets) / n_assets
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights = risk_parity_optimization(cov_matrix, target_risk=0.1)
```

**Minimum Variance Portfolio:**

```python
def minimum_variance_optimization(cov_matrix):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π"""
    from scipy.optimize import minimize
    
    n_assets = len(cov_matrix)
    
    # –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏
    def objective(w):
        return np.dot(w, np.dot(cov_matrix, w))
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    constraints = [{'type': 'eq', 'fun': lambda w: np.sum(w) - 1}]
    bounds = [(0, 1) for _ in range(n_assets)]
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞
    x0 = np.ones(n_assets) / n_assets
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights = minimum_variance_optimization(cov_matrix)
```

**Maximum Sharpe Portfolio:**

```python
def maximum_sharpe_optimization(expected_returns, cov_matrix, risk_free_rate=0.02):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –®–∞—Ä–ø–∞"""
    from scipy.optimize import minimize
    
    n_assets = len(expected_returns)
    
    # –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –®–∞—Ä–ø–∞
    def objective(w):
        portfolio_return = np.dot(w, expected_returns)
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        sharpe = (portfolio_return - risk_free_rate) / np.sqrt(portfolio_variance)
        return -sharpe  # –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π Sharpe
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    constraints = [{'type': 'eq', 'fun': lambda w: np.sum(w) - 1}]
    bounds = [(0, 1) for _ in range(n_assets)]
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞
    x0 = np.ones(n_assets) / n_assets
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights = maximum_sharpe_optimization(expected_returns, cov_matrix, risk_free_rate=0.02)
```

### 3. –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[ML –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ] --> B[–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π]
    A --> C[–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤]
    A --> D[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    A --> E[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏]
    A --> F[–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞]
    
    B --> B1[Time Series Models<br/>LSTM, GRU, Transformer]
    B --> B2[Ensemble Methods<br/>Random Forest, XGBoost]
    B --> B3[Deep Learning<br/>Neural Networks, CNN]
    B --> B4[Feature Engineering<br/>Technical indicators, Sentiment]
    
    C --> C1[K-means Clustering<br/>Group similar assets]
    C --> C2[Hierarchical Clustering<br/>Dendrogram-based grouping]
    C --> C3[DBSCAN<br/>Density-based clustering]
    C --> C4[Gaussian Mixture<br/>Probabilistic clustering]
    
    D --> D1[Reinforcement Learning<br/>Q-learning, Policy Gradient]
    D --> D2[Genetic Algorithms<br/>Evolutionary optimization]
    D --> D3[Bayesian Optimization<br/>Gaussian Process optimization]
    D --> D4[Multi-objective Optimization<br/>Pareto frontier]
    
    E --> E1[VaR Prediction<br/>ML-based VaR estimation]
    E --> E2[Stress Testing<br/>Scenario generation with ML]
    E --> E3[Anomaly Detection<br/>Outlier detection in returns]
    E --> E4[Regime Detection<br/>Market regime classification]
    
    F --> F1[Signal Generation<br/>ML-based trading signals]
    F --> F2[Threshold Optimization<br/>Dynamic rebalancing thresholds]
    F --> F3[Transaction Cost Modeling<br/>Cost-aware rebalancing]
    F --> F4[Market Microstructure<br/>Order book analysis]
    
    B1 --> G[ML Pipeline]
    B2 --> G
    B3 --> G
    B4 --> G
    C1 --> G
    C2 --> G
    C3 --> G
    C4 --> G
    D1 --> G
    D2 --> G
    D3 --> G
    D4 --> G
    E1 --> G
    E2 --> G
    E3 --> G
    E4 --> G
    F1 --> G
    F2 --> G
    F3 --> G
    F4 --> G
    
    G --> H[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π<br/>Train on historical data]
    H --> I[–í–∞–ª–∏–¥–∞—Ü–∏—è<br/>Cross-validation, Walk-forward]
    I --> J[–î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω<br/>Real-time predictions]
    J --> K[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<br/>Model performance tracking]
    
    K --> L{–ú–æ–¥–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞?}
    L -->|–î–∞| M[‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ]
    L -->|–ù–µ—Ç| N[‚ùå –ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å]
    
    N --> O[–ê–Ω–∞–ª–∏–∑ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏<br/>Identify performance decline]
    O --> P[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö<br/>Include new market data]
    P --> Q[–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ<br/>Retrain with updated data]
    Q --> R[–í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏<br/>Test on out-of-sample data]
    R --> S[–î–µ–ø–ª–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏<br/>Replace old model]
    S --> K
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#ffcdd2
    style F fill:#e1f5fe
    style M fill:#4caf50
    style N fill:#ff9800
```

**Clustering-based Portfolio:**

```python
def clustering_portfolio_optimization(returns, n_clusters=5, method='kmeans'):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏"""
    from sklearn.cluster import KMeans, AgglomerativeClustering
    from sklearn.preprocessing import StandardScaler
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    scaler = StandardScaler()
    returns_scaled = scaler.fit_transform(returns)
    
    # –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
    if method == 'kmeans':
        clusterer = KMeans(n_clusters=n_clusters, random_state=42)
    elif method == 'hierarchical':
        clusterer = AgglomerativeClustering(n_clusters=n_clusters)
    else:
        raise ValueError(f"Unknown clustering method: {method}")
    
    clusters = clusterer.fit_predict(returns_scaled)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
    portfolio_weights = {}
    
    for cluster_id in range(n_clusters):
        cluster_returns = returns[clusters == cluster_id]
        
        if len(cluster_returns) > 1:
            # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞
            cluster_cov = np.cov(cluster_returns.T)
            cluster_expected_returns = np.mean(cluster_returns, axis=0)
            
            # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞
            cluster_weights = minimum_variance_optimization(cluster_cov)
            
            # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
            cluster_weights = cluster_weights / np.sum(cluster_weights)
            
            portfolio_weights[cluster_id] = {
                'weights': cluster_weights,
                'assets': cluster_returns.columns[clusters == cluster_id].tolist()
            }
    
    return portfolio_weights

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
clustering_portfolio = clustering_portfolio_optimization(returns, n_clusters=5, method='kmeans')
```

**ML-based Portfolio Optimization:**

```python
def ml_portfolio_optimization(returns, features, model, n_portfolios=1000):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è"""
    from sklearn.ensemble import RandomForestRegressor
    from sklearn.model_selection import train_test_split
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    X = features
    y = returns
    
    # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
    
    # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    model.fit(X_train, y_train)
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    predictions = model.predict(X_test)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
    portfolios = []
    
    for i in range(n_portfolios):
        # –°–ª—É—á–∞–π–Ω—ã–µ –≤–µ—Å–∞
        weights = np.random.dirichlet(np.ones(len(returns.columns)))
        
        # –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_return = np.dot(weights, predictions.mean(axis=0))
        
        # –†–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_variance = np.dot(weights, np.dot(predictions.cov(), weights))
        
        # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
        sharpe = portfolio_return / np.sqrt(portfolio_variance)
        
        portfolios.append({
            'weights': weights,
            'return': portfolio_return,
            'variance': portfolio_variance,
            'sharpe': sharpe
        })
    
    # –í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
    best_portfolio = max(portfolios, key=lambda x: x['sharpe'])
    
    return best_portfolio, portfolios

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
best_portfolio, all_portfolios = ml_portfolio_optimization(returns, features, model)
```

## –ú–µ—Ç–æ–¥—ã –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### üåê –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏] --> B[–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è]
    A --> C[–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã]
    A --> D[–§–∞–∫—Ç–æ—Ä–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è]
    
    B --> B1[–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–†–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –∏ —Ä–µ–≥–∏–æ–Ω—ã]
    B --> B2[–°–µ–∫—Ç–æ—Ä–∞–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–†–∞–∑–ª–∏—á–Ω—ã–µ –æ—Ç—Ä–∞—Å–ª–∏ —ç–∫–æ–Ω–æ–º–∏–∫–∏]
    B --> B3[–í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>Dollar-cost averaging]
    B --> B4[–ö–ª–∞—Å—Å–æ–≤–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>Stocks, Bonds, REITs, Commodities]
    
    C --> C1[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–ù–∏–∑–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏]
    C --> C2[–§–∞–∫—Ç–æ—Ä–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–†–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞]
    C --> C3[–°—Ç–∏–ª–µ–≤–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>Value, Growth, Momentum, Quality]
    C --> C4[–†–∞–∑–º–µ—Ä–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>Large, Mid, Small cap]
    
    D --> D1[Fama-French —Ñ–∞–∫—Ç–æ—Ä—ã<br/>Market, Size, Value]
    D --> D2[–ú–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã<br/>Interest rates, Inflation, GDP]
    D --> D3[–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã<br/>Momentum, Volatility, Liquidity]
    D --> D4[–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã<br/>P/E, P/B, ROE, Debt/Equity]
    
    B1 --> E[–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º<br/>max_weight_per_country ‚â§ 30%]
    B2 --> F[–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º<br/>max_weight_per_sector ‚â§ 25%]
    C1 --> G[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è<br/>max_correlation ‚â§ 0.7]
    C2 --> H[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è –∫ —Ñ–∞–∫—Ç–æ—Ä—É<br/>max_factor_exposure ‚â§ 0.5]
    
    E --> I[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤]
    F --> I
    G --> I
    H --> I
    
    I --> J[–î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    J --> K[–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤<br/>Lower portfolio volatility]
    J --> L[–£–ª—É—á—à–µ–Ω–∏–µ Sharpe ratio<br/>Better risk-adjusted returns]
    J --> M[–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à–æ–∫–∞–º<br/>Resilience to market shocks]
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style J fill:#4caf50
```

### 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:**

```python
def geographic_diversification(returns_by_country, max_weight_per_country=0.3):
    """–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"""
    n_countries = len(returns_by_country)
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
    constraints = []
    bounds = []
    
    for i in range(n_countries):
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –Ω–∞ —Å—Ç—Ä–∞–Ω—É
        constraints.append({
            'type': 'ineq',
            'fun': lambda w, i=i: max_weight_per_country - w[i]
        })
        bounds.append((0, max_weight_per_country))
    
    # –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1
    constraints.append({'type': 'eq', 'fun': lambda w: np.sum(w) - 1})
    
    # –û–∂–∏–¥–∞–µ–º—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
    expected_returns = np.array([returns.mean() for returns in returns_by_country.values()])
    
    # –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    cov_matrix = np.cov([returns for returns in returns_by_country.values()])
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    from scipy.optimize import minimize
    
    def objective(w):
        portfolio_return = np.dot(w, expected_returns)
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        return -portfolio_return + 0.5 * portfolio_variance
    
    x0 = np.ones(n_countries) / n_countries
    
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
country_weights = geographic_diversification(returns_by_country, max_weight_per_country=0.3)
```

**–°–µ–∫—Ç–æ—Ä–∞–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:**

```python
def sectoral_diversification(returns_by_sector, max_weight_per_sector=0.25):
    """–°–µ–∫—Ç–æ—Ä–∞–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"""
    n_sectors = len(returns_by_sector)
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º
    constraints = []
    bounds = []
    
    for i in range(n_sectors):
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –Ω–∞ —Å–µ–∫—Ç–æ—Ä
        constraints.append({
            'type': 'ineq',
            'fun': lambda w, i=i: max_weight_per_sector - w[i]
        })
        bounds.append((0, max_weight_per_sector))
    
    # –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1
    constraints.append({'type': 'eq', 'fun': lambda w: np.sum(w) - 1})
    
    # –û–∂–∏–¥–∞–µ–º—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º
    expected_returns = np.array([returns.mean() for returns in returns_by_sector.values()])
    
    # –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    cov_matrix = np.cov([returns for returns in returns_by_sector.values()])
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    from scipy.optimize import minimize
    
    def objective(w):
        portfolio_return = np.dot(w, expected_returns)
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        return -portfolio_return + 0.5 * portfolio_variance
    
    x0 = np.ones(n_sectors) / n_sectors
    
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
sector_weights = sectoral_diversification(returns_by_sector, max_weight_per_sector=0.25)
```

### 2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

**Factor-based Diversification:**

```python
def factor_diversification(returns, factors, max_factor_exposure=0.5):
    """–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤"""
    from sklearn.linear_model import LinearRegression
    
    n_assets = len(returns.columns)
    n_factors = len(factors.columns)
    
    # –†–µ–≥—Ä–µ—Å—Å–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –Ω–∞ —Ñ–∞–∫—Ç–æ—Ä—ã
    factor_loadings = np.zeros((n_assets, n_factors))
    
    for i, asset in enumerate(returns.columns):
        model = LinearRegression()
        model.fit(factors, returns[asset])
        factor_loadings[i] = model.coef_
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ñ–∞–∫—Ç–æ—Ä–∞–º
    constraints = []
    bounds = [(0, 1) for _ in range(n_assets)]
    
    for j in range(n_factors):
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è –∫ —Ñ–∞–∫—Ç–æ—Ä—É
        constraints.append({
            'type': 'ineq',
            'fun': lambda w, j=j: max_factor_exposure - np.dot(w, factor_loadings[:, j])
        })
        constraints.append({
            'type': 'ineq',
            'fun': lambda w, j=j: max_factor_exposure + np.dot(w, factor_loadings[:, j])
        })
    
    # –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1
    constraints.append({'type': 'eq', 'fun': lambda w: np.sum(w) - 1})
    
    # –û–∂–∏–¥–∞–µ–º—ã–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    expected_returns = returns.mean().values
    
    # –ö–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    cov_matrix = returns.cov().values
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    from scipy.optimize import minimize
    
    def objective(w):
        portfolio_return = np.dot(w, expected_returns)
        portfolio_variance = np.dot(w, np.dot(cov_matrix, w))
        return -portfolio_return + 0.5 * portfolio_variance
    
    x0 = np.ones(n_assets) / n_assets
    
    result = minimize(objective, x0, method='SLSQP', bounds=bounds, constraints=constraints)
    
    if result.success:
        return result.x
    else:
        raise ValueError("Optimization failed")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
factor_weights = factor_diversification(returns, factors, max_factor_exposure=0.5)
```

**Correlation-based Diversification:**

```python
def correlation_diversification(returns, max_correlation=0.7):
    """–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π"""
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    corr_matrix = returns.corr()
    
    # –ü–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–æ–≤ —Å –Ω–∏–∑–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
    selected_assets = []
    remaining_assets = list(returns.columns)
    
    # –í—ã–±–æ—Ä –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞
    first_asset = remaining_assets[0]
    selected_assets.append(first_asset)
    remaining_assets.remove(first_asset)
    
    # –í—ã–±–æ—Ä –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
    while remaining_assets:
        best_asset = None
        best_score = -1
        
        for asset in remaining_assets:
            # –°—Ä–µ–¥–Ω—è—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏
            avg_correlation = corr_matrix.loc[asset, selected_assets].mean()
            
            # –û—Ü–µ–Ω–∫–∞ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
            diversification_score = 1 - avg_correlation
            
            if diversification_score > best_score:
                best_score = diversification_score
                best_asset = asset
        
        if best_asset and best_score > (1 - max_correlation):
            selected_assets.append(best_asset)
            remaining_assets.remove(best_asset)
        else:
            break
    
    # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
    selected_returns = returns[selected_assets]
    expected_returns = selected_returns.mean().values
    cov_matrix = selected_returns.cov().values
    
    # –†–∞–≤–Ω—ã–µ –≤–µ—Å–∞
    weights = np.ones(len(selected_assets)) / len(selected_assets)
    
    return weights, selected_assets

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
weights, selected_assets = correlation_diversification(returns, max_correlation=0.7)
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### ‚ö†Ô∏è –ú–µ—Ç—Ä–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[–ú–µ—Ç—Ä–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏] --> B[Value at Risk - VaR]
    A --> C[Expected Shortfall - ES]
    A --> D[–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞]
    A --> E[–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏]
    
    B --> B1[Historical VaR<br/>Percentile-based approach]
    B --> B2[Parametric VaR<br/>Normal distribution assumption]
    B --> B3[Monte Carlo VaR<br/>Simulation-based approach]
    B --> B4[–£—Ä–æ–≤–Ω–∏ –¥–æ–≤–µ—Ä–∏—è<br/>90%, 95%, 99%]
    
    C --> C1[Conditional VaR<br/>Average loss beyond VaR]
    C --> C2[Tail Risk<br/>Extreme loss scenarios]
    C --> C3[Coherent Risk Measure<br/>Subadditivity property]
    C --> C4[Regulatory Capital<br/>Basel III requirements]
    
    D --> D1[Peak-to-Trough<br/>Maximum decline from peak]
    D --> D2[Duration of Drawdown<br/>Time to recovery]
    D --> D3[Drawdown Frequency<br/>Number of drawdown periods]
    D --> D4[Underwater Curve<br/>Cumulative drawdown path]
    
    E --> E1[Volatility<br/>Standard deviation of returns]
    E --> E2[Beta<br/>Market sensitivity]
    E --> E3[Tracking Error<br/>Deviation from benchmark]
    E --> E4[Information Ratio<br/>Excess return per unit of tracking error]
    E --> E5[Sortino Ratio<br/>Downside deviation adjustment]
    E --> E6[Calmar Ratio<br/>Return to max drawdown ratio]
    
    B1 --> F[–†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤]
    B2 --> F
    B3 --> F
    C1 --> F
    D1 --> F
    E1 --> F
    
    F --> G[–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    G --> H[VaR 95%: -2.5%<br/>ES 95%: -3.8%<br/>Max DD: -15.2%]
    
    H --> I[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏]
    I --> J[–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ<br/>Position sizing based on VaR]
    I --> K[–•–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏–µ<br/>Derivatives for risk reduction]
    I --> L[–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>Correlation-based allocation]
    I --> M[–°—Ç–æ–ø-–ª–æ—Å—Å—ã<br/>Automatic risk controls]
    
    style A fill:#e3f2fd
    style B fill:#ffcdd2
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#c8e6c9
    style I fill:#4caf50
```

### 1. Value at Risk (VaR)

**Historical VaR:**

```python
def historical_var(returns, confidence_level=0.95):
    """–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π VaR"""
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    sorted_returns = np.sort(returns)
    
    # –ò–Ω–¥–µ–∫—Å –¥–ª—è VaR
    var_index = int((1 - confidence_level) * len(sorted_returns))
    
    # VaR
    var = sorted_returns[var_index]
    
    return var

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
var_95 = historical_var(portfolio_returns, confidence_level=0.95)
```

**Parametric VaR:**

```python
def parametric_var(returns, confidence_level=0.95):
    """–ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π VaR"""
    from scipy import stats
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    mean_return = returns.mean()
    std_return = returns.std()
    
    # Z-score –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è
    z_score = stats.norm.ppf(1 - confidence_level)
    
    # VaR
    var = mean_return + z_score * std_return
    
    return var

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
var_95 = parametric_var(portfolio_returns, confidence_level=0.95)
```

**Monte Carlo VaR:**

```python
def monte_carlo_var(returns, confidence_level=0.95, n_simulations=10000):
    """Monte Carlo VaR"""
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    mean_return = returns.mean()
    std_return = returns.std()
    
    # –°–∏–º—É–ª—è—Ü–∏–∏
    simulations = np.random.normal(mean_return, std_return, n_simulations)
    
    # VaR
    var = np.percentile(simulations, (1 - confidence_level) * 100)
    
    return var

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
var_95 = monte_carlo_var(portfolio_returns, confidence_level=0.95, n_simulations=10000)
```

### 2. Expected Shortfall (ES)

```python
def expected_shortfall(returns, confidence_level=0.95):
    """Expected Shortfall (Conditional VaR)"""
    # VaR
    var = historical_var(returns, confidence_level)
    
    # –û–∂–∏–¥–∞–µ–º—ã–π —É–±—ã—Ç–æ–∫ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ VaR
    es = returns[returns <= var].mean()
    
    return es

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
es_95 = expected_shortfall(portfolio_returns, confidence_level=0.95)
```

### 3. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞

```python
def maximum_drawdown(returns):
    """–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞"""
    # –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    cumulative_returns = (1 + returns).cumprod()
    
    # –°–∫–æ–ª—å–∑—è—â–∏–π –º–∞–∫—Å–∏–º—É–º
    running_max = cumulative_returns.expanding().max()
    
    # –ü—Ä–æ—Å–∞–¥–∫–∞
    drawdown = (cumulative_returns - running_max) / running_max
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
    max_drawdown = drawdown.min()
    
    return max_drawdown

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
max_dd = maximum_drawdown(portfolio_returns)
```

## –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### üîÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ] --> B[–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞]
    A --> C[–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ]
    A --> D[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å]
    
    B --> B1[–í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞<br/>Fixed schedule: Daily, Weekly, Monthly]
    B --> B2[–ü–æ—Ä–æ–≥–æ–≤–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞<br/>When deviation > threshold]
    B --> B3[–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏<br/>Transaction costs consideration]
    B --> B4[–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞<br/>Balance between cost and benefit]
    
    C --> C1[Volatility-based Rebalancing<br/>Adjust based on market volatility]
    C --> C2[Momentum-based Rebalancing<br/>Follow market momentum]
    C --> C3[Regime-based Rebalancing<br/>Different strategies per market regime]
    C --> C4[ML-based Rebalancing<br/>Machine learning predictions]
    
    D --> D1[Real-time Monitoring<br/>Continuous portfolio tracking]
    D --> D2[Risk Alerts<br/>VaR, ES, Drawdown warnings]
    D --> D3[Performance Tracking<br/>Sharpe, Return, Volatility]
    D --> D4[Compliance Monitoring<br/>Regulatory constraints]
    
    B1 --> E[–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    B2 --> E
    C1 --> F[–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    C2 --> F
    C3 --> F
    C4 --> F
    D1 --> G[–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã]
    D2 --> G
    D3 --> G
    D4 --> G
    
    E --> H[–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    F --> H
    G --> H
    
    H --> I[–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤–µ—Å–∞<br/>w_t = f(market_conditions_t)]
    I --> J[–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏<br/>Performance vs Static portfolio]
    
    J --> K{–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏?}
    K -->|–î–∞| L[‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ]
    K -->|–ù–µ—Ç| M[‚ùå –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é]
    
    M --> N[–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω<br/>Why dynamic management failed?]
    N --> O[–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤<br/>Adjust thresholds, frequencies]
    O --> P[–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ<br/>Backtest updated strategy]
    P --> H
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style L fill:#4caf50
    style M fill:#ff9800
```

### 1. –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞:**

```python
def time_based_rebalancing(returns, target_weights, rebalance_freq='M'):
    """–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏"""
    # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
    if rebalance_freq == 'D':
        rebalance_dates = returns.index
    elif rebalance_freq == 'W':
        rebalance_dates = returns.index[::7]
    elif rebalance_freq == 'M':
        rebalance_dates = returns.index[::30]
    elif rebalance_freq == 'Q':
        rebalance_dates = returns.index[::90]
    else:
        raise ValueError(f"Unknown rebalance frequency: {rebalance_freq}")
    
    # –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
    rebalanced_returns = []
    current_weights = target_weights.copy()
    
    for i, date in enumerate(returns.index):
        if date in rebalance_dates:
            current_weights = target_weights.copy()
        
        # –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_return = np.dot(current_weights, returns.loc[date])
        rebalanced_returns.append(portfolio_return)
    
    return pd.Series(rebalanced_returns, index=returns.index)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
rebalanced_returns = time_based_rebalancing(returns, target_weights, rebalance_freq='M')
```

**–ü–æ—Ä–æ–≥–æ–≤–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞:**

```python
def threshold_rebalancing(returns, target_weights, threshold=0.05):
    """–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Ä–æ–≥—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è"""
    rebalanced_returns = []
    current_weights = target_weights.copy()
    
    for i, date in enumerate(returns.index):
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –≤–µ—Å–æ–≤
        weight_deviation = np.abs(current_weights - target_weights)
        max_deviation = weight_deviation.max()
        
        if max_deviation > threshold:
            current_weights = target_weights.copy()
        
        # –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_return = np.dot(current_weights, returns.loc[date])
        rebalanced_returns.append(portfolio_return)
    
    return pd.Series(rebalanced_returns, index=returns.index)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
rebalanced_returns = threshold_rebalancing(returns, target_weights, threshold=0.05)
```

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**Volatility-based Rebalancing:**

```python
def volatility_based_rebalancing(returns, target_weights, volatility_window=30, 
                                volatility_threshold=0.02):
    """–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏"""
    rebalanced_returns = []
    current_weights = target_weights.copy()
    
    for i, date in enumerate(returns.index):
        if i >= volatility_window:
            # –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
            recent_returns = returns.iloc[i-volatility_window:i]
            volatility = recent_returns.std().mean()
            
            # –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
            if volatility > volatility_threshold:
                current_weights = target_weights.copy()
        
        # –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_return = np.dot(current_weights, returns.loc[date])
        rebalanced_returns.append(portfolio_return)
    
    return pd.Series(rebalanced_returns, index=returns.index)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
rebalanced_returns = volatility_based_rebalancing(returns, target_weights, 
                                                 volatility_window=30, volatility_threshold=0.02)
```

**Momentum-based Rebalancing:**

```python
def momentum_based_rebalancing(returns, target_weights, momentum_window=20, 
                              momentum_threshold=0.1):
    """–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–º–µ–Ω—Ç—É–º–∞"""
    rebalanced_returns = []
    current_weights = target_weights.copy()
    
    for i, date in enumerate(returns.index):
        if i >= momentum_window:
            # –†–∞—Å—á–µ—Ç –º–æ–º–µ–Ω—Ç—É–º–∞
            recent_returns = returns.iloc[i-momentum_window:i]
            momentum = recent_returns.mean().mean()
            
            # –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–æ–º–µ–Ω—Ç—É–º–∞
            if abs(momentum) > momentum_threshold:
                current_weights = target_weights.copy()
        
        # –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
        portfolio_return = np.dot(current_weights, returns.loc[date])
        rebalanced_returns.append(portfolio_return)
    
    return pd.Series(rebalanced_returns, index=returns.index)

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
rebalanced_returns = momentum_based_rebalancing(returns, target_weights, 
                                               momentum_window=20, momentum_threshold=0.1)
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```mermaid
graph TD
    A[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ] --> B[–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    A --> C[–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤]
    A --> D[–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è]
    A --> E[–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å]
    
    B --> B1[–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Total Return, Annual Return]
    B --> B2[–†–∏—Å–∫-—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Sharpe Ratio, Sortino Ratio]
    B --> B3[–ü—Ä–æ—Å–∞–¥–∫–∏<br/>Max Drawdown, Drawdown Duration]
    B --> B4[–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å<br/>Volatility, Coefficient of Variation]
    B --> B5[–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å<br/>Calmar Ratio, Information Ratio]
    
    C --> C1[Value at Risk<br/>VaR 90%, 95%, 99%]
    C --> C2[Expected Shortfall<br/>Conditional VaR]
    C --> C3[–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑<br/>Asset correlations, Factor exposures]
    C --> C4[–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ<br/>Scenario analysis, Monte Carlo]
    C --> C5[–†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ —Ä–∏—Å–∫–∏<br/>Basel III, Solvency II]
    
    D --> D1[–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å<br/>Cumulative return chart]
    D --> D2[–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π<br/>Return distribution histogram]
    D --> D3[–ü—Ä–æ—Å–∞–¥–∫–∏<br/>Drawdown chart]
    D --> D4[–°–∫–æ–ª—å–∑—è—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏<br/>Rolling Sharpe, Volatility]
    D --> D5[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–æ–º<br/>Portfolio vs Benchmark]
    D --> D6[–ê–Ω–∞–ª–∏–∑ –≤–∫–ª–∞–¥–∞ –∞–∫—Ç–∏–≤–æ–≤<br/>Asset contribution analysis]
    
    E --> E1[–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã<br/>Daily performance summary]
    E --> E2[–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã<br/>Weekly risk and return analysis]
    E --> E3[–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –æ—Ç—á–µ—Ç—ã<br/>Monthly portfolio review]
    E --> E4[–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã<br/>Quarterly attribution analysis]
    E --> E5[–ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è<br/>Risk alerts, Performance alerts]
    
    B1 --> F[–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫]
    B2 --> F
    B3 --> F
    B4 --> F
    B5 --> F
    C1 --> F
    C2 --> F
    C3 --> F
    C4 --> F
    C5 --> F
    
    F --> G[–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    G --> H[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ü–µ–ª—è–º–∏<br/>Performance vs Target]
    G --> I[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–æ–º<br/>Performance vs Benchmark]
    G --> J[–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤<br/>Performance trends over time]
    
    H --> K[–û—Ü–µ–Ω–∫–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ]
    I --> K
    J --> K
    
    K --> L{–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω?}
    L -->|–î–∞| M[‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é]
    L -->|–ù–µ—Ç| N[‚ùå –¢—Ä–µ–±—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏]
    
    N --> O[–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º<br/>Identify underperformance causes]
    O --> P[–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏<br/>Adjust allocation, rebalance]
    P --> Q[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π<br/>Track improvement]
    Q --> K
    
    style A fill:#e3f2fd
    style B fill:#c8e6c9
    style C fill:#ffcdd2
    style D fill:#fff3e0
    style E fill:#f3e5f5
    style M fill:#4caf50
    style N fill:#ff9800
```

### 1. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
def calculate_portfolio_metrics(returns, risk_free_rate=0.02):
    """–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"""
    # –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    total_return = (1 + returns).prod() - 1
    annual_return = (1 + returns).mean() ** 252 - 1
    volatility = returns.std() * np.sqrt(252)
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
    sharpe = (annual_return - risk_free_rate) / volatility
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
    max_drawdown = maximum_drawdown(returns)
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –°–æ—Ä—Ç–∏–Ω–æ
    downside_returns = returns[returns < 0]
    downside_volatility = downside_returns.std() * np.sqrt(252)
    sortino = (annual_return - risk_free_rate) / downside_volatility if downside_volatility > 0 else 0
    
    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ö–∞–ª—å–º–∞—Ä–∞
    calmar = annual_return / abs(max_drawdown) if max_drawdown != 0 else 0
    
    return {
        'total_return': total_return,
        'annual_return': annual_return,
        'volatility': volatility,
        'sharpe': sharpe,
        'max_drawdown': max_drawdown,
        'sortino': sortino,
        'calmar': calmar
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
metrics = calculate_portfolio_metrics(portfolio_returns, risk_free_rate=0.02)
```

### 2. –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤

```python
def analyze_portfolio_risks(returns, confidence_levels=[0.90, 0.95, 0.99]):
    """–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"""
    risks = {}
    
    for level in confidence_levels:
        # VaR
        var = historical_var(returns, level)
        
        # ES
        es = expected_shortfall(returns, level)
        
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
        max_dd = maximum_drawdown(returns)
        
        risks[level] = {
            'var': var,
            'es': es,
            'max_drawdown': max_dd
        }
    
    return risks

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
risks = analyze_portfolio_risks(portfolio_returns, confidence_levels=[0.90, 0.95, 0.99])
```

### 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

```python
def visualize_portfolio_performance(returns, benchmark_returns=None, save_path=None):
    """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ"""
    import matplotlib.pyplot as plt
    import seaborn as sns
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è
    plt.style.use('seaborn-v0_8')
    sns.set_palette("husl")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä—ã
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))
    
    # 1. –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    cumulative_returns = (1 + returns).cumprod()
    axes[0, 0].plot(cumulative_returns.index, cumulative_returns.values, label='–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ')
    
    if benchmark_returns is not None:
        benchmark_cumulative = (1 + benchmark_returns).cumprod()
        axes[0, 0].plot(benchmark_cumulative.index, benchmark_cumulative.values, 
                       label='–ë–µ–Ω—á–º–∞—Ä–∫', linestyle='--')
    
    axes[0, 0].set_title('–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[0, 0].set_xlabel('–î–∞—Ç–∞')
    axes[0, 0].set_ylabel('–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[0, 0].legend()
    axes[0, 0].grid(True)
    
    # 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π
    axes[0, 1].hist(returns, bins=50, alpha=0.7, edgecolor='black')
    axes[0, 1].axvline(returns.mean(), color='red', linestyle='--', 
                      label=f'–°—Ä–µ–¥–Ω–µ–µ: {returns.mean():.4f}')
    axes[0, 1].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π')
    axes[0, 1].set_xlabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å')
    axes[0, 1].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
    axes[0, 1].legend()
    axes[0, 1].grid(True)
    
    # 3. –ü—Ä–æ—Å–∞–¥–∫–∞
    cumulative_returns = (1 + returns).cumprod()
    running_max = cumulative_returns.expanding().max()
    drawdown = (cumulative_returns - running_max) / running_max
    
    axes[1, 0].fill_between(drawdown.index, drawdown.values, 0, alpha=0.3, color='red')
    axes[1, 0].plot(drawdown.index, drawdown.values, color='red')
    axes[1, 0].set_title('–ü—Ä–æ—Å–∞–¥–∫–∞')
    axes[1, 0].set_xlabel('–î–∞—Ç–∞')
    axes[1, 0].set_ylabel('–ü—Ä–æ—Å–∞–¥–∫–∞')
    axes[1, 0].grid(True)
    
    # 4. –°–∫–æ–ª—å–∑—è—â–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞
    rolling_sharpe = returns.rolling(252).mean() / returns.rolling(252).std() * np.sqrt(252)
    axes[1, 1].plot(rolling_sharpe.index, rolling_sharpe.values)
    axes[1, 1].axhline(y=1.0, color='red', linestyle='--', label='Sharpe = 1.0')
    axes[1, 1].set_title('–°–∫–æ–ª—å–∑—è—â–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞')
    axes[1, 1].set_xlabel('–î–∞—Ç–∞')
    axes[1, 1].set_ylabel('–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞')
    axes[1, 1].legend()
    axes[1, 1].grid(True)
    
    plt.tight_layout()
    
    if save_path:
        plt.savefig(save_path, dpi=300, bbox_inches='tight')
    
    plt.show()

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
visualize_portfolio_performance(portfolio_returns, benchmark_returns, 
                              save_path='portfolio_performance.png')
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç:

1. **–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ** - —Å–Ω–∏–∑–∏—Ç—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–∏—Å–∫–∏
2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å** - –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∏—Å–∫–∞
3. **–£–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∏—Å–∫–∞–º–∏** - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
4. **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

1. **–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** - –Ω–µ –∫–ª–∞–¥–∏—Ç–µ –≤—Å–µ —è–π—Ü–∞ –≤ –æ–¥–Ω—É –∫–æ—Ä–∑–∏–Ω—É
2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏** - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ VaR –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ—Å–∞–¥–∫—É
3. **–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –≤–µ—Å–∞
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
5. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –ø—Ä–∏—Å–ø–æ—Å–∞–±–ª–∏–≤–∞–π—Ç–µ—Å—å –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –≤—ã –≥–æ—Ç–æ–≤—ã –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç:
- [Feature Generation](./26_feature_generation_advanced.md)
- [–ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥](./27_backtesting_methods.md)
- [Walk-forward –∞–Ω–∞–ª–∏–∑](./28_walk_forward_analysis.md)
- [Monte Carlo —Å–∏–º—É–ª—è—Ü–∏–∏](./29_monte_carlo_simulations.md)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ (—Ç–µ–∫—É—â–∞—è –≥–ª–∞–≤–∞)
