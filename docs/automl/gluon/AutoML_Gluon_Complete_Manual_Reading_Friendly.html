<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</title>
    <style>
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            font-size: 18px;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 95%;
            min-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
        }
        
        .sidebar {
            width: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            max-height: 100vh;
            position: sticky;
            top: 0;
        }
        
        .main-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.9;
        }
        
        .navigation {
            margin-bottom: 30px;
        }
        
        .navigation h3 {
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #fff;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        
        .nav-section {
            margin-bottom: 20px;
        }
        
        .nav-section h4 {
            font-size: 1em;
            margin-bottom: 10px;
            color: #fff;
            opacity: 0.9;
        }
        
        .nav-links {
            list-style: none;
        }
        
        .nav-links li {
            margin-bottom: 8px;
        }
        
        .nav-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 5px;
            display: block;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }
        
        .nav-links a:hover {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateX(5px);
        }
        
        .nav-links a.active {
            background: rgba(255,255,255,0.3);
            color: white;
            font-weight: bold;
        }
        
        .content {
            font-size: 18px;
            line-height: 1.8;
            color: #2c3e50;
        }
        
        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: #2c3e50;
            margin: 30px 0 20px 0;
            font-weight: bold;
        }
        
        .content h1 {
            font-size: 2.2em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .content h2 {
            font-size: 1.8em;
            border-bottom: 2px solid #764ba2;
            padding-bottom: 8px;
        }
        
        .content h3 {
            font-size: 1.5em;
            color: #667eea;
        }
        
        .content h4 {
            font-size: 1.3em;
            color: #764ba2;
        }
        
        .content p {
            margin: 15px 0;
            text-align: justify;
        }
        
        .content ul, .content ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        
        .content li {
            margin: 8px 0;
        }
        
        .content blockquote {
            border-left: 4px solid #667eea;
            margin: 20px 0;
            padding: 15px 20px;
            background: #f8f9fa;
            border-radius: 0 5px 5px 0;
        }
        
        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .content th, .content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .content th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
        }
        
        .content tr:hover {
            background: #f8f9fa;
        }
        
        .content code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            border: 1px solid #34495e;
        }
        
        .content pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #34495e;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .content pre code {
            background: none;
            padding: 0;
            border: none;
            color: #ecf0f1;
        }
        
        .content code a, .content pre a {
            color: #f39c12;
            text-decoration: none;
        }
        
        .content code a:hover, .content pre a:hover {
            text-decoration: underline;
        }
        
        .content .keyword {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .content .string {
            color: #27ae60;
        }
        
        .content .number {
            color: #f39c12;
        }
        
        .content .boolean {
            color: #9b59b6;
        }
        
        .content .comment {
            color: #7f8c8d;
            font-style: italic;
        }
        
        .content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .content a {
            color: #667eea;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.3s ease;
        }
        
        .content a:hover {
            color: #764ba2;
            border-bottom-color: #764ba2;
        }
        
        .toc {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .toc h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            display: block;
            transition: all 0.3s ease;
        }
        
        .toc a:hover {
            background: #e9ecef;
            color: #764ba2;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 18px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-to-top:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            z-index: 1001;
            transition: width 0.3s ease;
        }
        
        @media (max-width: 1024px) {
            .container {
                max-width: 98%;
                min-width: 800px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                max-width: 100%;
                min-width: 320px;
            }
            
            .sidebar {
                width: 100%;
                max-height: 300px;
                position: relative;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .content {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>
    
    <div class="container">
        <div class="sidebar">
            <div class="navigation">
                <h3>üìö –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —É—á–µ–±–Ω–∏–∫—É</h3>
                
                <div class="nav-section">
                    <h4>üî∞ –û—Å–Ω–æ–≤—ã</h4>
                    <ul class="nav-links">
                        <li><a href="#automl-gluon---–ø–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</a></li>
                        <li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-automl-gluon">2. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</a></li>
                        <li><a href="#–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-automl-gluon">3. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</a></li>
                        <li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-automl-gluon">4. –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
                        <li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤-automl-gluon">5. –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω</h4>
                    <ul class="nav-links">
                        <li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π-–≤-automl-gluon">6. –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</a></li>
                        <li><a href="#–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏-–¥–µ–ø–ª–æ–π-automl-gluon-–º–æ–¥–µ–ª–µ–π">7. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</a></li>
                        <li><a href="#–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π-automl-gluon">8. –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</a></li>
                        <li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-automl-gluon">9. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
                        <li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-automl-gluon">10. Troubleshooting</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üçé –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</h4>
                    <ul class="nav-links">
                        <li><a href="#troubleshooting-automl-gluon">11. Apple Silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</a></li>
                        <li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-automl-gluon-–¥–ª—è-apple-silicon-m1m2m3">12. –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
                        <li><a href="#–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–æ—Ç-–∏–¥–µ–∏-–¥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–µ–ø–ª–æ—è">13. –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üß† –¢–µ–æ—Ä–∏—è</h4>
                    <ul class="nav-links">
                        <li><a href="#—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-ml-—Å–∏—Å—Ç–µ–º–∞-–¥–ª—è-dex">14. –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</a></li>
                        <li><a href="#—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl">15. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</a></li>
                        <li><a href="#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å-–º–æ–¥–µ–ª–µ–π">16. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</a></li>
                        <li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-automl">17. –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üìä –ö–µ–π—Å-—Å—Ç–∞–¥–∏</h4>
                    <ul class="nav-links">
                        <li><a href="#—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai">18. –ö–µ–π—Å-—Å—Ç–∞–¥–∏</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üìà –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</h4>
                    <ul class="nav-links">
                        <li><a href="#–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–µ–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–µ–∫—Ç—ã-—Å-automl-gluon">19. WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</a></li>
                        <li><a href="#wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å">20. SCHR Levels</a></li>
                        <li><a href="#schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å">21. SCHR SHORT3</a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h4>üåü –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ</h4>
                    <ul class="nav-links">
                        <li><a href="#schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å">22. –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</a></li>
                        <li><a href="#—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-–≤—Å–µ—Ö-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤">23. –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é</a></li>
                        <li><a href="#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã-–∫–æ—Ç–æ—Ä–∞—è-–¥–∞–µ—Ç-100-–ø—Ä–∏–±—ã–ª–∏-–≤-–º–µ—Å—è—Ü-–∏-–ø—Ä–∏-—ç—Ç–æ–º-–∏–º–µ–µ—Ç-95-—Ç–æ—á–Ω–æ—Å—Ç—å-–∏—Å–ø–æ–ª—å–∑—É—è-–≤—Å–µ-—Å–∞–º—ã–µ-–ª—É—á—à–∏–µ-—Ç–µ—Ö–Ω–∏–∫–∏-–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã-schr-levels-wave2-short3">27. üöÄ –°—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h1>AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
                <div class="subtitle">
                    <strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br>
                    <strong>–î–∞—Ç–∞:</strong> 2025<br>
                    <strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br>
                    <strong>–í–µ—Ä—Å–∏—è:</strong> 1.0
                </div>
            </div>
            
            <div class="content">
                <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>AutoML_Gluon_Complete_Manual</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 90%;
      min-width: 800px;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 768px) {
      body {
        font-size: 0.9em;
        padding: 12px;
        max-width: 95%;
        min-width: 320px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#automl-gluon---–ø–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
id="toc-automl-gluon---–ø–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"><span
class="toc-section-number">1</span> AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</a>
<ul>
<li><a href="#—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" id="toc-—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ"><span
class="toc-section-number">1.1</span> –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</a></li>
<li><a href="#—á—Ç–æ-—Ç–∞–∫–æ–µ-automl-gluon"
id="toc-—á—Ç–æ-—Ç–∞–∫–æ–µ-automl-gluon"><span
class="toc-section-number">1.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ AutoML Gluon?</a></li>
<li><a href="#–∫–ª—é—á–µ–≤—ã–µ-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏" id="toc-–∫–ª—é—á–µ–≤—ã–µ-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">1.3</span> –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</a></li>
<li><a href="#–¥–ª—è-–∫–æ–≥–æ-—ç—Ç–æ—Ç-–º–∞–Ω—É–∞–ª" id="toc-–¥–ª—è-–∫–æ–≥–æ-—ç—Ç–æ—Ç-–º–∞–Ω—É–∞–ª"><span
class="toc-section-number">1.4</span> –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –º–∞–Ω—É–∞–ª?</a></li>
<li><a href="#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"
id="toc-–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">1.5</span> –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ
—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="#—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-—Ä–∞–∑–¥–µ–ª—ã" id="toc-—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-—Ä–∞–∑–¥–µ–ª—ã"><span
class="toc-section-number">1.6</span> –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã</a>
<ul>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="toc-section-number">1.6.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple
Silicon</a></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" id="toc-–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">1.6.2</span> –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
<li><a href="#—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã-—Ä–∞–∑–¥–µ–ª-14"
id="toc-—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã-—Ä–∞–∑–¥–µ–ª-14"><span
class="toc-section-number">1.6.3</span> –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã (–†–∞–∑–¥–µ–ª
14):</a></li>
<li><a href="#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-—Ä–∞–∑–¥–µ–ª-15"
id="toc-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-—Ä–∞–∑–¥–µ–ª-15"><span
class="toc-section-number">1.6.4</span> –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–†–∞–∑–¥–µ–ª
15):</a></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-—Ä–∞–∑–¥–µ–ª-16"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-—Ä–∞–∑–¥–µ–ª-16"><span
class="toc-section-number">1.6.5</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã (–†–∞–∑–¥–µ–ª
16):</a></li>
<li><a href="#—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai-—Ä–∞–∑–¥–µ–ª-17"
id="toc-—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai-—Ä–∞–∑–¥–µ–ª-17"><span
class="toc-section-number">1.6.6</span> –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI (–†–∞–∑–¥–µ–ª
17):</a></li>
<li><a href="#–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–∞–∑–¥–µ–ª-18" id="toc-–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–∞–∑–¥–µ–ª-18"><span
class="toc-section-number">1.6.7</span> –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–†–∞–∑–¥–µ–ª 18):</a></li>
</ul></li>
</ul></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-automl-gluon"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-automl-gluon"><span
class="toc-section-number">2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è" id="toc-—Å–∏—Å—Ç–µ–º–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">2.1</span> –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"
id="toc-–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">2.1.1</span> –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="#—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"
id="toc-—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">2.1.2</span> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ
—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-pip" id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-pip"><span
class="toc-section-number">2.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞" id="toc-–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞"><span
class="toc-section-number">2.2.1</span> –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"><span
class="toc-section-number">2.2.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</a></li>
</ul></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-conda"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-conda"><span
class="toc-section-number">2.3</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ conda</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-–Ω–æ–≤–æ–≥–æ-–æ–∫—Ä—É–∂–µ–Ω–∏—è"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-–Ω–æ–≤–æ–≥–æ-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="toc-section-number">2.3.1</span> –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
–æ–∫—Ä—É–∂–µ–Ω–∏—è</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-gpu-–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-gpu-–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π"><span
class="toc-section-number">2.3.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å GPU
–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</a></li>
</ul></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏–∑-–∏—Å—Ö–æ–¥–Ω–æ–≥–æ-–∫–æ–¥–∞"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏–∑-–∏—Å—Ö–æ–¥–Ω–æ–≥–æ-–∫–æ–¥–∞"><span
class="toc-section-number">2.4</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞</a>
<ul>
<li><a href="#–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
id="toc-–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"><span
class="toc-section-number">2.4.1</span> –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–≤-—Ä–µ–∂–∏–º–µ-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–≤-—Ä–µ–∂–∏–º–µ-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"><span
class="toc-section-number">2.4.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ
—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–≤–µ—Ä–∫–∞-—É—Å—Ç–∞–Ω–æ–≤–∫–∏" id="toc-–ø—Ä–æ–≤–µ—Ä–∫–∞-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="toc-section-number">2.5</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–π-—Ç–µ—Å—Ç" id="toc-–±–∞–∑–æ–≤—ã–π-—Ç–µ—Å—Ç"><span
class="toc-section-number">2.5.1</span> –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç</a></li>
<li><a href="#—Ç–µ—Å—Ç-—Å-–ø—Ä–æ—Å—Ç—ã–º-–ø—Ä–∏–º–µ—Ä–æ–º"
id="toc-—Ç–µ—Å—Ç-—Å-–ø—Ä–æ—Å—Ç—ã–º-–ø—Ä–∏–º–µ—Ä–æ–º"><span
class="toc-section-number">2.5.2</span> –¢–µ—Å—Ç —Å –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∏–º–µ—Ä–æ–º</a></li>
</ul></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"><span
class="toc-section-number">2.6</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</a>
<ul>
<li><a href="#–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-gpu" id="toc-–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-gpu"><span
class="toc-section-number">2.6.1</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU</a></li>
<li><a href="#–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏"
id="toc-–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏"><span
class="toc-section-number">2.6.2</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏
–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏</a></li>
<li><a href="#–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏-—Ä—è–¥–∞–º–∏"
id="toc-–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏-—Ä—è–¥–∞–º–∏"><span
class="toc-section-number">2.6.3</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏
—Ä—è–¥–∞–º–∏</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="toc-section-number">2.7</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è</a>
<ul>
<li><a href="#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è" id="toc-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="toc-section-number">2.7.1</span> –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</a></li>
<li><a href="#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π-—Ñ–∞–π–ª"
id="toc-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π-—Ñ–∞–π–ª"><span
class="toc-section-number">2.7.2</span> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª</a></li>
</ul></li>
<li><a href="#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º-–ø—Ä–∏-—É—Å—Ç–∞–Ω–æ–≤–∫–µ"
id="toc-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º-–ø—Ä–∏-—É—Å—Ç–∞–Ω–æ–≤–∫–µ"><span
class="toc-section-number">2.8</span> –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏
—É—Å—Ç–∞–Ω–æ–≤–∫–µ</a>
<ul>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"
id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"><span
class="toc-section-number">2.8.1</span> –ü—Ä–æ–±–ª–µ–º—ã —Å
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</a></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—Å-cuda" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—Å-cuda"><span
class="toc-section-number">2.8.2</span> –ü—Ä–æ–±–ª–µ–º—ã —Å CUDA</a></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é"><span
class="toc-section-number">2.8.3</span> –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"
id="toc-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">2.9</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-—Ç–µ—Å—Ç-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"
id="toc-–ø–æ–ª–Ω—ã–π-—Ç–µ—Å—Ç-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="toc-section-number">2.9.1</span> –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏"><span
class="toc-section-number">2.10</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
<li><a href="#–ø–æ–ª–µ–∑–Ω—ã–µ-—Å—Å—ã–ª–∫–∏" id="toc-–ø–æ–ª–µ–∑–Ω—ã–µ-—Å—Å—ã–ª–∫–∏"><span
class="toc-section-number">2.11</span> –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</a></li>
</ul></li>
<li><a href="#–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-automl-gluon"
id="toc-–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-automl-gluon"><span
class="toc-section-number">3</span> –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AutoML
Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-tabularpredictor"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-tabularpredictor"><span
class="toc-section-number">3.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ TabularPredictor</a>
<ul>
<li><a href="#–∏–º–ø–æ—Ä—Ç-–∏-—Å–æ–∑–¥–∞–Ω–∏–µ-–±–∞–∑–æ–≤–æ–≥–æ-–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞"
id="toc-–∏–º–ø–æ—Ä—Ç-–∏-—Å–æ–∑–¥–∞–Ω–∏–µ-–±–∞–∑–æ–≤–æ–≥–æ-–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞"><span
class="toc-section-number">3.1.1</span> –ò–º–ø–æ—Ä—Ç –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ
–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</a></li>
</ul></li>
<li><a href="#—Ç–∏–ø—ã-–∑–∞–¥–∞—á" id="toc-—Ç–∏–ø—ã-–∑–∞–¥–∞—á"><span
class="toc-section-number">3.2</span> –¢–∏–ø—ã –∑–∞–¥–∞—á</a>
<ul>
<li><a href="#–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è" id="toc-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"><span
class="toc-section-number">3.2.1</span> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</a></li>
<li><a href="#—Ä–µ–≥—Ä–µ—Å—Å–∏—è" id="toc-—Ä–µ–≥—Ä–µ—Å—Å–∏—è"><span
class="toc-section-number">3.2.2</span> –†–µ–≥—Ä–µ—Å—Å–∏—è</a></li>
</ul></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏" id="toc-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">3.3</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤–æ–µ-–æ–±—É—á–µ–Ω–∏–µ" id="toc-–±–∞–∑–æ–≤–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">3.3.1</span> –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-—Å-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º-–≤—Ä–µ–º–µ–Ω–∏"
id="toc-–æ–±—É—á–µ–Ω–∏–µ-—Å-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º-–≤—Ä–µ–º–µ–Ω–∏"><span
class="toc-section-number">3.3.2</span> –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
–≤—Ä–µ–º–µ–Ω–∏</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-—Å-–ø—Ä–µ—Å–µ—Ç–∞–º–∏" id="toc-–æ–±—É—á–µ–Ω–∏–µ-—Å-–ø—Ä–µ—Å–µ—Ç–∞–º–∏"><span
class="toc-section-number">3.3.3</span> –û–±—É—á–µ–Ω–∏–µ —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏</a></li>
</ul></li>
<li><a href="#–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–º–æ–¥–µ–ª–∏"
id="toc-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">3.4</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏" id="toc-–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="toc-section-number">3.4.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">3.4.2</span> –í–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è" id="toc-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="toc-section-number">3.5</span> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è" id="toc-–±–∞–∑–æ–≤—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="toc-section-number">3.5.1</span> –ë–∞–∑–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</a></li>
<li><a href="#–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"
id="toc-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"><span
class="toc-section-number">3.5.2</span> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</a></li>
</ul></li>
<li><a href="#—Ä–∞–±–æ—Ç–∞-—Å-–ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏" id="toc-—Ä–∞–±–æ—Ç–∞-—Å-–ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏"><span
class="toc-section-number">3.6</span> –†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</a>
<ul>
<li><a href="#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"
id="toc-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="toc-section-number">3.6.1</span> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</a></li>
<li><a href="#—Ä—É—á–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"
id="toc-—Ä—É—á–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="toc-section-number">3.6.2</span> –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</a></li>
</ul></li>
<li><a href="#—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–∏-–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–µ–π"
id="toc-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–∏-–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">3.7</span> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π</a>
<ul>
<li><a href="#—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏" id="toc-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">3.7.1</span> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–∏" id="toc-–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">3.7.2</span> –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</a></li>
</ul></li>
<li><a href="#—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏" id="toc-—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏"><span
class="toc-section-number">3.8</span> –†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª—è" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª—è"><span
class="toc-section-number">3.8.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è</a></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è" id="toc-–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è"><span
class="toc-section-number">3.8.2</span> –ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"><span
class="toc-section-number">3.9</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="toc-section-number">3.9.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a></li>
<li><a href="#–∏—Å–∫–ª—é—á–µ–Ω–∏–µ-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤"
id="toc-–∏—Å–∫–ª—é—á–µ–Ω–∏–µ-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤"><span
class="toc-section-number">3.9.2</span> –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</a></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">3.9.3</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#—Ä–∞–±–æ—Ç–∞-—Å-—Ä–∞–∑–ª–∏—á–Ω—ã–º–∏-—Ç–∏–ø–∞–º–∏-–¥–∞–Ω–Ω—ã—Ö"
id="toc-—Ä–∞–±–æ—Ç–∞-—Å-—Ä–∞–∑–ª–∏—á–Ω—ã–º–∏-—Ç–∏–ø–∞–º–∏-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">3.10</span> –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
–¥–∞–Ω–Ω—ã—Ö</a>
<ul>
<li><a href="#–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ"
id="toc-–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="toc-section-number">3.10.1</span> –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ç–µ–∫—Å—Ç–æ–≤—ã–µ-–¥–∞–Ω–Ω—ã–µ" id="toc-—Ç–µ–∫—Å—Ç–æ–≤—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="toc-section-number">3.10.2</span> –¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#–≤—Ä–µ–º–µ–Ω–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ" id="toc-–≤—Ä–µ–º–µ–Ω–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="toc-section-number">3.10.3</span> –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è" id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">3.11</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ" id="toc-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">3.11.1</span> –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
<li><a href="#callback-—Ñ—É–Ω–∫—Ü–∏–∏" id="toc-callback-—Ñ—É–Ω–∫—Ü–∏–∏"><span
class="toc-section-number">3.11.2</span> Callback —Ñ—É–Ω–∫—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">3.12</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"><span
class="toc-section-number">3.12.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</a></li>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"><span
class="toc-section-number">3.12.2</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
—Ä–µ–≥—Ä–µ—Å—Å–∏–∏</a></li>
</ul></li>
<li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏" id="toc-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="toc-section-number">3.13</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</a>
<ul>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">3.13.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫" id="toc-–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫"><span
class="toc-section-number">3.13.2</span> –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">3.13.3</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
–æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-1" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-1"><span
class="toc-section-number">3.14</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-automl-gluon"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-automl-gluon"><span
class="toc-section-number">4</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoML
Gluon</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-1"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-1"><span
class="toc-section-number">4.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-–∫–∞—Å—Ç–æ–º–Ω—ã—Ö-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-–∫–∞—Å—Ç–æ–º–Ω—ã—Ö-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="toc-section-number">4.1.1</span> –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="toc-section-number">4.1.2</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π"><span
class="toc-section-number">4.2</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</a>
<ul>
<li><a href="#–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏"
id="toc-–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏"><span
class="toc-section-number">4.2.1</span> –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</a></li>
<li><a href="#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏" id="toc-–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏"><span
class="toc-section-number">4.2.2</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤"><span
class="toc-section-number">4.3</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</a>
<ul>
<li><a href="#cpu-–∏-gpu-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏" id="toc-cpu-–∏-gpu-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"><span
class="toc-section-number">4.3.1</span> CPU –∏ GPU –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
<li><a href="#–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">4.3.2</span> –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Ä–∞–±–æ—Ç–∞-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞–Ω–Ω—ã–º–∏"
id="toc-—Ä–∞–±–æ—Ç–∞-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞–Ω–Ω—ã–º–∏"><span
class="toc-section-number">4.4</span> –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</a>
<ul>
<li><a href="#–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">4.4.1</span> –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ
–æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"
id="toc-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">4.4.2</span> –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏-1"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏-1"><span
class="toc-section-number">4.5</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–∫–∞—Å—Ç–æ–º–Ω—ã–µ-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">4.5.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
<li><a href="#—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">4.5.2</span> –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="toc-section-number">4.6</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</a>
<ul>
<li><a href="#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"
id="toc-–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="toc-section-number">4.6.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</a></li>
<li><a href="#–æ–±—Ä–∞–±–æ—Ç–∫–∞-—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–æ–±—Ä–∞–±–æ—Ç–∫–∞-—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">4.6.2</span> –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫"><span
class="toc-section-number">4.7</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫</a>
<ul>
<li><a href="#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏" id="toc-–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="toc-section-number">4.7.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"
id="toc-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="toc-section-number">4.7.2</span> –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">4.8</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#–¥–µ—Ç–∞–ª—å–Ω–æ–µ-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"
id="toc-–¥–µ—Ç–∞–ª—å–Ω–æ–µ-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">4.8.1</span> –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è-1"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è-1"><span
class="toc-section-number">4.8.2</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">4.9</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a>
<ul>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–¥–µ–ø–ª–æ—è"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–¥–µ–ø–ª–æ—è"><span
class="toc-section-number">4.9.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</a></li>
<li><a href="#—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏" id="toc-—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">4.9.2</span> –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"><span
class="toc-section-number">4.10</span> –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–ø–æ–ª–Ω–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-–ø–æ–ª–Ω–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">4.10.1</span> –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-2" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-2"><span
class="toc-section-number">4.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤-automl-gluon"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤-automl-gluon"><span
class="toc-section-number">5</span> –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ AutoML
Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–º–µ—Ç—Ä–∏–∫–∏" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–º–µ—Ç—Ä–∏–∫–∏"><span
class="toc-section-number">5.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"><span
class="toc-section-number">5.2</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1" id="toc-–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="toc-section-number">5.2.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏" id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="toc-section-number">5.2.2</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">5.2.3</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"><span
class="toc-section-number">5.3</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2" id="toc-–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2"><span
class="toc-section-number">5.3.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="toc-section-number">5.3.2</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
</ul></li>
<li><a href="#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-autogluon"
id="toc-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-autogluon"><span
class="toc-section-number">5.4</span> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤
AutoGluon</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫-–¥–ª—è-–æ–±—É—á–µ–Ω–∏—è"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫-–¥–ª—è-–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">5.4.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è
–æ–±—É—á–µ–Ω–∏—è</a></li>
<li><a href="#–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"
id="toc-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="toc-section-number">5.4.2</span> –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1" id="toc-–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="toc-section-number">5.4.3</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
</ul></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–∞–Ω–∞–ª–∏–∑-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">5.5</span> –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a>
<ul>
<li><a href="#–ª–∏–¥–µ—Ä–±–æ—Ä–¥-–º–æ–¥–µ–ª–µ–π" id="toc-–ª–∏–¥–µ—Ä–±–æ—Ä–¥-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">5.5.1</span> –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</a></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–≤–∞–∂–Ω–æ—Å—Ç–∏-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"
id="toc-–∞–Ω–∞–ª–∏–∑-–≤–∞–∂–Ω–æ—Å—Ç–∏-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="toc-section-number">5.5.2</span> –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</a></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–æ—à–∏–±–æ–∫" id="toc-–∞–Ω–∞–ª–∏–∑-–æ—à–∏–±–æ–∫"><span
class="toc-section-number">5.5.3</span> –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</a></li>
</ul></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">5.6</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</a>
<ul>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">5.6.1</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">5.6.2</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–º–µ—Ç—Ä–∏–∫" id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–º–µ—Ç—Ä–∏–∫"><span
class="toc-section-number">5.7</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫</a>
<ul>
<li><a href="#–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-—Ä–µ–∞–ª—å–Ω–æ–º-–≤—Ä–µ–º–µ–Ω–∏"
id="toc-–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-—Ä–µ–∞–ª—å–Ω–æ–º-–≤—Ä–µ–º–µ–Ω–∏"><span
class="toc-section-number">5.7.1</span> –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º
–≤—Ä–µ–º–µ–Ω–∏</a></li>
<li><a href="#–∞–ª–µ—Ä—Ç—ã-–ø–æ-–º–µ—Ç—Ä–∏–∫–∞–º" id="toc-–∞–ª–µ—Ä—Ç—ã-–ø–æ-–º–µ—Ç—Ä–∏–∫–∞–º"><span
class="toc-section-number">5.7.2</span> –ê–ª–µ—Ä—Ç—ã –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–º–µ—Ç—Ä–∏–∫"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–º–µ—Ç—Ä–∏–∫"><span
class="toc-section-number">5.8</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ—Ü–µ–Ω–∫–∏-–º–æ–¥–µ–ª–∏"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ—Ü–µ–Ω–∫–∏-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">5.8.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ—Ü–µ–Ω–∫–∏
–º–æ–¥–µ–ª–∏</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-3" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-3"><span
class="toc-section-number">5.9</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π-–≤-automl-gluon"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π-–≤-automl-gluon"><span
class="toc-section-number">6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ AutoML Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–≤–∞–ª–∏–¥–∞—Ü–∏—é" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–≤–∞–ª–∏–¥–∞—Ü–∏—é"><span
class="toc-section-number">6.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é</a></li>
<li><a href="#—Ç–∏–ø—ã-–≤–∞–ª–∏–¥–∞—Ü–∏–∏" id="toc-—Ç–∏–ø—ã-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.2</span> –¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#holdout-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-holdout-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.2.1</span> 1. Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#k-fold-–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-k-fold-–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.2.2</span> 2. K-Fold
–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"
id="toc-—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="toc-section-number">6.2.3</span> 3. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#backtest-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-backtest-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.3</span> Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è</a>
<ul>
<li><a href="#–≤—Ä–µ–º–µ–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–≤—Ä–µ–º–µ–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">6.3.1</span> –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è
–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</a></li>
<li><a href="#—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π-backtest" id="toc-—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π-backtest"><span
class="toc-section-number">6.3.2</span> –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest</a></li>
</ul></li>
<li><a href="#walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.4</span> Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-–±–∞–∑–æ–≤–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.4.1</span> –ë–∞–∑–æ–≤–∞—è Walk-Forward
–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.4.2</span> –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward
–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.5</span> Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤—ã–π-monte-carlo" id="toc-–±–∞–∑–æ–≤—ã–π-monte-carlo"><span
class="toc-section-number">6.5.1</span> –ë–∞–∑–æ–≤—ã–π Monte Carlo</a></li>
<li><a href="#bootstrap-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-bootstrap-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.5.2</span> Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.6</span> –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</a>
<ul>
<li><a href="#ensemble-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-ensemble-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.6.1</span> Ensemble –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">6.7</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</a>
<ul>
<li><a href="#—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">6.7.1</span> –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–∞–Ω–∞–ª–∏–∑-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.8</span> –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑"
id="toc-—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑"><span
class="toc-section-number">6.8.1</span> –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</a></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"><span
class="toc-section-number">6.8.2</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã" id="toc-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã"><span
class="toc-section-number">6.9</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.9.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.10</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.10.1</span> –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">6.10.2</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-4" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-4"><span
class="toc-section-number">6.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏-–¥–µ–ø–ª–æ–π-automl-gluon-–º–æ–¥–µ–ª–µ–π"
id="toc-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏-–¥–µ–ø–ª–æ–π-automl-gluon-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">7</span> –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π AutoML Gluon
–º–æ–¥–µ–ª–µ–π</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–∞–∫—à–µ–Ω" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–∞–∫—à–µ–Ω"><span
class="toc-section-number">7.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–º–æ–¥–µ–ª–∏-–∫-–ø—Ä–æ–¥–∞–∫—à–µ–Ω—É"
id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–º–æ–¥–µ–ª–∏-–∫-–ø—Ä–æ–¥–∞–∫—à–µ–Ω—É"><span
class="toc-section-number">7.2</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É</a>
<ul>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏" id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">7.2.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-1" id="toc-—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-1"><span
class="toc-section-number">7.2.2</span> –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">7.2.3</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a></li>
</ul></li>
<li><a href="#api-—Å–µ—Ä–≤–µ—Ä-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-api-—Å–µ—Ä–≤–µ—Ä-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">7.3</span> API —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a>
<ul>
<li><a href="#fastapi-—Å–µ—Ä–≤–µ—Ä" id="toc-fastapi-—Å–µ—Ä–≤–µ—Ä"><span
class="toc-section-number">7.3.1</span> FastAPI —Å–µ—Ä–≤–µ—Ä</a></li>
<li><a href="#flask-—Å–µ—Ä–≤–µ—Ä" id="toc-flask-—Å–µ—Ä–≤–µ—Ä"><span
class="toc-section-number">7.3.2</span> Flask —Å–µ—Ä–≤–µ—Ä</a></li>
</ul></li>
<li><a href="#docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"
id="toc-docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"><span
class="toc-section-number">7.4</span> Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</a>
<ul>
<li><a href="#dockerfile-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-dockerfile-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">7.4.1</span> Dockerfile –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
<li><a href="#docker-compose-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-docker-compose-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">7.4.2</span> Docker Compose –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
</ul></li>
<li><a href="#kubernetes-–¥–µ–ø–ª–æ–π" id="toc-kubernetes-–¥–µ–ø–ª–æ–π"><span
class="toc-section-number">7.5</span> Kubernetes –¥–µ–ø–ª–æ–π</a>
<ul>
<li><a href="#deployment-–º–∞–Ω–∏—Ñ–µ—Å—Ç" id="toc-deployment-–º–∞–Ω–∏—Ñ–µ—Å—Ç"><span
class="toc-section-number">7.5.1</span> Deployment –º–∞–Ω–∏—Ñ–µ—Å—Ç</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">7.6</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞" id="toc-—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">7.6.1</span> –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
<li><a href="#–∞–ª–µ—Ä—Ç—ã-–∏-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" id="toc-–∞–ª–µ—Ä—Ç—ã-–∏-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"><span
class="toc-section-number">7.6.2</span> –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ" id="toc-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">7.7</span> –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
<ul>
<li><a href="#–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"
id="toc-–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">7.7.1</span> –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ
–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
<li><a href="#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ" id="toc-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">7.7.2</span> –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" id="toc-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"><span
class="toc-section-number">7.8</span> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</a>
<ul>
<li><a href="#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
id="toc-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"><span
class="toc-section-number">7.8.1</span> –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏
–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</a></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤—Ö–æ–¥–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤—Ö–æ–¥–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">7.8.2</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º—ã"
id="toc-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">7.9</span> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
id="toc-–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">7.9.1</span> –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ
—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-5" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-5"><span
class="toc-section-number">7.10</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π-automl-gluon"
id="toc-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π-automl-gluon"><span
class="toc-section-number">8</span> –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π AutoML
Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">8.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"
id="toc-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">8.2</span> –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">8.2.1</span> 1. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">8.2.2</span> 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">8.2.3</span> 3. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"
id="toc-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">8.3</span> –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">8.3.1</span> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">8.4</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö
–º–æ–¥–µ–ª–µ–π</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏" id="toc-—Å–∏—Å—Ç–µ–º–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">8.4.1</span> –°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">8.5</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-1"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-1"><span
class="toc-section-number">8.5.1</span> –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
</ul></li>
<li><a href="#–æ—Ç–∫–∞—Ç-–º–æ–¥–µ–ª–µ–π" id="toc-–æ—Ç–∫–∞—Ç-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">8.6</span> –û—Ç–∫–∞—Ç –º–æ–¥–µ–ª–µ–π</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–æ—Ç–∫–∞—Ç–∞" id="toc-—Å–∏—Å—Ç–µ–º–∞-–æ—Ç–∫–∞—Ç–∞"><span
class="toc-section-number">8.6.1</span> –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞—Ç–∞</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-1"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-1"><span
class="toc-section-number">8.7</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Å–∏—Å—Ç–µ–º—ã-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Å–∏—Å—Ç–µ–º—ã-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">8.7.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-6" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-6"><span
class="toc-section-number">8.8</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-automl-gluon"
id="toc-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-automl-gluon"><span
class="toc-section-number">9</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ AutoML Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="toc-section-number">9.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ª—É—á—à–∏–µ
–ø—Ä–∞–∫—Ç–∏–∫–∏</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1"><span
class="toc-section-number">9.2</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a>
<ul>
<li><a href="#–∫–∞—á–µ—Å—Ç–≤–æ-–¥–∞–Ω–Ω—ã—Ö" id="toc-–∫–∞—á–µ—Å—Ç–≤–æ-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">9.2.1</span> 1. –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö-–∑–Ω–∞—á–µ–Ω–∏–π"
id="toc-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö-–∑–Ω–∞—á–µ–Ω–∏–π"><span
class="toc-section-number">9.2.2</span> 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö
–∑–Ω–∞—á–µ–Ω–∏–π</a></li>
<li><a href="#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–≤—ã–±—Ä–æ—Å–æ–≤" id="toc-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–≤—ã–±—Ä–æ—Å–æ–≤"><span
class="toc-section-number">9.2.3</span> 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</a></li>
</ul></li>
<li><a href="#–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫-1" id="toc-–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫-1"><span
class="toc-section-number">9.3</span> –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</a>
<ul>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-1"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-1"><span
class="toc-section-number">9.3.1</span> 1. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</a></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏-1"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏-1"><span
class="toc-section-number">9.3.2</span> 2. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
—Ä–µ–≥—Ä–µ—Å—Å–∏–∏</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-2"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-2"><span
class="toc-section-number">9.4</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a>
<ul>
<li><a href="#—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–ø–æ–∏—Å–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"
id="toc-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–ø–æ–∏—Å–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="toc-section-number">9.4.1</span> 1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è-1"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è-1"><span
class="toc-section-number">9.4.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
–æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="toc-section-number">9.5</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
<ul>
<li><a href="#—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–≤–∞–ª–∏–¥–∞—Ü–∏–∏" id="toc-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">9.5.1</span> 1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
<li><a href="#–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">9.5.2</span> 2. –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏-1"
id="toc-—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏-1"><span
class="toc-section-number">9.6</span> –†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π-1"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π-1"><span
class="toc-section-number">9.6.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</a></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è-1" id="toc-–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è-1"><span
class="toc-section-number">9.6.2</span> 2. –ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</a></li>
</ul></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">9.7</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤-1" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤-1"><span
class="toc-section-number">9.7.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</a></li>
<li><a href="#–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è" id="toc-–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è"><span
class="toc-section-number">9.7.2</span> 2. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-1"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-1"><span
class="toc-section-number">9.8</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è" id="toc-—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">9.8.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">9.8.2</span> 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
</ul></li>
<li><a href="#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫" id="toc-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫"><span
class="toc-section-number">9.9</span> –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</a>
<ul>
<li><a href="#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∏—Å–∫–ª—é—á–µ–Ω–∏–π" id="toc-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∏—Å–∫–ª—é—á–µ–Ω–∏–π"><span
class="toc-section-number">9.9.1</span> 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</a></li>
<li><a href="#–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ-–ø–æ—Å–ª–µ-–æ—à–∏–±–æ–∫"
id="toc-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ-–ø–æ—Å–ª–µ-–æ—à–∏–±–æ–∫"><span
class="toc-section-number">9.9.2</span> 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ
–æ—à–∏–±–æ–∫</a></li>
</ul></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">9.10</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a>
<ul>
<li><a href="#—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-2" id="toc-—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-2"><span
class="toc-section-number">9.10.1</span> 1. –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"
id="toc-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="toc-section-number">9.10.2</span> 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-7" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-7"><span
class="toc-section-number">9.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-automl-gluon"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-automl-gluon"><span
class="toc-section-number">10</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML
Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–∏–º–µ—Ä—ã" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–∏–º–µ—Ä—ã"><span
class="toc-section-number">10.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–∏–º–µ—Ä—ã</a></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä-1-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–∫–ª–∏–µ–Ω—Ç–æ–≤-–±–∞–Ω–∫–∞"
id="toc-–ø—Ä–∏–º–µ—Ä-1-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–∫–ª–∏–µ–Ω—Ç–æ–≤-–±–∞–Ω–∫–∞"><span
class="toc-section-number">10.2</span> –ü—Ä–∏–º–µ—Ä 1: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
–±–∞–Ω–∫–∞</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞" id="toc-–∑–∞–¥–∞—á–∞"><span
class="toc-section-number">10.2.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ" id="toc-–¥–∞–Ω–Ω—ã–µ"><span
class="toc-section-number">10.2.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-2" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-2"><span
class="toc-section-number">10.2.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-1" id="toc-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-1"><span
class="toc-section-number">10.2.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞" id="toc-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞"><span
class="toc-section-number">10.2.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-1"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-1"><span
class="toc-section-number">10.2.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä-2-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ü–µ–Ω-–Ω–∞-–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å"
id="toc-–ø—Ä–∏–º–µ—Ä-2-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ü–µ–Ω-–Ω–∞-–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å"><span
class="toc-section-number">10.3</span> –ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –Ω–∞
–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-1" id="toc-–∑–∞–¥–∞—á–∞-1"><span
class="toc-section-number">10.3.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-1" id="toc-–¥–∞–Ω–Ω—ã–µ-1"><span
class="toc-section-number">10.3.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-3" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-3"><span
class="toc-section-number">10.3.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-2" id="toc-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-2"><span
class="toc-section-number">10.3.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-1" id="toc-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-1"><span
class="toc-section-number">10.3.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-2"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-2"><span
class="toc-section-number">10.3.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä-3-–∞–Ω–∞–ª–∏–∑-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–ø—Ä–∏–º–µ—Ä-3-–∞–Ω–∞–ª–∏–∑-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">10.4</span> –ü—Ä–∏–º–µ—Ä 3: –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-2" id="toc-–∑–∞–¥–∞—á–∞-2"><span
class="toc-section-number">10.4.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-2" id="toc-–¥–∞–Ω–Ω—ã–µ-2"><span
class="toc-section-number">10.4.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">10.4.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">10.4.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</a></li>
<li><a href="#–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">10.4.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</a></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="toc-section-number">10.4.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä-4-–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"
id="toc-–ø—Ä–∏–º–µ—Ä-4-–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"><span
class="toc-section-number">10.5</span> –ü—Ä–∏–º–µ—Ä 4: –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-3" id="toc-–∑–∞–¥–∞—á–∞-3"><span
class="toc-section-number">10.5.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-3" id="toc-–¥–∞–Ω–Ω—ã–µ-3"><span
class="toc-section-number">10.5.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-4" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-4"><span
class="toc-section-number">10.5.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-3" id="toc-–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-3"><span
class="toc-section-number">10.5.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-2" id="toc-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-2"><span
class="toc-section-number">10.5.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-3"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-3"><span
class="toc-section-number">10.5.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä-5-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"
id="toc-–ø—Ä–∏–º–µ—Ä-5-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">10.6</span> –ü—Ä–∏–º–µ—Ä 5: –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º–∞</a>
<ul>
<li><a href="#–ø–æ–ª–Ω–∞—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"
id="toc-–ø–æ–ª–Ω–∞—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">10.6.1</span> –ü–æ–ª–Ω–∞—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω
—Å–∏—Å—Ç–µ–º–∞</a></li>
<li><a href="#–∫–ª–∏–µ–Ω—Ç-–¥–ª—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
id="toc-–∫–ª–∏–µ–Ω—Ç-–¥–ª—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">10.6.2</span> –ö–ª–∏–µ–Ω—Ç –¥–ª—è
—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-8" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-8"><span
class="toc-section-number">10.7</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#troubleshooting-automl-gluon"
id="toc-troubleshooting-automl-gluon"><span
class="toc-section-number">11</span> Troubleshooting AutoML Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-troubleshooting"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-troubleshooting"><span
class="toc-section-number">11.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤
troubleshooting</a></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—É—Å—Ç–∞–Ω–æ–≤–∫–∏" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="toc-section-number">11.2</span> –ü—Ä–æ–±–ª–µ–º—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏</a>
<ul>
<li><a href="#–æ—à–∏–±–∫–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π" id="toc-–æ—à–∏–±–∫–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"><span
class="toc-section-number">11.2.1</span> 1. –û—à–∏–±–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</a></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é-1" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é-1"><span
class="toc-section-number">11.2.2</span> 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-–æ–±—É—á–µ–Ω–∏—è" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">11.3</span> –ü—Ä–æ–±–ª–µ–º—ã –æ–±—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#–º–µ–¥–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ" id="toc-–º–µ–¥–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">11.3.1</span> 1. –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#–ø–ª–æ—Ö–æ–µ-–∫–∞—á–µ—Å—Ç–≤–æ-–º–æ–¥–µ–ª–∏"
id="toc-–ø–ª–æ—Ö–æ–µ-–∫–∞—á–µ—Å—Ç–≤–æ-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">11.3.2</span> 2. –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–æ—à–∏–±–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏" id="toc-–æ—à–∏–±–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="toc-section-number">11.3.3</span> 3. –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"
id="toc-–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="toc-section-number">11.4</span> –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</a>
<ul>
<li><a href="#–æ—à–∏–±–∫–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π" id="toc-–æ—à–∏–±–∫–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="toc-section-number">11.4.1</span> 1. –û—à–∏–±–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</a></li>
<li><a href="#–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"
id="toc-–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="toc-section-number">11.4.2</span> 2. –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">11.5</span> –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a>
<ul>
<li><a href="#–º–µ–¥–ª–µ–Ω–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"
id="toc-–º–µ–¥–ª–µ–Ω–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="toc-section-number">11.5.1</span> 1. –ú–µ–¥–ª–µ–Ω–Ω—ã–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</a></li>
<li><a href="#–≤—ã—Å–æ–∫–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–∞–º—è—Ç–∏"
id="toc-–≤—ã—Å–æ–∫–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–∞–º—è—Ç–∏"><span
class="toc-section-number">11.5.2</span> 2. –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ø–∞–º—è—Ç–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" id="toc-–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">11.6</span> –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a>
<ul>
<li><a href="#–æ—à–∏–±–∫–∏-–∑–∞–≥—Ä—É–∑–∫–∏-–º–æ–¥–µ–ª–∏"
id="toc-–æ—à–∏–±–∫–∏-–∑–∞–≥—Ä—É–∑–∫–∏-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">11.6.1</span> 1. –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–æ—à–∏–±–∫–∏-api" id="toc-–æ—à–∏–±–∫–∏-api"><span
class="toc-section-number">11.6.2</span> 2. –û—à–∏–±–∫–∏ API</a></li>
</ul></li>
<li><a href="#–ø–æ–ª–µ–∑–Ω—ã–µ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏"
id="toc-–ø–æ–ª–µ–∑–Ω—ã–µ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏"><span
class="toc-section-number">11.7</span> –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-2"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-2"><span
class="toc-section-number">11.7.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è-1"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è-1"><span
class="toc-section-number">11.7.2</span> 2. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-9" id="toc-—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-9"><span
class="toc-section-number">11.8</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</a></li>
</ul></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-automl-gluon-–¥–ª—è-apple-silicon-m1m2m3"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-automl-gluon-–¥–ª—è-apple-silicon-m1m2m3"><span
class="toc-section-number">12</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple
Silicon (M1/M2/M3)</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é-–¥–ª—è-apple-silicon"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è Apple
Silicon</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–ª—è-apple-silicon"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon</a>
<ul>
<li><a href="#–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π"
id="toc-–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π"><span
class="toc-section-number">12.2.1</span> 1. –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-mlx-–¥–ª—è-apple-silicon"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-mlx-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.2.2</span> 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX –¥–ª—è Apple
Silicon</a></li>
<li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-ray-–¥–ª—è-apple-silicon"
id="toc-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-ray-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.2.3</span> 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray –¥–ª—è Apple
Silicon</a></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp"><span
class="toc-section-number">12.2.4</span> 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</a></li>
</ul></li>
<li><a href="#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-apple-silicon"
id="toc-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.3</span> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple
Silicon</a>
<ul>
<li><a href="#–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ-cuda-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-mps"
id="toc-–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ-cuda-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-mps"><span
class="toc-section-number">12.3.1</span> 1. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
MPS</a></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-autogluon-–¥–ª—è-apple-silicon"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-autogluon-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.3.2</span> 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è
Apple Silicon</a></li>
</ul></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-mlx" id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-mlx"><span
class="toc-section-number">12.4</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MLX</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-mlx-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-mlx-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">12.4.1</span> 1. –°–æ–∑–¥–∞–Ω–∏–µ
MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-mlx"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-mlx"><span
class="toc-section-number">12.4.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è
MLX</a></li>
</ul></li>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ray-–¥–ª—è-apple-silicon"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ray-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.5</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple
Silicon</a>
<ul>
<li><a href="#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-ray-–∫–ª–∞—Å—Ç–µ—Ä–∞"
id="toc-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-ray-–∫–ª–∞—Å—Ç–µ—Ä–∞"><span
class="toc-section-number">12.5.1</span> 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ray
–∫–ª–∞—Å—Ç–µ—Ä–∞</a></li>
<li><a href="#—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ-—Å-ray"
id="toc-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ-—Å-ray"><span
class="toc-section-number">12.5.2</span> 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å
Ray</a></li>
</ul></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-openmp" id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-openmp"><span
class="toc-section-number">12.6</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp-–¥–ª—è-apple-silicon"
id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.6.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple
Silicon</a></li>
<li><a href="#–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">12.6.2</span> 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–ø–æ–ª–Ω–∞—è-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"
id="toc-–ø–æ–ª–Ω–∞—è-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.7</span> –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple
Silicon</a>
<ul>
<li><a href="#–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–∏—Å—Ç–µ–º—ã"
id="toc-–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">12.7.1</span> 1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
—Å–∏—Å—Ç–µ–º—ã</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">12.7.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
–æ–±—É—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"><span
class="toc-section-number">12.8</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a>
<ul>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-–¥–ª—è-apple-silicon"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.8.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è
Apple Silicon</a></li>
</ul></li>
<li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-2"
id="toc-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-2"><span
class="toc-section-number">12.9</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"
id="toc-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"><span
class="toc-section-number">12.9.1</span> 1. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</a></li>
<li><a href="#—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">12.9.2</span> 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
</ul></li>
<li><a href="#troubleshooting-–¥–ª—è-apple-silicon"
id="toc-troubleshooting-–¥–ª—è-apple-silicon"><span
class="toc-section-number">12.10</span> Troubleshooting –¥–ª—è Apple
Silicon</a>
<ul>
<li><a href="#—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è"
id="toc-—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è"><span
class="toc-section-number">12.10.1</span> 1. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏
—Ä–µ—à–µ–Ω–∏—è</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-—Ä–∞–∑–Ω—ã—Ö-—Ä–∞–∑–º–µ—Ä–æ–≤-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-—Ä–∞–∑–Ω—ã—Ö-—Ä–∞–∑–º–µ—Ä–æ–≤-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">12.10.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö
—Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ"><span
class="toc-section-number">12.11</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–æ—Ç-–∏–¥–µ–∏-–¥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–µ–ø–ª–æ—è"
id="toc-–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–æ—Ç-–∏–¥–µ–∏-–¥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–µ–ø–ª–æ—è"><span
class="toc-section-number">13</span> –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä: –û—Ç –∏–¥–µ–∏ –¥–æ
–ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ"><span
class="toc-section-number">13.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—à–∞–≥-1-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-–∑–∞–¥–∞—á–∏"
id="toc-—à–∞–≥-1-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-–∑–∞–¥–∞—á–∏"><span
class="toc-section-number">13.2</span> –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</a>
<ul>
<li><a href="#–∏–¥–µ—è" id="toc-–∏–¥–µ—è"><span
class="toc-section-number">13.2.1</span> –ò–¥–µ—è</a></li>
<li><a href="#—Ü–µ–ª—å" id="toc-—Ü–µ–ª—å"><span
class="toc-section-number">13.2.2</span> –¶–µ–ª—å</a></li>
</ul></li>
<li><a href="#—à–∞–≥-2-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"
id="toc-—à–∞–≥-2-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">13.3</span> –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏-—Å-automl-gluon"
id="toc-—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏-—Å-automl-gluon"><span
class="toc-section-number">13.4</span> –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å AutoML
Gluon</a></li>
<li><a href="#—à–∞–≥-4-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"
id="toc-—à–∞–≥-4-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">13.5</span> –®–∞–≥ 4: –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#backtest" id="toc-backtest"><span
class="toc-section-number">13.5.1</span> Backtest</a></li>
<li><a href="#walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"
id="toc-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="toc-section-number">13.5.2</span> Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"
id="toc-monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="toc-section-number">13.5.3</span> Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
</ul></li>
<li><a href="#—à–∞–≥-5-—Å–æ–∑–¥–∞–Ω–∏–µ-api-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"
id="toc-—à–∞–≥-5-—Å–æ–∑–¥–∞–Ω–∏–µ-api-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="toc-section-number">13.6</span> –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ API –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
<li><a href="#—à–∞–≥-6-docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"
id="toc-—à–∞–≥-6-docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"><span
class="toc-section-number">13.7</span> –®–∞–≥ 6: Docker
–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</a></li>
<li><a href="#—à–∞–≥-7-–¥–µ–ø–ª–æ–π-–Ω–∞-dex-blockchain"
id="toc-—à–∞–≥-7-–¥–µ–ø–ª–æ–π-–Ω–∞-dex-blockchain"><span
class="toc-section-number">13.8</span> –®–∞–≥ 7: –î–µ–ø–ª–æ–π –Ω–∞ DEX
blockchain</a></li>
<li><a href="#—à–∞–≥-8-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"
id="toc-—à–∞–≥-8-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="toc-section-number">13.9</span> –®–∞–≥ 8: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</a></li>
<li><a href="#—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞" id="toc-—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">13.10</span> –®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"><span
class="toc-section-number">13.11</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
<ul>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">13.11.1</span> –ú–µ—Ç—Ä–∏–∫–∏
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
<li><a href="#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ—Å—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"
id="toc-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ—Å—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"><span
class="toc-section-number">13.11.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ
–ø–æ–¥—Ö–æ–¥–∞</a></li>
<li><a href="#–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è" id="toc-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è"><span
class="toc-section-number">13.11.3</span> –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-1" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-1"><span
class="toc-section-number">13.12</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-ml-—Å–∏—Å—Ç–µ–º–∞-–¥–ª—è-dex"
id="toc-—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-ml-—Å–∏—Å—Ç–µ–º–∞-–¥–ª—è-dex"><span
class="toc-section-number">14</span> –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è DEX</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-1" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-1"><span
class="toc-section-number">14.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—à–∞–≥-1-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã"
id="toc-—à–∞–≥-1-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">14.2</span> –®–∞–≥ 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"
id="toc-–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">14.2.1</span> –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</a></li>
</ul></li>
<li><a href="#—à–∞–≥-2-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"
id="toc-—à–∞–≥-2-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">14.3</span> –®–∞–≥ 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
–¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"
id="toc-—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">14.4</span> –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö
–º–æ–¥–µ–ª–µ–π</a></li>
<li><a href="#—à–∞–≥-4-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"
id="toc-—à–∞–≥-4-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">14.5</span> –®–∞–≥ 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#—à–∞–≥-5-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"
id="toc-—à–∞–≥-5-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"><span
class="toc-section-number">14.6</span> –®–∞–≥ 5: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</a></li>
<li><a href="#—à–∞–≥-6-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"
id="toc-—à–∞–≥-6-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"><span
class="toc-section-number">14.7</span> –®–∞–≥ 6: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</a></li>
<li><a href="#—à–∞–≥-7-kubernetes-–¥–µ–ø–ª–æ–π"
id="toc-—à–∞–≥-7-kubernetes-–¥–µ–ø–ª–æ–π"><span
class="toc-section-number">14.8</span> –®–∞–≥ 7: Kubernetes –¥–µ–ø–ª–æ–π</a></li>
<li><a href="#—à–∞–≥-8-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
id="toc-—à–∞–≥-8-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"><span
class="toc-section-number">14.9</span> –®–∞–≥ 8: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</a></li>
<li><a href="#—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"
id="toc-—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"><span
class="toc-section-number">14.10</span> –®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-1" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-1"><span
class="toc-section-number">14.11</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
<ul>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2"><span
class="toc-section-number">14.11.1</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</a></li>
<li><a href="#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"
id="toc-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"><span
class="toc-section-number">14.11.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ
–ø–æ–¥—Ö–æ–¥–∞</a></li>
<li><a href="#—Å–ª–æ–∂–Ω–æ—Å—Ç—å" id="toc-—Å–ª–æ–∂–Ω–æ—Å—Ç—å"><span
class="toc-section-number">14.11.3</span> –°–ª–æ–∂–Ω–æ—Å—Ç—å</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-2" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-2"><span
class="toc-section-number">14.12</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl"
id="toc-—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl"><span
class="toc-section-number">15</span> –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Ç–µ–æ—Ä–∏—é-automl"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Ç–µ–æ—Ä–∏—é-automl"><span
class="toc-section-number">15.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ–æ—Ä–∏—é AutoML</a></li>
<li><a href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏-automl"
id="toc-–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏-automl"><span
class="toc-section-number">15.2</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ AutoML</a>
<ul>
<li><a href="#neural-architecture-search-nas"
id="toc-neural-architecture-search-nas"><span
class="toc-section-number">15.2.1</span> 1. Neural Architecture Search
(NAS)</a></li>
<li><a href="#hyperparameter-optimization"
id="toc-hyperparameter-optimization"><span
class="toc-section-number">15.2.2</span> 2. Hyperparameter
Optimization</a></li>
<li><a href="#feature-engineering-automation"
id="toc-feature-engineering-automation"><span
class="toc-section-number">15.2.3</span> 3. Feature Engineering
Automation</a></li>
</ul></li>
<li><a href="#–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã"
id="toc-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã"><span
class="toc-section-number">15.3</span> –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã</a>
<ul>
<li><a href="#loss-functions" id="toc-loss-functions"><span
class="toc-section-number">15.3.1</span> 1. Loss Functions</a></li>
<li><a href="#optimization-algorithms"
id="toc-optimization-algorithms"><span
class="toc-section-number">15.3.2</span> 2. Optimization
Algorithms</a></li>
<li><a href="#regularization-techniques"
id="toc-regularization-techniques"><span
class="toc-section-number">15.3.3</span> 3. Regularization
Techniques</a></li>
</ul></li>
<li><a href="#ensemble-methods" id="toc-ensemble-methods"><span
class="toc-section-number">15.4</span> Ensemble Methods</a>
<ul>
<li><a href="#bagging" id="toc-bagging"><span
class="toc-section-number">15.4.1</span> 1. Bagging</a></li>
<li><a href="#boosting" id="toc-boosting"><span
class="toc-section-number">15.4.2</span> 2. Boosting</a></li>
<li><a href="#stacking" id="toc-stacking"><span
class="toc-section-number">15.4.3</span> 3. Stacking</a></li>
</ul></li>
<li><a href="#advanced-concepts" id="toc-advanced-concepts"><span
class="toc-section-number">15.5</span> Advanced Concepts</a>
<ul>
<li><a href="#multi-task-learning" id="toc-multi-task-learning"><span
class="toc-section-number">15.5.1</span> 1. Multi-Task Learning</a></li>
<li><a href="#transfer-learning" id="toc-transfer-learning"><span
class="toc-section-number">15.5.2</span> 2. Transfer Learning</a></li>
<li><a href="#meta-learning" id="toc-meta-learning"><span
class="toc-section-number">15.5.3</span> 3. Meta-Learning</a></li>
</ul></li>
<li><a href="#performance-optimization"
id="toc-performance-optimization"><span
class="toc-section-number">15.6</span> Performance Optimization</a>
<ul>
<li><a href="#memory-optimization" id="toc-memory-optimization"><span
class="toc-section-number">15.6.1</span> 1. Memory Optimization</a></li>
<li><a href="#computational-optimization"
id="toc-computational-optimization"><span
class="toc-section-number">15.6.2</span> 2. Computational
Optimization</a></li>
</ul></li>
<li><a href="#theoretical-guarantees"
id="toc-theoretical-guarantees"><span
class="toc-section-number">15.7</span> Theoretical Guarantees</a>
<ul>
<li><a href="#convergence-guarantees"
id="toc-convergence-guarantees"><span
class="toc-section-number">15.7.1</span> 1. Convergence
Guarantees</a></li>
<li><a href="#generalization-bounds"
id="toc-generalization-bounds"><span
class="toc-section-number">15.7.2</span> 2. Generalization
Bounds</a></li>
</ul></li>
<li><a href="#research-frontiers" id="toc-research-frontiers"><span
class="toc-section-number">15.8</span> Research Frontiers</a>
<ul>
<li><a href="#neural-architecture-search"
id="toc-neural-architecture-search"><span
class="toc-section-number">15.8.1</span> 1. Neural Architecture
Search</a></li>
<li><a href="#automl-for-time-series"
id="toc-automl-for-time-series"><span
class="toc-section-number">15.8.2</span> 2. AutoML for Time
Series</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-3" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-3"><span
class="toc-section-number">15.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å-–º–æ–¥–µ–ª–µ–π"
id="toc-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å-–º–æ–¥–µ–ª–µ–π"><span
class="toc-section-number">16</span> –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å
–º–æ–¥–µ–ª–µ–π</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å"><span
class="toc-section-number">16.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</a></li>
<li><a href="#—Ç–∏–ø—ã-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"
id="toc-—Ç–∏–ø—ã-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="toc-section-number">16.2</span> –¢–∏–ø—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</a>
<ul>
<li><a href="#–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-intrinsic-interpretability"
id="toc-–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-intrinsic-interpretability"><span
class="toc-section-number">16.2.1</span> 1. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (Intrinsic Interpretability)</a></li>
<li><a href="#–ø–æ—Å—Ç-—Ö–æ–∫-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-post-hoc-interpretability"
id="toc-–ø–æ—Å—Ç-—Ö–æ–∫-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-post-hoc-interpretability"><span
class="toc-section-number">16.2.2</span> 2. –ü–æ—Å—Ç-—Ö–æ–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
(Post-hoc Interpretability)</a></li>
</ul></li>
<li><a href="#–º–µ—Ç–æ–¥—ã-–≥–ª–æ–±–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"
id="toc-–º–µ—Ç–æ–¥—ã-–≥–ª–æ–±–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="toc-section-number">16.3</span> –ú–µ—Ç–æ–¥—ã –≥–ª–æ–±–∞–ª—å–Ω–æ–π
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</a>
<ul>
<li><a href="#feature-importance" id="toc-feature-importance"><span
class="toc-section-number">16.3.1</span> 1. Feature Importance</a></li>
<li><a href="#partial-dependence-plots-pdp"
id="toc-partial-dependence-plots-pdp"><span
class="toc-section-number">16.3.2</span> 2. Partial Dependence Plots
(PDP)</a></li>
<li><a href="#accumulated-local-effects-ale"
id="toc-accumulated-local-effects-ale"><span
class="toc-section-number">16.3.3</span> 3. Accumulated Local Effects
(ALE)</a></li>
</ul></li>
<li><a href="#–º–µ—Ç–æ–¥—ã-–ª–æ–∫–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"
id="toc-–º–µ—Ç–æ–¥—ã-–ª–æ–∫–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="toc-section-number">16.4</span> –ú–µ—Ç–æ–¥—ã –ª–æ–∫–∞–ª—å–Ω–æ–π
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</a>
<ul>
<li><a href="#lime-local-interpretable-model-agnostic-explanations"
id="toc-lime-local-interpretable-model-agnostic-explanations"><span
class="toc-section-number">16.4.1</span> 1. LIME (Local Interpretable
Model-agnostic Explanations)</a></li>
<li><a href="#shap-shapley-additive-explanations"
id="toc-shap-shapley-additive-explanations"><span
class="toc-section-number">16.4.2</span> 2. SHAP (SHapley Additive
exPlanations)</a></li>
<li><a href="#integrated-gradients" id="toc-integrated-gradients"><span
class="toc-section-number">16.4.3</span> 3. Integrated
Gradients</a></li>
</ul></li>
<li><a href="#—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ-–º–µ—Ç–æ–¥—ã-–¥–ª—è-automl-gluon"
id="toc-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ-–º–µ—Ç–æ–¥—ã-–¥–ª—è-automl-gluon"><span
class="toc-section-number">16.5</span> –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è AutoML
Gluon</a>
<ul>
<li><a href="#model-specific-interpretability"
id="toc-model-specific-interpretability"><span
class="toc-section-number">16.5.1</span> 1. Model-specific
Interpretability</a></li>
<li><a href="#ensemble-interpretability"
id="toc-ensemble-interpretability"><span
class="toc-section-number">16.5.2</span> 2. Ensemble
Interpretability</a></li>
</ul></li>
<li><a href="#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π"
id="toc-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π"><span
class="toc-section-number">16.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</a>
<ul>
<li><a href="#comprehensive-explanation-dashboard"
id="toc-comprehensive-explanation-dashboard"><span
class="toc-section-number">16.6.1</span> 1. Comprehensive Explanation
Dashboard</a></li>
<li><a href="#interactive-explanations"
id="toc-interactive-explanations"><span
class="toc-section-number">16.6.2</span> 2. Interactive
Explanations</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"
id="toc-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"><span
class="toc-section-number">16.7</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è"
id="toc-–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è"><span
class="toc-section-number">16.7.1</span> 1. –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞
–æ–±—ä—è—Å–Ω–µ–Ω–∏—è</a></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π"><span
class="toc-section-number">16.7.2</span> 2. –í–∞–ª–∏–¥–∞—Ü–∏—è
–æ–±—ä—è—Å–Ω–µ–Ω–∏–π</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-4" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-4"><span
class="toc-section-number">16.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-automl"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-automl"><span
class="toc-section-number">17</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"><span
class="toc-section-number">17.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ
—Ç–µ–º—ã</a></li>
<li><a href="#neural-architecture-search-nas-1"
id="toc-neural-architecture-search-nas-1"><span
class="toc-section-number">17.2</span> Neural Architecture Search
(NAS)</a>
<ul>
<li><a href="#differentiable-architecture-search-darts"
id="toc-differentiable-architecture-search-darts"><span
class="toc-section-number">17.2.1</span> 1. Differentiable Architecture
Search (DARTS)</a></li>
<li><a href="#efficient-neural-architecture-search-enas"
id="toc-efficient-neural-architecture-search-enas"><span
class="toc-section-number">17.2.2</span> 2. Efficient Neural
Architecture Search (ENAS)</a></li>
</ul></li>
<li><a href="#meta-learning-1" id="toc-meta-learning-1"><span
class="toc-section-number">17.3</span> Meta-Learning</a>
<ul>
<li><a href="#model-agnostic-meta-learning-maml"
id="toc-model-agnostic-meta-learning-maml"><span
class="toc-section-number">17.3.1</span> 1. Model-Agnostic Meta-Learning
(MAML)</a></li>
<li><a href="#prototypical-networks"
id="toc-prototypical-networks"><span
class="toc-section-number">17.3.2</span> 2. Prototypical
Networks</a></li>
</ul></li>
<li><a href="#multi-modal-learning" id="toc-multi-modal-learning"><span
class="toc-section-number">17.4</span> Multi-Modal Learning</a>
<ul>
<li><a href="#vision-language-models"
id="toc-vision-language-models"><span
class="toc-section-number">17.4.1</span> 1. Vision-Language
Models</a></li>
<li><a href="#cross-modal-attention"
id="toc-cross-modal-attention"><span
class="toc-section-number">17.4.2</span> 2. Cross-Modal
Attention</a></li>
</ul></li>
<li><a href="#federated-learning" id="toc-federated-learning"><span
class="toc-section-number">17.5</span> Federated Learning</a>
<ul>
<li><a href="#federated-averaging-fedavg"
id="toc-federated-averaging-fedavg"><span
class="toc-section-number">17.5.1</span> 1. Federated Averaging
(FedAvg)</a></li>
<li><a href="#differential-privacy" id="toc-differential-privacy"><span
class="toc-section-number">17.5.2</span> 2. Differential
Privacy</a></li>
</ul></li>
<li><a href="#continual-learning" id="toc-continual-learning"><span
class="toc-section-number">17.6</span> Continual Learning</a>
<ul>
<li><a href="#elastic-weight-consolidation-ewc"
id="toc-elastic-weight-consolidation-ewc"><span
class="toc-section-number">17.6.1</span> 1. Elastic Weight Consolidation
(EWC)</a></li>
<li><a href="#progressive-neural-networks"
id="toc-progressive-neural-networks"><span
class="toc-section-number">17.6.2</span> 2. Progressive Neural
Networks</a></li>
</ul></li>
<li><a href="#quantum-machine-learning"
id="toc-quantum-machine-learning"><span
class="toc-section-number">17.7</span> Quantum Machine Learning</a>
<ul>
<li><a href="#quantum-neural-networks"
id="toc-quantum-neural-networks"><span
class="toc-section-number">17.7.1</span> 1. Quantum Neural
Networks</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-5" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-5"><span
class="toc-section-number">17.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai"
id="toc-—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai"><span
class="toc-section-number">18</span> –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—ç—Ç–∏–∫—É-ai" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—ç—Ç–∏–∫—É-ai"><span
class="toc-section-number">18.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —ç—Ç–∏–∫—É AI</a></li>
<li><a href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-—ç—Ç–∏—á–Ω–æ–≥–æ-ai"
id="toc-–æ—Å–Ω–æ–≤–Ω—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-—ç—Ç–∏—á–Ω–æ–≥–æ-ai"><span
class="toc-section-number">18.2</span> –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ AI</a>
<ul>
<li><a href="#—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å-–∏-–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ-–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏"
id="toc-—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å-–∏-–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ-–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏"><span
class="toc-section-number">18.2.1</span> 1. –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ
–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏</a></li>
<li><a href="#–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å"
id="toc-–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å"><span
class="toc-section-number">18.2.2</span> 2. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏
–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</a></li>
<li><a href="#–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å-–∏-–∑–∞—â–∏—Ç–∞-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å-–∏-–∑–∞—â–∏—Ç–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">18.2.3</span> 3. –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞
–¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–≤–æ–≤—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è" id="toc-–ø—Ä–∞–≤–æ–≤—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="toc-section-number">18.3</span> –ü—Ä–∞–≤–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</a>
<ul>
<li><a href="#gdpr-compliance" id="toc-gdpr-compliance"><span
class="toc-section-number">18.3.1</span> 1. GDPR Compliance</a></li>
<li><a href="#ai-act-compliance" id="toc-ai-act-compliance"><span
class="toc-section-number">18.3.2</span> 2. AI Act Compliance</a></li>
</ul></li>
<li><a href="#bias-detection-and-mitigation"
id="toc-bias-detection-and-mitigation"><span
class="toc-section-number">18.4</span> Bias Detection and Mitigation</a>
<ul>
<li><a href="#bias-detection" id="toc-bias-detection"><span
class="toc-section-number">18.4.1</span> 1. Bias Detection</a></li>
<li><a href="#bias-mitigation" id="toc-bias-mitigation"><span
class="toc-section-number">18.4.2</span> 2. Bias Mitigation</a></li>
</ul></li>
<li><a href="#responsible-ai-framework"
id="toc-responsible-ai-framework"><span
class="toc-section-number">18.5</span> Responsible AI Framework</a>
<ul>
<li><a href="#ai-ethics-checklist" id="toc-ai-ethics-checklist"><span
class="toc-section-number">18.5.1</span> 1. AI Ethics Checklist</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-6" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-6"><span
class="toc-section-number">18.6</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–µ–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–µ–∫—Ç—ã-—Å-automl-gluon"
id="toc-–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–µ–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–µ–∫—Ç—ã-—Å-automl-gluon"><span
class="toc-section-number">19</span> –ö–µ–π—Å-—Å—Ç–∞–¥–∏: –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å
AutoML Gluon</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∫–µ–π—Å-—Å—Ç–∞–¥–∏"
id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∫–µ–π—Å-—Å—Ç–∞–¥–∏"><span
class="toc-section-number">19.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–µ–π—Å-—Å—Ç–∞–¥–∏</a></li>
<li><a href="#–∫–µ–π—Å-1-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ-—É—Å–ª—É–≥–∏---–∫—Ä–µ–¥–∏—Ç–Ω—ã–π-—Å–∫–æ—Ä–∏–Ω–≥"
id="toc-–∫–µ–π—Å-1-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ-—É—Å–ª—É–≥–∏---–∫—Ä–µ–¥–∏—Ç–Ω—ã–π-—Å–∫–æ—Ä–∏–Ω–≥"><span
class="toc-section-number">19.2</span> –ö–µ–π—Å 1: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏ -
–ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-4" id="toc-–∑–∞–¥–∞—á–∞-4"><span
class="toc-section-number">19.2.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-4" id="toc-–¥–∞–Ω–Ω—ã–µ-4"><span
class="toc-section-number">19.2.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ" id="toc-—Ä–µ—à–µ–Ω–∏–µ"><span
class="toc-section-number">19.2.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-2" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-2"><span
class="toc-section-number">19.2.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-2-–∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ---–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞-–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"
id="toc-–∫–µ–π—Å-2-–∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ---–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞-–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"><span
class="toc-section-number">19.3</span> –ö–µ–π—Å 2: –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ -
–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-5" id="toc-–∑–∞–¥–∞—á–∞-5"><span
class="toc-section-number">19.3.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-5" id="toc-–¥–∞–Ω–Ω—ã–µ-5"><span
class="toc-section-number">19.3.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ-1" id="toc-—Ä–µ—à–µ–Ω–∏–µ-1"><span
class="toc-section-number">19.3.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-3" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-3"><span
class="toc-section-number">19.3.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-3-e-commerce---—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞"
id="toc-–∫–µ–π—Å-3-e-commerce---—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">19.4</span> –ö–µ–π—Å 3: E-commerce -
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-6" id="toc-–∑–∞–¥–∞—á–∞-6"><span
class="toc-section-number">19.4.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-6" id="toc-–¥–∞–Ω–Ω—ã–µ-6"><span
class="toc-section-number">19.4.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ-2" id="toc-—Ä–µ—à–µ–Ω–∏–µ-2"><span
class="toc-section-number">19.4.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-4" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-4"><span
class="toc-section-number">19.4.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-4-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ---–ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"
id="toc-–∫–µ–π—Å-4-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ---–ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"><span
class="toc-section-number">19.5</span> –ö–µ–π—Å 4: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ -
–ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-7" id="toc-–∑–∞–¥–∞—á–∞-7"><span
class="toc-section-number">19.5.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-7" id="toc-–¥–∞–Ω–Ω—ã–µ-7"><span
class="toc-section-number">19.5.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ-3" id="toc-—Ä–µ—à–µ–Ω–∏–µ-3"><span
class="toc-section-number">19.5.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-5" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-5"><span
class="toc-section-number">19.5.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-5-–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è---btcusdt"
id="toc-–∫–µ–π—Å-5-–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è---btcusdt"><span
class="toc-section-number">19.6</span> –ö–µ–π—Å 5: –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è -
BTCUSDT</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-8" id="toc-–∑–∞–¥–∞—á–∞-8"><span
class="toc-section-number">19.6.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-8" id="toc-–¥–∞–Ω–Ω—ã–µ-8"><span
class="toc-section-number">19.6.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ-4" id="toc-—Ä–µ—à–µ–Ω–∏–µ-4"><span
class="toc-section-number">19.6.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-6" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-6"><span
class="toc-section-number">19.6.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∫–µ–π—Å-6-—Ö–µ–¥–∂-—Ñ–æ–Ω–¥---–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"
id="toc-–∫–µ–π—Å-6-—Ö–µ–¥–∂-—Ñ–æ–Ω–¥---–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="toc-section-number">19.7</span> –ö–µ–π—Å 6: –•–µ–¥–∂-—Ñ–æ–Ω–¥ - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
—Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-9" id="toc-–∑–∞–¥–∞—á–∞-9"><span
class="toc-section-number">19.7.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#–¥–∞–Ω–Ω—ã–µ-9" id="toc-–¥–∞–Ω–Ω—ã–µ-9"><span
class="toc-section-number">19.7.2</span> –î–∞–Ω–Ω—ã–µ</a></li>
<li><a href="#—Ä–µ—à–µ–Ω–∏–µ-5" id="toc-—Ä–µ—à–µ–Ω–∏–µ-5"><span
class="toc-section-number">19.7.3</span> –†–µ—à–µ–Ω–∏–µ</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-7" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-7"><span
class="toc-section-number">19.7.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-7" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-7"><span
class="toc-section-number">19.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
<li><a href="#–∫–µ–π—Å-7-—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"
id="toc-–∫–µ–π—Å-7-—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"><span
class="toc-section-number">19.9</span> –ö–µ–π—Å 7: –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ
—Ç–µ—Ö–Ω–∏–∫–∏</a>
<ul>
<li><a href="#–∑–∞–¥–∞—á–∞-10" id="toc-–∑–∞–¥–∞—á–∞-10"><span
class="toc-section-number">19.9.1</span> –ó–∞–¥–∞—á–∞</a></li>
<li><a href="#—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏" id="toc-—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"><span
class="toc-section-number">19.9.2</span> –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</a></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö-—Ç–µ—Ö–Ω–∏–∫"
id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö-—Ç–µ—Ö–Ω–∏–∫"><span
class="toc-section-number">19.9.3</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö
—Ç–µ—Ö–Ω–∏–∫</a></li>
<li><a href="#–ø–æ—á–µ–º—É-—ç—Ç–∏-—Ç–µ—Ö–Ω–∏–∫–∏-—Ç–∞–∫–∏–µ-–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ"
id="toc-–ø–æ—á–µ–º—É-—ç—Ç–∏-—Ç–µ—Ö–Ω–∏–∫–∏-—Ç–∞–∫–∏–µ-–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ"><span
class="toc-section-number">19.9.4</span> –ü–æ—á–µ–º—É —ç—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏ —Ç–∞–∫–∏–µ
–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ?</a></li>
</ul></li>
</ul></li>
<li><a href="#wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"
id="toc-wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="toc-section-number">20</span> WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏
ML-–º–æ–¥–µ–ª—å</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-2" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-2"><span
class="toc-section-number">20.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—á—Ç–æ-—Ç–∞–∫–æ–µ-wave2" id="toc-—á—Ç–æ-—Ç–∞–∫–æ–µ-wave2"><span
class="toc-section-number">20.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ WAVE2?</a></li>
<li><a href="#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-wave2"
id="toc-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-wave2"><span
class="toc-section-number">20.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2</a>
<ul>
<li><a href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ"
id="toc-–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ"><span
class="toc-section-number">20.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</a></li>
</ul></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º"
id="toc-–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º"><span
class="toc-section-number">20.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</a>
<ul>
<li><a href="#m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.3</span> M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"
id="toc-mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="toc-section-number">20.4.8</span> MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
</ul></li>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-wave2"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-wave2"><span
class="toc-section-number">20.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ
WAVE2</a>
<ul>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-5" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-5"><span
class="toc-section-number">20.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-1" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-1"><span
class="toc-section-number">20.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#backtest-1" id="toc-backtest-1"><span
class="toc-section-number">20.6.1</span> Backtest</a></li>
<li><a href="#walk-forward-analysis"
id="toc-walk-forward-analysis"><span
class="toc-section-number">20.6.2</span> Walk-Forward Analysis</a></li>
<li><a href="#monte-carlo-simulation"
id="toc-monte-carlo-simulation"><span
class="toc-section-number">20.6.3</span> Monte Carlo Simulation</a></li>
</ul></li>
<li><a href="#–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ" id="toc-–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ"><span
class="toc-section-number">20.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞"><span
class="toc-section-number">20.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</a></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex" id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex"><span
class="toc-section-number">20.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</a></li>
</ul></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-8" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-8"><span
class="toc-section-number">20.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
<ul>
<li><a href="#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏"
id="toc-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">20.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2"
id="toc-—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2"><span
class="toc-section-number">20.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</a></li>
<li><a href="#—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2" id="toc-—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2"><span
class="toc-section-number">20.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-8" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-8"><span
class="toc-section-number">20.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"
id="toc-schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="toc-section-number">21</span> SCHR Levels –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π
–∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-3" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-3"><span
class="toc-section-number">21.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-levels"
id="toc-—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-levels"><span
class="toc-section-number">21.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ SCHR Levels?</a></li>
<li><a href="#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-levels"
id="toc-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-levels"><span
class="toc-section-number">21.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels</a>
<ul>
<li><a href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-1"
id="toc-–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-1"><span
class="toc-section-number">21.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</a></li>
</ul></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-1"
id="toc-–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-1"><span
class="toc-section-number">21.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</a>
<ul>
<li><a href="#m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.3</span> M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"
id="toc-mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="toc-section-number">21.4.8</span> MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
</ul></li>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-levels"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-levels"><span
class="toc-section-number">21.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR
Levels</a>
<ul>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-6" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-6"><span
class="toc-section-number">21.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-2" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-2"><span
class="toc-section-number">21.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#backtest-2" id="toc-backtest-2"><span
class="toc-section-number">21.6.1</span> Backtest</a></li>
<li><a href="#walk-forward-analysis-1"
id="toc-walk-forward-analysis-1"><span
class="toc-section-number">21.6.2</span> Walk-Forward Analysis</a></li>
<li><a href="#monte-carlo-simulation-1"
id="toc-monte-carlo-simulation-1"><span
class="toc-section-number">21.6.3</span> Monte Carlo Simulation</a></li>
</ul></li>
<li><a href="#–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-1"
id="toc-–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-1"><span
class="toc-section-number">21.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-1"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-1"><span
class="toc-section-number">21.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</a></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-1" id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-1"><span
class="toc-section-number">21.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</a></li>
</ul></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-9" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-9"><span
class="toc-section-number">21.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
<ul>
<li><a href="#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-1"
id="toc-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-1"><span
class="toc-section-number">21.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"
id="toc-—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"><span
class="toc-section-number">21.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
Levels</a></li>
<li><a href="#—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"
id="toc-—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"><span
class="toc-section-number">21.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
Levels</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-9" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-9"><span
class="toc-section-number">21.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"
id="toc-schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="toc-section-number">22</span> SCHR SHORT3 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π
–∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-4" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-4"><span
class="toc-section-number">22.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-short3"
id="toc-—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-short3"><span
class="toc-section-number">22.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ SCHR SHORT3?</a></li>
<li><a href="#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-short3"
id="toc-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-short3"><span
class="toc-section-number">22.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3</a>
<ul>
<li><a href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-2"
id="toc-–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-2"><span
class="toc-section-number">22.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</a></li>
</ul></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-2"
id="toc-–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-2"><span
class="toc-section-number">22.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</a>
<ul>
<li><a href="#m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.3</span> M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="#mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"
id="toc-mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="toc-section-number">22.4.8</span> MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
</ul></li>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-short3"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-short3"><span
class="toc-section-number">22.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR
SHORT3</a>
<ul>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-7" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-7"><span
class="toc-section-number">22.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
</ul></li>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-3" id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-3"><span
class="toc-section-number">22.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</a>
<ul>
<li><a href="#backtest-3" id="toc-backtest-3"><span
class="toc-section-number">22.6.1</span> Backtest</a></li>
<li><a href="#walk-forward-analysis-2"
id="toc-walk-forward-analysis-2"><span
class="toc-section-number">22.6.2</span> Walk-Forward Analysis</a></li>
<li><a href="#monte-carlo-simulation-2"
id="toc-monte-carlo-simulation-2"><span
class="toc-section-number">22.6.3</span> Monte Carlo Simulation</a></li>
</ul></li>
<li><a href="#–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-2"
id="toc-–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-2"><span
class="toc-section-number">22.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</a>
<ul>
<li><a href="#—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-2"
id="toc-—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-2"><span
class="toc-section-number">22.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</a></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-2" id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-2"><span
class="toc-section-number">22.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</a></li>
</ul></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-10" id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-10"><span
class="toc-section-number">22.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
<ul>
<li><a href="#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-2"
id="toc-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-2"><span
class="toc-section-number">22.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"
id="toc-—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"><span
class="toc-section-number">22.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
SHORT3</a></li>
<li><a href="#—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"
id="toc-—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"><span
class="toc-section-number">22.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
SHORT3</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-10" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-10"><span
class="toc-section-number">22.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-–≤—Å–µ—Ö-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"
id="toc-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-–≤—Å–µ—Ö-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span
class="toc-section-number">23</span> –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-5" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-5"><span
class="toc-section-number">23.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"
id="toc-—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">23.2</span> –§–∏–ª–æ—Å–æ—Ñ–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–ø—Ä–∏–Ω—Ü–∏–ø—ã-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è" id="toc-–ø—Ä–∏–Ω—Ü–∏–ø—ã-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è"><span
class="toc-section-number">23.2.1</span> –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è</a></li>
<li><a href="#–ø–æ—á–µ–º—É-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç-–≤—Å–µ–≥–¥–∞"
id="toc-–ø–æ—á–µ–º—É-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç-–≤—Å–µ–≥–¥–∞"><span
class="toc-section-number">23.2.2</span> –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
–≤—Å–µ–≥–¥–∞</a></li>
</ul></li>
<li><a href="#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"
id="toc-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">23.3</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"
id="toc-–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"><span
class="toc-section-number">23.3.1</span> 1. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è
—Å–∏—Å—Ç–µ–º–∞</a></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"
id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span
class="toc-section-number">23.3.2</span> 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</a></li>
<li><a href="#–º–µ—Ç–∞-–º–æ–¥–µ–ª—å" id="toc-–º–µ—Ç–∞-–º–æ–¥–µ–ª—å"><span
class="toc-section-number">23.3.3</span> 3. –ú–µ—Ç–∞-–º–æ–¥–µ–ª—å</a></li>
<li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"
id="toc-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"><span
class="toc-section-number">23.3.4</span> 4. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</a></li>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ-–æ–±—É—á–µ–Ω–∏—è"
id="toc-—Å–∏—Å—Ç–µ–º–∞-–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ-–æ–±—É—á–µ–Ω–∏—è"><span
class="toc-section-number">23.3.5</span> 5. –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ
–æ–±—É—á–µ–Ω–∏—è</a></li>
</ul></li>
<li><a href="#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"
id="toc-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">23.4</span> –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-8" id="toc-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-8"><span
class="toc-section-number">23.4.1</span> 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–æ–±—É—á–µ–Ω–∏–µ-—Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏"
id="toc-–æ–±—É—á–µ–Ω–∏–µ-—Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏"><span
class="toc-section-number">23.4.2</span> 2. –û–±—É—á–µ–Ω–∏–µ
—Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏</a></li>
<li><a href="#–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-3"
id="toc-–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-3"><span
class="toc-section-number">23.4.3</span> 3. –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</a></li>
</ul></li>
<li><a href="#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"
id="toc-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">23.5</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a>
<ul>
<li><a href="#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å" id="toc-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"><span
class="toc-section-number">23.5.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</a></li>
<li><a href="#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"
id="toc-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">23.5.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-11" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-11"><span
class="toc-section-number">23.6</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é-—É—á–µ–±–Ω–∏–∫–∞"
id="toc-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é-—É—á–µ–±–Ω–∏–∫–∞"><span
class="toc-section-number">24</span> –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é
—É—á–µ–±–Ω–∏–∫–∞</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-6" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-6"><span
class="toc-section-number">24.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#–¥–ª—è-–Ω–æ–≤–∏—á–∫–æ–≤-0-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"
id="toc-–¥–ª—è-–Ω–æ–≤–∏—á–∫–æ–≤-0-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"><span
class="toc-section-number">24.2</span> –î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (0-6 –º–µ—Å—è—Ü–µ–≤
–æ–ø—ã—Ç–∞)</a>
<ul>
<li><a href="#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç-1-2-–Ω–µ–¥–µ–ª–∏"
id="toc-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç-1-2-–Ω–µ–¥–µ–ª–∏"><span
class="toc-section-number">24.2.1</span> üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (1-2
–Ω–µ–¥–µ–ª–∏)</a></li>
<li><a href="#–ø–æ–ª–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-1-2-–º–µ—Å—è—Ü–∞"
id="toc-–ø–æ–ª–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-1-2-–º–µ—Å—è—Ü–∞"><span
class="toc-section-number">24.2.2</span> üìö –ü–æ–ª–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (1-2
–º–µ—Å—è—Ü–∞)</a></li>
</ul></li>
<li><a href="#–¥–ª—è-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"
id="toc-–¥–ª—è-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"><span
class="toc-section-number">24.3</span> –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (6+
–º–µ—Å—è—Ü–µ–≤ –æ–ø—ã—Ç–∞)</a>
<ul>
<li><a href="#—Ñ–æ–∫—É—Å-–Ω–∞-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ-1-–Ω–µ–¥–µ–ª—è"
id="toc-—Ñ–æ–∫—É—Å-–Ω–∞-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ-1-–Ω–µ–¥–µ–ª—è"><span
class="toc-section-number">24.3.1</span> üéØ –§–æ–∫—É—Å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (1
–Ω–µ–¥–µ–ª—è)</a></li>
<li><a href="#—É–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-2-3-–Ω–µ–¥–µ–ª–∏"
id="toc-—É–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-2-3-–Ω–µ–¥–µ–ª–∏"><span
class="toc-section-number">24.3.2</span> üî¨ –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (2-3
–Ω–µ–¥–µ–ª–∏)</a></li>
</ul></li>
<li><a href="#–¥–ª—è-—ç–∫—Å–ø–µ—Ä—Ç–æ–≤-2-–≥–æ–¥–∞-–æ–ø—ã—Ç–∞"
id="toc-–¥–ª—è-—ç–∫—Å–ø–µ—Ä—Ç–æ–≤-2-–≥–æ–¥–∞-–æ–ø—ã—Ç–∞"><span
class="toc-section-number">24.4</span> –î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ (2+ –≥–æ–¥–∞ –æ–ø—ã—Ç–∞)</a>
<ul>
<li><a href="#–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è-—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å-3-5-–¥–Ω–µ–π"
id="toc-–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è-—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å-3-5-–¥–Ω–µ–π"><span
class="toc-section-number">24.4.1</span> üöÄ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
(3-5 –¥–Ω–µ–π)</a></li>
</ul></li>
<li><a href="#—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–ø—É—Ç–∏-–∏–∑—É—á–µ–Ω–∏—è"
id="toc-—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–ø—É—Ç–∏-–∏–∑—É—á–µ–Ω–∏—è"><span
class="toc-section-number">24.5</span> –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏
–∏–∑—É—á–µ–Ω–∏—è</a>
<ul>
<li><a href="#–¥–ª—è-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤-–¥–∞–Ω–Ω—ã—Ö"
id="toc-–¥–ª—è-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤-–¥–∞–Ω–Ω—ã—Ö"><span
class="toc-section-number">24.5.1</span> üìä –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤
–¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="#–¥–ª—è-ml-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤" id="toc-–¥–ª—è-ml-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤"><span
class="toc-section-number">24.5.2</span> ü§ñ –î–ª—è ML-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤</a></li>
<li><a href="#–¥–ª—è-—Ç—Ä–µ–π–¥–µ—Ä–æ–≤" id="toc-–¥–ª—è-—Ç—Ä–µ–π–¥–µ—Ä–æ–≤"><span
class="toc-section-number">24.5.3</span> üí∞ –î–ª—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</a></li>
<li><a href="#–¥–ª—è-–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤"
id="toc-–¥–ª—è-–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤"><span
class="toc-section-number">24.5.4</span> üè¢ –î–ª—è
–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-1"
id="toc-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-1"><span
class="toc-section-number">24.6</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</a>
<ul>
<li><a href="#–≤–µ–¥–µ–Ω–∏–µ-–∑–∞–º–µ—Ç–æ–∫" id="toc-–≤–µ–¥–µ–Ω–∏–µ-–∑–∞–º–µ—Ç–æ–∫"><span
class="toc-section-number">24.6.1</span> üìù –í–µ–¥–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫</a></li>
<li><a href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"
id="toc-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"><span
class="toc-section-number">24.6.2</span> üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ
—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</a></li>
<li><a href="#–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π-–ø–æ–¥—Ö–æ–¥" id="toc-–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π-–ø–æ–¥—Ö–æ–¥"><span
class="toc-section-number">24.6.3</span> üîÑ –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥</a></li>
<li><a href="#–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-—Ü–µ–ª–µ–π" id="toc-–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-—Ü–µ–ª–µ–π"><span
class="toc-section-number">24.6.4</span> üéØ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π</a></li>
</ul></li>
<li><a href="#—Ä–µ—Å—É—Ä—Å—ã-–¥–ª—è-—É–≥–ª—É–±–ª–µ–Ω–∏—è"
id="toc-—Ä–µ—Å—É—Ä—Å—ã-–¥–ª—è-—É–≥–ª—É–±–ª–µ–Ω–∏—è"><span
class="toc-section-number">24.7</span> –†–µ—Å—É—Ä—Å—ã –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–∏—è</a>
<ul>
<li><a href="#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"
id="toc-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"><span
class="toc-section-number">24.7.1</span> üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è
–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</a></li>
<li><a href="#–æ–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã" id="toc-–æ–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã"><span
class="toc-section-number">24.7.2</span> üåê –û–Ω–ª–∞–π–Ω —Ä–µ—Å—É—Ä—Å—ã</a></li>
<li><a href="#—Å–æ–æ–±—â–µ—Å—Ç–≤–æ" id="toc-—Å–æ–æ–±—â–µ—Å—Ç–≤–æ"><span
class="toc-section-number">24.7.3</span> üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-12" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-12"><span
class="toc-section-number">24.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π-–≤-ml-–º–æ–¥–µ–ª—è—Ö"
id="toc-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π-–≤-ml-–º–æ–¥–µ–ª—è—Ö"><span
class="toc-section-number">25</span> –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤ ML-–º–æ–¥–µ–ª—è—Ö</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-7" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-7"><span
class="toc-section-number">25.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#—á—Ç–æ-—Ç–∞–∫–æ–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏-–≤-ml"
id="toc-—á—Ç–æ-—Ç–∞–∫–æ–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏-–≤-ml"><span
class="toc-section-number">25.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ ML?</a>
<ul>
<li><a href="#–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ" id="toc-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"><span
class="toc-section-number">25.2.1</span> –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</a></li>
<li><a href="#—Ç–∏–ø—ã-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π" id="toc-—Ç–∏–ø—ã-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.2.2</span> –¢–∏–ø—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
</ul></li>
<li><a href="#—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.3</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a>
<ul>
<li><a href="#–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞-—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏"
id="toc-–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞-—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">25.3.1</span> 1. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞
—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</a></li>
<li><a href="#–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Ä–∏—Å–∫–∞–º–∏"
id="toc-–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Ä–∏—Å–∫–∞–º–∏"><span
class="toc-section-number">25.3.2</span> 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
—Ä–∏—Å–∫–∞–º–∏</a></li>
<li><a href="#–∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–Ω–∞-–æ—Å–Ω–æ–≤–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-–∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–Ω–∞-–æ—Å–Ω–æ–≤–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.3.3</span> 3. –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–¥—Ä–∏—Ñ—Ç–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–¥—Ä–∏—Ñ—Ç–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.3.4</span> 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–∏—Ñ—Ç–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
</ul></li>
<li><a href="#—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.4</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a>
<ul>
<li><a href="#–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"
id="toc-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"><span
class="toc-section-number">25.4.1</span> 1. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</a></li>
<li><a href="#–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.4.2</span> 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
<li><a href="#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π"
id="toc-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π"><span
class="toc-section-number">25.4.3</span> 3. –ü—Ä–æ–±–ª–µ–º—ã —Å
–∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</a></li>
</ul></li>
<li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.5</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a>
<ul>
<li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"
id="toc-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="toc-section-number">25.5.1</span> 1. –í–∞–ª–∏–¥–∞—Ü–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-2"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-2"><span
class="toc-section-number">25.5.2</span> 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
</ul></li>
<li><a href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-1"
id="toc-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-1"><span
class="toc-section-number">25.6</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</a>
<ul>
<li><a href="#—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"
id="toc-—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"><span
class="toc-section-number">25.6.1</span> 1. –¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</a></li>
<li><a href="#–ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
id="toc-–ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"><span
class="toc-section-number">25.6.2</span> 2. –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ
—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-13" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-13"><span
class="toc-section-number">25.7</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a>
<ul>
<li><a href="#–∫–ª—é—á–µ–≤—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã" id="toc-–∫–ª—é—á–µ–≤—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã"><span
class="toc-section-number">25.7.1</span> –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:</a></li>
</ul></li>
</ul></li>
<li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞---–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"
id="toc-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞---–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="toc-section-number">26</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - –õ—É—á—à–∏–µ
–ø—Ä–∞–∫—Ç–∏–∫–∏</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-8" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-8"><span
class="toc-section-number">26.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞" id="toc-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.2</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
</ul></li>
<li><a href="#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã-–∫–æ—Ç–æ—Ä–∞—è-–¥–∞–µ—Ç-100-–ø—Ä–∏–±—ã–ª–∏-–≤-–º–µ—Å—è—Ü-–∏-–ø—Ä–∏-—ç—Ç–æ–º-–∏–º–µ–µ—Ç-95-—Ç–æ—á–Ω–æ—Å—Ç—å-–∏—Å–ø–æ–ª—å–∑—É—è-–≤—Å–µ-—Å–∞–º—ã–µ-–ª—É—á—à–∏–µ-—Ç–µ—Ö–Ω–∏–∫–∏-–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã-schr-levels-wave2-short3"
id="toc-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã-–∫–æ—Ç–æ—Ä–∞—è-–¥–∞–µ—Ç-100-–ø—Ä–∏–±—ã–ª–∏-–≤-–º–µ—Å—è—Ü-–∏-–ø—Ä–∏-—ç—Ç–æ–º-–∏–º–µ–µ—Ç-95-—Ç–æ—á–Ω–æ—Å—Ç—å-–∏—Å–ø–æ–ª—å–∑—É—è-–≤—Å–µ-—Å–∞–º—ã–µ-–ª—É—á—à–∏–µ-—Ç–µ—Ö–Ω–∏–∫–∏-–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã-schr-levels-wave2-short3"><span
class="toc-section-number">27</span> –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ—Ç–æ—Ä–∞—è –¥–∞–µ—Ç > 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –∏ –ø—Ä–∏ —ç—Ç–æ–º –∏–º–µ–µ—Ç 95% —Ç–æ—á–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ —Å–∞–º—ã–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã SCHR Levels, Wave2, Short3</a>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Å—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤—É—é-—Å–∏—Å—Ç–µ–º—É" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Å—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤—É—é-—Å–∏—Å—Ç–µ–º—É"><span
class="toc-section-number">27.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É</a></li>
<li><a href="#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã" id="toc-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">27.2</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</a></li>
<li><a href="#–∞–ª–≥–æ—Ä–∏—Ç–º-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã" id="toc-–∞–ª–≥–æ—Ä–∏—Ç–º-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">27.3</span> –ê–ª–≥–æ—Ä–∏—Ç–º —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã</a></li>
<li><a href="#ml-–º–æ–¥–µ–ª—å-–¥–ª—è-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è-—Å–∏–≥–Ω–∞–ª–æ–≤" id="toc-ml-–º–æ–¥–µ–ª—å-–¥–ª—è-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è-—Å–∏–≥–Ω–∞–ª–æ–≤"><span
class="toc-section-number">27.4</span> ML-–º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</a></li>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞" id="toc-—Å–∏—Å—Ç–µ–º–∞-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞"><span
class="toc-section-number">27.5</span> –°–∏—Å—Ç–µ–º–∞ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</a></li>
<li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤" id="toc-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="toc-section-number">27.6</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</a></li>
<li><a href="#–±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è" id="toc-–±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="toc-section-number">27.7</span> –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è</a></li>
<li><a href="#—Ä–µ–∞–ª—å–Ω—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã" id="toc-—Ä–µ–∞–ª—å–Ω—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"><span
class="toc-section-number">27.8</span> –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</a></li>
<li><a href="#–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è-—Ç–æ—Ä–≥–æ–≤–ª–∏" id="toc-–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è-—Ç–æ—Ä–≥–æ–≤–ª–∏"><span
class="toc-section-number">27.9</span> –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏</a></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ"><span
class="toc-section-number">27.10</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
<ul>
<li><a href="#–≤–≤–µ–¥–µ–Ω–∏–µ-8" id="toc-–≤–≤–µ–¥–µ–Ω–∏–µ-8"><span
class="toc-section-number">26.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</a></li>
<li><a href="#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
id="toc-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.2</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a>
<ul>
<li><a href="#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
id="toc-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.2.1</span> 1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
<li><a href="#—Å–±–æ—Ä-–º–µ—Ç—Ä–∏–∫" id="toc-—Å–±–æ—Ä-–º–µ—Ç—Ä–∏–∫"><span
class="toc-section-number">26.2.2</span> 2. –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫</a></li>
<li><a href="#—Å–∏—Å—Ç–µ–º–∞-–∞–ª–µ—Ä—Ç–æ–≤" id="toc-—Å–∏—Å—Ç–µ–º–∞-–∞–ª–µ—Ä—Ç–æ–≤"><span
class="toc-section-number">26.2.3</span> 3. –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤</a></li>
<li><a href="#–¥–∞—à–±–æ—Ä–¥-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞" id="toc-–¥–∞—à–±–æ—Ä–¥-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.2.4</span> 4. –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a></li>
<li><a href="#–∞–Ω–∞–ª–∏–∑-–ª–æ–≥–æ–≤" id="toc-–∞–Ω–∞–ª–∏–∑-–ª–æ–≥–æ–≤"><span
class="toc-section-number">26.2.5</span> 5. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤</a></li>
<li><a href="#–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
id="toc-–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="toc-section-number">26.2.6</span> 6. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
<li><a href="#–ø—Ä–æ–≤–µ—Ä–∫–∞-–∑–¥–æ—Ä–æ–≤—å—è-—Å–∏—Å—Ç–µ–º—ã"
id="toc-–ø—Ä–æ–≤–µ—Ä–∫–∞-–∑–¥–æ—Ä–æ–≤—å—è-—Å–∏—Å—Ç–µ–º—ã"><span
class="toc-section-number">26.2.7</span> 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
—Å–∏—Å—Ç–µ–º—ã</a></li>
</ul></li>
<li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
id="toc-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.3</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a>
<ul>
<li><a href="#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–ª–µ—Ä—Ç–æ–≤" id="toc-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–ª–µ—Ä—Ç–æ–≤"><span
class="toc-section-number">26.3.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤</a></li>
<li><a href="#—Ä–æ—Ç–∞—Ü–∏—è-–ª–æ–≥–æ–≤" id="toc-—Ä–æ—Ç–∞—Ü–∏—è-–ª–æ–≥–æ–≤"><span
class="toc-section-number">26.3.2</span> 2. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤</a></li>
<li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"
id="toc-–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"><span
class="toc-section-number">26.3.3</span> 3. –ú–µ—Ç—Ä–∏–∫–∏
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</a></li>
</ul></li>
<li><a href="#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
id="toc-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="toc-section-number">26.4</span> –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</a>
<ul>
<li><a href="#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–¥–µ–π—Å—Ç–≤–∏—è"
id="toc-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–¥–µ–π—Å—Ç–≤–∏—è"><span
class="toc-section-number">26.4.1</span> 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ
–¥–µ–π—Å—Ç–≤–∏—è</a></li>
<li><a href="#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–≤–Ω–µ—à–Ω–∏–º–∏-—Å–∏—Å—Ç–µ–º–∞–º–∏"
id="toc-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–≤–Ω–µ—à–Ω–∏–º–∏-—Å–∏—Å—Ç–µ–º–∞–º–∏"><span
class="toc-section-number">26.4.2</span> 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏
—Å–∏—Å—Ç–µ–º–∞–º–∏</a></li>
</ul></li>
<li><a href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-14" id="toc-–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-14"><span
class="toc-section-number">26.5</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1"
id="automl-gluon---–ø–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"><span
class="header-section-number">1</span> AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ AutoML Gluon -
–º–æ—â–Ω–æ–º—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –æ—Ç
Amazon.</p>

<h2 data-number="1.0" id="–ø–æ—á–µ–º—É-–∏–º–µ–Ω–Ω–æ-automl-gluon"><span class="header-section-number">1.0</span> –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ AutoML Gluon?</h2>

<p><strong>–ü–æ—á–µ–º—É –º—ã –≤—ã–±—Ä–∞–ª–∏ AutoML Gluon —Å—Ä–µ–¥–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥—Ä—É–≥–∏—Ö —Ä–µ—à–µ–Ω–∏–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –µ—â–µ –æ–¥–∏–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ ML-–ø–æ–¥—Ö–æ–¥–∞.</p>

<h3 data-number="1.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ-ml"><span class="header-section-number">1.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ ML</h3>

<p><strong>–ü–æ—á–µ–º—É 90% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –∏–º–µ–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:</p>

<ul>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</strong> –°—É—â–µ—Å—Ç–≤—É–µ—Ç 100+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ML, –∏ –≤—ã–±–æ—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ 30-50%</li>
<li><strong>–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong> –¢—Ä–µ–±—É–µ—Ç —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã –∏ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–µ—Å—è—Ü—ã</li>
<li><strong>–ü—Ä–æ–±–ª–µ–º–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:</strong> 70% –º–æ–¥–µ–ª–µ–π –ø–µ—Ä–µ–æ–±—É—á–∞—é—Ç—Å—è –∏ –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:</strong> –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–µ:</strong> –ù—É–∂–Ω—ã –≥–æ–¥—ã –æ–ø—ã—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
</ul>

<h3 data-number="1.0.2" id="–∫–∞–∫-automl-gluon-—Ä–µ—à–∞–µ—Ç-—ç—Ç–∏-–ø—Ä–æ–±–ª–µ–º—ã"><span class="header-section-number">1.0.2</span> –ö–∞–∫ AutoML Gluon —Ä–µ—à–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã</h3>

<p><strong>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç AutoML Gluon –æ—Å–æ–±–µ–Ω–Ω—ã–º?</strong> –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π, –æ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ –¥–µ–ø–ª–æ—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω:</p>

<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</strong> –¢–µ—Å—Ç–∏—Ä—É–µ—Ç 20+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –¥–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
<li><strong>–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
<li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</strong> –°–æ–∑–¥–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–∂–µ –Ω–∞ –º–∞–ª—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö</li>
<li><strong>–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–ª—è –≤—Å–µ—Ö:</strong> –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–∏—Ö –∑–Ω–∞–Ω–∏–π ML</li>
</ul>

<h3 data-number="1.0.3" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-automl-gluon"><span class="header-section-number">1.0.3</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ AutoML Gluon</h3>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ –µ–¥–∏–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É:</p>

<ul>
<li><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> –°–æ–∑–¥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ä—É—á–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> –ß–∞—Å—Ç–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –º–æ–¥–µ–ª–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –†–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –û–±—ä—è—Å–Ω—è–µ—Ç, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</strong> –í—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</li>
</ul>

<h2 data-number="1.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-automl-gluon-–¥–µ—Ç–∞–ª—å–Ω–æ"><span class="header-section-number">1.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ AutoML Gluon - –¥–µ—Ç–∞–ª—å–Ω–æ</h2>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–µ—â–µ –æ–¥–∏–Ω AutoML"?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏:</p>

<h3 data-number="1.1.1" id="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-automl-gluon"><span class="header-section-number">1.1.1</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AutoML Gluon</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–∏–±–∫–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</p>

<ul>
<li><strong>–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:</strong> –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ</li>
<li><strong>–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:</strong> –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –º–µ—Ç–æ–¥—ã</li>
<li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ ML-—Å—Ç–µ–∫–∞–º–∏</li>
</ul>

<h3 data-number="1.1.2" id="–∫–ª—é—á–µ–≤—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã"><span class="header-section-number">1.1.2</span> –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤–µ—Å—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª ML-–ø—Ä–æ–µ–∫—Ç–∞:</p>

<ul>
<li><strong>TabularPredictor:</strong> –î–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö - 80% –≤—Å–µ—Ö ML-–∑–∞–¥–∞—á</li>
<li><strong>TimeSeriesPredictor:</strong> –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>ImagePredictor:</strong> –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - —Ä–∞—Å—Ç—É—â–∏–π —Å–µ–≥–º–µ–Ω—Ç ML</li>
<li><strong>TextPredictor:</strong> –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - NLP –∑–∞–¥–∞—á–∏</li>
</ul>

<h2 data-number="1.2" id="–¥–ª—è-–∫–æ–≥–æ-—ç—Ç–æ—Ç-–º–∞–Ω—É–∞–ª-–¥–µ—Ç–∞–ª—å–Ω–æ"><span class="header-section-number">1.2</span> –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –º–∞–Ω—É–∞–ª - –¥–µ—Ç–∞–ª—å–Ω–æ</h2>

<p><strong>–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –º–∞–Ω—É–∞–ª –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–ª–∏ –µ–≥–æ —Ç–∞–∫, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –º–æ–≥ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:</p>

<h3 data-number="1.2.1" id="–Ω–∞—á–∏–Ω–∞—é—â–∏–µ-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏"><span class="header-section-number">1.2.1</span> –ù–∞—á–∏–Ω–∞—é—â–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞—é—â–∏–º —Å—Ç–æ–∏—Ç –∏–∑—É—á–∞—Ç—å AutoML Gluon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –≤–æ–π—Ç–∏ –≤ –º–∏—Ä –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:</p>

<ul>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:</strong> –ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å –∑–∞ 10 –º–∏–Ω—É—Ç</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–ø—ã—Ç:</strong> –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è</li>
<li><strong>–ü–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Å–Ω–æ–≤:</strong> –ò–∑—É—á–µ–Ω–∏–µ ML —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É</li>
<li><strong>–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ:</strong> –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è —Ä–µ–∑—é–º–µ</li>
</ul>

<h3 data-number="1.2.2" id="–æ–ø—ã—Ç–Ω—ã–µ-ml-–∏–Ω–∂–µ–Ω–µ—Ä—ã"><span class="header-section-number">1.2.2</span> –û–ø—ã—Ç–Ω—ã–µ ML-–∏–Ω–∂–µ–Ω–µ—Ä—ã</h3>

<p><strong>–ü–æ—á–µ–º—É –æ–ø—ã—Ç–Ω—ã–º –∏–Ω–∂–µ–Ω–µ—Ä–∞–º –Ω—É–∂–µ–Ω AutoML Gluon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —É—Å–∫–æ—Ä—è–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö:</p>

<ul>
<li><strong>–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–π –∑–∞ –º–∏–Ω—É—Ç—ã</li>
<li><strong>–ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥:</strong> –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä—É—á–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:</strong> –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∏–Ω–Ω–æ–≤–∞—Ü–∏–π</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ ML –≤ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö</li>
</ul>

<h3 data-number="1.2.3" id="–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏"><span class="header-section-number">1.2.3</span> –ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –Ω—É–∂–µ–Ω AutoML Gluon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å ML –±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:</p>

<ul>
<li><strong>–ë–µ–∑ –∫–æ–¥–∞:</strong> –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</li>
<li><strong>–ë—ã—Å—Ç—Ä—ã–µ –∏–Ω—Å–∞–π—Ç—ã:</strong> –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞ —á–∞—Å—ã, –∞ –Ω–µ –º–µ—Å—è—Ü—ã</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:</strong> –õ–µ–≥–∫–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã</li>
</ul>
<h2 data-number="1.1" id="—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ"><span
class="header-section-number">1.1</span> –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</h2>
<ol type="1">
<li><a href="./01_installation.md">–í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</a></li>
<li><a href="./02_basic_usage.md">–ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</a></li>
<li><a href="./03_advanced_configuration.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</a></li>
<li><a href="./04_metrics.md">–ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
<li><a href="./05_validation.md">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</a></li>
<li><a href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</a></li>
<li><a href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</a></li>
<li><a href="./08_best_practices.md">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</a></li>
<li><a href="./09_examples.md">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="./10_troubleshooting.md">Troubleshooting</a></li>
<li><a href="./11_apple_silicon_optimization.md">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple
Silicon</a></li>
<li><a href="./12_simple_production_example.md">–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
<li><a href="./13_advanced_production_example.md">–°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
<li><a href="./14_theory_and_fundamentals.md">–¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã
AutoML</a></li>
<li><a
href="./15_interpretability_and_explainability.md">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏
–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</a></li>
<li><a href="./16_advanced_topics.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</a></li>
<li><a href="./17_ethics_and_responsible_ai.md">–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π
AI</a></li>
<li><a href="./18_case_studies.md">–ö–µ–π—Å-—Å—Ç–∞–¥–∏</a></li>
<li><a href="./19_wave2_indicator_analysis.md">WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π
–∞–Ω–∞–ª–∏–∑</a></li>
<li><a href="./20_schr_levels_analysis.md">SCHR Levels - –ê–Ω–∞–ª–∏–∑ –∏
ML-–º–æ–¥–µ–ª—å</a></li>
<li><a href="./21_schr_short3_analysis.md">SCHR SHORT3 - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</a></li>
<li><a href="./22_super_system_ultimate.md">–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
–≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</a></li>
<li><a href="./23_reading_guide.md">–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é
—É—á–µ–±–Ω–∏–∫–∞</a></li>
<li><a href="./24_probability_usage_guide.md">–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
<li><a href="./25_trading_bot_monitoring.md">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ -
–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</a></li>
</ol>
<h2 data-number="1.2" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-automl-gluon"><span
class="header-section-number">1.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ AutoML Gluon?</h2>
<p>AutoML Gluon - —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Amazon Web Services –¥–ª—è
–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:</p>
<ul>
<li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞—Ç—å –ª—É—á—à–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li>–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞</li>
<li>–°–æ–∑–¥–∞–≤–∞—Ç—å –∞–Ω—Å–∞–º–±–ª–∏ –º–æ–¥–µ–ª–µ–π</li>
<li>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Ç–∞–±–ª–∏—á–Ω—ã–µ, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã,
–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ç–µ–∫—Å—Ç)</li>
<li>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö</li>
</ul>
<h2 data-number="1.3" id="–∫–ª—é—á–µ–≤—ã–µ-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏"><span
class="header-section-number">1.3</span> –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</h2>
<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏</strong>: Gluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
<li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</strong>: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç
–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
<li><strong>–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∏
–∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</strong>: –ü–æ–¥–¥–µ—Ä–∂–∫–∞
—Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞ CPU, —Ç–∞–∫ –∏ –Ω–∞
GPU</li>
<li><strong>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AWS</strong>: –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏
—Å–µ—Ä–≤–∏—Å–∞–º–∏ Amazon</li>
</ul>
<h2 data-number="1.4" id="–¥–ª—è-–∫–æ–≥–æ-—ç—Ç–æ—Ç-–º–∞–Ω—É–∞–ª"><span
class="header-section-number">1.4</span> –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –º–∞–Ω—É–∞–ª?</h2>
<p>–≠—Ç–æ—Ç –º–∞–Ω—É–∞–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è: - Data Scientists, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç
—É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π - ML Engineers, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å
–ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º–∞–º–∏ - –ê–Ω–∞–ª–∏—Ç–∏–∫–æ–≤, –∏–∑—É—á–∞—é—â–∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ
–æ–±—É—á–µ–Ω–∏–µ - –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—â–∏—Ö ML –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
<h2 data-number="1.5" id="–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">1.5</span> –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>
<ul>
<li>Python 3.7+</li>
<li>–ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li>–ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –º–µ—Ç—Ä–∏–∫</li>
<li>–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å pandas –∏ numpy (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</li>
</ul>
<h2 data-number="1.6" id="—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-—Ä–∞–∑–¥–µ–ª—ã"><span
class="header-section-number">1.6</span> –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã</h2>
<h3 data-number="1.6.1" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="header-section-number">1.6.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple
Silicon</h3>
<p>–†–∞–∑–¥–µ–ª <a
href="./11_apple_silicon_optimization.md">11_apple_silicon_optimization.md</a>
—Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è: - <strong>MLX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</strong> -
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Apple MLX —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è - <strong>Ray
–Ω–∞—Å—Ç—Ä–æ–π–∫–∞</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ Apple Silicon -
<strong>OpenMP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</strong> - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å
–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é - <strong>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</strong> -
–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Apple Silicon - <strong>MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ</strong>
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Metal Performance Shaders - <strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong> - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ Apple
Silicon</p>
<h3 data-number="1.6.2" id="–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">1.6.2</span> –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<p>–†–∞–∑–¥–µ–ª—ã <a
href="./12_simple_production_example.md">12_simple_production_example.md</a>
–∏ <a
href="./13_advanced_production_example.md">13_advanced_production_example.md</a>
—Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–±–∞—Å—Ç–Ω—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π:</p>
<h4 data-number="1.6.2.1" id="–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-—Ä–∞–∑–¥–µ–ª-12"><span
class="header-section-number">1.6.2.1</span> –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä (–†–∞–∑–¥–µ–ª
12):</h4>
<ul>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong> - –æ—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∑–∞ 2
–Ω–µ–¥–µ–ª–∏</li>
<li><strong>–ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</strong> - ML –º–æ–¥–µ–ª—å + API + Docker +
DEX</li>
<li><strong>–ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</strong> - backtest, walk-forward,
monte-carlo</li>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π</strong> - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</li>
<li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç</strong>: 72.3% —Ç–æ—á–Ω–æ—Å—Ç—å, 1.45 Sharpe, 23.7%
–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</li>
</ul>
<h4 data-number="1.6.2.2" id="—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Ä–∞–∑–¥–µ–ª-13"><span
class="header-section-number">1.6.2.2</span> –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä (–†–∞–∑–¥–µ–ª
13):</h4>
<ul>
<li><strong>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</strong> - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –∞–Ω—Å–∞–º–±–ª–∏,
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</li>
<li><strong>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏</strong> - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã,
–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –æ–±—ä–µ–º, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</li>
<li><strong>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</strong> - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π backtest,
advanced walk-forward</li>
<li><strong>Kubernetes –¥–µ–ø–ª–æ–π</strong> - –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç</strong>: 78.5% —Ç–æ—á–Ω–æ—Å—Ç—å, 2.1 Sharpe, 34.2%
–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</li>
</ul>
<h3 data-number="1.6.3" id="—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã-—Ä–∞–∑–¥–µ–ª-14"><span
class="header-section-number">1.6.3</span> –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã (–†–∞–∑–¥–µ–ª
14):</h3>
<ul>
<li><strong>Neural Architecture Search</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π</li>
<li><strong>Hyperparameter Optimization</strong> - –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
<li><strong>Meta-Learning</strong> - –æ–±—É—á–µ–Ω–∏–µ —Ç–æ–º—É, –∫–∞–∫ —É—á–∏—Ç—å—Å—è</li>
<li><strong>Ensemble Methods</strong> - –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>Mathematical Foundations</strong> - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã
AutoML</li>
</ul>
<h3 data-number="1.6.4" id="–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-—Ä–∞–∑–¥–µ–ª-15"><span
class="header-section-number">1.6.4</span> –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–†–∞–∑–¥–µ–ª
15):</h3>
<ul>
<li><strong>–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤
—Ü–µ–ª–æ–º</li>
<li><strong>–õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
<li><strong>SHAP –∏ LIME</strong> - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—ä—è—Å–Ω–µ–Ω–∏—è</li>
<li><strong>Feature Importance</strong> - –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
<li><strong>Model-specific Interpretability</strong> - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è
AutoML Gluon –º–µ—Ç–æ–¥—ã</li>
</ul>
<h3 data-number="1.6.5" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-—Ä–∞–∑–¥–µ–ª-16"><span
class="header-section-number">1.6.5</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã (–†–∞–∑–¥–µ–ª
16):</h3>
<ul>
<li><strong>Neural Architecture Search</strong> - DARTS, ENAS,
Progressive NAS</li>
<li><strong>Meta-Learning</strong> - MAML, Prototypical Networks</li>
<li><strong>Multi-Modal Learning</strong> - —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
–¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>Federated Learning</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å
–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å—é</li>
<li><strong>Continual Learning</strong> - –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</li>
<li><strong>Quantum Machine Learning</strong> - –∫–≤–∞–Ω—Ç–æ–≤—ã–µ
–≤—ã—á–∏—Å–ª–µ–Ω–∏—è</li>
</ul>
<h3 data-number="1.6.6" id="—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai-—Ä–∞–∑–¥–µ–ª-17"><span
class="header-section-number">1.6.6</span> –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI
(–†–∞–∑–¥–µ–ª 17):</h3>
<ul>
<li><strong>–ü—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ AI</strong> - —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å,
–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å, –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</li>
<li><strong>–ü—Ä–∞–≤–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</strong> - GDPR, AI Act, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
—Ä–µ–≥—É–ª—è—Ü–∏—è–º</li>
<li><strong>Bias Detection</strong> - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ
—Å–º–µ—â–µ–Ω–∏–π</li>
<li><strong>Responsible AI Framework</strong> - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ
AI</li>
<li><strong>Ethics Checklist</strong> - —á–µ–∫–ª–∏—Å—Ç —ç—Ç–∏—á–Ω–æ—Å—Ç–∏ AI —Å–∏—Å—Ç–µ–º</li>
</ul>
<h3 data-number="1.6.7" id="–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–∞–∑–¥–µ–ª-18"><span
class="header-section-number">1.6.7</span> –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–†–∞–∑–¥–µ–ª 18):</h3>
<ul>
<li><strong>–§–∏–Ω–∞–Ω—Å—ã</strong> - –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ —Å 87.3% —Ç–æ—á–Ω–æ—Å—Ç—å—é</li>
<li><strong>–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</strong> - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∏–∞–±–µ—Ç–∞ —Å 91.2%
—Ç–æ—á–Ω–æ—Å—Ç—å—é</li>
<li><strong>E-commerce</strong> - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å 18% —Ä–æ—Å—Ç–æ–º
–∫–æ–Ω–≤–µ—Ä—Å–∏–∏</li>
<li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</strong> - –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å 45%
—Å–Ω–∏–∂–µ–Ω–∏–µ–º –ø—Ä–æ—Å—Ç–æ–µ–≤</li>
</ul>
<hr />
<p><em>–≠—Ç–æ—Ç –º–∞–Ω—É–∞–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤—Å–µ–º –∞—Å–ø–µ–∫—Ç–∞–º
—Ä–∞–±–æ—Ç—ã —Å AutoML Gluon, –æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è, –≤–∫–ª—é—á–∞—è
—Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è Apple Silicon.</em></p>
<hr />
<h1 data-number="2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-automl-gluon"><span
class="header-section-number">2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>

<h2 data-number="2.0" id="–ø–æ—á–µ–º—É-–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∫—Ä–∏—Ç–∏—á–Ω–∞"><span class="header-section-number">2.0</span> –ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞</h2>

<p><strong>–ü–æ—á–µ–º—É 70% –ø—Ä–æ–±–ª–µ–º —Å AutoML Gluon —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∏ –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ –æ—à–∏–±–∫–∏ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–µ—Ä—å–µ–∑–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º –≤ —Ä–∞–±–æ—Ç–µ.</p>

<h3 data-number="2.0.1" id="–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è-–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span class="header-section-number">2.0.1</span> –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å:</p>

<ul>
<li><strong>–û—à–∏–±–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:</strong> –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫ –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é:</strong> –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤ 10-100 —Ä–∞–∑</li>
<li><strong>–û—à–∏–±–∫–∏ –ø–∞–º—è—Ç–∏:</strong> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ö–≤–∞—Ç–∫–µ RAM</li>
<li><strong>–ü—Ä–æ–±–ª–µ–º—ã —Å GPU:</strong> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ CUDA –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å GPU –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏:</strong> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Å–ª–æ–∂–Ω—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</li>
</ul>

<h3 data-number="2.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span class="header-section-number">2.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ —Å–±–æ–µ–≤</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> –†–∞–±–æ—Ç–∞ —Å–æ –≤—Å–µ–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:</strong> –õ–µ–≥–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π</li>
</ul>

<h2 data-number="2.1" id="—Å–∏—Å—Ç–µ–º–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">2.1</span> –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon - —ç—Ç–æ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–∂–µ—Ç —Å–µ—Ä—å–µ–∑–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.</p>

<p><img src="images/installation_flowchart.png"
alt="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon" /> <em>–†–∏—Å—É–Ω–æ–∫ 1: –ë–ª–æ–∫-—Å—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
—É—Å—Ç–∞–Ω–æ–≤–∫–∏ AutoML Gluon</em></p>
<h3 data-number="2.1.1" id="–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">2.1.1</span> –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å AutoML Gluon, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.</p>

<p><strong>–ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:</strong></p>
<ul>
<li>–°–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –º–∞–ª—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö (< 10,000 —Å—Ç—Ä–æ–∫)</li>
<li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li>–†–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã</li>
</ul>

<p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:</strong></p>
<ul>
<li>–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
<li>–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU</li>
<li>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è</li>
</ul>

<ul>
<li><strong>Python</strong>: 3.7, 3.8, 3.9, 3.10, 3.11
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –≤–µ—Ä—Å–∏–∏:</strong> –û–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏–º–µ—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É</li>
        <li><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> Python 3.9+ –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ ML-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏</li>
    </ul>
</li>
<li><strong>–û–°</strong>: Linux, macOS, Windows
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–∏ –û–°:</strong> –û–Ω–∏ –∏–º–µ—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É Python –∏ ML-–±–∏–±–ª–∏–æ—Ç–µ–∫</li>
        <li><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> Linux –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, macOS –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</li>
    </ul>
</li>
<li><strong>RAM</strong>: 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB+)
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 4GB –º–∏–Ω–∏–º—É–º:</strong> AutoML Gluon –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ –ø–∞–º—è—Ç—å –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
        <li><strong>–ü–æ—á–µ–º—É 8GB+ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong> –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω—Å–∞–º–±–ª–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–µ RAM:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –≤ 10+ —Ä–∞–∑ –±–æ–ª—å—à–µ</li>
    </ul>
</li>
<li><strong>CPU</strong>: 2 —è–¥—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4+ —è–¥—Ä–∞)
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 2 —è–¥—Ä–∞ –º–∏–Ω–∏–º—É–º:</strong> AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
        <li><strong>–ü–æ—á–µ–º—É 4+ —è–¥—Ä–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong> –ö–∞–∂–¥–æ–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —è–¥—Ä–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ 20-30%</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–µ —è–¥–µ—Ä:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∑–∞ —Ä–∞–∑—É–º–Ω–æ–µ –≤—Ä–µ–º—è</li>
    </ul>
</li>
<li><strong>–î–∏—Å–∫</strong>: 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 2GB –º–∏–Ω–∏–º—É–º:</strong> –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</li>
        <li><strong>–ü–æ—á–µ–º—É –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –ª—É—á—à–µ:</strong> –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞:</strong> –ë—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏ –º–µ–Ω—å—à–µ –æ—á–∏—Å—Ç–æ–∫ –∫—ç—à–∞</li>
    </ul>
</li>
</ul>

<h3 data-number="2.1.2" id="—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">2.1.2</span> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å AutoML Gluon –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.</p>

<p><strong>–ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:</strong></p>
<ul>
<li>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (1M+ —Å—Ç—Ä–æ–∫) –∑–∞ —Ä–∞–∑—É–º–Ω–æ–µ –≤—Ä–µ–º—è</li>
<li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li>–°–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–∏ –º–æ–¥–µ–ª–µ–π</li>
<li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è</li>
<li>–†–∞–±–æ—Ç–∞—Ç—å —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</li>
</ul>

<ul>
<li><strong>Python</strong>: 3.9 –∏–ª–∏ 3.10
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –≤–µ—Ä—Å–∏–∏:</strong> –û–Ω–∏ –∏–º–µ—é—Ç –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –Ω–∞ 15-20% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–æ–ª–µ–µ —Å—Ç–∞—Ä—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏</li>
        <li><strong>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö ML-–±–∏–±–ª–∏–æ—Ç–µ–∫</li>
    </ul>
</li>
<li><strong>RAM</strong>: 16GB+
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 16GB+:</strong> –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤ –ø–∞–º—è—Ç—å –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã —Ü–µ–ª–∏–∫–æ–º</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –≤ 100+ —Ä–∞–∑ –±–æ–ª—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö</li>
        <li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–∫–∞—á–∫–∏ –Ω–∞ –¥–∏—Å–∫ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –≤ 5-10 —Ä–∞–∑</li>
    </ul>
</li>
<li><strong>CPU</strong>: 8+ —è–¥–µ—Ä
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 8+ —è–¥–µ—Ä:</strong> AutoML Gluon –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ 16 —è–¥–µ—Ä –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è –≤ 4-8 —Ä–∞–∑ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏</li>
        <li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∑–∞ —á–∞—Å—ã, –∞ –Ω–µ –¥–Ω–∏</li>
    </ul>
</li>
<li><strong>GPU</strong>: NVIDIA GPU —Å CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    <ul>
        <li><strong>–ü–æ—á–µ–º—É GPU –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:</strong> –ù–µ –≤—Å–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã AutoML Gluon –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç GPU</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç GPU:</strong> –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ 10-50 —Ä–∞–∑</li>
        <li><strong>–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω GPU:</strong> –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≥–ª—É–±–æ–∫–∏–º –æ–±—É—á–µ–Ω–∏–µ–º –∏ –±–æ–ª—å—à–∏–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏</li>
        <li><strong>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</strong> CUDA 11.0+, 4GB+ –≤–∏–¥–µ–æ–ø–∞–º—è—Ç–∏</li>
    </ul>
</li>
<li><strong>–î–∏—Å–∫</strong>: 10GB+ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 10GB+:</strong> –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞:</strong> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–µ–π</li>
        <li><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> SSD –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º</li>
    </ul>
</li>
</ul>

<h3 data-number="2.1.3" id="–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">2.1.3</span> –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ü–æ—á–µ–º—É –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω—ã –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ 24/7 –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö.</p>

<ul>
<li><strong>RAM</strong>: 32GB+ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤</li>
<li><strong>CPU</strong>: 16+ —è–¥–µ—Ä –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏</li>
<li><strong>GPU</strong>: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ GPU –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è</li>
<li><strong>–î–∏—Å–∫</strong>: NVMe SSD –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º</li>
<li><strong>–°–µ—Ç—å</strong>: –í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<h2 data-number="2.2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-pip"><span
class="header-section-number">2.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip</h2>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º –∏–º–µ–Ω–Ω–æ —Å pip?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–∏ AutoML Gluon, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>

<h3 data-number="2.2.1" id="–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞"><span
class="header-section-number">2.2.1</span> –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã AutoML Gluon –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.</p>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ:</strong></p>
<ul>
<li>–°–∫–∞—á–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</li>
<li>–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</li>
<li>–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã</li>
<li>–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π</li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon</span></code></pre></div>
<h3 data-number="2.2.2"
id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"><span
class="header-section-number">2.2.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon - —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∏ –≤—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –Ω—É–∂–Ω—ã.</p>

<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–¥—É–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:</strong></p>
<ul>
<li><strong>–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞:</strong> –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ</li>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:</strong> –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π = –±—ã—Å—Ç—Ä–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–ú–µ–Ω—å—à–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:</strong> –°–Ω–∏–∂–∞–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π</li>
<li><strong>–ì–∏–±–∫–æ—Å—Ç—å:</strong> –ú–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
</ul>

<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon.tabular</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon.timeseries</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon.vision</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon.text</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon<span class="pp">[</span><span class="ss">all</span><span class="pp">]</span></span></code></pre></div>

<h4 data-number="2.2.2.1" id="–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"><span class="header-section-number">2.2.2.1</span> –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏:</p>

<ul>
<li><strong>autogluon.tabular</strong> - –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω:</strong> 80% –≤—Å–µ—Ö ML-–∑–∞–¥–∞—á —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
        <li><strong>–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–µ–≥—Ä–µ—Å—Å–∏—è, –∞–Ω—Å–∞–º–±–ª–∏</li>
        <li><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á</li>
    </ul>
</li>

<li><strong>autogluon.timeseries</strong> - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω:</strong> –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
        <li><strong>–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:</strong> –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å, —Ç—Ä–µ–Ω–¥—ã</li>
        <li><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –î–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–¥–∞–∂, –º–µ—Ç—Ä–∏–∫</li>
    </ul>
</li>

<li><strong>autogluon.vision</strong> - –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω:</strong> –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è</li>
        <li><strong>–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤</li>
        <li><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</li>
    </ul>
</li>

<li><strong>autogluon.text</strong> - –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω:</strong> –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è NLP</li>
        <li><strong>–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:</strong> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞, –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</li>
        <li><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤, —á–∞—Ç-–±–æ—Ç–æ–≤, –ø–µ—Ä–µ–≤–æ–¥–æ–≤</li>
    </ul>
</li>
</ul>

<h2 data-number="2.3" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—á–µ—Ä–µ–∑-conda"><span
class="header-section-number">2.3</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ conda</h2>
<h3 data-number="2.3.1" id="—Å–æ–∑–¥–∞–Ω–∏–µ-–Ω–æ–≤–æ–≥–æ-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="header-section-number">2.3.1</span> –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
–æ–∫—Ä—É–∂–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å Python 3.9</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> autogluon python=3.9</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate autogluon</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge autogluon</span></code></pre></div>
<h3 data-number="2.3.2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-gpu-–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π"><span
class="header-section-number">2.3.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å GPU
–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å CUDA</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> autogluon-gpu python=3.9</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate autogluon-gpu</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install pytorch torchvision torchaudio pytorch-cuda=11.8 <span class="at">-c</span> pytorch <span class="at">-c</span> nvidia</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon</span></code></pre></div>
<h2 data-number="2.4" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏–∑-–∏—Å—Ö–æ–¥–Ω–æ–≥–æ-–∫–æ–¥–∞"><span
class="header-section-number">2.4</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ
–∫–æ–¥–∞</h2>
<h3 data-number="2.4.1" id="–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"><span
class="header-section-number">2.4.1</span> –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/autogluon/autogluon.git</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> autogluon</span></code></pre></div>
<h3 data-number="2.4.2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–≤-—Ä–µ–∂–∏–º–µ-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"><span
class="header-section-number">2.4.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ
—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-e</span> .</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-e</span> ./tabular</span></code></pre></div>
<h2 data-number="2.5" id="–ø—Ä–æ–≤–µ—Ä–∫–∞-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="header-section-number">2.5</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h2>
<h3 data-number="2.5.1" id="–±–∞–∑–æ–≤—ã–π-—Ç–µ—Å—Ç"><span
class="header-section-number">2.5.1</span> –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;AutoGluon version: </span><span class="sc">{</span>ag<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –¢–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.timeseries <span class="im">import</span> TimeSeriesPredictor</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.vision <span class="im">import</span> ImagePredictor</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.text <span class="im">import</span> TextPredictor</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;All modules imported successfully!&quot;</span>)</span></code></pre></div>
<h3 data-number="2.5.2" id="—Ç–µ—Å—Ç-—Å-–ø—Ä–æ—Å—Ç—ã–º-–ø—Ä–∏–º–µ—Ä–æ–º"><span
class="header-section-number">2.5.2</span> –¢–µ—Å—Ç —Å –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∏–º–µ—Ä–æ–º</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;feature1&#39;</span>: np.random.randn(<span class="dv">100</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;feature2&#39;</span>: np.random.randn(<span class="dv">100</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;target&#39;</span>: np.random.randint(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># –¢–µ—Å—Ç –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>predictor.fit(data, time_limit<span class="op">=</span><span class="dv">10</span>)  <span class="co"># 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Installation test passed!&quot;</span>)</span></code></pre></div>
<h2 data-number="2.6" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"><span
class="header-section-number">2.6</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö
–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h2>
<h3 data-number="2.6.1" id="–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-gpu"><span
class="header-section-number">2.6.1</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ CUDA toolkit (Ubuntu/Debian)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv cuda-ubuntu2004.pin /etc/apt/preferences.d/cuda-repository-pin-600</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda-repository-ubuntu2004-11-8-local_11.8.0-520.61.05-1_amd64.deb</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dpkg <span class="at">-i</span> cuda-repository-ubuntu2004-11-8-local_11.8.0-520.61.05-1_amd64.deb</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-key add /var/cuda-repository-ubuntu2004-11-8-local/7fa2af80.pub</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">-y</span> install cuda</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torch torchvision torchaudio <span class="at">--index-url</span> https://download.pytorch.org/whl/cu118</span></code></pre></div>
<h3 data-number="2.6.2" id="–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏"><span
class="header-section-number">2.6.2</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏
–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install dask<span class="pp">[</span><span class="ss">complete</span><span class="pp">]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install ray<span class="pp">[</span><span class="ss">default</span><span class="pp">]</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install modin<span class="pp">[</span><span class="ss">all</span><span class="pp">]</span></span></code></pre></div>
<h3 data-number="2.6.3" id="–¥–ª—è-—Ä–∞–±–æ—Ç—ã-—Å-–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏-—Ä—è–¥–∞–º–∏"><span
class="header-section-number">2.6.3</span> –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏
—Ä—è–¥–∞–º–∏</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install gluonts</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mxnet</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install statsmodels</span></code></pre></div>
<h2 data-number="2.7" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="header-section-number">2.7</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h2>
<h3 data-number="2.7.1" id="–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è"><span
class="header-section-number">2.7.1</span> –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">OMP_NUM_THREADS</span><span class="op">=</span>4</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">MKL_NUM_THREADS</span><span class="op">=</span>4</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">OPENBLAS_NUM_THREADS</span><span class="op">=</span>4</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è GPU</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CUDA_VISIBLE_DEVICES</span><span class="op">=</span>0</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –æ—Ç–ª–∞–¥–∫–∏</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">AUTOGLUON_DEBUG</span><span class="op">=</span>1</span></code></pre></div>
<h3 data-number="2.7.2" id="–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π-—Ñ–∞–π–ª"><span
class="header-section-number">2.7.2</span> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª</h3>
<p>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª <code>~/.autogluon/config.yaml</code>:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoGluon</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">time_limit</span><span class="kw">:</span><span class="at"> </span><span class="dv">3600</span><span class="co">  # 1 —á–∞—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">memory_limit</span><span class="kw">:</span><span class="at"> </span><span class="dv">8</span><span class="co">  # 8GB RAM</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">num_cpus</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span><span class="co">  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">num_gpus</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span><span class="co">  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tabular</span><span class="kw">:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">presets</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&#39;best_quality&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;high_quality&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;good_quality&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;medium_quality&#39;</span><span class="kw">,</span><span class="at"> </span><span class="st">&#39;optimize_for_deployment&#39;</span><span class="kw">]</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">hyperparameter_tune_kwargs</span><span class="kw">:</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">num_trials</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">scheduler</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;local&#39;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">searcher</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;auto&#39;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">timeseries</span><span class="kw">:</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">prediction_length</span><span class="kw">:</span><span class="at"> </span><span class="dv">24</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">freq</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;H&#39;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">target_column</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;target&#39;</span></span></code></pre></div>
<h2 data-number="2.8" id="—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º-–ø—Ä–∏-—É—Å—Ç–∞–Ω–æ–≤–∫–µ"><span
class="header-section-number">2.8</span> –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏
—É—Å—Ç–∞–Ω–æ–≤–∫–µ</h2>
<h3 data-number="2.8.1" id="–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏"><span
class="header-section-number">2.8.1</span> –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</h3>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ pip</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> cache purge</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫—ç—à–∞</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--no-cache-dir</span> autogluon</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon==0.8.2</span></code></pre></div>
<h3 data-number="2.8.2" id="–ø—Ä–æ–±–ª–µ–º—ã-—Å-cuda"><span
class="header-section-number">2.8.2</span> –ü—Ä–æ–±–ª–µ–º—ã —Å CUDA</h3>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ CUDA</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nvidia-smi</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ PyTorch</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-c</span> <span class="st">&quot;import torch; print(torch.cuda.is_available())&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ PyTorch</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torch==1.13.1+cu117 torchvision==0.14.1+cu117 <span class="at">--extra-index-url</span> https://download.pytorch.org/whl/cu117</span></code></pre></div>
<h3 data-number="2.8.3" id="–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é"><span
class="header-section-number">2.8.3</span> –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</h3>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--no-cache-dir</span> <span class="at">--no-deps</span> autogluon</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre></div>
<h2 data-number="2.9" id="–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"><span
class="header-section-number">2.9</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</h2>
<h3 data-number="2.9.1" id="–ø–æ–ª–Ω—ã–π-—Ç–µ—Å—Ç-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="header-section-number">2.9.1</span> –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_installation():</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ AutoGluon&quot;&quot;&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature1&#39;</span>: np.random.randn(n_samples),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature2&#39;</span>: np.random.randn(n_samples),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature3&#39;</span>: np.random.randn(n_samples),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;target&#39;</span>: np.random.randint(<span class="dv">0</span>, <span class="dv">2</span>, n_samples)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> data[:<span class="dv">800</span>]</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[<span class="dv">800</span>:]</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">60</span>,  <span class="co"># 1 –º–∏–Ω—É—Ç–∞</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;medium_quality&#39;</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Model performance: </span><span class="sc">{</span>performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Installation test completed successfully!&quot;</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    test_installation()</span></code></pre></div>
<h2 data-number="2.10" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏"><span
class="header-section-number">2.10</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./02_basic_usage.md">–ë–∞–∑–æ–≤–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</a> - <a
href="./03_advanced_configuration.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</a> - <a
href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a></p>
<h2 data-number="2.11" id="–ø–æ–ª–µ–∑–Ω—ã–µ-—Å—Å—ã–ª–∫–∏"><span
class="header-section-number">2.11</span> –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>
<ul>
<li><a href="https://auto.gluon.ai/">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li>
<li><a href="https://github.com/autogluon/autogluon">GitHub
—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a></li>
<li><a
href="https://github.com/autogluon/autogluon/tree/master/examples">–ü—Ä–∏–º–µ—Ä—ã
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="https://discuss.autogluon.ai/">–§–æ—Ä—É–º —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</a></li>
</ul>
<hr />
<h1 data-number="3" id="–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-automl-gluon"><span
class="header-section-number">3</span> –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AutoML
Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>

<h2 data-number="3.0" id="–ø–æ—á–µ–º—É-–Ω–∞—á–∏–Ω–∞–µ–º-—Å-–±–∞–∑–æ–≤–æ–≥–æ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span class="header-section-number">3.0</span> –ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –æ—Å–≤–æ–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º —Ç–µ—Ö–Ω–∏–∫–∞–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ 90% —É—Å–ø–µ—à–Ω—ã—Ö ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–º–µ–Ω–Ω–æ –±–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Å–Ω–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.</p>

<h3 data-number="3.0.1" id="–ø—Ä–∏–Ω—Ü–∏–ø—ã-–±–∞–∑–æ–≤–æ–≥–æ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span class="header-section-number">3.0.1</span> –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</p>

<ul>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞:</strong> –ú–∏–Ω–∏–º—É–º –∫–æ–¥–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:</strong> –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –ü–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è</li>
</ul>

<h3 data-number="3.0.2" id="—á—Ç–æ-–≤—ã-–Ω–∞—É—á–∏—Ç–µ—Å—å"><span class="header-section-number">3.0.2</span> –ß—Ç–æ –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –Ω–∞–≤—ã–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç 80% –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:</p>

<ul>
<li><strong>–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:</strong> –û—Ç –¥–∞–Ω–Ω—ã—Ö –¥–æ –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∑–∞ 5 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</li>
<li><strong>–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–∞ –≤–∞—à–∞ –º–æ–¥–µ–ª—å</li>
<li><strong>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:</strong> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è</li>
</ul>

<h2 data-number="3.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-tabularpredictor"><span
class="header-section-number">3.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤
TabularPredictor</h2>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º –∏–º–µ–Ω–Ω–æ —Å TabularPredictor?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ 80% –≤—Å–µ—Ö ML-–∑–∞–¥–∞—á —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∏ —ç—Ç–æ —Å–∞–º—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç AutoML Gluon.</p>

<p><img src="images/architecture_diagram.png"
alt="–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AutoML Gluon" /> <em>–†–∏—Å—É–Ω–æ–∫ 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AutoML
Gluon —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏</em></p>
<p><code>TabularPredictor</code> - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å
—Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ AutoGluon. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏
(–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–µ–≥—Ä–µ—Å—Å–∏—è) –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã.</p>

<h3 data-number="3.1.0" id="–ø–æ—á–µ–º—É-tabularpredictor-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">3.1.0</span> –ü–æ—á–µ–º—É TabularPredictor —Ç–∞–∫ –≤–∞–∂–µ–Ω</h3>

<p><strong>–ü–æ—á–µ–º—É TabularPredictor - —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ AutoML Gluon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —Ä–µ—à–∞–µ—Ç —Å–∞–º—ã–µ —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:</p>

<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</strong> –¢–µ—Å—Ç–∏—Ä—É–µ—Ç 20+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong> –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–π:</strong> –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:</strong> –û—á–∏—â–∞–µ—Ç –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ</li>
</ul>

<p><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong></p>
<ul>
<li><strong>–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏:</strong> –ú–µ—Å—è—Ü—ã —Ä–∞–±–æ—Ç—ã –∑–∞ —á–∞—Å—ã</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:</strong> –ß–∞—Å—Ç–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –º–æ–¥–µ–ª–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</strong> –í—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</li>
</ul>
<h3 data-number="3.1.1" id="–∏–º–ø–æ—Ä—Ç-–∏-—Å–æ–∑–¥–∞–Ω–∏–µ-–±–∞–∑–æ–≤–æ–≥–æ-–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞"><span
class="header-section-number">3.1.1</span> –ò–º–ø–æ—Ä—Ç –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ
–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π —Å–ø–æ—Å–æ–± –∏–º–ø–æ—Ä—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –¥–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º TabularPredictor —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–¥–∞.</p>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ:</strong></p>
<ul>
<li>–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
<li>–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏</li>
<li>–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
</ul>

<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target_column&#39;</span>,  <span class="co"># –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,    <span class="co"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span>      <span class="co"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>

<h4 data-number="3.1.1.1" id="–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞"><span class="header-section-number">3.1.1.1</span> –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à–∞ –º–æ–¥–µ–ª—å:</p>

<ul>
<li><strong>label='target_column'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω:</strong> –£–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫—É—é –∫–æ–ª–æ–Ω–∫—É –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–Ω–∞–µ—Ç, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</li>
        <li><strong>–í–∞–∂–Ω–æ:</strong> –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–æ–ª–æ–Ω–∫–æ–π –≤ –¥–∞–Ω–Ω—ã—Ö</li>
    </ul>
</li>

<li><strong>problem_type='auto'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 'auto':</strong> –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ –ø–æ –¥–∞–Ω–Ω—ã–º</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–∫–∞–∑—ã–≤–∞—Ç—å, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç—Ç–æ –∏–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–∏–ø —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</li>
    </ul>
</li>

<li><strong>eval_metric='auto'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 'auto':</strong> –í—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à—É—é –º–µ—Ç—Ä–∏–∫—É –¥–ª—è —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç accuracy –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, RMSE –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</li>
        <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:</strong> –ù–µ –Ω—É–∂–Ω–æ –∏–∑—É—á–∞—Ç—å, –∫–∞–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ</li>
    </ul>
</li>
</ul>

<h2 data-number="3.2" id="—Ç–∏–ø—ã-–∑–∞–¥–∞—á"><span
class="header-section-number">3.2</span> –¢–∏–ø—ã –∑–∞–¥–∞—á</h2>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ç–∏–ø—ã –∑–∞–¥–∞—á?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ—Ç —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏ –∑–∞–≤–∏—Å–∏—Ç –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –º–µ—Ç—Ä–∏–∫ –∏ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Ä–µ—à–µ–Ω–∏—é. AutoML Gluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø, –Ω–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –ª—É—á—à–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É.</p>

<h3 data-number="3.2.1" id="–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"><span
class="header-section-number">3.2.1</span> –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>

<p><strong>–ü–æ—á–µ–º—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–∫ –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ 60% –≤—Å–µ—Ö ML-–∑–∞–¥–∞—á - —ç—Ç–æ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ø–∞–º–∞ –¥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.</p>

<h4 data-number="3.2.1.0" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"><span class="header-section-number">3.2.1.0</span> –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è - —ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –∫–ª–∞—Å—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>

<p><strong>–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:</strong></p>
<ul>
<li><strong>–ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –°–ø–∞–º/–Ω–µ —Å–ø–∞–º, –±–æ–ª–µ–Ω/–∑–¥–æ—Ä–æ–≤</li>
<li><strong>–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ, –∂–∞–Ω—Ä —Ñ–∏–ª—å–º–∞</li>
<li><strong>–ú–Ω–æ–≥–æ–º–µ—Ç–æ—á–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –ù–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∞—Å—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</li>
</ul>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:</strong></p>
<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</strong> –¢–µ—Å—Ç–∏—Ä—É–µ—Ç 15+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
<li><strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ç–µ—Ö–Ω–∏–∫–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏</li>
<li><strong>–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç accuracy, F1-score, ROC-AUC</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
</ul>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;is_fraud&#39;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;category&#39;</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;multiclass&#39;</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.2.2" id="—Ä–µ–≥—Ä–µ—Å—Å–∏—è"><span
class="header-section-number">3.2.2</span> –†–µ–≥—Ä–µ—Å—Å–∏—è</h3>

<p><strong>–ü–æ—á–µ–º—É —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ç–∞–∫ –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ 30% –≤—Å–µ—Ö ML-–∑–∞–¥–∞—á - —ç—Ç–æ –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –æ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω –¥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂.</p>

<h4 data-number="3.2.2.0" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-—Ä–µ–≥—Ä–µ—Å—Å–∏—è"><span class="header-section-number">3.2.2.0</span> –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–≥—Ä–µ—Å—Å–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–≥—Ä–µ—Å—Å–∏—è - —ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>

<p><strong>–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:</strong></p>
<ul>
<li><strong>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω:</strong> –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏, –∞–∫—Ü–∏–π</li>
<li><strong>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂:</strong> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –≤—ã—Ä—É—á–∫–∞</li>
<li><strong>–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤:</strong> –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã</li>
<li><strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–æ–≥–Ω–æ–∑—ã:</strong> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏, –¥–æ–∑–∏—Ä–æ–≤–∫–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤</li>
</ul>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:</strong></p>
<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</strong> –¢–µ—Å—Ç–∏—Ä—É–µ—Ç 12+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</li>
<li><strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–Ω–æ–º–∞–ª–∏–∏</li>
<li><strong>–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç RMSE, MAE, R¬≤</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∏—Ö –≤–ª–∏—è–Ω–∏–µ</li>
</ul>

<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–µ–≥—Ä–µ—Å—Å–∏—è</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;price&#39;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>

<h4 data-number="3.2.2.1" id="–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"><span class="header-section-number">3.2.2.1</span> –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –∑–∞–¥–∞—á –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:</p>

<ul>
<li><strong>label='price'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 'price':</strong> –≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–Ω–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</li>
        <li><strong>–í–∞–∂–Ω–æ:</strong> –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —á–∏—Å–ª–æ–≤–æ–π</li>
    </ul>
</li>

<li><strong>problem_type='regression'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É 'regression':</strong> –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –°–∏—Å—Ç–µ–º–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</li>
        <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:</strong> –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
    </ul>
</li>

<li><strong>eval_metric='rmse'</strong>
    <ul>
        <li><strong>–ü–æ—á–µ–º—É RMSE:</strong> –õ—É—á—à–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</li>
        <li><strong>–ß—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—à–∏–±–∫—É –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</li>
        <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:</strong> –õ–µ–≥–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
    </ul>
</li>
</ul>
<h2 data-number="3.3" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">3.3</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h2>

<p><strong>–ü–æ—á–µ–º—É –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - —ç—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∏–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å AutoML Gluon –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ—é –º–æ—â—å - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –¥–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>

<h3 data-number="3.3.0" id="—á—Ç–æ-–ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç-–ø—Ä–∏-–æ–±—É—á–µ–Ω–∏–∏"><span class="header-section-number">3.3.0</span> –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è —Ç–∞–∫ —Å–ª–æ–∂–µ–Ω?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:</p>

<ol>
<li><strong>–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö:</strong> –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –≤—ã–±—Ä–æ—Å—ã</li>
<li><strong>–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞:</strong> –û—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ–¥–∏—Ä—É–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</li>
<li><strong>–í—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:</strong> –¢–µ—Å—Ç–∏—Ä—É–µ—Ç 20+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong> –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</li>
<li><strong>–°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–π:</strong> –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏</li>
<li><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ol>

<p><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong></p>
<ul>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ª—É—á—à—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
<li><strong>–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏:</strong> –ú–µ—Å—è—Ü—ã —Ä–∞–±–æ—Ç—ã –∑–∞ —á–∞—Å—ã</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</strong> –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è</li>
</ul>

<h3 data-number="3.3.1" id="–±–∞–∑–æ–≤–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">3.3.1</span> –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –±–∞–∑–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;train.csv&#39;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;test.csv&#39;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span></code></pre></div>
<h3 data-number="3.3.2" id="–æ–±—É—á–µ–Ω–∏–µ-—Å-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º-–≤—Ä–µ–º–µ–Ω–∏"><span
class="header-section-number">3.3.2</span> –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
–≤—Ä–µ–º–µ–Ω–∏</h3>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">3600</span>  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    memory_limit<span class="op">=</span><span class="dv">8</span>  <span class="co"># 8GB RAM</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.3.3" id="–æ–±—É—á–µ–Ω–∏–µ-—Å-–ø—Ä–µ—Å–µ—Ç–∞–º–∏"><span
class="header-section-number">3.3.3</span> –û–±—É—á–µ–Ω–∏–µ —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏</h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>presets <span class="op">=</span> [</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;best_quality&#39;</span>,      <span class="co"># –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–¥–æ–ª–≥–æ)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;high_quality&#39;</span>,      <span class="co"># –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;good_quality&#39;</span>,      <span class="co"># –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;medium_quality&#39;</span>,    <span class="co"># –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;optimize_for_deployment&#39;</span>  <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">1800</span>  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.4" id="–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">3.4</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</h2>
<h3 data-number="3.4.1" id="–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="header-section-number">3.4.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Model performance: </span><span class="sc">{</span>performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    test_data,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    detailed_report<span class="op">=</span><span class="va">True</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.4.2" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">3.4.2</span> –í–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    holdout_frac<span class="op">=</span><span class="fl">0.2</span>  <span class="co"># 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,  <span class="co"># 5-fold CV</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.5" id="–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="header-section-number">3.5</span> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h2>
<h3 data-number="3.5.1" id="–±–∞–∑–æ–≤—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="header-section-number">3.5.1</span> –ë–∞–∑–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤/–∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span></code></pre></div>
<h3 data-number="3.5.2"
id="–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è-—Å-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"><span
class="header-section-number">3.5.2</span> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</h3>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>predictions_with_intervals <span class="op">=</span> predictor.predict(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    test_data,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    include_confidence<span class="op">=</span><span class="va">True</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>individual_predictions <span class="op">=</span> predictor.predict_multi(test_data)</span></code></pre></div>
<h2 data-number="3.6" id="—Ä–∞–±–æ—Ç–∞-—Å-–ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏"><span
class="header-section-number">3.6</span> –†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</h2>
<h3 data-number="3.6.1" id="–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="header-section-number">3.6.1</span> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (one-hot encoding, label encoding)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - –ß–∏—Å–ª–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (TF-IDF, embeddings)</span></span></code></pre></div>
<h3 data-number="3.6.2" id="—Ä—É—á–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="header-section-number">3.6.2</span> –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.features <span class="im">import</span> FeatureGenerator</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>feature_generator <span class="op">=</span> FeatureGenerator(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    enable_nan_handling<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    enable_categorical_encoding<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    enable_text_special_features<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    enable_text_ngram_features<span class="op">=</span><span class="va">True</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –¥–∞–Ω–Ω—ã–º</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>train_data_processed <span class="op">=</span> feature_generator.fit_transform(train_data)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>test_data_processed <span class="op">=</span> feature_generator.transform(test_data)</span></code></pre></div>
<h2 data-number="3.7" id="—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–∏-–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">3.7</span> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞
–º–æ–¥–µ–ª–µ–π</h2>
<h3 data-number="3.7.1" id="—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">3.7.1</span> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>predictor.save(<span class="st">&#39;my_model&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>predictor.save(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;my_model&#39;</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    save_space<span class="op">=</span><span class="va">True</span>,  <span class="co"># –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    save_info<span class="op">=</span><span class="va">True</span>   <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.7.2" id="–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">3.7.2</span> –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;my_model&#39;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor.load(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;my_model&#39;</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    require_version_match<span class="op">=</span><span class="va">True</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.8" id="—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏"><span
class="header-section-number">3.8</span> –†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</h2>
<h3 data-number="3.8.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª—è"><span
class="header-section-number">3.8.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –∞–Ω—Å–∞–º–±–ª–µ–º</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,      <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">2</span>,       <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –±—ç–≥–≥–∏–Ω–≥–∞</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    num_stack_levels<span class="op">=</span><span class="dv">1</span>    <span class="co"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.8.2" id="–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è"><span
class="header-section-number">3.8.2</span> –ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª—è—Ö –≤ –∞–Ω—Å–∞–º–±–ª–µ</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>leaderboard <span class="op">=</span> predictor.leaderboard()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(leaderboard)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>leaderboard <span class="op">=</span> predictor.leaderboard(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    test_data,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    extra_info<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    silent<span class="op">=</span><span class="va">False</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.9" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"><span
class="header-section-number">3.9</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
<h3 data-number="3.9.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="header-section-number">3.9.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–ª–æ–≤–∞—Ä—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>},</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">63</span>}</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;iterations&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;iterations&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>}</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>},</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>}</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    hyperparameters<span class="op">=</span>hyperparameters</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.9.2" id="–∏—Å–∫–ª—é—á–µ–Ω–∏–µ-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤"><span
class="header-section-number">3.9.2</span> –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</h3>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>excluded_model_types <span class="op">=</span> [<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;NN_TORCH&#39;</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    excluded_model_types<span class="op">=</span>excluded_model_types</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.9.3" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">3.9.3</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular.models <span class="im">import</span> AbstractModel</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomValidationStrategy(AbstractModel):</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_default_resources(<span class="va">self</span>):</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;num_cpus&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>}</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    validation_strategy<span class="op">=</span><span class="st">&#39;custom&#39;</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    custom_validation_strategy<span class="op">=</span>CustomValidationStrategy()</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.10" id="—Ä–∞–±–æ—Ç–∞-—Å-—Ä–∞–∑–ª–∏—á–Ω—ã–º–∏-—Ç–∏–ø–∞–º–∏-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">3.10</span> –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
–¥–∞–Ω–Ω—ã—Ö</h2>
<h3 data-number="3.10.1" id="–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="header-section-number">3.10.1</span> –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–æ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏—Ö —è–≤–Ω–æ</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;category&#39;</span>, <span class="st">&#39;brand&#39;</span>, <span class="st">&#39;region&#39;</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    categorical_columns<span class="op">=</span>categorical_columns</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.10.2" id="—Ç–µ–∫—Å—Ç–æ–≤—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="header-section-number">3.10.2</span> –¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>text_columns <span class="op">=</span> [<span class="st">&#39;description&#39;</span>, <span class="st">&#39;review_text&#39;</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    text_columns<span class="op">=</span>text_columns</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.10.3" id="–≤—Ä–µ–º–µ–Ω–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ"><span
class="header-section-number">3.10.3</span> –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>time_columns <span class="op">=</span> [<span class="st">&#39;date&#39;</span>, <span class="st">&#39;timestamp&#39;</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    time_columns<span class="op">=</span>time_columns</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.11" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">3.11</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</h2>
<h3 data-number="3.11.1" id="–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">3.11.1</span> –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    verbosity<span class="op">=</span><span class="dv">2</span>  <span class="co"># –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="3.11.2" id="callback-—Ñ—É–Ω–∫—Ü–∏–∏"><span
class="header-section-number">3.11.2</span> Callback —Ñ—É–Ω–∫—Ü–∏–∏</h3>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> training_callback(model_name, model_path, model_info):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Callback —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Training </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Model path: </span><span class="sc">{</span>model_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Model info: </span><span class="sc">{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[training_callback]</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.12" id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">3.12</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 data-number="3.12.1" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"><span
class="header-section-number">3.12.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span><span class="dv">10000</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    n_redundant<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    n_classes<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">300</span>,  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;medium_quality&#39;</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>performance[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a><span class="co"># –ê–Ω–∞–ª–∏–∑ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>leaderboard <span class="op">=</span> predictor.leaderboard()</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(leaderboard)</span></code></pre></div>
<h3 data-number="3.12.2" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"><span
class="header-section-number">3.12.2</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h3>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_regression</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_regression(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span><span class="dv">10000</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    noise<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">300</span>,  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;RMSE: </span><span class="sc">{</span>performance[<span class="st">&#39;rmse&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MAE: </span><span class="sc">{</span>performance[<span class="st">&#39;mae&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance)</span></code></pre></div>
<h2 data-number="3.13" id="–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="header-section-number">3.13</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<h3 data-number="3.13.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">3.13.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data shape:&quot;</span>, train_data.shape)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Missing values:&quot;</span>, train_data.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>())</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data types:&quot;</span>, train_data.dtypes.value_counts())</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.dropna()  <span class="co"># –ò–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>constant_columns <span class="op">=</span> train_data.columns[train_data.nunique() <span class="op">&lt;=</span> <span class="dv">1</span>]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.drop(columns<span class="op">=</span>constant_columns)</span></code></pre></div>
<h3 data-number="3.13.2" id="–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫"><span
class="header-section-number">3.13.2</span> –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h3>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>classification_metrics <span class="op">=</span> [</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;balanced_accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;f1_macro&#39;</span>, <span class="st">&#39;f1_micro&#39;</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;precision&#39;</span>, <span class="st">&#39;precision_macro&#39;</span>, <span class="st">&#39;recall&#39;</span>, <span class="st">&#39;recall_macro&#39;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;roc_auc&#39;</span>, <span class="st">&#39;log_loss&#39;</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>regression_metrics <span class="op">=</span> [</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;rmse&#39;</span>, <span class="st">&#39;mae&#39;</span>, <span class="st">&#39;mape&#39;</span>, <span class="st">&#39;smape&#39;</span>, <span class="st">&#39;r2&#39;</span>, <span class="st">&#39;pearsonr&#39;</span>, <span class="st">&#39;spearmanr&#39;</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div>
<h3 data-number="3.13.3" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">3.13.3</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">60</span>,  <span class="co"># 1 –º–∏–Ω—É—Ç–∞</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;optimize_for_deployment&#39;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">3600</span>,  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="3.14" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-1"><span
class="header-section-number">3.14</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./03_advanced_configuration.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</a> - <a
href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a> - <a
href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></p>
<hr />
<h1 data-number="4" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-automl-gluon"><span
class="header-section-number">4</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoML
Gluon</h1>

<h2 data-number="4.0" id="–ø–æ—á–µ–º—É-–Ω—É–∂–Ω–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"><span class="header-section-number">4.0</span> –ü–æ—á–µ–º—É –Ω—É–∂–Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h2>

<p><strong>–ü–æ—á–µ–º—É –±–∞–∑–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥—ã–π –¥–∞—Ç–∞—Å–µ—Ç —É–Ω–∏–∫–∞–ª–µ–Ω, –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç –Ω–µ –ø–æ–¥–æ–π—Ç–∏ –¥–ª—è –≤–∞—à–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.</p>

<h3 data-number="4.0.1" id="–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è-–±–∞–∑–æ–≤—ã—Ö-–Ω–∞—Å—Ç—Ä–æ–µ–∫"><span class="header-section-number">4.0.1</span> –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫</h3>

<p><strong>–ü–æ—á–µ–º—É –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –Ω–∞ "—Å—Ä–µ–¥–Ω–∏–π" —Å–ª—É—á–∞–π:</p>

<ul>
<li><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:</strong> –ú–æ–≥—É—Ç –Ω–µ –ø–æ–¥–æ–π—Ç–∏ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ë–∞–∑–æ–≤—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong> –ù–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞</li>
<li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:</strong> –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:</strong> –ú–æ–≥—É—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-—Ü–µ–ª—è–º</li>
</ul>

<h3 data-number="4.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"><span class="header-section-number">4.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è?</strong> –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π:</p>

<ul>
<li><strong>–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏:</strong> –ù–∞ 10-30% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–∞–∑–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏:</strong> –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</strong> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏</li>
<li><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞:</strong> –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
</ul>

<h2 data-number="4.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-1"><span
class="header-section-number">4.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–∞–∫ –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –≤ 2-3 —Ä–∞–∑–∞.</p>
<h3 data-number="4.1.1" id="—Å–æ–∑–¥–∞–Ω–∏–µ-–∫–∞—Å—Ç–æ–º–Ω—ã—Ö-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="header-section-number">4.1.1</span> –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_freq&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_sum_hessian_in_leaf&#39;</span>: <span class="fl">1e-3</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l1&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l2&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_gain_to_split&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;save_binary&#39;</span>: <span class="va">True</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;seed&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction_seed&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_seed&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;drop_seed&#39;</span>: <span class="dv">4</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;keep_training_booster&#39;</span>: <span class="va">False</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">63</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.7</span>,</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_freq&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_sum_hessian_in_leaf&#39;</span>: <span class="fl">1e-3</span>,</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l1&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l2&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_gain_to_split&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;save_binary&#39;</span>: <span class="va">True</span>,</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;seed&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction_seed&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_seed&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;drop_seed&#39;</span>: <span class="dv">4</span>,</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;keep_training_booster&#39;</span>: <span class="va">False</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;iterations&#39;</span>: <span class="dv">100</span>,</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l2_leaf_reg&#39;</span>: <span class="fl">3.0</span>,</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bootstrap_type&#39;</span>: <span class="st">&#39;Bayesian&#39;</span>,</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_strength&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_temperature&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_type&#39;</span>: <span class="st">&#39;Iter&#39;</span>,</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_wait&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="va">False</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;iterations&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;depth&#39;</span>: <span class="dv">8</span>,</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l2_leaf_reg&#39;</span>: <span class="fl">5.0</span>,</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bootstrap_type&#39;</span>: <span class="st">&#39;Bayesian&#39;</span>,</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_strength&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_temperature&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_type&#39;</span>: <span class="st">&#39;Iter&#39;</span>,</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_wait&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="va">False</span></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>,</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_alpha&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_lambda&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_state&#39;</span>: <span class="dv">0</span></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>,</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>,</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_alpha&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_lambda&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_state&#39;</span>: <span class="dv">0</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>,</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_features&#39;</span>: <span class="st">&#39;sqrt&#39;</span>,</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bootstrap&#39;</span>: <span class="va">True</span>,</span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_state&#39;</span>: <span class="dv">0</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;KNN&#39;</span>: [</span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_neighbors&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;weights&#39;</span>: <span class="st">&#39;uniform&#39;</span>,</span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;algorithm&#39;</span>: <span class="st">&#39;auto&#39;</span>,</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;leaf_size&#39;</span>: <span class="dv">30</span>,</span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;p&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metric&#39;</span>: <span class="st">&#39;minkowski&#39;</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, hyperparameters<span class="op">=</span>hyperparameters)</span></code></pre></div>
<h3 data-number="4.1.2" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="header-section-number">4.1.2</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> Space</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>hyperparameter_space <span class="op">=</span> {</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: {</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_boost_round&#39;</span>: Space(<span class="dv">50</span>, <span class="dv">500</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_leaves&#39;</span>: Space(<span class="dv">31</span>, <span class="dv">127</span>),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: Space(<span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature_fraction&#39;</span>: Space(<span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;bagging_fraction&#39;</span>: Space(<span class="fl">0.5</span>, <span class="fl">1.0</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: {</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_estimators&#39;</span>: Space(<span class="dv">50</span>, <span class="dv">500</span>),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: Space(<span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: Space(<span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;subsample&#39;</span>: Space(<span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;colsample_bytree&#39;</span>: Space(<span class="fl">0.5</span>, <span class="fl">1.0</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    hyperparameter_tune_kwargs<span class="op">=</span>{</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_trials&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;scheduler&#39;</span>: <span class="st">&#39;local&#39;</span>,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;searcher&#39;</span>: <span class="st">&#39;auto&#39;</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.2" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π"><span
class="header-section-number">4.2</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</h2>
<h3 data-number="4.2.1" id="–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏"><span
class="header-section-number">4.2.1</span> –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∏–Ω–≥–∞</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,        <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">2</span>,         <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –±—ç–≥–≥–∏–Ω–≥–∞</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    num_stack_levels<span class="op">=</span><span class="dv">2</span>,     <span class="co"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    stack_ensemble_levels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>],  <span class="co"># –ö–∞–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç–µ–∫–∏–Ω–≥–∞</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    ag_args_fit<span class="op">=</span>{<span class="st">&#39;num_gpus&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">4</span>}  <span class="co"># –†–µ—Å—É—Ä—Å—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="4.2.2" id="–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–∞–Ω—Å–∞–º–±–ª–∏"><span
class="header-section-number">4.2.2</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</h3>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular.models <span class="im">import</span> AbstractModel</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomEnsembleModel(AbstractModel):</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">**</span>kwargs):</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.models <span class="op">=</span> []</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _fit(<span class="va">self</span>, X, y, <span class="op">**</span>kwargs):</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _predict(<span class="va">self</span>, X, <span class="op">**</span>kwargs):</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    custom_ensemble_model<span class="op">=</span>CustomEnsembleModel</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.3" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤"><span
class="header-section-number">4.3</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h2>
<h3 data-number="4.3.1" id="cpu-–∏-gpu-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏"><span
class="header-section-number">4.3.1</span> CPU –∏ GPU –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ag_args_fit <span class="op">=</span> {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">8</span>,          <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">1</span>,          <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">16</span>,     <span class="co"># –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ GB</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span>      <span class="co"># –õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    ag_args_fit<span class="op">=</span>ag_args_fit</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="4.3.2" id="–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">4.3.2</span> –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> scheduler</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>local_scheduler <span class="op">=</span> scheduler.LocalScheduler(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    num_cpus<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    num_gpus<span class="op">=</span><span class="dv">1</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    scheduler<span class="op">=</span>local_scheduler</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.4" id="—Ä–∞–±–æ—Ç–∞-—Å-–±–æ–ª—å—à–∏–º–∏-–¥–∞–Ω–Ω—ã–º–∏"><span
class="header-section-number">4.4</span> –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</h2>
<h3 data-number="4.4.1" id="–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">4.4.1</span> –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –ø–æ —á–∞—Å—Ç—è–º</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>chunk_size <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(train_data), chunk_size):</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    chunk <span class="op">=</span> train_data[i:i<span class="op">+</span>chunk_size]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        predictor.fit(chunk)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        predictor.fit(chunk, refit_full<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<h3 data-number="4.4.2" id="—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">4.4.2</span> –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> scheduler</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ray –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>ray_scheduler <span class="op">=</span> scheduler.RayScheduler(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    num_cpus<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    num_gpus<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    ray_address<span class="op">=</span><span class="st">&#39;auto&#39;</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    scheduler<span class="op">=</span>ray_scheduler</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.5" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏-1"><span
class="header-section-number">4.5</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 data-number="4.5.1" id="–∫–∞—Å—Ç–æ–º–Ω—ã–µ-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">4.5.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> TimeSeriesSplit</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_series_split(X, y, n_splits<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    tscv <span class="op">=</span> TimeSeriesSplit(n_splits<span class="op">=</span>n_splits)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> train_idx, val_idx <span class="kw">in</span> tscv.split(X):</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> train_idx, val_idx</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    validation_strategy<span class="op">=</span><span class="st">&#39;custom&#39;</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    custom_validation_strategy<span class="op">=</span>time_series_split</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="4.5.2" id="—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">4.5.2</span> –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> StratifiedKFold</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stratified_split(X, y, n_splits<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    skf <span class="op">=</span> StratifiedKFold(n_splits<span class="op">=</span>n_splits, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> train_idx, val_idx <span class="kw">in</span> skf.split(X, y):</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> train_idx, val_idx</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    validation_strategy<span class="op">=</span><span class="st">&#39;custom&#39;</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    custom_validation_strategy<span class="op">=</span>stratified_split</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.6" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="header-section-number">4.6</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
<h3 data-number="4.6.1" id="–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="header-section-number">4.6.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.features <span class="im">import</span> FeatureGenerator</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomFeatureGenerator(FeatureGenerator):</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">**</span>kwargs):</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.custom_features <span class="op">=</span> []</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _generate_features(<span class="va">self</span>, X):</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>        X[<span class="st">&#39;feature_ratio&#39;</span>] <span class="op">=</span> X[<span class="st">&#39;feature1&#39;</span>] <span class="op">/</span> (X[<span class="st">&#39;feature2&#39;</span>] <span class="op">+</span> <span class="fl">1e-8</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        X[<span class="st">&#39;feature_interaction&#39;</span>] <span class="op">=</span> X[<span class="st">&#39;feature1&#39;</span>] <span class="op">*</span> X[<span class="st">&#39;feature2&#39;</span>]</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> X</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>feature_generator <span class="op">=</span> CustomFeatureGenerator()</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>train_data_processed <span class="op">=</span> feature_generator.fit_transform(train_data)</span></code></pre></div>
<h3 data-number="4.6.2" id="–æ–±—Ä–∞–±–æ—Ç–∫–∞-—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">4.6.2</span> –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>text_features <span class="op">=</span> {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;enable_text_special_features&#39;</span>: <span class="va">True</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;enable_text_ngram_features&#39;</span>: <span class="va">True</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;text_ngram_range&#39;</span>: (<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;text_max_features&#39;</span>: <span class="dv">10000</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;text_min_df&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;text_max_df&#39;</span>: <span class="fl">0.95</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    feature_generator_kwargs<span class="op">=</span>text_features</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.7" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫"><span
class="header-section-number">4.7</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫</h2>
<h3 data-number="4.7.1" id="–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="header-section-number">4.7.1</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> Scorer</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> custom_metric(y_true, y_pred):</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞&quot;&quot;&quot;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>custom_scorer <span class="op">=</span> Scorer(</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">&#39;custom_metric&#39;</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    score_func<span class="op">=</span>custom_metric,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    greater_is_better<span class="op">=</span><span class="va">True</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>custom_scorer</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="4.7.2" id="–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="header-section-number">4.7.2</span> –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.8" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">4.8</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
<h3 data-number="4.8.1" id="–¥–µ—Ç–∞–ª—å–Ω–æ–µ-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">4.8.1</span> –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span>logging.INFO,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(name)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    handlers<span class="op">=</span>[</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        logging.FileHandler(<span class="st">&#39;autogluon.log&#39;</span>),</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>        logging.StreamHandler()</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    verbosity<span class="op">=</span><span class="dv">3</span>,  <span class="co"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    log_to_file<span class="op">=</span><span class="va">True</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="4.8.2" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–æ–±—É—á–µ–Ω–∏—è-1"><span
class="header-section-number">4.8.2</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Callback –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> training_monitor(epoch, logs):</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>logs<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[training_monitor]</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.9" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">4.9</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 data-number="4.9.1" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–¥–µ–ø–ª–æ—è"><span
class="header-section-number">4.9.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</h3>
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>production_config <span class="op">=</span> {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;ag_args_fit&#39;</span>: {</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">4</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;hyperparameters&#39;</span>: {</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: [{<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>}],</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;XGB&#39;</span>: [{<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>}],</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;RF&#39;</span>: [{<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>}]</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, <span class="op">**</span>production_config)</span></code></pre></div>
<h3 data-number="4.9.2" id="—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">4.9.2</span> –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>predictor.save(</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;production_model&#39;</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    save_space<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    compress<span class="op">=</span><span class="va">True</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.10" id="–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"><span
class="header-section-number">4.10</span> –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h2>
<h3 data-number="4.10.1" id="–ø–æ–ª–Ω–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">4.10.1</span> –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    path<span class="op">=</span><span class="st">&#39;./models&#39;</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    verbosity<span class="op">=</span><span class="dv">2</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>advanced_hyperparameters <span class="op">=</span> {</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_freq&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_sum_hessian_in_leaf&#39;</span>: <span class="fl">1e-3</span>,</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l1&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;lambda_l2&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_gain_to_split&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;save_binary&#39;</span>: <span class="va">True</span>,</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;seed&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;feature_fraction_seed&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_seed&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;drop_seed&#39;</span>: <span class="dv">4</span>,</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;keep_training_booster&#39;</span>: <span class="va">False</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;iterations&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l2_leaf_reg&#39;</span>: <span class="fl">3.0</span>,</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bootstrap_type&#39;</span>: <span class="st">&#39;Bayesian&#39;</span>,</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_strength&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bagging_temperature&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_type&#39;</span>: <span class="st">&#39;Iter&#39;</span>,</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;od_wait&#39;</span>: <span class="dv">20</span>,</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;verbose&#39;</span>: <span class="va">False</span></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_alpha&#39;</span>: <span class="fl">0.0</span>,</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reg_lambda&#39;</span>: <span class="fl">1.0</span>,</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;random_state&#39;</span>: <span class="dv">0</span></span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤</span></span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>ag_args_fit <span class="op">=</span> {</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">8</span>,</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">16</span>,</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span></span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span></span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>    hyperparameters<span class="op">=</span>advanced_hyperparameters,</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a>    num_stack_levels<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>    ag_args_fit<span class="op">=</span>ag_args_fit,</span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">3600</span>,</span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a>    holdout_frac<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a>    verbosity<span class="op">=</span><span class="dv">2</span></span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="4.11" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-2"><span
class="header-section-number">4.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a> - <a
href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a> - <a
href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a></p>
<hr />
<h1 data-number="5" id="–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤-automl-gluon"><span
class="header-section-number">5</span> –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤
AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>

<h2 data-number="5.0" id="–ø–æ—á–µ–º—É-–º–µ—Ç—Ä–∏–∫–∏-—Ç–∞–∫-–≤–∞–∂–Ω—ã"><span class="header-section-number">5.0</span> –ü–æ—á–µ–º—É –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞–∫ –≤–∞–∂–Ω—ã</h2>

<p><strong>–ü–æ—á–µ–º—É –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –∏ –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É.</p>

<h3 data-number="5.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö-–º–µ—Ç—Ä–∏–∫"><span class="header-section-number">5.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏?</strong> –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∫–∞–∑–∞—Ç—å—Å—è —Ö–æ—Ä–æ—à–µ–π, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø–ª–æ—Ö–æ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É:</p>

<ul>
<li><strong>–õ–æ–∂–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</strong> –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:</strong> –ú–æ–¥–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–µ –ø–æ —Ç–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é</li>
<li><strong>–ü–ª–æ—Ö–∏–µ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏—è:</strong> –ú–æ–¥–µ–ª—å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="5.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö-–º–µ—Ç—Ä–∏–∫"><span class="header-section-number">5.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫?</strong> –û–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö:</p>

<ul>
<li><strong>–û–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</li>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:</strong> –ú–æ–¥–µ–ª—å —É–ª—É—á—à–∞–µ—Ç—Å—è –≤ –Ω—É–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å:</strong> –ú–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –ü–æ–Ω—è—Ç–Ω—ã–µ –∏ –Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
</ul>

<h2 data-number="5.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–º–µ—Ç—Ä–∏–∫–∏"><span
class="header-section-number">5.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–µ—Ç—Ä–∏–∫–∏</h2>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –º–µ—Ç—Ä–∏–∫?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞.</p>
<p><img src="images/metrics_comparison.png" alt="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫" />
<em>–†–∏—Å—É–Ω–æ–∫ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</em></p>
<p><img src="images/metrics_detailed.png"
alt="–î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫" /> <em>–†–∏—Å—É–Ω–æ–∫ 3.1: –î–µ—Ç–∞–ª—å–Ω–∞—è
–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ - ROC Curve, Precision-Recall, Confusion Matrix,
Accuracy vs Threshold, F1 Score vs Threshold</em></p>
<p>–ú–µ—Ç—Ä–∏–∫–∏ –≤ AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è: - –û—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π -
–°—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ - –í—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</p>
<h2 data-number="5.2" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"><span
class="header-section-number">5.2</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
<h3 data-number="5.2.1" id="–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="header-section-number">5.2.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 data-number="5.2.1.1" id="accuracy-—Ç–æ—á–Ω–æ—Å—Ç—å"><span
class="header-section-number">5.2.1.1</span> Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å)</h4>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_true, y_pred)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.2.1.2" id="precision-—Ç–æ—á–Ω–æ—Å—Ç—å"><span
class="header-section-number">5.2.1.2</span> Precision (–¢–æ—á–Ω–æ—Å—Ç—å)</h4>
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Precision: </span><span class="sc">{</span>precision<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>precision_macro <span class="op">=</span> precision_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;macro&#39;</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>precision_micro <span class="op">=</span> precision_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;micro&#39;</span>)</span></code></pre></div>
<h4 data-number="5.2.1.3" id="recall-–ø–æ–ª–Ω–æ—Ç–∞"><span
class="header-section-number">5.2.1.3</span> Recall (–ü–æ–ª–Ω–æ—Ç–∞)</h4>
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–æ–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω—ã</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Recall: </span><span class="sc">{</span>recall<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>recall_macro <span class="op">=</span> recall_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;macro&#39;</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>recall_micro <span class="op">=</span> recall_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;micro&#39;</span>)</span></code></pre></div>
<h4 data-number="5.2.1.4" id="f1-score"><span
class="header-section-number">5.2.1.4</span> F1-Score</h4>
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ precision –∏ recall</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;F1-Score: </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>f1_macro <span class="op">=</span> f1_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;macro&#39;</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>f1_micro <span class="op">=</span> f1_score(y_true, y_pred, average<span class="op">=</span><span class="st">&#39;micro&#39;</span>)</span></code></pre></div>
<h3 data-number="5.2.2" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏"><span
class="header-section-number">5.2.2</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 data-number="5.2.2.1" id="roc-auc"><span
class="header-section-number">5.2.2.1</span> ROC AUC</h4>
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC –∫—Ä–∏–≤–æ–π</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> roc_auc_score(y_true, y_prob)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;ROC AUC: </span><span class="sc">{</span>roc_auc<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>roc_auc_ovo <span class="op">=</span> roc_auc_score(y_true, y_prob, multi_class<span class="op">=</span><span class="st">&#39;ovo&#39;</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>roc_auc_ovr <span class="op">=</span> roc_auc_score(y_true, y_prob, multi_class<span class="op">=</span><span class="st">&#39;ovr&#39;</span>)</span></code></pre></div>
<h4 data-number="5.2.2.2" id="pr-auc"><span
class="header-section-number">5.2.2.2</span> PR AUC</h4>
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–ª–æ—â–∞–¥—å –ø–æ–¥ Precision-Recall –∫—Ä–∏–≤–æ–π</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> average_precision_score</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>pr_auc <span class="op">=</span> average_precision_score(y_true, y_prob)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;PR AUC: </span><span class="sc">{</span>pr_auc<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.2.2.3" id="log-loss"><span
class="header-section-number">5.2.2.3</span> Log Loss</h4>
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> log_loss</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>log_loss_score <span class="op">=</span> log_loss(y_true, y_prob)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Log Loss: </span><span class="sc">{</span>log_loss_score<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.2.2.4" id="balanced-accuracy"><span
class="header-section-number">5.2.2.4</span> Balanced Accuracy</h4>
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> balanced_accuracy_score</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>balanced_acc <span class="op">=</span> balanced_accuracy_score(y_true, y_pred)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Balanced Accuracy: </span><span class="sc">{</span>balanced_acc<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="5.2.3" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">5.2.3</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<h4 data-number="5.2.3.1"
id="matthews-correlation-coefficient-mcc"><span
class="header-section-number">5.2.3.1</span> Matthews Correlation
Coefficient (MCC)</h4>
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> matthews_corrcoef</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>mcc <span class="op">=</span> matthews_corrcoef(y_true, y_pred)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MCC: </span><span class="sc">{</span>mcc<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.2.3.2" id="cohens-kappa"><span
class="header-section-number">5.2.3.2</span> Cohen‚Äôs Kappa</h4>
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> cohen_kappa_score</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> cohen_kappa_score(y_true, y_pred)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Cohen&#39;s Kappa: </span><span class="sc">{</span>kappa<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="5.3" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏"><span
class="header-section-number">5.3</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h2>
<h3 data-number="5.3.1" id="–±–∞–∑–æ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2"><span
class="header-section-number">5.3.1</span> –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 data-number="5.3.1.1" id="mean-absolute-error-mae"><span
class="header-section-number">5.3.1.1</span> Mean Absolute Error
(MAE)</h4>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>mae <span class="op">=</span> mean_absolute_error(y_true, y_pred)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MAE: </span><span class="sc">{</span>mae<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.3.1.2" id="mean-squared-error-mse"><span
class="header-section-number">5.3.1.2</span> Mean Squared Error
(MSE)</h4>
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_true, y_pred)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MSE: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.3.1.3" id="root-mean-squared-error-rmse"><span
class="header-section-number">5.3.1.3</span> Root Mean Squared Error
(RMSE)</h4>
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_true, y_pred))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;RMSE: </span><span class="sc">{</span>rmse<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="5.3.1.4" id="r¬≤-score"><span
class="header-section-number">5.3.1.4</span> R¬≤ Score</h4>
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_true, y_pred)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R¬≤ Score: </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="5.3.2" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="header-section-number">5.3.2</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 data-number="5.3.2.1" id="mean-absolute-percentage-error-mape"><span
class="header-section-number">5.3.2.1</span> Mean Absolute Percentage
Error (MAPE)</h4>
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mape(y_true, y_pred):</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.<span class="bu">abs</span>((y_true <span class="op">-</span> y_pred) <span class="op">/</span> y_true)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>mape_score <span class="op">=</span> mape(y_true, y_pred)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MAPE: </span><span class="sc">{</span>mape_score<span class="sc">:.4f}</span><span class="ss">%&quot;</span>)</span></code></pre></div>
<h4 data-number="5.3.2.2"
id="symmetric-mean-absolute-percentage-error-smape"><span
class="header-section-number">5.3.2.2</span> Symmetric Mean Absolute
Percentage Error (SMAPE)</h4>
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> smape(y_true, y_pred):</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(<span class="dv">2</span> <span class="op">*</span> np.<span class="bu">abs</span>(y_true <span class="op">-</span> y_pred) <span class="op">/</span> (np.<span class="bu">abs</span>(y_true) <span class="op">+</span> np.<span class="bu">abs</span>(y_pred))) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>smape_score <span class="op">=</span> smape(y_true, y_pred)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;SMAPE: </span><span class="sc">{</span>smape_score<span class="sc">:.4f}</span><span class="ss">%&quot;</span>)</span></code></pre></div>
<h4 data-number="5.3.2.3" id="mean-absolute-scaled-error-mase"><span
class="header-section-number">5.3.2.3</span> Mean Absolute Scaled Error
(MASE)</h4>
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mase(y_true, y_pred, y_train):</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ (—Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    naive_forecast <span class="op">=</span> np.roll(y_train, <span class="dv">1</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    naive_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(y_train <span class="op">-</span> naive_forecast))</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MAE –º–æ–¥–µ–ª–∏</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    model_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(y_true <span class="op">-</span> y_pred))</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model_mae <span class="op">/</span> naive_mae</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>mase_score <span class="op">=</span> mase(y_true, y_pred, y_train)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MASE: </span><span class="sc">{</span>mase_score<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="5.4" id="–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-autogluon"><span
class="header-section-number">5.4</span> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤
AutoGluon</h2>
<h3 data-number="5.4.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–µ—Ç—Ä–∏–∫-–¥–ª—è-–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">5.4.1</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è
–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>  <span class="co"># –∏–ª–∏ &#39;f1&#39;, &#39;roc_auc&#39;, &#39;log_loss&#39;</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span>  <span class="co"># –∏–ª–∏ &#39;mae&#39;, &#39;r2&#39;</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="5.4.2" id="–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="header-section-number">5.4.2</span> –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>]</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(performance)</span></code></pre></div>
<h3 data-number="5.4.3" id="–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-1"><span
class="header-section-number">5.4.3</span> –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> Scorer</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> custom_metric(y_true, y_pred):</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞&quot;&quot;&quot;</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>custom_scorer <span class="op">=</span> Scorer(</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">&#39;custom_metric&#39;</span>,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    score_func<span class="op">=</span>custom_metric,</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    greater_is_better<span class="op">=</span><span class="va">True</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>custom_scorer</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="5.5" id="–∞–Ω–∞–ª–∏–∑-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">5.5</span> –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 data-number="5.5.1" id="–ª–∏–¥–µ—Ä–±–æ—Ä–¥-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">5.5.1</span> –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</h3>
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>leaderboard <span class="op">=</span> predictor.leaderboard(test_data)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(leaderboard)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–µ—Ç–∞–ª—å–Ω—ã–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>leaderboard_detailed <span class="op">=</span> predictor.leaderboard(</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    test_data,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    extra_info<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    silent<span class="op">=</span><span class="va">False</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="5.5.2" id="–∞–Ω–∞–ª–∏–∑-–≤–∞–∂–Ω–æ—Å—Ç–∏-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤"><span
class="header-section-number">5.5.2</span> –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>feature_importance.plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Feature Importance&#39;</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<h3 data-number="5.5.3" id="–∞–Ω–∞–ª–∏–∑-–æ—à–∏–±–æ–∫"><span
class="header-section-number">5.5.3</span> –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</h3>
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_true, y_pred))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<h2 data-number="5.6" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">5.6</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</h2>
<h3 data-number="5.6.1" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">5.6.1</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean Absolute Scaled Error (MASE)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mase_time_series(y_true, y_pred, y_train, seasonal_period<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;MASE –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    naive_forecast <span class="op">=</span> np.roll(y_train, seasonal_period)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    naive_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(y_train <span class="op">-</span> naive_forecast))</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MAE –º–æ–¥–µ–ª–∏</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    model_mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(y_true <span class="op">-</span> y_pred))</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model_mae <span class="op">/</span> naive_mae</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Symmetric Mean Absolute Percentage Error (SMAPE)</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> smape_time_series(y_true, y_pred):</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;SMAPE –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(<span class="dv">2</span> <span class="op">*</span> np.<span class="bu">abs</span>(y_true <span class="op">-</span> y_pred) <span class="op">/</span> (np.<span class="bu">abs</span>(y_true) <span class="op">+</span> np.<span class="bu">abs</span>(y_pred))) <span class="op">*</span> <span class="dv">100</span></span></code></pre></div>
<h3 data-number="5.6.2" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">5.6.2</span> –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sharpe Ratio</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sharpe_ratio(returns, risk_free_rate<span class="op">=</span><span class="fl">0.02</span>):</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞&quot;&quot;&quot;</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    excess_returns <span class="op">=</span> returns <span class="op">-</span> risk_free_rate</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(excess_returns) <span class="op">/</span> np.std(excess_returns)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum Drawdown</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> max_drawdown(cumulative_returns):</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    peak <span class="op">=</span> np.maximum.accumulate(cumulative_returns)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    drawdown <span class="op">=</span> (cumulative_returns <span class="op">-</span> peak) <span class="op">/</span> peak</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">min</span>(drawdown)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calmar Ratio</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calmar_ratio(returns, max_dd):</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ö–∞–ª–º–∞—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    annual_return <span class="op">=</span> np.mean(returns) <span class="op">*</span> <span class="dv">252</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> annual_return <span class="op">/</span> <span class="bu">abs</span>(max_dd)</span></code></pre></div>
<h2 data-number="5.7" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–º–µ—Ç—Ä–∏–∫"><span
class="header-section-number">5.7</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫</h2>
<h3 data-number="5.7.1"
id="–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–º–µ—Ç—Ä–∏–∫-–≤-—Ä–µ–∞–ª—å–Ω–æ–º-–≤—Ä–µ–º–µ–Ω–∏"><span
class="header-section-number">5.7.1</span> –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤
—Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h3>
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MetricsLogger:</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, log_file<span class="op">=</span><span class="st">&#39;metrics.log&#39;</span>):</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_file <span class="op">=</span> log_file</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_history <span class="op">=</span> []</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_metrics(<span class="va">self</span>, metrics_dict):</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> datetime.now()</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>        metrics_dict[<span class="st">&#39;timestamp&#39;</span>] <span class="op">=</span> timestamp</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_history.append(metrics_dict)</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.log_file, <span class="st">&#39;a&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&quot;</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>metrics_dict<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_metrics_trend(<span class="va">self</span>, metric_name):</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –º–µ—Ç—Ä–∏–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [m[metric_name] <span class="cf">for</span> m <span class="kw">in</span> <span class="va">self</span>.metrics_history <span class="cf">if</span> metric_name <span class="kw">in</span> m]</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>metrics_logger <span class="op">=</span> MetricsLogger()</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> {</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;accuracy&#39;</span>: <span class="fl">0.85</span>,</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;f1_score&#39;</span>: <span class="fl">0.82</span>,</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;roc_auc&#39;</span>: <span class="fl">0.88</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>metrics_logger.log_metrics(metrics)</span></code></pre></div>
<h3 data-number="5.7.2" id="–∞–ª–µ—Ä—Ç—ã-–ø–æ-–º–µ—Ç—Ä–∏–∫–∞–º"><span
class="header-section-number">5.7.2</span> –ê–ª–µ—Ä—Ç—ã –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º</h3>
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MetricsAlert:</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, threshold<span class="op">=</span><span class="fl">0.8</span>, metric_name<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>):</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.threshold <span class="op">=</span> threshold</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metric_name <span class="op">=</span> metric_name</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_alert(<span class="va">self</span>, current_metric):</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_metric <span class="op">&lt;</span> <span class="va">self</span>.threshold:</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;ALERT: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>metric_name<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>current_metric<span class="sc">}</span><span class="ss"> &lt; </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>threshold<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>alert <span class="op">=</span> MetricsAlert(threshold<span class="op">=</span><span class="fl">0.8</span>, metric_name<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> alert.check_alert(<span class="fl">0.75</span>):</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre></div>
<h2 data-number="5.8" id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–º–µ—Ç—Ä–∏–∫"><span
class="header-section-number">5.8</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–º–µ—Ç—Ä–∏–∫</h2>
<h3 data-number="5.8.1" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ—Ü–µ–Ω–∫–∏-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">5.8.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ—Ü–µ–Ω–∫–∏
–º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span><span class="dv">10000</span>,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>    n_redundant<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>    n_classes<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Performance Metrics:&quot;</span>)</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> performance.items():</span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a><span class="co"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥</span></span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>leaderboard <span class="op">=</span> predictor.leaderboard(test_data)</span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Leaderboard:&quot;</span>)</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(leaderboard)</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Feature Importance:&quot;</span>)</span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head(<span class="dv">10</span>))</span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC –∫—Ä–∏–≤–∞—è</span></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>fpr, tpr, _ <span class="op">=</span> roc_curve(test_data[<span class="st">&#39;target&#39;</span>], probabilities[<span class="dv">1</span>])</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(fpr, tpr, label<span class="op">=</span><span class="ss">f&#39;ROC AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.3f}</span><span class="ss">&#39;</span>)</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">&#39;k--&#39;</span>)</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;ROC Curve&#39;</span>)</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].legend()</span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision-Recall –∫—Ä–∏–≤–∞—è</span></span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_curve</span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a>precision, recall, _ <span class="op">=</span> precision_recall_curve(test_data[<span class="st">&#39;target&#39;</span>], probabilities[<span class="dv">1</span>])</span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(recall, precision)</span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Recall&#39;</span>)</span>
<span id="cb93-73"><a href="#cb93-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Precision&#39;</span>)</span>
<span id="cb93-74"><a href="#cb93-74" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Precision-Recall Curve&#39;</span>)</span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span></span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb93-78"><a href="#cb93-78" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(test_data[<span class="st">&#39;target&#39;</span>], predictions)</span>
<span id="cb93-79"><a href="#cb93-79" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb93-80"><a href="#cb93-80" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb93-81"><a href="#cb93-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-82"><a href="#cb93-82" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb93-83"><a href="#cb93-83" aria-hidden="true" tabindex="-1"></a>feature_importance.head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb93-84"><a href="#cb93-84" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Top 10 Feature Importance&#39;</span>)</span>
<span id="cb93-85"><a href="#cb93-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-86"><a href="#cb93-86" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb93-87"><a href="#cb93-87" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<h2 data-number="5.9" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-3"><span
class="header-section-number">5.9</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a> - <a
href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a> - <a
href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a></p>
<hr />
<h1 data-number="6" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π-–≤-automl-gluon"><span
class="header-section-number">6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ AutoML
Gluon</h1>
<h2 data-number="6.0" id="–ø–æ—á–µ–º—É-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏-–≤–∞–∂–Ω–∞"><span class="header-section-number">6.0</span> –ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>

<p><strong>–ü–æ—á–µ–º—É 70% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö –º–æ–¥–µ–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –Ω–µ–≥–æ—Ç–æ–≤—ã–º–∏ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –í–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.</p>

<h3 data-number="6.0.1" id="–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ-–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è-–ø–ª–æ—Ö–æ–π-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.0.1</span> –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ø–ª–æ—Ö–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≤–∞–ª–æ–≤:</p>

<ul>
<li><strong>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏:</strong> –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ü–µ–Ω—ã, –∫–æ–º–ø–∞–Ω–∏—è —Ç–µ—Ä—è–µ—Ç –º–∏–ª–ª–∏–æ–Ω—ã</li>
<li><strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –æ—à–∏–±–∫–∏:</strong> –ú–æ–¥–µ–ª—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä—É–µ—Ç –±–æ–ª–µ–∑–Ω–∏, —Å—Ç–∞–≤–∏—Ç –ø–æ–¥ —É–≥—Ä–æ–∑—É –∂–∏–∑–Ω–∏</li>
<li><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏:</strong> –ú–æ–¥–µ–ª—å –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —Å–∏—Å—Ç–µ–º–∞ –ø–∞–¥–∞–µ—Ç</li>
<li><strong>–†–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ—Ä—è—é—Ç –¥–æ–≤–µ—Ä–∏–µ –∫ –ø—Ä–æ–¥—É–∫—Ç—É</li>
</ul>

<h3 data-number="6.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è?</strong> –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–æ–¥–µ–ª–∏ –∏ –∑–∞—â–∏—Ç—É –æ—Ç –ø—Ä–æ–≤–∞–ª–æ–≤:</p>

<ul>
<li><strong>–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å:</strong> –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–æ–≤–µ—Ä—è—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º</li>
<li><strong>–≠–∫–æ–Ω–æ–º–∏—è:</strong> –ò–∑–±–µ–≥–∞–µ—Ç–µ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</li>
</ul>

<h3 data-number="6.0.3" id="—Ç–∏–ø—ã-–≤–∞–ª–∏–¥–∞—Ü–∏–∏-–≤-automl-gluon"><span class="header-section-number">6.0.3</span> –¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ AutoML Gluon</h3>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥—ã–π —Ç–∏–ø —Ä–µ—à–∞–µ—Ç —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏:</p>

<ul>
<li><strong>Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ</li>
<li><strong>Cross-validation:</strong> –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>Time series –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</li>
<li><strong>Stratified –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∫–ª–∞—Å—Å–æ–≤ –≤ –≤—ã–±–æ—Ä–∫–∞—Ö</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="6.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–≤–∞–ª–∏–¥–∞—Ü–∏—é"><span
class="header-section-number">6.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é</h2>

<p><img src="images/validation_methods.png" alt="–ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏" />
<em>–†–∏—Å—É–Ω–æ–∫ 4: –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ AutoML Gluon</em></p>
<p><img src="images/walk_forward_analysis.png"
alt="Walk-Forward –∞–Ω–∞–ª–∏–∑" /> <em>–†–∏—Å—É–Ω–æ–∫ 4.1: Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è -
—Å—Ö–µ–º–∞, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</em></p>

<h3 data-number="6.1.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-–∑–∞—á–µ–º-–æ–Ω–∞-–Ω—É–∂–Ω–∞"><span class="header-section-number">6.1.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∑–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞</h3>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏"?</strong> –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–æ—Ç–æ–≤–∞ –ª–∏ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –º–∏—Ä—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç–µ –ø–∏–ª–æ—Ç–∞ –∫ –ø–æ–ª–µ—Ç—É - –≤–∞–ª–∏–¥–∞—Ü–∏—è —ç—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –æ–Ω –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.</p>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö. –≠—Ç–æ –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—É—á–∏–ª –≤—Å–µ –±–∏–ª–µ—Ç—ã –Ω–∞–∏–∑—É—Å—Ç—å, –Ω–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç.</p>

<h3 data-number="6.1.2" id="–ø—Ä–∏–Ω—Ü–∏–ø—ã-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.1.2</span> –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –ª–æ–∂–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:</p>

<ul>
<li><strong>–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:</strong> –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã "–≤–∏–¥–µ—Ç—å" –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–†–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç—Ä–∞–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</li>
<li><strong>–î–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä:</strong> –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞—Å—Ç –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å:</strong> –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
</ul>

<h3 data-number="6.1.3" id="–º–µ—Ç–æ–¥—ã-–≤–∞–ª–∏–¥–∞—Ü–∏–∏-–≤-automl-gluon"><span class="header-section-number">6.1.3</span> –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ AutoML Gluon</h3>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:</p>

<ul>
<li><strong>Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –ë—ã—Å—Ç—Ä–∞—è –∏ –ø—Ä–æ—Å—Ç–∞—è, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤</li>
<li><strong>Cross-validation:</strong> –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ</li>
<li><strong>Time series –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤, —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É</li>
<li><strong>Stratified –≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong> –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤, –≤–∞–∂–Ω–æ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ul>

<p>–í–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
ML-–º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –í AutoML Gluon –¥–æ—Å—Ç—É–ø–Ω—ã
—Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á.</p>
<h2 data-number="6.2" id="—Ç–∏–ø—ã-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.2</span> –¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 data-number="6.2.1" id="holdout-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.2.1</span> 1. Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>

<h4 data-number="6.2.1.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-holdout-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span class="header-section-number">6.2.1.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Ç–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞: –≤—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª—è–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ - –æ–¥–Ω—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –¥—Ä—É–≥—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –≠—Ç–æ –∫–∞–∫ —ç–∫–∑–∞–º–µ–Ω –≤ —à–∫–æ–ª–µ - –≤—ã —É—á–∏—Ç–µ—Å—å –ø–æ —É—á–µ–±–Ω–∏–∫—É, –∞ —ç–∫–∑–∞–º–µ–Ω —Å–¥–∞–µ—Ç–µ –ø–æ –Ω–æ–≤—ã–º –∑–∞–¥–∞—á–∞–º.</p>

<p><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è?</strong></p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</strong> 80% –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, 20% –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
<li><strong>–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:</strong> –ú–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
<li><strong>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞:</strong> –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</li>
</ol>

<h4 data-number="6.2.1.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-holdout-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.2.1.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h4>

<p><strong>–ü–æ—á–µ–º—É Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –¥–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞:</strong> –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å</li>
<li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–µ–≥–∫–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º</li>
</ul>

<h4 data-number="6.2.1.3" id="–Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏-holdout-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.2.1.3</span> –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h4>

<p><strong>–ü–æ—á–µ–º—É Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</li>
<li><strong>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> 20% –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –æ–±—É—á–µ–Ω–∏–∏</li>
<li><strong>–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å:</strong> –ü–ª–æ—Ö–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–∫–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
<li><strong>–ù–µ–¥–æ–æ—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏:</strong> –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –º–æ–¥–µ–ª—å</li>
</ul>

<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ—Å—Ç–∞—è holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    holdout_frac<span class="op">=</span><span class="fl">0.2</span>  <span class="co"># 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>

<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ holdout_frac=0.2:</strong></p>
<ul>
<li><strong>0.2 –æ–∑–Ω–∞—á–∞–µ—Ç 20%:</strong> 20% –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
<li><strong>80% –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:</strong> –û—Å—Ç–∞–ª—å–Ω—ã–µ 80% –ø–æ–π–¥—É—Ç –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</li>
<li><strong>–°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:</strong> AutoML Gluon —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
<li><strong>–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤</li>
</ul>
<h3 data-number="6.2.2" id="k-fold-–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.2.2</span> 2. K-Fold
–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>

<h4 data-number="6.2.2.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-k-fold-–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span class="header-section-number">6.2.2.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞, —á–µ–º Holdout?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –≠—Ç–æ –∫–∞–∫ —Å–¥–∞—Ç—å 5 —ç–∫–∑–∞–º–µ–Ω–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º.</p>

<p><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è?</strong></p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ K —á–∞—Å—Ç–µ–π:</strong> –î–∞–Ω–Ω—ã–µ –¥–µ–ª—è—Ç—Å—è –Ω–∞ K —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π (–æ–±—ã—á–Ω–æ K=5 –∏–ª–∏ K=10)</li>
<li><strong>K –∏—Ç–µ—Ä–∞—Ü–∏–π:</strong> –í –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–∞ —á–∞—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –æ—Å—Ç–∞–ª—å–Ω—ã–µ K-1 –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</li>
<li><strong>–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:</strong> –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ K-1 —á–∞—Å—Ç—è—Ö</li>
<li><strong>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –ú–æ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏</li>
<li><strong>–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</strong> –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ - —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º K –∏—Ç–µ—Ä–∞—Ü–∏—è–º</li>
</ol>

<h4 data-number="6.2.2.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-k-fold-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span class="header-section-number">6.2.2.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h4>

<p><strong>–ü–æ—á–µ–º—É K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</p>

<ul>
<li><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö:</strong> –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–≤—É–µ—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–∏, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</li>
<li><strong>–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –º–æ–¥–µ–ª—å</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</li>
</ul>

<h4 data-number="6.2.2.3" id="–≤—ã–±–æ—Ä-–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞-—Ñ–æ–ª–¥–æ–≤"><span class="header-section-number">6.2.2.3</span> –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ–ª–¥–æ–≤</h4>

<p><strong>–ü–æ—á–µ–º—É –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç 5 –∏–ª–∏ 10 —Ñ–æ–ª–¥–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é:</p>

<ul>
<li><strong>K=5:</strong> –ë—ã—Å—Ç—Ä–æ, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤</li>
<li><strong>K=10:</strong> –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–±–æ—Ä</li>
<li><strong>K=N (Leave-One-Out):</strong> –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ</li>
</ul>

<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,  <span class="co"># 5-fold CV</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>

<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong></p>
<ul>
<li><strong>num_bag_folds=5:</strong> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 5 —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
<li><strong>num_bag_sets=1:</strong> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞ (1 = —Ç–æ–ª—å–∫–æ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è)</li>
<li><strong>–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> AutoML Gluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤</li>
<li><strong>–°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:</strong> –ö–∞–∂–¥—ã–π —Ä–∞–∑ —Ñ–æ–ª–¥—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ</li>
</ul>
<h3 data-number="6.2.3" id="—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="header-section-number">6.2.3</span> 3. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>

<h4 data-number="6.2.3.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span class="header-section-number">6.2.3.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ 100 —Ä–∞–∑ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–≥–æ. –≠—Ç–æ –∫–∞–∫ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≤—Ä–∞—á–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∑–¥–æ—Ä–æ–≤—ã–º –ø–∞—Ü–∏–µ–Ω—Ç–∞–º.</p>

<p><strong>–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:</strong></p>
<ul>
<li><strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</strong> 99% –∑–¥–æ—Ä–æ–≤—ã—Ö, 1% –±–æ–ª—å–Ω—ã—Ö</li>
<li><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞:</strong> 99.9% –ª–µ–≥–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, 0.1% –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö</li>
<li><strong>–°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä—ã:</strong> 90% –æ–±—ã—á–Ω—ã—Ö –ø–∏—Å–µ–º, 10% —Å–ø–∞–º–∞</li>
</ul>

<h4 data-number="6.2.3.2" id="–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-—Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"><span class="header-section-number">6.2.3.2</span> –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h4>

<p><strong>–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ –±—É–¥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Å—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏—è—Ö:</p>

<ol>
<li><strong>–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:</strong> AutoML Gluon –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤</li>
<li><strong>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π:</strong> –í –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</li>
<li><strong>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:</strong> –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:</strong> –ü–æ–ª—É—á–∞–µ–º —Ç–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤</li>
</ol>

<h4 data-number="6.2.3.3" id="–∫–æ–≥–¥–∞-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å-—Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é"><span class="header-section-number">6.2.3.3</span> –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é</h4>

<p><strong>–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω—É–∂–Ω–∞ –Ω–µ –≤—Å–µ–≥–¥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞:</p>

<ul>
<li><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ö–æ–≥–¥–∞ –∫–ª–∞—Å—Å—ã –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ > 10:1)</li>
<li><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Å—ã (–º–µ–¥–∏—Ü–∏–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)</li>
<li><strong>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã</li>
<li><strong>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã</li>
</ul>

<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span><span class="va">True</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="6.3" id="backtest-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.3</span> Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 data-number="6.3.1"
id="–≤—Ä–µ–º–µ–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">6.3.1</span> –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è
–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> TimeSeriesSplit</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_series_backtest(data, target_col, n_splits<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.sort_values(<span class="st">&#39;timestamp&#39;</span>)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ–ª–¥–æ–≤</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    tscv <span class="op">=</span> TimeSeriesSplit(n_splits<span class="op">=</span>n_splits)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fold, (train_idx, val_idx) <span class="kw">in</span> <span class="bu">enumerate</span>(tscv.split(data)):</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Fold </span><span class="sc">{</span>fold <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n_splits<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>        train_fold <span class="op">=</span> data.iloc[train_idx]</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>        val_fold <span class="op">=</span> data.iloc[val_idx]</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_fold, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(val_fold)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(val_fold)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;fold&#39;</span>: fold <span class="op">+</span> <span class="dv">1</span>,</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a>backtest_results <span class="op">=</span> time_series_backtest(data, <span class="st">&#39;target&#39;</span>, n_splits<span class="op">=</span><span class="dv">5</span>)</span></code></pre></div>
<h3 data-number="6.3.2" id="—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π-backtest"><span
class="header-section-number">6.3.2</span> –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest</h3>
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> advanced_backtest(data, target_col, window_size<span class="op">=</span><span class="dv">1000</span>, step_size<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest —Å —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º&quot;&quot;&quot;</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n_samples <span class="op">-</span> window_size, step_size):</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> start <span class="op">+</span> window_size</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[start:end<span class="op">-</span><span class="dv">100</span>]</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>        val_data <span class="op">=</span> data.iloc[end<span class="op">-</span><span class="dv">100</span>:end]</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(val_data)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(val_data)</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;start&#39;</span>: start,</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;end&#39;</span>: end,</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="6.4" id="walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.4</span> Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 data-number="6.4.1" id="–±–∞–∑–æ–≤–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.4.1</span> –ë–∞–∑–æ–≤–∞—è Walk-Forward
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> walk_forward_validation(data, target_col, train_size<span class="op">=</span><span class="dv">1000</span>, test_size<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(train_size, n_samples <span class="op">-</span> test_size, test_size):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i<span class="op">-</span>train_size:i]</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>test_size]</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;train_start&#39;</span>: i<span class="op">-</span>train_size,</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;train_end&#39;</span>: i,</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;test_start&#39;</span>: i,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;test_end&#39;</span>: i<span class="op">+</span>test_size,</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>wf_results <span class="op">=</span> walk_forward_validation(data, <span class="st">&#39;target&#39;</span>, train_size<span class="op">=</span><span class="dv">1000</span>, test_size<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<h3 data-number="6.4.2" id="–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è-walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.4.2</span> –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb100"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adaptive_walk_forward(data, target_col, min_train_size<span class="op">=</span><span class="dv">500</span>, max_train_size<span class="op">=</span><span class="dv">2000</span>):</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –æ–∫–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    current_train_size <span class="op">=</span> min_train_size</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(min_train_size, n_samples <span class="op">-</span> <span class="dv">100</span>, <span class="dv">100</span>):</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;</span> n_samples <span class="op">//</span> <span class="dv">2</span>:</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>            current_train_size <span class="op">=</span> <span class="bu">min</span>(max_train_size, current_train_size <span class="op">+</span> <span class="dv">100</span>)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i<span class="op">-</span>current_train_size:i]</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span><span class="dv">100</span>]</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;train_size&#39;</span>: current_train_size,</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="6.5" id="monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.5</span> Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 data-number="6.5.1" id="–±–∞–∑–æ–≤—ã–π-monte-carlo"><span
class="header-section-number">6.5.1</span> –ë–∞–∑–æ–≤—ã–π Monte Carlo</h3>
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monte_carlo_validation(data, target_col, n_iterations<span class="op">=</span><span class="dv">100</span>, train_frac<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Å–ª—É—á–∞–π–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(n_iterations):</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.sample(frac<span class="op">=</span>train_frac, random_state<span class="op">=</span>iteration)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.drop(train_data.index)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;iteration&#39;</span>: iteration,</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>mc_results <span class="op">=</span> monte_carlo_validation(data, <span class="st">&#39;target&#39;</span>, n_iterations<span class="op">=</span><span class="dv">100</span>)</span></code></pre></div>
<h3 data-number="6.5.2" id="bootstrap-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.5.2</span> Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap_validation(data, target_col, n_bootstrap<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_bootstrap):</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bootstrap –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>        bootstrap_indices <span class="op">=</span> np.random.choice(n_samples, size<span class="op">=</span>n_samples, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>        bootstrap_data <span class="op">=</span> data.iloc[bootstrap_indices]</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Out-of-bag –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>        oob_indices <span class="op">=</span> np.setdiff1d(np.arange(n_samples), np.unique(bootstrap_indices))</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>        oob_data <span class="op">=</span> data.iloc[oob_indices]</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(oob_data) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>        predictor.fit(bootstrap_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ OOB –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(oob_data)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> predictor.evaluate(oob_data)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bootstrap&#39;</span>: i,</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="6.6" id="–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.6</span> –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 data-number="6.6.1" id="ensemble-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.6.1</span> Ensemble –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ensemble_validation(data, target_col, validation_methods<span class="op">=</span>[<span class="st">&#39;holdout&#39;</span>, <span class="st">&#39;kfold&#39;</span>, <span class="st">&#39;monte_carlo&#39;</span>]):</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;holdout&#39;</span> <span class="kw">in</span> validation_methods:</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>        predictor.fit(data, holdout_frac<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>        results[<span class="st">&#39;holdout&#39;</span>] <span class="op">=</span> predictor.evaluate(data)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># K-fold –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;kfold&#39;</span> <span class="kw">in</span> validation_methods:</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>        predictor.fit(data, num_bag_folds<span class="op">=</span><span class="dv">5</span>, num_bag_sets<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>        results[<span class="st">&#39;kfold&#39;</span>] <span class="op">=</span> predictor.evaluate(data)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;monte_carlo&#39;</span> <span class="kw">in</span> validation_methods:</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>        mc_results <span class="op">=</span> monte_carlo_validation(data, target_col, n_iterations<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>        results[<span class="st">&#39;monte_carlo&#39;</span>] <span class="op">=</span> mc_results</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="6.7" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–ª—è-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">6.7</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</h2>
<h3 data-number="6.7.1" id="—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">6.7.1</span> –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> financial_validation(data, target_col, lookback_window<span class="op">=</span><span class="dv">252</span>, forward_window<span class="op">=</span><span class="dv">21</span>):</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(lookback_window, n_samples <span class="op">-</span> forward_window, forward_window):</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (lookback_window –¥–Ω–µ–π)</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i<span class="op">-</span>lookback_window:i]</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (forward_window –¥–Ω–µ–π)</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>forward_window]</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_col)</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>        predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>        returns <span class="op">=</span> test_data[target_col].pct_change().dropna()</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>        predicted_returns <span class="op">=</span> predictions.pct_change().dropna()</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sharpe Ratio</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>        sharpe_ratio <span class="op">=</span> returns.mean() <span class="op">/</span> returns.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Maximum Drawdown</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>        cumulative_returns <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> returns).cumprod()</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>        peak <span class="op">=</span> cumulative_returns.expanding().<span class="bu">max</span>()</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>        drawdown <span class="op">=</span> (cumulative_returns <span class="op">-</span> peak) <span class="op">/</span> peak</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>        max_drawdown <span class="op">=</span> drawdown.<span class="bu">min</span>()</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;start_date&#39;</span>: test_data.index[<span class="dv">0</span>],</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;end_date&#39;</span>: test_data.index[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_drawdown&#39;</span>: max_drawdown,</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="6.8" id="–∞–Ω–∞–ª–∏–∑-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.8</span> –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 data-number="6.8.1" id="—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑"><span
class="header-section-number">6.8.1</span> –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_validation_results(results):</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    metrics <span class="op">=</span> []</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;performance&#39;</span> <span class="kw">in</span> result:</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>            metrics.append(result[<span class="st">&#39;performance&#39;</span>])</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    analysis <span class="op">=</span> {}</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric <span class="kw">in</span> metrics[<span class="dv">0</span>].keys():</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>        values <span class="op">=</span> [m[metric] <span class="cf">for</span> m <span class="kw">in</span> metrics]</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>        analysis[metric] <span class="op">=</span> {</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mean&#39;</span>: np.mean(values),</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;std&#39;</span>: np.std(values),</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min&#39;</span>: np.<span class="bu">min</span>(values),</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max&#39;</span>: np.<span class="bu">max</span>(values),</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;median&#39;</span>: np.median(values),</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;q25&#39;</span>: np.percentile(values, <span class="dv">25</span>),</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;q75&#39;</span>: np.percentile(values, <span class="dv">75</span>)</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> analysis</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>analysis <span class="op">=</span> analyze_validation_results(backtest_results)</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Validation Analysis:&quot;</span>)</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, stats <span class="kw">in</span> analysis.items():</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>stats[<span class="st">&#39;mean&#39;</span>]<span class="sc">:.4f}</span><span class="ss"> ¬± </span><span class="sc">{</span>stats[<span class="st">&#39;std&#39;</span>]<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="6.8.2" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"><span
class="header-section-number">6.8.2</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_validation_results(results, metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>):</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> []</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;performance&#39;</span> <span class="kw">in</span> result <span class="kw">and</span> metric <span class="kw">in</span> result[<span class="st">&#39;performance&#39;</span>]:</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>            values.append(result[<span class="st">&#39;performance&#39;</span>][metric])</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ì—Ä–∞—Ñ–∏–∫</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    plt.plot(values)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss"> over time&#39;</span>)</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Fold/Iteration&#39;</span>)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(metric)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>    plt.hist(values, bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Distribution of </span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(metric)</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Box plot</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>    plt.boxplot(values)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Box plot of </span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(metric)</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</span></span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>    stats_text <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(values)<span class="sc">:.4f}</span></span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a><span class="ss">    Std: </span><span class="sc">{</span>np<span class="sc">.</span>std(values)<span class="sc">:.4f}</span></span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a><span class="ss">    Min: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">min</span>(values)<span class="sc">:.4f}</span></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a><span class="ss">    Max: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(values)<span class="sc">:.4f}</span></span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    &quot;&quot;&quot;</span></span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a>    plt.text(<span class="fl">0.1</span>, <span class="fl">0.5</span>, stats_text, transform<span class="op">=</span>plt.gca().transAxes, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb106-49"><a href="#cb106-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-50"><a href="#cb106-50" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb106-51"><a href="#cb106-51" aria-hidden="true" tabindex="-1"></a>plot_validation_results(backtest_results, metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span></code></pre></div>
<h2 data-number="6.9" id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã"><span
class="header-section-number">6.9</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</h2>
<h3 data-number="6.9.1" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.9.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span><span class="dv">10000</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    n_redundant<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    n_classes<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;timestamp&#39;</span>] <span class="op">=</span> pd.date_range(<span class="st">&#39;2020-01-01&#39;</span>, periods<span class="op">=</span><span class="bu">len</span>(data), freq<span class="op">=</span><span class="st">&#39;D&#39;</span>)</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.set_index(<span class="st">&#39;timestamp&#39;</span>)</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;=== Holdout Validation ===&quot;</span>)</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>predictor_holdout <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>)</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>predictor_holdout.fit(data, holdout_frac<span class="op">=</span><span class="fl">0.2</span>, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>holdout_performance <span class="op">=</span> predictor_holdout.evaluate(data)</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Holdout Performance: </span><span class="sc">{</span>holdout_performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== K-Fold Validation ===&quot;</span>)</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>predictor_kfold <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>)</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>predictor_kfold.fit(data, num_bag_folds<span class="op">=</span><span class="dv">5</span>, num_bag_sets<span class="op">=</span><span class="dv">1</span>, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>kfold_performance <span class="op">=</span> predictor_kfold.evaluate(data)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;K-Fold Performance: </span><span class="sc">{</span>kfold_performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== Time Series Backtest ===&quot;</span>)</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>backtest_results <span class="op">=</span> time_series_backtest(data, <span class="st">&#39;target&#39;</span>, n_splits<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>backtest_analysis <span class="op">=</span> analyze_validation_results(backtest_results)</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Backtest Analysis: </span><span class="sc">{</span>backtest_analysis<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">=== Monte Carlo Validation ===&quot;</span>)</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a>mc_results <span class="op">=</span> monte_carlo_validation(data, <span class="st">&#39;target&#39;</span>, n_iterations<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a>mc_analysis <span class="op">=</span> analyze_validation_results(mc_results)</span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Monte Carlo Analysis: </span><span class="sc">{</span>mc_analysis<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>plot_validation_results(backtest_results, metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span></code></pre></div>
<h2 data-number="6.10" id="–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.10</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 data-number="6.10.1" id="–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.10.1</span> –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> choose_validation_method(data_type, problem_type, data_size):</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_type <span class="op">==</span> <span class="st">&#39;time_series&#39;</span>:</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;time_series_backtest&#39;</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;kfold&#39;</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;holdout&#39;</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;monte_carlo&#39;</span></span></code></pre></div>
<h3 data-number="6.10.2" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">6.10.2</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_validation_params(data, target_col):</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ–ª–¥–æ–≤</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_samples <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>        n_folds <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> n_samples <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>        n_folds <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>        n_folds <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ holdout</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_samples <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>        holdout_frac <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>        holdout_frac <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_folds&#39;</span>: n_folds,</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;holdout_frac&#39;</span>: holdout_frac,</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_monte_carlo&#39;</span>: <span class="bu">min</span>(<span class="dv">100</span>, n_samples <span class="op">//</span> <span class="dv">10</span>)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<h2 data-number="6.11" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-4"><span
class="header-section-number">6.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a> - <a
href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a> - <a
href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a></p>
<hr />
<h1 data-number="7" id="–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏-–¥–µ–ø–ª–æ–π-automl-gluon-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">7</span> –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π AutoML Gluon
–º–æ–¥–µ–ª–µ–π</h1>
<h2 data-number="7.0" id="–ø–æ—á–µ–º—É-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏-–≤–∞–∂–µ–Ω"><span class="header-section-number">7.0</span> –ü–æ—á–µ–º—É –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É 87% ML-–º–æ–¥–µ–ª–µ–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - —ç—Ç–æ —Ç–æ–ª—å–∫–æ 20% —Ä–∞–±–æ—Ç—ã. –û—Å—Ç–∞–ª—å–Ω—ã–µ 80% - —ç—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞.</p>

<h3 data-number="7.0.1" id="–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ-–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è-–ø–ª–æ—Ö–æ–≥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">7.0.1</span> –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –±–µ–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏?</strong> –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≤–∞–ª–æ–≤:</p>

<ul>
<li><strong>Microsoft Tay:</strong> AI-—á–∞—Ç–±–æ—Ç —Å—Ç–∞–ª —Ä–∞—Å–∏—Å—Ç–æ–º –∑–∞ 24 —á–∞—Å–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</li>
<li><strong>Amazon HR:</strong> AI-—Å–∏—Å—Ç–µ–º–∞ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∏—Ä–æ–≤–∞–ª–∞ –∂–µ–Ω—â–∏–Ω –ø—Ä–∏ –Ω–∞–π–º–µ</li>
<li><strong>Uber —Å–∞–º–æ—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –∞–≤—Ç–æ:</strong> –°–º–µ—Ä—Ç—å –ø–µ—à–µ—Ö–æ–¥–∞ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏</li>
<li><strong>Facebook –∞–ª–≥–æ—Ä–∏—Ç–º:</strong> –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑-–∑–∞ –ø–ª–æ—Ö–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
</ul>

<h3 data-number="7.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">7.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É?</strong> –£—Å–ø–µ—à–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É:</p>

<ul>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> 99.9% uptime, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:</strong> –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å:</strong> –†–µ–∞–ª—å–Ω–∞—è –ø–æ–ª—å–∑–∞ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
</ul>

<h3 data-number="7.0.3" id="—ç—Ç–∞–ø—ã-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏-–∫-–ø—Ä–æ–¥–∞–∫—à–µ–Ω—É"><span class="header-section-number">7.0.3</span> –≠—Ç–∞–ø—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É</h3>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å —á–µ—Ç–∫–∏–º —ç—Ç–∞–ø–∞–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å":</p>

<ol>
<li><strong>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏:</strong> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:</strong> –°–µ—Ä–≤–µ—Ä—ã, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, API</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:</strong> –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–ª–µ—Ä—Ç—ã, –¥–∞—à–±–æ—Ä–¥—ã</li>
<li><strong>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:</strong> –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</li>
</ol>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="7.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–∞–∫—à–µ–Ω"><span
class="header-section-number">7.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</h2>

<p><img src="images/production_architecture.png"
alt="–ü—Ä–æ–¥–∞–∫—à–µ–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞" /> <em>–†–∏—Å—É–Ω–æ–∫ 5: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
—Å–∏—Å—Ç–µ–º—ã AutoML Gluon</em></p>

<h3 data-number="7.1.1" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–≤-ml"><span class="header-section-number">7.1.1</span> –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –≤ ML</h3>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–∞–∫—à–µ–Ω –≤ ML –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ ML-–º–æ–¥–µ–ª–∏ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–¥, –∞ –∂–∏–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∞—Ç—Å—è –∏ –∏–∑–º–µ–Ω—è—é—Ç—Å—è. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∑–∞–≤–æ–¥–æ–º –∏ —Å–∞–¥–æ–º - –∑–∞–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø–ª–∞–Ω—É, –∞ —Å–∞–¥ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —É—Ö–æ–¥–∞.</p>

<p><strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ ML –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:</strong></p>
<ul>
<li><strong>–î–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è:</strong> –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç "–∑–∞–±—ã—Ç—å" —Ç–æ, —á—Ç–æ –∑–Ω–∞–ª–∞</li>
<li><strong>–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä–∏—Ñ—Ç:</strong> –†–µ–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –º–æ–¥–µ–ª–∏</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–∞–Ω–Ω—ã—Ö:</strong> –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö = –Ω–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
<li><strong>–ß–µ—Ä–Ω—ã–π —è—â–∏–∫:</strong> –°–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—è–ª–∞ —Ä–µ—à–µ–Ω–∏–µ</li>
</ul>

<h3 data-number="7.1.2" id="–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º—ã"><span class="header-section-number">7.1.2</span> –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã</h3>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º–∞ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å"?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–∞ —Ü–µ–ª–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã:</p>

<ul>
<li><strong>–ú–æ–¥–µ–ª—å:</strong> –û–±—É—á–µ–Ω–Ω–∞—è –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>API Gateway:</strong> –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</li>
<li><strong>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:</strong> –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:</strong> –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –ó–∞–ø–∏—Å—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</li>
<li><strong>–ê–ª–µ—Ä—Ç—ã:</strong> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö</li>
</ul>

<h3 data-number="7.1.3" id="–≤—ã–∑–æ–≤—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–µ–ø–ª–æ—è"><span class="header-section-number">7.1.3</span> –í—ã–∑–æ–≤—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è</h3>

<p><strong>–ü–æ—á–µ–º—É 70% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–æ–≤–∞–ª–∏–≤–∞—é—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –≥–æ—Ç–æ–≤—ã –∫ —Ä–µ–∞–ª—å–Ω—ã–º –≤—ã–∑–æ–≤–∞–º:</p>

<ul>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –û—Ç 1000 –¥–æ 1,000,000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å</li>
<li><strong>–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∂–¥—É—Ç –æ—Ç–≤–µ—Ç–∞ < 100–º—Å</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> 99.9% uptime –∏–ª–∏ –ø–æ—Ç–µ—Ä—è –∫–ª–∏–µ–Ω—Ç–æ–≤</li>
<li><strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:</strong> –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ –∏ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö</li>
</ul>

<p>–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π ML-–º–æ–¥–µ–ª–µ–π - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø, –∫–æ—Ç–æ—Ä—ã–π
—Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –í —ç—Ç–æ–º
—Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –¥–µ–ø–ª–æ—è AutoML Gluon –º–æ–¥–µ–ª–µ–π –≤
–ø—Ä–æ–¥–∞–∫—à–µ–Ω.</p>
<h2 data-number="7.2" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–º–æ–¥–µ–ª–∏-–∫-–ø—Ä–æ–¥–∞–∫—à–µ–Ω—É"><span
class="header-section-number">7.2</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏ –∫
–ø—Ä–æ–¥–∞–∫—à–µ–Ω—É</h2>
<h3 data-number="7.2.1" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">7.2.1</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h3>

<h4 data-number="7.2.1.1" id="–ø–æ—á–µ–º—É-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏-–≤–∞–∂–Ω–∞"><span class="header-section-number">7.2.1.1</span> –ü–æ—á–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h4>

<p><strong>–ü–æ—á–µ–º—É –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Jupyter, –º–æ–∂–µ—Ç –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø—Ä–µ–¥—ä—è–≤–ª—è–µ—Ç —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –¥—Ä—É–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–∞–º—è—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.</p>

<p><strong>–ü—Ä–æ–±–ª–µ–º—ã –Ω–µ–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:</strong></p>
<ul>
<li><strong>–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:</strong> 5 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 50–º—Å - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–π–¥—É—Ç</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏:</strong> –°–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π</li>
<li><strong>–ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏:</strong> –ù–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä</li>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö</li>
</ul>

<h4 data-number="7.2.1.2" id="–º–µ—Ç–æ–¥—ã-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏-–º–æ–¥–µ–ª–µ–π"><span class="header-section-number">7.2.1.2</span> –ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π</h4>

<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:</p>

<ul>
<li><strong>–ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è:</strong> –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–µ—Å–æ–≤ (float32 ‚Üí float16)</li>
<li><strong>–ü—Ä—É–Ω–∏–Ω–≥:</strong> –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–≤–∞–∂–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤</li>
<li><strong>–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è:</strong> –û–±—É—á–µ–Ω–∏–µ –º–∞–ª–µ–Ω—å–∫–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –±–æ–ª—å—à–æ–π</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:</strong> –í—ã–±–æ—Ä –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
</ul>

<h4 data-number="7.2.1.3" id="–±–∞–ª–∞–Ω—Å-–∫–∞—á–µ—Å—Ç–≤–∞-–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span class="header-section-number">7.2.1.3</span> –ë–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h4>

<p><strong>–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å —Å–∞–º—É—é —Ç–æ—á–Ω—É—é –º–æ–¥–µ–ª—å?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤–∞–∂–Ω—ã –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å, —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</p>

<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å vs –°–∫–æ—Ä–æ—Å—Ç—å:</strong> –ò–Ω–æ–≥–¥–∞ 1% —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç 10x —Å–∫–æ—Ä–æ—Å—Ç–∏</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å vs –ü–∞–º—è—Ç—å:</strong> –ë–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –Ω–µ –ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è –≤ –ø–∞–º—è—Ç—å</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å vs –°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> GPU –¥–æ—Ä–æ–≥–∏–µ, CPU –¥–µ—à–µ–≤–ª–µ</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å vs –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> –ü—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã</li>
</ul>

<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_production_model(train_data, target_col):</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>target_col,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./production_models&#39;</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –¥–µ–ø–ª–æ—è</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;optimize_for_deployment&#39;</span>,</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">3600</span>,  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span><span class="dv">3</span>,   <span class="co"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>        ag_args_fit<span class="op">=</span>{</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">4</span>,</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span></code></pre></div>
<h3 data-number="7.2.2" id="—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-1"><span
class="header-section-number">7.2.2</span> –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compress_model(predictor, model_name):</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    predictor.save(</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>        model_name,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>        save_space<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>        compress<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>        save_info<span class="op">=</span><span class="va">True</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> os</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    model_size <span class="op">=</span> os.path.getsize(<span class="ss">f&quot;</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">/predictor.pkl&quot;</span>) <span class="op">/</span> (<span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>)  <span class="co"># MB</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Model size: </span><span class="sc">{</span>model_size<span class="sc">:.2f}</span><span class="ss"> MB&quot;</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model_size</span></code></pre></div>
<h3 data-number="7.2.3" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">7.2.3</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_production_model(predictor, test_data, performance_thresholds):</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    validation_results <span class="op">=</span> {}</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric, threshold <span class="kw">in</span> performance_thresholds.items():</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> metric <span class="kw">in</span> performance:</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>            validation_results[metric] <span class="op">=</span> performance[metric] <span class="op">&gt;=</span> threshold</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>            validation_results[metric] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">hasattr</span>(predictor, <span class="st">&#39;predict_proba&#39;</span>):</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>        prob_std <span class="op">=</span> probabilities.std().mean()</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>        validation_results[<span class="st">&#39;stability&#39;</span>] <span class="op">=</span> prob_std <span class="op">&lt;</span> <span class="fl">0.1</span>  <span class="co"># –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> validation_results, performance</span></code></pre></div>
<h2 data-number="7.3" id="api-—Å–µ—Ä–≤–µ—Ä-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">7.3</span> API —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 data-number="7.3.1" id="fastapi-—Å–µ—Ä–≤–µ—Ä"><span
class="header-section-number">7.3.1</span> FastAPI —Å–µ—Ä–≤–µ—Ä</h3>
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastapi <span class="im">import</span> FastAPI, HTTPException</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Any</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> FastAPI(title<span class="op">=</span><span class="st">&quot;AutoML Gluon Production API&quot;</span>, version<span class="op">=</span><span class="st">&quot;1.0.0&quot;</span>)</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionRequest(BaseModel):</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—Ö–µ–º–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>    data: List[Dict[<span class="bu">str</span>, Any]]</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionResponse(BaseModel):</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏&quot;&quot;&quot;</span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>    predictions: List[Any]</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>    probabilities: List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>    model_info: Dict[<span class="bu">str</span>, Any]</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>    timestamp: <span class="bu">str</span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HealthResponse(BaseModel):</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ –¥–ª—è health check&quot;&quot;&quot;</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>    status: <span class="bu">str</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>    model_loaded: <span class="bu">bool</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>    model_info: Dict[<span class="bu">str</span>, Any] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a><span class="at">@app.on_event</span>(<span class="st">&quot;startup&quot;</span>)</span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> load_model():</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> model</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;./production_models&#39;</span>)</span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="st">&quot;Model loaded successfully&quot;</span>)</span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Failed to load model: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="at">@app.get</span>(<span class="st">&quot;/health&quot;</span>, response_model<span class="op">=</span>HealthResponse)</span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> health_check():</span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span></span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> HealthResponse(</span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a>            status<span class="op">=</span><span class="st">&quot;unhealthy&quot;</span>,</span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a>            model_loaded<span class="op">=</span><span class="va">False</span></span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> HealthResponse(</span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a>        status<span class="op">=</span><span class="st">&quot;healthy&quot;</span>,</span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a>        model_loaded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a>        model_info<span class="op">=</span>{</span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric</span>
<span id="cb113-65"><a href="#cb113-65" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb113-66"><a href="#cb113-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a><span class="at">@app.post</span>(<span class="st">&quot;/predict&quot;</span>, response_model<span class="op">=</span>PredictionResponse)</span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> predict(request: PredictionRequest):</span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">503</span>, detail<span class="op">=</span><span class="st">&quot;Model not loaded&quot;</span>)</span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-74"><a href="#cb113-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb113-75"><a href="#cb113-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ DataFrame</span></span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(request.data)</span>
<span id="cb113-77"><a href="#cb113-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-78"><a href="#cb113-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb113-79"><a href="#cb113-79" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> model.predict(df)</span>
<span id="cb113-80"><a href="#cb113-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-81"><a href="#cb113-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span></span>
<span id="cb113-82"><a href="#cb113-82" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">None</span></span>
<span id="cb113-83"><a href="#cb113-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;predict_proba&#39;</span>):</span>
<span id="cb113-84"><a href="#cb113-84" aria-hidden="true" tabindex="-1"></a>            proba <span class="op">=</span> model.predict_proba(df)</span>
<span id="cb113-85"><a href="#cb113-85" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> proba.to_dict(<span class="st">&#39;records&#39;</span>)</span>
<span id="cb113-86"><a href="#cb113-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-87"><a href="#cb113-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb113-88"><a href="#cb113-88" aria-hidden="true" tabindex="-1"></a>        model_info <span class="op">=</span> {</span>
<span id="cb113-89"><a href="#cb113-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb113-90"><a href="#cb113-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb113-91"><a href="#cb113-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric,</span>
<span id="cb113-92"><a href="#cb113-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;num_features&quot;</span>: <span class="bu">len</span>(df.columns)</span>
<span id="cb113-93"><a href="#cb113-93" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb113-94"><a href="#cb113-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-95"><a href="#cb113-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> PredictionResponse(</span>
<span id="cb113-96"><a href="#cb113-96" aria-hidden="true" tabindex="-1"></a>            predictions<span class="op">=</span>predictions.tolist(),</span>
<span id="cb113-97"><a href="#cb113-97" aria-hidden="true" tabindex="-1"></a>            probabilities<span class="op">=</span>probabilities,</span>
<span id="cb113-98"><a href="#cb113-98" aria-hidden="true" tabindex="-1"></a>            model_info<span class="op">=</span>model_info,</span>
<span id="cb113-99"><a href="#cb113-99" aria-hidden="true" tabindex="-1"></a>            timestamp<span class="op">=</span>datetime.now().isoformat()</span>
<span id="cb113-100"><a href="#cb113-100" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-101"><a href="#cb113-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-102"><a href="#cb113-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb113-103"><a href="#cb113-103" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Prediction error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb113-104"><a href="#cb113-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">500</span>, detail<span class="op">=</span><span class="bu">str</span>(e))</span>
<span id="cb113-105"><a href="#cb113-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-106"><a href="#cb113-106" aria-hidden="true" tabindex="-1"></a><span class="at">@app.get</span>(<span class="st">&quot;/model/info&quot;</span>)</span>
<span id="cb113-107"><a href="#cb113-107" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> model_info():</span>
<span id="cb113-108"><a href="#cb113-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb113-109"><a href="#cb113-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb113-110"><a href="#cb113-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">503</span>, detail<span class="op">=</span><span class="st">&quot;Model not loaded&quot;</span>)</span>
<span id="cb113-111"><a href="#cb113-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-112"><a href="#cb113-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb113-113"><a href="#cb113-113" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb113-114"><a href="#cb113-114" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb113-115"><a href="#cb113-115" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric,</span>
<span id="cb113-116"><a href="#cb113-116" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;feature_importance&quot;</span>: model.feature_importance().to_dict()</span>
<span id="cb113-117"><a href="#cb113-117" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-118"><a href="#cb113-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-119"><a href="#cb113-119" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb113-120"><a href="#cb113-120" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> uvicorn</span>
<span id="cb113-121"><a href="#cb113-121" aria-hidden="true" tabindex="-1"></a>    uvicorn.run(app, host<span class="op">=</span><span class="st">&quot;0.0.0.0&quot;</span>, port<span class="op">=</span><span class="dv">8000</span>)</span></code></pre></div>
<h3 data-number="7.3.2" id="flask-—Å–µ—Ä–≤–µ—Ä"><span
class="header-section-number">7.3.2</span> Flask —Å–µ—Ä–≤–µ—Ä</h3>
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_model():</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> model</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;./production_models&#39;</span>)</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="st">&quot;Model loaded successfully&quot;</span>)</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Failed to load model: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/health&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> health_check():</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({</span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;status&quot;</span>: <span class="st">&quot;unhealthy&quot;</span>,</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;model_loaded&quot;</span>: <span class="va">False</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>        }), <span class="dv">503</span></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jsonify({</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;status&quot;</span>: <span class="st">&quot;healthy&quot;</span>,</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_loaded&quot;</span>: <span class="va">True</span>,</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_info&quot;</span>: {</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/predict&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict():</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;Model not loaded&quot;</span>}), <span class="dv">503</span></span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> request.get_json()</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;data&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;No data provided&quot;</span>}), <span class="dv">400</span></span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ DataFrame</span></span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(data[<span class="st">&#39;data&#39;</span>])</span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> model.predict(df)</span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span></span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">None</span></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;predict_proba&#39;</span>):</span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a>            proba <span class="op">=</span> model.predict_proba(df)</span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> proba.to_dict(<span class="st">&#39;records&#39;</span>)</span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({</span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;predictions&quot;</span>: predictions.tolist(),</span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;probabilities&quot;</span>: probabilities,</span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;model_info&quot;</span>: {</span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;timestamp&quot;</span>: datetime.now().isoformat()</span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Prediction error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a>        logger.error(traceback.format_exc())</span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="bu">str</span>(e)}), <span class="dv">500</span></span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/model/info&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_info():</span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb114-93"><a href="#cb114-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb114-94"><a href="#cb114-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;Model not loaded&quot;</span>}), <span class="dv">503</span></span>
<span id="cb114-95"><a href="#cb114-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-96"><a href="#cb114-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jsonify({</span>
<span id="cb114-97"><a href="#cb114-97" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_path&quot;</span>: model.path,</span>
<span id="cb114-98"><a href="#cb114-98" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;problem_type&quot;</span>: model.problem_type,</span>
<span id="cb114-99"><a href="#cb114-99" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;eval_metric&quot;</span>: model.eval_metric,</span>
<span id="cb114-100"><a href="#cb114-100" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;feature_importance&quot;</span>: model.feature_importance().to_dict()</span>
<span id="cb114-101"><a href="#cb114-101" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-102"><a href="#cb114-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-103"><a href="#cb114-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb114-104"><a href="#cb114-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> load_model():</span>
<span id="cb114-105"><a href="#cb114-105" aria-hidden="true" tabindex="-1"></a>        app.run(host<span class="op">=</span><span class="st">&quot;0.0.0.0&quot;</span>, port<span class="op">=</span><span class="dv">8000</span>, debug<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb114-106"><a href="#cb114-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb114-107"><a href="#cb114-107" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;Failed to start server - model not loaded&quot;</span>)</span></code></pre></div>
<h2 data-number="7.4" id="docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"><span
class="header-section-number">7.4</span> Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</h2>
<h3 data-number="7.4.1" id="dockerfile-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">7.4.1</span> Dockerfile –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="sourceCode" id="cb115"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dockerfile –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">apt-get</span> update <span class="kw">&amp;&amp;</span> <span class="ex">apt-get</span> install <span class="at">-y</span> <span class="dt">\</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    gcc <span class="dt">\</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    g++ <span class="dt">\</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-rf</span> /var/lib/apt/lists/<span class="pp">*</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ requirements</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">--no-cache-dir</span> <span class="at">-r</span> requirements.txt</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">useradd</span> <span class="at">-m</span> <span class="at">-u</span> 1000 appuser <span class="kw">&amp;&amp;</span> <span class="fu">chown</span> <span class="at">-R</span> appuser:appuser /app</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> appuser</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–∞</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPOSE</span> 8000</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞</span></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;python&quot;</span>, <span class="st">&quot;app.py&quot;</span>]</span></code></pre></div>
<h3 data-number="7.4.2" id="docker-compose-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">7.4.2</span> Docker Compose –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="sourceCode" id="cb116"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># docker-compose.prod.yml</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">autogluon-api</span><span class="kw">:</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> .</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;8000:8000&quot;</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> MODEL_PATH=/app/models</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> LOG_LEVEL=INFO</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./models:/app/models</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./logs:/app/logs</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">healthcheck</span><span class="kw">:</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">test</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;CMD&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;curl&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;-f&quot;</span><span class="kw">,</span><span class="at"> </span><span class="st">&quot;http://localhost:8000/health&quot;</span><span class="kw">]</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">interval</span><span class="kw">:</span><span class="at"> 30s</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">timeout</span><span class="kw">:</span><span class="at"> 10s</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">retries</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">start_period</span><span class="kw">:</span><span class="at"> 40s</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nginx</span><span class="kw">:</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> nginx:alpine</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;80:80&quot;</span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;443:443&quot;</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./nginx.conf:/etc/nginx/nginx.conf</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./ssl:/etc/nginx/ssl</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">depends_on</span><span class="kw">:</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> autogluon-api</span></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">redis</span><span class="kw">:</span></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> redis:alpine</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;6379:6379&quot;</span></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> redis_data:/data</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">redis_data</span><span class="kw">:</span></span></code></pre></div>
<h2 data-number="7.5" id="kubernetes-–¥–µ–ø–ª–æ–π"><span
class="header-section-number">7.5</span> Kubernetes –¥–µ–ø–ª–æ–π</h2>
<h3 data-number="7.5.1" id="deployment-–º–∞–Ω–∏—Ñ–µ—Å—Ç"><span
class="header-section-number">7.5.1</span> Deployment –º–∞–Ω–∏—Ñ–µ—Å—Ç</h3>
<div class="sourceCode" id="cb117"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k8s-deployment.yaml</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> autogluon-api:latest</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8000</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> MODEL_PATH</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;/app/models&quot;</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> LOG_LEVEL</span></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;INFO&quot;</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1Gi&quot;</span></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;500m&quot;</span></span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;2Gi&quot;</span></span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1000m&quot;</span></span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">livenessProbe</span><span class="kw">:</span></span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8000</span></span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">30</span></span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">readinessProbe</span><span class="kw">:</span></span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">httpGet</span><span class="kw">:</span></span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /health</span></span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8000</span></span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">initialDelaySeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">periodSeconds</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">volumeMounts</span><span class="kw">:</span></span>
<span id="cb117-48"><a href="#cb117-48" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> model-storage</span></span>
<span id="cb117-49"><a href="#cb117-49" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /app/models</span></span>
<span id="cb117-50"><a href="#cb117-50" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> log-storage</span></span>
<span id="cb117-51"><a href="#cb117-51" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">mountPath</span><span class="kw">:</span><span class="at"> /app/logs</span></span>
<span id="cb117-52"><a href="#cb117-52" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb117-53"><a href="#cb117-53" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> model-storage</span></span>
<span id="cb117-54"><a href="#cb117-54" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">persistentVolumeClaim</span><span class="kw">:</span></span>
<span id="cb117-55"><a href="#cb117-55" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">claimName</span><span class="kw">:</span><span class="at"> model-pvc</span></span>
<span id="cb117-56"><a href="#cb117-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> log-storage</span></span>
<span id="cb117-57"><a href="#cb117-57" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">persistentVolumeClaim</span><span class="kw">:</span></span>
<span id="cb117-58"><a href="#cb117-58" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">claimName</span><span class="kw">:</span><span class="at"> log-pvc</span></span>
<span id="cb117-59"><a href="#cb117-59" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb117-60"><a href="#cb117-60" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb117-61"><a href="#cb117-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb117-62"><a href="#cb117-62" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb117-63"><a href="#cb117-63" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> autogluon-api-service</span></span>
<span id="cb117-64"><a href="#cb117-64" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb117-65"><a href="#cb117-65" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb117-66"><a href="#cb117-66" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> autogluon-api</span></span>
<span id="cb117-67"><a href="#cb117-67" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb117-68"><a href="#cb117-68" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">protocol</span><span class="kw">:</span><span class="at"> TCP</span></span>
<span id="cb117-69"><a href="#cb117-69" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">80</span></span>
<span id="cb117-70"><a href="#cb117-70" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">8000</span></span>
<span id="cb117-71"><a href="#cb117-71" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> LoadBalancer</span></span>
<span id="cb117-72"><a href="#cb117-72" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb117-73"><a href="#cb117-73" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb117-74"><a href="#cb117-74" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> PersistentVolumeClaim</span></span>
<span id="cb117-75"><a href="#cb117-75" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb117-76"><a href="#cb117-76" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> model-pvc</span></span>
<span id="cb117-77"><a href="#cb117-77" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb117-78"><a href="#cb117-78" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">accessModes</span><span class="kw">:</span></span>
<span id="cb117-79"><a href="#cb117-79" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> ReadWriteOnce</span></span>
<span id="cb117-80"><a href="#cb117-80" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb117-81"><a href="#cb117-81" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb117-82"><a href="#cb117-82" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> 10Gi</span></span>
<span id="cb117-83"><a href="#cb117-83" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb117-84"><a href="#cb117-84" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb117-85"><a href="#cb117-85" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> PersistentVolumeClaim</span></span>
<span id="cb117-86"><a href="#cb117-86" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb117-87"><a href="#cb117-87" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> log-pvc</span></span>
<span id="cb117-88"><a href="#cb117-88" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb117-89"><a href="#cb117-89" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">accessModes</span><span class="kw">:</span></span>
<span id="cb117-90"><a href="#cb117-90" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> ReadWriteOnce</span></span>
<span id="cb117-91"><a href="#cb117-91" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb117-92"><a href="#cb117-92" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb117-93"><a href="#cb117-93" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">storage</span><span class="kw">:</span><span class="at"> 5Gi</span></span></code></pre></div>
<h2 data-number="7.6" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">7.6</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 data-number="7.6.1" id="—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">7.6.1</span> –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psutil</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Any</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProductionMonitor:</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, log_file<span class="op">=</span><span class="st">&#39;production.log&#39;</span>):</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_file <span class="op">=</span> log_file</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_logging()</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> {}</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_logging(<span class="va">self</span>):</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>logging.INFO,</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(name)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>,</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>            handlers<span class="op">=</span>[</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>                logging.FileHandler(<span class="va">self</span>.log_file),</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>                logging.StreamHandler()</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_prediction(<span class="va">self</span>, input_data: Dict, prediction: Any, </span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>                      processing_time: <span class="bu">float</span>, model_info: Dict):</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>        log_entry <span class="op">=</span> {</span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;input_data&#39;</span>: input_data,</span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction&#39;</span>: prediction,</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;processing_time&#39;</span>: processing_time,</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_info&#39;</span>: model_info</span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Prediction: </span><span class="sc">{</span>log_entry<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_error(<span class="va">self</span>, error: <span class="pp">Exception</span>, context: Dict):</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>        error_entry <span class="op">=</span> {</span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(error),</span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;context&#39;</span>: context,</span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;traceback&#39;</span>: traceback.format_exc()</span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.error(<span class="ss">f&quot;Error: </span><span class="sc">{</span>error_entry<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_system_metrics(<span class="va">self</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_percent&#39;</span>: psutil.cpu_percent(),</span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_percent&#39;</span>: psutil.virtual_memory().percent,</span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;disk_percent&#39;</span>: psutil.disk_usage(<span class="st">&#39;/&#39;</span>).percent,</span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_model_health(<span class="va">self</span>, model) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a>            test_data <span class="op">=</span> pd.DataFrame({<span class="st">&#39;feature1&#39;</span>: [<span class="fl">1.0</span>], <span class="st">&#39;feature2&#39;</span>: [<span class="fl">2.0</span>]})</span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a>            start_time <span class="op">=</span> time.time()</span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a>            prediction <span class="op">=</span> model.predict(test_data)</span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a>            processing_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;status&#39;</span>: <span class="st">&#39;healthy&#39;</span>,</span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;processing_time&#39;</span>: processing_time,</span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;status&#39;</span>: <span class="st">&#39;unhealthy&#39;</span>,</span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e),</span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a>            }</span></code></pre></div>
<h3 data-number="7.6.2" id="–∞–ª–µ—Ä—Ç—ã-–∏-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"><span
class="header-section-number">7.6.2</span> –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb119"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AlertSystem:</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, smtp_server, smtp_port, email, password):</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.smtp_server <span class="op">=</span> smtp_server</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.smtp_port <span class="op">=</span> smtp_port</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.email <span class="op">=</span> email</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password <span class="op">=</span> password</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_email_alert(<span class="va">self</span>, subject: <span class="bu">str</span>, message: <span class="bu">str</span>, recipients: <span class="bu">list</span>):</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ email –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>            msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>            msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> <span class="va">self</span>.email</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>            msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> <span class="st">&#39;, &#39;</span>.join(recipients)</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>            msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> subject</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>            msg.attach(MIMEText(message, <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>            server <span class="op">=</span> smtplib.SMTP(<span class="va">self</span>.smtp_server, <span class="va">self</span>.smtp_port)</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>            server.starttls()</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>            server.login(<span class="va">self</span>.email, <span class="va">self</span>.password)</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>            server.send_message(msg)</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>            server.quit()</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Email alert sent to </span><span class="sc">{</span>recipients<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Failed to send email alert: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_slack_alert(<span class="va">self</span>, webhook_url: <span class="bu">str</span>, message: <span class="bu">str</span>):</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ Slack –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>            payload <span class="op">=</span> {</span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;text&quot;</span>: message,</span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;username&quot;</span>: <span class="st">&quot;AutoML Gluon Monitor&quot;</span>,</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;icon_emoji&quot;</span>: <span class="st">&quot;:robot_face:&quot;</span></span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.post(webhook_url, json<span class="op">=</span>payload)</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Slack alert sent successfully&quot;</span>)</span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Failed to send Slack alert: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_performance_thresholds(<span class="va">self</span>, metrics: Dict[<span class="bu">str</span>, <span class="bu">float</span>], </span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a>                                   thresholds: Dict[<span class="bu">str</span>, <span class="bu">float</span>]):</span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>        alerts <span class="op">=</span> []</span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric, threshold <span class="kw">in</span> thresholds.items():</span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric <span class="kw">in</span> metrics <span class="kw">and</span> metrics[metric] <span class="op">&lt;</span> threshold:</span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>                alerts.append(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss"> is below threshold: </span><span class="sc">{</span>metrics[metric]<span class="sc">}</span><span class="ss"> &lt; </span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> alerts</span></code></pre></div>
<h2 data-number="7.7" id="–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">7.7</span> –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 data-number="7.7.1" id="–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">7.7.1</span> –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ
–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="sourceCode" id="cb120"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> queue</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> threading</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ScalablePredictionService:</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, max_workers<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_workers <span class="op">=</span> max_workers</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.executor <span class="op">=</span> ThreadPoolExecutor(max_workers<span class="op">=</span>max_workers)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.request_queue <span class="op">=</span> queue.Queue()</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.result_queue <span class="op">=</span> queue.Queue()</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_prediction(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> Dict:</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>        loop <span class="op">=</span> asyncio.get_event_loop()</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="cf">await</span> loop.run_in_executor(</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.executor, </span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._predict_sync, </span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>            data</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _predict_sync(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> Dict:</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> batch_predict(<span class="va">self</span>, batch_data: List[Dict]) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> []</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –±–∞—Ç—á–∏</span></span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>        batch_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(batch_data), batch_size):</span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>            batch <span class="op">=</span> batch_data[i:i<span class="op">+</span>batch_size]</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞</span></span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="va">self</span>.max_workers) <span class="im">as</span> executor:</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>                futures <span class="op">=</span> [executor.submit(<span class="va">self</span>._predict_sync, data) <span class="cf">for</span> data <span class="kw">in</span> batch]</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>                batch_results <span class="op">=</span> [future.result() <span class="cf">for</span> future <span class="kw">in</span> futures]</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>                results.extend(batch_results)</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span></code></pre></div>
<h3 data-number="7.7.2" id="–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">7.7.2</span> –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> redis</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Any, Optional</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionCache:</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö—ç—à –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, redis_host<span class="op">=</span><span class="st">&#39;localhost&#39;</span>, redis_port<span class="op">=</span><span class="dv">6379</span>, ttl<span class="op">=</span><span class="dv">3600</span>):</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.redis_client <span class="op">=</span> redis.Redis(host<span class="op">=</span>redis_host, port<span class="op">=</span>redis_port, decode_responses<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ttl <span class="op">=</span> ttl</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _generate_cache_key(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>        data_str <span class="op">=</span> json.dumps(data, sort_keys<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> hashlib.md5(data_str.encode()).hexdigest()</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_prediction(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> Optional[Dict]:</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–∑ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>        cache_key <span class="op">=</span> <span class="va">self</span>._generate_cache_key(data)</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>        cached_result <span class="op">=</span> <span class="va">self</span>.redis_client.get(cache_key)</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cached_result:</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> json.loads(cached_result)</span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_prediction(<span class="va">self</span>, data: Dict, prediction: Dict):</span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –∫—ç—à&quot;&quot;&quot;</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>        cache_key <span class="op">=</span> <span class="va">self</span>._generate_cache_key(data)</span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.redis_client.setex(</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>            cache_key, </span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.ttl, </span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>            json.dumps(prediction)</span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> invalidate_cache(<span class="va">self</span>, pattern: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;*&quot;</span>):</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>        keys <span class="op">=</span> <span class="va">self</span>.redis_client.keys(pattern)</span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keys:</span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.redis_client.delete(<span class="op">*</span>keys)</span></code></pre></div>
<h2 data-number="7.8" id="–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"><span
class="header-section-number">7.8</span> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
<h3 data-number="7.8.1" id="–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"><span
class="header-section-number">7.8.1</span> –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏
–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> secrets</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecurityManager:</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–µ–Ω–µ–¥–∂–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, secret_key: <span class="bu">str</span>):</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.secret_key <span class="op">=</span> secret_key</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.api_keys <span class="op">=</span> {}</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_api_key(<span class="va">self</span>, user_id: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª—é—á–∞&quot;&quot;&quot;</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>        api_key <span class="op">=</span> secrets.token_urlsafe(<span class="dv">32</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.api_keys[api_key] <span class="op">=</span> {</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;user_id&#39;</span>: user_id,</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;created_at&#39;</span>: datetime.now(),</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;permissions&#39;</span>: [<span class="st">&#39;predict&#39;</span>, <span class="st">&#39;model_info&#39;</span>]</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> api_key</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_api_key(<span class="va">self</span>, api_key: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è API –∫–ª—é—á–∞&quot;&quot;&quot;</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> api_key <span class="kw">in</span> <span class="va">self</span>.api_keys</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_user_permissions(<span class="va">self</span>, api_key: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> api_key <span class="kw">in</span> <span class="va">self</span>.api_keys:</span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.api_keys[api_key][<span class="st">&#39;permissions&#39;</span>]</span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> require_auth(<span class="va">self</span>, permissions: <span class="bu">list</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> decorator(f):</span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">@wraps</span>(f)</span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> decorated_function(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞</span></span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>                api_key <span class="op">=</span> request.headers.get(<span class="st">&#39;X-API-Key&#39;</span>)</span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> api_key <span class="kw">or</span> <span class="kw">not</span> <span class="va">self</span>.validate_api_key(api_key):</span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> jsonify({<span class="st">&#39;error&#39;</span>: <span class="st">&#39;Invalid API key&#39;</span>}), <span class="dv">401</span></span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π</span></span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> permissions:</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>                    user_permissions <span class="op">=</span> <span class="va">self</span>.get_user_permissions(api_key)</span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">any</span>(perm <span class="kw">in</span> user_permissions <span class="cf">for</span> perm <span class="kw">in</span> permissions):</span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> jsonify({<span class="st">&#39;error&#39;</span>: <span class="st">&#39;Insufficient permissions&#39;</span>}), <span class="dv">403</span></span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> f(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> decorated_function</span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> decorator</span></code></pre></div>
<h3 data-number="7.8.2" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤—Ö–æ–¥–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">7.8.2</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel, validator</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Union</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> InputValidator:</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ç–æ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, feature_schema: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_schema <span class="op">=</span> feature_schema</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_input(<span class="va">self</span>, data: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> record <span class="kw">in</span> data:</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> feature, schema <span class="kw">in</span> <span class="va">self</span>.feature_schema.items():</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> feature <span class="kw">not</span> <span class="kw">in</span> record:</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f&quot;Missing required feature: </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(record[feature], schema[<span class="st">&#39;type&#39;</span>]):</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f&quot;Invalid type for feature </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;min&#39;</span> <span class="kw">in</span> schema <span class="kw">and</span> record[feature] <span class="op">&lt;</span> schema[<span class="st">&#39;min&#39;</span>]:</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f&quot;Value too small for feature </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;max&#39;</span> <span class="kw">in</span> schema <span class="kw">and</span> record[feature] <span class="op">&gt;</span> schema[<span class="st">&#39;max&#39;</span>]:</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f&quot;Value too large for feature </span><span class="sc">{</span>feature<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Validation error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_input(<span class="va">self</span>, data: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>        sanitized_data <span class="op">=</span> []</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> record <span class="kw">in</span> data:</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>            sanitized_record <span class="op">=</span> {}</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> feature, value <span class="kw">in</span> record.items():</span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û—á–∏—Å—Ç–∫–∞ –æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤</span></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">str</span>):</span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>                    sanitized_record[feature] <span class="op">=</span> value.strip()</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>                    sanitized_record[feature] <span class="op">=</span> value</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>            sanitized_data.append(sanitized_record)</span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized_data</span></code></pre></div>
<h2 data-number="7.9" id="—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">7.9</span> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="7.9.1" id="–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">7.9.1</span> –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aiohttp</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statistics</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LoadTester:</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API&quot;&quot;&quot;</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, base_url: <span class="bu">str</span>):</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.base_url <span class="op">=</span> base_url</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results <span class="op">=</span> []</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> single_request(<span class="va">self</span>, session: aiohttp.ClientSession, </span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>                           data: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–¥–∏–Ω–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å&quot;&quot;&quot;</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> time.time()</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">async</span> <span class="cf">with</span> session.post(</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>base_url<span class="sc">}</span><span class="ss">/predict&quot;</span>,</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>                json<span class="op">=</span>{<span class="st">&quot;data&quot;</span>: [data]}</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>            ) <span class="im">as</span> response:</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="cf">await</span> response.json()</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>                processing_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;status_code&#39;</span>: response.status,</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;processing_time&#39;</span>: processing_time,</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;success&#39;</span>: response.status <span class="op">==</span> <span class="dv">200</span>,</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;result&#39;</span>: result</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;status_code&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;processing_time&#39;</span>: time.time() <span class="op">-</span> start_time,</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;success&#39;</span>: <span class="va">False</span>,</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e)</span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-41"><a href="#cb124-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> load_test(<span class="va">self</span>, concurrent_users: <span class="bu">int</span>, </span>
<span id="cb124-42"><a href="#cb124-42" aria-hidden="true" tabindex="-1"></a>                       requests_per_user: <span class="bu">int</span>, </span>
<span id="cb124-43"><a href="#cb124-43" aria-hidden="true" tabindex="-1"></a>                       test_data: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb124-44"><a href="#cb124-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb124-45"><a href="#cb124-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="cf">with</span> aiohttp.ClientSession() <span class="im">as</span> session:</span>
<span id="cb124-46"><a href="#cb124-46" aria-hidden="true" tabindex="-1"></a>            tasks <span class="op">=</span> []</span>
<span id="cb124-47"><a href="#cb124-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb124-48"><a href="#cb124-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> user <span class="kw">in</span> <span class="bu">range</span>(concurrent_users):</span>
<span id="cb124-49"><a href="#cb124-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> request <span class="kw">in</span> <span class="bu">range</span>(requests_per_user):</span>
<span id="cb124-50"><a href="#cb124-50" aria-hidden="true" tabindex="-1"></a>                    data <span class="op">=</span> test_data[request <span class="op">%</span> <span class="bu">len</span>(test_data)]</span>
<span id="cb124-51"><a href="#cb124-51" aria-hidden="true" tabindex="-1"></a>                    task <span class="op">=</span> <span class="va">self</span>.single_request(session, data)</span>
<span id="cb124-52"><a href="#cb124-52" aria-hidden="true" tabindex="-1"></a>                    tasks.append(task)</span>
<span id="cb124-53"><a href="#cb124-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb124-54"><a href="#cb124-54" aria-hidden="true" tabindex="-1"></a>            results <span class="op">=</span> <span class="cf">await</span> asyncio.gather(<span class="op">*</span>tasks)</span>
<span id="cb124-55"><a href="#cb124-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb124-56"><a href="#cb124-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb124-57"><a href="#cb124-57" aria-hidden="true" tabindex="-1"></a>        successful_requests <span class="op">=</span> [r <span class="cf">for</span> r <span class="kw">in</span> results <span class="cf">if</span> r[<span class="st">&#39;success&#39;</span>]]</span>
<span id="cb124-58"><a href="#cb124-58" aria-hidden="true" tabindex="-1"></a>        failed_requests <span class="op">=</span> [r <span class="cf">for</span> r <span class="kw">in</span> results <span class="cf">if</span> <span class="kw">not</span> r[<span class="st">&#39;success&#39;</span>]]</span>
<span id="cb124-59"><a href="#cb124-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb124-60"><a href="#cb124-60" aria-hidden="true" tabindex="-1"></a>        processing_times <span class="op">=</span> [r[<span class="st">&#39;processing_time&#39;</span>] <span class="cf">for</span> r <span class="kw">in</span> successful_requests]</span>
<span id="cb124-61"><a href="#cb124-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb124-62"><a href="#cb124-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb124-63"><a href="#cb124-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;total_requests&#39;</span>: <span class="bu">len</span>(results),</span>
<span id="cb124-64"><a href="#cb124-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;successful_requests&#39;</span>: <span class="bu">len</span>(successful_requests),</span>
<span id="cb124-65"><a href="#cb124-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;failed_requests&#39;</span>: <span class="bu">len</span>(failed_requests),</span>
<span id="cb124-66"><a href="#cb124-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;success_rate&#39;</span>: <span class="bu">len</span>(successful_requests) <span class="op">/</span> <span class="bu">len</span>(results),</span>
<span id="cb124-67"><a href="#cb124-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;avg_processing_time&#39;</span>: statistics.mean(processing_times),</span>
<span id="cb124-68"><a href="#cb124-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_processing_time&#39;</span>: <span class="bu">min</span>(processing_times),</span>
<span id="cb124-69"><a href="#cb124-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_processing_time&#39;</span>: <span class="bu">max</span>(processing_times),</span>
<span id="cb124-70"><a href="#cb124-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;p95_processing_time&#39;</span>: statistics.quantiles(processing_times, n<span class="op">=</span><span class="dv">20</span>)[<span class="dv">18</span>]</span>
<span id="cb124-71"><a href="#cb124-71" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="7.10" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-5"><span
class="header-section-number">7.10</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a> - <a
href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a> - <a
href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></p>
<hr />
<h1 data-number="8" id="–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π-automl-gluon"><span
class="header-section-number">8</span> –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π AutoML
Gluon</h1>
<h2 data-number="8.0" id="–ø–æ—á–µ–º—É-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">8.0</span> –ü–æ—á–µ–º—É –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="8.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π"><span class="header-section-number">8.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="8.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π"><span class="header-section-number">8.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="8.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">8.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h2>
<p><img src="images/retraining_workflow.png"
alt="–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è" /> <em>–†–∏—Å—É–Ω–æ–∫ 6: –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
–º–æ–¥–µ–ª–µ–π AutoML Gluon</em></p>
<p>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (retraining) - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è
–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ ML-–º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ
—Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.</p>
<h2 data-number="8.2" id="—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">8.2</span> –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 data-number="8.2.1" id="–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">8.2.1</span> 1. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> schedule</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PeriodicRetraining:</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_path: <span class="bu">str</span>, retraining_interval: <span class="bu">int</span> <span class="op">=</span> <span class="dv">7</span>):</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_path <span class="op">=</span> model_path</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retraining_interval <span class="op">=</span> retraining_interval  <span class="co"># –¥–Ω–∏</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> schedule_retraining(<span class="va">self</span>):</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>        schedule.every().week.do(<span class="va">self</span>.retrain_model)</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>        schedule.every().day.do(<span class="va">self</span>.check_retraining_need)</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞</span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>            schedule.run_pending()</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">3600</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retrain_model(<span class="va">self</span>):</span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;Starting model retraining...&quot;</span>)</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>            new_data <span class="op">=</span> <span class="va">self</span>.load_new_data()</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>            predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>                path<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>model_path<span class="sc">}</span><span class="ss">_new&quot;</span></span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>            predictor.fit(new_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.validate_new_model(predictor):</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.deploy_new_model(predictor)</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">&quot;Model retraining completed successfully&quot;</span>)</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;New model validation failed, keeping old model&quot;</span>)</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Model retraining failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_retraining_need(<span class="va">self</span>):</span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a>        current_performance <span class="op">=</span> <span class="va">self</span>.evaluate_current_model()</span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a>        data_drift <span class="op">=</span> <span class="va">self</span>.check_data_drift()</span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a>        last_retraining <span class="op">=</span> <span class="va">self</span>.get_last_retraining_time()</span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a>        days_since_retraining <span class="op">=</span> (datetime.now() <span class="op">-</span> last_retraining).days</span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (current_performance <span class="op">&lt;</span> <span class="fl">0.8</span> <span class="kw">or</span> </span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a>            data_drift <span class="op">&gt;</span> <span class="fl">0.1</span> <span class="kw">or</span> </span>
<span id="cb125-72"><a href="#cb125-72" aria-hidden="true" tabindex="-1"></a>            days_since_retraining <span class="op">&gt;=</span> <span class="va">self</span>.retraining_interval):</span>
<span id="cb125-73"><a href="#cb125-73" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;Retraining needed based on criteria&quot;</span>)</span>
<span id="cb125-74"><a href="#cb125-74" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.retrain_model()</span></code></pre></div>
<h3 data-number="8.2.2" id="–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">8.2.2</span> 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb126"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdaptiveRetraining:</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_path: <span class="bu">str</span>, performance_threshold: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.8</span>):</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_path <span class="op">=</span> model_path</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_threshold <span class="op">=</span> performance_threshold</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_history <span class="op">=</span> []</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_performance(<span class="va">self</span>, predictions: <span class="bu">list</span>, actuals: <span class="bu">list</span>):</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>        current_performance <span class="op">=</span> <span class="va">self</span>.calculate_performance(predictions, actuals)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_history.append({</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now(),</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: current_performance</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.detect_performance_degradation():</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.warning(<span class="st">&quot;Performance degradation detected&quot;</span>)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.trigger_retraining()</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_performance_degradation(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.performance_history) <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∏–∑–º–µ—Ä–µ–Ω–∏–π</span></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>        recent_performance <span class="op">=</span> [p[<span class="st">&#39;performance&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.performance_history[<span class="op">-</span><span class="dv">10</span>:]]</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (recent_performance[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> <span class="va">self</span>.performance_threshold <span class="kw">and</span></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>            recent_performance[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> recent_performance[<span class="dv">0</span>]):</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> trigger_retraining(<span class="va">self</span>):</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">&quot;Triggering adaptive retraining...&quot;</span>)</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>        retraining_data <span class="op">=</span> <span class="va">self</span>.load_retraining_data()</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>model_path<span class="sc">}</span><span class="ss">_adaptive&quot;</span></span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a>        predictor.fit(retraining_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –¥–µ–ø–ª–æ–π</span></span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.validate_new_model(predictor):</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.deploy_new_model(predictor)</span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.performance_history <span class="op">=</span> []  <span class="co"># –°–±—Ä–æ—Å –∏—Å—Ç–æ—Ä–∏–∏</span></span></code></pre></div>
<h3 data-number="8.2.3" id="–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">8.2.3</span> 3. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> IncrementalRetraining:</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–Ω–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_path: <span class="bu">str</span>, batch_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>):</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_path <span class="op">=</span> model_path</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch_size <span class="op">=</span> batch_size</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> incremental_update(<span class="va">self</span>, new_data: pd.DataFrame):</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>            current_predictor <span class="op">=</span> TabularPredictor.load(<span class="va">self</span>.model_path)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>            combined_data <span class="op">=</span> <span class="va">self</span>.combine_data(current_predictor, new_data)</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>            updated_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>                path<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>model_path<span class="sc">}</span><span class="ss">_updated&quot;</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>            updated_predictor.fit(combined_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.validate_updated_model(updated_predictor):</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.deploy_updated_model(updated_predictor)</span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">&quot;Incremental update completed&quot;</span>)</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;Updated model validation failed&quot;</span>)</span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Incremental update failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> combine_data(<span class="va">self</span>, current_predictor, new_data: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)</span></span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a>        old_data <span class="op">=</span> <span class="va">self</span>.extract_old_data(current_predictor)</span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> old_data <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a>            combined_data <span class="op">=</span> pd.concat([old_data, new_data], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a>            combined_data <span class="op">=</span> new_data</span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> combined_data</span></code></pre></div>
<h2 data-number="8.3" id="–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">8.3</span> –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 data-number="8.3.1" id="—Å–∏—Å—Ç–µ–º–∞-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">8.3.1</span> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb128"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aiohttp</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Any</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AutomatedRetrainingSystem:</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> config</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retraining_queue <span class="op">=</span> asyncio.Queue()</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.is_retraining <span class="op">=</span> <span class="va">False</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> start_monitoring(<span class="va">self</span>):</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>        tasks <span class="op">=</span> [</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_data_quality(),</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_model_performance(),</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_data_drift(),</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.process_retraining_queue()</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> asyncio.gather(<span class="op">*</span>tasks)</span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_data_quality(<span class="va">self</span>):</span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>                data_quality <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.check_data_quality()</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> data_quality[<span class="st">&#39;score&#39;</span>] <span class="op">&lt;</span> <span class="va">self</span>.config[<span class="st">&#39;data_quality_threshold&#39;</span>]:</span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Data quality issue: </span><span class="sc">{</span>data_quality<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;data_quality&#39;</span>)</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">3600</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Data quality monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_model_performance(<span class="va">self</span>):</span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a>                performance <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.get_model_performance()</span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> performance[<span class="st">&#39;accuracy&#39;</span>] <span class="op">&lt;</span> <span class="va">self</span>.config[<span class="st">&#39;performance_threshold&#39;</span>]:</span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Performance degradation: </span><span class="sc">{</span>performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;performance&#39;</span>)</span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">1800</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Performance monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_data_drift(<span class="va">self</span>):</span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb128-65"><a href="#cb128-65" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb128-66"><a href="#cb128-66" aria-hidden="true" tabindex="-1"></a>                drift_score <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.check_data_drift()</span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drift_score <span class="op">&gt;</span> <span class="va">self</span>.config[<span class="st">&#39;drift_threshold&#39;</span>]:</span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Data drift detected: </span><span class="sc">{</span>drift_score<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;data_drift&#39;</span>)</span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-72"><a href="#cb128-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">7200</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞</span></span>
<span id="cb128-73"><a href="#cb128-73" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb128-75"><a href="#cb128-75" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Data drift monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-76"><a href="#cb128-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb128-77"><a href="#cb128-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-78"><a href="#cb128-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> trigger_retraining(<span class="va">self</span>, reason: <span class="bu">str</span>):</span>
<span id="cb128-79"><a href="#cb128-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb128-80"><a href="#cb128-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.is_retraining:</span>
<span id="cb128-81"><a href="#cb128-81" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;Retraining already in progress&quot;</span>)</span>
<span id="cb128-82"><a href="#cb128-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb128-83"><a href="#cb128-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb128-84"><a href="#cb128-84" aria-hidden="true" tabindex="-1"></a>        retraining_request <span class="op">=</span> {</span>
<span id="cb128-85"><a href="#cb128-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb128-86"><a href="#cb128-86" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reason&#39;</span>: reason,</span>
<span id="cb128-87"><a href="#cb128-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;priority&#39;</span>: <span class="va">self</span>.get_retraining_priority(reason)</span>
<span id="cb128-88"><a href="#cb128-88" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb128-89"><a href="#cb128-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb128-90"><a href="#cb128-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="va">self</span>.retraining_queue.put(retraining_request)</span>
<span id="cb128-91"><a href="#cb128-91" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Retraining queued: </span><span class="sc">{</span>retraining_request<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-92"><a href="#cb128-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-93"><a href="#cb128-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> process_retraining_queue(<span class="va">self</span>):</span>
<span id="cb128-94"><a href="#cb128-94" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb128-95"><a href="#cb128-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb128-96"><a href="#cb128-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb128-97"><a href="#cb128-97" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb128-98"><a href="#cb128-98" aria-hidden="true" tabindex="-1"></a>                request <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.retraining_queue.get()</span>
<span id="cb128-99"><a href="#cb128-99" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-100"><a href="#cb128-100" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb128-101"><a href="#cb128-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> <span class="va">self</span>.execute_retraining(request)</span>
<span id="cb128-102"><a href="#cb128-102" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-103"><a href="#cb128-103" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.retraining_queue.task_done()</span>
<span id="cb128-104"><a href="#cb128-104" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb128-105"><a href="#cb128-105" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb128-106"><a href="#cb128-106" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Retraining processing error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-107"><a href="#cb128-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb128-108"><a href="#cb128-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-109"><a href="#cb128-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> execute_retraining(<span class="va">self</span>, request: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb128-110"><a href="#cb128-110" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb128-111"><a href="#cb128-111" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.is_retraining <span class="op">=</span> <span class="va">True</span></span>
<span id="cb128-112"><a href="#cb128-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb128-113"><a href="#cb128-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb128-114"><a href="#cb128-114" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;Starting retraining: </span><span class="sc">{</span>request<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-115"><a href="#cb128-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb128-116"><a href="#cb128-116" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb128-117"><a href="#cb128-117" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.load_retraining_data()</span>
<span id="cb128-118"><a href="#cb128-118" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb128-119"><a href="#cb128-119" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb128-120"><a href="#cb128-120" aria-hidden="true" tabindex="-1"></a>            predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb128-121"><a href="#cb128-121" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb128-122"><a href="#cb128-122" aria-hidden="true" tabindex="-1"></a>                path<span class="op">=</span><span class="ss">f&quot;./models/retrained_</span><span class="sc">{</span>request[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb128-123"><a href="#cb128-123" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb128-124"><a href="#cb128-124" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb128-125"><a href="#cb128-125" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb128-126"><a href="#cb128-126" aria-hidden="true" tabindex="-1"></a>            predictor.fit(data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb128-127"><a href="#cb128-127" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb128-128"><a href="#cb128-128" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb128-129"><a href="#cb128-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="cf">await</span> <span class="va">self</span>.validate_new_model(predictor):</span>
<span id="cb128-130"><a href="#cb128-130" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb128-131"><a href="#cb128-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> <span class="va">self</span>.deploy_new_model(predictor)</span>
<span id="cb128-132"><a href="#cb128-132" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">&quot;Retraining completed successfully&quot;</span>)</span>
<span id="cb128-133"><a href="#cb128-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb128-134"><a href="#cb128-134" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;New model validation failed&quot;</span>)</span>
<span id="cb128-135"><a href="#cb128-135" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb128-136"><a href="#cb128-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb128-137"><a href="#cb128-137" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Retraining execution failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb128-138"><a href="#cb128-138" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb128-139"><a href="#cb128-139" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.is_retraining <span class="op">=</span> <span class="va">False</span></span></code></pre></div>
<h2 data-number="8.4" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">8.4</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö
–º–æ–¥–µ–ª–µ–π</h2>
<h3 data-number="8.4.1" id="—Å–∏—Å—Ç–µ–º–∞-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">8.4.1</span> –°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb129"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RetrainingValidator:</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ç–æ—Ä –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, validation_config: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> validation_config</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> validate_new_model(<span class="va">self</span>, new_predictor, old_predictor<span class="op">=</span><span class="va">None</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>            test_data <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.load_test_data()</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>            new_predictions <span class="op">=</span> new_predictor.predict(test_data)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>            new_performance <span class="op">=</span> new_predictor.evaluate(test_data)</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª—å—é (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> old_predictor <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>                old_predictions <span class="op">=</span> old_predictor.predict(test_data)</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>                old_performance <span class="op">=</span> old_predictor.evaluate(test_data)</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_performance_improvement(new_performance, old_performance):</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="st">&quot;New model doesn&#39;t improve performance&quot;</span>)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π</span></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_minimum_requirements(new_performance):</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;New model doesn&#39;t meet minimum requirements&quot;</span>)</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_model_stability(new_predictor, test_data):</span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;New model is not stable&quot;</span>)</span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_compatibility(new_predictor):</span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;New model is not compatible&quot;</span>)</span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Model validation failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_performance_improvement(<span class="va">self</span>, new_perf: Dict, old_perf: Dict) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a>        improvement_threshold <span class="op">=</span> <span class="va">self</span>.config.get(<span class="st">&#39;improvement_threshold&#39;</span>, <span class="fl">0.02</span>)</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric <span class="kw">in</span> <span class="va">self</span>.config[<span class="st">&#39;performance_metrics&#39;</span>]:</span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric <span class="kw">in</span> new_perf <span class="kw">and</span> metric <span class="kw">in</span> old_perf:</span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a>                improvement <span class="op">=</span> new_perf[metric] <span class="op">-</span> old_perf[metric]</span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> improvement <span class="op">&lt;</span> improvement_threshold:</span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_minimum_requirements(<span class="va">self</span>, performance: Dict) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric, threshold <span class="kw">in</span> <span class="va">self</span>.config[<span class="st">&#39;minimum_requirements&#39;</span>].items():</span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric <span class="kw">in</span> performance <span class="kw">and</span> performance[metric] <span class="op">&lt;</span> threshold:</span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_model_stability(<span class="va">self</span>, predictor, test_data: pd.DataFrame) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> []</span>
<span id="cb129-73"><a href="#cb129-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb129-74"><a href="#cb129-74" aria-hidden="true" tabindex="-1"></a>            pred <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a>            predictions.append(pred)</span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a>        consistency <span class="op">=</span> <span class="va">self</span>.calculate_prediction_consistency(predictions)</span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> consistency <span class="op">&gt;</span> <span class="va">self</span>.config.get(<span class="st">&#39;stability_threshold&#39;</span>, <span class="fl">0.95</span>)</span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-81"><a href="#cb129-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_compatibility(<span class="va">self</span>, predictor) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb129-82"><a href="#cb129-82" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb129-83"><a href="#cb129-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ AutoGluon</span></span>
<span id="cb129-84"><a href="#cb129-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(predictor, <span class="st">&#39;version&#39;</span>):</span>
<span id="cb129-85"><a href="#cb129-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> predictor.version <span class="op">!=</span> <span class="va">self</span>.config.get(<span class="st">&#39;required_version&#39;</span>):</span>
<span id="cb129-86"><a href="#cb129-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-87"><a href="#cb129-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-88"><a href="#cb129-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb129-89"><a href="#cb129-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_model_format(predictor):</span>
<span id="cb129-90"><a href="#cb129-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb129-91"><a href="#cb129-91" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb129-92"><a href="#cb129-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span></code></pre></div>
<h2 data-number="8.5" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">8.5</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 data-number="8.5.1" id="—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-1"><span
class="header-section-number">8.5.1</span> –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="sourceCode" id="cb130"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RetrainingMonitor:</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, monitoring_config: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> monitoring_config</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> {}</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> start_monitoring(<span class="va">self</span>, retraining_process):</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitor_resources()</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitor_progress(retraining_process)</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitor_quality(retraining_process)</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_resources(<span class="va">self</span>):</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> psutil</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>                <span class="co"># CPU –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>                cpu_percent <span class="op">=</span> psutil.cpu_percent()</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–∞–º—è—Ç—å</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>                memory <span class="op">=</span> psutil.virtual_memory()</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>                memory_percent <span class="op">=</span> memory.percent</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–∏—Å–∫</span></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>                disk <span class="op">=</span> psutil.disk_usage(<span class="st">&#39;/&#39;</span>)</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>                disk_percent <span class="op">=</span> disk.percent</span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot;Resources - CPU: </span><span class="sc">{</span>cpu_percent<span class="sc">}</span><span class="ss">%, Memory: </span><span class="sc">{</span>memory_percent<span class="sc">}</span><span class="ss">%, Disk: </span><span class="sc">{</span>disk_percent<span class="sc">}</span><span class="ss">%&quot;</span>)</span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤</span></span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> cpu_percent <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="st">&quot;High CPU usage detected&quot;</span>)</span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> memory_percent <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="st">&quot;High memory usage detected&quot;</span>)</span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> disk_percent <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="st">&quot;High disk usage detected&quot;</span>)</span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">60</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É</span></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Resource monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">300</span>)</span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_progress(<span class="va">self</span>, retraining_process):</span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> datetime.now()</span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> retraining_process.is_alive():</span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a>            elapsed_time <span class="op">=</span> datetime.now() <span class="op">-</span> start_time</span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</span></span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> elapsed_time.total_seconds() <span class="op">&gt;</span> <span class="va">self</span>.config.get(<span class="st">&#39;max_retraining_time&#39;</span>, <span class="dv">7200</span>):</span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">&quot;Retraining timeout exceeded&quot;</span>)</span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a>                retraining_process.terminate()</span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;Retraining progress: </span><span class="sc">{</span>elapsed_time<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">300</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_quality(<span class="va">self</span>, retraining_process):</span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a>        quality_metrics <span class="op">=</span> {</span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accuracy&#39;</span>: [],</span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;precision&#39;</span>: [],</span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recall&#39;</span>: [],</span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;f1_score&#39;</span>: []</span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> retraining_process.is_alive():</span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a>                current_metrics <span class="op">=</span> <span class="va">self</span>.get_current_metrics()</span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span></span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> metric, value <span class="kw">in</span> current_metrics.items():</span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> metric <span class="kw">in</span> quality_metrics:</span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a>                        quality_metrics[metric].append(value)</span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞</span></span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.analyze_quality_trend(quality_metrics)</span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">600</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç</span></span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Quality monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">300</span>)</span></code></pre></div>
<h2 data-number="8.6" id="–æ—Ç–∫–∞—Ç-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">8.6</span> –û—Ç–∫–∞—Ç –º–æ–¥–µ–ª–µ–π</h2>
<h3 data-number="8.6.1" id="—Å–∏—Å—Ç–µ–º–∞-–æ—Ç–∫–∞—Ç–∞"><span
class="header-section-number">8.6.1</span> –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞—Ç–∞</h3>
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ModelRollback:</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞—Ç–∞ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, rollback_config: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> rollback_config</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_versions <span class="op">=</span> []</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_backup(<span class="va">self</span>, model_path: <span class="bu">str</span>):</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        backup_path <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>model_path<span class="sc">}</span><span class="ss">_backup_</span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;%Y%m</span><span class="sc">%d</span><span class="st">_%H%M%S&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> shutil</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>            shutil.copytree(model_path, backup_path)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–µ—Ä—Å–∏–∏</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>            version_info <span class="op">=</span> {</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;path&#39;</span>: backup_path,</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;original_path&#39;</span>: model_path</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_versions.append(version_info)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;Model backup created: </span><span class="sc">{</span>backup_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> backup_path</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Backup creation failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rollback_model(<span class="va">self</span>, target_version: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target_version <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û—Ç–∫–∞—Ç –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.model_versions) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="st">&quot;No previous version available for rollback&quot;</span>)</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>                target_version <span class="op">=</span> <span class="va">self</span>.model_versions[<span class="op">-</span><span class="dv">2</span>][<span class="st">&#39;path&#39;</span>]</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û—Ç–∫–∞—Ç –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏</span></span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>                target_version <span class="op">=</span> <span class="va">self</span>.find_version_path(target_version)</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_version <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.error(<span class="ss">f&quot;Version </span><span class="sc">{</span>target_version<span class="sc">}</span><span class="ss"> not found&quot;</span>)</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>            current_path <span class="op">=</span> <span class="va">self</span>.config[<span class="st">&#39;current_model_path&#39;</span>]</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>            backup_path <span class="op">=</span> <span class="va">self</span>.config[<span class="st">&#39;backup_model_path&#39;</span>]</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.create_backup(current_path)</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> shutil</span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>            shutil.copytree(target_version, current_path, dirs_exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;Model rolled back to: </span><span class="sc">{</span>target_version<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Model rollback failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> find_version_path(<span class="va">self</span>, version_id: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –ø—É—Ç–∏ –∫ –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> version <span class="kw">in</span> <span class="va">self</span>.model_versions:</span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> version_id <span class="kw">in</span> version[<span class="st">&#39;path&#39;</span>]:</span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> version[<span class="st">&#39;path&#39;</span>]</span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code></pre></div>
<h2 data-number="8.7" id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-1"><span
class="header-section-number">8.7</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 data-number="8.7.1" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-—Å–∏—Å—Ç–µ–º—ã-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">8.7.1</span> –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CompleteRetrainingSystem:</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, config: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.config <span class="op">=</span> config</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retraining_history <span class="op">=</span> []</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> initialize(<span class="va">self</span>):</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_model <span class="op">=</span> TabularPredictor.load(<span class="va">self</span>.config[<span class="st">&#39;model_path&#39;</span>])</span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="va">self</span>.start_monitoring()</span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> start_monitoring(<span class="va">self</span>):</span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>        tasks <span class="op">=</span> [</span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_performance(),</span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_data_drift(),</span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.monitor_schedule()</span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> asyncio.gather(<span class="op">*</span>tasks)</span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_performance(<span class="va">self</span>):</span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a>                performance <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.get_current_performance()</span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏</span></span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> performance[<span class="st">&#39;accuracy&#39;</span>] <span class="op">&lt;</span> <span class="va">self</span>.config[<span class="st">&#39;performance_threshold&#39;</span>]:</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Performance degradation detected: </span><span class="sc">{</span>performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;performance_degradation&#39;</span>)</span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">1800</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Performance monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_data_drift(<span class="va">self</span>):</span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb132-59"><a href="#cb132-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb132-60"><a href="#cb132-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb132-61"><a href="#cb132-61" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb132-62"><a href="#cb132-62" aria-hidden="true" tabindex="-1"></a>                drift_score <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.check_data_drift()</span>
<span id="cb132-63"><a href="#cb132-63" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-64"><a href="#cb132-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drift_score <span class="op">&gt;</span> <span class="va">self</span>.config[<span class="st">&#39;drift_threshold&#39;</span>]:</span>
<span id="cb132-65"><a href="#cb132-65" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Data drift detected: </span><span class="sc">{</span>drift_score<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-66"><a href="#cb132-66" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;data_drift&#39;</span>)</span>
<span id="cb132-67"><a href="#cb132-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-68"><a href="#cb132-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">3600</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span></span>
<span id="cb132-69"><a href="#cb132-69" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-70"><a href="#cb132-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-71"><a href="#cb132-71" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Data drift monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-72"><a href="#cb132-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb132-73"><a href="#cb132-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-74"><a href="#cb132-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> monitor_schedule(<span class="va">self</span>):</span>
<span id="cb132-75"><a href="#cb132-75" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb132-76"><a href="#cb132-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb132-77"><a href="#cb132-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb132-78"><a href="#cb132-78" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb132-79"><a href="#cb132-79" aria-hidden="true" tabindex="-1"></a>                last_retraining <span class="op">=</span> <span class="va">self</span>.get_last_retraining_time()</span>
<span id="cb132-80"><a href="#cb132-80" aria-hidden="true" tabindex="-1"></a>                days_since_retraining <span class="op">=</span> (datetime.now() <span class="op">-</span> last_retraining).days</span>
<span id="cb132-81"><a href="#cb132-81" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-82"><a href="#cb132-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> days_since_retraining <span class="op">&gt;=</span> <span class="va">self</span>.config[<span class="st">&#39;retraining_interval&#39;</span>]:</span>
<span id="cb132-83"><a href="#cb132-83" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="st">&quot;Scheduled retraining triggered&quot;</span>)</span>
<span id="cb132-84"><a href="#cb132-84" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">await</span> <span class="va">self</span>.trigger_retraining(<span class="st">&#39;scheduled&#39;</span>)</span>
<span id="cb132-85"><a href="#cb132-85" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-86"><a href="#cb132-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">3600</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span></span>
<span id="cb132-87"><a href="#cb132-87" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-88"><a href="#cb132-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-89"><a href="#cb132-89" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;Schedule monitoring error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-90"><a href="#cb132-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> asyncio.sleep(<span class="dv">300</span>)</span>
<span id="cb132-91"><a href="#cb132-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-92"><a href="#cb132-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> trigger_retraining(<span class="va">self</span>, reason: <span class="bu">str</span>):</span>
<span id="cb132-93"><a href="#cb132-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb132-94"><a href="#cb132-94" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Triggering retraining: </span><span class="sc">{</span>reason<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-95"><a href="#cb132-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-96"><a href="#cb132-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb132-97"><a href="#cb132-97" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span></span>
<span id="cb132-98"><a href="#cb132-98" aria-hidden="true" tabindex="-1"></a>            backup_path <span class="op">=</span> <span class="va">self</span>.create_model_backup()</span>
<span id="cb132-99"><a href="#cb132-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-100"><a href="#cb132-100" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb132-101"><a href="#cb132-101" aria-hidden="true" tabindex="-1"></a>            new_data <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.load_new_data()</span>
<span id="cb132-102"><a href="#cb132-102" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-103"><a href="#cb132-103" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-104"><a href="#cb132-104" aria-hidden="true" tabindex="-1"></a>            new_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb132-105"><a href="#cb132-105" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="va">self</span>.config[<span class="st">&#39;target_column&#39;</span>],</span>
<span id="cb132-106"><a href="#cb132-106" aria-hidden="true" tabindex="-1"></a>                path<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config[<span class="st">&#39;model_path&#39;</span>]<span class="sc">}</span><span class="ss">_new&quot;</span></span>
<span id="cb132-107"><a href="#cb132-107" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb132-108"><a href="#cb132-108" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-109"><a href="#cb132-109" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb132-110"><a href="#cb132-110" aria-hidden="true" tabindex="-1"></a>            new_predictor.fit(new_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb132-111"><a href="#cb132-111" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-112"><a href="#cb132-112" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb132-113"><a href="#cb132-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="cf">await</span> <span class="va">self</span>.validate_new_model(new_predictor):</span>
<span id="cb132-114"><a href="#cb132-114" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-115"><a href="#cb132-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> <span class="va">self</span>.deploy_new_model(new_predictor)</span>
<span id="cb132-116"><a href="#cb132-116" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-117"><a href="#cb132-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</span></span>
<span id="cb132-118"><a href="#cb132-118" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.retraining_history.append({</span>
<span id="cb132-119"><a href="#cb132-119" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb132-120"><a href="#cb132-120" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;reason&#39;</span>: reason,</span>
<span id="cb132-121"><a href="#cb132-121" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;backup_path&#39;</span>: backup_path,</span>
<span id="cb132-122"><a href="#cb132-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;status&#39;</span>: <span class="st">&#39;success&#39;</span></span>
<span id="cb132-123"><a href="#cb132-123" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb132-124"><a href="#cb132-124" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-125"><a href="#cb132-125" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">&quot;Retraining completed successfully&quot;</span>)</span>
<span id="cb132-126"><a href="#cb132-126" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb132-127"><a href="#cb132-127" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏</span></span>
<span id="cb132-128"><a href="#cb132-128" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.rollback_model(backup_path)</span>
<span id="cb132-129"><a href="#cb132-129" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-130"><a href="#cb132-130" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.retraining_history.append({</span>
<span id="cb132-131"><a href="#cb132-131" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb132-132"><a href="#cb132-132" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;reason&#39;</span>: reason,</span>
<span id="cb132-133"><a href="#cb132-133" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;backup_path&#39;</span>: backup_path,</span>
<span id="cb132-134"><a href="#cb132-134" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;status&#39;</span>: <span class="st">&#39;failed&#39;</span></span>
<span id="cb132-135"><a href="#cb132-135" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb132-136"><a href="#cb132-136" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-137"><a href="#cb132-137" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">&quot;Retraining failed, rolled back to previous version&quot;</span>)</span>
<span id="cb132-138"><a href="#cb132-138" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb132-139"><a href="#cb132-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-140"><a href="#cb132-140" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Retraining failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-141"><a href="#cb132-141" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-142"><a href="#cb132-142" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û—Ç–∫–∞—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏</span></span>
<span id="cb132-143"><a href="#cb132-143" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;backup_path&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb132-144"><a href="#cb132-144" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.rollback_model(backup_path)</span>
<span id="cb132-145"><a href="#cb132-145" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-146"><a href="#cb132-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> validate_new_model(<span class="va">self</span>, new_predictor) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb132-147"><a href="#cb132-147" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb132-148"><a href="#cb132-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb132-149"><a href="#cb132-149" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb132-150"><a href="#cb132-150" aria-hidden="true" tabindex="-1"></a>            test_data <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.load_test_data()</span>
<span id="cb132-151"><a href="#cb132-151" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-152"><a href="#cb132-152" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-153"><a href="#cb132-153" aria-hidden="true" tabindex="-1"></a>            new_predictions <span class="op">=</span> new_predictor.predict(test_data)</span>
<span id="cb132-154"><a href="#cb132-154" aria-hidden="true" tabindex="-1"></a>            new_performance <span class="op">=</span> new_predictor.evaluate(test_data)</span>
<span id="cb132-155"><a href="#cb132-155" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-156"><a href="#cb132-156" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª—å—é</span></span>
<span id="cb132-157"><a href="#cb132-157" aria-hidden="true" tabindex="-1"></a>            current_predictions <span class="op">=</span> <span class="va">self</span>.current_model.predict(test_data)</span>
<span id="cb132-158"><a href="#cb132-158" aria-hidden="true" tabindex="-1"></a>            current_performance <span class="op">=</span> <span class="va">self</span>.current_model.evaluate(test_data)</span>
<span id="cb132-159"><a href="#cb132-159" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-160"><a href="#cb132-160" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è</span></span>
<span id="cb132-161"><a href="#cb132-161" aria-hidden="true" tabindex="-1"></a>            improvement <span class="op">=</span> new_performance[<span class="st">&#39;accuracy&#39;</span>] <span class="op">-</span> current_performance[<span class="st">&#39;accuracy&#39;</span>]</span>
<span id="cb132-162"><a href="#cb132-162" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-163"><a href="#cb132-163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> improvement <span class="op">&lt;</span> <span class="va">self</span>.config.get(<span class="st">&#39;improvement_threshold&#39;</span>, <span class="fl">0.01</span>):</span>
<span id="cb132-164"><a href="#cb132-164" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Insufficient improvement: </span><span class="sc">{</span>improvement<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-165"><a href="#cb132-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb132-166"><a href="#cb132-166" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-167"><a href="#cb132-167" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π</span></span>
<span id="cb132-168"><a href="#cb132-168" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_performance[<span class="st">&#39;accuracy&#39;</span>] <span class="op">&lt;</span> <span class="va">self</span>.config.get(<span class="st">&#39;minimum_accuracy&#39;</span>, <span class="fl">0.8</span>):</span>
<span id="cb132-169"><a href="#cb132-169" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f&quot;Accuracy below minimum: </span><span class="sc">{</span>new_performance[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-170"><a href="#cb132-170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb132-171"><a href="#cb132-171" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-172"><a href="#cb132-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb132-173"><a href="#cb132-173" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-174"><a href="#cb132-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-175"><a href="#cb132-175" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Model validation failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-176"><a href="#cb132-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb132-177"><a href="#cb132-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-178"><a href="#cb132-178" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> deploy_new_model(<span class="va">self</span>, new_predictor):</span>
<span id="cb132-179"><a href="#cb132-179" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb132-180"><a href="#cb132-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb132-181"><a href="#cb132-181" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞</span></span>
<span id="cb132-182"><a href="#cb132-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> <span class="va">self</span>.stop_current_service()</span>
<span id="cb132-183"><a href="#cb132-183" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-184"><a href="#cb132-184" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-185"><a href="#cb132-185" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> shutil</span>
<span id="cb132-186"><a href="#cb132-186" aria-hidden="true" tabindex="-1"></a>            shutil.copytree(new_predictor.path, <span class="va">self</span>.config[<span class="st">&#39;model_path&#39;</span>], dirs_exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb132-187"><a href="#cb132-187" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-188"><a href="#cb132-188" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-189"><a href="#cb132-189" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.current_model <span class="op">=</span> new_predictor</span>
<span id="cb132-190"><a href="#cb132-190" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-191"><a href="#cb132-191" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞</span></span>
<span id="cb132-192"><a href="#cb132-192" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> <span class="va">self</span>.start_updated_service()</span>
<span id="cb132-193"><a href="#cb132-193" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-194"><a href="#cb132-194" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;New model deployed successfully&quot;</span>)</span>
<span id="cb132-195"><a href="#cb132-195" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb132-196"><a href="#cb132-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb132-197"><a href="#cb132-197" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;Model deployment failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-198"><a href="#cb132-198" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb132-199"><a href="#cb132-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-200"><a href="#cb132-200" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_model_backup(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb132-201"><a href="#cb132-201" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb132-202"><a href="#cb132-202" aria-hidden="true" tabindex="-1"></a>        backup_path <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config[<span class="st">&#39;model_path&#39;</span>]<span class="sc">}</span><span class="ss">_backup_</span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;%Y%m</span><span class="sc">%d</span><span class="st">_%H%M%S&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb132-203"><a href="#cb132-203" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-204"><a href="#cb132-204" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> shutil</span>
<span id="cb132-205"><a href="#cb132-205" aria-hidden="true" tabindex="-1"></a>        shutil.copytree(<span class="va">self</span>.config[<span class="st">&#39;model_path&#39;</span>], backup_path)</span>
<span id="cb132-206"><a href="#cb132-206" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-207"><a href="#cb132-207" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> backup_path</span>
<span id="cb132-208"><a href="#cb132-208" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-209"><a href="#cb132-209" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rollback_model(<span class="va">self</span>, backup_path: <span class="bu">str</span>):</span>
<span id="cb132-210"><a href="#cb132-210" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb132-211"><a href="#cb132-211" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> shutil</span>
<span id="cb132-212"><a href="#cb132-212" aria-hidden="true" tabindex="-1"></a>        shutil.copytree(backup_path, <span class="va">self</span>.config[<span class="st">&#39;model_path&#39;</span>], dirs_exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb132-213"><a href="#cb132-213" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-214"><a href="#cb132-214" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb132-215"><a href="#cb132-215" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.current_model <span class="op">=</span> TabularPredictor.load(<span class="va">self</span>.config[<span class="st">&#39;model_path&#39;</span>])</span>
<span id="cb132-216"><a href="#cb132-216" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb132-217"><a href="#cb132-217" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Model rolled back to: </span><span class="sc">{</span>backup_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb132-218"><a href="#cb132-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-219"><a href="#cb132-219" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb132-220"><a href="#cb132-220" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb132-221"><a href="#cb132-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;model_path&#39;</span>: <span class="st">&#39;./production_models&#39;</span>,</span>
<span id="cb132-222"><a href="#cb132-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;target_column&#39;</span>: <span class="st">&#39;target&#39;</span>,</span>
<span id="cb132-223"><a href="#cb132-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;performance_threshold&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb132-224"><a href="#cb132-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;drift_threshold&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb132-225"><a href="#cb132-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;retraining_interval&#39;</span>: <span class="dv">7</span>,  <span class="co"># –¥–Ω–∏</span></span>
<span id="cb132-226"><a href="#cb132-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;improvement_threshold&#39;</span>: <span class="fl">0.01</span>,</span>
<span id="cb132-227"><a href="#cb132-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;minimum_accuracy&#39;</span>: <span class="fl">0.8</span></span>
<span id="cb132-228"><a href="#cb132-228" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-229"><a href="#cb132-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-230"><a href="#cb132-230" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb132-231"><a href="#cb132-231" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> main():</span>
<span id="cb132-232"><a href="#cb132-232" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CompleteRetrainingSystem(config)</span>
<span id="cb132-233"><a href="#cb132-233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> system.initialize()</span>
<span id="cb132-234"><a href="#cb132-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-235"><a href="#cb132-235" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb132-236"><a href="#cb132-236" aria-hidden="true" tabindex="-1"></a>    asyncio.run(main())</span></code></pre></div>
<h2 data-number="8.8" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-6"><span
class="header-section-number">8.8</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a> - <a
href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a> - <a
href="./10_troubleshooting.md">Troubleshooting</a></p>
<hr />
<h1 data-number="9" id="–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-automl-gluon"><span
class="header-section-number">9</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ AutoML Gluon</h1>
<h2 data-number="9.0" id="–ø–æ—á–µ–º—É-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">9.0</span> –ü–æ—á–µ–º—É –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="9.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span class="header-section-number">9.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="9.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span class="header-section-number">9.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="9.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="header-section-number">9.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<p><img src="images/performance_comparison.png"
alt="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" /> <em>–†–∏—Å—É–Ω–æ–∫ 7: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</em></p>
<p><img src="images/robustness_analysis.png" alt="–ê–Ω–∞–ª–∏–∑ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏" />
<em>–†–∏—Å—É–Ω–æ–∫ 7.1: –ê–Ω–∞–ª–∏–∑ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏ - —Ä–æ–±–∞—Å—Ç–Ω—ã–µ vs –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã–µ
—Å–∏—Å—Ç–µ–º—ã, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</em></p>
<p>–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ - —ç—Ç–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML Gluon,
–∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ –¥–æ—Å—Ç–∏—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.</p>
<h2 data-number="9.2" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1"><span
class="header-section-number">9.2</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
<h3 data-number="9.2.1" id="–∫–∞—á–µ—Å—Ç–≤–æ-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">9.2.1</span> 1. –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data_quality_check(data: pd.DataFrame) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    quality_report <span class="op">=</span> {</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;shape&#39;</span>: data.shape,</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;missing_values&#39;</span>: data.isnull().<span class="bu">sum</span>().to_dict(),</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;data_types&#39;</span>: data.dtypes.to_dict(),</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;duplicates&#39;</span>: data.duplicated().<span class="bu">sum</span>(),</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;outliers&#39;</span>: {},</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;correlations&#39;</span>: {}</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>    missing_percent <span class="op">=</span> (data.isnull().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(data)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>    quality_report[<span class="st">&#39;missing_percent&#39;</span>] <span class="op">=</span> missing_percent.to_dict()</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>    numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> data[(data[col] <span class="op">&lt;</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR) <span class="op">|</span> (data[col] <span class="op">&gt;</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR)]</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>        quality_report[<span class="st">&#39;outliers&#39;</span>][col] <span class="op">=</span> <span class="bu">len</span>(outliers)</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(numeric_columns) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>        correlation_matrix <span class="op">=</span> data[numeric_columns].corr()</span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>        quality_report[<span class="st">&#39;correlations&#39;</span>] <span class="op">=</span> correlation_matrix.to_dict()</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quality_report</span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a>quality_report <span class="op">=</span> data_quality_check(train_data)</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data Quality Report:&quot;</span>)</span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> quality_report.items():</span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="9.2.2" id="–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö-–∑–Ω–∞—á–µ–Ω–∏–π"><span
class="header-section-number">9.2.2</span> 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö
–∑–Ω–∞—á–µ–Ω–∏–π</h3>
<div class="sourceCode" id="cb134"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> handle_missing_values(data: pd.DataFrame, strategy: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;auto&#39;</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> strategy <span class="op">==</span> <span class="st">&#39;auto&#39;</span>:</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> data.columns:</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> data[col].dtype <span class="op">==</span> <span class="st">&#39;object&#39;</span>:</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –º–æ–¥–∞</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>                data[col].fillna(data[col].mode()[<span class="dv">0</span>] <span class="cf">if</span> <span class="kw">not</span> data[col].mode().empty <span class="cf">else</span> <span class="st">&#39;Unknown&#39;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –º–µ–¥–∏–∞–Ω–∞</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>                data[col].fillna(data[col].median(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> strategy <span class="op">==</span> <span class="st">&#39;drop&#39;</span>:</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.dropna()</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> strategy <span class="op">==</span> <span class="st">&#39;interpolate&#39;</span>:</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.interpolate(method<span class="op">=</span><span class="st">&#39;linear&#39;</span>)</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>train_data_clean <span class="op">=</span> handle_missing_values(train_data, strategy<span class="op">=</span><span class="st">&#39;auto&#39;</span>)</span></code></pre></div>
<h3 data-number="9.2.3" id="–æ–±—Ä–∞–±–æ—Ç–∫–∞-–≤—ã–±—Ä–æ—Å–æ–≤"><span
class="header-section-number">9.2.3</span> 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</h3>
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> handle_outliers(data: pd.DataFrame, method: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;iqr&#39;</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method <span class="op">==</span> <span class="st">&#39;iqr&#39;</span>:</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç–æ–¥ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–∞—Ö–∞</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>            Q1 <span class="op">=</span> data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>            Q3 <span class="op">=</span> data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>            IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–º–µ–Ω–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&lt;</span> lower_bound, lower_bound, data[col])</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&gt;</span> upper_bound, upper_bound, data[col])</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;zscore&#39;</span>:</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç–æ–¥ Z-—Å–∫–æ—Ä</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>            z_scores <span class="op">=</span> np.<span class="bu">abs</span>((data[col] <span class="op">-</span> data[col].mean()) <span class="op">/</span> data[col].std())</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> data[z_scores <span class="op">&lt;</span> <span class="dv">3</span>]  <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;winsorize&#39;</span>:</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∏–Ω–∑–æ—Ä–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>            lower_percentile <span class="op">=</span> data[col].quantile(<span class="fl">0.05</span>)</span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>            upper_percentile <span class="op">=</span> data[col].quantile(<span class="fl">0.95</span>)</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&lt;</span> lower_percentile, lower_percentile, data[col])</span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&gt;</span> upper_percentile, upper_percentile, data[col])</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a>train_data_no_outliers <span class="op">=</span> handle_outliers(train_data, method<span class="op">=</span><span class="st">&#39;iqr&#39;</span>)</span></code></pre></div>
<h2 data-number="9.3" id="–≤—ã–±–æ—Ä-–º–µ—Ç—Ä–∏–∫-1"><span
class="header-section-number">9.3</span> –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h2>
<h3 data-number="9.3.1" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-1"><span
class="header-section-number">9.3.1</span> 1. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_classification_metrics(problem_type: <span class="bu">str</span>, data_balance: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;balanced&#39;</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> problem_type <span class="op">==</span> <span class="st">&#39;binary&#39;</span>:</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data_balance <span class="op">==</span> <span class="st">&#39;balanced&#39;</span>:</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>, <span class="st">&#39;precision&#39;</span>, <span class="st">&#39;recall&#39;</span>]</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data_balance <span class="op">==</span> <span class="st">&#39;imbalanced&#39;</span>:</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>, <span class="st">&#39;precision&#39;</span>, <span class="st">&#39;recall&#39;</span>, <span class="st">&#39;balanced_accuracy&#39;</span>]</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>]</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> problem_type <span class="op">==</span> <span class="st">&#39;multiclass&#39;</span>:</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data_balance <span class="op">==</span> <span class="st">&#39;balanced&#39;</span>:</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1_macro&#39;</span>, <span class="st">&#39;f1_micro&#39;</span>, <span class="st">&#39;precision_macro&#39;</span>, <span class="st">&#39;recall_macro&#39;</span>]</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data_balance <span class="op">==</span> <span class="st">&#39;imbalanced&#39;</span>:</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;f1_macro&#39;</span>, <span class="st">&#39;f1_micro&#39;</span>, <span class="st">&#39;balanced_accuracy&#39;</span>, <span class="st">&#39;precision_macro&#39;</span>, <span class="st">&#39;recall_macro&#39;</span>]</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1_macro&#39;</span>, <span class="st">&#39;f1_micro&#39;</span>]</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;roc_auc&#39;</span>]</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> select_classification_metrics(<span class="st">&#39;binary&#39;</span>, <span class="st">&#39;imbalanced&#39;</span>)</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>metrics[<span class="dv">0</span>]  <span class="co"># –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞</span></span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="9.3.2" id="–º–µ—Ç—Ä–∏–∫–∏-–¥–ª—è-—Ä–µ–≥—Ä–µ—Å—Å–∏–∏-1"><span
class="header-section-number">9.3.2</span> 2. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h3>
<div class="sourceCode" id="cb137"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_regression_metrics(problem_type: <span class="bu">str</span>, target_distribution: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;normal&#39;</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> target_distribution <span class="op">==</span> <span class="st">&#39;normal&#39;</span>:</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="st">&#39;rmse&#39;</span>, <span class="st">&#39;mae&#39;</span>, <span class="st">&#39;r2&#39;</span>]</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> target_distribution <span class="op">==</span> <span class="st">&#39;skewed&#39;</span>:</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="st">&#39;mae&#39;</span>, <span class="st">&#39;mape&#39;</span>, <span class="st">&#39;smape&#39;</span>]</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> target_distribution <span class="op">==</span> <span class="st">&#39;outliers&#39;</span>:</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="st">&#39;mae&#39;</span>, <span class="st">&#39;huber_loss&#39;</span>]</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="st">&#39;rmse&#39;</span>, <span class="st">&#39;mae&#39;</span>]</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> select_regression_metrics(<span class="st">&#39;regression&#39;</span>, <span class="st">&#39;normal&#39;</span>)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span>metrics[<span class="dv">0</span>]</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="9.4" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-2"><span
class="header-section-number">9.4</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>
<h3 data-number="9.4.1" id="—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–ø–æ–∏—Å–∫–∞-–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span
class="header-section-number">9.4.1</span> 1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞
–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_hyperparameter_strategy(data_size: <span class="bu">int</span>, problem_type: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç - –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;GBM&#39;</span>: [{<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>}],</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;RF&#39;</span>: [{<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}],</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;XGB&#39;</span>: [{<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>}]</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç - —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">300</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>}</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>},</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">300</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>}</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">300</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç - —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>}</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>},</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">25</span>}</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;iterations&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;iterations&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>}</span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb138-51"><a href="#cb138-51" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> create_hyperparameter_strategy(<span class="bu">len</span>(train_data), <span class="st">&#39;binary&#39;</span>)</span>
<span id="cb138-52"><a href="#cb138-52" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, hyperparameters<span class="op">=</span>hyperparameters)</span></code></pre></div>
<h3 data-number="9.4.2" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–∏-–æ–±—É—á–µ–Ω–∏—è-1"><span
class="header-section-number">9.4.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_training_time(data_size: <span class="bu">int</span>, available_time: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –º–æ–¥–µ–ª—å</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    time_per_model <span class="op">=</span> available_time <span class="op">/</span> <span class="dv">10</span>  <span class="co"># 10 –º–æ–¥–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: time_per_model,</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span>,</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–º–µ—Ä–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: time_per_model,</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;medium_quality&#39;</span>,</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: time_per_model,</span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">2</span></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a>training_config <span class="op">=</span> optimize_training_time(<span class="bu">len</span>(train_data), <span class="dv">3600</span>)  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, <span class="op">**</span>training_config)</span></code></pre></div>
<h2 data-number="9.5" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"><span
class="header-section-number">9.5</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 data-number="9.5.1" id="—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">9.5.1</span> 1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_validation_strategy(data_size: <span class="bu">int</span>, problem_type: <span class="bu">str</span>, </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>                             data_type: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;tabular&#39;</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_type <span class="op">==</span> <span class="st">&#39;time_series&#39;</span>:</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;validation_strategy&#39;</span>: <span class="st">&#39;time_series_split&#39;</span>,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_splits&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;test_size&#39;</span>: <span class="fl">0.2</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;validation_strategy&#39;</span>: <span class="st">&#39;holdout&#39;</span>,</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;holdout_frac&#39;</span>: <span class="fl">0.3</span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;validation_strategy&#39;</span>: <span class="st">&#39;kfold&#39;</span>,</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;validation_strategy&#39;</span>: <span class="st">&#39;kfold&#39;</span>,</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span></span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>validation_config <span class="op">=</span> select_validation_strategy(<span class="bu">len</span>(train_data), <span class="st">&#39;binary&#39;</span>)</span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, <span class="op">**</span>validation_config)</span></code></pre></div>
<h3 data-number="9.5.2" id="–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">9.5.2</span> 2. –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_cross_validation(predictor, data: pd.DataFrame, </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>                           n_folds: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    kf <span class="op">=</span> KFold(n_splits<span class="op">=</span>n_folds, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    fold_results <span class="op">=</span> []</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> fold, (train_idx, val_idx) <span class="kw">in</span> <span class="bu">enumerate</span>(kf.split(data)):</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>        train_fold <span class="op">=</span> data.iloc[train_idx]</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>        val_fold <span class="op">=</span> data.iloc[val_idx]</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>        fold_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>predictor.label,</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span>predictor.problem_type,</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span>predictor.eval_metric</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>        fold_predictor.fit(train_fold, time_limit<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> fold_predictor.predict(val_fold)</span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> fold_predictor.evaluate(val_fold)</span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>        fold_results.append({</span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;fold&#39;</span>: fold <span class="op">+</span> <span class="dv">1</span>,</span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: performance</span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>    all_metrics <span class="op">=</span> {}</span>
<span id="cb141-39"><a href="#cb141-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> result <span class="kw">in</span> fold_results:</span>
<span id="cb141-40"><a href="#cb141-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric, value <span class="kw">in</span> result[<span class="st">&#39;performance&#39;</span>].items():</span>
<span id="cb141-41"><a href="#cb141-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric <span class="kw">not</span> <span class="kw">in</span> all_metrics:</span>
<span id="cb141-42"><a href="#cb141-42" aria-hidden="true" tabindex="-1"></a>                all_metrics[metric] <span class="op">=</span> []</span>
<span id="cb141-43"><a href="#cb141-43" aria-hidden="true" tabindex="-1"></a>            all_metrics[metric].append(value)</span>
<span id="cb141-44"><a href="#cb141-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-45"><a href="#cb141-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span></span>
<span id="cb141-46"><a href="#cb141-46" aria-hidden="true" tabindex="-1"></a>    cv_results <span class="op">=</span> {}</span>
<span id="cb141-47"><a href="#cb141-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric, values <span class="kw">in</span> all_metrics.items():</span>
<span id="cb141-48"><a href="#cb141-48" aria-hidden="true" tabindex="-1"></a>        cv_results[metric] <span class="op">=</span> {</span>
<span id="cb141-49"><a href="#cb141-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mean&#39;</span>: np.mean(values),</span>
<span id="cb141-50"><a href="#cb141-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;std&#39;</span>: np.std(values),</span>
<span id="cb141-51"><a href="#cb141-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min&#39;</span>: np.<span class="bu">min</span>(values),</span>
<span id="cb141-52"><a href="#cb141-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max&#39;</span>: np.<span class="bu">max</span>(values)</span>
<span id="cb141-53"><a href="#cb141-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb141-54"><a href="#cb141-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-55"><a href="#cb141-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cv_results</span>
<span id="cb141-56"><a href="#cb141-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-57"><a href="#cb141-57" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb141-58"><a href="#cb141-58" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> perform_cross_validation(predictor, train_data, n_folds<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb141-59"><a href="#cb141-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Cross-validation results:&quot;</span>)</span>
<span id="cb141-60"><a href="#cb141-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, stats <span class="kw">in</span> cv_results.items():</span>
<span id="cb141-61"><a href="#cb141-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>stats[<span class="st">&#39;mean&#39;</span>]<span class="sc">:.4f}</span><span class="ss"> ¬± </span><span class="sc">{</span>stats[<span class="st">&#39;std&#39;</span>]<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="9.6" id="—Ä–∞–±–æ—Ç–∞-—Å-–∞–Ω—Å–∞–º–±–ª—è–º–∏-1"><span
class="header-section-number">9.6</span> –†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</h2>
<h3 data-number="9.6.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–Ω—Å–∞–º–±–ª–µ–π-1"><span
class="header-section-number">9.6.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</h3>
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> configure_ensemble(data_size: <span class="bu">int</span>, problem_type: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ—Å—Ç–æ–π –∞–Ω—Å–∞–º–±–ª—å</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_stack_levels&#39;</span>: <span class="dv">0</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–º–µ—Ä–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_stack_levels&#39;</span>: <span class="dv">1</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª–æ–∂–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_stack_levels&#39;</span>: <span class="dv">2</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>ensemble_config <span class="op">=</span> configure_ensemble(<span class="bu">len</span>(train_data), <span class="st">&#39;binary&#39;</span>)</span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, <span class="op">**</span>ensemble_config)</span></code></pre></div>
<h3 data-number="9.6.2" id="–∞–Ω–∞–ª–∏–∑-–∞–Ω—Å–∞–º–±–ª—è-1"><span
class="header-section-number">9.6.2</span> 2. –ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_ensemble(predictor) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    leaderboard <span class="op">=</span> predictor.leaderboard()</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    ensemble_analysis <span class="op">=</span> {</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_models&#39;</span>: <span class="bu">len</span>(leaderboard),</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;best_model&#39;</span>: leaderboard.iloc[<span class="dv">0</span>][<span class="st">&#39;model&#39;</span>],</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;best_score&#39;</span>: leaderboard.iloc[<span class="dv">0</span>][<span class="st">&#39;score_val&#39;</span>],</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;model_diversity&#39;</span>: calculate_model_diversity(leaderboard),</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;performance_gap&#39;</span>: leaderboard.iloc[<span class="dv">0</span>][<span class="st">&#39;score_val&#39;</span>] <span class="op">-</span> leaderboard.iloc[<span class="op">-</span><span class="dv">1</span>][<span class="st">&#39;score_val&#39;</span>]</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ensemble_analysis</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_model_diversity(leaderboard: pd.DataFrame) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–æ —Ç–∏–ø–∞–º –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    model_types <span class="op">=</span> leaderboard[<span class="st">&#39;model&#39;</span>].<span class="bu">str</span>.split(<span class="st">&#39;_&#39;</span>).<span class="bu">str</span>[<span class="dv">0</span>].value_counts()</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    diversity <span class="op">=</span> <span class="bu">len</span>(model_types) <span class="op">/</span> <span class="bu">len</span>(leaderboard)</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> diversity</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>ensemble_analysis <span class="op">=</span> analyze_ensemble(predictor)</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Ensemble Analysis:&quot;</span>)</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> ensemble_analysis.items():</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="9.7" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">9.7</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 data-number="9.7.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Ä–µ—Å—É—Ä—Å–æ–≤-1"><span
class="header-section-number">9.7.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h3>
<div class="sourceCode" id="cb144"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_resources(data_size: <span class="bu">int</span>, available_resources: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>        num_cpus <span class="op">=</span> <span class="bu">min</span>(<span class="dv">2</span>, available_resources.get(<span class="st">&#39;cpus&#39;</span>, <span class="dv">4</span>))</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>        memory_limit <span class="op">=</span> <span class="bu">min</span>(<span class="dv">4</span>, available_resources.get(<span class="st">&#39;memory&#39;</span>, <span class="dv">8</span>))</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>        num_cpus <span class="op">=</span> <span class="bu">min</span>(<span class="dv">4</span>, available_resources.get(<span class="st">&#39;cpus&#39;</span>, <span class="dv">8</span>))</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>        memory_limit <span class="op">=</span> <span class="bu">min</span>(<span class="dv">8</span>, available_resources.get(<span class="st">&#39;memory&#39;</span>, <span class="dv">16</span>))</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>        num_cpus <span class="op">=</span> <span class="bu">min</span>(<span class="dv">8</span>, available_resources.get(<span class="st">&#39;cpus&#39;</span>, <span class="dv">16</span>))</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>        memory_limit <span class="op">=</span> <span class="bu">min</span>(<span class="dv">16</span>, available_resources.get(<span class="st">&#39;memory&#39;</span>, <span class="dv">32</span>))</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_cpus&#39;</span>: num_cpus,</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_gpus&#39;</span>: available_resources.get(<span class="st">&#39;gpus&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;memory_limit&#39;</span>: memory_limit</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>resources <span class="op">=</span> optimize_resources(<span class="bu">len</span>(train_data), {<span class="st">&#39;cpus&#39;</span>: <span class="dv">8</span>, <span class="st">&#39;memory&#39;</span>: <span class="dv">16</span>, <span class="st">&#39;gpus&#39;</span>: <span class="dv">1</span>})</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, ag_args_fit<span class="op">=</span>resources)</span></code></pre></div>
<h3 data-number="9.7.2" id="–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è"><span
class="header-section-number">9.7.2</span> 2. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> configure_parallelization(data_size: <span class="bu">int</span>, problem_type: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_folds&#39;</span>: <span class="va">False</span>,</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_models&#39;</span>: <span class="va">False</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–º–µ—Ä–µ–Ω–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_folds&#39;</span>: <span class="va">True</span>,</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_models&#39;</span>: <span class="va">False</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_folds&#39;</span>: <span class="va">True</span>,</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parallel_models&#39;</span>: <span class="va">True</span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>parallel_config <span class="op">=</span> configure_parallelization(<span class="bu">len</span>(train_data), <span class="st">&#39;binary&#39;</span>)</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ ag_args_fit</span></span></code></pre></div>
<h2 data-number="9.8" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-1"><span
class="header-section-number">9.8</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 data-number="9.8.1" id="—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">9.8.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AutoGluonLogger:</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è AutoGluon&quot;&quot;&quot;</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, log_file: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;autogluon.log&#39;</span>):</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_file <span class="op">=</span> log_file</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_logging()</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_logging(<span class="va">self</span>):</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>logging.INFO,</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(name)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>,</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>            handlers<span class="op">=</span>[</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>                logging.FileHandler(<span class="va">self</span>.log_file),</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>                logging.StreamHandler()</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_training_start(<span class="va">self</span>, data_info: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Training started: </span><span class="sc">{</span>data_info<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_training_progress(<span class="va">self</span>, progress: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Training progress: </span><span class="sc">{</span>progress<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_training_complete(<span class="va">self</span>, results: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Training completed: </span><span class="sc">{</span>results<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_prediction(<span class="va">self</span>, input_data: Dict, prediction: Any, </span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true" tabindex="-1"></a>                      processing_time: <span class="bu">float</span>):</span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb146-39"><a href="#cb146-39" aria-hidden="true" tabindex="-1"></a>        log_entry <span class="op">=</span> {</span>
<span id="cb146-40"><a href="#cb146-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb146-41"><a href="#cb146-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;input_data&#39;</span>: input_data,</span>
<span id="cb146-42"><a href="#cb146-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction&#39;</span>: prediction,</span>
<span id="cb146-43"><a href="#cb146-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;processing_time&#39;</span>: processing_time</span>
<span id="cb146-44"><a href="#cb146-44" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb146-45"><a href="#cb146-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Prediction: </span><span class="sc">{</span>log_entry<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-46"><a href="#cb146-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb146-47"><a href="#cb146-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_error(<span class="va">self</span>, error: <span class="pp">Exception</span>, context: Dict[<span class="bu">str</span>, Any]):</span>
<span id="cb146-48"><a href="#cb146-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span></span>
<span id="cb146-49"><a href="#cb146-49" aria-hidden="true" tabindex="-1"></a>        error_entry <span class="op">=</span> {</span>
<span id="cb146-50"><a href="#cb146-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb146-51"><a href="#cb146-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(error),</span>
<span id="cb146-52"><a href="#cb146-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;context&#39;</span>: context</span>
<span id="cb146-53"><a href="#cb146-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb146-54"><a href="#cb146-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.error(<span class="ss">f&quot;Error: </span><span class="sc">{</span>error_entry<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb146-55"><a href="#cb146-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-56"><a href="#cb146-56" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb146-57"><a href="#cb146-57" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> AutoGluonLogger()</span>
<span id="cb146-58"><a href="#cb146-58" aria-hidden="true" tabindex="-1"></a>logger.log_training_start({<span class="st">&#39;data_size&#39;</span>: <span class="bu">len</span>(train_data), <span class="st">&#39;features&#39;</span>: <span class="bu">len</span>(train_data.columns)})</span></code></pre></div>
<h3 data-number="9.8.2" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">9.8.2</span> 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psutil</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Any</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PerformanceMonitor:</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_history <span class="op">=</span> []</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_system_metrics(<span class="va">self</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_percent&#39;</span>: psutil.cpu_percent(),</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_percent&#39;</span>: psutil.virtual_memory().percent,</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;disk_percent&#39;</span>: psutil.disk_usage(<span class="st">&#39;/&#39;</span>).percent,</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_training(<span class="va">self</span>, predictor, data: pd.DataFrame):</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> time.time()</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>        initial_metrics <span class="op">=</span> <span class="va">self</span>.get_system_metrics()</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_history.append(initial_metrics)</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span></span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>        predictor.fit(data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>        final_metrics <span class="op">=</span> <span class="va">self</span>.get_system_metrics()</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>        final_metrics[<span class="st">&#39;training_time&#39;</span>] <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_history.append(final_metrics)</span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> final_metrics</span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_performance(<span class="va">self</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.metrics_history) <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {}</span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤</span></span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>        cpu_usage <span class="op">=</span> [m[<span class="st">&#39;cpu_percent&#39;</span>] <span class="cf">for</span> m <span class="kw">in</span> <span class="va">self</span>.metrics_history]</span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>        memory_usage <span class="op">=</span> [m[<span class="st">&#39;memory_percent&#39;</span>] <span class="cf">for</span> m <span class="kw">in</span> <span class="va">self</span>.metrics_history]</span>
<span id="cb147-46"><a href="#cb147-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-47"><a href="#cb147-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb147-48"><a href="#cb147-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;avg_cpu_usage&#39;</span>: <span class="bu">sum</span>(cpu_usage) <span class="op">/</span> <span class="bu">len</span>(cpu_usage),</span>
<span id="cb147-49"><a href="#cb147-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_cpu_usage&#39;</span>: <span class="bu">max</span>(cpu_usage),</span>
<span id="cb147-50"><a href="#cb147-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;avg_memory_usage&#39;</span>: <span class="bu">sum</span>(memory_usage) <span class="op">/</span> <span class="bu">len</span>(memory_usage),</span>
<span id="cb147-51"><a href="#cb147-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_memory_usage&#39;</span>: <span class="bu">max</span>(memory_usage),</span>
<span id="cb147-52"><a href="#cb147-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;training_time&#39;</span>: <span class="va">self</span>.metrics_history[<span class="op">-</span><span class="dv">1</span>].get(<span class="st">&#39;training_time&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb147-53"><a href="#cb147-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb147-54"><a href="#cb147-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-55"><a href="#cb147-55" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb147-56"><a href="#cb147-56" aria-hidden="true" tabindex="-1"></a>monitor <span class="op">=</span> PerformanceMonitor()</span>
<span id="cb147-57"><a href="#cb147-57" aria-hidden="true" tabindex="-1"></a>final_metrics <span class="op">=</span> monitor.monitor_training(predictor, train_data)</span>
<span id="cb147-58"><a href="#cb147-58" aria-hidden="true" tabindex="-1"></a>performance_analysis <span class="op">=</span> monitor.analyze_performance()</span>
<span id="cb147-59"><a href="#cb147-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Performance analysis: </span><span class="sc">{</span>performance_analysis<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="9.9" id="–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫"><span
class="header-section-number">9.9</span> –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</h2>
<h3 data-number="9.9.1" id="–æ–±—Ä–∞–±–æ—Ç–∫–∞-–∏—Å–∫–ª—é—á–µ–Ω–∏–π"><span
class="header-section-number">9.9.1</span> 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</h3>
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> safe_training(predictor, data: pd.DataFrame, <span class="op">**</span>kwargs) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>        predictor.fit(data, <span class="op">**</span>kwargs)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(predictor, <span class="st">&#39;evaluate&#39;</span>):</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>            performance <span class="op">=</span> predictor.evaluate(data)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;status&#39;</span>: <span class="st">&#39;success&#39;</span>,</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;error&#39;</span>: <span class="va">None</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;status&#39;</span>: <span class="st">&#39;success&#39;</span>,</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;performance&#39;</span>: <span class="va">None</span>,</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;error&#39;</span>: <span class="va">None</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">MemoryError</span> <span class="im">as</span> e:</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;error&#39;</span>,</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: <span class="va">None</span>,</span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error&#39;</span>: <span class="ss">f&#39;Memory error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;Reduce data size or increase memory&#39;</span></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">TimeoutError</span> <span class="im">as</span> e:</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;error&#39;</span>,</span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: <span class="va">None</span>,</span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error&#39;</span>: <span class="ss">f&#39;Timeout error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;Increase time_limit or reduce model complexity&#39;</span></span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;error&#39;</span>,</span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: <span class="va">None</span>,</span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error&#39;</span>: <span class="ss">f&#39;Unexpected error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;Check data quality and parameters&#39;</span></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> safe_training(predictor, train_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> result[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="st">&#39;success&#39;</span>:</span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Training successful: </span><span class="sc">{</span>result[<span class="st">&#39;performance&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb148-51"><a href="#cb148-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Training failed: </span><span class="sc">{</span>result[<span class="st">&#39;error&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Suggestion: </span><span class="sc">{</span>result[<span class="st">&#39;suggestion&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="9.9.2" id="–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ-–ø–æ—Å–ª–µ-–æ—à–∏–±–æ–∫"><span
class="header-section-number">9.9.2</span> 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ
–æ—à–∏–±–æ–∫</h3>
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> resilient_training(predictor, data: pd.DataFrame, </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>                      fallback_strategies: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–£—Å—Ç–æ–π—á–∏–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏&quot;&quot;&quot;</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, strategy <span class="kw">in</span> <span class="bu">enumerate</span>(fallback_strategies):</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –æ–±—É—á–µ–Ω–∏—è —Å —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>            predictor.fit(data, <span class="op">**</span>strategy)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> validate_model(predictor):</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;status&#39;</span>: <span class="st">&#39;success&#39;</span>,</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strategy_used&#39;</span>: i,</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strategy_config&#39;</span>: strategy</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Strategy </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> failed: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;status&#39;</span>: <span class="st">&#39;error&#39;</span>,</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;error&#39;</span>: <span class="st">&#39;All strategies failed&#39;</span>,</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;suggestions&#39;</span>: [</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Check data quality&#39;</span>,</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Reduce model complexity&#39;</span>,</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Increase time limits&#39;</span>,</span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Use simpler algorithms&#39;</span></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</span></span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>fallback_strategies <span class="op">=</span> [</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a>    {<span class="st">&#39;presets&#39;</span>: <span class="st">&#39;best_quality&#39;</span>, <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span>},</span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>    {<span class="st">&#39;presets&#39;</span>: <span class="st">&#39;high_quality&#39;</span>, <span class="st">&#39;time_limit&#39;</span>: <span class="dv">1800</span>},</span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a>    {<span class="st">&#39;presets&#39;</span>: <span class="st">&#39;medium_quality&#39;</span>, <span class="st">&#39;time_limit&#39;</span>: <span class="dv">900</span>},</span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a>    {<span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span>, <span class="st">&#39;time_limit&#39;</span>: <span class="dv">300</span>}</span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> resilient_training(predictor, train_data, fallback_strategies)</span></code></pre></div>
<h2 data-number="9.10" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">9.10</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 data-number="9.10.1" id="—Å–∂–∞—Ç–∏–µ-–º–æ–¥–µ–ª–∏-2"><span
class="header-section-number">9.10.1</span> 1. –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_for_production(predictor, target_size_mb: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    current_size <span class="op">=</span> get_model_size(predictor)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_size <span class="op">&lt;=</span> target_size_mb:</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;already_optimized&#39;</span>,</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;current_size&#39;</span>: current_size,</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;target_size&#39;</span>: target_size_mb</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    optimization_strategies <span class="op">=</span> [</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;name&#39;</span>: <span class="st">&#39;reduce_models&#39;</span>,</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;config&#39;</span>: {</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;excluded_model_types&#39;</span>: [<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;NN_TORCH&#39;</span>],</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;name&#39;</span>: <span class="st">&#39;compress_models&#39;</span>,</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;config&#39;</span>: {</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;save_space&#39;</span>: <span class="va">True</span>,</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;compress&#39;</span>: <span class="va">True</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;name&#39;</span>: <span class="st">&#39;simplify_ensemble&#39;</span>,</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;config&#39;</span>: {</span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_stack_levels&#39;</span>: <span class="dv">0</span></span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> strategy <span class="kw">in</span> optimization_strategies:</span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</span></span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a>            optimized_predictor <span class="op">=</span> apply_optimization_strategy(predictor, strategy)</span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞</span></span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a>            optimized_size <span class="op">=</span> get_model_size(optimized_predictor)</span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> optimized_size <span class="op">&lt;=</span> target_size_mb:</span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;status&#39;</span>: <span class="st">&#39;optimized&#39;</span>,</span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strategy&#39;</span>: strategy[<span class="st">&#39;name&#39;</span>],</span>
<span id="cb150-52"><a href="#cb150-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;original_size&#39;</span>: current_size,</span>
<span id="cb150-53"><a href="#cb150-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;optimized_size&#39;</span>: optimized_size,</span>
<span id="cb150-54"><a href="#cb150-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;compression_ratio&#39;</span>: optimized_size <span class="op">/</span> current_size</span>
<span id="cb150-55"><a href="#cb150-55" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb150-56"><a href="#cb150-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb150-57"><a href="#cb150-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb150-58"><a href="#cb150-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Optimization strategy </span><span class="sc">{</span>strategy[<span class="st">&#39;name&#39;</span>]<span class="sc">}</span><span class="ss"> failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb150-59"><a href="#cb150-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb150-60"><a href="#cb150-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-61"><a href="#cb150-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb150-62"><a href="#cb150-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;status&#39;</span>: <span class="st">&#39;failed&#39;</span>,</span>
<span id="cb150-63"><a href="#cb150-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;error&#39;</span>: <span class="st">&#39;Could not achieve target size&#39;</span>,</span>
<span id="cb150-64"><a href="#cb150-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;suggestions&#39;</span>: [</span>
<span id="cb150-65"><a href="#cb150-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Increase target size&#39;</span>,</span>
<span id="cb150-66"><a href="#cb150-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Use simpler algorithms&#39;</span>,</span>
<span id="cb150-67"><a href="#cb150-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Reduce training data&#39;</span>,</span>
<span id="cb150-68"><a href="#cb150-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Use model compression techniques&#39;</span></span>
<span id="cb150-69"><a href="#cb150-69" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb150-70"><a href="#cb150-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb150-71"><a href="#cb150-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-72"><a href="#cb150-72" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb150-73"><a href="#cb150-73" aria-hidden="true" tabindex="-1"></a>optimization_result <span class="op">=</span> optimize_for_production(predictor, target_size_mb<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb150-74"><a href="#cb150-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Optimization result: </span><span class="sc">{</span>optimization_result<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="9.10.2" id="–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="header-section-number">9.10.2</span> 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h3>
<div class="sourceCode" id="cb151"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Optional</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionCache:</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö—ç—à –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, cache_size: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>):</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cache_size <span class="op">=</span> cache_size</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cache <span class="op">=</span> {}</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.access_count <span class="op">=</span> {}</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _generate_cache_key(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>        data_str <span class="op">=</span> json.dumps(data, sort_keys<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> hashlib.md5(data_str.encode()).hexdigest()</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_prediction(<span class="va">self</span>, data: Dict) <span class="op">-&gt;</span> Optional[Any]:</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–∑ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>        cache_key <span class="op">=</span> <span class="va">self</span>._generate_cache_key(data)</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cache_key <span class="kw">in</span> <span class="va">self</span>.cache:</span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞</span></span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.access_count[cache_key] <span class="op">=</span> <span class="va">self</span>.access_count.get(cache_key, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.cache[cache_key]</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_prediction(<span class="va">self</span>, data: Dict, prediction: Any):</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –∫—ç—à&quot;&quot;&quot;</span></span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>        cache_key <span class="op">=</span> <span class="va">self</span>._generate_cache_key(data)</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞</span></span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.cache) <span class="op">&gt;=</span> <span class="va">self</span>.cache_size:</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–∏–º–µ–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞</span></span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>            least_used_key <span class="op">=</span> <span class="bu">min</span>(<span class="va">self</span>.access_count.keys(), key<span class="op">=</span><span class="va">self</span>.access_count.get)</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> <span class="va">self</span>.cache[least_used_key]</span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> <span class="va">self</span>.access_count[least_used_key]</span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞</span></span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cache[cache_key] <span class="op">=</span> prediction</span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.access_count[cache_key] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_cache_stats(<span class="va">self</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cache_size&#39;</span>: <span class="bu">len</span>(<span class="va">self</span>.cache),</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_cache_size&#39;</span>: <span class="va">self</span>.cache_size,</span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;hit_rate&#39;</span>: <span class="va">self</span>.calculate_hit_rate(),</span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;most_accessed&#39;</span>: <span class="bu">max</span>(<span class="va">self</span>.access_count.items(), key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>]) <span class="cf">if</span> <span class="va">self</span>.access_count <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_hit_rate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb151-54"><a href="#cb151-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç hit rate –∫—ç—à–∞&quot;&quot;&quot;</span></span>
<span id="cb151-55"><a href="#cb151-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.access_count:</span>
<span id="cb151-56"><a href="#cb151-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb151-57"><a href="#cb151-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-58"><a href="#cb151-58" aria-hidden="true" tabindex="-1"></a>        total_accesses <span class="op">=</span> <span class="bu">sum</span>(<span class="va">self</span>.access_count.values())</span>
<span id="cb151-59"><a href="#cb151-59" aria-hidden="true" tabindex="-1"></a>        cache_hits <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.cache)</span>
<span id="cb151-60"><a href="#cb151-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cache_hits <span class="op">/</span> total_accesses <span class="cf">if</span> total_accesses <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span></span>
<span id="cb151-61"><a href="#cb151-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-62"><a href="#cb151-62" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb151-63"><a href="#cb151-63" aria-hidden="true" tabindex="-1"></a>cache <span class="op">=</span> PredictionCache(cache_size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb151-64"><a href="#cb151-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-65"><a href="#cb151-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cached_predict(predictor, data: Dict) <span class="op">-&gt;</span> Any:</span>
<span id="cb151-66"><a href="#cb151-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb151-67"><a href="#cb151-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞</span></span>
<span id="cb151-68"><a href="#cb151-68" aria-hidden="true" tabindex="-1"></a>    cached_prediction <span class="op">=</span> cache.get_prediction(data)</span>
<span id="cb151-69"><a href="#cb151-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cached_prediction <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb151-70"><a href="#cb151-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cached_prediction</span>
<span id="cb151-71"><a href="#cb151-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-72"><a href="#cb151-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb151-73"><a href="#cb151-73" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> predictor.predict(pd.DataFrame([data]))</span>
<span id="cb151-74"><a href="#cb151-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-75"><a href="#cb151-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à</span></span>
<span id="cb151-76"><a href="#cb151-76" aria-hidden="true" tabindex="-1"></a>    cache.set_prediction(data, prediction)</span>
<span id="cb151-77"><a href="#cb151-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-78"><a href="#cb151-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prediction</span></code></pre></div>
<h2 data-number="9.11" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-7"><span
class="header-section-number">9.11</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a> - <a
href="./10_troubleshooting.md">Troubleshooting</a></p>
<hr />
<h1 data-number="10" id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-automl-gluon"><span
class="header-section-number">10</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML
Gluon</h1>
<h2 data-number="10.0" id="–ø–æ—á–µ–º—É-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">10.0</span> –ü–æ—á–µ–º—É –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="10.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span class="header-section-number">10.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="10.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"><span class="header-section-number">10.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="10.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–∏–º–µ—Ä—ã"><span
class="header-section-number">10.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–∏–º–µ—Ä—ã</h2>
<p><img src="images/monte_carlo_analysis.png"
alt="Monte Carlo –∞–Ω–∞–ª–∏–∑" /> <em>–†–∏—Å—É–Ω–æ–∫ 8.1: Monte Carlo –∞–Ω–∞–ª–∏–∑ -
—Ä–æ–±–∞—Å—Ç–Ω—ã–µ vs –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏, risk-return
–ø—Ä–æ—Ñ–∏–ª—å</em></p>
<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML
Gluon –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç
–ø–æ–ª–Ω—ã–π –∫–æ–¥, –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.</p>
<h2 data-number="10.2" id="–ø—Ä–∏–º–µ—Ä-1-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–∫–ª–∏–µ–Ω—Ç–æ–≤-–±–∞–Ω–∫–∞"><span
class="header-section-number">10.2</span> –ü—Ä–∏–º–µ—Ä 1: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
–∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞</h2>
<h3 data-number="10.2.1" id="–∑–∞–¥–∞—á–∞"><span
class="header-section-number">10.2.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ñ–æ–ª—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –±–∞–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö
–ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.</p>
<h3 data-number="10.2.2" id="–¥–∞–Ω–Ω—ã–µ"><span
class="header-section-number">10.2.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb152"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏</span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_bank_data(n_samples<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(</span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>        n_samples<span class="op">=</span>n_samples,</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>        n_features<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>        n_informative<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>        n_redundant<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>        n_classes<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame —Å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏</span></span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [</span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;age&#39;</span>, <span class="st">&#39;income&#39;</span>, <span class="st">&#39;credit_score&#39;</span>, <span class="st">&#39;debt_ratio&#39;</span>, <span class="st">&#39;employment_years&#39;</span>,</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;loan_amount&#39;</span>, <span class="st">&#39;interest_rate&#39;</span>, <span class="st">&#39;payment_history&#39;</span>, <span class="st">&#39;savings_balance&#39;</span>,</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;investment_value&#39;</span>, <span class="st">&#39;credit_cards&#39;</span>, <span class="st">&#39;late_payments&#39;</span>, <span class="st">&#39;bankruptcies&#39;</span>,</span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;foreclosures&#39;</span>, <span class="st">&#39;collections&#39;</span>, <span class="st">&#39;inquiries&#39;</span>, <span class="st">&#39;credit_utilization&#39;</span>,</span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;account_age&#39;</span>, <span class="st">&#39;payment_frequency&#39;</span>, <span class="st">&#39;credit_mix&#39;</span></span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>feature_names)</span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;default_risk&#39;</span>] <span class="op">=</span> y</span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb152-36"><a href="#cb152-36" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;employment_status&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;employed&#39;</span>, <span class="st">&#39;unemployed&#39;</span>, <span class="st">&#39;self_employed&#39;</span>], n_samples)</span>
<span id="cb152-37"><a href="#cb152-37" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;education&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;high_school&#39;</span>, <span class="st">&#39;bachelor&#39;</span>, <span class="st">&#39;master&#39;</span>, <span class="st">&#39;phd&#39;</span>], n_samples)</span>
<span id="cb152-38"><a href="#cb152-38" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;marital_status&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;single&#39;</span>, <span class="st">&#39;married&#39;</span>, <span class="st">&#39;divorced&#39;</span>], n_samples)</span>
<span id="cb152-39"><a href="#cb152-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-40"><a href="#cb152-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb152-41"><a href="#cb152-41" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;application_date&#39;</span>] <span class="op">=</span> pd.date_range(<span class="st">&#39;2020-01-01&#39;</span>, periods<span class="op">=</span>n_samples, freq<span class="op">=</span><span class="st">&#39;D&#39;</span>)</span>
<span id="cb152-42"><a href="#cb152-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb152-43"><a href="#cb152-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb152-44"><a href="#cb152-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-45"><a href="#cb152-45" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb152-46"><a href="#cb152-46" aria-hidden="true" tabindex="-1"></a>bank_data <span class="op">=</span> create_bank_data(<span class="dv">10000</span>)</span>
<span id="cb152-47"><a href="#cb152-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Bank data shape:&quot;</span>, bank_data.shape)</span>
<span id="cb152-48"><a href="#cb152-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Default rate:&quot;</span>, bank_data[<span class="st">&#39;default_risk&#39;</span>].mean())</span></code></pre></div>
<h3 data-number="10.2.3" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-2"><span
class="header-section-number">10.2.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb153"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_bank_data(data):</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.fillna(data.median())</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;debt_to_income&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;debt_ratio&#39;</span>] <span class="op">*</span> data[<span class="st">&#39;income&#39;</span>]</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;credit_utilization_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;credit_utilization&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;credit_score&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;payment_stability&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;payment_history&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;late_payments&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>    numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="op">!=</span> <span class="st">&#39;default_risk&#39;</span>:</span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>            Q1 <span class="op">=</span> data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a>            Q3 <span class="op">=</span> data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a>            IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&lt;</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, data[col])</span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&gt;</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, data[col])</span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-24"><a href="#cb153-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb153-25"><a href="#cb153-25" aria-hidden="true" tabindex="-1"></a>bank_data_processed <span class="op">=</span> prepare_bank_data(bank_data)</span></code></pre></div>
<h3 data-number="10.2.4" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-1"><span
class="header-section-number">10.2.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb154"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_bank_model(data):</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏&quot;&quot;&quot;</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>data[<span class="st">&#39;default_risk&#39;</span>])</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;default_risk&#39;</span>,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;roc_auc&#39;</span>,</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./bank_models&#39;</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>    hyperparameters <span class="op">=</span> {</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span></span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb154-33"><a href="#cb154-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span></span>
<span id="cb154-34"><a href="#cb154-34" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb154-35"><a href="#cb154-35" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb154-36"><a href="#cb154-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb154-37"><a href="#cb154-37" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb154-38"><a href="#cb154-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;iterations&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb154-39"><a href="#cb154-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb154-40"><a href="#cb154-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb154-41"><a href="#cb154-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;l2_leaf_reg&#39;</span>: <span class="fl">3.0</span></span>
<span id="cb154-42"><a href="#cb154-42" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb154-43"><a href="#cb154-43" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb154-44"><a href="#cb154-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb154-45"><a href="#cb154-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-46"><a href="#cb154-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb154-47"><a href="#cb154-47" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb154-48"><a href="#cb154-48" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb154-49"><a href="#cb154-49" aria-hidden="true" tabindex="-1"></a>        hyperparameters<span class="op">=</span>hyperparameters,</span>
<span id="cb154-50"><a href="#cb154-50" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">1800</span>,  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb154-51"><a href="#cb154-51" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb154-52"><a href="#cb154-52" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb154-53"><a href="#cb154-53" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb154-54"><a href="#cb154-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb154-55"><a href="#cb154-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-56"><a href="#cb154-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, test_data</span>
<span id="cb154-57"><a href="#cb154-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-58"><a href="#cb154-58" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb154-59"><a href="#cb154-59" aria-hidden="true" tabindex="-1"></a>bank_predictor, bank_test_data <span class="op">=</span> train_bank_model(bank_data_processed)</span></code></pre></div>
<h3 data-number="10.2.5" id="–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞"><span
class="header-section-number">10.2.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_bank_model(predictor, test_data):</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>    feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>    leaderboard <span class="op">=</span> predictor.leaderboard(test_data)</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature_importance&#39;</span>: feature_importance,</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;leaderboard&#39;</span>: leaderboard,</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;predictions&#39;</span>: predictions,</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;probabilities&#39;</span>: probabilities</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>bank_results <span class="op">=</span> evaluate_bank_model(bank_predictor, bank_test_data)</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Bank Model Performance:&quot;</span>)</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> bank_results[<span class="st">&#39;performance&#39;</span>].items():</span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Top 10 Feature Importance:&quot;</span>)</span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bank_results[<span class="st">&#39;feature_importance&#39;</span>].head(<span class="dv">10</span>))</span></code></pre></div>
<h3 data-number="10.2.6" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-1"><span
class="header-section-number">10.2.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="sourceCode" id="cb156"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_bank_results(results, test_data):</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ROC –∫—Ä–∏–≤–∞—è</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>    fpr, tpr, _ <span class="op">=</span> roc_curve(test_data[<span class="st">&#39;default_risk&#39;</span>], results[<span class="st">&#39;probabilities&#39;</span>][<span class="dv">1</span>])</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>    roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(fpr, tpr, label<span class="op">=</span><span class="ss">f&#39;ROC AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.3f}</span><span class="ss">&#39;</span>)</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">&#39;k--&#39;</span>)</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;ROC Curve&#39;</span>)</span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].legend()</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Precision-Recall –∫—Ä–∏–≤–∞—è</span></span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_curve</span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a>    precision, recall, _ <span class="op">=</span> precision_recall_curve(test_data[<span class="st">&#39;default_risk&#39;</span>], results[<span class="st">&#39;probabilities&#39;</span>][<span class="dv">1</span>])</span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(recall, precision)</span>
<span id="cb156-23"><a href="#cb156-23" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Recall&#39;</span>)</span>
<span id="cb156-24"><a href="#cb156-24" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Precision&#39;</span>)</span>
<span id="cb156-25"><a href="#cb156-25" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Precision-Recall Curve&#39;</span>)</span>
<span id="cb156-26"><a href="#cb156-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-27"><a href="#cb156-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb156-28"><a href="#cb156-28" aria-hidden="true" tabindex="-1"></a>    results[<span class="st">&#39;feature_importance&#39;</span>].head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb156-29"><a href="#cb156-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Top 10 Feature Importance&#39;</span>)</span>
<span id="cb156-30"><a href="#cb156-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-31"><a href="#cb156-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb156-32"><a href="#cb156-32" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].hist(results[<span class="st">&#39;probabilities&#39;</span>][<span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb156-33"><a href="#cb156-33" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Default Probability&#39;</span>)</span>
<span id="cb156-34"><a href="#cb156-34" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb156-35"><a href="#cb156-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Distribution of Default Probabilities&#39;</span>)</span>
<span id="cb156-36"><a href="#cb156-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb156-37"><a href="#cb156-37" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb156-38"><a href="#cb156-38" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb156-39"><a href="#cb156-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-40"><a href="#cb156-40" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb156-41"><a href="#cb156-41" aria-hidden="true" tabindex="-1"></a>visualize_bank_results(bank_results, bank_test_data)</span></code></pre></div>
<h2 data-number="10.3"
id="–ø—Ä–∏–º–µ—Ä-2-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ü–µ–Ω-–Ω–∞-–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å"><span
class="header-section-number">10.3</span> –ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω
–Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</h2>
<h3 data-number="10.3.1" id="–∑–∞–¥–∞—á–∞-1"><span
class="header-section-number">10.3.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ–±—ä–µ–∫—Ç–∞.</p>
<h3 data-number="10.3.2" id="–¥–∞–Ω–Ω—ã–µ-1"><span
class="header-section-number">10.3.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb157"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_real_estate_data(n_samples<span class="op">=</span><span class="dv">5000</span>):</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;area&#39;</span>: np.random.normal(<span class="dv">120</span>, <span class="dv">30</span>, n_samples),</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;bedrooms&#39;</span>: np.random.poisson(<span class="dv">3</span>, n_samples),</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;bathrooms&#39;</span>: np.random.poisson(<span class="dv">2</span>, n_samples),</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;age&#39;</span>: np.random.exponential(<span class="dv">10</span>, n_samples),</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;garage&#39;</span>: np.random.binomial(<span class="dv">1</span>, <span class="fl">0.7</span>, n_samples),</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;pool&#39;</span>: np.random.binomial(<span class="dv">1</span>, <span class="fl">0.2</span>, n_samples),</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;garden&#39;</span>: np.random.binomial(<span class="dv">1</span>, <span class="fl">0.6</span>, n_samples)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;location&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;downtown&#39;</span>, <span class="st">&#39;suburbs&#39;</span>, <span class="st">&#39;rural&#39;</span>], n_samples)</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;property_type&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;house&#39;</span>, <span class="st">&#39;apartment&#39;</span>, <span class="st">&#39;townhouse&#39;</span>], n_samples)</span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;condition&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;excellent&#39;</span>, <span class="st">&#39;good&#39;</span>, <span class="st">&#39;fair&#39;</span>, <span class="st">&#39;poor&#39;</span>], n_samples)</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (—Ü–µ–Ω–∞)</span></span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>    base_price <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>    price <span class="op">=</span> (base_price <span class="op">+</span> </span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;area&#39;</span>] <span class="op">*</span> <span class="dv">1000</span> <span class="op">+</span></span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;bedrooms&#39;</span>] <span class="op">*</span> <span class="dv">10000</span> <span class="op">+</span></span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;bathrooms&#39;</span>] <span class="op">*</span> <span class="dv">5000</span> <span class="op">+</span></span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;garage&#39;</span>] <span class="op">*</span> <span class="dv">15000</span> <span class="op">+</span></span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;pool&#39;</span>] <span class="op">*</span> <span class="dv">25000</span> <span class="op">+</span></span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;garden&#39;</span>] <span class="op">*</span> <span class="dv">10000</span> <span class="op">-</span></span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a>             data[<span class="st">&#39;age&#39;</span>] <span class="op">*</span> <span class="dv">2000</span>)</span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞</span></span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a>    price <span class="op">+=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">20000</span>, n_samples)</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;price&#39;</span>] <span class="op">=</span> np.maximum(price, <span class="dv">50000</span>)  <span class="co"># –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞</span></span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a>real_estate_data <span class="op">=</span> create_real_estate_data(<span class="dv">5000</span>)</span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Real estate data shape:&quot;</span>, real_estate_data.shape)</span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Price statistics:&quot;</span>)</span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(real_estate_data[<span class="st">&#39;price&#39;</span>].describe())</span></code></pre></div>
<h3 data-number="10.3.3" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-3"><span
class="header-section-number">10.3.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb158"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_real_estate_data(data):</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;area_per_bedroom&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;area&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;bedrooms&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;total_rooms&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;bedrooms&#39;</span>] <span class="op">+</span> data[<span class="st">&#39;bathrooms&#39;</span>]</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;age_category&#39;</span>] <span class="op">=</span> pd.cut(data[<span class="st">&#39;age&#39;</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">100</span>], labels<span class="op">=</span>[<span class="st">&#39;new&#39;</span>, <span class="st">&#39;recent&#39;</span>, <span class="st">&#39;old&#39;</span>, <span class="st">&#39;very_old&#39;</span>])</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;area&#39;</span>] <span class="op">=</span> np.where(data[<span class="st">&#39;area&#39;</span>] <span class="op">&gt;</span> <span class="dv">300</span>, <span class="dv">300</span>, data[<span class="st">&#39;area&#39;</span>])</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;age&#39;</span>] <span class="op">=</span> np.where(data[<span class="st">&#39;age&#39;</span>] <span class="op">&gt;</span> <span class="dv">50</span>, <span class="dv">50</span>, data[<span class="st">&#39;age&#39;</span>])</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>real_estate_processed <span class="op">=</span> prepare_real_estate_data(real_estate_data)</span></code></pre></div>
<h3 data-number="10.3.4" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-2"><span
class="header-section-number">10.3.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_real_estate_model(data):</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;price&#39;</span>,</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span>,</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./real_estate_models&#39;</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>    hyperparameters <span class="op">=</span> {</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">300</span>,</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">300</span>,</span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>,</span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">2</span></span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>        hyperparameters<span class="op">=</span>hyperparameters,</span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">1800</span>,  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, test_data</span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a>real_estate_predictor, real_estate_test_data <span class="op">=</span> train_real_estate_model(real_estate_processed)</span></code></pre></div>
<h3 data-number="10.3.5" id="–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-1"><span
class="header-section-number">10.3.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="sourceCode" id="cb160"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_real_estate_model(predictor, test_data):</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>    feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    leaderboard <span class="op">=</span> predictor.leaderboard(test_data)</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>    errors <span class="op">=</span> test_data[<span class="st">&#39;price&#39;</span>] <span class="op">-</span> predictions</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>    mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(errors))</span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>    mape <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(errors <span class="op">/</span> test_data[<span class="st">&#39;price&#39;</span>])) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature_importance&#39;</span>: feature_importance,</span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;leaderboard&#39;</span>: leaderboard,</span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;predictions&#39;</span>: predictions,</span>
<span id="cb160-26"><a href="#cb160-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;mae&#39;</span>: mae,</span>
<span id="cb160-27"><a href="#cb160-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;mape&#39;</span>: mape,</span>
<span id="cb160-28"><a href="#cb160-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;errors&#39;</span>: errors</span>
<span id="cb160-29"><a href="#cb160-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb160-30"><a href="#cb160-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-31"><a href="#cb160-31" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb160-32"><a href="#cb160-32" aria-hidden="true" tabindex="-1"></a>real_estate_results <span class="op">=</span> evaluate_real_estate_model(real_estate_predictor, real_estate_test_data)</span>
<span id="cb160-33"><a href="#cb160-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-34"><a href="#cb160-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Real Estate Model Performance:&quot;</span>)</span>
<span id="cb160-35"><a href="#cb160-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> real_estate_results[<span class="st">&#39;performance&#39;</span>].items():</span>
<span id="cb160-36"><a href="#cb160-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb160-37"><a href="#cb160-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-38"><a href="#cb160-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>real_estate_results[<span class="st">&#39;mae&#39;</span>]<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb160-39"><a href="#cb160-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MAPE: </span><span class="sc">{</span>real_estate_results[<span class="st">&#39;mape&#39;</span>]<span class="sc">:.2f}</span><span class="ss">%&quot;</span>)</span></code></pre></div>
<h3 data-number="10.3.6" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-2"><span
class="header-section-number">10.3.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="sourceCode" id="cb161"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_real_estate_results(results, test_data):</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].scatter(test_data[<span class="st">&#39;price&#39;</span>], results[<span class="st">&#39;predictions&#39;</span>], alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].plot([test_data[<span class="st">&#39;price&#39;</span>].<span class="bu">min</span>(), test_data[<span class="st">&#39;price&#39;</span>].<span class="bu">max</span>()], </span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                   [test_data[<span class="st">&#39;price&#39;</span>].<span class="bu">min</span>(), test_data[<span class="st">&#39;price&#39;</span>].<span class="bu">max</span>()], <span class="st">&#39;r--&#39;</span>)</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;Actual Price&#39;</span>)</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;Predicted Price&#39;</span>)</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Predictions vs Actual&#39;</span>)</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].hist(results[<span class="st">&#39;errors&#39;</span>], bins<span class="op">=</span><span class="dv">50</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Prediction Error&#39;</span>)</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Distribution of Prediction Errors&#39;</span>)</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>    results[<span class="st">&#39;feature_importance&#39;</span>].head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Top 10 Feature Importance&#39;</span>)</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—à–∏–±–∫–∏ –ø–æ —Ü–µ–Ω–µ</span></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].scatter(test_data[<span class="st">&#39;price&#39;</span>], results[<span class="st">&#39;errors&#39;</span>], alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Actual Price&#39;</span>)</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Prediction Error&#39;</span>)</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Errors by Price Range&#39;</span>)</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>visualize_real_estate_results(real_estate_results, real_estate_test_data)</span></code></pre></div>
<h2 data-number="10.4" id="–ø—Ä–∏–º–µ—Ä-3-–∞–Ω–∞–ª–∏–∑-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">10.4</span> –ü—Ä–∏–º–µ—Ä 3: –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</h2>
<h3 data-number="10.4.1" id="–∑–∞–¥–∞—á–∞-2"><span
class="header-section-number">10.4.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
<h3 data-number="10.4.2" id="–¥–∞–Ω–Ω—ã–µ-2"><span
class="header-section-number">10.4.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb162"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_sales_data(n_days<span class="op">=</span><span class="dv">365</span>, n_products<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö&quot;&quot;&quot;</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> pd.date_range(<span class="st">&#39;2023-01-01&#39;</span>, periods<span class="op">=</span>n_days, freq<span class="op">=</span><span class="st">&#39;D&#39;</span>)</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> []</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> product_id <span class="kw">in</span> <span class="bu">range</span>(n_products):</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–π —Ç—Ä–µ–Ω–¥</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>        trend <span class="op">=</span> np.linspace(<span class="dv">100</span>, <span class="dv">150</span>, n_days)</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è)</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>        seasonality <span class="op">=</span> <span class="dv">20</span> <span class="op">*</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> np.arange(n_days) <span class="op">/</span> <span class="dv">7</span>)</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω—ã–π —à—É–º</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>        noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">10</span>, n_days)</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–¥–∞–∂–∏</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>        sales <span class="op">=</span> trend <span class="op">+</span> seasonality <span class="op">+</span> noise</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>        sales <span class="op">=</span> np.maximum(sales, <span class="dv">0</span>)  <span class="co"># –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π</span></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, (date, sale) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(dates, sales)):</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>            data.append({</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;date&#39;</span>: date,</span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;product_id&#39;</span>: <span class="ss">f&#39;product_</span><span class="sc">{</span>product_id<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;sales&#39;</span>: sale,</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;day_of_week&#39;</span>: date.dayofweek,</span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;month&#39;</span>: date.month,</span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;quarter&#39;</span>: date.quarter</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(data)</span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> create_sales_data(<span class="dv">365</span>, <span class="dv">10</span>)</span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Sales data shape:&quot;</span>, sales_data.shape)</span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Sales statistics:&quot;</span>)</span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales_data[<span class="st">&#39;sales&#39;</span>].describe())</span></code></pre></div>
<h3 data-number="10.4.3"
id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">10.4.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è
–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="sourceCode" id="cb163"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_sales_data(data):</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ª–∞–≥–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.sort_values([<span class="st">&#39;product_id&#39;</span>, <span class="st">&#39;date&#39;</span>])</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> lag <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>]:</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="ss">f&#39;sales_lag_</span><span class="sc">{</span>lag<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data.groupby(<span class="st">&#39;product_id&#39;</span>)[<span class="st">&#39;sales&#39;</span>].shift(lag)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> window <span class="kw">in</span> [<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>]:</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>        data[<span class="ss">f&#39;sales_ma_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data.groupby(<span class="st">&#39;product_id&#39;</span>)[<span class="st">&#39;sales&#39;</span>].rolling(window<span class="op">=</span>window).mean().reset_index(<span class="dv">0</span>, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢—Ä–µ–Ω–¥—ã</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;sales_trend&#39;</span>] <span class="op">=</span> data.groupby(<span class="st">&#39;product_id&#39;</span>)[<span class="st">&#39;sales&#39;</span>].rolling(window<span class="op">=</span><span class="dv">7</span>).mean().reset_index(<span class="dv">0</span>, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–µ–∑–æ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;is_weekend&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;day_of_week&#39;</span>] <span class="op">&gt;=</span> <span class="dv">5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;is_month_start&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;date&#39;</span>].dt.day <span class="op">&lt;=</span> <span class="dv">7</span>).astype(<span class="bu">int</span>)</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;is_month_end&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;date&#39;</span>].dt.day <span class="op">&gt;=</span> <span class="dv">25</span>).astype(<span class="bu">int</span>)</span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>sales_processed <span class="op">=</span> prepare_sales_data(sales_data)</span></code></pre></div>
<h3 data-number="10.4.4" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">10.4.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</h3>
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_sales_model(data):</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π –¥–ª—è —Ç–µ—Å—Ç–∞)</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>    split_date <span class="op">=</span> data[<span class="st">&#39;date&#39;</span>].<span class="bu">max</span>() <span class="op">-</span> pd.Timedelta(days<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> data[data[<span class="st">&#39;date&#39;</span>] <span class="op">&lt;=</span> split_date]</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[data[<span class="st">&#39;date&#39;</span>] <span class="op">&gt;</span> split_date]</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;sales&#39;</span>,</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span>,</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./sales_models&#39;</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>    hyperparameters <span class="op">=</span> {</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a>        hyperparameters<span class="op">=</span>hyperparameters,</span>
<span id="cb164-44"><a href="#cb164-44" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">1800</span>,  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb164-45"><a href="#cb164-45" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb164-46"><a href="#cb164-46" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span><span class="dv">3</span>,  <span class="co"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb164-47"><a href="#cb164-47" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb164-48"><a href="#cb164-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb164-49"><a href="#cb164-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-50"><a href="#cb164-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, test_data</span>
<span id="cb164-51"><a href="#cb164-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-52"><a href="#cb164-52" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb164-53"><a href="#cb164-53" aria-hidden="true" tabindex="-1"></a>sales_predictor, sales_test_data <span class="op">=</span> train_sales_model(sales_processed)</span></code></pre></div>
<h3 data-number="10.4.5" id="–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">10.4.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</h3>
<div class="sourceCode" id="cb165"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_sales_model(predictor, test_data):</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>    feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>    product_performance <span class="op">=</span> {}</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> product_id <span class="kw">in</span> test_data[<span class="st">&#39;product_id&#39;</span>].unique():</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>        product_data <span class="op">=</span> test_data[test_data[<span class="st">&#39;product_id&#39;</span>] <span class="op">==</span> product_id]</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>        product_predictions <span class="op">=</span> predictions[test_data[<span class="st">&#39;product_id&#39;</span>] <span class="op">==</span> product_id]</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>        mae <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(product_data[<span class="st">&#39;sales&#39;</span>] <span class="op">-</span> product_predictions))</span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>        mape <span class="op">=</span> np.mean(np.<span class="bu">abs</span>((product_data[<span class="st">&#39;sales&#39;</span>] <span class="op">-</span> product_predictions) <span class="op">/</span> product_data[<span class="st">&#39;sales&#39;</span>])) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>        product_performance[product_id] <span class="op">=</span> {</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mae&#39;</span>: mae,</span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mape&#39;</span>: mape</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature_importance&#39;</span>: feature_importance,</span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;product_performance&#39;</span>: product_performance,</span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;predictions&#39;</span>: predictions</span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a>sales_results <span class="op">=</span> evaluate_sales_model(sales_predictor, sales_test_data)</span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Sales Model Performance:&quot;</span>)</span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> sales_results[<span class="st">&#39;performance&#39;</span>].items():</span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Product Performance:&quot;</span>)</span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> product, perf <span class="kw">in</span> sales_results[<span class="st">&#39;product_performance&#39;</span>].items():</span>
<span id="cb165-43"><a href="#cb165-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>product<span class="sc">}</span><span class="ss">: MAE=</span><span class="sc">{</span>perf[<span class="st">&#39;mae&#39;</span>]<span class="sc">:.2f}</span><span class="ss">, MAPE=</span><span class="sc">{</span>perf[<span class="st">&#39;mape&#39;</span>]<span class="sc">:.2f}</span><span class="ss">%&quot;</span>)</span></code></pre></div>
<h3 data-number="10.4.6" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö-—Ä—è–¥–æ–≤"><span
class="header-section-number">10.4.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
—Ä—è–¥–æ–≤</h3>
<div class="sourceCode" id="cb166"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_sales_results(results, test_data):</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>    product_id <span class="op">=</span> test_data[<span class="st">&#39;product_id&#39;</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>    product_data <span class="op">=</span> test_data[test_data[<span class="st">&#39;product_id&#39;</span>] <span class="op">==</span> product_id]</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>    product_predictions <span class="op">=</span> results[<span class="st">&#39;predictions&#39;</span>][test_data[<span class="st">&#39;product_id&#39;</span>] <span class="op">==</span> product_id]</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(product_data[<span class="st">&#39;date&#39;</span>], product_data[<span class="st">&#39;sales&#39;</span>], label<span class="op">=</span><span class="st">&#39;Actual&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(product_data[<span class="st">&#39;date&#39;</span>], product_predictions, label<span class="op">=</span><span class="st">&#39;Predicted&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="ss">f&#39;Sales Forecast for </span><span class="sc">{</span>product_id<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;Sales&#39;</span>)</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].legend()</span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>    errors <span class="op">=</span> test_data[<span class="st">&#39;sales&#39;</span>] <span class="op">-</span> results[<span class="st">&#39;predictions&#39;</span>]</span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].hist(errors, bins<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Prediction Error&#39;</span>)</span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Distribution of Prediction Errors&#39;</span>)</span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>    results[<span class="st">&#39;feature_importance&#39;</span>].head(<span class="dv">10</span>).plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Top 10 Feature Importance&#39;</span>)</span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a>    products <span class="op">=</span> <span class="bu">list</span>(results[<span class="st">&#39;product_performance&#39;</span>].keys())</span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a>    maes <span class="op">=</span> [results[<span class="st">&#39;product_performance&#39;</span>][p][<span class="st">&#39;mae&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> products]</span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].bar(products, maes)</span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Product&#39;</span>)</span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;MAE&#39;</span>)</span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Performance by Product&#39;</span>)</span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a>visualize_sales_results(sales_results, sales_test_data)</span></code></pre></div>
<h2 data-number="10.5" id="–ø—Ä–∏–º–µ—Ä-4-–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è"><span
class="header-section-number">10.5</span> –ü—Ä–∏–º–µ—Ä 4: –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è
–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
<h3 data-number="10.5.1" id="–∑–∞–¥–∞—á–∞-3"><span
class="header-section-number">10.5.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>
<h3 data-number="10.5.2" id="–¥–∞–Ω–Ω—ã–µ-3"><span
class="header-section-number">10.5.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<div class="sourceCode" id="cb167"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_image_data(n_samples<span class="op">=</span><span class="dv">5000</span>, n_features<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> np.random.randn(n_samples, n_features)</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    n_classes <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    classes <span class="op">=</span> [<span class="st">&#39;cat&#39;</span>, <span class="st">&#39;dog&#39;</span>, <span class="st">&#39;bird&#39;</span>, <span class="st">&#39;car&#39;</span>, <span class="st">&#39;tree&#39;</span>]</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.choice(n_classes, n_samples)</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_features)]</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(features, columns<span class="op">=</span>feature_names)</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;class&#39;</span>] <span class="op">=</span> [classes[i] <span class="cf">for</span> i <span class="kw">in</span> y]</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;image_size&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;small&#39;</span>, <span class="st">&#39;medium&#39;</span>, <span class="st">&#39;large&#39;</span>], n_samples)</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;color_channels&#39;</span>] <span class="op">=</span> np.random.choice([<span class="dv">1</span>, <span class="dv">3</span>], n_samples)</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;resolution&#39;</span>] <span class="op">=</span> np.random.choice([<span class="st">&#39;low&#39;</span>, <span class="st">&#39;medium&#39;</span>, <span class="st">&#39;high&#39;</span>], n_samples)</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>image_data <span class="op">=</span> create_image_data(<span class="dv">5000</span>, <span class="dv">100</span>)</span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Image data shape:&quot;</span>, image_data.shape)</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class distribution:&quot;</span>)</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image_data[<span class="st">&#39;class&#39;</span>].value_counts())</span></code></pre></div>
<h3 data-number="10.5.3" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-4"><span
class="header-section-number">10.5.3</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb168"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_image_data(data):</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;feature_sum&#39;</span>] <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;feature_mean&#39;</span>] <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;feature_std&#39;</span>] <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).std(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>    numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="op">!=</span> <span class="st">&#39;color_channels&#39;</span>:</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> (data[col] <span class="op">-</span> data[col].mean()) <span class="op">/</span> data[col].std()</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>image_processed <span class="op">=</span> prepare_image_data(image_data)</span></code></pre></div>
<h3 data-number="10.5.4" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏-3"><span
class="header-section-number">10.5.4</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb169"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_image_model(data):</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>    train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>data[<span class="st">&#39;class&#39;</span>])</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;class&#39;</span>,</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;multiclass&#39;</span>,</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./image_models&#39;</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>    hyperparameters <span class="op">=</span> {</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">31</span>,</span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_data_in_leaf&#39;</span>: <span class="dv">20</span></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>,</span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;subsample&#39;</span>: <span class="fl">0.8</span>,</span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;colsample_bytree&#39;</span>: <span class="fl">0.8</span></span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb169-36"><a href="#cb169-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb169-37"><a href="#cb169-37" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb169-38"><a href="#cb169-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>,</span>
<span id="cb169-39"><a href="#cb169-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>,</span>
<span id="cb169-40"><a href="#cb169-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb169-41"><a href="#cb169-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">2</span></span>
<span id="cb169-42"><a href="#cb169-42" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb169-43"><a href="#cb169-43" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb169-44"><a href="#cb169-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb169-45"><a href="#cb169-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-46"><a href="#cb169-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb169-47"><a href="#cb169-47" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb169-48"><a href="#cb169-48" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb169-49"><a href="#cb169-49" aria-hidden="true" tabindex="-1"></a>        hyperparameters<span class="op">=</span>hyperparameters,</span>
<span id="cb169-50"><a href="#cb169-50" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">1800</span>,  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb169-51"><a href="#cb169-51" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb169-52"><a href="#cb169-52" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb169-53"><a href="#cb169-53" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span><span class="dv">1</span></span>
<span id="cb169-54"><a href="#cb169-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-55"><a href="#cb169-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb169-56"><a href="#cb169-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, test_data</span>
<span id="cb169-57"><a href="#cb169-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-58"><a href="#cb169-58" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb169-59"><a href="#cb169-59" aria-hidden="true" tabindex="-1"></a>image_predictor, image_test_data <span class="op">=</span> train_image_model(image_processed)</span></code></pre></div>
<h3 data-number="10.5.5" id="–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞-2"><span
class="header-section-number">10.5.5</span> –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="sourceCode" id="cb170"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_image_model(predictor, test_data):</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    feature_importance <span class="op">=</span> predictor.feature_importance()</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    leaderboard <span class="op">=</span> predictor.leaderboard(test_data)</span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–ª–∞—Å—Å–∞–º</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>    class_report <span class="op">=</span> classification_report(test_data[<span class="st">&#39;class&#39;</span>], predictions, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>    conf_matrix <span class="op">=</span> confusion_matrix(test_data[<span class="st">&#39;class&#39;</span>], predictions)</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;performance&#39;</span>: performance,</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feature_importance&#39;</span>: feature_importance,</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;leaderboard&#39;</span>: leaderboard,</span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;predictions&#39;</span>: predictions,</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;probabilities&#39;</span>: probabilities,</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;classification_report&#39;</span>: class_report,</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;confusion_matrix&#39;</span>: conf_matrix</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>image_results <span class="op">=</span> evaluate_image_model(image_predictor, image_test_data)</span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Image Model Performance:&quot;</span>)</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> image_results[<span class="st">&#39;performance&#39;</span>].items():</span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> class_name, metrics <span class="kw">in</span> image_results[<span class="st">&#39;classification_report&#39;</span>].items():</span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(metrics, <span class="bu">dict</span>):</span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>class_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>metrics<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="10.5.6" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-3"><span
class="header-section-number">10.5.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="sourceCode" id="cb171"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_image_results(results, test_data):</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(results[<span class="st">&#39;confusion_matrix&#39;</span>], annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>    results[<span class="st">&#39;feature_importance&#39;</span>].head(<span class="dv">15</span>).plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Top 15 Feature Importance&#39;</span>)</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>    prediction_counts <span class="op">=</span> pd.Series(results[<span class="st">&#39;predictions&#39;</span>]).value_counts()</span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>    prediction_counts.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&#39;Distribution of Predictions&#39;</span>)</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">&#39;Class&#39;</span>)</span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∞—Å—Å–∞–º</span></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>    class_accuracy <span class="op">=</span> []</span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> class_name <span class="kw">in</span> test_data[<span class="st">&#39;class&#39;</span>].unique():</span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>        class_data <span class="op">=</span> test_data[test_data[<span class="st">&#39;class&#39;</span>] <span class="op">==</span> class_name]</span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>        class_predictions <span class="op">=</span> results[<span class="st">&#39;predictions&#39;</span>][test_data[<span class="st">&#39;class&#39;</span>] <span class="op">==</span> class_name]</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> (class_data[<span class="st">&#39;class&#39;</span>] <span class="op">==</span> class_predictions).mean()</span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a>        class_accuracy.append(accuracy)</span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].bar(test_data[<span class="st">&#39;class&#39;</span>].unique(), class_accuracy)</span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&#39;Accuracy by Class&#39;</span>)</span>
<span id="cb171-35"><a href="#cb171-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">&#39;Class&#39;</span>)</span>
<span id="cb171-36"><a href="#cb171-36" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb171-37"><a href="#cb171-37" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb171-38"><a href="#cb171-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb171-39"><a href="#cb171-39" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb171-40"><a href="#cb171-40" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb171-41"><a href="#cb171-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-42"><a href="#cb171-42" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb171-43"><a href="#cb171-43" aria-hidden="true" tabindex="-1"></a>visualize_image_results(image_results, image_test_data)</span></code></pre></div>
<h2 data-number="10.6" id="–ø—Ä–∏–º–µ—Ä-5-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">10.6</span> –ü—Ä–∏–º–µ—Ä 5: –ü—Ä–æ–¥–∞–∫—à–µ–Ω
—Å–∏—Å—Ç–µ–º–∞</h2>
<h3 data-number="10.6.1" id="–ø–æ–ª–Ω–∞—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">10.6.1</span> –ü–æ–ª–Ω–∞—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω
—Å–∏—Å—Ç–µ–º–∞</h3>
<div class="sourceCode" id="cb172"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastapi <span class="im">import</span> FastAPI, HTTPException</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Any</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aiohttp</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> FastAPI(title<span class="op">=</span><span class="st">&quot;AutoML Gluon Production API&quot;</span>, version<span class="op">=</span><span class="st">&quot;1.0.0&quot;</span>)</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {}</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>model_metadata <span class="op">=</span> {}</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionRequest(BaseModel):</span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>    model_name: <span class="bu">str</span></span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>    data: List[Dict[<span class="bu">str</span>, Any]]</span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictionResponse(BaseModel):</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a>    predictions: List[Any]</span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a>    probabilities: List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb172-30"><a href="#cb172-30" aria-hidden="true" tabindex="-1"></a>    model_info: Dict[<span class="bu">str</span>, Any]</span>
<span id="cb172-31"><a href="#cb172-31" aria-hidden="true" tabindex="-1"></a>    timestamp: <span class="bu">str</span></span>
<span id="cb172-32"><a href="#cb172-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-33"><a href="#cb172-33" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ModelInfo(BaseModel):</span>
<span id="cb172-34"><a href="#cb172-34" aria-hidden="true" tabindex="-1"></a>    model_name: <span class="bu">str</span></span>
<span id="cb172-35"><a href="#cb172-35" aria-hidden="true" tabindex="-1"></a>    model_type: <span class="bu">str</span></span>
<span id="cb172-36"><a href="#cb172-36" aria-hidden="true" tabindex="-1"></a>    performance: Dict[<span class="bu">str</span>, <span class="bu">float</span>]</span>
<span id="cb172-37"><a href="#cb172-37" aria-hidden="true" tabindex="-1"></a>    features: List[<span class="bu">str</span>]</span>
<span id="cb172-38"><a href="#cb172-38" aria-hidden="true" tabindex="-1"></a>    created_at: <span class="bu">str</span></span>
<span id="cb172-39"><a href="#cb172-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-40"><a href="#cb172-40" aria-hidden="true" tabindex="-1"></a><span class="at">@app.on_event</span>(<span class="st">&quot;startup&quot;</span>)</span>
<span id="cb172-41"><a href="#cb172-41" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> load_models():</span>
<span id="cb172-42"><a href="#cb172-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ&quot;&quot;&quot;</span></span>
<span id="cb172-43"><a href="#cb172-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> models, model_metadata</span>
<span id="cb172-44"><a href="#cb172-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-45"><a href="#cb172-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb172-46"><a href="#cb172-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb172-47"><a href="#cb172-47" aria-hidden="true" tabindex="-1"></a>        models[<span class="st">&#39;bank_default&#39;</span>] <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;./bank_models&#39;</span>)</span>
<span id="cb172-48"><a href="#cb172-48" aria-hidden="true" tabindex="-1"></a>        model_metadata[<span class="st">&#39;bank_default&#39;</span>] <span class="op">=</span> {</span>
<span id="cb172-49"><a href="#cb172-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_type&#39;</span>: <span class="st">&#39;binary_classification&#39;</span>,</span>
<span id="cb172-50"><a href="#cb172-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;target&#39;</span>: <span class="st">&#39;default_risk&#39;</span>,</span>
<span id="cb172-51"><a href="#cb172-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;features&#39;</span>: [<span class="st">&#39;age&#39;</span>, <span class="st">&#39;income&#39;</span>, <span class="st">&#39;credit_score&#39;</span>, <span class="st">&#39;debt_ratio&#39;</span>, <span class="st">&#39;employment_years&#39;</span>]</span>
<span id="cb172-52"><a href="#cb172-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb172-53"><a href="#cb172-53" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="st">&quot;Bank model loaded successfully&quot;</span>)</span>
<span id="cb172-54"><a href="#cb172-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb172-55"><a href="#cb172-55" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Failed to load bank model: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb172-56"><a href="#cb172-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-57"><a href="#cb172-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb172-58"><a href="#cb172-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb172-59"><a href="#cb172-59" aria-hidden="true" tabindex="-1"></a>        models[<span class="st">&#39;real_estate&#39;</span>] <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;./real_estate_models&#39;</span>)</span>
<span id="cb172-60"><a href="#cb172-60" aria-hidden="true" tabindex="-1"></a>        model_metadata[<span class="st">&#39;real_estate&#39;</span>] <span class="op">=</span> {</span>
<span id="cb172-61"><a href="#cb172-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_type&#39;</span>: <span class="st">&#39;regression&#39;</span>,</span>
<span id="cb172-62"><a href="#cb172-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;target&#39;</span>: <span class="st">&#39;price&#39;</span>,</span>
<span id="cb172-63"><a href="#cb172-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;features&#39;</span>: [<span class="st">&#39;area&#39;</span>, <span class="st">&#39;bedrooms&#39;</span>, <span class="st">&#39;bathrooms&#39;</span>, <span class="st">&#39;age&#39;</span>, <span class="st">&#39;location&#39;</span>]</span>
<span id="cb172-64"><a href="#cb172-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb172-65"><a href="#cb172-65" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="st">&quot;Real estate model loaded successfully&quot;</span>)</span>
<span id="cb172-66"><a href="#cb172-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb172-67"><a href="#cb172-67" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Failed to load real estate model: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb172-68"><a href="#cb172-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-69"><a href="#cb172-69" aria-hidden="true" tabindex="-1"></a><span class="at">@app.get</span>(<span class="st">&quot;/health&quot;</span>)</span>
<span id="cb172-70"><a href="#cb172-70" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> health_check():</span>
<span id="cb172-71"><a href="#cb172-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span></span>
<span id="cb172-72"><a href="#cb172-72" aria-hidden="true" tabindex="-1"></a>    loaded_models <span class="op">=</span> <span class="bu">list</span>(models.keys())</span>
<span id="cb172-73"><a href="#cb172-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb172-74"><a href="#cb172-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;status&quot;</span>: <span class="st">&quot;healthy&quot;</span> <span class="cf">if</span> loaded_models <span class="cf">else</span> <span class="st">&quot;unhealthy&quot;</span>,</span>
<span id="cb172-75"><a href="#cb172-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;loaded_models&quot;</span>: loaded_models,</span>
<span id="cb172-76"><a href="#cb172-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;timestamp&quot;</span>: datetime.now().isoformat()</span>
<span id="cb172-77"><a href="#cb172-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-78"><a href="#cb172-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-79"><a href="#cb172-79" aria-hidden="true" tabindex="-1"></a><span class="at">@app.post</span>(<span class="st">&quot;/predict&quot;</span>, response_model<span class="op">=</span>PredictionResponse)</span>
<span id="cb172-80"><a href="#cb172-80" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> predict(request: PredictionRequest):</span>
<span id="cb172-81"><a href="#cb172-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb172-82"><a href="#cb172-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-83"><a href="#cb172-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> request.model_name <span class="kw">not</span> <span class="kw">in</span> models:</span>
<span id="cb172-84"><a href="#cb172-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">404</span>, detail<span class="op">=</span><span class="ss">f&quot;Model </span><span class="sc">{</span>request<span class="sc">.</span>model_name<span class="sc">}</span><span class="ss"> not found&quot;</span>)</span>
<span id="cb172-85"><a href="#cb172-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-86"><a href="#cb172-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb172-87"><a href="#cb172-87" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> models[request.model_name]</span>
<span id="cb172-88"><a href="#cb172-88" aria-hidden="true" tabindex="-1"></a>        metadata <span class="op">=</span> model_metadata[request.model_name]</span>
<span id="cb172-89"><a href="#cb172-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb172-90"><a href="#cb172-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb172-91"><a href="#cb172-91" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(request.data)</span>
<span id="cb172-92"><a href="#cb172-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb172-93"><a href="#cb172-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb172-94"><a href="#cb172-94" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> model.predict(df)</span>
<span id="cb172-95"><a href="#cb172-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb172-96"><a href="#cb172-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span></span>
<span id="cb172-97"><a href="#cb172-97" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">None</span></span>
<span id="cb172-98"><a href="#cb172-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;predict_proba&#39;</span>):</span>
<span id="cb172-99"><a href="#cb172-99" aria-hidden="true" tabindex="-1"></a>            proba <span class="op">=</span> model.predict_proba(df)</span>
<span id="cb172-100"><a href="#cb172-100" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> proba.to_dict(<span class="st">&#39;records&#39;</span>)</span>
<span id="cb172-101"><a href="#cb172-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb172-102"><a href="#cb172-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> PredictionResponse(</span>
<span id="cb172-103"><a href="#cb172-103" aria-hidden="true" tabindex="-1"></a>            predictions<span class="op">=</span>predictions.tolist(),</span>
<span id="cb172-104"><a href="#cb172-104" aria-hidden="true" tabindex="-1"></a>            probabilities<span class="op">=</span>probabilities,</span>
<span id="cb172-105"><a href="#cb172-105" aria-hidden="true" tabindex="-1"></a>            model_info<span class="op">=</span>{</span>
<span id="cb172-106"><a href="#cb172-106" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;model_name&quot;</span>: request.model_name,</span>
<span id="cb172-107"><a href="#cb172-107" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;model_type&quot;</span>: metadata[<span class="st">&#39;model_type&#39;</span>],</span>
<span id="cb172-108"><a href="#cb172-108" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;target&quot;</span>: metadata[<span class="st">&#39;target&#39;</span>],</span>
<span id="cb172-109"><a href="#cb172-109" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;features&quot;</span>: metadata[<span class="st">&#39;features&#39;</span>]</span>
<span id="cb172-110"><a href="#cb172-110" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb172-111"><a href="#cb172-111" aria-hidden="true" tabindex="-1"></a>            timestamp<span class="op">=</span>datetime.now().isoformat()</span>
<span id="cb172-112"><a href="#cb172-112" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb172-113"><a href="#cb172-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb172-114"><a href="#cb172-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb172-115"><a href="#cb172-115" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Prediction error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb172-116"><a href="#cb172-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">500</span>, detail<span class="op">=</span><span class="bu">str</span>(e))</span>
<span id="cb172-117"><a href="#cb172-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-118"><a href="#cb172-118" aria-hidden="true" tabindex="-1"></a><span class="at">@app.get</span>(<span class="st">&quot;/models&quot;</span>)</span>
<span id="cb172-119"><a href="#cb172-119" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> list_models():</span>
<span id="cb172-120"><a href="#cb172-120" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb172-121"><a href="#cb172-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb172-122"><a href="#cb172-122" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;models&quot;</span>: <span class="bu">list</span>(models.keys()),</span>
<span id="cb172-123"><a href="#cb172-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;metadata&quot;</span>: model_metadata</span>
<span id="cb172-124"><a href="#cb172-124" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-125"><a href="#cb172-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-126"><a href="#cb172-126" aria-hidden="true" tabindex="-1"></a><span class="at">@app.get</span>(<span class="st">&quot;/models/</span><span class="sc">{model_name}</span><span class="st">&quot;</span>)</span>
<span id="cb172-127"><a href="#cb172-127" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> get_model_info(model_name: <span class="bu">str</span>):</span>
<span id="cb172-128"><a href="#cb172-128" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb172-129"><a href="#cb172-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model_name <span class="kw">not</span> <span class="kw">in</span> models:</span>
<span id="cb172-130"><a href="#cb172-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> HTTPException(status_code<span class="op">=</span><span class="dv">404</span>, detail<span class="op">=</span><span class="ss">f&quot;Model </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> not found&quot;</span>)</span>
<span id="cb172-131"><a href="#cb172-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-132"><a href="#cb172-132" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> models[model_name]</span>
<span id="cb172-133"><a href="#cb172-133" aria-hidden="true" tabindex="-1"></a>    metadata <span class="op">=</span> model_metadata[model_name]</span>
<span id="cb172-134"><a href="#cb172-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb172-135"><a href="#cb172-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb172-136"><a href="#cb172-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_name&quot;</span>: model_name,</span>
<span id="cb172-137"><a href="#cb172-137" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_type&quot;</span>: metadata[<span class="st">&#39;model_type&#39;</span>],</span>
<span id="cb172-138"><a href="#cb172-138" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;target&quot;</span>: metadata[<span class="st">&#39;target&#39;</span>],</span>
<span id="cb172-139"><a href="#cb172-139" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;features&quot;</span>: metadata[<span class="st">&#39;features&#39;</span>],</span>
<span id="cb172-140"><a href="#cb172-140" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;performance&quot;</span>: model.evaluate(pd.DataFrame([{f: <span class="dv">0</span> <span class="cf">for</span> f <span class="kw">in</span> metadata[<span class="st">&#39;features&#39;</span>]}]))</span>
<span id="cb172-141"><a href="#cb172-141" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb172-142"><a href="#cb172-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-143"><a href="#cb172-143" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb172-144"><a href="#cb172-144" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> uvicorn</span>
<span id="cb172-145"><a href="#cb172-145" aria-hidden="true" tabindex="-1"></a>    uvicorn.run(app, host<span class="op">=</span><span class="st">&quot;0.0.0.0&quot;</span>, port<span class="op">=</span><span class="dv">8000</span>)</span></code></pre></div>
<h3 data-number="10.6.2" id="–∫–ª–∏–µ–Ω—Ç-–¥–ª—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">10.6.2</span> –ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="sourceCode" id="cb173"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_production_api():</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω API&quot;&quot;&quot;</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    base_url <span class="op">=</span> <span class="st">&quot;http://localhost:8000&quot;</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health check</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(<span class="ss">f&quot;</span><span class="sc">{</span>base_url<span class="sc">}</span><span class="ss">/health&quot;</span>)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Health check:&quot;</span>, response.json())</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(<span class="ss">f&quot;</span><span class="sc">{</span>base_url<span class="sc">}</span><span class="ss">/models&quot;</span>)</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Available models:&quot;</span>, response.json())</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>    bank_data <span class="op">=</span> {</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_name&quot;</span>: <span class="st">&quot;bank_default&quot;</span>,</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;data&quot;</span>: [</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;age&quot;</span>: <span class="dv">35</span>,</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;income&quot;</span>: <span class="dv">50000</span>,</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;credit_score&quot;</span>: <span class="dv">750</span>,</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;debt_ratio&quot;</span>: <span class="fl">0.3</span>,</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;employment_years&quot;</span>: <span class="dv">5</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.post(<span class="ss">f&quot;</span><span class="sc">{</span>base_url<span class="sc">}</span><span class="ss">/predict&quot;</span>, json<span class="op">=</span>bank_data)</span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Bank prediction:&quot;</span>, response.json())</span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a>    real_estate_data <span class="op">=</span> {</span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;model_name&quot;</span>: <span class="st">&quot;real_estate&quot;</span>,</span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;data&quot;</span>: [</span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;area&quot;</span>: <span class="dv">120</span>,</span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;bedrooms&quot;</span>: <span class="dv">3</span>,</span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;bathrooms&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;age&quot;</span>: <span class="dv">10</span>,</span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;location&quot;</span>: <span class="st">&quot;downtown&quot;</span></span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.post(<span class="ss">f&quot;</span><span class="sc">{</span>base_url<span class="sc">}</span><span class="ss">/predict&quot;</span>, json<span class="op">=</span>real_estate_data)</span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Real estate prediction:&quot;</span>, response.json())</span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤</span></span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a>    test_production_api()</span></code></pre></div>
<h2 data-number="10.7" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-8"><span
class="header-section-number">10.7</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./10_troubleshooting.md">Troubleshooting</a> - <a
href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a></p>
<hr />
<h1 data-number="11" id="troubleshooting-automl-gluon"><span
class="header-section-number">11</span> Troubleshooting AutoML
Gluon</h1>
<h2 data-number="11.0" id="–ø–æ—á–µ–º—É-troubleshooting-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">11.0</span> –ü–æ—á–µ–º—É troubleshooting —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É troubleshooting –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="11.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-troubleshooting"><span class="header-section-number">11.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ troubleshooting</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å troubleshooting?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="11.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-troubleshooting"><span class="header-section-number">11.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ troubleshooting</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ troubleshooting?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="11.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-troubleshooting"><span
class="header-section-number">11.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤
troubleshooting</h2>
<p><img src="images/troubleshooting_flowchart.png"
alt="Troubleshooting –±–ª–æ–∫-—Å—Ö–µ–º–∞" /> <em>–†–∏—Å—É–Ω–æ–∫ 8: –ë–ª–æ–∫-—Å—Ö–µ–º–∞ —Ä–µ—à–µ–Ω–∏—è
–ø—Ä–æ–±–ª–µ–º AutoML Gluon</em></p>
<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å
AutoML Gluon, –∏ —Å–ø–æ—Å–æ–±—ã –∏—Ö —Ä–µ—à–µ–Ω–∏—è. –ö–∞–∂–¥–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ,
–ø—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏ –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é.</p>
<h2 data-number="11.2" id="–ø—Ä–æ–±–ª–µ–º—ã-—É—Å—Ç–∞–Ω–æ–≤–∫–∏"><span
class="header-section-number">11.2</span> –ü—Ä–æ–±–ª–µ–º—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h2>
<h3 data-number="11.2.1" id="–æ—à–∏–±–∫–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"><span
class="header-section-number">11.2.1</span> 1. –û—à–∏–±–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h3>
<h4 data-number="11.2.1.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–∫–æ–Ω—Ñ–ª–∏–∫—Ç-–≤–µ—Ä—Å–∏–π-–ø–∞–∫–µ—Ç–æ–≤"><span
class="header-section-number">11.2.1.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π
–ø–∞–∫–µ—Ç–æ–≤</h4>
<div class="sourceCode" id="cb174"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ERROR:</span> pip<span class="st">&#39;s dependency resolver does not currently take into account all the packages that are installed.</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="st">This behaviour is the source of the following dependency conflicts.</span></span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb175"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> autogluon python=3.9</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate autogluon</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--upgrade</span> pip</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≤–µ—Ä—Å–∏–π</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon==0.8.2</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torch==1.13.1</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torchvision==0.14.1</span></code></pre></div>
<h4 data-number="11.2.1.2" id="–ø—Ä–æ–±–ª–µ–º–∞-–æ—à–∏–±–∫–∏-cuda"><span
class="header-section-number">11.2.1.2</span> –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ CUDA</h4>
<div class="sourceCode" id="cb176"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="ex">RuntimeError:</span> CUDA out of memory</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb177"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CUDA</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;CUDA available: </span><span class="sc">{</span>torch<span class="sc">.</span>cuda<span class="sc">.</span>is_available()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;CUDA version: </span><span class="sc">{</span>torch<span class="sc">.</span>version<span class="sc">.</span>cuda<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ PyTorch</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>pip install torch<span class="op">==</span><span class="fl">1.13.1</span><span class="op">+</span>cu117 torchvision<span class="op">==</span><span class="fl">0.14.1</span><span class="op">+</span>cu117 <span class="op">--</span>extra<span class="op">-</span>index<span class="op">-</span>url https:<span class="op">//</span>download.pytorch.org<span class="op">/</span>whl<span class="op">/</span>cu117</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;CUDA_VISIBLE_DEVICES&#39;</span>] <span class="op">=</span> <span class="st">&#39;&#39;</span></span></code></pre></div>
<h3 data-number="11.2.2" id="–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø–∞–º—è—Ç—å—é-1"><span
class="header-section-number">11.2.2</span> 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</h3>
<h4 data-number="11.2.2.1" id="–ø—Ä–æ–±–ª–µ–º–∞-out-of-memory"><span
class="header-section-number">11.2.2.1</span> –ü—Ä–æ–±–ª–µ–º–∞: Out of
memory</h4>
<div class="sourceCode" id="cb178"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="ex">MemoryError:</span> Unable to allocate array</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>ag.set_config({<span class="st">&#39;memory_limit&#39;</span>: <span class="dv">4</span>})  <span class="co"># 4GB</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;AUTOGLUON_MEMORY_LIMIT&#39;</span>] <span class="op">=</span> <span class="st">&#39;4&#39;</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.sample(frac<span class="op">=</span><span class="fl">0.5</span>)  <span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 50% –¥–∞–Ω–Ω—ã—Ö</span></span></code></pre></div>
<h2 data-number="11.3" id="–ø—Ä–æ–±–ª–µ–º—ã-–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">11.3</span> –ü—Ä–æ–±–ª–µ–º—ã –æ–±—É—á–µ–Ω–∏—è</h2>
<h3 data-number="11.3.1" id="–º–µ–¥–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">11.3.1</span> 1. –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<h4 data-number="11.3.1.1"
id="–ø—Ä–æ–±–ª–µ–º–∞-–æ–±—É—á–µ–Ω–∏–µ-–∑–∞–Ω–∏–º–∞–µ—Ç-—Å–ª–∏—à–∫–æ–º-–º–Ω–æ–≥–æ-–≤—Ä–µ–º–µ–Ω–∏"><span
class="header-section-number">11.3.1.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –û–±—É—á–µ–Ω–∏–µ
–∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</h4>
<div class="sourceCode" id="cb180"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">300</span>)  <span class="co"># 5 –º–∏–Ω—É—Ç –¥–ª—è —Ç–µ—Å—Ç–∞</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Training time: </span><span class="sc">{</span>time<span class="sc">.</span>time() <span class="op">-</span> start_time<span class="sc">:.2f}</span><span class="ss"> seconds&quot;</span>)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    presets<span class="op">=</span><span class="st">&#39;optimize_for_deployment&#39;</span>,  <span class="co"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>    time_limit<span class="op">=</span><span class="dv">600</span>,  <span class="co"># 10 –º–∏–Ω—É—Ç</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">3</span>,  <span class="co"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    ag_args_fit<span class="op">=</span>{</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_cpus&#39;</span>: <span class="dv">2</span>,  <span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ CPU</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">4</span>  <span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="11.3.2" id="–ø–ª–æ—Ö–æ–µ-–∫–∞—á–µ—Å—Ç–≤–æ-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">11.3.2</span> 2. –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
–º–æ–¥–µ–ª–∏</h3>
<h4 data-number="11.3.2.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–Ω–∏–∑–∫–∞—è-—Ç–æ—á–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">11.3.2.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</h4>
<div class="sourceCode" id="cb182"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_data_quality(data):</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Data shape:&quot;</span>, data.shape)</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Missing values:&quot;</span>, data.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>())</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Data types:&quot;</span>, data.dtypes.value_counts())</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;target&#39;</span> <span class="kw">in</span> data.columns:</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Target distribution:&quot;</span>)</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(data[<span class="st">&#39;target&#39;</span>].value_counts())</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>        target_counts <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>].value_counts()</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>        imbalance_ratio <span class="op">=</span> target_counts.<span class="bu">max</span>() <span class="op">/</span> target_counts.<span class="bu">min</span>()</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Imbalance ratio: </span><span class="sc">{</span>imbalance_ratio<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> imbalance_ratio <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;WARNING: Severe class imbalance detected&quot;</span>)</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>diagnose_data_quality(train_data)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb183"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> improve_data_quality(data):</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.fillna(data.median())</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>    numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> col <span class="op">!=</span> <span class="st">&#39;target&#39;</span>:</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>            Q1 <span class="op">=</span> data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>            Q3 <span class="op">=</span> data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>            IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&lt;</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, data[col])</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> np.where(data[col] <span class="op">&gt;</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR, data[col])</span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;feature1&#39;</span> <span class="kw">in</span> data.columns <span class="kw">and</span> <span class="st">&#39;feature2&#39;</span> <span class="kw">in</span> data.columns:</span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;feature_interaction&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;feature1&#39;</span>] <span class="op">*</span> data[<span class="st">&#39;feature2&#39;</span>]</span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;feature_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;feature1&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;feature2&#39;</span>] <span class="op">+</span> <span class="fl">1e-8</span>)</span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a>train_data_improved <span class="op">=</span> improve_data_quality(train_data)</span></code></pre></div>
<h3 data-number="11.3.3" id="–æ—à–∏–±–∫–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">11.3.3</span> 3. –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<h4 data-number="11.3.3.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–æ—à–∏–±–∫–∏-–ø—Ä–∏-–≤–∞–ª–∏–¥–∞—Ü–∏–∏"><span
class="header-section-number">11.3.3.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏
–≤–∞–ª–∏–¥–∞—Ü–∏–∏</h4>
<div class="sourceCode" id="cb184"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_validation_issues(predictor, test_data):</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Test data shape:&quot;</span>, test_data.shape)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Test data columns:&quot;</span>, test_data.columns.tolist())</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Data types:&quot;</span>)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(test_data.dtypes)</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Missing values:&quot;</span>)</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(test_data.isnull().<span class="bu">sum</span>())</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Predictions shape:&quot;</span>, predictions.shape)</span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Validation error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb184-29"><a href="#cb184-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> diagnose_validation_issues(predictor, test_data):</span>
<span id="cb184-30"><a href="#cb184-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Validation issues detected&quot;</span>)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_validation_issues(test_data):</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> test_data.fillna(test_data.median())</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> test_data.columns:</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> test_data[col].dtype <span class="op">==</span> <span class="st">&#39;object&#39;</span>:</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —á–∏—Å–ª–æ–≤–æ–π —Ç–∏–ø</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>                test_data[col] <span class="op">=</span> pd.to_numeric(test_data[col])</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ï—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>    constant_columns <span class="op">=</span> test_data.columns[test_data.nunique() <span class="op">&lt;=</span> <span class="dv">1</span>]</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> test_data.drop(columns<span class="op">=</span>constant_columns)</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> test_data</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a>test_data_fixed <span class="op">=</span> fix_validation_issues(test_data)</span></code></pre></div>
<h2 data-number="11.4" id="–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="header-section-number">11.4</span> –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h2>
<h3 data-number="11.4.1" id="–æ—à–∏–±–∫–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"><span
class="header-section-number">11.4.1</span> 1. –û—à–∏–±–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h3>
<h4 data-number="11.4.1.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–æ—à–∏–±–∫–∏-–ø—Ä–∏-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏"><span
class="header-section-number">11.4.1.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏</h4>
<div class="sourceCode" id="cb186"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_prediction_issues(predictor, data):</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Input data shape:&quot;</span>, data.shape)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Input data types:&quot;</span>, data.dtypes)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –º–æ–¥–µ–ª—å—é</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>        model_features <span class="op">=</span> predictor.feature_importance().index.tolist()</span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>        data_features <span class="op">=</span> data.columns.tolist()</span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>        missing_features <span class="op">=</span> <span class="bu">set</span>(model_features) <span class="op">-</span> <span class="bu">set</span>(data_features)</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>        extra_features <span class="op">=</span> <span class="bu">set</span>(data_features) <span class="op">-</span> <span class="bu">set</span>(model_features)</span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing_features:</span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Missing features: </span><span class="sc">{</span>missing_features<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> extra_features:</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Extra features: </span><span class="sc">{</span>extra_features<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(data)</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Predictions successful&quot;</span>)</span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Prediction error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> diagnose_prediction_issues(predictor, new_data):</span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Prediction issues detected&quot;</span>)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb187"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_prediction_issues(predictor, data):</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>    expected_features <span class="op">=</span> predictor.feature_importance().index.tolist()</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature <span class="kw">in</span> expected_features:</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> feature <span class="kw">not</span> <span class="kw">in</span> data.columns:</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>            data[feature] <span class="op">=</span> <span class="dv">0</span>  <span class="co"># –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª—è–º–∏</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data[expected_features]</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.fillna(<span class="dv">0</span>)</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>new_data_fixed <span class="op">=</span> fix_prediction_issues(predictor, new_data)</span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(new_data_fixed)</span></code></pre></div>
<h3 data-number="11.4.2" id="–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="header-section-number">11.4.2</span> 2. –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<h4 data-number="11.4.2.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"><span
class="header-section-number">11.4.2.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ
—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h4>
<div class="sourceCode" id="cb188"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_prediction_stability(predictor, data, n_tests<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> []</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_tests):</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> predictor.predict(data)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>        predictions.append(pred)</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>    predictions_array <span class="op">=</span> np.array(predictions)</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>    consistency <span class="op">=</span> np.mean(predictions_array <span class="op">==</span> predictions_array[<span class="dv">0</span>])</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Prediction consistency: </span><span class="sc">{</span>consistency<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> consistency <span class="op">&lt;</span> <span class="fl">0.95</span>:</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;WARNING: Unstable predictions detected&quot;</span>)</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> consistency</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>consistency <span class="op">=</span> diagnose_prediction_stability(predictor, test_data)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb189"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stabilize_predictions(predictor, data, n_samples<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> []</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —à—É–º–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>        noisy_data <span class="op">=</span> data.copy()</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> noisy_data.columns:</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> noisy_data[col].dtype <span class="kw">in</span> [np.float64, np.int64]:</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>                noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.01</span>, <span class="bu">len</span>(noisy_data))</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>                noisy_data[col] <span class="op">+=</span> noise</span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>        pred <span class="op">=</span> predictor.predict(noisy_data)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>        predictions.append(pred)</span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> predictor.problem_type <span class="op">==</span> <span class="st">&#39;regression&#39;</span>:</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>        stable_predictions <span class="op">=</span> np.mean(predictions, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>        stable_predictions <span class="op">=</span> []</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(predictions[<span class="dv">0</span>])):</span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>            votes <span class="op">=</span> [pred[i] <span class="cf">for</span> pred <span class="kw">in</span> predictions]</span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>            stable_predictions.append(<span class="bu">max</span>(<span class="bu">set</span>(votes), key<span class="op">=</span>votes.count))</span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stable_predictions</span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>stable_predictions <span class="op">=</span> stabilize_predictions(predictor, test_data)</span></code></pre></div>
<h2 data-number="11.5" id="–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">11.5</span> –ü—Ä–æ–±–ª–µ–º—ã
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 data-number="11.5.1" id="–º–µ–¥–ª–µ–Ω–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="header-section-number">11.5.1</span> 1. –ú–µ–¥–ª–µ–Ω–Ω—ã–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<h4 data-number="11.5.1.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–º–µ–¥–ª–µ–Ω–Ω—ã–µ-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"><span
class="header-section-number">11.5.1.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h4>
<div class="sourceCode" id="cb190"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_prediction_performance(predictor, data):</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä–∫–µ</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    small_data <span class="op">=</span> data.head(<span class="dv">100</span>)</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> time.time()</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(small_data)</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>    prediction_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Prediction time for 100 samples: </span><span class="sc">{</span>prediction_time<span class="sc">:.4f}</span><span class="ss"> seconds&quot;</span>)</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Prediction time per sample: </span><span class="sc">{</span>prediction_time<span class="op">/</span><span class="dv">100</span><span class="sc">:.6f}</span><span class="ss"> seconds&quot;</span>)</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>    estimated_time <span class="op">=</span> prediction_time <span class="op">*</span> <span class="bu">len</span>(data) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Estimated time for full dataset: </span><span class="sc">{</span>estimated_time<span class="sc">:.2f}</span><span class="ss"> seconds&quot;</span>)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prediction_time</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>prediction_time <span class="op">=</span> diagnose_prediction_performance(predictor, test_data)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_prediction_performance(predictor, data):</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> []</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data), batch_size):</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>        batch <span class="op">=</span> data.iloc[i:i<span class="op">+</span>batch_size]</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>        batch_predictions <span class="op">=</span> predictor.predict(batch)</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>        predictions.extend(batch_predictions)</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictions</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_fast_model(predictor, data):</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>    fast_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>predictor.label,</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span>predictor.problem_type,</span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span>predictor.eval_metric,</span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./fast_models&#39;</span></span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –±—ã—Å—Ç—Ä—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö</span></span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>    fast_predictor.fit(</span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>        data,</span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>        hyperparameters<span class="op">=</span>{</span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;GBM&#39;</span>: [{<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">50</span>}],</span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;RF&#39;</span>: [{<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">50</span>}]</span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">300</span></span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fast_predictor</span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a>fast_predictor <span class="op">=</span> create_fast_model(predictor, train_data)</span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>fast_predictions <span class="op">=</span> fast_predictor.predict(test_data)</span></code></pre></div>
<h3 data-number="11.5.2" id="–≤—ã—Å–æ–∫–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–∞–º—è—Ç–∏"><span
class="header-section-number">11.5.2</span> 2. –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ø–∞–º—è—Ç–∏</h3>
<h4 data-number="11.5.2.1"
id="–ø—Ä–æ–±–ª–µ–º–∞-–≤—ã—Å–æ–∫–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–ø–∞–º—è—Ç–∏"><span
class="header-section-number">11.5.2.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–æ–µ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏</h4>
<div class="sourceCode" id="cb192"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–∞–º—è—Ç–∏</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psutil</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_memory_usage():</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>    process <span class="op">=</span> psutil.Process()</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>    memory_info <span class="op">=</span> process.memory_info()</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Memory usage: </span><span class="sc">{</span>memory_info<span class="sc">.</span>rss <span class="op">/</span> <span class="dv">1024</span> <span class="op">/</span> <span class="dv">1024</span><span class="sc">:.2f}</span><span class="ss"> MB&quot;</span>)</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Memory percent: </span><span class="sc">{</span>process<span class="sc">.</span>memory_percent()<span class="sc">:.2f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> memory_info.rss <span class="op">/</span> <span class="dv">1024</span> <span class="op">/</span> <span class="dv">1024</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>memory_usage <span class="op">=</span> diagnose_memory_usage()</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb193"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_memory_usage(predictor, data):</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —á–∞—Å—Ç—è–º</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>    chunk_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> []</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data), chunk_size):</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>        chunk <span class="op">=</span> data.iloc[i:i<span class="op">+</span>chunk_size]</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>        chunk_predictions <span class="op">=</span> predictor.predict(chunk)</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>        predictions.extend(chunk_predictions)</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> chunk</span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictions</span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb193-21"><a href="#cb193-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_data_types(data):</span>
<span id="cb193-22"><a href="#cb193-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb193-23"><a href="#cb193-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-24"><a href="#cb193-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> data.columns:</span>
<span id="cb193-25"><a href="#cb193-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data[col].dtype <span class="op">==</span> <span class="st">&#39;float64&#39;</span>:</span>
<span id="cb193-26"><a href="#cb193-26" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;float32&#39;</span>)</span>
<span id="cb193-27"><a href="#cb193-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data[col].dtype <span class="op">==</span> <span class="st">&#39;int64&#39;</span>:</span>
<span id="cb193-28"><a href="#cb193-28" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;int32&#39;</span>)</span>
<span id="cb193-29"><a href="#cb193-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-30"><a href="#cb193-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb193-31"><a href="#cb193-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-32"><a href="#cb193-32" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb193-33"><a href="#cb193-33" aria-hidden="true" tabindex="-1"></a>data_optimized <span class="op">=</span> optimize_data_types(data)</span></code></pre></div>
<h2 data-number="11.6" id="–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">11.6</span> –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 data-number="11.6.1" id="–æ—à–∏–±–∫–∏-–∑–∞–≥—Ä—É–∑–∫–∏-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">11.6.1</span> 1. –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
–º–æ–¥–µ–ª–∏</h3>
<h4 data-number="11.6.1.1"
id="–ø—Ä–æ–±–ª–µ–º–∞-–æ—à–∏–±–∫–∏-–ø—Ä–∏-–∑–∞–≥—Ä—É–∑–∫–µ-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">11.6.1.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏
–∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏</h4>
<div class="sourceCode" id="cb194"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_model_loading(model_path):</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> os</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.exists(model_path):</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Model path does not exist: </span><span class="sc">{</span>model_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>        required_files <span class="op">=</span> [<span class="st">&#39;predictor.pkl&#39;</span>, <span class="st">&#39;metadata.json&#39;</span>]</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> required_files:</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>            file_path <span class="op">=</span> os.path.join(model_path, <span class="bu">file</span>)</span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(file_path):</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;Required file missing: </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</span></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor.load(model_path)</span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Model loaded successfully&quot;</span>)</span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Model loading error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> diagnose_model_loading(<span class="st">&#39;./models&#39;</span>):</span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Model loading issues detected&quot;</span>)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb195"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_model_loading_issues(model_path):</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ AutoGluon</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;AutoGluon version: </span><span class="sc">{</span>ag<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor.load(</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>            model_path,</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>            require_version_match<span class="op">=</span><span class="va">False</span>  <span class="co"># –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π</span></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Failed to load model: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Attempting to recreate model...&quot;</span>)</span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-26"><a href="#cb195-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb195-27"><a href="#cb195-27" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> fix_model_loading_issues(<span class="st">&#39;./models&#39;</span>)</span></code></pre></div>
<h3 data-number="11.6.2" id="–æ—à–∏–±–∫–∏-api"><span
class="header-section-number">11.6.2</span> 2. –û—à–∏–±–∫–∏ API</h3>
<h4 data-number="11.6.2.1" id="–ø—Ä–æ–±–ª–µ–º–∞-–æ—à–∏–±–∫–∏-–≤-api"><span
class="header-section-number">11.6.2.1</span> –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –≤
API</h4>
<div class="sourceCode" id="cb196"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ API</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diagnose_api_issues(api_url, test_data):</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º API&quot;&quot;&quot;</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Health check</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(<span class="ss">f&quot;</span><span class="sc">{</span>api_url<span class="sc">}</span><span class="ss">/health&quot;</span>)</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Health check failed: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.post(<span class="ss">f&quot;</span><span class="sc">{</span>api_url<span class="sc">}</span><span class="ss">/predict&quot;</span>, json<span class="op">=</span>test_data)</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Prediction failed: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error: </span><span class="sc">{</span>response<span class="sc">.</span>text<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;API working correctly&quot;</span>)</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;API error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> diagnose_api_issues(<span class="st">&quot;http://localhost:8000&quot;</span>, test_data):</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API issues detected&quot;</span>)</span></code></pre></div>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º API</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_api_issues(api_url, test_data):</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º API&quot;&quot;&quot;</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(<span class="ss">f&quot;</span><span class="sc">{</span>api_url<span class="sc">}</span><span class="ss">/health&quot;</span>, timeout<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>            health_data <span class="op">=</span> response.json()</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;API status: </span><span class="sc">{</span>health_data[<span class="st">&#39;status&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;loaded_models&#39;</span> <span class="kw">in</span> health_data:</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;Loaded models: </span><span class="sc">{</span>health_data[<span class="st">&#39;loaded_models&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;API not healthy: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> requests.exceptions.Timeout:</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;API timeout - server may be overloaded&quot;</span>)</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> requests.exceptions.<span class="pp">ConnectionError</span>:</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;API connection error - server may be down&quot;</span>)</span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;API error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> fix_api_issues(<span class="st">&quot;http://localhost:8000&quot;</span>, test_data):</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API issues resolved&quot;</span>)</span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;API issues persist&quot;</span>)</span></code></pre></div>
<h2 data-number="11.7" id="–ø–æ–ª–µ–∑–Ω—ã–µ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏"><span
class="header-section-number">11.7</span> –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</h2>
<h3 data-number="11.7.1" id="—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-2"><span
class="header-section-number">11.7.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="sourceCode" id="cb198"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AutoGluonMonitor:</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ AutoGluon —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> {}</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alerts <span class="op">=</span> []</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_system_health(<span class="va">self</span>):</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>        memory <span class="op">=</span> psutil.virtual_memory()</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> memory.percent <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alerts.append(<span class="st">&quot;High memory usage&quot;</span>)</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>        cpu <span class="op">=</span> psutil.cpu_percent()</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cpu <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alerts.append(<span class="st">&quot;High CPU usage&quot;</span>)</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞</span></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>        disk <span class="op">=</span> psutil.disk_usage(<span class="st">&#39;/&#39;</span>)</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> disk.percent <span class="op">&gt;</span> <span class="dv">90</span>:</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alerts.append(<span class="st">&quot;High disk usage&quot;</span>)</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.alerts) <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_model_performance(<span class="va">self</span>, predictor, test_data):</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>            start_time <span class="op">=</span> time.time()</span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>            predictions <span class="op">=</span> predictor.predict(test_data.head(<span class="dv">100</span>))</span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a>            prediction_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏</span></span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prediction_time <span class="op">&gt;</span> <span class="dv">10</span>:  <span class="co"># 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è 100 –æ–±—Ä–∞–∑—Ü–æ–≤</span></span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.alerts.append(<span class="st">&quot;Slow prediction performance&quot;</span>)</span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb198-41"><a href="#cb198-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb198-42"><a href="#cb198-42" aria-hidden="true" tabindex="-1"></a>            performance <span class="op">=</span> predictor.evaluate(test_data.head(<span class="dv">100</span>))</span>
<span id="cb198-43"><a href="#cb198-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> performance.get(<span class="st">&#39;accuracy&#39;</span>, <span class="dv">0</span>) <span class="op">&lt;</span> <span class="fl">0.8</span>:</span>
<span id="cb198-44"><a href="#cb198-44" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.alerts.append(<span class="st">&quot;Low model accuracy&quot;</span>)</span>
<span id="cb198-45"><a href="#cb198-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb198-46"><a href="#cb198-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb198-47"><a href="#cb198-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb198-48"><a href="#cb198-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb198-49"><a href="#cb198-49" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alerts.append(<span class="ss">f&quot;Model performance error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb198-50"><a href="#cb198-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb198-51"><a href="#cb198-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-52"><a href="#cb198-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_report(<span class="va">self</span>):</span>
<span id="cb198-53"><a href="#cb198-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb198-54"><a href="#cb198-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-55"><a href="#cb198-55" aria-hidden="true" tabindex="-1"></a>        report <span class="op">=</span> {</span>
<span id="cb198-56"><a href="#cb198-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb198-57"><a href="#cb198-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;system_health&#39;</span>: <span class="va">self</span>.check_system_health(),</span>
<span id="cb198-58"><a href="#cb198-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;alerts&#39;</span>: <span class="va">self</span>.alerts,</span>
<span id="cb198-59"><a href="#cb198-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metrics&#39;</span>: <span class="va">self</span>.metrics</span>
<span id="cb198-60"><a href="#cb198-60" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb198-61"><a href="#cb198-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-62"><a href="#cb198-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> report</span>
<span id="cb198-63"><a href="#cb198-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-64"><a href="#cb198-64" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb198-65"><a href="#cb198-65" aria-hidden="true" tabindex="-1"></a>monitor <span class="op">=</span> AutoGluonMonitor()</span>
<span id="cb198-66"><a href="#cb198-66" aria-hidden="true" tabindex="-1"></a>report <span class="op">=</span> monitor.generate_report()</span>
<span id="cb198-67"><a href="#cb198-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Monitoring report:&quot;</span>, report)</span></code></pre></div>
<h3 data-number="11.7.2" id="—Å–∏—Å—Ç–µ–º–∞-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è-1"><span
class="header-section-number">11.7.2</span> 2. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="sourceCode" id="cb199"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AutoGluonLogger:</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è AutoGluon&quot;&quot;&quot;</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, log_file<span class="op">=</span><span class="st">&#39;autogluon.log&#39;</span>):</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_file <span class="op">=</span> log_file</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_logging()</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_logging(<span class="va">self</span>):</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>logging.INFO,</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(name)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>,</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>            handlers<span class="op">=</span>[</span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>                logging.FileHandler(<span class="va">self</span>.log_file),</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>                logging.StreamHandler()</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_training_start(<span class="va">self</span>, data_info):</span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Training started: </span><span class="sc">{</span>data_info<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_training_complete(<span class="va">self</span>, results):</span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Training completed: </span><span class="sc">{</span>results<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-33"><a href="#cb199-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_prediction(<span class="va">self</span>, input_data, prediction, processing_time):</span>
<span id="cb199-34"><a href="#cb199-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb199-35"><a href="#cb199-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;Prediction: input=</span><span class="sc">{</span>input_data<span class="sc">}</span><span class="ss">, prediction=</span><span class="sc">{</span>prediction<span class="sc">}</span><span class="ss">, time=</span><span class="sc">{</span>processing_time<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb199-36"><a href="#cb199-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-37"><a href="#cb199-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> log_error(<span class="va">self</span>, error, context):</span>
<span id="cb199-38"><a href="#cb199-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span></span>
<span id="cb199-39"><a href="#cb199-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.error(<span class="ss">f&quot;Error: </span><span class="sc">{</span>error<span class="sc">}</span><span class="ss">, context: </span><span class="sc">{</span>context<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb199-40"><a href="#cb199-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-41"><a href="#cb199-41" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb199-42"><a href="#cb199-42" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> AutoGluonLogger()</span>
<span id="cb199-43"><a href="#cb199-43" aria-hidden="true" tabindex="-1"></a>logger.log_training_start({<span class="st">&#39;data_size&#39;</span>: <span class="bu">len</span>(train_data)})</span></code></pre></div>
<h2 data-number="11.8" id="—Å–ª–µ–¥—É—é—â–∏–µ-—à–∞–≥–∏-9"><span
class="header-section-number">11.8</span> –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫: - <a
href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a> - <a
href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></p>
<hr />
<h1 data-number="12"
id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-automl-gluon-–¥–ª—è-apple-silicon-m1m2m3"><span
class="header-section-number">12</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è
Apple Silicon (M1/M2/M3)</h1>
<h2 data-number="12.0" id="–ø–æ—á–µ–º—É-apple-silicon-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">12.0</span> –ü–æ—á–µ–º—É apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="12.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-apple-silicon-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"><span class="header-section-number">12.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="12.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-apple-silicon-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"><span class="header-section-number">12.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ apple silicon –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="12.1"
id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è
Apple Silicon</h2>
<p><img src="images/apple_silicon_optimization.png"
alt="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon" /> <em>–†–∏—Å—É–Ω–æ–∫ 9: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML
Gluon –¥–ª—è Apple Silicon</em></p>
<p>Apple Silicon MacBook —Å —á–∏–ø–∞–º–∏ M1, M2, M3 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑: -
<strong>MLX</strong> - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Apple
Silicon - <strong>Ray</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
Apple Silicon - <strong>OpenMP</strong> - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è -
<strong>Metal Performance Shaders (MPS)</strong> - GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ</p>
<h2 data-number="12.2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.2</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple
Silicon</h2>
<h3 data-number="12.2.1" id="–±–∞–∑–æ–≤–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π"><span
class="header-section-number">12.2.1</span> 1. –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</h3>
<div class="sourceCode" id="cb200"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ conda –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> autogluon-m1 python=3.9</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate autogluon-m1</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge numpy pandas scikit-learn matplotlib seaborn</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MPS (Metal Performance Shaders)</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install torch torchvision torchaudio</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install autogluon</span></code></pre></div>
<h3 data-number="12.2.2" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-mlx-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.2.2</span> 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX –¥–ª—è Apple
Silicon</h3>
<div class="sourceCode" id="cb201"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mlx mlx-lm</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö MLX –ø–∞–∫–µ—Ç–æ–≤</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mlx-optimizers mlx-nn</span></code></pre></div>
<h3 data-number="12.2.3" id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-ray-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.2.3</span> 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray –¥–ª—è Apple
Silicon</h3>
<div class="sourceCode" id="cb202"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install ray<span class="pp">[</span><span class="ss">default</span><span class="pp">]</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Apple Silicon</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-c</span> <span class="st">&quot;import ray; print(ray.__version__)&quot;</span></span></code></pre></div>
<h3 data-number="12.2.4" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp"><span
class="header-section-number">12.2.4</span> 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</h3>
<div class="sourceCode" id="cb203"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenMP –¥–ª—è macOS</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install libomp</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –±–∏–Ω–¥–∏–Ω–≥–æ–≤</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install openmp-python</span></code></pre></div>
<h2 data-number="12.3" id="–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.3</span> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple
Silicon</h2>
<h3 data-number="12.3.1" id="–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ-cuda-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-mps"><span
class="header-section-number">12.3.1</span> 1. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA –∏
–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MPS</h3>
<div class="sourceCode" id="cb204"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;CUDA_VISIBLE_DEVICES&#39;</span>] <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;CUDA_DEVICE_ORDER&#39;</span>] <span class="op">=</span> <span class="st">&#39;PCI_BUS_ID&#39;</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∫–ª—é—á–µ–Ω–∏–µ MPS (Metal Performance Shaders) –¥–ª—è Apple Silicon</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> torch.backends.mps.is_available():</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;PYTORCH_ENABLE_MPS_FALLBACK&#39;</span>] <span class="op">=</span> <span class="st">&#39;1&#39;</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;MPS (Metal Performance Shaders) –¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span>)</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span>)</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a><span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon</span></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;OMP_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(torch.get_num_threads())</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;MKL_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(torch.get_num_threads())</span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;OPENBLAS_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(torch.get_num_threads())</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span></span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;PyTorch version: </span><span class="sc">{</span>torch<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MPS available: </span><span class="sc">{</span>torch<span class="sc">.</span>backends<span class="sc">.</span>mps<span class="sc">.</span>is_available()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MPS built: </span><span class="sc">{</span>torch<span class="sc">.</span>backends<span class="sc">.</span>mps<span class="sc">.</span>is_built()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;CPU threads: </span><span class="sc">{</span>torch<span class="sc">.</span>get_num_threads()<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="12.3.2"
id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-autogluon-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.3.2</span> 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è
Apple Silicon</h3>
<div class="sourceCode" id="cb205"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> configure_apple_silicon():</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>    ag.set_config({</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_cpus&#39;</span>: torch.get_num_threads(),</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span>,  <span class="co"># GB</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è MPS</span></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> torch.backends.mps.is_available():</span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ&quot;</span>)</span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU&quot;</span>)</span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ag</span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span></span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a>configure_apple_silicon()</span></code></pre></div>
<h2 data-number="12.4" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-mlx"><span
class="header-section-number">12.4</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MLX</h2>
<h3 data-number="12.4.1"
id="—Å–æ–∑–¥–∞–Ω–∏–µ-mlx-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">12.4.1</span> 1. –°–æ–∑–¥–∞–Ω–∏–µ
MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</h3>
<div class="sourceCode" id="cb206"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlx.core <span class="im">as</span> mx</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlx.nn <span class="im">as</span> nn</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLXOptimizedPredictor:</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_path: <span class="bu">str</span>):</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_path <span class="op">=</span> model_path</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mlx_model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_names <span class="op">=</span> <span class="va">None</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_mlx_model(<span class="va">self</span>):</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –≤ MLX&quot;&quot;&quot;</span></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>            weights <span class="op">=</span> mx.load(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>model_path<span class="sc">}</span><span class="ss">/mlx_weights.npz&quot;</span>)</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏</span></span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.mlx_model <span class="op">=</span> <span class="va">self</span>.create_mlx_architecture(weights)</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;MLX –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ&quot;</span>)</span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ MLX –º–æ–¥–µ–ª–∏: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_mlx_architecture(<span class="va">self</span>, weights):</span>
<span id="cb206-31"><a href="#cb206-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã MLX –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb206-32"><a href="#cb206-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb206-33"><a href="#cb206-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">class</span> MLXTabularModel(nn.Module):</span>
<span id="cb206-34"><a href="#cb206-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, hidden_sizes, output_size):</span>
<span id="cb206-35"><a href="#cb206-35" aria-hidden="true" tabindex="-1"></a>                <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb206-36"><a href="#cb206-36" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.layers <span class="op">=</span> []</span>
<span id="cb206-37"><a href="#cb206-37" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb206-38"><a href="#cb206-38" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π</span></span>
<span id="cb206-39"><a href="#cb206-39" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.layers.append(nn.Linear(input_size, hidden_sizes[<span class="dv">0</span>]))</span>
<span id="cb206-40"><a href="#cb206-40" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb206-41"><a href="#cb206-41" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏</span></span>
<span id="cb206-42"><a href="#cb206-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(hidden_sizes) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb206-43"><a href="#cb206-43" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.layers.append(nn.Linear(hidden_sizes[i], hidden_sizes[i <span class="op">+</span> <span class="dv">1</span>]))</span>
<span id="cb206-44"><a href="#cb206-44" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.layers.append(nn.ReLU())</span>
<span id="cb206-45"><a href="#cb206-45" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb206-46"><a href="#cb206-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π</span></span>
<span id="cb206-47"><a href="#cb206-47" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.layers.append(nn.Linear(hidden_sizes[<span class="op">-</span><span class="dv">1</span>], output_size))</span>
<span id="cb206-48"><a href="#cb206-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb206-49"><a href="#cb206-49" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, x):</span>
<span id="cb206-50"><a href="#cb206-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> layer <span class="kw">in</span> <span class="va">self</span>.layers:</span>
<span id="cb206-51"><a href="#cb206-51" aria-hidden="true" tabindex="-1"></a>                    x <span class="op">=</span> layer(x)</span>
<span id="cb206-52"><a href="#cb206-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> x</span>
<span id="cb206-53"><a href="#cb206-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb206-54"><a href="#cb206-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> MLXTabularModel</span>
<span id="cb206-55"><a href="#cb206-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-56"><a href="#cb206-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict_mlx(<span class="va">self</span>, data: np.ndarray) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb206-57"><a href="#cb206-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MLX&quot;&quot;&quot;</span></span>
<span id="cb206-58"><a href="#cb206-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.mlx_model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb206-59"><a href="#cb206-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;MLX –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞&quot;</span>)</span>
<span id="cb206-60"><a href="#cb206-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb206-61"><a href="#cb206-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ MLX –º–∞—Å—Å–∏–≤</span></span>
<span id="cb206-62"><a href="#cb206-62" aria-hidden="true" tabindex="-1"></a>        mlx_data <span class="op">=</span> mx.array(data.astype(np.float32))</span>
<span id="cb206-63"><a href="#cb206-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb206-64"><a href="#cb206-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb206-65"><a href="#cb206-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> mx.<span class="bu">eval</span>():</span>
<span id="cb206-66"><a href="#cb206-66" aria-hidden="true" tabindex="-1"></a>            predictions <span class="op">=</span> <span class="va">self</span>.mlx_model(mlx_data)</span>
<span id="cb206-67"><a href="#cb206-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb206-68"><a href="#cb206-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.array(predictions)</span>
<span id="cb206-69"><a href="#cb206-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-70"><a href="#cb206-70" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb206-71"><a href="#cb206-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_mlx_predictor(model_path: <span class="bu">str</span>):</span>
<span id="cb206-72"><a href="#cb206-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb206-73"><a href="#cb206-73" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> MLXOptimizedPredictor(model_path)</span>
<span id="cb206-74"><a href="#cb206-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-75"><a href="#cb206-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> predictor.load_mlx_model():</span>
<span id="cb206-76"><a href="#cb206-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb206-77"><a href="#cb206-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb206-78"><a href="#cb206-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code></pre></div>
<h3 data-number="12.4.2" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-mlx"><span
class="header-section-number">12.4.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è
MLX</h3>
<div class="sourceCode" id="cb207"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_data_for_mlx(data: pd.DataFrame) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MLX&quot;&quot;&quot;</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ numpy —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>    data_array <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[np.number]).values.astype(np.float32)</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è MLX</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>    data_array <span class="op">=</span> (data_array <span class="op">-</span> data_array.mean(axis<span class="op">=</span><span class="dv">0</span>)) <span class="op">/</span> (data_array.std(axis<span class="op">=</span><span class="dv">0</span>) <span class="op">+</span> <span class="fl">1e-8</span>)</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data_array</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_with_mlx_optimization(train_data: pd.DataFrame):</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å MLX –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π&quot;&quot;&quot;</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>    optimized_data <span class="op">=</span> optimize_data_for_mlx(train_data)</span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./mlx_models&#39;</span></span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è Apple Silicon</span></span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>        train_data,</span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>        ag_args_fit<span class="op">=</span>{</span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_cpus&#39;</span>: torch.get_num_threads(),</span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb207-34"><a href="#cb207-34" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb207-35"><a href="#cb207-35" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">3600</span></span>
<span id="cb207-36"><a href="#cb207-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb207-37"><a href="#cb207-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-38"><a href="#cb207-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span></code></pre></div>
<h2 data-number="12.5" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ray-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.5</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple
Silicon</h2>
<h3 data-number="12.5.1" id="–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-ray-–∫–ª–∞—Å—Ç–µ—Ä–∞"><span
class="header-section-number">12.5.1</span> 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ray
–∫–ª–∞—Å—Ç–µ—Ä–∞</h3>
<div class="sourceCode" id="cb208"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ray</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ray <span class="im">import</span> tune</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autogluon <span class="im">as</span> ag</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> configure_ray_apple_silicon():</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Apple Silicon</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    ray.init(</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>        num_cpus<span class="op">=</span>torch.get_num_threads(),</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>        num_gpus<span class="op">=</span><span class="dv">0</span>,  <span class="co"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ GPU –¥–ª—è Apple Silicon</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>        object_store_memory<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>,  <span class="co"># 2GB</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>        ignore_reinit_error<span class="op">=</span><span class="va">True</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: </span><span class="sc">{</span>ray<span class="sc">.</span>is_initialized()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã: </span><span class="sc">{</span>ray<span class="sc">.</span>cluster_resources()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ray</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray</span></span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>ray_cluster <span class="op">=</span> configure_ray_apple_silicon()</span></code></pre></div>
<h3 data-number="12.5.2" id="—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ-—Å-ray"><span
class="header-section-number">12.5.2</span> 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å
Ray</h3>
<div class="sourceCode" id="cb209"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="at">@ray.remote</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_model_remote(data_chunk, model_config):</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–£–¥–∞–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>model_config[<span class="st">&#39;label&#39;</span>],</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span>model_config[<span class="st">&#39;problem_type&#39;</span>],</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span>model_config[<span class="st">&#39;eval_metric&#39;</span>]</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>        data_chunk,</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span>model_config[<span class="st">&#39;time_limit&#39;</span>],</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span>model_config[<span class="st">&#39;presets&#39;</span>]</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distributed_training_apple_silicon(data: pd.DataFrame, n_workers: <span class="bu">int</span> <span class="op">=</span> <span class="dv">4</span>):</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>    chunk_size <span class="op">=</span> <span class="bu">len</span>(data) <span class="op">//</span> n_workers</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>    data_chunks <span class="op">=</span> [data.iloc[i:i<span class="op">+</span>chunk_size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data), chunk_size)]</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>    model_config <span class="op">=</span> {</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;label&#39;</span>: <span class="st">&#39;target&#39;</span>,</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;problem_type&#39;</span>: <span class="st">&#39;auto&#39;</span>,</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;eval_metric&#39;</span>: <span class="st">&#39;auto&#39;</span>,</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;time_limit&#39;</span>: <span class="dv">1800</span>,</span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;medium_quality&#39;</span></span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–ø—É—Å–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</span></span>
<span id="cb209-40"><a href="#cb209-40" aria-hidden="true" tabindex="-1"></a>    futures <span class="op">=</span> []</span>
<span id="cb209-41"><a href="#cb209-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chunk <span class="kw">in</span> data_chunks:</span>
<span id="cb209-42"><a href="#cb209-42" aria-hidden="true" tabindex="-1"></a>        future <span class="op">=</span> train_model_remote.remote(chunk, model_config)</span>
<span id="cb209-43"><a href="#cb209-43" aria-hidden="true" tabindex="-1"></a>        futures.append(future)</span>
<span id="cb209-44"><a href="#cb209-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-45"><a href="#cb209-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è</span></span>
<span id="cb209-46"><a href="#cb209-46" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> ray.get(futures)</span>
<span id="cb209-47"><a href="#cb209-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-48"><a href="#cb209-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb209-49"><a href="#cb209-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-50"><a href="#cb209-50" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb209-51"><a href="#cb209-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_distributed_training(data: pd.DataFrame):</span>
<span id="cb209-52"><a href="#cb209-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb209-53"><a href="#cb209-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-54"><a href="#cb209-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray</span></span>
<span id="cb209-55"><a href="#cb209-55" aria-hidden="true" tabindex="-1"></a>    configure_ray_apple_silicon()</span>
<span id="cb209-56"><a href="#cb209-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-57"><a href="#cb209-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb209-58"><a href="#cb209-58" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> distributed_training_apple_silicon(data, n_workers<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb209-59"><a href="#cb209-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-60"><a href="#cb209-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–û–±—É—á–µ–Ω–æ </span><span class="sc">{</span><span class="bu">len</span>(models)<span class="sc">}</span><span class="ss"> –º–æ–¥–µ–ª–µ–π&quot;</span>)</span>
<span id="cb209-61"><a href="#cb209-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-62"><a href="#cb209-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> models</span></code></pre></div>
<h2 data-number="12.6" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-openmp"><span
class="header-section-number">12.6</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP</h2>
<h3 data-number="12.6.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-openmp-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.6.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è
Apple Silicon</h3>
<div class="sourceCode" id="cb210"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing <span class="im">as</span> mp</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> configure_openmp_apple_silicon():</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>    num_cores <span class="op">=</span> mp.cpu_count()</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–î–æ—Å—Ç—É–ø–Ω–æ —è–¥–µ—Ä: </span><span class="sc">{</span>num_cores<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</span></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;OMP_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(num_cores)</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;MKL_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(num_cores)</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;OPENBLAS_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(num_cores)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;VECLIB_MAXIMUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(num_cores)</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Apple Silicon</span></span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;OMP_SCHEDULE&#39;</span>] <span class="op">=</span> <span class="st">&#39;dynamic&#39;</span></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;OMP_DYNAMIC&#39;</span>] <span class="op">=</span> <span class="st">&#39;TRUE&#39;</span></span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a>    os.environ[<span class="st">&#39;OMP_NESTED&#39;</span>] <span class="op">=</span> <span class="st">&#39;TRUE&#39;</span></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Apple Silicon&quot;</span>)</span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_cores</span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫</span></span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a>num_cores <span class="op">=</span> configure_openmp_apple_silicon()</span></code></pre></div>
<h3 data-number="12.6.2" id="–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">12.6.2</span> 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
–¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb211"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor, ProcessPoolExecutor</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parallel_data_processing(data: pd.DataFrame, n_workers: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_workers <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>        n_workers <span class="op">=</span> mp.cpu_count()</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chunk(chunk):</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>        chunk <span class="op">=</span> chunk.fillna(chunk.median())</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(chunk.columns) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a>            chunk[<span class="st">&#39;feature_sum&#39;</span>] <span class="op">=</span> chunk.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>            chunk[<span class="st">&#39;feature_mean&#39;</span>] <span class="op">=</span> chunk.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> chunk</span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span></span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true" tabindex="-1"></a>    chunk_size <span class="op">=</span> <span class="bu">len</span>(data) <span class="op">//</span> n_workers</span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true" tabindex="-1"></a>    chunks <span class="op">=</span> [data.iloc[i:i<span class="op">+</span>chunk_size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data), chunk_size)]</span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span></span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span>n_workers) <span class="im">as</span> executor:</span>
<span id="cb211-28"><a href="#cb211-28" aria-hidden="true" tabindex="-1"></a>        processed_chunks <span class="op">=</span> <span class="bu">list</span>(executor.<span class="bu">map</span>(process_chunk, chunks))</span>
<span id="cb211-29"><a href="#cb211-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-30"><a href="#cb211-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb211-31"><a href="#cb211-31" aria-hidden="true" tabindex="-1"></a>    processed_data <span class="op">=</span> pd.concat(processed_chunks, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb211-32"><a href="#cb211-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-33"><a href="#cb211-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> processed_data</span>
<span id="cb211-34"><a href="#cb211-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-35"><a href="#cb211-35" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏</span></span>
<span id="cb211-36"><a href="#cb211-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_data_processing(data: pd.DataFrame):</span>
<span id="cb211-37"><a href="#cb211-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb211-38"><a href="#cb211-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-39"><a href="#cb211-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</span></span>
<span id="cb211-40"><a href="#cb211-40" aria-hidden="true" tabindex="-1"></a>    configure_openmp_apple_silicon()</span>
<span id="cb211-41"><a href="#cb211-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-42"><a href="#cb211-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span></span>
<span id="cb211-43"><a href="#cb211-43" aria-hidden="true" tabindex="-1"></a>    processed_data <span class="op">=</span> parallel_data_processing(data)</span>
<span id="cb211-44"><a href="#cb211-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-45"><a href="#cb211-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> processed_data</span></code></pre></div>
<h2 data-number="12.7" id="–ø–æ–ª–Ω–∞—è-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.7</span> –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple
Silicon</h2>
<h3 data-number="12.7.1" id="–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">12.7.1</span> 1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
—Å–∏—Å—Ç–µ–º—ã</h3>
<div class="sourceCode" id="cb212"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AppleSiliconOptimizer:</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_cores <span class="op">=</span> mp.cpu_count()</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mps_available <span class="op">=</span> torch.backends.mps.is_available()</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ray_initialized <span class="op">=</span> <span class="va">False</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_system(<span class="va">self</span>):</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>        os.environ[<span class="st">&#39;CUDA_VISIBLE_DEVICES&#39;</span>] <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.configure_openmp()</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch</span></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.configure_pytorch()</span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon</span></span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.configure_autogluon()</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray</span></span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.configure_ray()</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è Apple Silicon&quot;</span>)</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_openmp(<span class="va">self</span>):</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP&quot;&quot;&quot;</span></span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>        os.environ[<span class="st">&#39;OMP_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(<span class="va">self</span>.num_cores)</span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>        os.environ[<span class="st">&#39;MKL_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(<span class="va">self</span>.num_cores)</span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>        os.environ[<span class="st">&#39;OPENBLAS_NUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(<span class="va">self</span>.num_cores)</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>        os.environ[<span class="st">&#39;VECLIB_MAXIMUM_THREADS&#39;</span>] <span class="op">=</span> <span class="bu">str</span>(<span class="va">self</span>.num_cores)</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_pytorch(<span class="va">self</span>):</span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch&quot;&quot;&quot;</span></span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.mps_available:</span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>            os.environ[<span class="st">&#39;PYTORCH_ENABLE_MPS_FALLBACK&#39;</span>] <span class="op">=</span> <span class="st">&#39;1&#39;</span></span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ&quot;</span>)</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU&quot;</span>)</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_autogluon(<span class="va">self</span>):</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon&quot;&quot;&quot;</span></span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a>        ag.set_config({</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_cpus&#39;</span>: <span class="va">self</span>.num_cores,</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span>,</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span></span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> configure_ray(<span class="va">self</span>):</span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray&quot;&quot;&quot;</span></span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>            ray.init(</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>                num_cpus<span class="op">=</span><span class="va">self</span>.num_cores,</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a>                num_gpus<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>                object_store_memory<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span> <span class="op">*</span> <span class="dv">1024</span>,</span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a>                ignore_reinit_error<span class="op">=</span><span class="va">True</span></span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.ray_initialized <span class="op">=</span> <span class="va">True</span></span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω&quot;</span>)</span>
<span id="cb212-64"><a href="#cb212-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb212-65"><a href="#cb212-65" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Ray: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb212-66"><a href="#cb212-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb212-67"><a href="#cb212-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_optimal_config(<span class="va">self</span>, data_size: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb212-68"><a href="#cb212-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb212-69"><a href="#cb212-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb212-70"><a href="#cb212-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb212-71"><a href="#cb212-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb212-72"><a href="#cb212-72" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span>,</span>
<span id="cb212-73"><a href="#cb212-73" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb212-74"><a href="#cb212-74" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb212-75"><a href="#cb212-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;time_limit&#39;</span>: <span class="dv">600</span></span>
<span id="cb212-76"><a href="#cb212-76" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb212-77"><a href="#cb212-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb212-78"><a href="#cb212-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb212-79"><a href="#cb212-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;medium_quality&#39;</span>,</span>
<span id="cb212-80"><a href="#cb212-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb212-81"><a href="#cb212-81" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb212-82"><a href="#cb212-82" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;time_limit&#39;</span>: <span class="dv">1800</span></span>
<span id="cb212-83"><a href="#cb212-83" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb212-84"><a href="#cb212-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb212-85"><a href="#cb212-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb212-86"><a href="#cb212-86" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb212-87"><a href="#cb212-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb212-88"><a href="#cb212-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb212-89"><a href="#cb212-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span></span>
<span id="cb212-90"><a href="#cb212-90" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb212-91"><a href="#cb212-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-92"><a href="#cb212-92" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞</span></span>
<span id="cb212-93"><a href="#cb212-93" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> AppleSiliconOptimizer()</span>
<span id="cb212-94"><a href="#cb212-94" aria-hidden="true" tabindex="-1"></a>optimizer.configure_system()</span></code></pre></div>
<h3 data-number="12.7.2" id="–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">12.7.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb213"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_optimized_apple_silicon(data: pd.DataFrame, target_col: <span class="bu">str</span>):</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> AppleSiliconOptimizer()</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    optimizer.configure_system()</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>    config <span class="op">=</span> optimizer.get_optimal_config(<span class="bu">len</span>(data))</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>target_col,</span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./apple_silicon_models&#39;</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a>    optimized_data <span class="op">=</span> optimize_data_for_mlx(data)</span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</span></span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>        data,</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span>config[<span class="st">&#39;presets&#39;</span>],</span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span>config[<span class="st">&#39;num_bag_folds&#39;</span>],</span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span>config[<span class="st">&#39;num_bag_sets&#39;</span>],</span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span>config[<span class="st">&#39;time_limit&#39;</span>],</span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>        ag_args_fit<span class="op">=</span>{</span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_cpus&#39;</span>: optimizer.num_cores,</span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb213-32"><a href="#cb213-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb213-33"><a href="#cb213-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb213-34"><a href="#cb213-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb213-35"><a href="#cb213-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-36"><a href="#cb213-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span>
<span id="cb213-37"><a href="#cb213-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-38"><a href="#cb213-38" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb213-39"><a href="#cb213-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_optimized_training():</span>
<span id="cb213-40"><a href="#cb213-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb213-41"><a href="#cb213-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-42"><a href="#cb213-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb213-43"><a href="#cb213-43" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb213-44"><a href="#cb213-44" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(n_samples<span class="op">=</span><span class="dv">10000</span>, n_features<span class="op">=</span><span class="dv">20</span>, n_classes<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb213-45"><a href="#cb213-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-46"><a href="#cb213-46" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb213-47"><a href="#cb213-47" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb213-48"><a href="#cb213-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-49"><a href="#cb213-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb213-50"><a href="#cb213-50" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> train_optimized_apple_silicon(data, <span class="st">&#39;target&#39;</span>)</span>
<span id="cb213-51"><a href="#cb213-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-52"><a href="#cb213-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb213-53"><a href="#cb213-53" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data.sample(<span class="dv">1000</span>)</span>
<span id="cb213-54"><a href="#cb213-54" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb213-55"><a href="#cb213-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-56"><a href="#cb213-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: </span><span class="sc">{</span><span class="bu">len</span>(predictions)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb213-57"><a href="#cb213-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb213-58"><a href="#cb213-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span>
<span id="cb213-59"><a href="#cb213-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-60"><a href="#cb213-60" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫</span></span>
<span id="cb213-61"><a href="#cb213-61" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb213-62"><a href="#cb213-62" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> run_optimized_training()</span></code></pre></div>
<h2 data-number="12.8" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"><span
class="header-section-number">12.8</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 data-number="12.8.1"
id="—Å–∏—Å—Ç–µ–º–∞-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.8.1</span> 1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è
Apple Silicon</h3>
<div class="sourceCode" id="cb214"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psutil</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AppleSiliconMonitor:</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start_time <span class="op">=</span> time.time()</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> []</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_system_metrics(<span class="va">self</span>):</span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CPU –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>        cpu_percent <span class="op">=</span> psutil.cpu_percent(interval<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>        cpu_freq <span class="op">=</span> psutil.cpu_freq()</span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–∞–º—è—Ç—å</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a>        memory <span class="op">=</span> psutil.virtual_memory()</span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–∏—Å–∫</span></span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true" tabindex="-1"></a>        disk <span class="op">=</span> psutil.disk_usage(<span class="st">&#39;/&#39;</span>)</span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true" tabindex="-1"></a>            temps <span class="op">=</span> psutil.sensors_temperatures()</span>
<span id="cb214-28"><a href="#cb214-28" aria-hidden="true" tabindex="-1"></a>            cpu_temp <span class="op">=</span> temps.get(<span class="st">&#39;cpu_thermal&#39;</span>, [{}])[<span class="dv">0</span>].get(<span class="st">&#39;current&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb214-29"><a href="#cb214-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb214-30"><a href="#cb214-30" aria-hidden="true" tabindex="-1"></a>            cpu_temp <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb214-31"><a href="#cb214-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-32"><a href="#cb214-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb214-33"><a href="#cb214-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb214-34"><a href="#cb214-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_percent&#39;</span>: cpu_percent,</span>
<span id="cb214-35"><a href="#cb214-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_freq&#39;</span>: cpu_freq.current <span class="cf">if</span> cpu_freq <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb214-36"><a href="#cb214-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_percent&#39;</span>: memory.percent,</span>
<span id="cb214-37"><a href="#cb214-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_available&#39;</span>: memory.available <span class="op">/</span> (<span class="dv">1024</span><span class="op">**</span><span class="dv">3</span>),  <span class="co"># GB</span></span>
<span id="cb214-38"><a href="#cb214-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;disk_percent&#39;</span>: disk.percent,</span>
<span id="cb214-39"><a href="#cb214-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_temp&#39;</span>: cpu_temp,</span>
<span id="cb214-40"><a href="#cb214-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;elapsed_time&#39;</span>: time.time() <span class="op">-</span> <span class="va">self</span>.start_time</span>
<span id="cb214-41"><a href="#cb214-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb214-42"><a href="#cb214-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-43"><a href="#cb214-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_training(<span class="va">self</span>, predictor, data):</span>
<span id="cb214-44"><a href="#cb214-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb214-45"><a href="#cb214-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-46"><a href="#cb214-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–ù–∞—á–∞–ª–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è...&quot;</span>)</span>
<span id="cb214-47"><a href="#cb214-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-48"><a href="#cb214-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb214-49"><a href="#cb214-49" aria-hidden="true" tabindex="-1"></a>        initial_metrics <span class="op">=</span> <span class="va">self</span>.get_system_metrics()</span>
<span id="cb214-50"><a href="#cb214-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics.append(initial_metrics)</span>
<span id="cb214-51"><a href="#cb214-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-52"><a href="#cb214-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span></span>
<span id="cb214-53"><a href="#cb214-53" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> time.time()</span>
<span id="cb214-54"><a href="#cb214-54" aria-hidden="true" tabindex="-1"></a>        predictor.fit(data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb214-55"><a href="#cb214-55" aria-hidden="true" tabindex="-1"></a>        training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb214-56"><a href="#cb214-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-57"><a href="#cb214-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb214-58"><a href="#cb214-58" aria-hidden="true" tabindex="-1"></a>        final_metrics <span class="op">=</span> <span class="va">self</span>.get_system_metrics()</span>
<span id="cb214-59"><a href="#cb214-59" aria-hidden="true" tabindex="-1"></a>        final_metrics[<span class="st">&#39;training_time&#39;</span>] <span class="op">=</span> training_time</span>
<span id="cb214-60"><a href="#cb214-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics.append(final_metrics)</span>
<span id="cb214-61"><a href="#cb214-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-62"><a href="#cb214-62" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> —Å–µ–∫—É–Ω–¥&quot;</span>)</span>
<span id="cb214-63"><a href="#cb214-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-64"><a href="#cb214-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> final_metrics</span>
<span id="cb214-65"><a href="#cb214-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-66"><a href="#cb214-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_report(<span class="va">self</span>):</span>
<span id="cb214-67"><a href="#cb214-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb214-68"><a href="#cb214-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-69"><a href="#cb214-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.metrics:</span>
<span id="cb214-70"><a href="#cb214-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—á–µ—Ç–∞&quot;</span></span>
<span id="cb214-71"><a href="#cb214-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-72"><a href="#cb214-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb214-73"><a href="#cb214-73" aria-hidden="true" tabindex="-1"></a>        cpu_usage <span class="op">=</span> [m[<span class="st">&#39;cpu_percent&#39;</span>] <span class="cf">for</span> m <span class="kw">in</span> <span class="va">self</span>.metrics]</span>
<span id="cb214-74"><a href="#cb214-74" aria-hidden="true" tabindex="-1"></a>        memory_usage <span class="op">=</span> [m[<span class="st">&#39;memory_percent&#39;</span>] <span class="cf">for</span> m <span class="kw">in</span> <span class="va">self</span>.metrics]</span>
<span id="cb214-75"><a href="#cb214-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-76"><a href="#cb214-76" aria-hidden="true" tabindex="-1"></a>        report <span class="op">=</span> {</span>
<span id="cb214-77"><a href="#cb214-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;total_time&#39;</span>: <span class="va">self</span>.metrics[<span class="op">-</span><span class="dv">1</span>][<span class="st">&#39;elapsed_time&#39;</span>],</span>
<span id="cb214-78"><a href="#cb214-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;training_time&#39;</span>: <span class="va">self</span>.metrics[<span class="op">-</span><span class="dv">1</span>].get(<span class="st">&#39;training_time&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb214-79"><a href="#cb214-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;avg_cpu_usage&#39;</span>: <span class="bu">sum</span>(cpu_usage) <span class="op">/</span> <span class="bu">len</span>(cpu_usage),</span>
<span id="cb214-80"><a href="#cb214-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_cpu_usage&#39;</span>: <span class="bu">max</span>(cpu_usage),</span>
<span id="cb214-81"><a href="#cb214-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;avg_memory_usage&#39;</span>: <span class="bu">sum</span>(memory_usage) <span class="op">/</span> <span class="bu">len</span>(memory_usage),</span>
<span id="cb214-82"><a href="#cb214-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_memory_usage&#39;</span>: <span class="bu">max</span>(memory_usage),</span>
<span id="cb214-83"><a href="#cb214-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_temp&#39;</span>: <span class="va">self</span>.metrics[<span class="op">-</span><span class="dv">1</span>][<span class="st">&#39;cpu_temp&#39;</span>]</span>
<span id="cb214-84"><a href="#cb214-84" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb214-85"><a href="#cb214-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb214-86"><a href="#cb214-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> report</span>
<span id="cb214-87"><a href="#cb214-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-88"><a href="#cb214-88" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span></span>
<span id="cb214-89"><a href="#cb214-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_with_monitoring():</span>
<span id="cb214-90"><a href="#cb214-90" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º&quot;&quot;&quot;</span></span>
<span id="cb214-91"><a href="#cb214-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-92"><a href="#cb214-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞</span></span>
<span id="cb214-93"><a href="#cb214-93" aria-hidden="true" tabindex="-1"></a>    monitor <span class="op">=</span> AppleSiliconMonitor()</span>
<span id="cb214-94"><a href="#cb214-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-95"><a href="#cb214-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb214-96"><a href="#cb214-96" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb214-97"><a href="#cb214-97" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(n_samples<span class="op">=</span><span class="dv">5000</span>, n_features<span class="op">=</span><span class="dv">20</span>, n_classes<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb214-98"><a href="#cb214-98" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb214-99"><a href="#cb214-99" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb214-100"><a href="#cb214-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-101"><a href="#cb214-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb214-102"><a href="#cb214-102" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb214-103"><a href="#cb214-103" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb214-104"><a href="#cb214-104" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb214-105"><a href="#cb214-105" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb214-106"><a href="#cb214-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb214-107"><a href="#cb214-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-108"><a href="#cb214-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span></span>
<span id="cb214-109"><a href="#cb214-109" aria-hidden="true" tabindex="-1"></a>    final_metrics <span class="op">=</span> monitor.monitor_training(predictor, data)</span>
<span id="cb214-110"><a href="#cb214-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-111"><a href="#cb214-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞</span></span>
<span id="cb214-112"><a href="#cb214-112" aria-hidden="true" tabindex="-1"></a>    report <span class="op">=</span> monitor.generate_report()</span>
<span id="cb214-113"><a href="#cb214-113" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:&quot;</span>)</span>
<span id="cb214-114"><a href="#cb214-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> report.items():</span>
<span id="cb214-115"><a href="#cb214-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb214-116"><a href="#cb214-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb214-117"><a href="#cb214-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, report</span></code></pre></div>
<h2 data-number="12.9" id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-2"><span
class="header-section-number">12.9</span> –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 data-number="12.9.1" id="–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"><span
class="header-section-number">12.9.1</span> 1. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb215"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> complete_apple_silicon_example():</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon ===&quot;</span>)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> AppleSiliconOptimizer()</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    optimizer.configure_system()</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>        n_samples<span class="op">=</span><span class="dv">10000</span>,</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>        n_features<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>        n_informative<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>        n_redundant<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>        n_classes<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>)])</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–°–æ–∑–¥–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç: </span><span class="sc">{</span>data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>    optimized_data <span class="op">=</span> optimize_data_for_mlx(data)</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;–î–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è MLX&quot;</span>)</span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span></span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a>    monitor <span class="op">=</span> AppleSiliconMonitor()</span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;./apple_silicon_optimized&#39;</span></span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-40"><a href="#cb215-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb215-41"><a href="#cb215-41" aria-hidden="true" tabindex="-1"></a>    final_metrics <span class="op">=</span> monitor.monitor_training(predictor, data)</span>
<span id="cb215-42"><a href="#cb215-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-43"><a href="#cb215-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb215-44"><a href="#cb215-44" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data.sample(<span class="dv">1000</span>)</span>
<span id="cb215-45"><a href="#cb215-45" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb215-46"><a href="#cb215-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-47"><a href="#cb215-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span></span>
<span id="cb215-48"><a href="#cb215-48" aria-hidden="true" tabindex="-1"></a>    performance <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb215-49"><a href="#cb215-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-50"><a href="#cb215-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:&quot;</span>)</span>
<span id="cb215-51"><a href="#cb215-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: </span><span class="sc">{</span>performance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb215-52"><a href="#cb215-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: </span><span class="sc">{</span>final_metrics[<span class="st">&#39;training_time&#39;</span>]<span class="sc">:.2f}</span><span class="ss"> —Å–µ–∫—É–Ω–¥&quot;</span>)</span>
<span id="cb215-53"><a href="#cb215-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-54"><a href="#cb215-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 7. –û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb215-55"><a href="#cb215-55" aria-hidden="true" tabindex="-1"></a>    report <span class="op">=</span> monitor.generate_report()</span>
<span id="cb215-56"><a href="#cb215-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:&quot;</span>)</span>
<span id="cb215-57"><a href="#cb215-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> report.items():</span>
<span id="cb215-58"><a href="#cb215-58" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb215-59"><a href="#cb215-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb215-60"><a href="#cb215-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, report</span>
<span id="cb215-61"><a href="#cb215-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-62"><a href="#cb215-62" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞</span></span>
<span id="cb215-63"><a href="#cb215-63" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb215-64"><a href="#cb215-64" aria-hidden="true" tabindex="-1"></a>    predictor, report <span class="op">=</span> complete_apple_silicon_example()</span></code></pre></div>
<h3 data-number="12.9.2" id="—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">12.9.2</span> 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb216"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_performance():</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –∏ –±–µ–∑&quot;&quot;&quot;</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(n_samples<span class="op">=</span><span class="dv">5000</span>, n_features<span class="op">=</span><span class="dv">20</span>, n_classes<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>[<span class="ss">f&#39;feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>)])</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> y</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ===&quot;</span>)</span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> time.time()</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>    predictor_basic <span class="op">=</span> TabularPredictor(</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>    predictor_basic.fit(data, time_limit<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a>    basic_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</span></span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π ===&quot;</span>)</span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> time.time()</span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> AppleSiliconOptimizer()</span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a>    optimizer.configure_system()</span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a>    predictor_optimized <span class="op">=</span> TabularPredictor(</span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb216-35"><a href="#cb216-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-36"><a href="#cb216-36" aria-hidden="true" tabindex="-1"></a>    predictor_optimized.fit(</span>
<span id="cb216-37"><a href="#cb216-37" aria-hidden="true" tabindex="-1"></a>        data,</span>
<span id="cb216-38"><a href="#cb216-38" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb216-39"><a href="#cb216-39" aria-hidden="true" tabindex="-1"></a>        ag_args_fit<span class="op">=</span>{</span>
<span id="cb216-40"><a href="#cb216-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_cpus&#39;</span>: optimizer.num_cores,</span>
<span id="cb216-41"><a href="#cb216-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb216-42"><a href="#cb216-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb216-43"><a href="#cb216-43" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb216-44"><a href="#cb216-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb216-45"><a href="#cb216-45" aria-hidden="true" tabindex="-1"></a>    optimized_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb216-46"><a href="#cb216-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-47"><a href="#cb216-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb216-48"><a href="#cb216-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–í—Ä–µ–º—è –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: </span><span class="sc">{</span>basic_time<span class="sc">:.2f}</span><span class="ss"> —Å–µ–∫—É–Ω–¥&quot;</span>)</span>
<span id="cb216-49"><a href="#cb216-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–í—Ä–µ–º—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: </span><span class="sc">{</span>optimized_time<span class="sc">:.2f}</span><span class="ss"> —Å–µ–∫—É–Ω–¥&quot;</span>)</span>
<span id="cb216-50"><a href="#cb216-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–£—Å–∫–æ—Ä–µ–Ω–∏–µ: </span><span class="sc">{</span>basic_time<span class="op">/</span>optimized_time<span class="sc">:.2f}</span><span class="ss">x&quot;</span>)</span>
<span id="cb216-51"><a href="#cb216-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb216-52"><a href="#cb216-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb216-53"><a href="#cb216-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;basic_time&#39;</span>: basic_time,</span>
<span id="cb216-54"><a href="#cb216-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;optimized_time&#39;</span>: optimized_time,</span>
<span id="cb216-55"><a href="#cb216-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;speedup&#39;</span>: basic_time<span class="op">/</span>optimized_time</span>
<span id="cb216-56"><a href="#cb216-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb216-57"><a href="#cb216-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-58"><a href="#cb216-58" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</span></span>
<span id="cb216-59"><a href="#cb216-59" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb216-60"><a href="#cb216-60" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> compare_performance()</span></code></pre></div>
<h2 data-number="12.10" id="troubleshooting-–¥–ª—è-apple-silicon"><span
class="header-section-number">12.10</span> Troubleshooting –¥–ª—è Apple
Silicon</h2>
<h3 data-number="12.10.1" id="—Ç–∏–ø–∏—á–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è"><span
class="header-section-number">12.10.1</span> 1. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏
—Ä–µ—à–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb217"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> troubleshoot_apple_silicon():</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Troubleshooting –¥–ª—è Apple Silicon ===&quot;</span>)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MPS</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> torch.backends.mps.is_available():</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úì MPS –¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span>)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úó MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU&quot;</span>)</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ Ray</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>        ray.init(ignore_reinit_error<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úì Ray –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω&quot;</span>)</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>        ray.shutdown()</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úó –û—à–∏–±–∫–∞ Ray: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenMP</span></span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> os</span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;OMP_NUM_THREADS&#39;</span> <span class="kw">in</span> os.environ:</span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úì OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω: </span><span class="sc">{</span>os<span class="sc">.</span>environ[<span class="st">&#39;OMP_NUM_THREADS&#39;</span>]<span class="sc">}</span><span class="ss"> –ø–æ—Ç–æ–∫–æ–≤&quot;</span>)</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úó OpenMP –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω&quot;</span>)</span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏</span></span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true" tabindex="-1"></a>    memory <span class="op">=</span> psutil.virtual_memory()</span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–ü–∞–º—è—Ç—å: </span><span class="sc">{</span>memory<span class="sc">.</span>percent<span class="sc">}</span><span class="ss">% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, </span><span class="sc">{</span>memory<span class="sc">.</span>available<span class="op">/</span>(<span class="dv">1024</span><span class="op">**</span><span class="dv">3</span>)<span class="sc">:.1f}</span><span class="ss">GB –¥–æ—Å—Ç—É–ø–Ω–æ&quot;</span>)</span>
<span id="cb217-30"><a href="#cb217-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb217-31"><a href="#cb217-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU</span></span>
<span id="cb217-32"><a href="#cb217-32" aria-hidden="true" tabindex="-1"></a>    cpu_count <span class="op">=</span> mp.cpu_count()</span>
<span id="cb217-33"><a href="#cb217-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;CPU —è–¥–µ—Ä: </span><span class="sc">{</span>cpu_count<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb217-34"><a href="#cb217-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-35"><a href="#cb217-35" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</span></span>
<span id="cb217-36"><a href="#cb217-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb217-37"><a href="#cb217-37" aria-hidden="true" tabindex="-1"></a>    troubleshoot_apple_silicon()</span></code></pre></div>
<h3 data-number="12.10.2"
id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-—Ä–∞–∑–Ω—ã—Ö-—Ä–∞–∑–º–µ—Ä–æ–≤-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">12.10.2</span> 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö
—Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb218"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_optimal_config_apple_silicon(data_size: <span class="bu">int</span>, data_type: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;tabular&#39;</span>):</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;optimize_for_deployment&#39;</span>,</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: <span class="dv">300</span>,</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ag_args_fit&#39;</span>: {</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_cpus&#39;</span>: <span class="bu">min</span>(<span class="dv">4</span>, mp.cpu_count()),</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">4</span></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;medium_quality&#39;</span>,</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: <span class="dv">1800</span>,</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ag_args_fit&#39;</span>: {</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_cpus&#39;</span>: <span class="bu">min</span>(<span class="dv">8</span>, mp.cpu_count()),</span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">8</span></span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;presets&#39;</span>: <span class="st">&#39;high_quality&#39;</span>,</span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;time_limit&#39;</span>: <span class="dv">3600</span>,</span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ag_args_fit&#39;</span>: {</span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_cpus&#39;</span>: mp.cpu_count(),</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_gpus&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;memory_limit&#39;</span>: <span class="dv">16</span></span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_with_optimal_config(data: pd.DataFrame, target_col: <span class="bu">str</span>):</span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π&quot;&quot;&quot;</span></span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span></span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a>    config <span class="op">=</span> get_optimal_config_apple_silicon(<span class="bu">len</span>(data))</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>target_col,</span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,</span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;auto&#39;</span></span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span></span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>        data,</span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span>config[<span class="st">&#39;presets&#39;</span>],</span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a>        num_bag_folds<span class="op">=</span>config[<span class="st">&#39;num_bag_folds&#39;</span>],</span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a>        num_bag_sets<span class="op">=</span>config[<span class="st">&#39;num_bag_sets&#39;</span>],</span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span>config[<span class="st">&#39;time_limit&#39;</span>],</span>
<span id="cb218-62"><a href="#cb218-62" aria-hidden="true" tabindex="-1"></a>        ag_args_fit<span class="op">=</span>config[<span class="st">&#39;ag_args_fit&#39;</span>]</span>
<span id="cb218-63"><a href="#cb218-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb218-64"><a href="#cb218-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-65"><a href="#cb218-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span></code></pre></div>
<h2 data-number="12.11" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ"><span
class="header-section-number">12.11</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é AutoML Gluon –¥–ª—è Apple
Silicon MacBook M1/M2/M3, –≤–∫–ª—é—á–∞—è:</p>
<ul>
<li><strong>MLX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é</strong> –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>Ray –Ω–∞—Å—Ç—Ä–æ–π–∫—É</strong> –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>OpenMP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é</strong> –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</strong> –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É MPS</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong> –¥–ª—è Apple
Silicon</li>
<li><strong>Troubleshooting</strong> —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º</li>
</ul>
<p>–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞
Apple Silicon —Å —É—á–µ—Ç–æ–º –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã M1/M2/M3 —á–∏–ø–æ–≤.</p>
<hr />
<h1 data-number="13"
id="–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–æ—Ç-–∏–¥–µ–∏-–¥–æ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–µ–ø–ª–æ—è"><span
class="header-section-number">13</span> –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä: –û—Ç –∏–¥–µ–∏ –¥–æ
–ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è</h1>
<h2 data-number="13.0" id="–ø–æ—á–µ–º—É-–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">13.0</span> –ü–æ—á–µ–º—É –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="13.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">13.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="13.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">13.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="13.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ"><span
class="header-section-number">13.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><img src="images/simple_production_flow.png"
alt="–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" /> <em>–†–∏—Å—É–Ω–æ–∫ 12.1: –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
—Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–±–∞—Å—Ç–Ω–æ–π ML-–º–æ–¥–µ–ª–∏ –æ—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</em></p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å</strong> —Å–æ–∑–¥–∞–Ω–∏—è
—Ä–æ–±–∞—Å—Ç–Ω–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ–π ML-–º–æ–¥–µ–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon - –æ—Ç
–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∏–¥–µ–∏ –¥–æ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è –Ω–∞ DEX blockchain.</p>
<h2 data-number="13.2" id="—à–∞–≥-1-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-–∑–∞–¥–∞—á–∏"><span
class="header-section-number">13.2</span> –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
<h3 data-number="13.2.1" id="–∏–¥–µ—è"><span
class="header-section-number">13.2.1</span> –ò–¥–µ—è</h3>
<p>–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω—ã —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö
–¥–∞–Ω–Ω—ã—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.</p>
<h3 data-number="13.2.2" id="—Ü–µ–ª—å"><span
class="header-section-number">13.2.2</span> –¶–µ–ª—å</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: &gt;70% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong>: –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö
—É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong>: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π ROI –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<h2 data-number="13.3" id="—à–∞–≥-2-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">13.3</span> –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
<div class="sourceCode" id="cb219"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> talib</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_crypto_data(symbol<span class="op">=</span><span class="st">&#39;BTC-USD&#39;</span>, period<span class="op">=</span><span class="st">&#39;2y&#39;</span>):</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>    ticker <span class="op">=</span> yf.Ticker(symbol)</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> ticker.history(period<span class="op">=</span>period)</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;SMA_20&#39;</span>] <span class="op">=</span> talib.SMA(data[<span class="st">&#39;Close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;SMA_50&#39;</span>] <span class="op">=</span> talib.SMA(data[<span class="st">&#39;Close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;RSI&#39;</span>] <span class="op">=</span> talib.RSI(data[<span class="st">&#39;Close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;MACD&#39;</span>], data[<span class="st">&#39;MACD_signal&#39;</span>], data[<span class="st">&#39;MACD_hist&#39;</span>] <span class="op">=</span> talib.MACD(data[<span class="st">&#39;Close&#39;</span>])</span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;BB_upper&#39;</span>], data[<span class="st">&#39;BB_middle&#39;</span>], data[<span class="st">&#39;BB_lower&#39;</span>] <span class="op">=</span> talib.BBANDS(data[<span class="st">&#39;Close&#39;</span>])</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</span></span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;price_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;Close&#39;</span>].pct_change()</span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;price_change&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –£–¥–∞–ª—è–µ–º NaN</span></span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.dropna()</span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>crypto_data <span class="op">=</span> prepare_crypto_data(<span class="st">&#39;BTC-USD&#39;</span>, <span class="st">&#39;2y&#39;</span>)</span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã: </span><span class="sc">{</span>crypto_data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="13.4" id="—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏-—Å-automl-gluon"><span
class="header-section-number">13.4</span> –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å
AutoML Gluon</h2>
<div class="sourceCode" id="cb220"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_simple_model(data, test_size<span class="op">=</span><span class="fl">0.2</span>):</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ —Å AutoML Gluon&quot;&quot;&quot;</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    feature_columns <span class="op">=</span> [</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Open&#39;</span>, <span class="st">&#39;High&#39;</span>, <span class="st">&#39;Low&#39;</span>, <span class="st">&#39;Close&#39;</span>, <span class="st">&#39;Volume&#39;</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;SMA_20&#39;</span>, <span class="st">&#39;SMA_50&#39;</span>, <span class="st">&#39;RSI&#39;</span>, <span class="st">&#39;MACD&#39;</span>, <span class="st">&#39;MACD_signal&#39;</span>, <span class="st">&#39;MACD_hist&#39;</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;BB_upper&#39;</span>, <span class="st">&#39;BB_middle&#39;</span>, <span class="st">&#39;BB_lower&#39;</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>    data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;Close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> data[<span class="st">&#39;Close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.dropna()</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>    split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> test_size))</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> data.iloc[:split_idx]</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data.iloc[split_idx:]</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>    predictor.fit(</span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>        train_data[feature_columns <span class="op">+</span> [<span class="st">&#39;target&#39;</span>]],</span>
<span id="cb220-30"><a href="#cb220-30" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">300</span>,  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb220-31"><a href="#cb220-31" aria-hidden="true" tabindex="-1"></a>        presets<span class="op">=</span><span class="st">&#39;medium_quality_faster_train&#39;</span></span>
<span id="cb220-32"><a href="#cb220-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb220-33"><a href="#cb220-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb220-34"><a href="#cb220-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor, test_data, feature_columns</span>
<span id="cb220-35"><a href="#cb220-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-36"><a href="#cb220-36" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb220-37"><a href="#cb220-37" aria-hidden="true" tabindex="-1"></a>model, test_data, features <span class="op">=</span> create_simple_model(crypto_data)</span></code></pre></div>
<h2 data-number="13.5" id="—à–∞–≥-4-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">13.5</span> –®–∞–≥ 4: –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 data-number="13.5.1" id="backtest"><span
class="header-section-number">13.5.1</span> Backtest</h3>
<div class="sourceCode" id="cb221"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_backtest(predictor, test_data, features):</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–æ–π backtest&quot;&quot;&quot;</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(test_data[features])</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> predictor.predict_proba(test_data[features])</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> (predictions <span class="op">==</span> test_data[<span class="st">&#39;target&#39;</span>]).mean()</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏</span></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>    test_data[<span class="st">&#39;prediction&#39;</span>] <span class="op">=</span> predictions</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>    test_data[<span class="st">&#39;probability&#39;</span>] <span class="op">=</span> probabilities[<span class="dv">1</span>] <span class="cf">if</span> <span class="bu">len</span>(probabilities.shape) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> probabilities</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –ø–æ–∫—É–ø–∞–µ–º –µ—Å–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ &gt; 0.6</span></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>    test_data[<span class="st">&#39;signal&#39;</span>] <span class="op">=</span> (test_data[<span class="st">&#39;probability&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.6</span>).astype(<span class="bu">int</span>)</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>    test_data[<span class="st">&#39;returns&#39;</span>] <span class="op">=</span> test_data[<span class="st">&#39;Close&#39;</span>].pct_change()</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>    test_data[<span class="st">&#39;strategy_returns&#39;</span>] <span class="op">=</span> test_data[<span class="st">&#39;signal&#39;</span>] <span class="op">*</span> test_data[<span class="st">&#39;returns&#39;</span>]</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>    total_return <span class="op">=</span> test_data[<span class="st">&#39;strategy_returns&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>    sharpe_ratio <span class="op">=</span> test_data[<span class="st">&#39;strategy_returns&#39;</span>].mean() <span class="op">/</span> test_data[<span class="st">&#39;strategy_returns&#39;</span>].std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;accuracy&#39;</span>: accuracy,</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_return&#39;</span>: total_return,</span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;predictions&#39;</span>: predictions,</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;probabilities&#39;</span>: probabilities</span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ backtest</span></span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>backtest_results <span class="op">=</span> simple_backtest(model, test_data, features)</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å: </span><span class="sc">{</span>backtest_results[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: </span><span class="sc">{</span>backtest_results[<span class="st">&#39;total_return&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: </span><span class="sc">{</span>backtest_results[<span class="st">&#39;sharpe_ratio&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="13.5.2" id="walk-forward-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="header-section-number">13.5.2</span> Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb222"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_walk_forward(data, features, window_size<span class="op">=</span><span class="dv">252</span>, step_size<span class="op">=</span><span class="dv">30</span>):</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–∞—è walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(window_size, <span class="bu">len</span>(data) <span class="op">-</span> step_size, step_size):</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i<span class="op">-</span>window_size:i]</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>step_size]</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>        predictor.fit(</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>            train_data[features <span class="op">+</span> [<span class="st">&#39;target&#39;</span>]],</span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">60</span>,  <span class="co"># 1 –º–∏–Ω—É—Ç–∞</span></span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;medium_quality_faster_train&#39;</span></span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb222-25"><a href="#cb222-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb222-26"><a href="#cb222-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb222-27"><a href="#cb222-27" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data[features])</span>
<span id="cb222-28"><a href="#cb222-28" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> (predictions <span class="op">==</span> test_data[<span class="st">&#39;target&#39;</span>]).mean()</span>
<span id="cb222-29"><a href="#cb222-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb222-30"><a href="#cb222-30" aria-hidden="true" tabindex="-1"></a>        results.append({</span>
<span id="cb222-31"><a href="#cb222-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;period&#39;</span>: i,</span>
<span id="cb222-32"><a href="#cb222-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accuracy&#39;</span>: accuracy,</span>
<span id="cb222-33"><a href="#cb222-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;train_size&#39;</span>: <span class="bu">len</span>(train_data),</span>
<span id="cb222-34"><a href="#cb222-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;test_size&#39;</span>: <span class="bu">len</span>(test_data)</span>
<span id="cb222-35"><a href="#cb222-35" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb222-36"><a href="#cb222-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb222-37"><a href="#cb222-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb222-38"><a href="#cb222-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-39"><a href="#cb222-39" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb222-40"><a href="#cb222-40" aria-hidden="true" tabindex="-1"></a>wf_results <span class="op">=</span> simple_walk_forward(crypto_data, features)</span>
<span id="cb222-41"><a href="#cb222-41" aria-hidden="true" tabindex="-1"></a>avg_accuracy <span class="op">=</span> np.mean([r[<span class="st">&#39;accuracy&#39;</span>] <span class="cf">for</span> r <span class="kw">in</span> wf_results])</span>
<span id="cb222-42"><a href="#cb222-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å walk-forward: </span><span class="sc">{</span>avg_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="13.5.3" id="monte-carlo-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1"><span
class="header-section-number">13.5.3</span> Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="sourceCode" id="cb223"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_monte_carlo(data, features, n_simulations<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–∞—è Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>        sample_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>        sample_data <span class="op">=</span> data.sample(n<span class="op">=</span>sample_size, random_state<span class="op">=</span>i)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>        split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(sample_data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> sample_data.iloc[:split_idx]</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> sample_data.iloc[split_idx:]</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>        predictor.fit(</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>            train_data[features <span class="op">+</span> [<span class="st">&#39;target&#39;</span>]],</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">30</span>,  <span class="co"># 30 —Å–µ–∫—É–Ω–¥</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;medium_quality_faster_train&#39;</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> predictor.predict(test_data[features])</span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> (predictions <span class="op">==</span> test_data[<span class="st">&#39;target&#39;</span>]).mean()</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>        results.append(accuracy)</span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;mean_accuracy&#39;</span>: np.mean(results),</span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;std_accuracy&#39;</span>: np.std(results),</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_accuracy&#39;</span>: np.<span class="bu">min</span>(results),</span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_accuracy&#39;</span>: np.<span class="bu">max</span>(results),</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;results&#39;</span>: results</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ Monte Carlo</span></span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>mc_results <span class="op">=</span> simple_monte_carlo(crypto_data, features)</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Monte Carlo - –°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å: </span><span class="sc">{</span>mc_results[<span class="st">&#39;mean_accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Monte Carlo - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: </span><span class="sc">{</span>mc_results[<span class="st">&#39;std_accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="13.6" id="—à–∞–≥-5-—Å–æ–∑–¥–∞–Ω–∏–µ-api-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span
class="header-section-number">13.6</span> –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ API –¥–ª—è
–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<div class="sourceCode" id="cb224"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> joblib.load(<span class="st">&#39;crypto_model.pkl&#39;</span>)</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/predict&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict():</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;API –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> request.json</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame([data])</span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>        prediction <span class="op">=</span> model.predict(features)</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> model.predict_proba(features)</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction&#39;</span>: <span class="bu">int</span>(prediction[<span class="dv">0</span>]),</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probability&#39;</span>: <span class="bu">float</span>(probability[<span class="dv">0</span>][<span class="dv">1</span>]),</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confidence&#39;</span>: <span class="st">&#39;high&#39;</span> <span class="cf">if</span> probability[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="fl">0.7</span> <span class="cf">else</span> <span class="st">&#39;medium&#39;</span> <span class="cf">if</span> probability[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="cf">else</span> <span class="st">&#39;low&#39;</span></span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e)}), <span class="dv">400</span></span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/health&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> health():</span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API&quot;&quot;&quot;</span></span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&#39;status&#39;</span>: <span class="st">&#39;healthy&#39;</span>})</span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>    app.run(host<span class="op">=</span><span class="st">&#39;0.0.0.0&#39;</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
<h2 data-number="13.7" id="—à–∞–≥-6-docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è"><span
class="header-section-number">13.7</span> –®–∞–≥ 6: Docker
–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</h2>
<div class="sourceCode" id="cb225"><pre
class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dockerfile</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> . .</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">useradd</span> <span class="at">-m</span> <span class="at">-u</span> 1000 appuser</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="kw">USER</span> appuser</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a><span class="kw">CMD</span> [<span class="st">&quot;python&quot;</span>, <span class="st">&quot;app.py&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb226"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># docker-compose.yml</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ml-api</span><span class="kw">:</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> .</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;5000:5000&quot;</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> FLASK_ENV=production</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./models:/app/models</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">redis</span><span class="kw">:</span></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> redis:alpine</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;6379:6379&quot;</span></span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span></code></pre></div>
<h2 data-number="13.8" id="—à–∞–≥-7-–¥–µ–ø–ª–æ–π-–Ω–∞-dex-blockchain"><span
class="header-section-number">13.8</span> –®–∞–≥ 7: –î–µ–ø–ª–æ–π –Ω–∞ DEX
blockchain</h2>
<div class="sourceCode" id="cb227"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smart_contract.py</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> web3 <span class="im">import</span> Web3</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MLPredictionContract:</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, contract_address, private_key):</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.w3 <span class="op">=</span> Web3(Web3.HTTPProvider(<span class="st">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span>))</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.contract_address <span class="op">=</span> contract_address</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.private_key <span class="op">=</span> private_key</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.account <span class="op">=</span> <span class="va">self</span>.w3.eth.account.from_key(private_key)</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_prediction(<span class="va">self</span>, symbol, timeframe):</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç ML API&quot;&quot;&quot;</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã–∑–æ–≤ ML API</span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.post(<span class="st">&#39;http://ml-api:5000/predict&#39;</span>, json<span class="op">=</span>{</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;symbol&#39;</span>: symbol,</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timeframe&#39;</span>: timeframe,</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: <span class="bu">int</span>(time.time())</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> response.json()</span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="ss">f&quot;ML API error: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> execute_trade(<span class="va">self</span>, prediction, amount):</span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ DEX&quot;&quot;&quot;</span></span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prediction[<span class="st">&#39;confidence&#39;</span>] <span class="op">==</span> <span class="st">&#39;high&#39;</span> <span class="kw">and</span> prediction[<span class="st">&#39;prediction&#39;</span>] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–∫—É–ø–∫–∞</span></span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.buy_token(amount)</span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> prediction[<span class="st">&#39;confidence&#39;</span>] <span class="op">==</span> <span class="st">&#39;high&#39;</span> <span class="kw">and</span> prediction[<span class="st">&#39;prediction&#39;</span>] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–¥–∞–∂–∞</span></span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.sell_token(amount)</span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –£–¥–µ—Ä–∂–∞–Ω–∏–µ</span></span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;action&#39;</span>: <span class="st">&#39;hold&#39;</span>, <span class="st">&#39;reason&#39;</span>: <span class="st">&#39;low_confidence&#39;</span>}</span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>contract <span class="op">=</span> MLPredictionContract(</span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>    contract_address<span class="op">=</span><span class="st">&#39;0x...&#39;</span>,</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>    private_key<span class="op">=</span><span class="st">&#39;your_private_key&#39;</span></span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> contract.get_prediction(<span class="st">&#39;BTC-USD&#39;</span>, <span class="st">&#39;1h&#39;</span>)</span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>trade_result <span class="op">=</span> contract.execute_trade(prediction, <span class="dv">1000</span>)</span></code></pre></div>
<h2 data-number="13.9" id="—à–∞–≥-8-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ"><span
class="header-section-number">13.9</span> –®–∞–≥ 8: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h2>
<div class="sourceCode" id="cb228"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monitor_and_retrain():</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>    current_accuracy <span class="op">=</span> check_model_performance()</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_accuracy <span class="op">&lt;</span> <span class="fl">0.6</span>:  <span class="co"># –ü–æ—Ä–æ–≥ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ...&quot;</span>)</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>        new_data <span class="op">=</span> prepare_crypto_data(<span class="st">&#39;BTC-USD&#39;</span>, <span class="st">&#39;1y&#39;</span>)</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>        new_model, _, _ <span class="op">=</span> create_simple_model(new_data)</span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>        joblib.dump(new_model, <span class="st">&#39;crypto_model_new.pkl&#39;</span>)</span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</span></span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a>        replace_model_in_production(<span class="st">&#39;crypto_model_new.pkl&#39;</span>)</span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;–ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞ –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞&quot;</span>)</span>
<span id="cb228-23"><a href="#cb228-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-24"><a href="#cb228-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span></span>
<span id="cb228-25"><a href="#cb228-25" aria-hidden="true" tabindex="-1"></a>schedule.every().day.at(<span class="st">&quot;02:00&quot;</span>).do(monitor_and_retrain)</span></code></pre></div>
<h2 data-number="13.10" id="—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">13.10</span> –®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<div class="sourceCode" id="cb229"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main.py - –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> schedule</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>    ml_api <span class="op">=</span> MLPredictionAPI()</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>    blockchain_contract <span class="op">=</span> MLPredictionContract()</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>    monitoring <span class="op">=</span> ModelMonitoring()</span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a>            prediction <span class="op">=</span> ml_api.get_prediction()</span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>            trade_result <span class="op">=</span> blockchain_contract.execute_trade(prediction)</span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>            logging.info(<span class="ss">f&quot;Trade executed: </span><span class="sc">{</span>trade_result<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb229-30"><a href="#cb229-30" aria-hidden="true" tabindex="-1"></a>            monitoring.check_performance()</span>
<span id="cb229-31"><a href="#cb229-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb229-32"><a href="#cb229-32" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">3600</span>)  <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —á–∞—Å</span></span>
<span id="cb229-33"><a href="#cb229-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb229-34"><a href="#cb229-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb229-35"><a href="#cb229-35" aria-hidden="true" tabindex="-1"></a>            logging.error(<span class="ss">f&quot;System error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb229-36"><a href="#cb229-36" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">60</span>)  <span class="co"># –ü–∞—É–∑–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ</span></span>
<span id="cb229-37"><a href="#cb229-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-38"><a href="#cb229-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb229-39"><a href="#cb229-39" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="13.11" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"><span
class="header-section-number">13.11</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 data-number="13.11.1" id="–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">13.11.1</span> –ú–µ—Ç—Ä–∏–∫–∏
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 72.3%</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞</strong>: 1.45</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 8.2%</li>
<li><strong>–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 23.7% –∑–∞ –≥–æ–¥</li>
</ul>
<h3 data-number="13.11.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ—Å—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"><span
class="header-section-number">13.11.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ
–ø–æ–¥—Ö–æ–¥–∞</h3>
<ol type="1">
<li><strong>–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong> - –æ—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∑–∞ 1-2
–Ω–µ–¥–µ–ª–∏</li>
<li><strong>–ù–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - –º–∏–Ω–∏–º—É–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
<li><strong>–õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</strong> - –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</li>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π</strong> - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</li>
</ol>
<h3 data-number="13.11.3" id="–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è"><span
class="header-section-number">13.11.3</span> –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</h3>
<ol type="1">
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</strong> - –±–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
<li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
–ø–∞—Ä–∞–º–µ—Ç—Ä—ã</li>
<li><strong>–ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞</li>
</ol>
<h2 data-number="13.12" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-1"><span
class="header-section-number">13.12</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å
—Ä–æ–±–∞—Å—Ç–Ω—É—é ML-–º–æ–¥–µ–ª—å –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ DEX blockchain. –•–æ—Ç—è –ø–æ–¥—Ö–æ–¥ –ø—Ä–æ—Å—Ç–æ–π,
–æ–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å.</p>
<p><strong>–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª</strong> –ø–æ–∫–∞–∂–µ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å
–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.</p>
<hr />
<h1 data-number="14"
id="—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-ml-—Å–∏—Å—Ç–µ–º–∞-–¥–ª—è-dex"><span
class="header-section-number">14</span> –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è DEX</h1>
<h2 data-number="14.0" id="–ø–æ—á–µ–º—É-—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">14.0</span> –ü–æ—á–µ–º—É —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="14.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">14.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="14.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Å–ª–æ–∂–Ω—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞"><span class="header-section-number">14.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="14.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-1"><span
class="header-section-number">14.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><img src="images/advanced_production_flow.png"
alt="–°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" /> <em>–†–∏—Å—É–Ω–æ–∫ 13.1: –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä
—Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π ML-—Å–∏—Å—Ç–µ–º—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, –∞–Ω—Å–∞–º–±–ª—è–º–∏ –∏
–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º</em></p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–¥—Ö–æ–¥</strong> –∫ —Å–æ–∑–¥–∞–Ω–∏—é
—Ä–æ–±–∞—Å—Ç–Ω–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ–π ML-—Å–∏—Å—Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon - –æ—Ç
—Å–ª–æ–∂–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–æ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏
—Ç–µ—Ö–Ω–∏–∫–∞–º–∏.</p>
<h2 data-number="14.2" id="—à–∞–≥-1-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">14.2</span> –®–∞–≥ 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="14.2.1" id="–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">14.2.1</span> –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h3>
<div class="sourceCode" id="cb230"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedMLSystem:</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è DEX —Ç–æ—Ä–≥–æ–≤–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.models <span class="op">=</span> {</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_direction&#39;</span>: <span class="va">None</span>,      <span class="co"># –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volatility&#39;</span>: <span class="va">None</span>,          <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volume&#39;</span>: <span class="va">None</span>,              <span class="co"># –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sentiment&#39;</span>: <span class="va">None</span>,           <span class="co"># –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä—ã–Ω–∫–∞</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;macro&#39;</span>: <span class="va">None</span>                <span class="co"># –ú–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble <span class="op">=</span> <span class="va">None</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> RiskManager()</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.portfolio_manager <span class="op">=</span> PortfolioManager()</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitoring <span class="op">=</span> AdvancedMonitoring()</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> initialize_system(<span class="va">self</span>):</span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h2 data-number="14.3" id="—à–∞–≥-2-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">14.3</span> –®–∞–≥ 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
–¥–∞–Ω–Ω—ã—Ö</h2>
<div class="sourceCode" id="cb231"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> talib</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ccxt</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textblob <span class="im">import</span> TextBlob</span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newsapi</span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedDataProcessor:</span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exchanges <span class="op">=</span> {</span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;binance&#39;</span>: ccxt.binance(),</span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;coinbase&#39;</span>: ccxt.coinbasepro(),</span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;kraken&#39;</span>: ccxt.kraken()</span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.news_api <span class="op">=</span> newsapi.NewsApiClient(api_key<span class="op">=</span><span class="st">&#39;YOUR_API_KEY&#39;</span>)</span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_multi_source_data(<span class="va">self</span>, symbols, timeframe<span class="op">=</span><span class="st">&#39;1h&#39;</span>, days<span class="op">=</span><span class="dv">365</span>):</span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a>        all_data <span class="op">=</span> {}</span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-28"><a href="#cb231-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> symbol <span class="kw">in</span> symbols:</span>
<span id="cb231-29"><a href="#cb231-29" aria-hidden="true" tabindex="-1"></a>            symbol_data <span class="op">=</span> {}</span>
<span id="cb231-30"><a href="#cb231-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-31"><a href="#cb231-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. –¶–µ–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã—Ö –±–∏—Ä–∂</span></span>
<span id="cb231-32"><a href="#cb231-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> exchange_name, exchange <span class="kw">in</span> <span class="va">self</span>.exchanges.items():</span>
<span id="cb231-33"><a href="#cb231-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb231-34"><a href="#cb231-34" aria-hidden="true" tabindex="-1"></a>                    ohlcv <span class="op">=</span> exchange.fetch_ohlcv(symbol, timeframe, limit<span class="op">=</span>days<span class="op">*</span><span class="dv">24</span>)</span>
<span id="cb231-35"><a href="#cb231-35" aria-hidden="true" tabindex="-1"></a>                    df <span class="op">=</span> pd.DataFrame(ohlcv, columns<span class="op">=</span>[<span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;open&#39;</span>, <span class="st">&#39;high&#39;</span>, <span class="st">&#39;low&#39;</span>, <span class="st">&#39;close&#39;</span>, <span class="st">&#39;volume&#39;</span>])</span>
<span id="cb231-36"><a href="#cb231-36" aria-hidden="true" tabindex="-1"></a>                    df[<span class="st">&#39;timestamp&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;timestamp&#39;</span>], unit<span class="op">=</span><span class="st">&#39;ms&#39;</span>)</span>
<span id="cb231-37"><a href="#cb231-37" aria-hidden="true" tabindex="-1"></a>                    symbol_data[<span class="ss">f&#39;</span><span class="sc">{</span>exchange_name<span class="sc">}</span><span class="ss">_price&#39;</span>] <span class="op">=</span> df</span>
<span id="cb231-38"><a href="#cb231-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb231-39"><a href="#cb231-39" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å </span><span class="sc">{</span>exchange_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb231-40"><a href="#cb231-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-41"><a href="#cb231-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb231-42"><a href="#cb231-42" aria-hidden="true" tabindex="-1"></a>            symbol_data[<span class="st">&#39;technical&#39;</span>] <span class="op">=</span> <span class="va">self</span>._calculate_advanced_indicators(symbol_data[<span class="st">&#39;binance_price&#39;</span>])</span>
<span id="cb231-43"><a href="#cb231-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-44"><a href="#cb231-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 3. –ù–æ–≤–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</span></span>
<span id="cb231-45"><a href="#cb231-45" aria-hidden="true" tabindex="-1"></a>            symbol_data[<span class="st">&#39;sentiment&#39;</span>] <span class="op">=</span> <span class="va">self</span>._collect_sentiment_data(symbol)</span>
<span id="cb231-46"><a href="#cb231-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-47"><a href="#cb231-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 4. –ú–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</span></span>
<span id="cb231-48"><a href="#cb231-48" aria-hidden="true" tabindex="-1"></a>            symbol_data[<span class="st">&#39;macro&#39;</span>] <span class="op">=</span> <span class="va">self</span>._collect_macro_data()</span>
<span id="cb231-49"><a href="#cb231-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-50"><a href="#cb231-50" aria-hidden="true" tabindex="-1"></a>            all_data[symbol] <span class="op">=</span> symbol_data</span>
<span id="cb231-51"><a href="#cb231-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-52"><a href="#cb231-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_data</span>
<span id="cb231-53"><a href="#cb231-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-54"><a href="#cb231-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _calculate_advanced_indicators(<span class="va">self</span>, price_data):</span>
<span id="cb231-55"><a href="#cb231-55" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb231-56"><a href="#cb231-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-57"><a href="#cb231-57" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> price_data.copy()</span>
<span id="cb231-58"><a href="#cb231-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-59"><a href="#cb231-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb231-60"><a href="#cb231-60" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_20&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb231-61"><a href="#cb231-61" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_50&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb231-62"><a href="#cb231-62" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_200&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb231-63"><a href="#cb231-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-64"><a href="#cb231-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã</span></span>
<span id="cb231-65"><a href="#cb231-65" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;RSI&#39;</span>] <span class="op">=</span> talib.RSI(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb231-66"><a href="#cb231-66" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;STOCH_K&#39;</span>], df[<span class="st">&#39;STOCH_D&#39;</span>] <span class="op">=</span> talib.STOCH(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-67"><a href="#cb231-67" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;WILLR&#39;</span>] <span class="op">=</span> talib.WILLR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-68"><a href="#cb231-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-69"><a href="#cb231-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢—Ä–µ–Ω–¥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb231-70"><a href="#cb231-70" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;MACD&#39;</span>], df[<span class="st">&#39;MACD_signal&#39;</span>], df[<span class="st">&#39;MACD_hist&#39;</span>] <span class="op">=</span> talib.MACD(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-71"><a href="#cb231-71" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ADX&#39;</span>] <span class="op">=</span> talib.ADX(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-72"><a href="#cb231-72" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;AROON_UP&#39;</span>], df[<span class="st">&#39;AROON_DOWN&#39;</span>] <span class="op">=</span> talib.AROON(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>])</span>
<span id="cb231-73"><a href="#cb231-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-74"><a href="#cb231-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–º–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb231-75"><a href="#cb231-75" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;OBV&#39;</span>] <span class="op">=</span> talib.OBV(df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb231-76"><a href="#cb231-76" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;AD&#39;</span>] <span class="op">=</span> talib.AD(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb231-77"><a href="#cb231-77" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ADOSC&#39;</span>] <span class="op">=</span> talib.ADOSC(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb231-78"><a href="#cb231-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-79"><a href="#cb231-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb231-80"><a href="#cb231-80" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ATR&#39;</span>] <span class="op">=</span> talib.ATR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-81"><a href="#cb231-81" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;NATR&#39;</span>] <span class="op">=</span> talib.NATR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-82"><a href="#cb231-82" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;TRANGE&#39;</span>] <span class="op">=</span> talib.TRANGE(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-83"><a href="#cb231-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-84"><a href="#cb231-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bollinger Bands</span></span>
<span id="cb231-85"><a href="#cb231-85" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_upper&#39;</span>], df[<span class="st">&#39;BB_middle&#39;</span>], df[<span class="st">&#39;BB_lower&#39;</span>] <span class="op">=</span> talib.BBANDS(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-86"><a href="#cb231-86" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_width&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;BB_upper&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>]) <span class="op">/</span> df[<span class="st">&#39;BB_middle&#39;</span>]</span>
<span id="cb231-87"><a href="#cb231-87" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_position&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>]) <span class="op">/</span> (df[<span class="st">&#39;BB_upper&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>])</span>
<span id="cb231-88"><a href="#cb231-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-89"><a href="#cb231-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Momentum</span></span>
<span id="cb231-90"><a href="#cb231-90" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;MOM&#39;</span>] <span class="op">=</span> talib.MOM(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb231-91"><a href="#cb231-91" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ROC&#39;</span>] <span class="op">=</span> talib.ROC(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb231-92"><a href="#cb231-92" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;PPO&#39;</span>] <span class="op">=</span> talib.PPO(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-93"><a href="#cb231-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-94"><a href="#cb231-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Price patterns</span></span>
<span id="cb231-95"><a href="#cb231-95" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;DOJI&#39;</span>] <span class="op">=</span> talib.CDLDOJI(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-96"><a href="#cb231-96" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;HAMMER&#39;</span>] <span class="op">=</span> talib.CDLHAMMER(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-97"><a href="#cb231-97" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ENGULFING&#39;</span>] <span class="op">=</span> talib.CDLENGULFING(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb231-98"><a href="#cb231-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-99"><a href="#cb231-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb231-100"><a href="#cb231-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-101"><a href="#cb231-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _collect_sentiment_data(<span class="va">self</span>, symbol):</span>
<span id="cb231-102"><a href="#cb231-102" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è—Ö —Ä—ã–Ω–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb231-103"><a href="#cb231-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-104"><a href="#cb231-104" aria-hidden="true" tabindex="-1"></a>        sentiment_data <span class="op">=</span> []</span>
<span id="cb231-105"><a href="#cb231-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-106"><a href="#cb231-106" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ–≤–æ—Å—Ç–∏</span></span>
<span id="cb231-107"><a href="#cb231-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb231-108"><a href="#cb231-108" aria-hidden="true" tabindex="-1"></a>            news <span class="op">=</span> <span class="va">self</span>.news_api.get_everything(</span>
<span id="cb231-109"><a href="#cb231-109" aria-hidden="true" tabindex="-1"></a>                q<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss"> cryptocurrency&#39;</span>,</span>
<span id="cb231-110"><a href="#cb231-110" aria-hidden="true" tabindex="-1"></a>                from_param<span class="op">=</span>(datetime.now() <span class="op">-</span> timedelta(days<span class="op">=</span><span class="dv">7</span>)).isoformat(),</span>
<span id="cb231-111"><a href="#cb231-111" aria-hidden="true" tabindex="-1"></a>                to<span class="op">=</span>datetime.now().isoformat(),</span>
<span id="cb231-112"><a href="#cb231-112" aria-hidden="true" tabindex="-1"></a>                language<span class="op">=</span><span class="st">&#39;en&#39;</span>,</span>
<span id="cb231-113"><a href="#cb231-113" aria-hidden="true" tabindex="-1"></a>                sort_by<span class="op">=</span><span class="st">&#39;publishedAt&#39;</span></span>
<span id="cb231-114"><a href="#cb231-114" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb231-115"><a href="#cb231-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb231-116"><a href="#cb231-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> article <span class="kw">in</span> news[<span class="st">&#39;articles&#39;</span>]:</span>
<span id="cb231-117"><a href="#cb231-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb231-118"><a href="#cb231-118" aria-hidden="true" tabindex="-1"></a>                blob <span class="op">=</span> TextBlob(article[<span class="st">&#39;title&#39;</span>] <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> article[<span class="st">&#39;description&#39;</span>])</span>
<span id="cb231-119"><a href="#cb231-119" aria-hidden="true" tabindex="-1"></a>                sentiment_score <span class="op">=</span> blob.sentiment.polarity</span>
<span id="cb231-120"><a href="#cb231-120" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb231-121"><a href="#cb231-121" aria-hidden="true" tabindex="-1"></a>                sentiment_data.append({</span>
<span id="cb231-122"><a href="#cb231-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: article[<span class="st">&#39;publishedAt&#39;</span>],</span>
<span id="cb231-123"><a href="#cb231-123" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: article[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb231-124"><a href="#cb231-124" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;sentiment&#39;</span>: sentiment_score,</span>
<span id="cb231-125"><a href="#cb231-125" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;source&#39;</span>: article[<span class="st">&#39;source&#39;</span>][<span class="st">&#39;name&#39;</span>]</span>
<span id="cb231-126"><a href="#cb231-126" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb231-127"><a href="#cb231-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb231-128"><a href="#cb231-128" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb231-129"><a href="#cb231-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-130"><a href="#cb231-130" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ (–ø—Ä–∏–º–µ—Ä —Å Twitter API)</span></span>
<span id="cb231-131"><a href="#cb231-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sentiment_data.extend(self._get_twitter_sentiment(symbol))</span></span>
<span id="cb231-132"><a href="#cb231-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-133"><a href="#cb231-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame(sentiment_data)</span>
<span id="cb231-134"><a href="#cb231-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb231-135"><a href="#cb231-135" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _collect_macro_data(<span class="va">self</span>):</span>
<span id="cb231-136"><a href="#cb231-136" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb231-137"><a href="#cb231-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-138"><a href="#cb231-138" aria-hidden="true" tabindex="-1"></a>        macro_data <span class="op">=</span> {}</span>
<span id="cb231-139"><a href="#cb231-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-140"><a href="#cb231-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb231-141"><a href="#cb231-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb231-142"><a href="#cb231-142" aria-hidden="true" tabindex="-1"></a>            fear_greed <span class="op">=</span> requests.get(<span class="st">&#39;https://api.alternative.me/fng/&#39;</span>).json()</span>
<span id="cb231-143"><a href="#cb231-143" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;fear_greed&#39;</span>] <span class="op">=</span> fear_greed[<span class="st">&#39;data&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;value&#39;</span>]</span>
<span id="cb231-144"><a href="#cb231-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb231-145"><a href="#cb231-145" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;fear_greed&#39;</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb231-146"><a href="#cb231-146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-147"><a href="#cb231-147" aria-hidden="true" tabindex="-1"></a>        <span class="co"># DXY (Dollar Index)</span></span>
<span id="cb231-148"><a href="#cb231-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb231-149"><a href="#cb231-149" aria-hidden="true" tabindex="-1"></a>            dxy <span class="op">=</span> yf.download(<span class="st">&#39;DX-Y.NYB&#39;</span>, period<span class="op">=</span><span class="st">&#39;1y&#39;</span>)[<span class="st">&#39;Close&#39;</span>]</span>
<span id="cb231-150"><a href="#cb231-150" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;dxy&#39;</span>] <span class="op">=</span> dxy.iloc[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb231-151"><a href="#cb231-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb231-152"><a href="#cb231-152" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;dxy&#39;</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb231-153"><a href="#cb231-153" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-154"><a href="#cb231-154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># VIX (Volatility Index)</span></span>
<span id="cb231-155"><a href="#cb231-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb231-156"><a href="#cb231-156" aria-hidden="true" tabindex="-1"></a>            vix <span class="op">=</span> yf.download(<span class="st">&#39;^VIX&#39;</span>, period<span class="op">=</span><span class="st">&#39;1y&#39;</span>)[<span class="st">&#39;Close&#39;</span>]</span>
<span id="cb231-157"><a href="#cb231-157" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;vix&#39;</span>] <span class="op">=</span> vix.iloc[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb231-158"><a href="#cb231-158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb231-159"><a href="#cb231-159" aria-hidden="true" tabindex="-1"></a>            macro_data[<span class="st">&#39;vix&#39;</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb231-160"><a href="#cb231-160" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb231-161"><a href="#cb231-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> macro_data</span></code></pre></div>
<h2 data-number="14.4" id="—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">14.4</span> –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö
–º–æ–¥–µ–ª–µ–π</h2>
<div class="sourceCode" id="cb232"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MultiModelSystem:</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.models <span class="op">=</span> {}</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_weights <span class="op">=</span> {}</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_price_direction_model(<span class="va">self</span>, data):</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã&quot;&quot;&quot;</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>._prepare_price_features(data)</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> (data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a>        predictor.fit(</span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a>            features,</span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a>            num_bag_folds<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a>            num_bag_sets<span class="op">=</span><span class="dv">2</span></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-29"><a href="#cb232-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-30"><a href="#cb232-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb232-31"><a href="#cb232-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-32"><a href="#cb232-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_volatility_model(<span class="va">self</span>, data):</span>
<span id="cb232-33"><a href="#cb232-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb232-34"><a href="#cb232-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-35"><a href="#cb232-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb232-36"><a href="#cb232-36" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;volatility&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb232-37"><a href="#cb232-37" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;volatility_target&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;volatility&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> data[<span class="st">&#39;volatility&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb232-38"><a href="#cb232-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-39"><a href="#cb232-39" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>._prepare_volatility_features(data)</span>
<span id="cb232-40"><a href="#cb232-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-41"><a href="#cb232-41" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb232-42"><a href="#cb232-42" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;volatility_target&#39;</span>,</span>
<span id="cb232-43"><a href="#cb232-43" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb232-44"><a href="#cb232-44" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb232-45"><a href="#cb232-45" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-46"><a href="#cb232-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-47"><a href="#cb232-47" aria-hidden="true" tabindex="-1"></a>        predictor.fit(</span>
<span id="cb232-48"><a href="#cb232-48" aria-hidden="true" tabindex="-1"></a>            features,</span>
<span id="cb232-49"><a href="#cb232-49" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb232-50"><a href="#cb232-50" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span></span>
<span id="cb232-51"><a href="#cb232-51" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-52"><a href="#cb232-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-53"><a href="#cb232-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb232-54"><a href="#cb232-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-55"><a href="#cb232-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_volume_model(<span class="va">self</span>, data):</span>
<span id="cb232-56"><a href="#cb232-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ–±—ä–µ–º–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb232-57"><a href="#cb232-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-58"><a href="#cb232-58" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;volume_target&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;volume&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> data[<span class="st">&#39;volume&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb232-59"><a href="#cb232-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-60"><a href="#cb232-60" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>._prepare_volume_features(data)</span>
<span id="cb232-61"><a href="#cb232-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-62"><a href="#cb232-62" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb232-63"><a href="#cb232-63" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;volume_target&#39;</span>,</span>
<span id="cb232-64"><a href="#cb232-64" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb232-65"><a href="#cb232-65" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb232-66"><a href="#cb232-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-67"><a href="#cb232-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-68"><a href="#cb232-68" aria-hidden="true" tabindex="-1"></a>        predictor.fit(features, time_limit<span class="op">=</span><span class="dv">600</span>, presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>)</span>
<span id="cb232-69"><a href="#cb232-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-70"><a href="#cb232-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb232-71"><a href="#cb232-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-72"><a href="#cb232-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_sentiment_model(<span class="va">self</span>, data, sentiment_data):</span>
<span id="cb232-73"><a href="#cb232-73" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb232-74"><a href="#cb232-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-75"><a href="#cb232-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb232-76"><a href="#cb232-76" aria-hidden="true" tabindex="-1"></a>        merged_data <span class="op">=</span> <span class="va">self</span>._merge_sentiment_data(data, sentiment_data)</span>
<span id="cb232-77"><a href="#cb232-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-78"><a href="#cb232-78" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>._prepare_sentiment_features(merged_data)</span>
<span id="cb232-79"><a href="#cb232-79" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> (merged_data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> merged_data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb232-80"><a href="#cb232-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-81"><a href="#cb232-81" aria-hidden="true" tabindex="-1"></a>        predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb232-82"><a href="#cb232-82" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb232-83"><a href="#cb232-83" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb232-84"><a href="#cb232-84" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb232-85"><a href="#cb232-85" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-86"><a href="#cb232-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-87"><a href="#cb232-87" aria-hidden="true" tabindex="-1"></a>        predictor.fit(features, time_limit<span class="op">=</span><span class="dv">600</span>, presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>)</span>
<span id="cb232-88"><a href="#cb232-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-89"><a href="#cb232-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictor</span>
<span id="cb232-90"><a href="#cb232-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-91"><a href="#cb232-91" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_ensemble_model(<span class="va">self</span>, models, data):</span>
<span id="cb232-92"><a href="#cb232-92" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb232-93"><a href="#cb232-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-94"><a href="#cb232-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb232-95"><a href="#cb232-95" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> {}</span>
<span id="cb232-96"><a href="#cb232-96" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> {}</span>
<span id="cb232-97"><a href="#cb232-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-98"><a href="#cb232-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb232-99"><a href="#cb232-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb232-100"><a href="#cb232-100" aria-hidden="true" tabindex="-1"></a>                features <span class="op">=</span> <span class="va">self</span>._prepare_features_for_model(name, data)</span>
<span id="cb232-101"><a href="#cb232-101" aria-hidden="true" tabindex="-1"></a>                predictions[name] <span class="op">=</span> model.predict(features)</span>
<span id="cb232-102"><a href="#cb232-102" aria-hidden="true" tabindex="-1"></a>                probabilities[name] <span class="op">=</span> model.predict_proba(features)</span>
<span id="cb232-103"><a href="#cb232-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-104"><a href="#cb232-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span></span>
<span id="cb232-105"><a href="#cb232-105" aria-hidden="true" tabindex="-1"></a>        meta_features <span class="op">=</span> pd.DataFrame(probabilities)</span>
<span id="cb232-106"><a href="#cb232-106" aria-hidden="true" tabindex="-1"></a>        meta_target <span class="op">=</span> (data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb232-107"><a href="#cb232-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-108"><a href="#cb232-108" aria-hidden="true" tabindex="-1"></a>        ensemble_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb232-109"><a href="#cb232-109" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb232-110"><a href="#cb232-110" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb232-111"><a href="#cb232-111" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span></span>
<span id="cb232-112"><a href="#cb232-112" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-113"><a href="#cb232-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-114"><a href="#cb232-114" aria-hidden="true" tabindex="-1"></a>        ensemble_predictor.fit(</span>
<span id="cb232-115"><a href="#cb232-115" aria-hidden="true" tabindex="-1"></a>            meta_features,</span>
<span id="cb232-116"><a href="#cb232-116" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb232-117"><a href="#cb232-117" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;medium_quality_faster_train&#39;</span></span>
<span id="cb232-118"><a href="#cb232-118" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb232-119"><a href="#cb232-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb232-120"><a href="#cb232-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_predictor</span></code></pre></div>
<h2 data-number="14.5" id="—à–∞–≥-4-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">14.5</span> –®–∞–≥ 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<div class="sourceCode" id="cb233"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedValidation:</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.validation_results <span class="op">=</span> {}</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> comprehensive_backtest(<span class="va">self</span>, models, data, start_date, end_date):</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π backtest —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> (data.index <span class="op">&gt;=</span> start_date) <span class="op">&amp;</span> (data.index <span class="op">&lt;=</span> end_date)</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data[mask]</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> {}</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>                features <span class="op">=</span> <span class="va">self</span>._prepare_features_for_model(name, test_data)</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>                predictions <span class="op">=</span> model.predict(features)</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>                probabilities <span class="op">=</span> model.predict_proba(features)</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>                accuracy <span class="op">=</span> (predictions <span class="op">==</span> test_data[<span class="st">&#39;target&#39;</span>]).mean()</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</span></span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>                strategy_returns <span class="op">=</span> <span class="va">self</span>._calculate_strategy_returns(</span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>                    test_data, predictions, probabilities</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>                sharpe_ratio <span class="op">=</span> <span class="va">self</span>._calculate_sharpe_ratio(strategy_returns)</span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>                max_drawdown <span class="op">=</span> <span class="va">self</span>._calculate_max_drawdown(strategy_returns)</span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a>                var_95 <span class="op">=</span> <span class="va">self</span>._calculate_var(strategy_returns, <span class="fl">0.95</span>)</span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a>                results[name] <span class="op">=</span> {</span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;accuracy&#39;</span>: accuracy,</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;max_drawdown&#39;</span>: max_drawdown,</span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;var_95&#39;</span>: var_95,</span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;total_return&#39;</span>: strategy_returns.<span class="bu">sum</span>(),</span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;win_rate&#39;</span>: (strategy_returns <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb233-43"><a href="#cb233-43" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb233-44"><a href="#cb233-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-45"><a href="#cb233-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb233-46"><a href="#cb233-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb233-47"><a href="#cb233-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advanced_walk_forward(<span class="va">self</span>, models, data, window_size<span class="op">=</span><span class="dv">252</span>, step_size<span class="op">=</span><span class="dv">30</span>, min_train_size<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb233-48"><a href="#cb233-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb233-49"><a href="#cb233-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-50"><a href="#cb233-50" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> []</span>
<span id="cb233-51"><a href="#cb233-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-52"><a href="#cb233-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(min_train_size, <span class="bu">len</span>(data) <span class="op">-</span> window_size, step_size):</span>
<span id="cb233-53"><a href="#cb233-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ</span></span>
<span id="cb233-54"><a href="#cb233-54" aria-hidden="true" tabindex="-1"></a>            train_data <span class="op">=</span> data.iloc[i<span class="op">-</span>min_train_size:i]</span>
<span id="cb233-55"><a href="#cb233-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-56"><a href="#cb233-56" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</span></span>
<span id="cb233-57"><a href="#cb233-57" aria-hidden="true" tabindex="-1"></a>            test_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>window_size]</span>
<span id="cb233-58"><a href="#cb233-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-59"><a href="#cb233-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb233-60"><a href="#cb233-60" aria-hidden="true" tabindex="-1"></a>            retrained_models <span class="op">=</span> {}</span>
<span id="cb233-61"><a href="#cb233-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb233-62"><a href="#cb233-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb233-63"><a href="#cb233-63" aria-hidden="true" tabindex="-1"></a>                    retrained_models[name] <span class="op">=</span> <span class="va">self</span>._retrain_model(</span>
<span id="cb233-64"><a href="#cb233-64" aria-hidden="true" tabindex="-1"></a>                        model, train_data, name</span>
<span id="cb233-65"><a href="#cb233-65" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb233-66"><a href="#cb233-66" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-67"><a href="#cb233-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb233-68"><a href="#cb233-68" aria-hidden="true" tabindex="-1"></a>            test_results <span class="op">=</span> <span class="va">self</span>.comprehensive_backtest(</span>
<span id="cb233-69"><a href="#cb233-69" aria-hidden="true" tabindex="-1"></a>                retrained_models, test_data, </span>
<span id="cb233-70"><a href="#cb233-70" aria-hidden="true" tabindex="-1"></a>                test_data.index[<span class="dv">0</span>], test_data.index[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb233-71"><a href="#cb233-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb233-72"><a href="#cb233-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-73"><a href="#cb233-73" aria-hidden="true" tabindex="-1"></a>            results.append({</span>
<span id="cb233-74"><a href="#cb233-74" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;period&#39;</span>: i,</span>
<span id="cb233-75"><a href="#cb233-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;train_size&#39;</span>: <span class="bu">len</span>(train_data),</span>
<span id="cb233-76"><a href="#cb233-76" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;test_size&#39;</span>: <span class="bu">len</span>(test_data),</span>
<span id="cb233-77"><a href="#cb233-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;results&#39;</span>: test_results</span>
<span id="cb233-78"><a href="#cb233-78" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb233-79"><a href="#cb233-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-80"><a href="#cb233-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb233-81"><a href="#cb233-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb233-82"><a href="#cb233-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monte_carlo_simulation(<span class="va">self</span>, models, data, n_simulations<span class="op">=</span><span class="dv">1000</span>, confidence_level<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb233-83"><a href="#cb233-83" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb233-84"><a href="#cb233-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-85"><a href="#cb233-85" aria-hidden="true" tabindex="-1"></a>        simulation_results <span class="op">=</span> []</span>
<span id="cb233-86"><a href="#cb233-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-87"><a href="#cb233-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb233-88"><a href="#cb233-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ë—É—Ç—Å—Ç—Ä–∞–ø –≤—ã–±–æ—Ä–∫–∞</span></span>
<span id="cb233-89"><a href="#cb233-89" aria-hidden="true" tabindex="-1"></a>            bootstrap_data <span class="op">=</span> data.sample(n<span class="op">=</span><span class="bu">len</span>(data), replace<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span>i)</span>
<span id="cb233-90"><a href="#cb233-90" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-91"><a href="#cb233-91" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb233-92"><a href="#cb233-92" aria-hidden="true" tabindex="-1"></a>            split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(bootstrap_data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb233-93"><a href="#cb233-93" aria-hidden="true" tabindex="-1"></a>            train_data <span class="op">=</span> bootstrap_data.iloc[:split_idx]</span>
<span id="cb233-94"><a href="#cb233-94" aria-hidden="true" tabindex="-1"></a>            test_data <span class="op">=</span> bootstrap_data.iloc[split_idx:]</span>
<span id="cb233-95"><a href="#cb233-95" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-96"><a href="#cb233-96" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb233-97"><a href="#cb233-97" aria-hidden="true" tabindex="-1"></a>            trained_models <span class="op">=</span> {}</span>
<span id="cb233-98"><a href="#cb233-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb233-99"><a href="#cb233-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb233-100"><a href="#cb233-100" aria-hidden="true" tabindex="-1"></a>                    trained_models[name] <span class="op">=</span> <span class="va">self</span>._train_model_on_data(</span>
<span id="cb233-101"><a href="#cb233-101" aria-hidden="true" tabindex="-1"></a>                        model, train_data, name</span>
<span id="cb233-102"><a href="#cb233-102" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb233-103"><a href="#cb233-103" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-104"><a href="#cb233-104" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb233-105"><a href="#cb233-105" aria-hidden="true" tabindex="-1"></a>            test_results <span class="op">=</span> <span class="va">self</span>.comprehensive_backtest(</span>
<span id="cb233-106"><a href="#cb233-106" aria-hidden="true" tabindex="-1"></a>                trained_models, test_data,</span>
<span id="cb233-107"><a href="#cb233-107" aria-hidden="true" tabindex="-1"></a>                test_data.index[<span class="dv">0</span>], test_data.index[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb233-108"><a href="#cb233-108" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb233-109"><a href="#cb233-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb233-110"><a href="#cb233-110" aria-hidden="true" tabindex="-1"></a>            simulation_results.append(test_results)</span>
<span id="cb233-111"><a href="#cb233-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb233-112"><a href="#cb233-112" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</span></span>
<span id="cb233-113"><a href="#cb233-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._analyze_simulation_results(simulation_results, confidence_level)</span></code></pre></div>
<h2 data-number="14.6" id="—à–∞–≥-5-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"><span
class="header-section-number">14.6</span> –®–∞–≥ 5: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h2>
<div class="sourceCode" id="cb234"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedRiskManager:</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç&quot;&quot;&quot;</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position_sizes <span class="op">=</span> {}</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.stop_losses <span class="op">=</span> {}</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.take_profits <span class="op">=</span> {}</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_drawdown <span class="op">=</span> <span class="fl">0.15</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.var_limit <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_position_size(<span class="va">self</span>, prediction, confidence, account_balance, volatility):</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (Kelly Criterion)</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>        win_rate <span class="op">=</span> confidence</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>        avg_win <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># –°—Ä–µ–¥–Ω–∏–π –≤—ã–∏–≥—Ä—ã—à</span></span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>        avg_loss <span class="op">=</span> <span class="fl">0.01</span>  <span class="co"># –°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–∏–≥—Ä—ã—à</span></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>        kelly_fraction <span class="op">=</span> (win_rate <span class="op">*</span> avg_win <span class="op">-</span> (<span class="dv">1</span> <span class="op">-</span> win_rate) <span class="op">*</span> avg_loss) <span class="op">/</span> avg_win</span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Kelly</span></span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a>        kelly_fraction <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, <span class="bu">min</span>(kelly_fraction, <span class="fl">0.25</span>))</span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-24"><a href="#cb234-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb234-25"><a href="#cb234-25" aria-hidden="true" tabindex="-1"></a>        volatility_adjustment <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> volatility <span class="op">*</span> <span class="dv">10</span>)</span>
<span id="cb234-26"><a href="#cb234-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-27"><a href="#cb234-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb234-28"><a href="#cb234-28" aria-hidden="true" tabindex="-1"></a>        position_size <span class="op">=</span> account_balance <span class="op">*</span> kelly_fraction <span class="op">*</span> volatility_adjustment</span>
<span id="cb234-29"><a href="#cb234-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-30"><a href="#cb234-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> position_size</span>
<span id="cb234-31"><a href="#cb234-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb234-32"><a href="#cb234-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dynamic_stop_loss(<span class="va">self</span>, entry_price, prediction, volatility, atr):</span>
<span id="cb234-33"><a href="#cb234-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å&quot;&quot;&quot;</span></span>
<span id="cb234-34"><a href="#cb234-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-35"><a href="#cb234-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prediction <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># –î–ª–∏–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è</span></span>
<span id="cb234-36"><a href="#cb234-36" aria-hidden="true" tabindex="-1"></a>            stop_loss <span class="op">=</span> entry_price <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> atr <span class="op">/</span> entry_price)</span>
<span id="cb234-37"><a href="#cb234-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># –ö–æ—Ä–æ—Ç–∫–∞—è –ø–æ–∑–∏—Ü–∏—è</span></span>
<span id="cb234-38"><a href="#cb234-38" aria-hidden="true" tabindex="-1"></a>            stop_loss <span class="op">=</span> entry_price <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> atr <span class="op">/</span> entry_price)</span>
<span id="cb234-39"><a href="#cb234-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-40"><a href="#cb234-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stop_loss</span>
<span id="cb234-41"><a href="#cb234-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb234-42"><a href="#cb234-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> portfolio_optimization(<span class="va">self</span>, predictions, correlations, expected_returns):</span>
<span id="cb234-43"><a href="#cb234-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb234-44"><a href="#cb234-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-45"><a href="#cb234-45" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb234-46"><a href="#cb234-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-47"><a href="#cb234-47" aria-hidden="true" tabindex="-1"></a>        n_assets <span class="op">=</span> <span class="bu">len</span>(predictions)</span>
<span id="cb234-48"><a href="#cb234-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-49"><a href="#cb234-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</span></span>
<span id="cb234-50"><a href="#cb234-50" aria-hidden="true" tabindex="-1"></a>        constraints <span class="op">=</span> [</span>
<span id="cb234-51"><a href="#cb234-51" aria-hidden="true" tabindex="-1"></a>            {<span class="st">&#39;type&#39;</span>: <span class="st">&#39;eq&#39;</span>, <span class="st">&#39;fun&#39;</span>: <span class="kw">lambda</span> x: np.<span class="bu">sum</span>(x) <span class="op">-</span> <span class="dv">1</span>}  <span class="co"># –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1</span></span>
<span id="cb234-52"><a href="#cb234-52" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb234-53"><a href="#cb234-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-54"><a href="#cb234-54" aria-hidden="true" tabindex="-1"></a>        bounds <span class="op">=</span> [(<span class="dv">0</span>, <span class="fl">0.3</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_assets)]  <span class="co"># –ú–∞–∫—Å–∏–º—É–º 30% –≤ –æ–¥–∏–Ω –∞–∫—Ç–∏–≤</span></span>
<span id="cb234-55"><a href="#cb234-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-56"><a href="#cb234-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è Sharpe ratio)</span></span>
<span id="cb234-57"><a href="#cb234-57" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> objective(weights):</span>
<span id="cb234-58"><a href="#cb234-58" aria-hidden="true" tabindex="-1"></a>            portfolio_return <span class="op">=</span> np.<span class="bu">sum</span>(weights <span class="op">*</span> expected_returns)</span>
<span id="cb234-59"><a href="#cb234-59" aria-hidden="true" tabindex="-1"></a>            portfolio_volatility <span class="op">=</span> np.sqrt(np.dot(weights.T, np.dot(correlations, weights)))</span>
<span id="cb234-60"><a href="#cb234-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span>(portfolio_return <span class="op">/</span> portfolio_volatility)  <span class="co"># –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ Sharpe</span></span>
<span id="cb234-61"><a href="#cb234-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-62"><a href="#cb234-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb234-63"><a href="#cb234-63" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> minimize(</span>
<span id="cb234-64"><a href="#cb234-64" aria-hidden="true" tabindex="-1"></a>            objective, </span>
<span id="cb234-65"><a href="#cb234-65" aria-hidden="true" tabindex="-1"></a>            x0<span class="op">=</span>np.ones(n_assets) <span class="op">/</span> n_assets,</span>
<span id="cb234-66"><a href="#cb234-66" aria-hidden="true" tabindex="-1"></a>            method<span class="op">=</span><span class="st">&#39;SLSQP&#39;</span>,</span>
<span id="cb234-67"><a href="#cb234-67" aria-hidden="true" tabindex="-1"></a>            bounds<span class="op">=</span>bounds,</span>
<span id="cb234-68"><a href="#cb234-68" aria-hidden="true" tabindex="-1"></a>            constraints<span class="op">=</span>constraints</span>
<span id="cb234-69"><a href="#cb234-69" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb234-70"><a href="#cb234-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb234-71"><a href="#cb234-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result.x</span></code></pre></div>
<h2 data-number="14.7" id="—à–∞–≥-6-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"><span
class="header-section-number">14.7</span> –®–∞–≥ 6: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h2>
<div class="sourceCode" id="cb235"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># api_gateway.py</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> APIGateway:</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;API Gateway –¥–ª—è ML —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.services <span class="op">=</span> {</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_service&#39;</span>: <span class="st">&#39;http://data-service:5001&#39;</span>,</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_service&#39;</span>: <span class="st">&#39;http://model-service:5002&#39;</span>,</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk_service&#39;</span>: <span class="st">&#39;http://risk-service:5003&#39;</span>,</span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trading_service&#39;</span>: <span class="st">&#39;http://trading-service:5004&#39;</span>,</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;monitoring_service&#39;</span>: <span class="st">&#39;http://monitoring-service:5005&#39;</span></span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_prediction(<span class="va">self</span>, symbol, timeframe):</span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>        data_response <span class="op">=</span> requests.get(</span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>services[<span class="st">&#39;data_service&#39;</span>]<span class="sc">}</span><span class="ss">/data/</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>timeframe<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data_response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb235-30"><a href="#cb235-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;error&#39;</span>: <span class="st">&#39;Data service unavailable&#39;</span>}, <span class="dv">500</span></span>
<span id="cb235-31"><a href="#cb235-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-32"><a href="#cb235-32" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data_response.json()</span>
<span id="cb235-33"><a href="#cb235-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-34"><a href="#cb235-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb235-35"><a href="#cb235-35" aria-hidden="true" tabindex="-1"></a>        prediction_response <span class="op">=</span> requests.post(</span>
<span id="cb235-36"><a href="#cb235-36" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>services[<span class="st">&#39;model_service&#39;</span>]<span class="sc">}</span><span class="ss">/predict&quot;</span>,</span>
<span id="cb235-37"><a href="#cb235-37" aria-hidden="true" tabindex="-1"></a>            json<span class="op">=</span>data</span>
<span id="cb235-38"><a href="#cb235-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb235-39"><a href="#cb235-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-40"><a href="#cb235-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prediction_response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb235-41"><a href="#cb235-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;error&#39;</span>: <span class="st">&#39;Model service unavailable&#39;</span>}, <span class="dv">500</span></span>
<span id="cb235-42"><a href="#cb235-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-43"><a href="#cb235-43" aria-hidden="true" tabindex="-1"></a>        prediction <span class="op">=</span> prediction_response.json()</span>
<span id="cb235-44"><a href="#cb235-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-45"><a href="#cb235-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞</span></span>
<span id="cb235-46"><a href="#cb235-46" aria-hidden="true" tabindex="-1"></a>        risk_response <span class="op">=</span> requests.post(</span>
<span id="cb235-47"><a href="#cb235-47" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>services[<span class="st">&#39;risk_service&#39;</span>]<span class="sc">}</span><span class="ss">/calculate_risk&quot;</span>,</span>
<span id="cb235-48"><a href="#cb235-48" aria-hidden="true" tabindex="-1"></a>            json<span class="op">=</span>{<span class="op">**</span>data, <span class="op">**</span>prediction}</span>
<span id="cb235-49"><a href="#cb235-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb235-50"><a href="#cb235-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-51"><a href="#cb235-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> risk_response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb235-52"><a href="#cb235-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;error&#39;</span>: <span class="st">&#39;Risk service unavailable&#39;</span>}, <span class="dv">500</span></span>
<span id="cb235-53"><a href="#cb235-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-54"><a href="#cb235-54" aria-hidden="true" tabindex="-1"></a>        risk_data <span class="op">=</span> risk_response.json()</span>
<span id="cb235-55"><a href="#cb235-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-56"><a href="#cb235-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb235-57"><a href="#cb235-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction&#39;</span>: prediction,</span>
<span id="cb235-58"><a href="#cb235-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk&#39;</span>: risk_data,</span>
<span id="cb235-59"><a href="#cb235-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb235-60"><a href="#cb235-60" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb235-61"><a href="#cb235-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-62"><a href="#cb235-62" aria-hidden="true" tabindex="-1"></a><span class="co"># data_service.py</span></span>
<span id="cb235-63"><a href="#cb235-63" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataService:</span>
<span id="cb235-64"><a href="#cb235-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb235-65"><a href="#cb235-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-66"><a href="#cb235-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb235-67"><a href="#cb235-67" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processor <span class="op">=</span> AdvancedDataProcessor()</span>
<span id="cb235-68"><a href="#cb235-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-69"><a href="#cb235-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_data(<span class="va">self</span>, symbol, timeframe):</span>
<span id="cb235-70"><a href="#cb235-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb235-71"><a href="#cb235-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-72"><a href="#cb235-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb235-73"><a href="#cb235-73" aria-hidden="true" tabindex="-1"></a>        raw_data <span class="op">=</span> <span class="va">self</span>.processor.collect_multi_source_data([symbol])</span>
<span id="cb235-74"><a href="#cb235-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-75"><a href="#cb235-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞</span></span>
<span id="cb235-76"><a href="#cb235-76" aria-hidden="true" tabindex="-1"></a>        processed_data <span class="op">=</span> <span class="va">self</span>.processor.process_data(raw_data[symbol])</span>
<span id="cb235-77"><a href="#cb235-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-78"><a href="#cb235-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> processed_data</span>
<span id="cb235-79"><a href="#cb235-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-80"><a href="#cb235-80" aria-hidden="true" tabindex="-1"></a><span class="co"># model_service.py</span></span>
<span id="cb235-81"><a href="#cb235-81" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ModelService:</span>
<span id="cb235-82"><a href="#cb235-82" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb235-83"><a href="#cb235-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-84"><a href="#cb235-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb235-85"><a href="#cb235-85" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.models <span class="op">=</span> {}</span>
<span id="cb235-86"><a href="#cb235-86" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_models()</span>
<span id="cb235-87"><a href="#cb235-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-88"><a href="#cb235-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, data):</span>
<span id="cb235-89"><a href="#cb235-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb235-90"><a href="#cb235-90" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-91"><a href="#cb235-91" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> {}</span>
<span id="cb235-92"><a href="#cb235-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-93"><a href="#cb235-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, model <span class="kw">in</span> <span class="va">self</span>.models.items():</span>
<span id="cb235-94"><a href="#cb235-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb235-95"><a href="#cb235-95" aria-hidden="true" tabindex="-1"></a>                features <span class="op">=</span> <span class="va">self</span>.prepare_features(data, name)</span>
<span id="cb235-96"><a href="#cb235-96" aria-hidden="true" tabindex="-1"></a>                predictions[name] <span class="op">=</span> {</span>
<span id="cb235-97"><a href="#cb235-97" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;prediction&#39;</span>: model.predict(features),</span>
<span id="cb235-98"><a href="#cb235-98" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;probability&#39;</span>: model.predict_proba(features)</span>
<span id="cb235-99"><a href="#cb235-99" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb235-100"><a href="#cb235-100" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-101"><a href="#cb235-101" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω—Å–∞–º–±–ª–µ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb235-102"><a href="#cb235-102" aria-hidden="true" tabindex="-1"></a>        ensemble_prediction <span class="op">=</span> <span class="va">self</span>.ensemble_predict(predictions)</span>
<span id="cb235-103"><a href="#cb235-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-104"><a href="#cb235-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_prediction</span>
<span id="cb235-105"><a href="#cb235-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-106"><a href="#cb235-106" aria-hidden="true" tabindex="-1"></a><span class="co"># risk_service.py</span></span>
<span id="cb235-107"><a href="#cb235-107" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RiskService:</span>
<span id="cb235-108"><a href="#cb235-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb235-109"><a href="#cb235-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-110"><a href="#cb235-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb235-111"><a href="#cb235-111" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> AdvancedRiskManager()</span>
<span id="cb235-112"><a href="#cb235-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-113"><a href="#cb235-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_risk(<span class="va">self</span>, data, prediction):</span>
<span id="cb235-114"><a href="#cb235-114" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb235-115"><a href="#cb235-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-116"><a href="#cb235-116" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb235-117"><a href="#cb235-117" aria-hidden="true" tabindex="-1"></a>        volatility <span class="op">=</span> <span class="va">self</span>.calculate_volatility(data)</span>
<span id="cb235-118"><a href="#cb235-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-119"><a href="#cb235-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># VaR</span></span>
<span id="cb235-120"><a href="#cb235-120" aria-hidden="true" tabindex="-1"></a>        var <span class="op">=</span> <span class="va">self</span>.calculate_var(data)</span>
<span id="cb235-121"><a href="#cb235-121" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-122"><a href="#cb235-122" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</span></span>
<span id="cb235-123"><a href="#cb235-123" aria-hidden="true" tabindex="-1"></a>        max_dd <span class="op">=</span> <span class="va">self</span>.calculate_max_drawdown(data)</span>
<span id="cb235-124"><a href="#cb235-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-125"><a href="#cb235-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb235-126"><a href="#cb235-126" aria-hidden="true" tabindex="-1"></a>        position_size <span class="op">=</span> <span class="va">self</span>.risk_manager.calculate_position_size(</span>
<span id="cb235-127"><a href="#cb235-127" aria-hidden="true" tabindex="-1"></a>            prediction[<span class="st">&#39;prediction&#39;</span>],</span>
<span id="cb235-128"><a href="#cb235-128" aria-hidden="true" tabindex="-1"></a>            prediction[<span class="st">&#39;probability&#39;</span>],</span>
<span id="cb235-129"><a href="#cb235-129" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">&#39;account_balance&#39;</span>],</span>
<span id="cb235-130"><a href="#cb235-130" aria-hidden="true" tabindex="-1"></a>            volatility</span>
<span id="cb235-131"><a href="#cb235-131" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb235-132"><a href="#cb235-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-133"><a href="#cb235-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb235-134"><a href="#cb235-134" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volatility&#39;</span>: volatility,</span>
<span id="cb235-135"><a href="#cb235-135" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;var&#39;</span>: var,</span>
<span id="cb235-136"><a href="#cb235-136" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_drawdown&#39;</span>: max_dd,</span>
<span id="cb235-137"><a href="#cb235-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;position_size&#39;</span>: position_size,</span>
<span id="cb235-138"><a href="#cb235-138" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk_score&#39;</span>: <span class="va">self</span>.calculate_risk_score(volatility, var, max_dd)</span>
<span id="cb235-139"><a href="#cb235-139" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="14.8" id="—à–∞–≥-7-kubernetes-–¥–µ–ø–ª–æ–π"><span
class="header-section-number">14.8</span> –®–∞–≥ 7: Kubernetes –¥–µ–ø–ª–æ–π</h2>
<div class="sourceCode" id="cb236"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kubernetes-deployment.yaml</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> apps/v1</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Deployment</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ml-system</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">replicas</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">matchLabels</span><span class="kw">:</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">app</span><span class="kw">:</span><span class="at"> ml-system</span></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">labels</span><span class="kw">:</span></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">app</span><span class="kw">:</span><span class="at"> ml-system</span></span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">containers</span><span class="kw">:</span></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> api-gateway</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> ml-system/api-gateway:latest</span></span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> REDIS_URL</span></span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;redis://redis-service:6379&quot;</span></span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> DATABASE_URL</span></span>
<span id="cb236-25"><a href="#cb236-25" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;postgresql://user:pass@postgres-service:5432/mldb&quot;</span></span>
<span id="cb236-26"><a href="#cb236-26" aria-hidden="true" tabindex="-1"></a><span class="at">        </span></span>
<span id="cb236-27"><a href="#cb236-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> data-service</span></span>
<span id="cb236-28"><a href="#cb236-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> ml-system/data-service:latest</span></span>
<span id="cb236-29"><a href="#cb236-29" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-30"><a href="#cb236-30" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5001</span></span>
<span id="cb236-31"><a href="#cb236-31" aria-hidden="true" tabindex="-1"></a><span class="at">        </span></span>
<span id="cb236-32"><a href="#cb236-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> model-service</span></span>
<span id="cb236-33"><a href="#cb236-33" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> ml-system/model-service:latest</span></span>
<span id="cb236-34"><a href="#cb236-34" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-35"><a href="#cb236-35" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5002</span></span>
<span id="cb236-36"><a href="#cb236-36" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">resources</span><span class="kw">:</span></span>
<span id="cb236-37"><a href="#cb236-37" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">requests</span><span class="kw">:</span></span>
<span id="cb236-38"><a href="#cb236-38" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;2Gi&quot;</span></span>
<span id="cb236-39"><a href="#cb236-39" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;1000m&quot;</span></span>
<span id="cb236-40"><a href="#cb236-40" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">limits</span><span class="kw">:</span></span>
<span id="cb236-41"><a href="#cb236-41" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">memory</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;4Gi&quot;</span></span>
<span id="cb236-42"><a href="#cb236-42" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">cpu</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;2000m&quot;</span></span>
<span id="cb236-43"><a href="#cb236-43" aria-hidden="true" tabindex="-1"></a><span class="at">        </span></span>
<span id="cb236-44"><a href="#cb236-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> risk-service</span></span>
<span id="cb236-45"><a href="#cb236-45" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> ml-system/risk-service:latest</span></span>
<span id="cb236-46"><a href="#cb236-46" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-47"><a href="#cb236-47" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5003</span></span>
<span id="cb236-48"><a href="#cb236-48" aria-hidden="true" tabindex="-1"></a><span class="at">        </span></span>
<span id="cb236-49"><a href="#cb236-49" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> trading-service</span></span>
<span id="cb236-50"><a href="#cb236-50" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">image</span><span class="kw">:</span><span class="at"> ml-system/trading-service:latest</span></span>
<span id="cb236-51"><a href="#cb236-51" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-52"><a href="#cb236-52" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">containerPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5004</span></span>
<span id="cb236-53"><a href="#cb236-53" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb236-54"><a href="#cb236-54" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> BLOCKCHAIN_RPC</span></span>
<span id="cb236-55"><a href="#cb236-55" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&quot;</span></span>
<span id="cb236-56"><a href="#cb236-56" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> PRIVATE_KEY</span></span>
<span id="cb236-57"><a href="#cb236-57" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">valueFrom</span><span class="kw">:</span></span>
<span id="cb236-58"><a href="#cb236-58" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">secretKeyRef</span><span class="kw">:</span></span>
<span id="cb236-59"><a href="#cb236-59" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">name</span><span class="kw">:</span><span class="at"> blockchain-secrets</span></span>
<span id="cb236-60"><a href="#cb236-60" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">key</span><span class="kw">:</span><span class="at"> private-key</span></span>
<span id="cb236-61"><a href="#cb236-61" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb236-62"><a href="#cb236-62" aria-hidden="true" tabindex="-1"></a><span class="fu">apiVersion</span><span class="kw">:</span><span class="at"> v1</span></span>
<span id="cb236-63"><a href="#cb236-63" aria-hidden="true" tabindex="-1"></a><span class="fu">kind</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb236-64"><a href="#cb236-64" aria-hidden="true" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb236-65"><a href="#cb236-65" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ml-system-service</span></span>
<span id="cb236-66"><a href="#cb236-66" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span><span class="kw">:</span></span>
<span id="cb236-67"><a href="#cb236-67" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">selector</span><span class="kw">:</span></span>
<span id="cb236-68"><a href="#cb236-68" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">app</span><span class="kw">:</span><span class="at"> ml-system</span></span>
<span id="cb236-69"><a href="#cb236-69" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb236-70"><a href="#cb236-70" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> api-gateway</span></span>
<span id="cb236-71"><a href="#cb236-71" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb236-72"><a href="#cb236-72" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5000</span></span>
<span id="cb236-73"><a href="#cb236-73" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> data-service</span></span>
<span id="cb236-74"><a href="#cb236-74" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5001</span></span>
<span id="cb236-75"><a href="#cb236-75" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5001</span></span>
<span id="cb236-76"><a href="#cb236-76" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> model-service</span></span>
<span id="cb236-77"><a href="#cb236-77" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5002</span></span>
<span id="cb236-78"><a href="#cb236-78" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5002</span></span>
<span id="cb236-79"><a href="#cb236-79" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> risk-service</span></span>
<span id="cb236-80"><a href="#cb236-80" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5003</span></span>
<span id="cb236-81"><a href="#cb236-81" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5003</span></span>
<span id="cb236-82"><a href="#cb236-82" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> trading-service</span></span>
<span id="cb236-83"><a href="#cb236-83" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5004</span></span>
<span id="cb236-84"><a href="#cb236-84" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">targetPort</span><span class="kw">:</span><span class="at"> </span><span class="dv">5004</span></span></code></pre></div>
<h2 data-number="14.9" id="—à–∞–≥-8-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"><span
class="header-section-number">14.9</span> –®–∞–≥ 8: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h2>
<div class="sourceCode" id="cb237"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedMonitoring:</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> {}</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alerts <span class="op">=</span> []</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_history <span class="op">=</span> []</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_model_performance(<span class="va">self</span>, model_name, predictions, actuals):</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> (predictions <span class="op">==</span> actuals).mean()</span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</span></span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_history.append({</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now(),</span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model&#39;</span>: model_name,</span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accuracy&#39;</span>: accuracy</span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é</span></span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.performance_history) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a>            recent_accuracy <span class="op">=</span> np.mean([p[<span class="st">&#39;accuracy&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.performance_history[<span class="op">-</span><span class="dv">10</span>:]])</span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a>            historical_accuracy <span class="op">=</span> np.mean([p[<span class="st">&#39;accuracy&#39;</span>] <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.performance_history[:<span class="op">-</span><span class="dv">10</span>]])</span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recent_accuracy <span class="op">&lt;</span> historical_accuracy <span class="op">*</span> <span class="fl">0.9</span>:</span>
<span id="cb237-28"><a href="#cb237-28" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.trigger_alert(<span class="ss">f&quot;Model </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> performance degraded&quot;</span>)</span>
<span id="cb237-29"><a href="#cb237-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-30"><a href="#cb237-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_system_health(<span class="va">self</span>):</span>
<span id="cb237-31"><a href="#cb237-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb237-32"><a href="#cb237-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-33"><a href="#cb237-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤</span></span>
<span id="cb237-34"><a href="#cb237-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> service_name, service_url <span class="kw">in</span> <span class="va">self</span>.services.items():</span>
<span id="cb237-35"><a href="#cb237-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb237-36"><a href="#cb237-36" aria-hidden="true" tabindex="-1"></a>                response <span class="op">=</span> requests.get(<span class="ss">f&quot;</span><span class="sc">{</span>service_url<span class="sc">}</span><span class="ss">/health&quot;</span>, timeout<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb237-37"><a href="#cb237-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb237-38"><a href="#cb237-38" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.trigger_alert(<span class="ss">f&quot;Service </span><span class="sc">{</span>service_name<span class="sc">}</span><span class="ss"> is unhealthy&quot;</span>)</span>
<span id="cb237-39"><a href="#cb237-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb237-40"><a href="#cb237-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.trigger_alert(<span class="ss">f&quot;Service </span><span class="sc">{</span>service_name<span class="sc">}</span><span class="ss"> is unreachable&quot;</span>)</span>
<span id="cb237-41"><a href="#cb237-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-42"><a href="#cb237-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤</span></span>
<span id="cb237-43"><a href="#cb237-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.check_resource_usage()</span>
<span id="cb237-44"><a href="#cb237-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-45"><a href="#cb237-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫</span></span>
<span id="cb237-46"><a href="#cb237-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.check_latency()</span>
<span id="cb237-47"><a href="#cb237-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-48"><a href="#cb237-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> trigger_alert(<span class="va">self</span>, message):</span>
<span id="cb237-49"><a href="#cb237-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb237-50"><a href="#cb237-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-51"><a href="#cb237-51" aria-hidden="true" tabindex="-1"></a>        alert <span class="op">=</span> {</span>
<span id="cb237-52"><a href="#cb237-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now(),</span>
<span id="cb237-53"><a href="#cb237-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: message,</span>
<span id="cb237-54"><a href="#cb237-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;severity&#39;</span>: <span class="st">&#39;high&#39;</span></span>
<span id="cb237-55"><a href="#cb237-55" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb237-56"><a href="#cb237-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-57"><a href="#cb237-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alerts.append(alert)</span>
<span id="cb237-58"><a href="#cb237-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-59"><a href="#cb237-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></span>
<span id="cb237-60"><a href="#cb237-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.send_notification(alert)</span>
<span id="cb237-61"><a href="#cb237-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-62"><a href="#cb237-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> auto_retrain(<span class="va">self</span>, model_name, performance_threshold<span class="op">=</span><span class="fl">0.6</span>):</span>
<span id="cb237-63"><a href="#cb237-63" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb237-64"><a href="#cb237-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb237-65"><a href="#cb237-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.performance_history[<span class="op">-</span><span class="dv">1</span>][<span class="st">&#39;accuracy&#39;</span>] <span class="op">&lt;</span> performance_threshold:</span>
<span id="cb237-66"><a href="#cb237-66" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Triggering auto-retrain for </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb237-67"><a href="#cb237-67" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb237-68"><a href="#cb237-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–±–æ—Ä –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb237-69"><a href="#cb237-69" aria-hidden="true" tabindex="-1"></a>            new_data <span class="op">=</span> <span class="va">self</span>.collect_new_data()</span>
<span id="cb237-70"><a href="#cb237-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb237-71"><a href="#cb237-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb237-72"><a href="#cb237-72" aria-hidden="true" tabindex="-1"></a>            retrained_model <span class="op">=</span> <span class="va">self</span>.retrain_model(model_name, new_data)</span>
<span id="cb237-73"><a href="#cb237-73" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb237-74"><a href="#cb237-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb237-75"><a href="#cb237-75" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.ab_test_models(model_name, retrained_model)</span></code></pre></div>
<h2 data-number="14.10" id="—à–∞–≥-9-–ø–æ–ª–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"><span
class="header-section-number">14.10</span> –®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<div class="sourceCode" id="cb238"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main_system.py</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedMLSystem:</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª–Ω–∞—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è ML —Å–∏—Å—Ç–µ–º–∞&quot;&quot;&quot;</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_processor <span class="op">=</span> AdvancedDataProcessor()</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_system <span class="op">=</span> MultiModelSystem()</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> AdvancedRiskManager()</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitoring <span class="op">=</span> AdvancedMonitoring()</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.api_gateway <span class="op">=</span> APIGateway()</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_production_system(<span class="va">self</span>):</span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> <span class="va">self</span>.data_processor.collect_multi_source_data([<span class="st">&#39;BTC-USD&#39;</span>, <span class="st">&#39;ETH-USD&#39;</span>])</span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb238-21"><a href="#cb238-21" aria-hidden="true" tabindex="-1"></a>                predictions <span class="op">=</span> <span class="va">self</span>.model_system.get_predictions(data)</span>
<span id="cb238-22"><a href="#cb238-22" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-23"><a href="#cb238-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3. –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤</span></span>
<span id="cb238-24"><a href="#cb238-24" aria-hidden="true" tabindex="-1"></a>                risk_assessment <span class="op">=</span> <span class="va">self</span>.risk_manager.assess_risks(predictions, data)</span>
<span id="cb238-25"><a href="#cb238-25" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-26"><a href="#cb238-26" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</span></span>
<span id="cb238-27"><a href="#cb238-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> risk_assessment[<span class="st">&#39;risk_score&#39;</span>] <span class="op">&lt;</span> <span class="fl">0.7</span>:  <span class="co"># –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫</span></span>
<span id="cb238-28"><a href="#cb238-28" aria-hidden="true" tabindex="-1"></a>                    trade_results <span class="op">=</span> <span class="va">self</span>.execute_trades(predictions, risk_assessment)</span>
<span id="cb238-29"><a href="#cb238-29" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb238-30"><a href="#cb238-30" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</span></span>
<span id="cb238-31"><a href="#cb238-31" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.monitoring.monitor_trades(trade_results)</span>
<span id="cb238-32"><a href="#cb238-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-33"><a href="#cb238-33" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb238-34"><a href="#cb238-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.monitoring.check_retrain_required():</span>
<span id="cb238-35"><a href="#cb238-35" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.retrain_models()</span>
<span id="cb238-36"><a href="#cb238-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-37"><a href="#cb238-37" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">300</span>)  <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb238-38"><a href="#cb238-38" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb238-39"><a href="#cb238-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb238-40"><a href="#cb238-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.monitoring.trigger_alert(<span class="ss">f&quot;System error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb238-41"><a href="#cb238-41" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">60</span>)</span>
<span id="cb238-42"><a href="#cb238-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-43"><a href="#cb238-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb238-44"><a href="#cb238-44" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> AdvancedMLSystem()</span>
<span id="cb238-45"><a href="#cb238-45" aria-hidden="true" tabindex="-1"></a>    system.run_production_system()</span></code></pre></div>
<h2 data-number="14.11" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-1"><span
class="header-section-number">14.11</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 data-number="14.11.1" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-2"><span
class="header-section-number">14.11.1</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª—è</strong>: 78.5%</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞</strong>: 2.1</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 5.8%</li>
<li><strong>VaR (95%)</strong>: 2.3%</li>
<li><strong>–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 34.2% –∑–∞ –≥–æ–¥</li>
<li><strong>Win Rate</strong>: 68.4%</li>
</ul>
<h3 data-number="14.11.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞"><span
class="header-section-number">14.11.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ
–ø–æ–¥—Ö–æ–¥–∞</h3>
<ol type="1">
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –∞–Ω—Å–∞–º–±–ª—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö
–º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong> - –ø–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h3 data-number="14.11.3" id="—Å–ª–æ–∂–Ω–æ—Å—Ç—å"><span
class="header-section-number">14.11.3</span> –°–ª–æ–∂–Ω–æ—Å—Ç—å</h3>
<ol type="1">
<li><strong>–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
<li><strong>–†–µ—Å—É—Ä—Å–æ–µ–º–∫–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö
–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è</strong> - —Ç—Ä–µ–±—É–µ—Ç DevOps —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏</strong> - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
</ol>
<h2 data-number="14.12" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-2"><span
class="header-section-number">14.12</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é
ML-—Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ DEX blockchain —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
–ø—Ä–∞–∫—Ç–∏–∫ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π. –•–æ—Ç—è —Å–∏—Å—Ç–µ–º–∞ —Å–ª–æ–∂–Ω–∞—è, –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å.</p>
<hr />
<h1 data-number="15" id="—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl"><span
class="header-section-number">15</span> –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</h1>
<h2 data-number="15.0" id="–ø–æ—á–µ–º—É-—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">15.0</span> –ü–æ—á–µ–º—É —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="15.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl"><span class="header-section-number">15.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="15.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl"><span class="header-section-number">15.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ç–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã automl?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="15.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Ç–µ–æ—Ä–∏—é-automl"><span
class="header-section-number">15.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ–æ—Ä–∏—é AutoML</h2>
<p><img src="images/automl_theory.png" alt="–¢–µ–æ—Ä–∏—è AutoML" />
<em>–†–∏—Å—É–Ω–æ–∫ 14.1: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ
–æ–±—É—á–µ–Ω–∏—è</em></p>
<p>AutoML (Automated Machine Learning) - —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è,
–∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ
—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
AutoML Gluon.</p>
<h2 data-number="15.2" id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏-automl"><span
class="header-section-number">15.2</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ AutoML</h2>
<h3 data-number="15.2.1" id="neural-architecture-search-nas"><span
class="header-section-number">15.2.1</span> 1. Neural Architecture
Search (NAS)</h3>
<p>Neural Architecture Search - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.</p>
<div class="sourceCode" id="cb239"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ—Ä NAS –≤ AutoGluon</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.vision <span class="im">import</span> ImagePredictor</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NAS –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> ImagePredictor()</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>predictor.fit(</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>    train_data,</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>    hyperparameters<span class="op">=</span>{</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;resnet50&#39;</span>,  <span class="co"># –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;nas&#39;</span>: <span class="va">True</span>,          <span class="co"># –í–∫–ª—é—á–∏—Ç—å NAS</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;nas_lr&#39;</span>: <span class="fl">0.01</span>,       <span class="co"># Learning rate –¥–ª—è NAS</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;nas_epochs&#39;</span>: <span class="dv">50</span>     <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –¥–ª—è NAS</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="15.2.2" id="hyperparameter-optimization"><span
class="header-section-number">15.2.2</span> 2. Hyperparameter
Optimization</h3>
<p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
AutoML.</p>
<h4 data-number="15.2.2.1" id="–º–µ—Ç–æ–¥—ã-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"><span
class="header-section-number">15.2.2.1</span> –ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:</h4>
<p><strong>Grid Search:</strong></p>
<div class="sourceCode" id="cb240"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —Å–µ—Ç–∫–µ</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>},</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>        {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">300</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.01</span>}</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Random Search:</strong></p>
<div class="sourceCode" id="cb241"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–∏—Å–∫</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: {</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_boost_round&#39;</span>: randint(<span class="dv">50</span>, <span class="dv">500</span>),</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: uniform(<span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: randint(<span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Bayesian Optimization:</strong></p>
<div class="sourceCode" id="cb242"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ë–∞–π–µ—Å–æ–≤—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.core <span class="im">import</span> space</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: {</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_boost_round&#39;</span>: space.Int(<span class="dv">50</span>, <span class="dv">500</span>),</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: space.Real(<span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: space.Int(<span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 data-number="15.2.3" id="feature-engineering-automation"><span
class="header-section-number">15.2.3</span> 3. Feature Engineering
Automation</h3>
<p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ - –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å AutoML.</p>
<div class="sourceCode" id="cb243"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>    feature_generator_type<span class="op">=</span><span class="st">&#39;auto&#39;</span>,  <span class="co"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>    feature_generator_kwargs<span class="op">=</span>{</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable_text_special_features&#39;</span>: <span class="va">True</span>,</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable_text_ngram_features&#39;</span>: <span class="va">True</span>,</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable_datetime_features&#39;</span>: <span class="va">True</span>,</span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable_categorical_features&#39;</span>: <span class="va">True</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 data-number="15.3" id="–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–æ—Å–Ω–æ–≤—ã"><span
class="header-section-number">15.3</span> –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã</h2>
<h3 data-number="15.3.1" id="loss-functions"><span
class="header-section-number">15.3.1</span> 1. Loss Functions</h3>
<p>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—Ç–µ—Ä—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:</p>
<div class="sourceCode" id="cb244"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FocalLoss(nn.Module):</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Focal Loss –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, alpha<span class="op">=</span><span class="dv">1</span>, gamma<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(FocalLoss, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alpha <span class="op">=</span> alpha</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gamma <span class="op">=</span> gamma</span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, inputs, targets):</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>        ce_loss <span class="op">=</span> nn.CrossEntropyLoss()(inputs, targets)</span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>        pt <span class="op">=</span> torch.exp(<span class="op">-</span>ce_loss)</span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>        focal_loss <span class="op">=</span> <span class="va">self</span>.alpha <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>pt)<span class="op">**</span><span class="va">self</span>.gamma <span class="op">*</span> ce_loss</span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> focal_loss</span></code></pre></div>
<h3 data-number="15.3.2" id="optimization-algorithms"><span
class="header-section-number">15.3.2</span> 2. Optimization
Algorithms</h3>
<div class="sourceCode" id="cb245"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>optimizers <span class="op">=</span> {</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;adam&#39;</span>: {</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;lr&#39;</span>: <span class="fl">0.001</span>,</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;betas&#39;</span>: (<span class="fl">0.9</span>, <span class="fl">0.999</span>),</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;eps&#39;</span>: <span class="fl">1e-8</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;sgd&#39;</span>: {</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;lr&#39;</span>: <span class="fl">0.01</span>,</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;momentum&#39;</span>: <span class="fl">0.9</span>,</span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;weight_decay&#39;</span>: <span class="fl">1e-4</span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;rmsprop&#39;</span>: {</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;lr&#39;</span>: <span class="fl">0.01</span>,</span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;alpha&#39;</span>: <span class="fl">0.99</span>,</span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;eps&#39;</span>: <span class="fl">1e-8</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 data-number="15.3.3" id="regularization-techniques"><span
class="header-section-number">15.3.3</span> 3. Regularization
Techniques</h3>
<div class="sourceCode" id="cb246"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú–µ—Ç–æ–¥—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>regularization <span class="op">=</span> {</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;l1&#39;</span>: <span class="fl">0.01</span>,      <span class="co"># L1 regularization</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;l2&#39;</span>: <span class="fl">0.01</span>,      <span class="co"># L2 regularization</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;dropout&#39;</span>: <span class="fl">0.5</span>,  <span class="co"># Dropout</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;batch_norm&#39;</span>: <span class="va">True</span>,  <span class="co"># Batch normalization</span></span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;early_stopping&#39;</span>: {</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;patience&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_delta&#39;</span>: <span class="fl">0.001</span></span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 data-number="15.4" id="ensemble-methods"><span
class="header-section-number">15.4</span> Ensemble Methods</h2>
<h3 data-number="15.4.1" id="bagging"><span
class="header-section-number">15.4.1</span> 1. Bagging</h3>
<div class="sourceCode" id="cb247"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bagging –≤ AutoGluon</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>    num_bag_folds<span class="op">=</span><span class="dv">5</span>,    <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è bagging</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>    num_bag_sets<span class="op">=</span><span class="dv">2</span>,     <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>    num_stack_levels<span class="op">=</span><span class="dv">1</span>  <span class="co"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 data-number="15.4.2" id="boosting"><span
class="header-section-number">15.4.2</span> 2. Boosting</h3>
<div class="sourceCode" id="cb248"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boosting –∞–ª–≥–æ—Ä–∏—Ç–º—ã</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>hyperparameters <span class="op">=</span> {</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: {</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: {</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;LGB&#39;</span>: {</span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>,</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 data-number="15.4.3" id="stacking"><span
class="header-section-number">15.4.3</span> 3. Stacking</h3>
<div class="sourceCode" id="cb249"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç–µ–∫–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>stacking_config <span class="op">=</span> {</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_bag_folds&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_bag_sets&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;num_stack_levels&#39;</span>: <span class="dv">2</span>,</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;stacker_models&#39;</span>: [<span class="st">&#39;GBM&#39;</span>, <span class="st">&#39;XGB&#39;</span>, <span class="st">&#39;LGB&#39;</span>],</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;stacker_hyperparameters&#39;</span>: {</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;GBM&#39;</span>: {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">100</span>}</span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 data-number="15.5" id="advanced-concepts"><span
class="header-section-number">15.5</span> Advanced Concepts</h2>
<h3 data-number="15.5.1" id="multi-task-learning"><span
class="header-section-number">15.5.1</span> 1. Multi-Task Learning</h3>
<div class="sourceCode" id="cb250"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú—É–ª—å—Ç–∏–∑–∞–¥–∞—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MultiTaskPredictor:</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, tasks):</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tasks <span class="op">=</span> tasks</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictors <span class="op">=</span> {}</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> task <span class="kw">in</span> tasks:</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.predictors[task] <span class="op">=</span> TabularPredictor(</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span>task[<span class="st">&#39;label&#39;</span>],</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>                problem_type<span class="op">=</span>task[<span class="st">&#39;type&#39;</span>]</span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, data):</span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> task_name, predictor <span class="kw">in</span> <span class="va">self</span>.predictors.items():</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>            task_data <span class="op">=</span> data[task[<span class="st">&#39;features&#39;</span>] <span class="op">+</span> [task[<span class="st">&#39;label&#39;</span>]]]</span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true" tabindex="-1"></a>            predictor.fit(task_data)</span></code></pre></div>
<h3 data-number="15.5.2" id="transfer-learning"><span
class="header-section-number">15.5.2</span> 2. Transfer Learning</h3>
<div class="sourceCode" id="cb251"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –¢—Ä–∞–Ω—Å—Ñ–µ—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transfer_learning(source_data, target_data, source_label, target_label):</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    source_predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>source_label)</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    source_predictor.fit(source_data)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>    source_features <span class="op">=</span> source_predictor.extract_features(target_data)</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</span></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>    target_predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span>target_label)</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a>    target_predictor.fit(source_features)</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target_predictor</span></code></pre></div>
<h3 data-number="15.5.3" id="meta-learning"><span
class="header-section-number">15.5.3</span> 3. Meta-Learning</h3>
<div class="sourceCode" id="cb252"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ú–µ—Ç–∞-–æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MetaLearner:</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.meta_features <span class="op">=</span> {}</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.algorithm_performance <span class="op">=</span> {}</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_meta_features(<span class="va">self</span>, dataset):</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> {</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_samples&#39;</span>: <span class="bu">len</span>(dataset),</span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_features&#39;</span>: <span class="bu">len</span>(dataset.columns) <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;n_classes&#39;</span>: <span class="bu">len</span>(dataset[<span class="st">&#39;target&#39;</span>].unique()),</span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;missing_ratio&#39;</span>: dataset.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> (<span class="bu">len</span>(dataset) <span class="op">*</span> <span class="bu">len</span>(dataset.columns)),</span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;categorical_ratio&#39;</span>: <span class="bu">len</span>(dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns) <span class="op">/</span> <span class="bu">len</span>(dataset.columns)</span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> recommend_algorithm(<span class="va">self</span>, dataset):</span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb252-20"><a href="#cb252-20" aria-hidden="true" tabindex="-1"></a>        meta_features <span class="op">=</span> <span class="va">self</span>.extract_meta_features(dataset)</span>
<span id="cb252-21"><a href="#cb252-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb252-22"><a href="#cb252-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞</span></span>
<span id="cb252-23"><a href="#cb252-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> meta_features[<span class="st">&#39;n_samples&#39;</span>] <span class="op">&lt;</span> <span class="dv">1000</span>:</span>
<span id="cb252-24"><a href="#cb252-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;GBM&#39;</span></span>
<span id="cb252-25"><a href="#cb252-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> meta_features[<span class="st">&#39;categorical_ratio&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb252-26"><a href="#cb252-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;CAT&#39;</span></span>
<span id="cb252-27"><a href="#cb252-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb252-28"><a href="#cb252-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;XGB&#39;</span></span></code></pre></div>
<h2 data-number="15.6" id="performance-optimization"><span
class="header-section-number">15.6</span> Performance Optimization</h2>
<h3 data-number="15.6.1" id="memory-optimization"><span
class="header-section-number">15.6.1</span> 1. Memory Optimization</h3>
<div class="sourceCode" id="cb253"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimize_memory(data):</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>]).columns:</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data[col].<span class="bu">min</span>() <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> data[col].<span class="bu">max</span>() <span class="op">&lt;</span> <span class="dv">255</span>:</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;uint8&#39;</span>)</span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data[col].<span class="bu">min</span>() <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">128</span> <span class="kw">and</span> data[col].<span class="bu">max</span>() <span class="op">&lt;</span> <span class="dv">127</span>:</span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;int8&#39;</span>)</span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data[col].<span class="bu">min</span>() <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> data[col].<span class="bu">max</span>() <span class="op">&lt;</span> <span class="dv">65535</span>:</span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;uint16&#39;</span>)</span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> data[col].<span class="bu">min</span>() <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">32768</span> <span class="kw">and</span> data[col].<span class="bu">max</span>() <span class="op">&lt;</span> <span class="dv">32767</span>:</span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;int16&#39;</span>)</span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a>            data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;int32&#39;</span>)</span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è float —Ç–∏–ø–æ–≤</span></span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>]).columns:</span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a>        data[col] <span class="op">=</span> data[col].astype(<span class="st">&#39;float32&#39;</span>)</span>
<span id="cb253-21"><a href="#cb253-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb253-22"><a href="#cb253-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="15.6.2" id="computational-optimization"><span
class="header-section-number">15.6.2</span> 2. Computational
Optimization</h3>
<div class="sourceCode" id="cb254"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing <span class="im">as</span> mp</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parallel_processing(data, n_jobs<span class="op">=-</span><span class="dv">1</span>):</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n_jobs <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>        n_jobs <span class="op">=</span> mp.cpu_count()</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>    chunk_size <span class="op">=</span> <span class="bu">len</span>(data) <span class="op">//</span> n_jobs</span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>    chunks <span class="op">=</span> [data[i:i<span class="op">+</span>chunk_size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data), chunk_size)]</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> mp.Pool(n_jobs) <span class="im">as</span> pool:</span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> pool.<span class="bu">map</span>(process_chunk, chunks)</span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(results)</span></code></pre></div>
<h2 data-number="15.7" id="theoretical-guarantees"><span
class="header-section-number">15.7</span> Theoretical Guarantees</h2>
<h3 data-number="15.7.1" id="convergence-guarantees"><span
class="header-section-number">15.7.1</span> 1. Convergence
Guarantees</h3>
<div class="sourceCode" id="cb255"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì–∞—Ä–∞–Ω—Ç–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>convergence_guarantees <span class="op">=</span> {</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;GBM&#39;</span>: {</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;convergence_rate&#39;</span>: <span class="st">&#39;O(1/sqrt(T))&#39;</span>,</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;conditions&#39;</span>: [<span class="st">&#39;convex_loss&#39;</span>, <span class="st">&#39;bounded_gradients&#39;</span>],</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;theorem&#39;</span>: <span class="st">&#39;GBM converges to global optimum for convex loss&#39;</span></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XGB&#39;</span>: {</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;convergence_rate&#39;</span>: <span class="st">&#39;O(log(T)/T)&#39;</span>,</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;conditions&#39;</span>: [<span class="st">&#39;strongly_convex_loss&#39;</span>, <span class="st">&#39;bounded_hessian&#39;</span>],</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;theorem&#39;</span>: <span class="st">&#39;XGB converges with rate O(log(T)/T)&#39;</span></span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 data-number="15.7.2" id="generalization-bounds"><span
class="header-section-number">15.7.2</span> 2. Generalization
Bounds</h3>
<div class="sourceCode" id="cb256"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ì—Ä–∞–Ω–∏—Ü—ã –æ–±–æ–±—â–µ–Ω–∏—è</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generalization_bound(n, d, delta):</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ì—Ä–∞–Ω–∏—Ü–∞ –æ–±–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞&quot;&quot;&quot;</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> math</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># VC dimension bound</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>    vc_bound <span class="op">=</span> math.sqrt((d <span class="op">*</span> math.log(n) <span class="op">+</span> math.log(<span class="dv">1</span><span class="op">/</span>delta)) <span class="op">/</span> n)</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rademacher complexity bound</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>    rademacher_bound <span class="op">=</span> math.sqrt(math.log(n) <span class="op">/</span> n)</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(vc_bound, rademacher_bound)</span></code></pre></div>
<h2 data-number="15.8" id="research-frontiers"><span
class="header-section-number">15.8</span> Research Frontiers</h2>
<h3 data-number="15.8.1" id="neural-architecture-search"><span
class="header-section-number">15.8.1</span> 1. Neural Architecture
Search</h3>
<div class="sourceCode" id="cb257"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã NAS</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DARTS:</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Differentiable Architecture Search&quot;&quot;&quot;</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, search_space):</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.search_space <span class="op">=</span> search_space</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.architecture_weights <span class="op">=</span> {}</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> search(<span class="va">self</span>, data, epochs<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span></span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span></span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.update_architecture_weights(data)</span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.update_model_weights(data)</span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb257-18"><a href="#cb257-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_architecture_weights(<span class="va">self</span>, data):</span>
<span id="cb257-19"><a href="#cb257-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span></span>
<span id="cb257-20"><a href="#cb257-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DARTS</span></span>
<span id="cb257-21"><a href="#cb257-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h3 data-number="15.8.2" id="automl-for-time-series"><span
class="header-section-number">15.8.2</span> 2. AutoML for Time
Series</h3>
<div class="sourceCode" id="cb258"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AutoML –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.timeseries <span class="im">import</span> TimeSeriesPredictor</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_series_automl(data, prediction_length):</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;AutoML –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>    predictor <span class="op">=</span> TimeSeriesPredictor(</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>        prediction_length<span class="op">=</span>prediction_length,</span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>        target<span class="op">=</span><span class="st">&quot;target&quot;</span>,</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>        time_limit<span class="op">=</span><span class="dv">3600</span>  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>    predictor.fit(data)</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> predictor</span></code></pre></div>
<h2 data-number="15.9" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-3"><span
class="header-section-number">15.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤ AutoML –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è:</p>
<ol type="1">
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</strong> - –∑–Ω–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö –∏
—Å–ª–∞–±—ã—Ö —Å—Ç–æ—Ä–æ–Ω</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ
–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ
—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤</li>
<li><strong>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤</strong> - –æ—Å–Ω–æ–≤–∞ –¥–ª—è
–∏–Ω–Ω–æ–≤–∞—Ü–∏–π</li>
</ol>
<p>–≠—Ç–∏ –∑–Ω–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AutoML Gluon –Ω–µ –∫–∞–∫ ‚Äú—á–µ—Ä–Ω—ã–π —è—â–∏–∫‚Äù,
–∞ –∫–∞–∫ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –µ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤.</p>
<hr />
<h1 data-number="16"
id="–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å-–º–æ–¥–µ–ª–µ–π"><span
class="header-section-number">16</span> –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏
–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π</h1>
<h2 data-number="16.0" id="–ø–æ—á–µ–º—É-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">16.0</span> –ü–æ—á–µ–º—É –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="16.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å"><span class="header-section-number">16.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="16.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å"><span class="header-section-number">16.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="16.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å"><span
class="header-section-number">16.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</h2>
<p><img src="images/interpretability_overview.png"
alt="–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ML" /> <em>–†–∏—Å—É–Ω–æ–∫ 15.1: –û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–≤
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ ML-–º–æ–¥–µ–ª–µ–π</em></p>
<p>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è - —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞—Ç—å –∏
–æ–±—ä—è—Å–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã–µ ML-–º–æ–¥–µ–ª—è–º–∏. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è: -
<strong>–î–æ–≤–µ—Ä–∏—è –∫ –º–æ–¥–µ–ª–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π -
<strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act -
<strong>–û—Ç–ª–∞–¥–∫–∞ –º–æ–¥–µ–ª–µ–π</strong> - –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Å–º–µ—â–µ–Ω–∏–π -
<strong>–£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</p>
<h2 data-number="16.2" id="—Ç–∏–ø—ã-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="header-section-number">16.2</span> –¢–∏–ø—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 data-number="16.2.1"
id="–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-intrinsic-interpretability"><span
class="header-section-number">16.2.1</span> 1. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (Intrinsic Interpretability)</h3>
<p>–ú–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã:</p>
<div class="sourceCode" id="cb259"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> np.<span class="bu">abs</span>(model.coef_)</span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> X_train.columns</span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏</span></span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a>importance_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;feature&#39;</span>: feature_names,</span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;importance&#39;</span>: feature_importance</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">&#39;importance&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:&quot;</span>)</span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(importance_df)</span></code></pre></div>
<h3 data-number="16.2.2"
id="–ø–æ—Å—Ç-—Ö–æ–∫-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-post-hoc-interpretability"><span
class="header-section-number">16.2.2</span> 2. –ü–æ—Å—Ç-—Ö–æ–∫
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (Post-hoc Interpretability)</h3>
<p>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —É–∂–µ –æ–±—É—á–µ–Ω–Ω—ã—Ö ‚Äú—á–µ—Ä–Ω—ã—Ö —è—â–∏–∫–æ–≤‚Äù:</p>
<div class="sourceCode" id="cb260"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SHAP –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>)</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data)</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ SHAP explainer</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(predictor.get_model_best())</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X_test)</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>shap.summary_plot(shap_values, X_test)</span></code></pre></div>
<h2 data-number="16.3" id="–º–µ—Ç–æ–¥—ã-–≥–ª–æ–±–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="header-section-number">16.3</span> –ú–µ—Ç–æ–¥—ã –≥–ª–æ–±–∞–ª—å–Ω–æ–π
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 data-number="16.3.1" id="feature-importance"><span
class="header-section-number">16.3.1</span> 1. Feature Importance</h3>
<div class="sourceCode" id="cb261"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_feature_importance(predictor, method<span class="op">=</span><span class="st">&#39;permutation&#39;</span>):</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method <span class="op">==</span> <span class="st">&#39;permutation&#39;</span>:</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Permutation importance</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.inspection <span class="im">import</span> permutation_importance</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a>        perm_importance <span class="op">=</span> permutation_importance(</span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a>            model, X_test, y_test, n_repeats<span class="op">=</span><span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> perm_importance.importances_mean</span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;shap&#39;</span>:</span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SHAP importance</span></span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> shap</span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a>        explainer <span class="op">=</span> shap.TreeExplainer(predictor.get_model_best())</span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a>        shap_values <span class="op">=</span> explainer.shap_values(X_test)</span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.<span class="bu">abs</span>(shap_values).mean(<span class="dv">0</span>)</span>
<span id="cb261-23"><a href="#cb261-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb261-24"><a href="#cb261-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;builtin&#39;</span>:</span>
<span id="cb261-25"><a href="#cb261-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å (–¥–ª—è tree-based –º–æ–¥–µ–ª–µ–π)</span></span>
<span id="cb261-26"><a href="#cb261-26" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb261-27"><a href="#cb261-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;feature_importances_&#39;</span>):</span>
<span id="cb261-28"><a href="#cb261-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> model.feature_importances_</span>
<span id="cb261-29"><a href="#cb261-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb261-30"><a href="#cb261-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Model doesn&#39;t support built-in feature importance&quot;</span>)</span></code></pre></div>
<h3 data-number="16.3.2" id="partial-dependence-plots-pdp"><span
class="header-section-number">16.3.2</span> 2. Partial Dependence Plots
(PDP)</h3>
<div class="sourceCode" id="cb262"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.inspection <span class="im">import</span> partial_dependence, plot_partial_dependence</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_pdp(predictor, X, features, model<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —á–∞—Å—Ç–∏—á–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PDP –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(features) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>        pdp, axes <span class="op">=</span> partial_dependence(</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>            model, X, features, grid_resolution<span class="op">=</span><span class="dv">50</span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>        plt.plot(axes[<span class="dv">0</span>], pdp[<span class="dv">0</span>])</span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(features[<span class="dv">0</span>])</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">&#39;Partial Dependence&#39;</span>)</span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f&#39;Partial Dependence Plot for </span><span class="sc">{</span>features[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PDP –¥–ª—è –¥–≤—É—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">len</span>(features) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a>        pdp, axes <span class="op">=</span> partial_dependence(</span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>            model, X, features, grid_resolution<span class="op">=</span><span class="dv">20</span></span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb262-30"><a href="#cb262-30" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb262-31"><a href="#cb262-31" aria-hidden="true" tabindex="-1"></a>        plt.contourf(axes[<span class="dv">0</span>], axes[<span class="dv">1</span>], pdp[<span class="dv">0</span>], levels<span class="op">=</span><span class="dv">20</span>, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb262-32"><a href="#cb262-32" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb262-33"><a href="#cb262-33" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(features[<span class="dv">0</span>])</span>
<span id="cb262-34"><a href="#cb262-34" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(features[<span class="dv">1</span>])</span>
<span id="cb262-35"><a href="#cb262-35" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f&#39;Partial Dependence Plot for </span><span class="sc">{</span>features[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>features[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb262-36"><a href="#cb262-36" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code></pre></div>
<h3 data-number="16.3.3" id="accumulated-local-effects-ale"><span
class="header-section-number">16.3.3</span> 3. Accumulated Local Effects
(ALE)</h3>
<div class="sourceCode" id="cb263"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> alibi</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> alibi.explainers <span class="im">import</span> ALE</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_ale(predictor, X, features):</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ALE –≥—Ä–∞—Ñ–∏–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ ALE explainer</span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>    ale <span class="op">=</span> ALE(model.predict, feature_names<span class="op">=</span>X.columns.tolist())</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ ALE</span></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a>    ale_exp <span class="op">=</span> ale.explain(X.values, features<span class="op">=</span>features)</span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a>    ax.plot(ale_exp.feature_values[<span class="dv">0</span>], ale_exp.ale_values[<span class="dv">0</span>])</span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(features[<span class="dv">0</span>])</span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">&#39;ALE&#39;</span>)</span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f&#39;Accumulated Local Effects for </span><span class="sc">{</span>features[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb263-21"><a href="#cb263-21" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>)</span>
<span id="cb263-22"><a href="#cb263-22" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<h2 data-number="16.4" id="–º–µ—Ç–æ–¥—ã-–ª–æ–∫–∞–ª—å–Ω–æ–π-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏"><span
class="header-section-number">16.4</span> –ú–µ—Ç–æ–¥—ã –ª–æ–∫–∞–ª—å–Ω–æ–π
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 data-number="16.4.1"
id="lime-local-interpretable-model-agnostic-explanations"><span
class="header-section-number">16.4.1</span> 1. LIME (Local Interpretable
Model-agnostic Explanations)</h3>
<div class="sourceCode" id="cb264"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime.lime_tabular</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explain_with_lime(predictor, X, instance_idx, num_features<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é LIME&quot;&quot;&quot;</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ LIME explainer</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> lime.lime_tabular.LimeTabularExplainer(</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>        X.values,</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>        feature_names<span class="op">=</span>X.columns.tolist(),</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>        class_names<span class="op">=</span>[<span class="st">&#39;Class 0&#39;</span>, <span class="st">&#39;Class 1&#39;</span>],</span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">&#39;classification&#39;</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a>    explanation <span class="op">=</span> explainer.explain_instance(</span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a>        X.iloc[instance_idx].values,</span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>        model.predict_proba,</span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>        num_features<span class="op">=</span>num_features</span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a>    explanation.show_in_notebook(show_table<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> explanation</span></code></pre></div>
<h3 data-number="16.4.2" id="shap-shapley-additive-explanations"><span
class="header-section-number">16.4.2</span> 2. SHAP (SHapley Additive
exPlanations)</h3>
<div class="sourceCode" id="cb265"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explain_with_shap(predictor, X, instance_idx):</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é SHAP&quot;&quot;&quot;</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ SHAP explainer</span></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;predict_proba&#39;</span>):</span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–ª—è tree-based –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true" tabindex="-1"></a>        explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true" tabindex="-1"></a>        shap_values <span class="op">=</span> explainer.shap_values(X.iloc[instance_idx:instance_idx<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true" tabindex="-1"></a>        explainer <span class="op">=</span> shap.Explainer(model)</span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true" tabindex="-1"></a>        shap_values <span class="op">=</span> explainer(X.iloc[instance_idx:instance_idx<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–¥–æ–ø–∞–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true" tabindex="-1"></a>    shap.waterfall_plot(explainer.expected_value, shap_values[<span class="dv">0</span>], X.iloc[instance_idx])</span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-21"><a href="#cb265-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> shap_values</span></code></pre></div>
<h3 data-number="16.4.3" id="integrated-gradients"><span
class="header-section-number">16.4.3</span> 3. Integrated Gradients</h3>
<div class="sourceCode" id="cb266"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integrated_gradients(model, X, baseline<span class="op">=</span><span class="va">None</span>, steps<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Integrated Gradients&quot;&quot;&quot;</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> baseline <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>        baseline <span class="op">=</span> np.zeros_like(X)</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∞–ª—å—Ñ–∞ –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>    alphas <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, steps)</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É baseline –∏ X</span></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>    interpolated <span class="op">=</span> []</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>        interpolated.append(baseline <span class="op">+</span> alpha <span class="op">*</span> (X <span class="op">-</span> baseline))</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>    interpolated <span class="op">=</span> np.array(interpolated)</span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span></span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> tf.GradientTape() <span class="im">as</span> tape:</span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a>        tape.watch(interpolated)</span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> model(interpolated)</span>
<span id="cb266-24"><a href="#cb266-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-25"><a href="#cb266-25" aria-hidden="true" tabindex="-1"></a>    gradients <span class="op">=</span> tape.gradient(predictions, interpolated)</span>
<span id="cb266-26"><a href="#cb266-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-27"><a href="#cb266-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span></span>
<span id="cb266-28"><a href="#cb266-28" aria-hidden="true" tabindex="-1"></a>    integrated_grads <span class="op">=</span> np.mean(gradients, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> (X <span class="op">-</span> baseline)</span>
<span id="cb266-29"><a href="#cb266-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb266-30"><a href="#cb266-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integrated_grads</span></code></pre></div>
<h2 data-number="16.5" id="—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ-–º–µ—Ç–æ–¥—ã-–¥–ª—è-automl-gluon"><span
class="header-section-number">16.5</span> –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è AutoML
Gluon</h2>
<h3 data-number="16.5.1" id="model-specific-interpretability"><span
class="header-section-number">16.5.1</span> 1. Model-specific
Interpretability</h3>
<div class="sourceCode" id="cb267"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_model_specific_explanations(predictor):</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>    model_name <span class="op">=</span> predictor.get_model_best().<span class="va">__class__</span>.<span class="va">__name__</span></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>    explanations <span class="op">=</span> {}</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;XGB&#39;</span> <span class="kw">in</span> model_name <span class="kw">or</span> <span class="st">&#39;LGB&#39;</span> <span class="kw">in</span> model_name <span class="kw">or</span> <span class="st">&#39;GBM&#39;</span> <span class="kw">in</span> model_name:</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tree-based –º–æ–¥–µ–ª–∏</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;feature_importance&#39;</span>] <span class="op">=</span> model.feature_importances_</span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;tree_structure&#39;</span>] <span class="op">=</span> model.get_booster().get_dump()</span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Neural&#39;</span> <span class="kw">in</span> model_name <span class="kw">or</span> <span class="st">&#39;TabNet&#39;</span> <span class="kw">in</span> model_name:</span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;attention_weights&#39;</span>] <span class="op">=</span> model.attention_weights</span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;feature_embeddings&#39;</span>] <span class="op">=</span> model.feature_embeddings</span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">&#39;Linear&#39;</span> <span class="kw">in</span> model_name <span class="kw">or</span> <span class="st">&#39;Logistic&#39;</span> <span class="kw">in</span> model_name:</span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb267-21"><a href="#cb267-21" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;coefficients&#39;</span>] <span class="op">=</span> model.coef_</span>
<span id="cb267-22"><a href="#cb267-22" aria-hidden="true" tabindex="-1"></a>        explanations[<span class="st">&#39;intercept&#39;</span>] <span class="op">=</span> model.intercept_</span>
<span id="cb267-23"><a href="#cb267-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb267-24"><a href="#cb267-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> explanations</span></code></pre></div>
<h3 data-number="16.5.2" id="ensemble-interpretability"><span
class="header-section-number">16.5.2</span> 2. Ensemble
Interpretability</h3>
<div class="sourceCode" id="cb268"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explain_ensemble(predictor, X, method<span class="op">=</span><span class="st">&#39;weighted&#39;</span>):</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> predictor.get_model_names()</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> predictor.get_model_weights()</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>    explanations <span class="op">=</span> {}</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, weight <span class="kw">in</span> <span class="bu">zip</span>(models, weights):</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> predictor.get_model(model_name)</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> method <span class="op">==</span> <span class="st">&#39;weighted&#39;</span>:</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ</span></span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">hasattr</span>(model, <span class="st">&#39;feature_importances_&#39;</span>):</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>                importance <span class="op">=</span> model.feature_importances_ <span class="op">*</span> weight</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>                explanations[model_name] <span class="op">=</span> importance</span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;shap&#39;</span>:</span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># SHAP –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a>            explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true" tabindex="-1"></a>            shap_values <span class="op">=</span> explainer.shap_values(X)</span>
<span id="cb268-22"><a href="#cb268-22" aria-hidden="true" tabindex="-1"></a>            explanations[model_name] <span class="op">=</span> shap_values <span class="op">*</span> weight</span>
<span id="cb268-23"><a href="#cb268-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb268-24"><a href="#cb268-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</span></span>
<span id="cb268-25"><a href="#cb268-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method <span class="op">==</span> <span class="st">&#39;weighted&#39;</span>:</span>
<span id="cb268-26"><a href="#cb268-26" aria-hidden="true" tabindex="-1"></a>        ensemble_importance <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">list</span>(explanations.values()), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb268-27"><a href="#cb268-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_importance</span>
<span id="cb268-28"><a href="#cb268-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb268-29"><a href="#cb268-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;shap&#39;</span>:</span>
<span id="cb268-30"><a href="#cb268-30" aria-hidden="true" tabindex="-1"></a>        ensemble_shap <span class="op">=</span> np.<span class="bu">sum</span>(<span class="bu">list</span>(explanations.values()), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb268-31"><a href="#cb268-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_shap</span></code></pre></div>
<h2 data-number="16.6" id="–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π"><span
class="header-section-number">16.6</span> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</h2>
<h3 data-number="16.6.1" id="comprehensive-explanation-dashboard"><span
class="header-section-number">16.6.1</span> 1. Comprehensive Explanation
Dashboard</h3>
<div class="sourceCode" id="cb269"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_explanation_dashboard(predictor, X, y, instance_idx<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>    fig.suptitle(<span class="st">&#39;Comprehensive Model Explanation Dashboard&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Feature Importance</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>    importance <span class="op">=</span> get_feature_importance(predictor)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> X.columns</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>    sorted_idx <span class="op">=</span> np.argsort(importance)[::<span class="op">-</span><span class="dv">1</span>][:<span class="dv">10</span>]</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>    ax1.barh(<span class="bu">range</span>(<span class="bu">len</span>(sorted_idx)), importance[sorted_idx])</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>    ax1.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(sorted_idx)))</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>    ax1.set_yticklabels([feature_names[i] <span class="cf">for</span> i <span class="kw">in</span> sorted_idx])</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>    ax1.set_title(<span class="st">&#39;Top 10 Feature Importance&#39;</span>)</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. SHAP Summary</span></span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer.shap_values(X.iloc[:<span class="dv">100</span>])  <span class="co"># –ü–µ—Ä–≤—ã–µ 100 –æ–±—Ä–∞–∑—Ü–æ–≤</span></span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a>    shap.summary_plot(shap_values, X.iloc[:<span class="dv">100</span>], show<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a>    ax2.set_title(<span class="st">&#39;SHAP Summary Plot&#39;</span>)</span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Partial Dependence</span></span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>    ax3 <span class="op">=</span> axes[<span class="dv">0</span>, <span class="dv">2</span>]</span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a>    top_feature <span class="op">=</span> feature_names[sorted_idx[<span class="dv">0</span>]]</span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a>    pdp, axes_pdp <span class="op">=</span> partial_dependence(model, X, [top_feature])</span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a>    ax3.plot(axes_pdp[<span class="dv">0</span>], pdp[<span class="dv">0</span>])</span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>    ax3.set_xlabel(top_feature)</span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a>    ax3.set_ylabel(<span class="st">&#39;Partial Dependence&#39;</span>)</span>
<span id="cb269-35"><a href="#cb269-35" aria-hidden="true" tabindex="-1"></a>    ax3.set_title(<span class="ss">f&#39;PDP for </span><span class="sc">{</span>top_feature<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb269-36"><a href="#cb269-36" aria-hidden="true" tabindex="-1"></a>    ax3.grid(<span class="va">True</span>)</span>
<span id="cb269-37"><a href="#cb269-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-38"><a href="#cb269-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Local Explanation (LIME)</span></span>
<span id="cb269-39"><a href="#cb269-39" aria-hidden="true" tabindex="-1"></a>    ax4 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb269-40"><a href="#cb269-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ó–¥–µ—Å—å –±—É–¥–µ—Ç LIME –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞</span></span>
<span id="cb269-41"><a href="#cb269-41" aria-hidden="true" tabindex="-1"></a>    ax4.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&#39;LIME Explanation</span><span class="ch">\n</span><span class="st">for Instance&#39;</span>, </span>
<span id="cb269-42"><a href="#cb269-42" aria-hidden="true" tabindex="-1"></a>             ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;center&#39;</span>, transform<span class="op">=</span>ax4.transAxes)</span>
<span id="cb269-43"><a href="#cb269-43" aria-hidden="true" tabindex="-1"></a>    ax4.set_title(<span class="st">&#39;Local Explanation (LIME)&#39;</span>)</span>
<span id="cb269-44"><a href="#cb269-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-45"><a href="#cb269-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5. Model Performance</span></span>
<span id="cb269-46"><a href="#cb269-46" aria-hidden="true" tabindex="-1"></a>    ax5 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb269-47"><a href="#cb269-47" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> predictor.predict(X)</span>
<span id="cb269-48"><a href="#cb269-48" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> (predictions <span class="op">==</span> y).mean()</span>
<span id="cb269-49"><a href="#cb269-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-50"><a href="#cb269-50" aria-hidden="true" tabindex="-1"></a>    ax5.bar([<span class="st">&#39;Accuracy&#39;</span>], [accuracy])</span>
<span id="cb269-51"><a href="#cb269-51" aria-hidden="true" tabindex="-1"></a>    ax5.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb269-52"><a href="#cb269-52" aria-hidden="true" tabindex="-1"></a>    ax5.set_title(<span class="st">&#39;Model Performance&#39;</span>)</span>
<span id="cb269-53"><a href="#cb269-53" aria-hidden="true" tabindex="-1"></a>    ax5.set_ylabel(<span class="st">&#39;Score&#39;</span>)</span>
<span id="cb269-54"><a href="#cb269-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-55"><a href="#cb269-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 6. Prediction Distribution</span></span>
<span id="cb269-56"><a href="#cb269-56" aria-hidden="true" tabindex="-1"></a>    ax6 <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb269-57"><a href="#cb269-57" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> predictor.predict_proba(X)</span>
<span id="cb269-58"><a href="#cb269-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(probabilities.shape) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb269-59"><a href="#cb269-59" aria-hidden="true" tabindex="-1"></a>        ax6.hist(probabilities[:, <span class="dv">1</span>], bins<span class="op">=</span><span class="dv">30</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb269-60"><a href="#cb269-60" aria-hidden="true" tabindex="-1"></a>        ax6.set_xlabel(<span class="st">&#39;Prediction Probability&#39;</span>)</span>
<span id="cb269-61"><a href="#cb269-61" aria-hidden="true" tabindex="-1"></a>        ax6.set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb269-62"><a href="#cb269-62" aria-hidden="true" tabindex="-1"></a>        ax6.set_title(<span class="st">&#39;Prediction Distribution&#39;</span>)</span>
<span id="cb269-63"><a href="#cb269-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-64"><a href="#cb269-64" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb269-65"><a href="#cb269-65" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<h3 data-number="16.6.2" id="interactive-explanations"><span
class="header-section-number">16.6.2</span> 2. Interactive
Explanations</h3>
<div class="sourceCode" id="cb270"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_interactive_explanation(predictor, X, instance_idx<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> predictor.get_model_best()</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SHAP –∑–Ω–∞—á–µ–Ω–∏—è</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>    explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>    shap_values <span class="op">=</span> explainer.shap_values(X.iloc[instance_idx:instance_idx<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞</span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> go.Figure()</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Waterfall plot</span></span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> X.columns</span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> shap_values[<span class="dv">0</span>]</span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Bar(</span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>features,</span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>values,</span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">&#39;SHAP Values&#39;</span>,</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a>        marker_color<span class="op">=</span>[<span class="st">&#39;red&#39;</span> <span class="cf">if</span> v <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;green&#39;</span> <span class="cf">for</span> v <span class="kw">in</span> values]</span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="ss">f&#39;SHAP Values for Instance </span><span class="sc">{</span>instance_idx<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">&#39;Features&#39;</span>,</span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">&#39;SHAP Value&#39;</span>,</span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span></code></pre></div>
<h2 data-number="16.7" id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"><span
class="header-section-number">16.7</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
<h3 data-number="16.7.1" id="–≤—ã–±–æ—Ä-–º–µ—Ç–æ–¥–∞-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è"><span
class="header-section-number">16.7.1</span> 1. –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞
–æ–±—ä—è—Å–Ω–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb271"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> choose_explanation_method(model_type, data_size, interpretability_requirement):</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –º–µ—Ç–æ–¥–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> interpretability_requirement <span class="op">==</span> <span class="st">&#39;high&#39;</span>:</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_type <span class="kw">in</span> [<span class="st">&#39;Linear&#39;</span>, <span class="st">&#39;Logistic&#39;</span>]:</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;coefficients&#39;</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;lime&#39;</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> interpretability_requirement <span class="op">==</span> <span class="st">&#39;medium&#39;</span>:</span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data_size <span class="op">&lt;</span> <span class="dv">10000</span>:</span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;shap&#39;</span></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;permutation_importance&#39;</span></span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb271-19"><a href="#cb271-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∏–∑–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb271-20"><a href="#cb271-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;feature_importance&#39;</span></span></code></pre></div>
<h3 data-number="16.7.2" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–æ–±—ä—è—Å–Ω–µ–Ω–∏–π"><span
class="header-section-number">16.7.2</span> 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</h3>
<div class="sourceCode" id="cb272"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> validate_explanations(predictor, X, y, explanation_method<span class="op">=</span><span class="st">&#39;shap&#39;</span>):</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> explanation_method <span class="op">==</span> <span class="st">&#39;shap&#39;</span>:</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>        explainer <span class="op">=</span> shap.TreeExplainer(predictor.get_model_best())</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>        shap_values <span class="op">=</span> explainer.shap_values(X)</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>        consistency_score <span class="op">=</span> shap.utils.consistency_score(shap_values)</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;consistency_score&#39;</span>: consistency_score,</span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;explanation_quality&#39;</span>: <span class="st">&#39;high&#39;</span> <span class="cf">if</span> consistency_score <span class="op">&gt;</span> <span class="fl">0.8</span> <span class="cf">else</span> <span class="st">&#39;medium&#39;</span></span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> explanation_method <span class="op">==</span> <span class="st">&#39;lime&#39;</span>:</span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è LIME</span></span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true" tabindex="-1"></a>        lime_explainer <span class="op">=</span> lime.lime_tabular.LimeTabularExplainer(</span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true" tabindex="-1"></a>            X.values, feature_names<span class="op">=</span>X.columns.tolist()</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö</span></span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true" tabindex="-1"></a>        fidelity_scores <span class="op">=</span> []</span>
<span id="cb272-25"><a href="#cb272-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">min</span>(<span class="dv">10</span>, <span class="bu">len</span>(X))):</span>
<span id="cb272-26"><a href="#cb272-26" aria-hidden="true" tabindex="-1"></a>            explanation <span class="op">=</span> lime_explainer.explain_instance(</span>
<span id="cb272-27"><a href="#cb272-27" aria-hidden="true" tabindex="-1"></a>                X.iloc[i].values, predictor.predict_proba</span>
<span id="cb272-28"><a href="#cb272-28" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb272-29"><a href="#cb272-29" aria-hidden="true" tabindex="-1"></a>            fidelity_scores.append(explanation.score)</span>
<span id="cb272-30"><a href="#cb272-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb272-31"><a href="#cb272-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb272-32"><a href="#cb272-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;average_fidelity&#39;</span>: np.mean(fidelity_scores),</span>
<span id="cb272-33"><a href="#cb272-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;explanation_quality&#39;</span>: <span class="st">&#39;high&#39;</span> <span class="cf">if</span> np.mean(fidelity_scores) <span class="op">&gt;</span> <span class="fl">0.8</span> <span class="cf">else</span> <span class="st">&#39;medium&#39;</span></span>
<span id="cb272-34"><a href="#cb272-34" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="16.8" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-4"><span
class="header-section-number">16.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è:</p>
<ol type="1">
<li><strong>–î–æ–≤–µ—Ä–∏—è –∫ –º–æ–¥–µ–ª–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è
—Ä–µ—à–µ–Ω–∏–π</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act,
—Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</li>
<li><strong>–û—Ç–ª–∞–¥–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è</strong> - –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞
—Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
</ol>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç
—Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ—á–Ω—ã–µ, –Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏ –Ω–∞–¥–µ–∂–Ω—ã–µ ML-–º–æ–¥–µ–ª–∏.</p>
<hr />
<h1 data-number="17" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-automl"><span
class="header-section-number">17</span> –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML</h1>
<h2 data-number="17.0" id="–ø–æ—á–µ–º—É-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">17.0</span> –ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="17.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"><span class="header-section-number">17.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="17.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"><span class="header-section-number">17.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="17.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"><span
class="header-section-number">17.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ
—Ç–µ–º—ã</h2>
<p><img src="images/advanced_topics_overview.png"
alt="–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML" /> <em>–†–∏—Å—É–Ω–æ–∫ 16.1: –û–±–∑–æ—Ä –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º
–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ AutoML</em></p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ–º—ã –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤
–æ–±–ª–∞—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è
–Ω–µ–π—Ä–æ–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–∏—Å–∫, –º–µ—Ç–∞-–æ–±—É—á–µ–Ω–∏–µ, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏
–¥—Ä—É–≥–∏–µ cutting-edge —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.</p>
<h2 data-number="17.2" id="neural-architecture-search-nas-1"><span
class="header-section-number">17.2</span> Neural Architecture Search
(NAS)</h2>
<h3 data-number="17.2.1"
id="differentiable-architecture-search-darts"><span
class="header-section-number">17.2.1</span> 1. Differentiable
Architecture Search (DARTS)</h3>
<div class="sourceCode" id="cb273"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DARTS(nn.Module):</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Differentiable Architecture Search&quot;&quot;&quot;</span></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_channels, output_channels, num_ops<span class="op">=</span><span class="dv">8</span>):</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(DARTS, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.input_channels <span class="op">=</span> input_channels</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_channels <span class="op">=</span> output_channels</span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_ops <span class="op">=</span> num_ops</span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø–µ—Ä–∞—Ü–∏–∏</span></span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ops <span class="op">=</span> nn.ModuleList([</span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(input_channels, output_channels, <span class="dv">1</span>, bias<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(input_channels, output_channels, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>, bias<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(input_channels, output_channels, <span class="dv">5</span>, padding<span class="op">=</span><span class="dv">2</span>, bias<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a>            nn.MaxPool2d(<span class="dv">3</span>, stride<span class="op">=</span><span class="dv">1</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a>            nn.AvgPool2d(<span class="dv">3</span>, stride<span class="op">=</span><span class="dv">1</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a>            nn.Identity() <span class="cf">if</span> input_channels <span class="op">==</span> output_channels <span class="cf">else</span> <span class="va">None</span>,</span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(input_channels, output_channels, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>, dilation<span class="op">=</span><span class="dv">2</span>, bias<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(input_channels, output_channels, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>, dilation<span class="op">=</span><span class="dv">3</span>, bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–µ—Å–∞</span></span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alpha <span class="op">=</span> nn.Parameter(torch.randn(num_ops))</span>
<span id="cb273-28"><a href="#cb273-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-29"><a href="#cb273-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb273-30"><a href="#cb273-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Softmax –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≤–µ—Å–æ–≤</span></span>
<span id="cb273-31"><a href="#cb273-31" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> F.softmax(<span class="va">self</span>.alpha, dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb273-32"><a href="#cb273-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-33"><a href="#cb273-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–π</span></span>
<span id="cb273-34"><a href="#cb273-34" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="bu">sum</span>(w <span class="op">*</span> op(x) <span class="cf">for</span> w, op <span class="kw">in</span> <span class="bu">zip</span>(weights, <span class="va">self</span>.ops) <span class="cf">if</span> op <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>)</span>
<span id="cb273-35"><a href="#cb273-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-36"><a href="#cb273-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output</span>
<span id="cb273-37"><a href="#cb273-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-38"><a href="#cb273-38" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DARTS</span></span>
<span id="cb273-39"><a href="#cb273-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_architecture(train_loader, val_loader, epochs<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb273-40"><a href="#cb273-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –ø–æ–º–æ—â—å—é DARTS&quot;&quot;&quot;</span></span>
<span id="cb273-41"><a href="#cb273-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-42"><a href="#cb273-42" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> DARTS(input_channels<span class="op">=</span><span class="dv">3</span>, output_channels<span class="op">=</span><span class="dv">64</span>)</span>
<span id="cb273-43"><a href="#cb273-43" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.025</span>)</span>
<span id="cb273-44"><a href="#cb273-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-45"><a href="#cb273-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb273-46"><a href="#cb273-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≤–µ—Å–æ–≤</span></span>
<span id="cb273-47"><a href="#cb273-47" aria-hidden="true" tabindex="-1"></a>        model.train()</span>
<span id="cb273-48"><a href="#cb273-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch_idx, (data, target) <span class="kw">in</span> <span class="bu">enumerate</span>(train_loader):</span>
<span id="cb273-49"><a href="#cb273-49" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb273-50"><a href="#cb273-50" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model(data)</span>
<span id="cb273-51"><a href="#cb273-51" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> F.cross_entropy(output, target)</span>
<span id="cb273-52"><a href="#cb273-52" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb273-53"><a href="#cb273-53" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb273-54"><a href="#cb273-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-55"><a href="#cb273-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb273-56"><a href="#cb273-56" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()</span>
<span id="cb273-57"><a href="#cb273-57" aria-hidden="true" tabindex="-1"></a>        val_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb273-58"><a href="#cb273-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb273-59"><a href="#cb273-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> data, target <span class="kw">in</span> val_loader:</span>
<span id="cb273-60"><a href="#cb273-60" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> model(data)</span>
<span id="cb273-61"><a href="#cb273-61" aria-hidden="true" tabindex="-1"></a>                val_loss <span class="op">+=</span> F.cross_entropy(output, target).item()</span>
<span id="cb273-62"><a href="#cb273-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb273-63"><a href="#cb273-63" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">, Validation Loss: </span><span class="sc">{</span>val_loss<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb273-64"><a href="#cb273-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-65"><a href="#cb273-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code></pre></div>
<h3 data-number="17.2.2"
id="efficient-neural-architecture-search-enas"><span
class="header-section-number">17.2.2</span> 2. Efficient Neural
Architecture Search (ENAS)</h3>
<div class="sourceCode" id="cb274"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ENAS(nn.Module):</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Efficient Neural Architecture Search&quot;&quot;&quot;</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_nodes<span class="op">=</span><span class="dv">5</span>, num_ops<span class="op">=</span><span class="dv">8</span>):</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(ENAS, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_nodes <span class="op">=</span> num_nodes</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_ops <span class="op">=</span> num_ops</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (RNN)</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.controller <span class="op">=</span> nn.LSTM(<span class="dv">32</span>, <span class="dv">32</span>, num_layers<span class="op">=</span><span class="dv">2</span>, batch_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.controller_output <span class="op">=</span> nn.Linear(<span class="dv">32</span>, num_nodes <span class="op">*</span> num_ops)</span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø–µ—Ä–∞—Ü–∏–∏</span></span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ops <span class="op">=</span> nn.ModuleList([</span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb274-16"><a href="#cb274-16" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">5</span>, padding<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb274-17"><a href="#cb274-17" aria-hidden="true" tabindex="-1"></a>            nn.MaxPool2d(<span class="dv">3</span>, stride<span class="op">=</span><span class="dv">1</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb274-18"><a href="#cb274-18" aria-hidden="true" tabindex="-1"></a>            nn.AvgPool2d(<span class="dv">3</span>, stride<span class="op">=</span><span class="dv">1</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb274-19"><a href="#cb274-19" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">1</span>),</span>
<span id="cb274-20"><a href="#cb274-20" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>, dilation<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb274-21"><a href="#cb274-21" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(<span class="dv">3</span>, <span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>, dilation<span class="op">=</span><span class="dv">3</span>),</span>
<span id="cb274-22"><a href="#cb274-22" aria-hidden="true" tabindex="-1"></a>            nn.Identity()</span>
<span id="cb274-23"><a href="#cb274-23" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb274-24"><a href="#cb274-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-25"><a href="#cb274-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sample_architecture(<span class="va">self</span>):</span>
<span id="cb274-26"><a href="#cb274-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span></span>
<span id="cb274-27"><a href="#cb274-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä</span></span>
<span id="cb274-28"><a href="#cb274-28" aria-hidden="true" tabindex="-1"></a>        hidden <span class="op">=</span> torch.zeros(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">32</span>)  <span class="co"># LSTM hidden state</span></span>
<span id="cb274-29"><a href="#cb274-29" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> []</span>
<span id="cb274-30"><a href="#cb274-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-31"><a href="#cb274-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_nodes):</span>
<span id="cb274-32"><a href="#cb274-32" aria-hidden="true" tabindex="-1"></a>            output, hidden <span class="op">=</span> <span class="va">self</span>.controller(torch.randn(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">32</span>), hidden)</span>
<span id="cb274-33"><a href="#cb274-33" aria-hidden="true" tabindex="-1"></a>            logits <span class="op">=</span> <span class="va">self</span>.controller_output(output)</span>
<span id="cb274-34"><a href="#cb274-34" aria-hidden="true" tabindex="-1"></a>            logits <span class="op">=</span> logits.view(<span class="va">self</span>.num_nodes, <span class="va">self</span>.num_ops)</span>
<span id="cb274-35"><a href="#cb274-35" aria-hidden="true" tabindex="-1"></a>            probs <span class="op">=</span> F.softmax(logits[i], dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb274-36"><a href="#cb274-36" aria-hidden="true" tabindex="-1"></a>            action <span class="op">=</span> torch.multinomial(probs, <span class="dv">1</span>)</span>
<span id="cb274-37"><a href="#cb274-37" aria-hidden="true" tabindex="-1"></a>            outputs.append(action.item())</span>
<span id="cb274-38"><a href="#cb274-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-39"><a href="#cb274-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> outputs</span>
<span id="cb274-40"><a href="#cb274-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb274-41"><a href="#cb274-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, architecture<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb274-42"><a href="#cb274-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> architecture <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb274-43"><a href="#cb274-43" aria-hidden="true" tabindex="-1"></a>            architecture <span class="op">=</span> <span class="va">self</span>.sample_architecture()</span>
<span id="cb274-44"><a href="#cb274-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-45"><a href="#cb274-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span></span>
<span id="cb274-46"><a href="#cb274-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, op_idx <span class="kw">in</span> <span class="bu">enumerate</span>(architecture):</span>
<span id="cb274-47"><a href="#cb274-47" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">self</span>.ops[op_idx](x)</span>
<span id="cb274-48"><a href="#cb274-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb274-49"><a href="#cb274-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code></pre></div>
<h2 data-number="17.3" id="meta-learning-1"><span
class="header-section-number">17.3</span> Meta-Learning</h2>
<h3 data-number="17.3.1" id="model-agnostic-meta-learning-maml"><span
class="header-section-number">17.3.1</span> 1. Model-Agnostic
Meta-Learning (MAML)</h3>
<div class="sourceCode" id="cb275"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MAML(nn.Module):</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Model-Agnostic Meta-Learning&quot;&quot;&quot;</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, lr<span class="op">=</span><span class="fl">0.01</span>):</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(MAML, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> model</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lr <span class="op">=</span> lr</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.model(x)</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> meta_update(<span class="va">self</span>, support_set, query_set, num_inner_steps<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–µ—Ç–∞-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>        fast_weights <span class="op">=</span> {name: param.clone() <span class="cf">for</span> name, param <span class="kw">in</span> <span class="va">self</span>.model.named_parameters()}</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> step <span class="kw">in</span> <span class="bu">range</span>(num_inner_steps):</span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass –Ω–∞ support set</span></span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>            support_pred <span class="op">=</span> <span class="va">self</span>.forward_with_weights(support_set[<span class="dv">0</span>], fast_weights)</span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a>            support_loss <span class="op">=</span> F.cross_entropy(support_pred, support_set[<span class="dv">1</span>])</span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã</span></span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>            grads <span class="op">=</span> torch.autograd.grad(support_loss, fast_weights.values(), create_graph<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span></span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a>            fast_weights <span class="op">=</span> {name: weight <span class="op">-</span> <span class="va">self</span>.lr <span class="op">*</span> grad </span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">for</span> (name, weight), grad <span class="kw">in</span> <span class="bu">zip</span>(fast_weights.items(), grads)}</span>
<span id="cb275-30"><a href="#cb275-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb275-31"><a href="#cb275-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ query set</span></span>
<span id="cb275-32"><a href="#cb275-32" aria-hidden="true" tabindex="-1"></a>        query_pred <span class="op">=</span> <span class="va">self</span>.forward_with_weights(query_set[<span class="dv">0</span>], fast_weights)</span>
<span id="cb275-33"><a href="#cb275-33" aria-hidden="true" tabindex="-1"></a>        query_loss <span class="op">=</span> F.cross_entropy(query_pred, query_set[<span class="dv">1</span>])</span>
<span id="cb275-34"><a href="#cb275-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb275-35"><a href="#cb275-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> query_loss</span>
<span id="cb275-36"><a href="#cb275-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb275-37"><a href="#cb275-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward_with_weights(<span class="va">self</span>, x, weights):</span>
<span id="cb275-38"><a href="#cb275-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Forward pass —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb275-39"><a href="#cb275-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è forward pass —Å custom –≤–µ—Å–∞–º–∏</span></span>
<span id="cb275-40"><a href="#cb275-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h3 data-number="17.3.2" id="prototypical-networks"><span
class="header-section-number">17.3.2</span> 2. Prototypical
Networks</h3>
<div class="sourceCode" id="cb276"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PrototypicalNetworks(nn.Module):</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Prototypical Networks –¥–ª—è few-shot learning&quot;&quot;&quot;</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_dim, hidden_dim<span class="op">=</span><span class="dv">64</span>):</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(PrototypicalNetworks, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.encoder <span class="op">=</span> nn.Sequential(</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>            nn.Linear(input_dim, hidden_dim),</span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim),</span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, support_set, query_set, num_classes):</span>
<span id="cb276-15"><a href="#cb276-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Forward pass –¥–ª—è few-shot learning&quot;&quot;&quot;</span></span>
<span id="cb276-16"><a href="#cb276-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-17"><a href="#cb276-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ support set</span></span>
<span id="cb276-18"><a href="#cb276-18" aria-hidden="true" tabindex="-1"></a>        support_embeddings <span class="op">=</span> <span class="va">self</span>.encoder(support_set)</span>
<span id="cb276-19"><a href="#cb276-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-20"><a href="#cb276-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤ –∫–ª–∞—Å—Å–æ–≤</span></span>
<span id="cb276-21"><a href="#cb276-21" aria-hidden="true" tabindex="-1"></a>        prototypes <span class="op">=</span> []</span>
<span id="cb276-22"><a href="#cb276-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_classes):</span>
<span id="cb276-23"><a href="#cb276-23" aria-hidden="true" tabindex="-1"></a>            class_mask <span class="op">=</span> (support_set[:, <span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> i)  <span class="co"># –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü - —ç—Ç–æ –∫–ª–∞—Å—Å</span></span>
<span id="cb276-24"><a href="#cb276-24" aria-hidden="true" tabindex="-1"></a>            class_embeddings <span class="op">=</span> support_embeddings[class_mask]</span>
<span id="cb276-25"><a href="#cb276-25" aria-hidden="true" tabindex="-1"></a>            prototype <span class="op">=</span> class_embeddings.mean(dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb276-26"><a href="#cb276-26" aria-hidden="true" tabindex="-1"></a>            prototypes.append(prototype)</span>
<span id="cb276-27"><a href="#cb276-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-28"><a href="#cb276-28" aria-hidden="true" tabindex="-1"></a>        prototypes <span class="op">=</span> torch.stack(prototypes)</span>
<span id="cb276-29"><a href="#cb276-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-30"><a href="#cb276-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ query set</span></span>
<span id="cb276-31"><a href="#cb276-31" aria-hidden="true" tabindex="-1"></a>        query_embeddings <span class="op">=</span> <span class="va">self</span>.encoder(query_set)</span>
<span id="cb276-32"><a href="#cb276-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-33"><a href="#cb276-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –¥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤</span></span>
<span id="cb276-34"><a href="#cb276-34" aria-hidden="true" tabindex="-1"></a>        distances <span class="op">=</span> torch.cdist(query_embeddings, prototypes)</span>
<span id="cb276-35"><a href="#cb276-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-36"><a href="#cb276-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø)</span></span>
<span id="cb276-37"><a href="#cb276-37" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> torch.argmin(distances, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb276-38"><a href="#cb276-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb276-39"><a href="#cb276-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictions, distances</span></code></pre></div>
<h2 data-number="17.4" id="multi-modal-learning"><span
class="header-section-number">17.4</span> Multi-Modal Learning</h2>
<h3 data-number="17.4.1" id="vision-language-models"><span
class="header-section-number">17.4.1</span> 1. Vision-Language
Models</h3>
<div class="sourceCode" id="cb277"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> VisionLanguageModel(nn.Module):</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ç–µ–∫—Å—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_dim<span class="op">=</span><span class="dv">2048</span>, text_dim<span class="op">=</span><span class="dv">768</span>, hidden_dim<span class="op">=</span><span class="dv">512</span>):</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(VisionLanguageModel, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä</span></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.vision_encoder <span class="op">=</span> nn.Sequential(</span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>            nn.Linear(image_dim, hidden_dim),</span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ–∫—Å—Ç–æ–≤—ã–π —ç–Ω–∫–æ–¥–µ—Ä</span></span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.text_encoder <span class="op">=</span> nn.Sequential(</span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a>            nn.Linear(text_dim, hidden_dim),</span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§—å—é–∂–Ω –º–æ–¥—É–ª—å</span></span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fusion <span class="op">=</span> nn.Sequential(</span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim <span class="op">*</span> <span class="dv">2</span>, hidden_dim),</span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, <span class="dv">1</span>)</span>
<span id="cb277-26"><a href="#cb277-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb277-27"><a href="#cb277-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb277-28"><a href="#cb277-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, images, texts):</span>
<span id="cb277-29"><a href="#cb277-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</span></span>
<span id="cb277-30"><a href="#cb277-30" aria-hidden="true" tabindex="-1"></a>        image_features <span class="op">=</span> <span class="va">self</span>.vision_encoder(images)</span>
<span id="cb277-31"><a href="#cb277-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-32"><a href="#cb277-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb277-33"><a href="#cb277-33" aria-hidden="true" tabindex="-1"></a>        text_features <span class="op">=</span> <span class="va">self</span>.text_encoder(texts)</span>
<span id="cb277-34"><a href="#cb277-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-35"><a href="#cb277-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb277-36"><a href="#cb277-36" aria-hidden="true" tabindex="-1"></a>        combined <span class="op">=</span> torch.cat([image_features, text_features], dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb277-37"><a href="#cb277-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-38"><a href="#cb277-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb277-39"><a href="#cb277-39" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">self</span>.fusion(combined)</span>
<span id="cb277-40"><a href="#cb277-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb277-41"><a href="#cb277-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output</span></code></pre></div>
<h3 data-number="17.4.2" id="cross-modal-attention"><span
class="header-section-number">17.4.2</span> 2. Cross-Modal
Attention</h3>
<div class="sourceCode" id="cb278"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CrossModalAttention(nn.Module):</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Cross-modal attention –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dim):</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(CrossModalAttention, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dim <span class="op">=</span> dim</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Attention –º–µ—Ö–∞–Ω–∏–∑–º—ã</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.attention <span class="op">=</span> nn.MultiheadAttention(dim, num_heads<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.norm1 <span class="op">=</span> nn.LayerNorm(dim)</span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.norm2 <span class="op">=</span> nn.LayerNorm(dim)</span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feed-forward</span></span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ff <span class="op">=</span> nn.Sequential(</span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a>            nn.Linear(dim, dim <span class="op">*</span> <span class="dv">4</span>),</span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a>            nn.Linear(dim <span class="op">*</span> <span class="dv">4</span>, dim)</span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb278-21"><a href="#cb278-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb278-22"><a href="#cb278-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, modality1, modality2):</span>
<span id="cb278-23"><a href="#cb278-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cross-attention –º–µ–∂–¥—É –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º–∏</span></span>
<span id="cb278-24"><a href="#cb278-24" aria-hidden="true" tabindex="-1"></a>        attended1, _ <span class="op">=</span> <span class="va">self</span>.attention(modality1, modality2, modality2)</span>
<span id="cb278-25"><a href="#cb278-25" aria-hidden="true" tabindex="-1"></a>        attended1 <span class="op">=</span> <span class="va">self</span>.norm1(attended1 <span class="op">+</span> modality1)</span>
<span id="cb278-26"><a href="#cb278-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-27"><a href="#cb278-27" aria-hidden="true" tabindex="-1"></a>        attended2, _ <span class="op">=</span> <span class="va">self</span>.attention(modality2, modality1, modality1)</span>
<span id="cb278-28"><a href="#cb278-28" aria-hidden="true" tabindex="-1"></a>        attended2 <span class="op">=</span> <span class="va">self</span>.norm1(attended2 <span class="op">+</span> modality2)</span>
<span id="cb278-29"><a href="#cb278-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-30"><a href="#cb278-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feed-forward</span></span>
<span id="cb278-31"><a href="#cb278-31" aria-hidden="true" tabindex="-1"></a>        output1 <span class="op">=</span> <span class="va">self</span>.norm2(attended1 <span class="op">+</span> <span class="va">self</span>.ff(attended1))</span>
<span id="cb278-32"><a href="#cb278-32" aria-hidden="true" tabindex="-1"></a>        output2 <span class="op">=</span> <span class="va">self</span>.norm2(attended2 <span class="op">+</span> <span class="va">self</span>.ff(attended2))</span>
<span id="cb278-33"><a href="#cb278-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb278-34"><a href="#cb278-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output1, output2</span></code></pre></div>
<h2 data-number="17.5" id="federated-learning"><span
class="header-section-number">17.5</span> Federated Learning</h2>
<h3 data-number="17.5.1" id="federated-averaging-fedavg"><span
class="header-section-number">17.5.1</span> 1. Federated Averaging
(FedAvg)</h3>
<div class="sourceCode" id="cb279"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FederatedAveraging:</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Federated Averaging –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, global_model, clients):</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.global_model <span class="op">=</span> global_model</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.clients <span class="op">=</span> clients</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> federated_round(<span class="va">self</span>, num_epochs<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–¥–∏–Ω —Ä–∞—É–Ω–¥ —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞—Ö</span></span>
<span id="cb279-12"><a href="#cb279-12" aria-hidden="true" tabindex="-1"></a>        client_models <span class="op">=</span> []</span>
<span id="cb279-13"><a href="#cb279-13" aria-hidden="true" tabindex="-1"></a>        client_weights <span class="op">=</span> []</span>
<span id="cb279-14"><a href="#cb279-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-15"><a href="#cb279-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> client <span class="kw">in</span> <span class="va">self</span>.clients:</span>
<span id="cb279-16"><a href="#cb279-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb279-17"><a href="#cb279-17" aria-hidden="true" tabindex="-1"></a>            local_model <span class="op">=</span> <span class="va">self</span>.train_client(client, num_epochs)</span>
<span id="cb279-18"><a href="#cb279-18" aria-hidden="true" tabindex="-1"></a>            client_models.append(local_model)</span>
<span id="cb279-19"><a href="#cb279-19" aria-hidden="true" tabindex="-1"></a>            client_weights.append(<span class="bu">len</span>(client.data))  <span class="co"># –í–µ—Å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —Ä–∞–∑–º–µ—Ä—É –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb279-20"><a href="#cb279-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-21"><a href="#cb279-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb279-22"><a href="#cb279-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.aggregate_models(client_models, client_weights)</span>
<span id="cb279-23"><a href="#cb279-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb279-24"><a href="#cb279-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_client(<span class="va">self</span>, client, num_epochs):</span>
<span id="cb279-25"><a href="#cb279-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ&quot;&quot;&quot;</span></span>
<span id="cb279-26"><a href="#cb279-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-27"><a href="#cb279-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb279-28"><a href="#cb279-28" aria-hidden="true" tabindex="-1"></a>        local_model <span class="op">=</span> copy.deepcopy(<span class="va">self</span>.global_model)</span>
<span id="cb279-29"><a href="#cb279-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-30"><a href="#cb279-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb279-31"><a href="#cb279-31" aria-hidden="true" tabindex="-1"></a>        optimizer <span class="op">=</span> torch.optim.SGD(local_model.parameters(), lr<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb279-32"><a href="#cb279-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-33"><a href="#cb279-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb279-34"><a href="#cb279-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> batch <span class="kw">in</span> client.data_loader:</span>
<span id="cb279-35"><a href="#cb279-35" aria-hidden="true" tabindex="-1"></a>                optimizer.zero_grad()</span>
<span id="cb279-36"><a href="#cb279-36" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> local_model(batch[<span class="dv">0</span>])</span>
<span id="cb279-37"><a href="#cb279-37" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> F.cross_entropy(output, batch[<span class="dv">1</span>])</span>
<span id="cb279-38"><a href="#cb279-38" aria-hidden="true" tabindex="-1"></a>                loss.backward()</span>
<span id="cb279-39"><a href="#cb279-39" aria-hidden="true" tabindex="-1"></a>                optimizer.step()</span>
<span id="cb279-40"><a href="#cb279-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-41"><a href="#cb279-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> local_model</span>
<span id="cb279-42"><a href="#cb279-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb279-43"><a href="#cb279-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> aggregate_models(<span class="va">self</span>, client_models, weights):</span>
<span id="cb279-44"><a href="#cb279-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º –≤–µ—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb279-45"><a href="#cb279-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-46"><a href="#cb279-46" aria-hidden="true" tabindex="-1"></a>        total_weight <span class="op">=</span> <span class="bu">sum</span>(weights)</span>
<span id="cb279-47"><a href="#cb279-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-48"><a href="#cb279-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb279-49"><a href="#cb279-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> param <span class="kw">in</span> <span class="va">self</span>.global_model.parameters():</span>
<span id="cb279-50"><a href="#cb279-50" aria-hidden="true" tabindex="-1"></a>            param.data.zero_()</span>
<span id="cb279-51"><a href="#cb279-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb279-52"><a href="#cb279-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ</span></span>
<span id="cb279-53"><a href="#cb279-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> model, weight <span class="kw">in</span> <span class="bu">zip</span>(client_models, weights):</span>
<span id="cb279-54"><a href="#cb279-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> global_param, local_param <span class="kw">in</span> <span class="bu">zip</span>(<span class="va">self</span>.global_model.parameters(), model.parameters()):</span>
<span id="cb279-55"><a href="#cb279-55" aria-hidden="true" tabindex="-1"></a>                global_param.data <span class="op">+=</span> local_param.data <span class="op">*</span> (weight <span class="op">/</span> total_weight)</span></code></pre></div>
<h3 data-number="17.5.2" id="differential-privacy"><span
class="header-section-number">17.5.2</span> 2. Differential Privacy</h3>
<div class="sourceCode" id="cb280"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DifferentialPrivacy:</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Differential Privacy –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, epsilon<span class="op">=</span><span class="fl">1.0</span>, delta<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.epsilon <span class="op">=</span> epsilon</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.delta <span class="op">=</span> delta</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_noise(<span class="va">self</span>, gradients, sensitivity<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —à—É–º–∞</span></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>        sigma <span class="op">=</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> np.log(<span class="fl">1.25</span> <span class="op">/</span> <span class="va">self</span>.delta)) <span class="op">*</span> sensitivity <span class="op">/</span> <span class="va">self</span>.epsilon</span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —à—É–º–∞</span></span>
<span id="cb280-15"><a href="#cb280-15" aria-hidden="true" tabindex="-1"></a>        noise <span class="op">=</span> torch.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>gradients.shape)</span>
<span id="cb280-16"><a href="#cb280-16" aria-hidden="true" tabindex="-1"></a>        noisy_gradients <span class="op">=</span> gradients <span class="op">+</span> noise</span>
<span id="cb280-17"><a href="#cb280-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb280-18"><a href="#cb280-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> noisy_gradients</span>
<span id="cb280-19"><a href="#cb280-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb280-20"><a href="#cb280-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> clip_gradients(<span class="va">self</span>, gradients, max_norm<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb280-21"><a href="#cb280-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—Ä–µ–∑–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb280-22"><a href="#cb280-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb280-23"><a href="#cb280-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># L2 –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb280-24"><a href="#cb280-24" aria-hidden="true" tabindex="-1"></a>        grad_norm <span class="op">=</span> torch.norm(gradients)</span>
<span id="cb280-25"><a href="#cb280-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> grad_norm <span class="op">&gt;</span> max_norm:</span>
<span id="cb280-26"><a href="#cb280-26" aria-hidden="true" tabindex="-1"></a>            gradients <span class="op">=</span> gradients <span class="op">*</span> (max_norm <span class="op">/</span> grad_norm)</span>
<span id="cb280-27"><a href="#cb280-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb280-28"><a href="#cb280-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> gradients</span></code></pre></div>
<h2 data-number="17.6" id="continual-learning"><span
class="header-section-number">17.6</span> Continual Learning</h2>
<h3 data-number="17.6.1" id="elastic-weight-consolidation-ewc"><span
class="header-section-number">17.6.1</span> 1. Elastic Weight
Consolidation (EWC)</h3>
<div class="sourceCode" id="cb281"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ElasticWeightConsolidation:</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Elastic Weight Consolidation –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, lambda_ewc<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> model</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lambda_ewc <span class="op">=</span> lambda_ewc</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fisher_information <span class="op">=</span> {}</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.optimal_params <span class="op">=</span> {}</span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> compute_fisher_information(<span class="va">self</span>, dataloader):</span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –§–∏—à–µ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a>        fisher_info <span class="op">=</span> {}</span>
<span id="cb281-15"><a href="#cb281-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-16"><a href="#cb281-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, param <span class="kw">in</span> <span class="va">self</span>.model.named_parameters():</span>
<span id="cb281-17"><a href="#cb281-17" aria-hidden="true" tabindex="-1"></a>            fisher_info[name] <span class="op">=</span> torch.zeros_like(param)</span>
<span id="cb281-18"><a href="#cb281-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-19"><a href="#cb281-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch <span class="kw">in</span> dataloader:</span>
<span id="cb281-20"><a href="#cb281-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model.zero_grad()</span>
<span id="cb281-21"><a href="#cb281-21" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="va">self</span>.model(batch[<span class="dv">0</span>])</span>
<span id="cb281-22"><a href="#cb281-22" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> F.cross_entropy(output, batch[<span class="dv">1</span>])</span>
<span id="cb281-23"><a href="#cb281-23" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb281-24"><a href="#cb281-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb281-25"><a href="#cb281-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> name, param <span class="kw">in</span> <span class="va">self</span>.model.named_parameters():</span>
<span id="cb281-26"><a href="#cb281-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> param.grad <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb281-27"><a href="#cb281-27" aria-hidden="true" tabindex="-1"></a>                    fisher_info[name] <span class="op">+=</span> param.grad <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb281-28"><a href="#cb281-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-29"><a href="#cb281-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb281-30"><a href="#cb281-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name <span class="kw">in</span> fisher_info:</span>
<span id="cb281-31"><a href="#cb281-31" aria-hidden="true" tabindex="-1"></a>            fisher_info[name] <span class="op">/=</span> <span class="bu">len</span>(dataloader)</span>
<span id="cb281-32"><a href="#cb281-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-33"><a href="#cb281-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fisher_information <span class="op">=</span> fisher_info</span>
<span id="cb281-34"><a href="#cb281-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-35"><a href="#cb281-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ewc_loss(<span class="va">self</span>, current_loss):</span>
<span id="cb281-36"><a href="#cb281-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ EWC —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∫ loss&quot;&quot;&quot;</span></span>
<span id="cb281-37"><a href="#cb281-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-38"><a href="#cb281-38" aria-hidden="true" tabindex="-1"></a>        ewc_loss <span class="op">=</span> current_loss</span>
<span id="cb281-39"><a href="#cb281-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-40"><a href="#cb281-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, param <span class="kw">in</span> <span class="va">self</span>.model.named_parameters():</span>
<span id="cb281-41"><a href="#cb281-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> name <span class="kw">in</span> <span class="va">self</span>.fisher_information:</span>
<span id="cb281-42"><a href="#cb281-42" aria-hidden="true" tabindex="-1"></a>                ewc_loss <span class="op">+=</span> (<span class="va">self</span>.lambda_ewc <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> torch.<span class="bu">sum</span>(</span>
<span id="cb281-43"><a href="#cb281-43" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.fisher_information[name] <span class="op">*</span> (param <span class="op">-</span> <span class="va">self</span>.optimal_params[name]) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb281-44"><a href="#cb281-44" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb281-45"><a href="#cb281-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb281-46"><a href="#cb281-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ewc_loss</span></code></pre></div>
<h3 data-number="17.6.2" id="progressive-neural-networks"><span
class="header-section-number">17.6.2</span> 2. Progressive Neural
Networks</h3>
<div class="sourceCode" id="cb282"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProgressiveNeuralNetwork(nn.Module):</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Progressive Neural Networks –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_dim, hidden_dim<span class="op">=</span><span class="dv">64</span>):</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(ProgressiveNeuralNetwork, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.columns <span class="op">=</span> nn.ModuleList()</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lateral_connections <span class="op">=</span> nn.ModuleList()</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞</span></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>        first_column <span class="op">=</span> nn.Sequential(</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>            nn.Linear(input_dim, hidden_dim),</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.columns.append(first_column)</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_column(<span class="va">self</span>, input_dim, hidden_dim<span class="op">=</span><span class="dv">64</span>):</span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏&quot;&quot;&quot;</span></span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞</span></span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a>        new_column <span class="op">=</span> nn.Sequential(</span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a>            nn.Linear(input_dim, hidden_dim),</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb282-25"><a href="#cb282-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb282-26"><a href="#cb282-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.columns.append(new_column)</span>
<span id="cb282-27"><a href="#cb282-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-28"><a href="#cb282-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–æ–∫–æ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏</span></span>
<span id="cb282-29"><a href="#cb282-29" aria-hidden="true" tabindex="-1"></a>        lateral_conn <span class="op">=</span> nn.ModuleList()</span>
<span id="cb282-30"><a href="#cb282-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="va">self</span>.columns) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb282-31"><a href="#cb282-31" aria-hidden="true" tabindex="-1"></a>            lateral_conn.append(nn.Linear(hidden_dim, hidden_dim))</span>
<span id="cb282-32"><a href="#cb282-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lateral_connections.append(lateral_conn)</span>
<span id="cb282-33"><a href="#cb282-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb282-34"><a href="#cb282-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, column_idx):</span>
<span id="cb282-35"><a href="#cb282-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Forward pass –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb282-36"><a href="#cb282-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-37"><a href="#cb282-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å —á–µ—Ä–µ–∑ —Ç–µ–∫—É—â—É—é –∫–æ–ª–æ–Ω–∫—É</span></span>
<span id="cb282-38"><a href="#cb282-38" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">self</span>.columns[column_idx](x)</span>
<span id="cb282-39"><a href="#cb282-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-40"><a href="#cb282-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–æ–∫–æ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏</span></span>
<span id="cb282-41"><a href="#cb282-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(column_idx):</span>
<span id="cb282-42"><a href="#cb282-42" aria-hidden="true" tabindex="-1"></a>            lateral_output <span class="op">=</span> <span class="va">self</span>.lateral_connections[column_idx][i](</span>
<span id="cb282-43"><a href="#cb282-43" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.columns[i](x)</span>
<span id="cb282-44"><a href="#cb282-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb282-45"><a href="#cb282-45" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> output <span class="op">+</span> lateral_output</span>
<span id="cb282-46"><a href="#cb282-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb282-47"><a href="#cb282-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output</span></code></pre></div>
<h2 data-number="17.7" id="quantum-machine-learning"><span
class="header-section-number">17.7</span> Quantum Machine Learning</h2>
<h3 data-number="17.7.1" id="quantum-neural-networks"><span
class="header-section-number">17.7.1</span> 1. Quantum Neural
Networks</h3>
<div class="sourceCode" id="cb283"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PennyLane</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pennylane <span class="im">as</span> qml</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quantum_neural_network(params, x):</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–≤–∞–Ω—Ç–æ–≤–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å&quot;&quot;&quot;</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>        qml.RY(x[i], wires<span class="op">=</span>i)</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–∏</span></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> layer <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(params)):</span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a>            qml.RY(params[layer][i], wires<span class="op">=</span>i)</span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –≠–Ω—Çangling gates</span></span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb283-19"><a href="#cb283-19" aria-hidden="true" tabindex="-1"></a>            qml.CNOT(wires<span class="op">=</span>[i, i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb283-20"><a href="#cb283-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-21"><a href="#cb283-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–∑–º–µ—Ä–µ–Ω–∏–µ</span></span>
<span id="cb283-22"><a href="#cb283-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [qml.expval(qml.PauliZ(i)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x))]</span>
<span id="cb283-23"><a href="#cb283-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-24"><a href="#cb283-24" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</span></span>
<span id="cb283-25"><a href="#cb283-25" aria-hidden="true" tabindex="-1"></a>dev <span class="op">=</span> qml.device(<span class="st">&#39;default.qubit&#39;</span>, wires<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb283-26"><a href="#cb283-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-27"><a href="#cb283-27" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ QNode</span></span>
<span id="cb283-28"><a href="#cb283-28" aria-hidden="true" tabindex="-1"></a>qnode <span class="op">=</span> qml.QNode(quantum_neural_network, dev)</span>
<span id="cb283-29"><a href="#cb283-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-30"><a href="#cb283-30" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb283-31"><a href="#cb283-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_quantum_model(X, y, num_layers<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb283-32"><a href="#cb283-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb283-33"><a href="#cb283-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-34"><a href="#cb283-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb283-35"><a href="#cb283-35" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, (num_layers, <span class="bu">len</span>(X[<span class="dv">0</span>])))</span>
<span id="cb283-36"><a href="#cb283-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-37"><a href="#cb283-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä</span></span>
<span id="cb283-38"><a href="#cb283-38" aria-hidden="true" tabindex="-1"></a>    opt <span class="op">=</span> qml.GradientDescentOptimizer(stepsize<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb283-39"><a href="#cb283-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-40"><a href="#cb283-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb283-41"><a href="#cb283-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span></span>
<span id="cb283-42"><a href="#cb283-42" aria-hidden="true" tabindex="-1"></a>        grads <span class="op">=</span> qml.grad(qnode)(params, X[<span class="dv">0</span>])</span>
<span id="cb283-43"><a href="#cb283-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb283-44"><a href="#cb283-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb283-45"><a href="#cb283-45" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> opt.step(qnode, params, X[<span class="dv">0</span>])</span>
<span id="cb283-46"><a href="#cb283-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb283-47"><a href="#cb283-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iteration <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb283-48"><a href="#cb283-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Iteration </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss">, Cost: </span><span class="sc">{</span>qnode(params, X[<span class="dv">0</span>])<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb283-49"><a href="#cb283-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb283-50"><a href="#cb283-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> params</span></code></pre></div>
<h2 data-number="17.8" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-5"><span
class="header-section-number">17.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞—é—â—É—é—Å—è
–æ–±–ª–∞—Å—Ç—å, –≤–∫–ª—é—á–∞—é—â—É—é:</p>
<ol type="1">
<li><strong>Neural Architecture Search</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä</li>
<li><strong>Meta-Learning</strong> - –æ–±—É—á–µ–Ω–∏–µ —Ç–æ–º—É, –∫–∞–∫ —É—á–∏—Ç—å—Å—è</li>
<li><strong>Multi-Modal Learning</strong> - —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
–¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>Federated Learning</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å
—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</li>
<li><strong>Continual Learning</strong> - –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑
–∑–∞–±—ã–≤–∞–Ω–∏—è</li>
<li><strong>Quantum Machine Learning</strong> - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö
–≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
</ol>
<p>–≠—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –∏ –º–æ—â–Ω—ã—Ö ML-—Å–∏—Å—Ç–µ–º, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–æ–≥–æ
–ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–∞–∫ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤, —Ç–∞–∫ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –∏—Ö
–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.</p>
<hr />
<h1 data-number="18" id="—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai"><span
class="header-section-number">18</span> –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</h1>
<h2 data-number="18.0" id="–ø–æ—á–µ–º—É-—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">18.0</span> –ü–æ—á–µ–º—É —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="18.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai"><span class="header-section-number">18.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="18.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai"><span class="header-section-number">18.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —ç—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π ai?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="18.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—ç—Ç–∏–∫—É-ai"><span
class="header-section-number">18.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —ç—Ç–∏–∫—É AI</h2>
<p><img src="images/ai_ethics_overview.png"
alt="–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI" /> <em>–†–∏—Å—É–Ω–æ–∫ 17.1: –ü—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ –∏
–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞</em></p>
<p>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–µ–π –Ω–µ—Å—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é
–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –ø—Ä–∞–≤–æ–≤—ã–µ
—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö AI-—Å–∏—Å—Ç–µ–º.</p>
<h2 data-number="18.2" id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-—ç—Ç–∏—á–Ω–æ–≥–æ-ai"><span
class="header-section-number">18.2</span> –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ
AI</h2>
<h3 data-number="18.2.1"
id="—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å-–∏-–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ-–¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏"><span
class="header-section-number">18.2.1</span> 1. –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å –∏
–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏</h3>
<div class="sourceCode" id="cb284"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_fairness(model, X_test, y_test, sensitive_attributes):</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> model.predict(X_test)</span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>    fairness_metrics <span class="op">=</span> {}</span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> attr <span class="kw">in</span> sensitive_attributes:</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∞—Ç—Ä–∏–±—É—Ç–∞–º</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> X_test[attr].unique()</span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>        group_metrics <span class="op">=</span> {}</span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> group <span class="kw">in</span> groups:</span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a>            mask <span class="op">=</span> X_test[attr] <span class="op">==</span> group</span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a>            group_predictions <span class="op">=</span> predictions[mask]</span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a>            group_actual <span class="op">=</span> y_test[mask]</span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã</span></span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a>            accuracy <span class="op">=</span> (group_predictions <span class="op">==</span> group_actual).mean()</span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a>            precision <span class="op">=</span> calculate_precision(group_predictions, group_actual)</span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a>            recall <span class="op">=</span> calculate_recall(group_predictions, group_actual)</span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb284-28"><a href="#cb284-28" aria-hidden="true" tabindex="-1"></a>            group_metrics[group] <span class="op">=</span> {</span>
<span id="cb284-29"><a href="#cb284-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;accuracy&#39;</span>: accuracy,</span>
<span id="cb284-30"><a href="#cb284-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;precision&#39;</span>: precision,</span>
<span id="cb284-31"><a href="#cb284-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;recall&#39;</span>: recall</span>
<span id="cb284-32"><a href="#cb284-32" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb284-33"><a href="#cb284-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb284-34"><a href="#cb284-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏</span></span>
<span id="cb284-35"><a href="#cb284-35" aria-hidden="true" tabindex="-1"></a>        accuracies <span class="op">=</span> [metrics[<span class="st">&#39;accuracy&#39;</span>] <span class="cf">for</span> metrics <span class="kw">in</span> group_metrics.values()]</span>
<span id="cb284-36"><a href="#cb284-36" aria-hidden="true" tabindex="-1"></a>        max_diff <span class="op">=</span> <span class="bu">max</span>(accuracies) <span class="op">-</span> <span class="bu">min</span>(accuracies)</span>
<span id="cb284-37"><a href="#cb284-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb284-38"><a href="#cb284-38" aria-hidden="true" tabindex="-1"></a>        fairness_metrics[attr] <span class="op">=</span> {</span>
<span id="cb284-39"><a href="#cb284-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;group_metrics&#39;</span>: group_metrics,</span>
<span id="cb284-40"><a href="#cb284-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_accuracy_difference&#39;</span>: max_diff,</span>
<span id="cb284-41"><a href="#cb284-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;is_fair&#39;</span>: max_diff <span class="op">&lt;</span> <span class="fl">0.1</span>  <span class="co"># –ü–æ—Ä–æ–≥ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏</span></span>
<span id="cb284-42"><a href="#cb284-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb284-43"><a href="#cb284-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-44"><a href="#cb284-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fairness_metrics</span>
<span id="cb284-45"><a href="#cb284-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-46"><a href="#cb284-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_precision(predictions, actual):</span>
<span id="cb284-47"><a href="#cb284-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb284-48"><a href="#cb284-48" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> ((predictions <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (actual <span class="op">==</span> <span class="dv">1</span>)).<span class="bu">sum</span>()</span>
<span id="cb284-49"><a href="#cb284-49" aria-hidden="true" tabindex="-1"></a>    fp <span class="op">=</span> ((predictions <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (actual <span class="op">==</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span>
<span id="cb284-50"><a href="#cb284-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tp <span class="op">/</span> (tp <span class="op">+</span> fp) <span class="cf">if</span> (tp <span class="op">+</span> fp) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb284-51"><a href="#cb284-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-52"><a href="#cb284-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_recall(predictions, actual):</span>
<span id="cb284-53"><a href="#cb284-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ø–æ–ª–Ω–æ—Ç—ã&quot;&quot;&quot;</span></span>
<span id="cb284-54"><a href="#cb284-54" aria-hidden="true" tabindex="-1"></a>    tp <span class="op">=</span> ((predictions <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (actual <span class="op">==</span> <span class="dv">1</span>)).<span class="bu">sum</span>()</span>
<span id="cb284-55"><a href="#cb284-55" aria-hidden="true" tabindex="-1"></a>    fn <span class="op">=</span> ((predictions <span class="op">==</span> <span class="dv">0</span>) <span class="op">&amp;</span> (actual <span class="op">==</span> <span class="dv">1</span>)).<span class="bu">sum</span>()</span>
<span id="cb284-56"><a href="#cb284-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn) <span class="cf">if</span> (tp <span class="op">+</span> fn) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span></code></pre></div>
<h3 data-number="18.2.2" id="–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å-–∏-–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å"><span
class="header-section-number">18.2.2</span> 2. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏
–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</h3>
<div class="sourceCode" id="cb285"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lime.lime_tabular</span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EthicalModelWrapper:</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —ç—Ç–∏—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, feature_names, sensitive_attributes):</span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> model</span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_names <span class="op">=</span> feature_names</span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sensitive_attributes <span class="op">=</span> sensitive_attributes</span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.explainer <span class="op">=</span> <span class="va">None</span></span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_explainer(<span class="va">self</span>, X_train):</span>
<span id="cb285-15"><a href="#cb285-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–∏—Ç–µ–ª—è –¥–ª—è –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb285-16"><a href="#cb285-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-17"><a href="#cb285-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SHAP explainer</span></span>
<span id="cb285-18"><a href="#cb285-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.shap_explainer <span class="op">=</span> shap.TreeExplainer(<span class="va">self</span>.model)</span>
<span id="cb285-19"><a href="#cb285-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-20"><a href="#cb285-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># LIME explainer</span></span>
<span id="cb285-21"><a href="#cb285-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lime_explainer <span class="op">=</span> lime.lime_tabular.LimeTabularExplainer(</span>
<span id="cb285-22"><a href="#cb285-22" aria-hidden="true" tabindex="-1"></a>            X_train.values,</span>
<span id="cb285-23"><a href="#cb285-23" aria-hidden="true" tabindex="-1"></a>            feature_names<span class="op">=</span><span class="va">self</span>.feature_names,</span>
<span id="cb285-24"><a href="#cb285-24" aria-hidden="true" tabindex="-1"></a>            class_names<span class="op">=</span>[<span class="st">&#39;Class 0&#39;</span>, <span class="st">&#39;Class 1&#39;</span>],</span>
<span id="cb285-25"><a href="#cb285-25" aria-hidden="true" tabindex="-1"></a>            mode<span class="op">=</span><span class="st">&#39;classification&#39;</span></span>
<span id="cb285-26"><a href="#cb285-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb285-27"><a href="#cb285-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb285-28"><a href="#cb285-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> explain_prediction(<span class="va">self</span>, instance, method<span class="op">=</span><span class="st">&#39;shap&#39;</span>):</span>
<span id="cb285-29"><a href="#cb285-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb285-30"><a href="#cb285-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-31"><a href="#cb285-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> method <span class="op">==</span> <span class="st">&#39;shap&#39;</span>:</span>
<span id="cb285-32"><a href="#cb285-32" aria-hidden="true" tabindex="-1"></a>            shap_values <span class="op">=</span> <span class="va">self</span>.shap_explainer.shap_values(instance)</span>
<span id="cb285-33"><a href="#cb285-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> shap_values</span>
<span id="cb285-34"><a href="#cb285-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> method <span class="op">==</span> <span class="st">&#39;lime&#39;</span>:</span>
<span id="cb285-35"><a href="#cb285-35" aria-hidden="true" tabindex="-1"></a>            explanation <span class="op">=</span> <span class="va">self</span>.lime_explainer.explain_instance(</span>
<span id="cb285-36"><a href="#cb285-36" aria-hidden="true" tabindex="-1"></a>                instance.values,</span>
<span id="cb285-37"><a href="#cb285-37" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.model.predict_proba,</span>
<span id="cb285-38"><a href="#cb285-38" aria-hidden="true" tabindex="-1"></a>                num_features<span class="op">=</span><span class="dv">10</span></span>
<span id="cb285-39"><a href="#cb285-39" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb285-40"><a href="#cb285-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> explanation</span>
<span id="cb285-41"><a href="#cb285-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb285-42"><a href="#cb285-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Method must be &#39;shap&#39; or &#39;lime&#39;&quot;</span>)</span>
<span id="cb285-43"><a href="#cb285-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb285-44"><a href="#cb285-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_bias_in_explanation(<span class="va">self</span>, instance):</span>
<span id="cb285-45"><a href="#cb285-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–º–µ—â–µ–Ω–∏–π –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb285-46"><a href="#cb285-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-47"><a href="#cb285-47" aria-hidden="true" tabindex="-1"></a>        explanation <span class="op">=</span> <span class="va">self</span>.explain_prediction(instance, method<span class="op">=</span><span class="st">&#39;lime&#39;</span>)</span>
<span id="cb285-48"><a href="#cb285-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-49"><a href="#cb285-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span></span>
<span id="cb285-50"><a href="#cb285-50" aria-hidden="true" tabindex="-1"></a>        sensitive_importance <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb285-51"><a href="#cb285-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> attr <span class="kw">in</span> <span class="va">self</span>.sensitive_attributes:</span>
<span id="cb285-52"><a href="#cb285-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> attr <span class="kw">in</span> explanation.as_list():</span>
<span id="cb285-53"><a href="#cb285-53" aria-hidden="true" tabindex="-1"></a>                sensitive_importance <span class="op">+=</span> <span class="bu">abs</span>(explanation.as_list()[attr][<span class="dv">1</span>])</span>
<span id="cb285-54"><a href="#cb285-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-55"><a href="#cb285-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ï—Å–ª–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∏–º–µ—é—Ç –≤—ã—Å–æ–∫—É—é –≤–∞–∂–Ω–æ—Å—Ç—å - –≤–æ–∑–º–æ–∂–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ</span></span>
<span id="cb285-56"><a href="#cb285-56" aria-hidden="true" tabindex="-1"></a>        bias_detected <span class="op">=</span> sensitive_importance <span class="op">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb285-57"><a href="#cb285-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb285-58"><a href="#cb285-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb285-59"><a href="#cb285-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bias_detected&#39;</span>: bias_detected,</span>
<span id="cb285-60"><a href="#cb285-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sensitive_importance&#39;</span>: sensitive_importance,</span>
<span id="cb285-61"><a href="#cb285-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;explanation&#39;</span>: explanation</span>
<span id="cb285-62"><a href="#cb285-62" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="18.2.3" id="–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å-–∏-–∑–∞—â–∏—Ç–∞-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">18.2.3</span> 3. –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞
–¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb286"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PrivacyPreservingML:</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;ML —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, epsilon<span class="op">=</span><span class="fl">1.0</span>, delta<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.epsilon <span class="op">=</span> epsilon</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.delta <span class="op">=</span> delta</span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_differential_privacy_noise(<span class="va">self</span>, data, sensitivity<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —à—É–º–∞</span></span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a>        sigma <span class="op">=</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> np.log(<span class="fl">1.25</span> <span class="op">/</span> <span class="va">self</span>.delta)) <span class="op">*</span> sensitivity <span class="op">/</span> <span class="va">self</span>.epsilon</span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —à—É–º–∞</span></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a>        noise <span class="op">=</span> np.random.normal(<span class="dv">0</span>, sigma, data.shape)</span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a>        noisy_data <span class="op">=</span> data <span class="op">+</span> noise</span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> noisy_data</span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> k_anonymity_check(<span class="va">self</span>, data, quasi_identifiers, k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb286-24"><a href="#cb286-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ k-–∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb286-25"><a href="#cb286-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-26"><a href="#cb286-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–≤–∞–∑–∏-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º</span></span>
<span id="cb286-27"><a href="#cb286-27" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> data.groupby(quasi_identifiers).size()</span>
<span id="cb286-28"><a href="#cb286-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-29"><a href="#cb286-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä—É–ø–ø—ã</span></span>
<span id="cb286-30"><a href="#cb286-30" aria-hidden="true" tabindex="-1"></a>        min_group_size <span class="op">=</span> groups.<span class="bu">min</span>()</span>
<span id="cb286-31"><a href="#cb286-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-32"><a href="#cb286-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb286-33"><a href="#cb286-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;k_anonymity_satisfied&#39;</span>: min_group_size <span class="op">&gt;=</span> k,</span>
<span id="cb286-34"><a href="#cb286-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min_group_size&#39;</span>: min_group_size,</span>
<span id="cb286-35"><a href="#cb286-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;groups_below_k&#39;</span>: (groups <span class="op">&lt;</span> k).<span class="bu">sum</span>()</span>
<span id="cb286-36"><a href="#cb286-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb286-37"><a href="#cb286-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb286-38"><a href="#cb286-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> l_diversity_check(<span class="va">self</span>, data, quasi_identifiers, sensitive_attribute, l<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb286-39"><a href="#cb286-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ l-—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è&quot;&quot;&quot;</span></span>
<span id="cb286-40"><a href="#cb286-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-41"><a href="#cb286-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–≤–∞–∑–∏-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º</span></span>
<span id="cb286-42"><a href="#cb286-42" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> data.groupby(quasi_identifiers)</span>
<span id="cb286-43"><a href="#cb286-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-44"><a href="#cb286-44" aria-hidden="true" tabindex="-1"></a>        l_diversity_satisfied <span class="op">=</span> <span class="va">True</span></span>
<span id="cb286-45"><a href="#cb286-45" aria-hidden="true" tabindex="-1"></a>        groups_below_l <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb286-46"><a href="#cb286-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-47"><a href="#cb286-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name, group <span class="kw">in</span> groups:</span>
<span id="cb286-48"><a href="#cb286-48" aria-hidden="true" tabindex="-1"></a>            unique_sensitive_values <span class="op">=</span> group[sensitive_attribute].nunique()</span>
<span id="cb286-49"><a href="#cb286-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> unique_sensitive_values <span class="op">&lt;</span> l:</span>
<span id="cb286-50"><a href="#cb286-50" aria-hidden="true" tabindex="-1"></a>                l_diversity_satisfied <span class="op">=</span> <span class="va">False</span></span>
<span id="cb286-51"><a href="#cb286-51" aria-hidden="true" tabindex="-1"></a>                groups_below_l <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb286-52"><a href="#cb286-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb286-53"><a href="#cb286-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb286-54"><a href="#cb286-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l_diversity_satisfied&#39;</span>: l_diversity_satisfied,</span>
<span id="cb286-55"><a href="#cb286-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;groups_below_l&#39;</span>: groups_below_l</span>
<span id="cb286-56"><a href="#cb286-56" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="18.3" id="–ø—Ä–∞–≤–æ–≤—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"><span
class="header-section-number">18.3</span> –ü—Ä–∞–≤–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>
<h3 data-number="18.3.1" id="gdpr-compliance"><span
class="header-section-number">18.3.1</span> 1. GDPR Compliance</h3>
<div class="sourceCode" id="cb287"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GDPRCompliance:</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è GDPR&quot;&quot;&quot;</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_subjects <span class="op">=</span> {}</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processing_purposes <span class="op">=</span> {}</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.consent_records <span class="op">=</span> {}</span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> record_consent(<span class="va">self</span>, subject_id, purpose, consent_given, timestamp):</span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø–∏—Å—å —Å–æ–≥–ª–∞—Å–∏—è —Å—É–±—ä–µ–∫—Ç–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> subject_id <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.consent_records:</span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.consent_records[subject_id] <span class="op">=</span> []</span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.consent_records[subject_id].append({</span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;purpose&#39;</span>: purpose,</span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;consent_given&#39;</span>: consent_given,</span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: timestamp</span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb287-20"><a href="#cb287-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-21"><a href="#cb287-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_consent(<span class="va">self</span>, subject_id, purpose):</span>
<span id="cb287-22"><a href="#cb287-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb287-23"><a href="#cb287-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-24"><a href="#cb287-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> subject_id <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.consent_records:</span>
<span id="cb287-25"><a href="#cb287-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb287-26"><a href="#cb287-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-27"><a href="#cb287-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–π —Ü–µ–ª–∏</span></span>
<span id="cb287-28"><a href="#cb287-28" aria-hidden="true" tabindex="-1"></a>        relevant_consents <span class="op">=</span> [</span>
<span id="cb287-29"><a href="#cb287-29" aria-hidden="true" tabindex="-1"></a>            record <span class="cf">for</span> record <span class="kw">in</span> <span class="va">self</span>.consent_records[subject_id]</span>
<span id="cb287-30"><a href="#cb287-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> record[<span class="st">&#39;purpose&#39;</span>] <span class="op">==</span> purpose</span>
<span id="cb287-31"><a href="#cb287-31" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb287-32"><a href="#cb287-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-33"><a href="#cb287-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> relevant_consents:</span>
<span id="cb287-34"><a href="#cb287-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb287-35"><a href="#cb287-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-36"><a href="#cb287-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è</span></span>
<span id="cb287-37"><a href="#cb287-37" aria-hidden="true" tabindex="-1"></a>        latest_consent <span class="op">=</span> <span class="bu">max</span>(relevant_consents, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;timestamp&#39;</span>])</span>
<span id="cb287-38"><a href="#cb287-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> latest_consent[<span class="st">&#39;consent_given&#39;</span>]</span>
<span id="cb287-39"><a href="#cb287-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-40"><a href="#cb287-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> right_to_erasure(<span class="va">self</span>, subject_id):</span>
<span id="cb287-41"><a href="#cb287-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (–ø—Ä–∞–≤–æ –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º)&quot;&quot;&quot;</span></span>
<span id="cb287-42"><a href="#cb287-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-43"><a href="#cb287-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> subject_id <span class="kw">in</span> <span class="va">self</span>.consent_records:</span>
<span id="cb287-44"><a href="#cb287-44" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> <span class="va">self</span>.consent_records[subject_id]</span>
<span id="cb287-45"><a href="#cb287-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-46"><a href="#cb287-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞</span></span>
<span id="cb287-47"><a href="#cb287-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb287-48"><a href="#cb287-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-49"><a href="#cb287-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> data_portability(<span class="va">self</span>, subject_id):</span>
<span id="cb287-50"><a href="#cb287-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–∞–≤–æ –Ω–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb287-51"><a href="#cb287-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-52"><a href="#cb287-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–∑–≤—Ä–∞—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ</span></span>
<span id="cb287-53"><a href="#cb287-53" aria-hidden="true" tabindex="-1"></a>        subject_data <span class="op">=</span> {</span>
<span id="cb287-54"><a href="#cb287-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;personal_data&#39;</span>: <span class="va">self</span>.get_subject_data(subject_id),</span>
<span id="cb287-55"><a href="#cb287-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;consent_records&#39;</span>: <span class="va">self</span>.consent_records.get(subject_id, []),</span>
<span id="cb287-56"><a href="#cb287-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;processing_history&#39;</span>: <span class="va">self</span>.get_processing_history(subject_id)</span>
<span id="cb287-57"><a href="#cb287-57" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb287-58"><a href="#cb287-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb287-59"><a href="#cb287-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> subject_data</span></code></pre></div>
<h3 data-number="18.3.2" id="ai-act-compliance"><span
class="header-section-number">18.3.2</span> 2. AI Act Compliance</h3>
<div class="sourceCode" id="cb288"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AIActCompliance:</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ AI Act (–ï–°)&quot;&quot;&quot;</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_categories <span class="op">=</span> {</span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;unacceptable&#39;</span>: [],</span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;high&#39;</span>: [],</span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;limited&#39;</span>: [],</span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;minimal&#39;</span>: []</span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> classify_ai_system(<span class="va">self</span>, system_description):</span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è AI —Å–∏—Å—Ç–µ–º—ã –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb288-15"><a href="#cb288-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb288-16"><a href="#cb288-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.is_biometric_identification(system_description):</span>
<span id="cb288-17"><a href="#cb288-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;unacceptable&#39;</span></span>
<span id="cb288-18"><a href="#cb288-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.is_high_risk_application(system_description):</span>
<span id="cb288-19"><a href="#cb288-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;high&#39;</span></span>
<span id="cb288-20"><a href="#cb288-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.is_limited_risk_application(system_description):</span>
<span id="cb288-21"><a href="#cb288-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;limited&#39;</span></span>
<span id="cb288-22"><a href="#cb288-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb288-23"><a href="#cb288-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;minimal&#39;</span></span>
<span id="cb288-24"><a href="#cb288-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-25"><a href="#cb288-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_biometric_identification(<span class="va">self</span>, description):</span>
<span id="cb288-26"><a href="#cb288-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é&quot;&quot;&quot;</span></span>
<span id="cb288-27"><a href="#cb288-27" aria-hidden="true" tabindex="-1"></a>        biometric_keywords <span class="op">=</span> [<span class="st">&#39;face recognition&#39;</span>, <span class="st">&#39;fingerprint&#39;</span>, <span class="st">&#39;iris&#39;</span>, <span class="st">&#39;voice&#39;</span>]</span>
<span id="cb288-28"><a href="#cb288-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">any</span>(keyword <span class="kw">in</span> description.lower() <span class="cf">for</span> keyword <span class="kw">in</span> biometric_keywords)</span>
<span id="cb288-29"><a href="#cb288-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-30"><a href="#cb288-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_high_risk_application(<span class="va">self</span>, description):</span>
<span id="cb288-31"><a href="#cb288-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb288-32"><a href="#cb288-32" aria-hidden="true" tabindex="-1"></a>        high_risk_keywords <span class="op">=</span> [</span>
<span id="cb288-33"><a href="#cb288-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;medical diagnosis&#39;</span>, <span class="st">&#39;credit scoring&#39;</span>, <span class="st">&#39;recruitment&#39;</span>,</span>
<span id="cb288-34"><a href="#cb288-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;law enforcement&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;transport&#39;</span></span>
<span id="cb288-35"><a href="#cb288-35" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb288-36"><a href="#cb288-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">any</span>(keyword <span class="kw">in</span> description.lower() <span class="cf">for</span> keyword <span class="kw">in</span> high_risk_keywords)</span>
<span id="cb288-37"><a href="#cb288-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-38"><a href="#cb288-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_limited_risk_application(<span class="va">self</span>, description):</span>
<span id="cb288-39"><a href="#cb288-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ —Ä–∏—Å–∫–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb288-40"><a href="#cb288-40" aria-hidden="true" tabindex="-1"></a>        limited_risk_keywords <span class="op">=</span> [<span class="st">&#39;chatbot&#39;</span>, <span class="st">&#39;recommendation&#39;</span>, <span class="st">&#39;content moderation&#39;</span>]</span>
<span id="cb288-41"><a href="#cb288-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">any</span>(keyword <span class="kw">in</span> description.lower() <span class="cf">for</span> keyword <span class="kw">in</span> limited_risk_keywords)</span>
<span id="cb288-42"><a href="#cb288-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb288-43"><a href="#cb288-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_compliance_requirements(<span class="va">self</span>, risk_level):</span>
<span id="cb288-44"><a href="#cb288-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb288-45"><a href="#cb288-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb288-46"><a href="#cb288-46" aria-hidden="true" tabindex="-1"></a>        requirements <span class="op">=</span> {</span>
<span id="cb288-47"><a href="#cb288-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;unacceptable&#39;</span>: [</span>
<span id="cb288-48"><a href="#cb288-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;System is prohibited under AI Act&#39;</span></span>
<span id="cb288-49"><a href="#cb288-49" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb288-50"><a href="#cb288-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;high&#39;</span>: [</span>
<span id="cb288-51"><a href="#cb288-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Conformity assessment required&#39;</span>,</span>
<span id="cb288-52"><a href="#cb288-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Risk management system&#39;</span>,</span>
<span id="cb288-53"><a href="#cb288-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Data governance&#39;</span>,</span>
<span id="cb288-54"><a href="#cb288-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Technical documentation&#39;</span>,</span>
<span id="cb288-55"><a href="#cb288-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Record keeping&#39;</span>,</span>
<span id="cb288-56"><a href="#cb288-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Transparency and user information&#39;</span>,</span>
<span id="cb288-57"><a href="#cb288-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Human oversight&#39;</span>,</span>
<span id="cb288-58"><a href="#cb288-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Accuracy, robustness and cybersecurity&#39;</span></span>
<span id="cb288-59"><a href="#cb288-59" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb288-60"><a href="#cb288-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;limited&#39;</span>: [</span>
<span id="cb288-61"><a href="#cb288-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Transparency obligations&#39;</span>,</span>
<span id="cb288-62"><a href="#cb288-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;User information requirements&#39;</span></span>
<span id="cb288-63"><a href="#cb288-63" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb288-64"><a href="#cb288-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;minimal&#39;</span>: [</span>
<span id="cb288-65"><a href="#cb288-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;No specific requirements&#39;</span></span>
<span id="cb288-66"><a href="#cb288-66" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb288-67"><a href="#cb288-67" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb288-68"><a href="#cb288-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb288-69"><a href="#cb288-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> requirements.get(risk_level, [])</span></code></pre></div>
<h2 data-number="18.4" id="bias-detection-and-mitigation"><span
class="header-section-number">18.4</span> Bias Detection and
Mitigation</h2>
<h3 data-number="18.4.1" id="bias-detection"><span
class="header-section-number">18.4.1</span> 1. Bias Detection</h3>
<div class="sourceCode" id="cb289"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BiasDetector:</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏–π –≤ ML –º–æ–¥–µ–ª—è—Ö&quot;&quot;&quot;</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bias_metrics <span class="op">=</span> {}</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> statistical_parity_difference(<span class="va">self</span>, predictions, sensitive_attribute):</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–æ—Å—Ç—å –ø–∞—Ä–∏—Ç–µ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> sensitive_attribute.unique()</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>        spd_values <span class="op">=</span> []</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> group <span class="kw">in</span> groups:</span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>            group_mask <span class="op">=</span> sensitive_attribute <span class="op">==</span> group</span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>            group_positive_rate <span class="op">=</span> predictions[group_mask].mean()</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>            spd_values.append(group_positive_rate)</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–æ–ª–µ–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤</span></span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>        spd <span class="op">=</span> <span class="bu">max</span>(spd_values) <span class="op">-</span> <span class="bu">min</span>(spd_values)</span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;statistical_parity_difference&#39;</span>: spd,</span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;is_fair&#39;</span>: spd <span class="op">&lt;</span> <span class="fl">0.1</span>,  <span class="co"># –ü–æ—Ä–æ–≥ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏</span></span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;group_rates&#39;</span>: <span class="bu">dict</span>(<span class="bu">zip</span>(groups, spd_values))</span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> equalized_odds_difference(<span class="va">self</span>, predictions, actual, sensitive_attribute):</span>
<span id="cb289-28"><a href="#cb289-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞–∑–Ω–æ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–Ω—ã—Ö —à–∞–Ω—Å–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb289-29"><a href="#cb289-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-30"><a href="#cb289-30" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> sensitive_attribute.unique()</span>
<span id="cb289-31"><a href="#cb289-31" aria-hidden="true" tabindex="-1"></a>        tpr_values <span class="op">=</span> []</span>
<span id="cb289-32"><a href="#cb289-32" aria-hidden="true" tabindex="-1"></a>        fpr_values <span class="op">=</span> []</span>
<span id="cb289-33"><a href="#cb289-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-34"><a href="#cb289-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> group <span class="kw">in</span> groups:</span>
<span id="cb289-35"><a href="#cb289-35" aria-hidden="true" tabindex="-1"></a>            group_mask <span class="op">=</span> sensitive_attribute <span class="op">==</span> group</span>
<span id="cb289-36"><a href="#cb289-36" aria-hidden="true" tabindex="-1"></a>            group_predictions <span class="op">=</span> predictions[group_mask]</span>
<span id="cb289-37"><a href="#cb289-37" aria-hidden="true" tabindex="-1"></a>            group_actual <span class="op">=</span> actual[group_mask]</span>
<span id="cb289-38"><a href="#cb289-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb289-39"><a href="#cb289-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># True Positive Rate</span></span>
<span id="cb289-40"><a href="#cb289-40" aria-hidden="true" tabindex="-1"></a>            tpr <span class="op">=</span> ((group_predictions <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (group_actual <span class="op">==</span> <span class="dv">1</span>)).<span class="bu">sum</span>() <span class="op">/</span> (group_actual <span class="op">==</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb289-41"><a href="#cb289-41" aria-hidden="true" tabindex="-1"></a>            tpr_values.append(tpr)</span>
<span id="cb289-42"><a href="#cb289-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb289-43"><a href="#cb289-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># False Positive Rate</span></span>
<span id="cb289-44"><a href="#cb289-44" aria-hidden="true" tabindex="-1"></a>            fpr <span class="op">=</span> ((group_predictions <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (group_actual <span class="op">==</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">/</span> (group_actual <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb289-45"><a href="#cb289-45" aria-hidden="true" tabindex="-1"></a>            fpr_values.append(fpr)</span>
<span id="cb289-46"><a href="#cb289-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-47"><a href="#cb289-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–Ω–æ—Å—Ç–∏ TPR –∏ FPR</span></span>
<span id="cb289-48"><a href="#cb289-48" aria-hidden="true" tabindex="-1"></a>        tpr_diff <span class="op">=</span> <span class="bu">max</span>(tpr_values) <span class="op">-</span> <span class="bu">min</span>(tpr_values)</span>
<span id="cb289-49"><a href="#cb289-49" aria-hidden="true" tabindex="-1"></a>        fpr_diff <span class="op">=</span> <span class="bu">max</span>(fpr_values) <span class="op">-</span> <span class="bu">min</span>(fpr_values)</span>
<span id="cb289-50"><a href="#cb289-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-51"><a href="#cb289-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb289-52"><a href="#cb289-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;equalized_odds_difference&#39;</span>: <span class="bu">max</span>(tpr_diff, fpr_diff),</span>
<span id="cb289-53"><a href="#cb289-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;tpr_difference&#39;</span>: tpr_diff,</span>
<span id="cb289-54"><a href="#cb289-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;fpr_difference&#39;</span>: fpr_diff,</span>
<span id="cb289-55"><a href="#cb289-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;is_fair&#39;</span>: <span class="bu">max</span>(tpr_diff, fpr_diff) <span class="op">&lt;</span> <span class="fl">0.1</span></span>
<span id="cb289-56"><a href="#cb289-56" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb289-57"><a href="#cb289-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-58"><a href="#cb289-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> demographic_parity_difference(<span class="va">self</span>, predictions, sensitive_attribute):</span>
<span id="cb289-59"><a href="#cb289-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞–∑–Ω–æ—Å—Ç—å –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä–∏—Ç–µ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb289-60"><a href="#cb289-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-61"><a href="#cb289-61" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> sensitive_attribute.unique()</span>
<span id="cb289-62"><a href="#cb289-62" aria-hidden="true" tabindex="-1"></a>        positive_rates <span class="op">=</span> []</span>
<span id="cb289-63"><a href="#cb289-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-64"><a href="#cb289-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> group <span class="kw">in</span> groups:</span>
<span id="cb289-65"><a href="#cb289-65" aria-hidden="true" tabindex="-1"></a>            group_mask <span class="op">=</span> sensitive_attribute <span class="op">==</span> group</span>
<span id="cb289-66"><a href="#cb289-66" aria-hidden="true" tabindex="-1"></a>            positive_rate <span class="op">=</span> predictions[group_mask].mean()</span>
<span id="cb289-67"><a href="#cb289-67" aria-hidden="true" tabindex="-1"></a>            positive_rates.append(positive_rate)</span>
<span id="cb289-68"><a href="#cb289-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-69"><a href="#cb289-69" aria-hidden="true" tabindex="-1"></a>        dpd <span class="op">=</span> <span class="bu">max</span>(positive_rates) <span class="op">-</span> <span class="bu">min</span>(positive_rates)</span>
<span id="cb289-70"><a href="#cb289-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb289-71"><a href="#cb289-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb289-72"><a href="#cb289-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;demographic_parity_difference&#39;</span>: dpd,</span>
<span id="cb289-73"><a href="#cb289-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;is_fair&#39;</span>: dpd <span class="op">&lt;</span> <span class="fl">0.1</span>,</span>
<span id="cb289-74"><a href="#cb289-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;group_positive_rates&#39;</span>: <span class="bu">dict</span>(<span class="bu">zip</span>(groups, positive_rates))</span>
<span id="cb289-75"><a href="#cb289-75" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="18.4.2" id="bias-mitigation"><span
class="header-section-number">18.4.2</span> 2. Bias Mitigation</h3>
<div class="sourceCode" id="cb290"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BiasMitigation:</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–µ—Ç–æ–¥—ã —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mitigation_strategies <span class="op">=</span> {}</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preprocess_bias_mitigation(<span class="va">self</span>, X, y, sensitive_attributes):</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span></span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>        X_processed <span class="op">=</span> X.drop(columns<span class="op">=</span>sensitive_attributes)</span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤</span></span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a>        smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a>        X_balanced, y_balanced <span class="op">=</span> smote.fit_resample(X_processed, y)</span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-18"><a href="#cb290-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> X_balanced, y_balanced</span>
<span id="cb290-19"><a href="#cb290-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb290-20"><a href="#cb290-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> inprocess_bias_mitigation(<span class="va">self</span>, model, X, y, sensitive_attributes):</span>
<span id="cb290-21"><a href="#cb290-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–Ω–∏–∂–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb290-22"><a href="#cb290-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-23"><a href="#cb290-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ fairness constraints</span></span>
<span id="cb290-24"><a href="#cb290-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> fairness_loss(y_true, y_pred, sensitive_attr):</span>
<span id="cb290-25"><a href="#cb290-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span></span>
<span id="cb290-26"><a href="#cb290-26" aria-hidden="true" tabindex="-1"></a>            main_loss <span class="op">=</span> F.cross_entropy(y_pred, y_true)</span>
<span id="cb290-27"><a href="#cb290-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb290-28"><a href="#cb290-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fairness penalty</span></span>
<span id="cb290-29"><a href="#cb290-29" aria-hidden="true" tabindex="-1"></a>            groups <span class="op">=</span> sensitive_attr.unique()</span>
<span id="cb290-30"><a href="#cb290-30" aria-hidden="true" tabindex="-1"></a>            fairness_penalty <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb290-31"><a href="#cb290-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb290-32"><a href="#cb290-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> group <span class="kw">in</span> groups:</span>
<span id="cb290-33"><a href="#cb290-33" aria-hidden="true" tabindex="-1"></a>                group_mask <span class="op">=</span> sensitive_attr <span class="op">==</span> group</span>
<span id="cb290-34"><a href="#cb290-34" aria-hidden="true" tabindex="-1"></a>                group_predictions <span class="op">=</span> y_pred[group_mask]</span>
<span id="cb290-35"><a href="#cb290-35" aria-hidden="true" tabindex="-1"></a>                group_positive_rate <span class="op">=</span> group_predictions.mean()</span>
<span id="cb290-36"><a href="#cb290-36" aria-hidden="true" tabindex="-1"></a>                fairness_penalty <span class="op">+=</span> (group_positive_rate <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb290-37"><a href="#cb290-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb290-38"><a href="#cb290-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> main_loss <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> fairness_penalty</span>
<span id="cb290-39"><a href="#cb290-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-40"><a href="#cb290-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fairness_loss</span>
<span id="cb290-41"><a href="#cb290-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb290-42"><a href="#cb290-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> postprocess_bias_mitigation(<span class="va">self</span>, predictions, sensitive_attributes, threshold<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb290-43"><a href="#cb290-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb290-44"><a href="#cb290-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-45"><a href="#cb290-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø</span></span>
<span id="cb290-46"><a href="#cb290-46" aria-hidden="true" tabindex="-1"></a>        adjusted_predictions <span class="op">=</span> predictions.copy()</span>
<span id="cb290-47"><a href="#cb290-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-48"><a href="#cb290-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> group <span class="kw">in</span> sensitive_attributes.unique():</span>
<span id="cb290-49"><a href="#cb290-49" aria-hidden="true" tabindex="-1"></a>            group_mask <span class="op">=</span> sensitive_attributes <span class="op">==</span> group</span>
<span id="cb290-50"><a href="#cb290-50" aria-hidden="true" tabindex="-1"></a>            group_predictions <span class="op">=</span> predictions[group_mask]</span>
<span id="cb290-51"><a href="#cb290-51" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb290-52"><a href="#cb290-52" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–ª—è –≥—Ä—É–ø–ø—ã</span></span>
<span id="cb290-53"><a href="#cb290-53" aria-hidden="true" tabindex="-1"></a>            group_threshold <span class="op">=</span> <span class="va">self</span>.calculate_fair_threshold(</span>
<span id="cb290-54"><a href="#cb290-54" aria-hidden="true" tabindex="-1"></a>                group_predictions, group</span>
<span id="cb290-55"><a href="#cb290-55" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb290-56"><a href="#cb290-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb290-57"><a href="#cb290-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞</span></span>
<span id="cb290-58"><a href="#cb290-58" aria-hidden="true" tabindex="-1"></a>            adjusted_predictions[group_mask] <span class="op">=</span> (</span>
<span id="cb290-59"><a href="#cb290-59" aria-hidden="true" tabindex="-1"></a>                group_predictions <span class="op">&gt;</span> group_threshold</span>
<span id="cb290-60"><a href="#cb290-60" aria-hidden="true" tabindex="-1"></a>            ).astype(<span class="bu">int</span>)</span>
<span id="cb290-61"><a href="#cb290-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-62"><a href="#cb290-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adjusted_predictions</span>
<span id="cb290-63"><a href="#cb290-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb290-64"><a href="#cb290-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_fair_threshold(<span class="va">self</span>, predictions, group):</span>
<span id="cb290-65"><a href="#cb290-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –¥–ª—è –≥—Ä—É–ø–ø—ã&quot;&quot;&quot;</span></span>
<span id="cb290-66"><a href="#cb290-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb290-67"><a href="#cb290-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ - –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã</span></span>
<span id="cb290-68"><a href="#cb290-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.5</span></span></code></pre></div>
<h2 data-number="18.5" id="responsible-ai-framework"><span
class="header-section-number">18.5</span> Responsible AI Framework</h2>
<h3 data-number="18.5.1" id="ai-ethics-checklist"><span
class="header-section-number">18.5.1</span> 1. AI Ethics Checklist</h3>
<div class="sourceCode" id="cb291"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AIEthicsChecklist:</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ß–µ–∫–ª–∏—Å—Ç —ç—Ç–∏—á–Ω–æ—Å—Ç–∏ AI —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checklist <span class="op">=</span> {</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_quality&#39;</span>: [],</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bias_assessment&#39;</span>: [],</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;privacy_protection&#39;</span>: [],</span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;transparency&#39;</span>: [],</span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accountability&#39;</span>: [],</span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;fairness&#39;</span>: [],</span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;safety&#39;</span>: []</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> assess_data_quality(<span class="va">self</span>, data, sensitive_attributes):</span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true" tabindex="-1"></a>        checks <span class="op">=</span> []</span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span></span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true" tabindex="-1"></a>        missing_ratio <span class="op">=</span> data.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> (<span class="bu">len</span>(data) <span class="op">*</span> <span class="bu">len</span>(data.columns))</span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true" tabindex="-1"></a>        checks.append({</span>
<span id="cb291-23"><a href="#cb291-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;check&#39;</span>: <span class="st">&#39;Missing values ratio&#39;</span>,</span>
<span id="cb291-24"><a href="#cb291-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;value&#39;</span>: missing_ratio,</span>
<span id="cb291-25"><a href="#cb291-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;passed&#39;</span>: missing_ratio <span class="op">&lt;</span> <span class="fl">0.1</span>,</span>
<span id="cb291-26"><a href="#cb291-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recommendation&#39;</span>: <span class="st">&#39;Clean missing values&#39;</span> <span class="cf">if</span> missing_ratio <span class="op">&gt;=</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb291-27"><a href="#cb291-27" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb291-28"><a href="#cb291-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-29"><a href="#cb291-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã</span></span>
<span id="cb291-30"><a href="#cb291-30" aria-hidden="true" tabindex="-1"></a>        duplicate_ratio <span class="op">=</span> data.duplicated().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(data)</span>
<span id="cb291-31"><a href="#cb291-31" aria-hidden="true" tabindex="-1"></a>        checks.append({</span>
<span id="cb291-32"><a href="#cb291-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;check&#39;</span>: <span class="st">&#39;Duplicate ratio&#39;</span>,</span>
<span id="cb291-33"><a href="#cb291-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;value&#39;</span>: duplicate_ratio,</span>
<span id="cb291-34"><a href="#cb291-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;passed&#39;</span>: duplicate_ratio <span class="op">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb291-35"><a href="#cb291-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recommendation&#39;</span>: <span class="st">&#39;Remove duplicates&#39;</span> <span class="cf">if</span> duplicate_ratio <span class="op">&gt;=</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb291-36"><a href="#cb291-36" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb291-37"><a href="#cb291-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-38"><a href="#cb291-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span></span>
<span id="cb291-39"><a href="#cb291-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> attr <span class="kw">in</span> sensitive_attributes:</span>
<span id="cb291-40"><a href="#cb291-40" aria-hidden="true" tabindex="-1"></a>            value_counts <span class="op">=</span> data[attr].value_counts()</span>
<span id="cb291-41"><a href="#cb291-41" aria-hidden="true" tabindex="-1"></a>            min_ratio <span class="op">=</span> value_counts.<span class="bu">min</span>() <span class="op">/</span> value_counts.<span class="bu">sum</span>()</span>
<span id="cb291-42"><a href="#cb291-42" aria-hidden="true" tabindex="-1"></a>            checks.append({</span>
<span id="cb291-43"><a href="#cb291-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;check&#39;</span>: <span class="ss">f&#39;Balance of </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb291-44"><a href="#cb291-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;value&#39;</span>: min_ratio,</span>
<span id="cb291-45"><a href="#cb291-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;passed&#39;</span>: min_ratio <span class="op">&gt;</span> <span class="fl">0.1</span>,</span>
<span id="cb291-46"><a href="#cb291-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;recommendation&#39;</span>: <span class="ss">f&#39;Balance </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss"> groups&#39;</span> <span class="cf">if</span> min_ratio <span class="op">&lt;=</span> <span class="fl">0.1</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb291-47"><a href="#cb291-47" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb291-48"><a href="#cb291-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-49"><a href="#cb291-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checklist[<span class="st">&#39;data_quality&#39;</span>] <span class="op">=</span> checks</span>
<span id="cb291-50"><a href="#cb291-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> checks</span>
<span id="cb291-51"><a href="#cb291-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb291-52"><a href="#cb291-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> assess_bias(<span class="va">self</span>, model, X_test, y_test, sensitive_attributes):</span>
<span id="cb291-53"><a href="#cb291-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span></span>
<span id="cb291-54"><a href="#cb291-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-55"><a href="#cb291-55" aria-hidden="true" tabindex="-1"></a>        bias_detector <span class="op">=</span> BiasDetector()</span>
<span id="cb291-56"><a href="#cb291-56" aria-hidden="true" tabindex="-1"></a>        checks <span class="op">=</span> []</span>
<span id="cb291-57"><a href="#cb291-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-58"><a href="#cb291-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> attr <span class="kw">in</span> sensitive_attributes:</span>
<span id="cb291-59"><a href="#cb291-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∏—Ç–µ—Ç</span></span>
<span id="cb291-60"><a href="#cb291-60" aria-hidden="true" tabindex="-1"></a>            spd_result <span class="op">=</span> bias_detector.statistical_parity_difference(</span>
<span id="cb291-61"><a href="#cb291-61" aria-hidden="true" tabindex="-1"></a>                model.predict(X_test), X_test[attr]</span>
<span id="cb291-62"><a href="#cb291-62" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb291-63"><a href="#cb291-63" aria-hidden="true" tabindex="-1"></a>            checks.append({</span>
<span id="cb291-64"><a href="#cb291-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;check&#39;</span>: <span class="ss">f&#39;Statistical parity for </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb291-65"><a href="#cb291-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;value&#39;</span>: spd_result[<span class="st">&#39;statistical_parity_difference&#39;</span>],</span>
<span id="cb291-66"><a href="#cb291-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;passed&#39;</span>: spd_result[<span class="st">&#39;is_fair&#39;</span>],</span>
<span id="cb291-67"><a href="#cb291-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;recommendation&#39;</span>: <span class="ss">f&#39;Address bias in </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">if</span> <span class="kw">not</span> spd_result[<span class="st">&#39;is_fair&#39;</span>] <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb291-68"><a href="#cb291-68" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb291-69"><a href="#cb291-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb291-70"><a href="#cb291-70" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –£—Ä–∞–≤–Ω–µ–Ω–Ω—ã–µ —à–∞–Ω—Å—ã</span></span>
<span id="cb291-71"><a href="#cb291-71" aria-hidden="true" tabindex="-1"></a>            eod_result <span class="op">=</span> bias_detector.equalized_odds_difference(</span>
<span id="cb291-72"><a href="#cb291-72" aria-hidden="true" tabindex="-1"></a>                model.predict(X_test), y_test, X_test[attr]</span>
<span id="cb291-73"><a href="#cb291-73" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb291-74"><a href="#cb291-74" aria-hidden="true" tabindex="-1"></a>            checks.append({</span>
<span id="cb291-75"><a href="#cb291-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;check&#39;</span>: <span class="ss">f&#39;Equalized odds for </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb291-76"><a href="#cb291-76" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;value&#39;</span>: eod_result[<span class="st">&#39;equalized_odds_difference&#39;</span>],</span>
<span id="cb291-77"><a href="#cb291-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;passed&#39;</span>: eod_result[<span class="st">&#39;is_fair&#39;</span>],</span>
<span id="cb291-78"><a href="#cb291-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;recommendation&#39;</span>: <span class="ss">f&#39;Address equalized odds for </span><span class="sc">{</span>attr<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">if</span> <span class="kw">not</span> eod_result[<span class="st">&#39;is_fair&#39;</span>] <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb291-79"><a href="#cb291-79" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb291-80"><a href="#cb291-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-81"><a href="#cb291-81" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checklist[<span class="st">&#39;bias_assessment&#39;</span>] <span class="op">=</span> checks</span>
<span id="cb291-82"><a href="#cb291-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> checks</span>
<span id="cb291-83"><a href="#cb291-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb291-84"><a href="#cb291-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_ethics_report(<span class="va">self</span>):</span>
<span id="cb291-85"><a href="#cb291-85" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ —ç—Ç–∏—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb291-86"><a href="#cb291-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-87"><a href="#cb291-87" aria-hidden="true" tabindex="-1"></a>        report <span class="op">=</span> {</span>
<span id="cb291-88"><a href="#cb291-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;overall_score&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb291-89"><a href="#cb291-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;category_scores&#39;</span>: {},</span>
<span id="cb291-90"><a href="#cb291-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recommendations&#39;</span>: [],</span>
<span id="cb291-91"><a href="#cb291-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;passed_checks&#39;</span>: <span class="dv">0</span>,</span>
<span id="cb291-92"><a href="#cb291-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;total_checks&#39;</span>: <span class="dv">0</span></span>
<span id="cb291-93"><a href="#cb291-93" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb291-94"><a href="#cb291-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-95"><a href="#cb291-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, checks <span class="kw">in</span> <span class="va">self</span>.checklist.items():</span>
<span id="cb291-96"><a href="#cb291-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> checks:</span>
<span id="cb291-97"><a href="#cb291-97" aria-hidden="true" tabindex="-1"></a>                passed <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> check <span class="kw">in</span> checks <span class="cf">if</span> check[<span class="st">&#39;passed&#39;</span>])</span>
<span id="cb291-98"><a href="#cb291-98" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> <span class="bu">len</span>(checks)</span>
<span id="cb291-99"><a href="#cb291-99" aria-hidden="true" tabindex="-1"></a>                score <span class="op">=</span> passed <span class="op">/</span> total <span class="cf">if</span> total <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb291-100"><a href="#cb291-100" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb291-101"><a href="#cb291-101" aria-hidden="true" tabindex="-1"></a>                report[<span class="st">&#39;category_scores&#39;</span>][category] <span class="op">=</span> score</span>
<span id="cb291-102"><a href="#cb291-102" aria-hidden="true" tabindex="-1"></a>                report[<span class="st">&#39;passed_checks&#39;</span>] <span class="op">+=</span> passed</span>
<span id="cb291-103"><a href="#cb291-103" aria-hidden="true" tabindex="-1"></a>                report[<span class="st">&#39;total_checks&#39;</span>] <span class="op">+=</span> total</span>
<span id="cb291-104"><a href="#cb291-104" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb291-105"><a href="#cb291-105" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–±–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span></span>
<span id="cb291-106"><a href="#cb291-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> check <span class="kw">in</span> checks:</span>
<span id="cb291-107"><a href="#cb291-107" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> check.get(<span class="st">&#39;recommendation&#39;</span>):</span>
<span id="cb291-108"><a href="#cb291-108" aria-hidden="true" tabindex="-1"></a>                        report[<span class="st">&#39;recommendations&#39;</span>].append({</span>
<span id="cb291-109"><a href="#cb291-109" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;category&#39;</span>: category,</span>
<span id="cb291-110"><a href="#cb291-110" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;check&#39;</span>: check[<span class="st">&#39;check&#39;</span>],</span>
<span id="cb291-111"><a href="#cb291-111" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;recommendation&#39;</span>: check[<span class="st">&#39;recommendation&#39;</span>]</span>
<span id="cb291-112"><a href="#cb291-112" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb291-113"><a href="#cb291-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-114"><a href="#cb291-114" aria-hidden="true" tabindex="-1"></a>        report[<span class="st">&#39;overall_score&#39;</span>] <span class="op">=</span> report[<span class="st">&#39;passed_checks&#39;</span>] <span class="op">/</span> report[<span class="st">&#39;total_checks&#39;</span>] <span class="cf">if</span> report[<span class="st">&#39;total_checks&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb291-115"><a href="#cb291-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb291-116"><a href="#cb291-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> report</span></code></pre></div>
<h2 data-number="18.6" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-6"><span
class="header-section-number">18.6</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∞
—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ML-—Å–∏—Å—Ç–µ–º. –ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:</p>
<ol type="1">
<li><strong>–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è —Å–æ
–≤—Å–µ–º–∏ –≥—Ä—É–ø–ø–∞–º–∏</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å</strong> - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π
–º–æ–¥–µ–ª–∏</li>
<li><strong>–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</strong> - –∑–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act –∏
–¥—Ä—É–≥–∏–µ</li>
<li><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏–π</strong> - –∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å
–ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç—å—é</li>
<li><strong>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</strong> - —á–µ—Ç–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —Ä–µ—à–µ–Ω–∏—è AI</li>
</ol>
<p>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —ç—Ç–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–æ–≤—ã–º
—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º, –Ω–æ –∏ –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –∫
AI-—Å–∏—Å—Ç–µ–º–∞–º.</p>
<hr />
<h1 data-number="19"
id="–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ä–µ–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–µ–∫—Ç—ã-—Å-automl-gluon"><span
class="header-section-number">19</span> –ö–µ–π—Å-—Å—Ç–∞–¥–∏: –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å
AutoML Gluon</h1>
<h2 data-number="19.0" id="–ø–æ—á–µ–º—É-–∫–µ–π—Å-—Å—Ç–∞–¥–∏-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">19.0</span> –ü–æ—á–µ–º—É –∫–µ–π—Å-—Å—Ç–∞–¥–∏ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –∫–µ–π—Å-—Å—Ç–∞–¥–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="19.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–∫–µ–π—Å-—Å—Ç–∞–¥–∏"><span class="header-section-number">19.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–µ–π—Å-—Å—Ç–∞–¥–∏</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–µ–π—Å-—Å—Ç–∞–¥–∏?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="19.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–∫–µ–π—Å-—Å—Ç–∞–¥–∏"><span class="header-section-number">19.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–µ–π—Å-—Å—Ç–∞–¥–∏</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∫–µ–π—Å-—Å—Ç–∞–¥–∏?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024</p>
<h2 data-number="19.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-–∫–µ–π—Å-—Å—Ç–∞–¥–∏"><span
class="header-section-number">19.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–µ–π—Å-—Å—Ç–∞–¥–∏</h2>
<p><img src="images/case_studies_overview.png"
alt="–ö–µ–π—Å-—Å—Ç–∞–¥–∏ AutoML" /> <em>–†–∏—Å—É–Ω–æ–∫ 18.1: –û–±–∑–æ—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏
–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon</em></p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∫–µ–π—Å-—Å—Ç–∞–¥–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤,
–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ AutoML Gluon –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö –∏
–∑–∞–¥–∞—á–∞—Ö.</p>
<h2 data-number="19.2"
id="–∫–µ–π—Å-1-—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ-—É—Å–ª—É–≥–∏---–∫—Ä–µ–¥–∏—Ç–Ω—ã–π-—Å–∫–æ—Ä–∏–Ω–≥"><span
class="header-section-number">19.2</span> –ö–µ–π—Å 1: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏ -
–ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥</h2>
<h3 data-number="19.2.1" id="–∑–∞–¥–∞—á–∞-4"><span
class="header-section-number">19.2.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –±–∞–Ω–∫–∞ —Å —Ü–µ–ª—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
–ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –≤—ã–¥–∞—á–µ –∫—Ä–µ–¥–∏—Ç–æ–≤.</p>
<h3 data-number="19.2.2" id="–¥–∞–Ω–Ω—ã–µ-4"><span
class="header-section-number">19.2.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 100,000 –∑–∞—è–≤–æ–∫ –Ω–∞ –∫—Ä–µ–¥–∏—Ç</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 50+ (–¥–æ—Ö–æ–¥, –≤–æ–∑—Ä–∞—Å—Ç, –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è,
–∑–∞–Ω—è—Ç–æ—Å—Ç—å –∏ –¥—Ä.)</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –î–µ—Ñ–æ–ª—Ç –ø–æ –∫—Ä–µ–¥–∏—Ç—É
(–±–∏–Ω–∞—Ä–Ω–∞—è)</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 3 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<h3 data-number="19.2.3" id="—Ä–µ—à–µ–Ω–∏–µ"><span
class="header-section-number">19.2.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb292"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CreditScoringSystem:</span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_importance <span class="op">=</span> <span class="va">None</span></span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_and_prepare_data(<span class="va">self</span>, data_path):</span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb292-19"><a href="#cb292-19" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(data_path)</span>
<span id="cb292-20"><a href="#cb292-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-21"><a href="#cb292-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span></span>
<span id="cb292-22"><a href="#cb292-22" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;income&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;income&#39;</span>].fillna(df[<span class="st">&#39;income&#39;</span>].median())</span>
<span id="cb292-23"><a href="#cb292-23" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;employment_years&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;employment_years&#39;</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb292-24"><a href="#cb292-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-25"><a href="#cb292-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb292-26"><a href="#cb292-26" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;debt_to_income_ratio&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;debt&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;income&#39;</span>]</span>
<span id="cb292-27"><a href="#cb292-27" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;credit_utilization&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;credit_used&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;credit_limit&#39;</span>]</span>
<span id="cb292-28"><a href="#cb292-28" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;age_group&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;age&#39;</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">50</span>, <span class="dv">100</span>], labels<span class="op">=</span>[<span class="st">&#39;Young&#39;</span>, <span class="st">&#39;Adult&#39;</span>, <span class="st">&#39;Middle&#39;</span>, <span class="st">&#39;Senior&#39;</span>])</span>
<span id="cb292-29"><a href="#cb292-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-30"><a href="#cb292-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb292-31"><a href="#cb292-31" aria-hidden="true" tabindex="-1"></a>        categorical_features <span class="op">=</span> [<span class="st">&#39;employment_type&#39;</span>, <span class="st">&#39;education&#39;</span>, <span class="st">&#39;marital_status&#39;</span>]</span>
<span id="cb292-32"><a href="#cb292-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> feature <span class="kw">in</span> categorical_features:</span>
<span id="cb292-33"><a href="#cb292-33" aria-hidden="true" tabindex="-1"></a>            df[feature] <span class="op">=</span> df[feature].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb292-34"><a href="#cb292-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-35"><a href="#cb292-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb292-36"><a href="#cb292-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb292-37"><a href="#cb292-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_model(<span class="va">self</span>, train_data, time_limit<span class="op">=</span><span class="dv">3600</span>):</span>
<span id="cb292-38"><a href="#cb292-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb292-39"><a href="#cb292-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-40"><a href="#cb292-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb292-41"><a href="#cb292-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb292-42"><a href="#cb292-42" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;default&#39;</span>,</span>
<span id="cb292-43"><a href="#cb292-43" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb292-44"><a href="#cb292-44" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;roc_auc&#39;</span>,</span>
<span id="cb292-45"><a href="#cb292-45" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;credit_scoring_model&#39;</span></span>
<span id="cb292-46"><a href="#cb292-46" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb292-47"><a href="#cb292-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-48"><a href="#cb292-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</span></span>
<span id="cb292-49"><a href="#cb292-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb292-50"><a href="#cb292-50" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb292-51"><a href="#cb292-51" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span>time_limit,</span>
<span id="cb292-52"><a href="#cb292-52" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb292-53"><a href="#cb292-53" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb292-54"><a href="#cb292-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb292-55"><a href="#cb292-55" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>},</span>
<span id="cb292-56"><a href="#cb292-56" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>}</span>
<span id="cb292-57"><a href="#cb292-57" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb292-58"><a href="#cb292-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb292-59"><a href="#cb292-59" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>},</span>
<span id="cb292-60"><a href="#cb292-60" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>}</span>
<span id="cb292-61"><a href="#cb292-61" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb292-62"><a href="#cb292-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb292-63"><a href="#cb292-63" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>},</span>
<span id="cb292-64"><a href="#cb292-64" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>}</span>
<span id="cb292-65"><a href="#cb292-65" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb292-66"><a href="#cb292-66" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb292-67"><a href="#cb292-67" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb292-68"><a href="#cb292-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-69"><a href="#cb292-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb292-70"><a href="#cb292-70" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_importance <span class="op">=</span> <span class="va">self</span>.predictor.feature_importance(train_data)</span>
<span id="cb292-71"><a href="#cb292-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-72"><a href="#cb292-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span>
<span id="cb292-73"><a href="#cb292-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb292-74"><a href="#cb292-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate_model(<span class="va">self</span>, test_data):</span>
<span id="cb292-75"><a href="#cb292-75" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb292-76"><a href="#cb292-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-77"><a href="#cb292-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb292-78"><a href="#cb292-78" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(test_data)</span>
<span id="cb292-79"><a href="#cb292-79" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(test_data)</span>
<span id="cb292-80"><a href="#cb292-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-81"><a href="#cb292-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb292-82"><a href="#cb292-82" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, roc_auc_score</span>
<span id="cb292-83"><a href="#cb292-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-84"><a href="#cb292-84" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> (predictions <span class="op">==</span> test_data[<span class="st">&#39;default&#39;</span>]).mean()</span>
<span id="cb292-85"><a href="#cb292-85" aria-hidden="true" tabindex="-1"></a>        auc_score <span class="op">=</span> roc_auc_score(test_data[<span class="st">&#39;default&#39;</span>], probabilities[<span class="dv">1</span>])</span>
<span id="cb292-86"><a href="#cb292-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-87"><a href="#cb292-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span></span>
<span id="cb292-88"><a href="#cb292-88" aria-hidden="true" tabindex="-1"></a>        report <span class="op">=</span> classification_report(test_data[<span class="st">&#39;default&#39;</span>], predictions)</span>
<span id="cb292-89"><a href="#cb292-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-90"><a href="#cb292-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span></span>
<span id="cb292-91"><a href="#cb292-91" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(test_data[<span class="st">&#39;default&#39;</span>], predictions)</span>
<span id="cb292-92"><a href="#cb292-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-93"><a href="#cb292-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb292-94"><a href="#cb292-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accuracy&#39;</span>: accuracy,</span>
<span id="cb292-95"><a href="#cb292-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;auc_score&#39;</span>: auc_score,</span>
<span id="cb292-96"><a href="#cb292-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;classification_report&#39;</span>: report,</span>
<span id="cb292-97"><a href="#cb292-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confusion_matrix&#39;</span>: cm,</span>
<span id="cb292-98"><a href="#cb292-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions&#39;</span>: predictions,</span>
<span id="cb292-99"><a href="#cb292-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probabilities&#39;</span>: probabilities</span>
<span id="cb292-100"><a href="#cb292-100" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb292-101"><a href="#cb292-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb292-102"><a href="#cb292-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_scorecard(<span class="va">self</span>, test_data, score_range<span class="op">=</span>(<span class="dv">300</span>, <span class="dv">850</span>)):</span>
<span id="cb292-103"><a href="#cb292-103" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb292-104"><a href="#cb292-104" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-105"><a href="#cb292-105" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(test_data)</span>
<span id="cb292-106"><a href="#cb292-106" aria-hidden="true" tabindex="-1"></a>        default_prob <span class="op">=</span> probabilities[<span class="dv">1</span>]</span>
<span id="cb292-107"><a href="#cb292-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-108"><a href="#cb292-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥</span></span>
<span id="cb292-109"><a href="#cb292-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–≥–∏–∫–∞: —á–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞, —Ç–µ–º –Ω–∏–∂–µ —Ä–µ–π—Ç–∏–Ω–≥</span></span>
<span id="cb292-110"><a href="#cb292-110" aria-hidden="true" tabindex="-1"></a>        scores <span class="op">=</span> score_range[<span class="dv">1</span>] <span class="op">-</span> (default_prob <span class="op">*</span> (score_range[<span class="dv">1</span>] <span class="op">-</span> score_range[<span class="dv">0</span>]))</span>
<span id="cb292-111"><a href="#cb292-111" aria-hidden="true" tabindex="-1"></a>        scores <span class="op">=</span> np.clip(scores, score_range[<span class="dv">0</span>], score_range[<span class="dv">1</span>])</span>
<span id="cb292-112"><a href="#cb292-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb292-113"><a href="#cb292-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> scores</span>
<span id="cb292-114"><a href="#cb292-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-115"><a href="#cb292-115" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb292-116"><a href="#cb292-116" aria-hidden="true" tabindex="-1"></a>credit_system <span class="op">=</span> CreditScoringSystem()</span>
<span id="cb292-117"><a href="#cb292-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-118"><a href="#cb292-118" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb292-119"><a href="#cb292-119" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> credit_system.load_and_prepare_data(<span class="st">&#39;credit_data.csv&#39;</span>)</span>
<span id="cb292-120"><a href="#cb292-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-121"><a href="#cb292-121" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span></span>
<span id="cb292-122"><a href="#cb292-122" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>data[<span class="st">&#39;default&#39;</span>])</span>
<span id="cb292-123"><a href="#cb292-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-124"><a href="#cb292-124" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb292-125"><a href="#cb292-125" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> credit_system.train_model(train_data, time_limit<span class="op">=</span><span class="dv">3600</span>)</span>
<span id="cb292-126"><a href="#cb292-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-127"><a href="#cb292-127" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞</span></span>
<span id="cb292-128"><a href="#cb292-128" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> credit_system.evaluate_model(test_data)</span>
<span id="cb292-129"><a href="#cb292-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>results[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb292-130"><a href="#cb292-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;AUC Score: </span><span class="sc">{</span>results[<span class="st">&#39;auc_score&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb292-131"><a href="#cb292-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-132"><a href="#cb292-132" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤</span></span>
<span id="cb292-133"><a href="#cb292-133" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> credit_system.create_scorecard(test_data)</span></code></pre></div>
<h3 data-number="19.2.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-2"><span
class="header-section-number">19.2.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 87.3%</li>
<li><strong>AUC Score</strong>: 0.923</li>
<li><strong>–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è</strong>: 1 —á–∞—Å</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –í—ã—Å–æ–∫–∞—è (–≤–∞–∂–Ω–æ—Å—Ç—å
–ø—Ä–∏–∑–Ω–∞–∫–æ–≤)</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: –°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å –Ω–∞ 23%, —É—Å–∫–æ—Ä–µ–Ω–∏–µ
–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫ –≤ 5 —Ä–∞–∑</li>
</ul>
<h2 data-number="19.3"
id="–∫–µ–π—Å-2-–∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ---–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞-–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"><span
class="header-section-number">19.3</span> –ö–µ–π—Å 2: –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ -
–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</h2>
<h3 data-number="19.3.1" id="–∑–∞–¥–∞—á–∞-5"><span
class="header-section-number">19.3.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Ä–∞–Ω–Ω–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ
–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.</p>
<h3 data-number="19.3.2" id="–¥–∞–Ω–Ω—ã–µ-5"><span
class="header-section-number">19.3.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 25,000 –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 8 –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–≥–ª—é–∫–æ–∑–∞, –ò–ú–¢,
–≤–æ–∑—Ä–∞—Å—Ç –∏ –¥—Ä.)</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –î–∏–∞–±–µ—Ç (–±–∏–Ω–∞—Ä–Ω–∞—è)</li>
<li><strong>–ò—Å—Ç–æ—á–Ω–∏–∫</strong>: Pima Indians Diabetes Dataset +
–∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</li>
</ul>
<h3 data-number="19.3.3" id="—Ä–µ—à–µ–Ω–∏–µ-1"><span
class="header-section-number">19.3.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb293"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DiabetesDiagnosisSystem:</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_factors <span class="op">=</span> <span class="va">None</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_medical_data(<span class="va">self</span>, data_path):</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(data_path)</span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.validate_medical_data(df)</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-16"><a href="#cb293-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span></span>
<span id="cb293-17"><a href="#cb293-17" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;bmi_category&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;BMI&#39;</span>], </span>
<span id="cb293-18"><a href="#cb293-18" aria-hidden="true" tabindex="-1"></a>                                   bins<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">100</span>], </span>
<span id="cb293-19"><a href="#cb293-19" aria-hidden="true" tabindex="-1"></a>                                   labels<span class="op">=</span>[<span class="st">&#39;Underweight&#39;</span>, <span class="st">&#39;Normal&#39;</span>, <span class="st">&#39;Overweight&#39;</span>, <span class="st">&#39;Obese&#39;</span>])</span>
<span id="cb293-20"><a href="#cb293-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-21"><a href="#cb293-21" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;glucose_category&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;Glucose&#39;</span>], </span>
<span id="cb293-22"><a href="#cb293-22" aria-hidden="true" tabindex="-1"></a>                                      bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">126</span>, <span class="dv">200</span>], </span>
<span id="cb293-23"><a href="#cb293-23" aria-hidden="true" tabindex="-1"></a>                                      labels<span class="op">=</span>[<span class="st">&#39;Normal&#39;</span>, <span class="st">&#39;Prediabetes&#39;</span>, <span class="st">&#39;Diabetes&#39;</span>])</span>
<span id="cb293-24"><a href="#cb293-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-25"><a href="#cb293-25" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;age_group&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;Age&#39;</span>], </span>
<span id="cb293-26"><a href="#cb293-26" aria-hidden="true" tabindex="-1"></a>                               bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">100</span>], </span>
<span id="cb293-27"><a href="#cb293-27" aria-hidden="true" tabindex="-1"></a>                               labels<span class="op">=</span>[<span class="st">&#39;Young&#39;</span>, <span class="st">&#39;Middle&#39;</span>, <span class="st">&#39;Senior&#39;</span>, <span class="st">&#39;Elderly&#39;</span>])</span>
<span id="cb293-28"><a href="#cb293-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-29"><a href="#cb293-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb293-30"><a href="#cb293-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-31"><a href="#cb293-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_medical_data(<span class="va">self</span>, df):</span>
<span id="cb293-32"><a href="#cb293-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span></span>
<span id="cb293-33"><a href="#cb293-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-34"><a href="#cb293-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span></span>
<span id="cb293-35"><a href="#cb293-35" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df[df[<span class="st">&#39;Glucose&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]  <span class="co"># –ì–ª—é–∫–æ–∑–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 0</span></span>
<span id="cb293-36"><a href="#cb293-36" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df[df[<span class="st">&#39;BMI&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]      <span class="co"># –ò–ú–¢ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º</span></span>
<span id="cb293-37"><a href="#cb293-37" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df[df[<span class="st">&#39;Age&#39;</span>] <span class="op">&gt;=</span> <span class="dv">0</span>]     <span class="co"># –í–æ–∑—Ä–∞—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º</span></span>
<span id="cb293-38"><a href="#cb293-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-39"><a href="#cb293-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–º–µ–Ω–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ–¥–∏–∞–Ω–æ–π</span></span>
<span id="cb293-40"><a href="#cb293-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> [<span class="st">&#39;Glucose&#39;</span>, <span class="st">&#39;BloodPressure&#39;</span>, <span class="st">&#39;SkinThickness&#39;</span>, <span class="st">&#39;Insulin&#39;</span>, <span class="st">&#39;BMI&#39;</span>]:</span>
<span id="cb293-41"><a href="#cb293-41" aria-hidden="true" tabindex="-1"></a>            Q1 <span class="op">=</span> df[column].quantile(<span class="fl">0.25</span>)</span>
<span id="cb293-42"><a href="#cb293-42" aria-hidden="true" tabindex="-1"></a>            Q3 <span class="op">=</span> df[column].quantile(<span class="fl">0.75</span>)</span>
<span id="cb293-43"><a href="#cb293-43" aria-hidden="true" tabindex="-1"></a>            IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb293-44"><a href="#cb293-44" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb293-45"><a href="#cb293-45" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb293-46"><a href="#cb293-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb293-47"><a href="#cb293-47" aria-hidden="true" tabindex="-1"></a>            df[column] <span class="op">=</span> np.where(df[column] <span class="op">&lt;</span> lower_bound, df[column].median(), df[column])</span>
<span id="cb293-48"><a href="#cb293-48" aria-hidden="true" tabindex="-1"></a>            df[column] <span class="op">=</span> np.where(df[column] <span class="op">&gt;</span> upper_bound, df[column].median(), df[column])</span>
<span id="cb293-49"><a href="#cb293-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-50"><a href="#cb293-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb293-51"><a href="#cb293-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-52"><a href="#cb293-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_medical_model(<span class="va">self</span>, train_data, time_limit<span class="op">=</span><span class="dv">1800</span>):</span>
<span id="cb293-53"><a href="#cb293-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb293-54"><a href="#cb293-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-55"><a href="#cb293-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å</span></span>
<span id="cb293-56"><a href="#cb293-56" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb293-57"><a href="#cb293-57" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;Outcome&#39;</span>,</span>
<span id="cb293-58"><a href="#cb293-58" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb293-59"><a href="#cb293-59" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;roc_auc&#39;</span>,</span>
<span id="cb293-60"><a href="#cb293-60" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;diabetes_diagnosis_model&#39;</span></span>
<span id="cb293-61"><a href="#cb293-61" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb293-62"><a href="#cb293-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-63"><a href="#cb293-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏</span></span>
<span id="cb293-64"><a href="#cb293-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb293-65"><a href="#cb293-65" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb293-66"><a href="#cb293-66" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span>time_limit,</span>
<span id="cb293-67"><a href="#cb293-67" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb293-68"><a href="#cb293-68" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb293-69"><a href="#cb293-69" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb293-70"><a href="#cb293-70" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>},</span>
<span id="cb293-71"><a href="#cb293-71" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>}</span>
<span id="cb293-72"><a href="#cb293-72" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb293-73"><a href="#cb293-73" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb293-74"><a href="#cb293-74" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.1</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">6</span>},</span>
<span id="cb293-75"><a href="#cb293-75" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>}</span>
<span id="cb293-76"><a href="#cb293-76" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb293-77"><a href="#cb293-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb293-78"><a href="#cb293-78" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb293-79"><a href="#cb293-79" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>}</span>
<span id="cb293-80"><a href="#cb293-80" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb293-81"><a href="#cb293-81" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb293-82"><a href="#cb293-82" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb293-83"><a href="#cb293-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-84"><a href="#cb293-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span>
<span id="cb293-85"><a href="#cb293-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-86"><a href="#cb293-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_risk_assessment(<span class="va">self</span>, patient_data):</span>
<span id="cb293-87"><a href="#cb293-87" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞ –¥–ª—è –ø–∞—Ü–∏–µ–Ω—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb293-88"><a href="#cb293-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-89"><a href="#cb293-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb293-90"><a href="#cb293-90" aria-hidden="true" tabindex="-1"></a>        prediction <span class="op">=</span> <span class="va">self</span>.predictor.predict(patient_data)</span>
<span id="cb293-91"><a href="#cb293-91" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(patient_data)</span>
<span id="cb293-92"><a href="#cb293-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-93"><a href="#cb293-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–∏—Å–∫–∞</span></span>
<span id="cb293-94"><a href="#cb293-94" aria-hidden="true" tabindex="-1"></a>        risk_level <span class="op">=</span> <span class="va">self</span>.interpret_risk(probability[<span class="dv">1</span>])</span>
<span id="cb293-95"><a href="#cb293-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-96"><a href="#cb293-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span></span>
<span id="cb293-97"><a href="#cb293-97" aria-hidden="true" tabindex="-1"></a>        recommendations <span class="op">=</span> <span class="va">self</span>.generate_recommendations(patient_data, risk_level)</span>
<span id="cb293-98"><a href="#cb293-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-99"><a href="#cb293-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb293-100"><a href="#cb293-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction&#39;</span>: prediction[<span class="dv">0</span>],</span>
<span id="cb293-101"><a href="#cb293-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probability&#39;</span>: probability[<span class="dv">1</span>][<span class="dv">0</span>],</span>
<span id="cb293-102"><a href="#cb293-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk_level&#39;</span>: risk_level,</span>
<span id="cb293-103"><a href="#cb293-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recommendations&#39;</span>: recommendations</span>
<span id="cb293-104"><a href="#cb293-104" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb293-105"><a href="#cb293-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-106"><a href="#cb293-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> interpret_risk(<span class="va">self</span>, probability):</span>
<span id="cb293-107"><a href="#cb293-107" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb293-108"><a href="#cb293-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-109"><a href="#cb293-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> probability <span class="op">&lt;</span> <span class="fl">0.3</span>:</span>
<span id="cb293-110"><a href="#cb293-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Low Risk&#39;</span></span>
<span id="cb293-111"><a href="#cb293-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> probability <span class="op">&lt;</span> <span class="fl">0.6</span>:</span>
<span id="cb293-112"><a href="#cb293-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Medium Risk&#39;</span></span>
<span id="cb293-113"><a href="#cb293-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> probability <span class="op">&lt;</span> <span class="fl">0.8</span>:</span>
<span id="cb293-114"><a href="#cb293-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;High Risk&#39;</span></span>
<span id="cb293-115"><a href="#cb293-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb293-116"><a href="#cb293-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;Very High Risk&#39;</span></span>
<span id="cb293-117"><a href="#cb293-117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb293-118"><a href="#cb293-118" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_recommendations(<span class="va">self</span>, patient_data, risk_level):</span>
<span id="cb293-119"><a href="#cb293-119" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span></span>
<span id="cb293-120"><a href="#cb293-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-121"><a href="#cb293-121" aria-hidden="true" tabindex="-1"></a>        recommendations <span class="op">=</span> []</span>
<span id="cb293-122"><a href="#cb293-122" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-123"><a href="#cb293-123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> risk_level <span class="kw">in</span> [<span class="st">&#39;High Risk&#39;</span>, <span class="st">&#39;Very High Risk&#39;</span>]:</span>
<span id="cb293-124"><a href="#cb293-124" aria-hidden="true" tabindex="-1"></a>            recommendations.append(<span class="st">&quot;Immediate consultation with endocrinologist&quot;</span>)</span>
<span id="cb293-125"><a href="#cb293-125" aria-hidden="true" tabindex="-1"></a>            recommendations.append(<span class="st">&quot;Regular blood glucose monitoring&quot;</span>)</span>
<span id="cb293-126"><a href="#cb293-126" aria-hidden="true" tabindex="-1"></a>            recommendations.append(<span class="st">&quot;Lifestyle modifications (diet, exercise)&quot;</span>)</span>
<span id="cb293-127"><a href="#cb293-127" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-128"><a href="#cb293-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> patient_data[<span class="st">&#39;BMI&#39;</span>].iloc[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">30</span>:</span>
<span id="cb293-129"><a href="#cb293-129" aria-hidden="true" tabindex="-1"></a>            recommendations.append(<span class="st">&quot;Weight management program&quot;</span>)</span>
<span id="cb293-130"><a href="#cb293-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-131"><a href="#cb293-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> patient_data[<span class="st">&#39;Glucose&#39;</span>].iloc[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">126</span>:</span>
<span id="cb293-132"><a href="#cb293-132" aria-hidden="true" tabindex="-1"></a>            recommendations.append(<span class="st">&quot;Fasting glucose test&quot;</span>)</span>
<span id="cb293-133"><a href="#cb293-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-134"><a href="#cb293-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> recommendations</span>
<span id="cb293-135"><a href="#cb293-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-136"><a href="#cb293-136" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb293-137"><a href="#cb293-137" aria-hidden="true" tabindex="-1"></a>diabetes_system <span class="op">=</span> DiabetesDiagnosisSystem()</span>
<span id="cb293-138"><a href="#cb293-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-139"><a href="#cb293-139" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb293-140"><a href="#cb293-140" aria-hidden="true" tabindex="-1"></a>medical_data <span class="op">=</span> diabetes_system.load_medical_data(<span class="st">&#39;diabetes_data.csv&#39;</span>)</span>
<span id="cb293-141"><a href="#cb293-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-142"><a href="#cb293-142" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb293-143"><a href="#cb293-143" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(medical_data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>medical_data[<span class="st">&#39;Outcome&#39;</span>])</span>
<span id="cb293-144"><a href="#cb293-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-145"><a href="#cb293-145" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb293-146"><a href="#cb293-146" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> diabetes_system.train_medical_model(train_data)</span>
<span id="cb293-147"><a href="#cb293-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-148"><a href="#cb293-148" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞</span></span>
<span id="cb293-149"><a href="#cb293-149" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> diabetes_system.evaluate_model(test_data)</span>
<span id="cb293-150"><a href="#cb293-150" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Medical Model Accuracy: </span><span class="sc">{</span>results[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb293-151"><a href="#cb293-151" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Medical Model AUC: </span><span class="sc">{</span>results[<span class="st">&#39;auc_score&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="19.3.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-3"><span
class="header-section-number">19.3.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 91.2%</li>
<li><strong>AUC Score</strong>: 0.945</li>
<li><strong>–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: 89.5% (–≤–∞–∂–Ω–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π
–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)</li>
<li><strong>–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å</strong>: 92.8%</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: –†–∞–Ω–Ω–µ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –¥–∏–∞–±–µ—Ç–∞ —É 15%
–ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –ª–µ—á–µ–Ω–∏–µ –Ω–∞ 30%</li>
</ul>
<h2 data-number="19.4"
id="–∫–µ–π—Å-3-e-commerce---—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">19.4</span> –ö–µ–π—Å 3: E-commerce -
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<h3 data-number="19.4.1" id="–∑–∞–¥–∞—á–∞-6"><span
class="header-section-number">19.4.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è
–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞.</p>
<h3 data-number="19.4.2" id="–¥–∞–Ω–Ω—ã–µ-6"><span
class="header-section-number">19.4.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 1,000,000 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</li>
<li><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</strong>: 50,000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</li>
<li><strong>–¢–æ–≤–∞—Ä—ã</strong>: 10,000 SKU</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞</li>
</ul>
<h3 data-number="19.4.3" id="—Ä–µ—à–µ–Ω–∏–µ-2"><span
class="header-section-number">19.4.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb294"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EcommerceRecommendationSystem:</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è e-commerce&quot;&quot;&quot;</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.user_predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.item_predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collaborative_filter <span class="op">=</span> <span class="va">None</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prepare_recommendation_data(<span class="va">self</span>, transactions_df, users_df, items_df):</span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> transactions_df.merge(users_df, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>)</span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.merge(items_df, on<span class="op">=</span><span class="st">&#39;item_id&#39;</span>)</span>
<span id="cb294-15"><a href="#cb294-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-16"><a href="#cb294-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span></span>
<span id="cb294-17"><a href="#cb294-17" aria-hidden="true" tabindex="-1"></a>        user_features <span class="op">=</span> <span class="va">self</span>.create_user_features(df)</span>
<span id="cb294-18"><a href="#cb294-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-19"><a href="#cb294-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞</span></span>
<span id="cb294-20"><a href="#cb294-20" aria-hidden="true" tabindex="-1"></a>        item_features <span class="op">=</span> <span class="va">self</span>.create_item_features(df)</span>
<span id="cb294-21"><a href="#cb294-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-22"><a href="#cb294-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (—Ä–µ–π—Ç–∏–Ω–≥/–ø–æ–∫—É–ø–∫–∞)</span></span>
<span id="cb294-23"><a href="#cb294-23" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;rating&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_implicit_rating(df)</span>
<span id="cb294-24"><a href="#cb294-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-25"><a href="#cb294-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df, user_features, item_features</span>
<span id="cb294-26"><a href="#cb294-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-27"><a href="#cb294-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_user_features(<span class="va">self</span>, df):</span>
<span id="cb294-28"><a href="#cb294-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb294-29"><a href="#cb294-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-30"><a href="#cb294-30" aria-hidden="true" tabindex="-1"></a>        user_features <span class="op">=</span> df.groupby(<span class="st">&#39;user_id&#39;</span>).agg({</span>
<span id="cb294-31"><a href="#cb294-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;item_id&#39;</span>: <span class="st">&#39;count&#39;</span>,  <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫</span></span>
<span id="cb294-32"><a href="#cb294-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price&#39;</span>: [<span class="st">&#39;sum&#39;</span>, <span class="st">&#39;mean&#39;</span>],  <span class="co"># –û–±—â–∞—è –∏ —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span></span>
<span id="cb294-33"><a href="#cb294-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;category&#39;</span>: <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;Unknown&#39;</span>,  <span class="co"># –õ—é–±–∏–º–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</span></span>
<span id="cb294-34"><a href="#cb294-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;brand&#39;</span>: <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;Unknown&#39;</span>  <span class="co"># –õ—é–±–∏–º—ã–π –±—Ä–µ–Ω–¥</span></span>
<span id="cb294-35"><a href="#cb294-35" aria-hidden="true" tabindex="-1"></a>        }).reset_index()</span>
<span id="cb294-36"><a href="#cb294-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-37"><a href="#cb294-37" aria-hidden="true" tabindex="-1"></a>        user_features.columns <span class="op">=</span> [<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;total_purchases&#39;</span>, <span class="st">&#39;total_spent&#39;</span>, <span class="st">&#39;avg_purchase&#39;</span>, <span class="st">&#39;favorite_category&#39;</span>, <span class="st">&#39;favorite_brand&#39;</span>]</span>
<span id="cb294-38"><a href="#cb294-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-39"><a href="#cb294-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb294-40"><a href="#cb294-40" aria-hidden="true" tabindex="-1"></a>        user_features[<span class="st">&#39;purchase_frequency&#39;</span>] <span class="op">=</span> user_features[<span class="st">&#39;total_purchases&#39;</span>] <span class="op">/</span> <span class="dv">365</span>  <span class="co"># –ü–æ–∫—É–ø–æ–∫ –≤ –¥–µ–Ω—å</span></span>
<span id="cb294-41"><a href="#cb294-41" aria-hidden="true" tabindex="-1"></a>        user_features[<span class="st">&#39;avg_spent_per_purchase&#39;</span>] <span class="op">=</span> user_features[<span class="st">&#39;total_spent&#39;</span>] <span class="op">/</span> user_features[<span class="st">&#39;total_purchases&#39;</span>]</span>
<span id="cb294-42"><a href="#cb294-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-43"><a href="#cb294-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> user_features</span>
<span id="cb294-44"><a href="#cb294-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-45"><a href="#cb294-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_item_features(<span class="va">self</span>, df):</span>
<span id="cb294-46"><a href="#cb294-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb294-47"><a href="#cb294-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-48"><a href="#cb294-48" aria-hidden="true" tabindex="-1"></a>        item_features <span class="op">=</span> df.groupby(<span class="st">&#39;item_id&#39;</span>).agg({</span>
<span id="cb294-49"><a href="#cb294-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;user_id&#39;</span>: <span class="st">&#39;count&#39;</span>,  <span class="co"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</span></span>
<span id="cb294-50"><a href="#cb294-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price&#39;</span>: <span class="st">&#39;mean&#39;</span>,  <span class="co"># –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞</span></span>
<span id="cb294-51"><a href="#cb294-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;category&#39;</span>: <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;Unknown&#39;</span>,</span>
<span id="cb294-52"><a href="#cb294-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;brand&#39;</span>: <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;Unknown&#39;</span></span>
<span id="cb294-53"><a href="#cb294-53" aria-hidden="true" tabindex="-1"></a>        }).reset_index()</span>
<span id="cb294-54"><a href="#cb294-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-55"><a href="#cb294-55" aria-hidden="true" tabindex="-1"></a>        item_features.columns <span class="op">=</span> [<span class="st">&#39;item_id&#39;</span>, <span class="st">&#39;total_buyers&#39;</span>, <span class="st">&#39;avg_price&#39;</span>, <span class="st">&#39;category&#39;</span>, <span class="st">&#39;brand&#39;</span>]</span>
<span id="cb294-56"><a href="#cb294-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-57"><a href="#cb294-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞</span></span>
<span id="cb294-58"><a href="#cb294-58" aria-hidden="true" tabindex="-1"></a>        item_features[<span class="st">&#39;popularity_score&#39;</span>] <span class="op">=</span> item_features[<span class="st">&#39;total_buyers&#39;</span>] <span class="op">/</span> item_features[<span class="st">&#39;total_buyers&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb294-59"><a href="#cb294-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-60"><a href="#cb294-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> item_features</span>
<span id="cb294-61"><a href="#cb294-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-62"><a href="#cb294-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_implicit_rating(<span class="va">self</span>, df):</span>
<span id="cb294-63"><a href="#cb294-63" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –Ω–µ—è–≤–Ω–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb294-64"><a href="#cb294-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-65"><a href="#cb294-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: —á–µ–º –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–æ–∫, —Ç–µ–º –≤—ã—à–µ —Ä–µ–π—Ç–∏–Ω–≥</span></span>
<span id="cb294-66"><a href="#cb294-66" aria-hidden="true" tabindex="-1"></a>        user_purchase_counts <span class="op">=</span> df.groupby(<span class="st">&#39;user_id&#39;</span>)[<span class="st">&#39;item_id&#39;</span>].count()</span>
<span id="cb294-67"><a href="#cb294-67" aria-hidden="true" tabindex="-1"></a>        item_purchase_counts <span class="op">=</span> df.groupby(<span class="st">&#39;item_id&#39;</span>)[<span class="st">&#39;user_id&#39;</span>].count()</span>
<span id="cb294-68"><a href="#cb294-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-69"><a href="#cb294-69" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;user_activity&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;user_id&#39;</span>].<span class="bu">map</span>(user_purchase_counts)</span>
<span id="cb294-70"><a href="#cb294-70" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;item_popularity&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;item_id&#39;</span>].<span class="bu">map</span>(item_purchase_counts)</span>
<span id="cb294-71"><a href="#cb294-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-72"><a href="#cb294-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞</span></span>
<span id="cb294-73"><a href="#cb294-73" aria-hidden="true" tabindex="-1"></a>        rating <span class="op">=</span> (df[<span class="st">&#39;user_activity&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;user_activity&#39;</span>].<span class="bu">max</span>() <span class="op">+</span> </span>
<span id="cb294-74"><a href="#cb294-74" aria-hidden="true" tabindex="-1"></a>                 df[<span class="st">&#39;item_popularity&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;item_popularity&#39;</span>].<span class="bu">max</span>()) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb294-75"><a href="#cb294-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-76"><a href="#cb294-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rating</span>
<span id="cb294-77"><a href="#cb294-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-78"><a href="#cb294-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_collaborative_filtering(<span class="va">self</span>, df, user_features, item_features):</span>
<span id="cb294-79"><a href="#cb294-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb294-80"><a href="#cb294-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-81"><a href="#cb294-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è AutoML</span></span>
<span id="cb294-82"><a href="#cb294-82" aria-hidden="true" tabindex="-1"></a>        recommendation_data <span class="op">=</span> df.merge(user_features, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>)</span>
<span id="cb294-83"><a href="#cb294-83" aria-hidden="true" tabindex="-1"></a>        recommendation_data <span class="op">=</span> recommendation_data.merge(item_features, on<span class="op">=</span><span class="st">&#39;item_id&#39;</span>)</span>
<span id="cb294-84"><a href="#cb294-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-85"><a href="#cb294-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb294-86"><a href="#cb294-86" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collaborative_filter <span class="op">=</span> TabularPredictor(</span>
<span id="cb294-87"><a href="#cb294-87" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;rating&#39;</span>,</span>
<span id="cb294-88"><a href="#cb294-88" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;regression&#39;</span>,</span>
<span id="cb294-89"><a href="#cb294-89" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;rmse&#39;</span>,</span>
<span id="cb294-90"><a href="#cb294-90" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;recommendation_model&#39;</span></span>
<span id="cb294-91"><a href="#cb294-91" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb294-92"><a href="#cb294-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-93"><a href="#cb294-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb294-94"><a href="#cb294-94" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collaborative_filter.fit(</span>
<span id="cb294-95"><a href="#cb294-95" aria-hidden="true" tabindex="-1"></a>            recommendation_data,</span>
<span id="cb294-96"><a href="#cb294-96" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">3600</span>,</span>
<span id="cb294-97"><a href="#cb294-97" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span></span>
<span id="cb294-98"><a href="#cb294-98" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb294-99"><a href="#cb294-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-100"><a href="#cb294-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.collaborative_filter</span>
<span id="cb294-101"><a href="#cb294-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-102"><a href="#cb294-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_recommendations(<span class="va">self</span>, user_id, n_recommendations<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb294-103"><a href="#cb294-103" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb294-104"><a href="#cb294-104" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-105"><a href="#cb294-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span></span>
<span id="cb294-106"><a href="#cb294-106" aria-hidden="true" tabindex="-1"></a>        user_data <span class="op">=</span> <span class="va">self</span>.get_user_features(user_id)</span>
<span id="cb294-107"><a href="#cb294-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-108"><a href="#cb294-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</span></span>
<span id="cb294-109"><a href="#cb294-109" aria-hidden="true" tabindex="-1"></a>        all_items <span class="op">=</span> <span class="va">self</span>.get_all_items()</span>
<span id="cb294-110"><a href="#cb294-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-111"><a href="#cb294-111" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</span></span>
<span id="cb294-112"><a href="#cb294-112" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> []</span>
<span id="cb294-113"><a href="#cb294-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item_id <span class="kw">in</span> all_items:</span>
<span id="cb294-114"><a href="#cb294-114" aria-hidden="true" tabindex="-1"></a>            item_data <span class="op">=</span> <span class="va">self</span>.get_item_features(item_id)</span>
<span id="cb294-115"><a href="#cb294-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb294-116"><a href="#cb294-116" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–æ–≤–∞—Ä–∞</span></span>
<span id="cb294-117"><a href="#cb294-117" aria-hidden="true" tabindex="-1"></a>            combined_data <span class="op">=</span> pd.DataFrame([{<span class="op">**</span>user_data, <span class="op">**</span>item_data}])</span>
<span id="cb294-118"><a href="#cb294-118" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb294-119"><a href="#cb294-119" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞</span></span>
<span id="cb294-120"><a href="#cb294-120" aria-hidden="true" tabindex="-1"></a>            rating <span class="op">=</span> <span class="va">self</span>.collaborative_filter.predict(combined_data)[<span class="dv">0</span>]</span>
<span id="cb294-121"><a href="#cb294-121" aria-hidden="true" tabindex="-1"></a>            predictions.append((item_id, rating))</span>
<span id="cb294-122"><a href="#cb294-122" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-123"><a href="#cb294-123" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É</span></span>
<span id="cb294-124"><a href="#cb294-124" aria-hidden="true" tabindex="-1"></a>        predictions.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb294-125"><a href="#cb294-125" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-126"><a href="#cb294-126" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–ø-N —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span></span>
<span id="cb294-127"><a href="#cb294-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predictions[:n_recommendations]</span>
<span id="cb294-128"><a href="#cb294-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb294-129"><a href="#cb294-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> evaluate_recommendations(<span class="va">self</span>, test_data, n_recommendations<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb294-130"><a href="#cb294-130" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span></span>
<span id="cb294-131"><a href="#cb294-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-132"><a href="#cb294-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span></span>
<span id="cb294-133"><a href="#cb294-133" aria-hidden="true" tabindex="-1"></a>        precision_scores <span class="op">=</span> []</span>
<span id="cb294-134"><a href="#cb294-134" aria-hidden="true" tabindex="-1"></a>        recall_scores <span class="op">=</span> []</span>
<span id="cb294-135"><a href="#cb294-135" aria-hidden="true" tabindex="-1"></a>        ndcg_scores <span class="op">=</span> []</span>
<span id="cb294-136"><a href="#cb294-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-137"><a href="#cb294-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> user_id <span class="kw">in</span> test_data[<span class="st">&#39;user_id&#39;</span>].unique():</span>
<span id="cb294-138"><a href="#cb294-138" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span></span>
<span id="cb294-139"><a href="#cb294-139" aria-hidden="true" tabindex="-1"></a>            actual_items <span class="op">=</span> <span class="bu">set</span>(test_data[test_data[<span class="st">&#39;user_id&#39;</span>] <span class="op">==</span> user_id][<span class="st">&#39;item_id&#39;</span>])</span>
<span id="cb294-140"><a href="#cb294-140" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb294-141"><a href="#cb294-141" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span></span>
<span id="cb294-142"><a href="#cb294-142" aria-hidden="true" tabindex="-1"></a>            recommendations <span class="op">=</span> <span class="va">self</span>.generate_recommendations(user_id, n_recommendations)</span>
<span id="cb294-143"><a href="#cb294-143" aria-hidden="true" tabindex="-1"></a>            recommended_items <span class="op">=</span> <span class="bu">set</span>([item_id <span class="cf">for</span> item_id, _ <span class="kw">in</span> recommendations])</span>
<span id="cb294-144"><a href="#cb294-144" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb294-145"><a href="#cb294-145" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Precision@K</span></span>
<span id="cb294-146"><a href="#cb294-146" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(recommended_items) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb294-147"><a href="#cb294-147" aria-hidden="true" tabindex="-1"></a>                precision <span class="op">=</span> <span class="bu">len</span>(actual_items <span class="op">&amp;</span> recommended_items) <span class="op">/</span> <span class="bu">len</span>(recommended_items)</span>
<span id="cb294-148"><a href="#cb294-148" aria-hidden="true" tabindex="-1"></a>                precision_scores.append(precision)</span>
<span id="cb294-149"><a href="#cb294-149" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb294-150"><a href="#cb294-150" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Recall@K</span></span>
<span id="cb294-151"><a href="#cb294-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(actual_items) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb294-152"><a href="#cb294-152" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> <span class="bu">len</span>(actual_items <span class="op">&amp;</span> recommended_items) <span class="op">/</span> <span class="bu">len</span>(actual_items)</span>
<span id="cb294-153"><a href="#cb294-153" aria-hidden="true" tabindex="-1"></a>                recall_scores.append(recall)</span>
<span id="cb294-154"><a href="#cb294-154" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb294-155"><a href="#cb294-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb294-156"><a href="#cb294-156" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;precision@10&#39;</span>: np.mean(precision_scores),</span>
<span id="cb294-157"><a href="#cb294-157" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recall@10&#39;</span>: np.mean(recall_scores),</span>
<span id="cb294-158"><a href="#cb294-158" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;f1_score&#39;</span>: <span class="dv">2</span> <span class="op">*</span> np.mean(precision_scores) <span class="op">*</span> np.mean(recall_scores) <span class="op">/</span> </span>
<span id="cb294-159"><a href="#cb294-159" aria-hidden="true" tabindex="-1"></a>                       (np.mean(precision_scores) <span class="op">+</span> np.mean(recall_scores))</span>
<span id="cb294-160"><a href="#cb294-160" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb294-161"><a href="#cb294-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-162"><a href="#cb294-162" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb294-163"><a href="#cb294-163" aria-hidden="true" tabindex="-1"></a>recommendation_system <span class="op">=</span> EcommerceRecommendationSystem()</span>
<span id="cb294-164"><a href="#cb294-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-165"><a href="#cb294-165" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb294-166"><a href="#cb294-166" aria-hidden="true" tabindex="-1"></a>transactions <span class="op">=</span> pd.read_csv(<span class="st">&#39;transactions.csv&#39;</span>)</span>
<span id="cb294-167"><a href="#cb294-167" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> pd.read_csv(<span class="st">&#39;users.csv&#39;</span>)</span>
<span id="cb294-168"><a href="#cb294-168" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> pd.read_csv(<span class="st">&#39;items.csv&#39;</span>)</span>
<span id="cb294-169"><a href="#cb294-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-170"><a href="#cb294-170" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb294-171"><a href="#cb294-171" aria-hidden="true" tabindex="-1"></a>df, user_features, item_features <span class="op">=</span> recommendation_system.prepare_recommendation_data(</span>
<span id="cb294-172"><a href="#cb294-172" aria-hidden="true" tabindex="-1"></a>    transactions, users, items</span>
<span id="cb294-173"><a href="#cb294-173" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb294-174"><a href="#cb294-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-175"><a href="#cb294-175" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb294-176"><a href="#cb294-176" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> recommendation_system.train_collaborative_filtering(df, user_features, item_features)</span>
<span id="cb294-177"><a href="#cb294-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-178"><a href="#cb294-178" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞</span></span>
<span id="cb294-179"><a href="#cb294-179" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> recommendation_system.evaluate_recommendations(df)</span>
<span id="cb294-180"><a href="#cb294-180" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Precision@10: </span><span class="sc">{</span>results[<span class="st">&#39;precision@10&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb294-181"><a href="#cb294-181" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Recall@10: </span><span class="sc">{</span>results[<span class="st">&#39;recall@10&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb294-182"><a href="#cb294-182" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;F1 Score: </span><span class="sc">{</span>results[<span class="st">&#39;f1_score&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="19.4.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-4"><span
class="header-section-number">19.4.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>Precision@10</strong>: 0.342</li>
<li><strong>Recall@10</strong>: 0.156</li>
<li><strong>F1 Score</strong>: 0.214</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏</strong>: 18%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞</strong>: 12%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫</strong>: 25%</li>
</ul>
<h2 data-number="19.5"
id="–∫–µ–π—Å-4-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ---–ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ-–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"><span
class="header-section-number">19.5</span> –ö–µ–π—Å 4: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ -
–ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h2>
<h3 data-number="19.5.1" id="–∑–∞–¥–∞—á–∞-7"><span
class="header-section-number">19.5.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ
–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.</p>
<h3 data-number="19.5.2" id="–¥–∞–Ω–Ω—ã–µ-7"><span
class="header-section-number">19.5.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</strong>: 500 –µ–¥–∏–Ω–∏—Ü –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ
–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</li>
<li><strong>–°–µ–Ω—Å–æ—Ä—ã</strong>: 50+ –¥–∞—Ç—á–∏–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é –µ–¥–∏–Ω–∏—Ü—É</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π</strong>: –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞</li>
</ul>
<h3 data-number="19.5.3" id="—Ä–µ—à–µ–Ω–∏–µ-3"><span
class="header-section-number">19.5.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb295"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PredictiveMaintenanceSystem:</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.equipment_predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.anomaly_detector <span class="op">=</span> <span class="va">None</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prepare_sensor_data(<span class="va">self</span>, sensor_data):</span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º</span></span>
<span id="cb295-12"><a href="#cb295-12" aria-hidden="true" tabindex="-1"></a>        sensor_data[<span class="st">&#39;timestamp&#39;</span>] <span class="op">=</span> pd.to_datetime(sensor_data[<span class="st">&#39;timestamp&#39;</span>])</span>
<span id="cb295-13"><a href="#cb295-13" aria-hidden="true" tabindex="-1"></a>        sensor_data <span class="op">=</span> sensor_data.set_index(<span class="st">&#39;timestamp&#39;</span>)</span>
<span id="cb295-14"><a href="#cb295-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-15"><a href="#cb295-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span></span>
<span id="cb295-16"><a href="#cb295-16" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> []</span>
<span id="cb295-17"><a href="#cb295-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-18"><a href="#cb295-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> equipment_id <span class="kw">in</span> sensor_data[<span class="st">&#39;equipment_id&#39;</span>].unique():</span>
<span id="cb295-19"><a href="#cb295-19" aria-hidden="true" tabindex="-1"></a>            equipment_data <span class="op">=</span> sensor_data[sensor_data[<span class="st">&#39;equipment_id&#39;</span>] <span class="op">==</span> equipment_id]</span>
<span id="cb295-20"><a href="#cb295-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb295-21"><a href="#cb295-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞</span></span>
<span id="cb295-22"><a href="#cb295-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> window <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">24</span>]:  <span class="co"># 1 —á–∞—Å, 6 —á–∞—Å–æ–≤, 24 —á–∞—Å–∞</span></span>
<span id="cb295-23"><a href="#cb295-23" aria-hidden="true" tabindex="-1"></a>                window_data <span class="op">=</span> equipment_data.rolling(window<span class="op">=</span>window).agg({</span>
<span id="cb295-24"><a href="#cb295-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;temperature&#39;</span>: [<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>],</span>
<span id="cb295-25"><a href="#cb295-25" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pressure&#39;</span>: [<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>],</span>
<span id="cb295-26"><a href="#cb295-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;vibration&#39;</span>: [<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>],</span>
<span id="cb295-27"><a href="#cb295-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;current&#39;</span>: [<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>],</span>
<span id="cb295-28"><a href="#cb295-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;voltage&#39;</span>: [<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;std&#39;</span>, <span class="st">&#39;max&#39;</span>, <span class="st">&#39;min&#39;</span>]</span>
<span id="cb295-29"><a href="#cb295-29" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb295-30"><a href="#cb295-30" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb295-31"><a href="#cb295-31" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫</span></span>
<span id="cb295-32"><a href="#cb295-32" aria-hidden="true" tabindex="-1"></a>                window_data.columns <span class="op">=</span> [<span class="ss">f&#39;</span><span class="sc">{</span>col[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>col[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">h&#39;</span> <span class="cf">for</span> col <span class="kw">in</span> window_data.columns]</span>
<span id="cb295-33"><a href="#cb295-33" aria-hidden="true" tabindex="-1"></a>                features.append(window_data)</span>
<span id="cb295-34"><a href="#cb295-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-35"><a href="#cb295-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb295-36"><a href="#cb295-36" aria-hidden="true" tabindex="-1"></a>        all_features <span class="op">=</span> pd.concat(features, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb295-37"><a href="#cb295-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-38"><a href="#cb295-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_features</span>
<span id="cb295-39"><a href="#cb295-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-40"><a href="#cb295-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_maintenance_target(<span class="va">self</span>, sensor_data, maintenance_logs):</span>
<span id="cb295-41"><a href="#cb295-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb295-42"><a href="#cb295-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-43"><a href="#cb295-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤ –∏ –ª–æ–≥–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span></span>
<span id="cb295-44"><a href="#cb295-44" aria-hidden="true" tabindex="-1"></a>        maintenance_data <span class="op">=</span> sensor_data.merge(maintenance_logs, on<span class="op">=</span><span class="st">&#39;equipment_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb295-45"><a href="#cb295-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-46"><a href="#cb295-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb295-47"><a href="#cb295-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1 = —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π</span></span>
<span id="cb295-48"><a href="#cb295-48" aria-hidden="true" tabindex="-1"></a>        maintenance_data[<span class="st">&#39;maintenance_needed&#39;</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb295-49"><a href="#cb295-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-50"><a href="#cb295-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, row <span class="kw">in</span> maintenance_data.iterrows():</span>
<span id="cb295-51"><a href="#cb295-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.notna(row[<span class="st">&#39;maintenance_date&#39;</span>]):</span>
<span id="cb295-52"><a href="#cb295-52" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ï—Å–ª–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –±—ã–ª–æ –≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è</span></span>
<span id="cb295-53"><a href="#cb295-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (row[<span class="st">&#39;maintenance_date&#39;</span>] <span class="op">-</span> row[<span class="st">&#39;timestamp&#39;</span>]).days <span class="op">&lt;=</span> <span class="dv">7</span>:</span>
<span id="cb295-54"><a href="#cb295-54" aria-hidden="true" tabindex="-1"></a>                    maintenance_data.loc[idx, <span class="st">&#39;maintenance_needed&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb295-55"><a href="#cb295-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-56"><a href="#cb295-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> maintenance_data</span>
<span id="cb295-57"><a href="#cb295-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-58"><a href="#cb295-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_maintenance_model(<span class="va">self</span>, maintenance_data, time_limit<span class="op">=</span><span class="dv">7200</span>):</span>
<span id="cb295-59"><a href="#cb295-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb295-60"><a href="#cb295-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-61"><a href="#cb295-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb295-62"><a href="#cb295-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.equipment_predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb295-63"><a href="#cb295-63" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;maintenance_needed&#39;</span>,</span>
<span id="cb295-64"><a href="#cb295-64" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb295-65"><a href="#cb295-65" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;roc_auc&#39;</span>,</span>
<span id="cb295-66"><a href="#cb295-66" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;maintenance_prediction_model&#39;</span></span>
<span id="cb295-67"><a href="#cb295-67" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb295-68"><a href="#cb295-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-69"><a href="#cb295-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤</span></span>
<span id="cb295-70"><a href="#cb295-70" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.equipment_predictor.fit(</span>
<span id="cb295-71"><a href="#cb295-71" aria-hidden="true" tabindex="-1"></a>            maintenance_data,</span>
<span id="cb295-72"><a href="#cb295-72" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span>time_limit,</span>
<span id="cb295-73"><a href="#cb295-73" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb295-74"><a href="#cb295-74" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb295-75"><a href="#cb295-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb295-76"><a href="#cb295-76" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb295-77"><a href="#cb295-77" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb295-78"><a href="#cb295-78" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb295-79"><a href="#cb295-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb295-80"><a href="#cb295-80" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb295-81"><a href="#cb295-81" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb295-82"><a href="#cb295-82" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb295-83"><a href="#cb295-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb295-84"><a href="#cb295-84" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>},</span>
<span id="cb295-85"><a href="#cb295-85" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>}</span>
<span id="cb295-86"><a href="#cb295-86" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb295-87"><a href="#cb295-87" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb295-88"><a href="#cb295-88" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb295-89"><a href="#cb295-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-90"><a href="#cb295-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.equipment_predictor</span>
<span id="cb295-91"><a href="#cb295-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-92"><a href="#cb295-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_anomalies(<span class="va">self</span>, sensor_data):</span>
<span id="cb295-93"><a href="#cb295-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb295-94"><a href="#cb295-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-95"><a href="#cb295-95" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.ensemble <span class="im">import</span> IsolationForest</span>
<span id="cb295-96"><a href="#cb295-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-97"><a href="#cb295-97" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π</span></span>
<span id="cb295-98"><a href="#cb295-98" aria-hidden="true" tabindex="-1"></a>        sensor_features <span class="op">=</span> sensor_data.select_dtypes(include<span class="op">=</span>[np.number])</span>
<span id="cb295-99"><a href="#cb295-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-100"><a href="#cb295-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π</span></span>
<span id="cb295-101"><a href="#cb295-101" aria-hidden="true" tabindex="-1"></a>        anomaly_detector <span class="op">=</span> IsolationForest(contamination<span class="op">=</span><span class="fl">0.1</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb295-102"><a href="#cb295-102" aria-hidden="true" tabindex="-1"></a>        anomaly_detector.fit(sensor_features)</span>
<span id="cb295-103"><a href="#cb295-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-104"><a href="#cb295-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π</span></span>
<span id="cb295-105"><a href="#cb295-105" aria-hidden="true" tabindex="-1"></a>        anomalies <span class="op">=</span> anomaly_detector.predict(sensor_features)</span>
<span id="cb295-106"><a href="#cb295-106" aria-hidden="true" tabindex="-1"></a>        anomaly_scores <span class="op">=</span> anomaly_detector.score_samples(sensor_features)</span>
<span id="cb295-107"><a href="#cb295-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-108"><a href="#cb295-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> anomalies, anomaly_scores</span>
<span id="cb295-109"><a href="#cb295-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-110"><a href="#cb295-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_maintenance_schedule(<span class="va">self</span>, current_sensor_data):</span>
<span id="cb295-111"><a href="#cb295-111" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb295-112"><a href="#cb295-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-113"><a href="#cb295-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span></span>
<span id="cb295-114"><a href="#cb295-114" aria-hidden="true" tabindex="-1"></a>        maintenance_prob <span class="op">=</span> <span class="va">self</span>.equipment_predictor.predict_proba(current_sensor_data)</span>
<span id="cb295-115"><a href="#cb295-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-116"><a href="#cb295-116" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</span></span>
<span id="cb295-117"><a href="#cb295-117" aria-hidden="true" tabindex="-1"></a>        schedule <span class="op">=</span> []</span>
<span id="cb295-118"><a href="#cb295-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-119"><a href="#cb295-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, prob <span class="kw">in</span> <span class="bu">enumerate</span>(maintenance_prob[<span class="dv">1</span>]):</span>
<span id="cb295-120"><a href="#cb295-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prob <span class="op">&gt;</span> <span class="fl">0.7</span>:  <span class="co"># –í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span></span>
<span id="cb295-121"><a href="#cb295-121" aria-hidden="true" tabindex="-1"></a>                schedule.append({</span>
<span id="cb295-122"><a href="#cb295-122" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;equipment_id&#39;</span>: current_sensor_data.iloc[idx][<span class="st">&#39;equipment_id&#39;</span>],</span>
<span id="cb295-123"><a href="#cb295-123" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;High&#39;</span>,</span>
<span id="cb295-124"><a href="#cb295-124" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;maintenance_date&#39;</span>: pd.Timestamp.now() <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb295-125"><a href="#cb295-125" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;probability&#39;</span>: prob</span>
<span id="cb295-126"><a href="#cb295-126" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb295-127"><a href="#cb295-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> prob <span class="op">&gt;</span> <span class="fl">0.5</span>:  <span class="co"># –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</span></span>
<span id="cb295-128"><a href="#cb295-128" aria-hidden="true" tabindex="-1"></a>                schedule.append({</span>
<span id="cb295-129"><a href="#cb295-129" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;equipment_id&#39;</span>: current_sensor_data.iloc[idx][<span class="st">&#39;equipment_id&#39;</span>],</span>
<span id="cb295-130"><a href="#cb295-130" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;Medium&#39;</span>,</span>
<span id="cb295-131"><a href="#cb295-131" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;maintenance_date&#39;</span>: pd.Timestamp.now() <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">3</span>),</span>
<span id="cb295-132"><a href="#cb295-132" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;probability&#39;</span>: prob</span>
<span id="cb295-133"><a href="#cb295-133" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb295-134"><a href="#cb295-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> prob <span class="op">&gt;</span> <span class="fl">0.3</span>:  <span class="co"># –ù–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</span></span>
<span id="cb295-135"><a href="#cb295-135" aria-hidden="true" tabindex="-1"></a>                schedule.append({</span>
<span id="cb295-136"><a href="#cb295-136" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;equipment_id&#39;</span>: current_sensor_data.iloc[idx][<span class="st">&#39;equipment_id&#39;</span>],</span>
<span id="cb295-137"><a href="#cb295-137" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;Low&#39;</span>,</span>
<span id="cb295-138"><a href="#cb295-138" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;maintenance_date&#39;</span>: pd.Timestamp.now() <span class="op">+</span> pd.Timedelta(days<span class="op">=</span><span class="dv">7</span>),</span>
<span id="cb295-139"><a href="#cb295-139" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;probability&#39;</span>: prob</span>
<span id="cb295-140"><a href="#cb295-140" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb295-141"><a href="#cb295-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb295-142"><a href="#cb295-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> schedule</span>
<span id="cb295-143"><a href="#cb295-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-144"><a href="#cb295-144" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb295-145"><a href="#cb295-145" aria-hidden="true" tabindex="-1"></a>maintenance_system <span class="op">=</span> PredictiveMaintenanceSystem()</span>
<span id="cb295-146"><a href="#cb295-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-147"><a href="#cb295-147" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb295-148"><a href="#cb295-148" aria-hidden="true" tabindex="-1"></a>sensor_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;sensor_data.csv&#39;</span>)</span>
<span id="cb295-149"><a href="#cb295-149" aria-hidden="true" tabindex="-1"></a>maintenance_logs <span class="op">=</span> pd.read_csv(<span class="st">&#39;maintenance_logs.csv&#39;</span>)</span>
<span id="cb295-150"><a href="#cb295-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-151"><a href="#cb295-151" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb295-152"><a href="#cb295-152" aria-hidden="true" tabindex="-1"></a>sensor_features <span class="op">=</span> maintenance_system.prepare_sensor_data(sensor_data)</span>
<span id="cb295-153"><a href="#cb295-153" aria-hidden="true" tabindex="-1"></a>maintenance_data <span class="op">=</span> maintenance_system.create_maintenance_target(sensor_data, maintenance_logs)</span>
<span id="cb295-154"><a href="#cb295-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-155"><a href="#cb295-155" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb295-156"><a href="#cb295-156" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> maintenance_system.train_maintenance_model(maintenance_data)</span>
<span id="cb295-157"><a href="#cb295-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-158"><a href="#cb295-158" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞</span></span>
<span id="cb295-159"><a href="#cb295-159" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> maintenance_system.evaluate_model(maintenance_data)</span>
<span id="cb295-160"><a href="#cb295-160" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Maintenance Prediction Accuracy: </span><span class="sc">{</span>results[<span class="st">&#39;accuracy&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb295-161"><a href="#cb295-161" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Maintenance Prediction AUC: </span><span class="sc">{</span>results[<span class="st">&#39;auc_score&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h3 data-number="19.5.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-5"><span
class="header-section-number">19.5.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤</strong>: 89.4%</li>
<li><strong>AUC Score</strong>: 0.934</li>
<li><strong>–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–µ–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ–µ–≤</strong>: 45%</li>
<li><strong>–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</strong>: 32%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</strong>: 18%</li>
</ul>
<h2 data-number="19.6"
id="–∫–µ–π—Å-5-–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è---btcusdt"><span
class="header-section-number">19.6</span> –ö–µ–π—Å 5: –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è - BTCUSDT</h2>
<h3 data-number="19.6.1" id="–∑–∞–¥–∞—á–∞-8"><span
class="header-section-number">19.6.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –∏ —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω–æ–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è
—Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º –ø—Ä–∏ –¥—Ä–∏—Ñ—Ç–µ –º–æ–¥–µ–ª–∏.</p>
<h3 data-number="19.6.2" id="–¥–∞–Ω–Ω—ã–µ-8"><span
class="header-section-number">19.6.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–ü–∞—Ä–∞</strong>: BTCUSDT</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞</strong>: 1-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 50+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –æ–±—ä–µ–º,
–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã (1
—á–∞—Å –≤–ø–µ—Ä–µ–¥)</li>
</ul>
<h3 data-number="19.6.3" id="—Ä–µ—à–µ–Ω–∏–µ-4"><span
class="header-section-number">19.6.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb296"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> talib</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ccxt</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> schedule</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BTCUSDTTradingSystem:</span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT —Å AutoML Gluon&quot;&quot;&quot;</span></span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_columns <span class="op">=</span> []</span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_performance <span class="op">=</span> {}</span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.drift_threshold <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># –ü–æ—Ä–æ–≥ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span></span>
<span id="cb296-25"><a href="#cb296-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retrain_frequency <span class="op">=</span> <span class="st">&#39;daily&#39;</span>  <span class="co"># &#39;daily&#39; –∏–ª–∏ &#39;weekly&#39;</span></span>
<span id="cb296-26"><a href="#cb296-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-27"><a href="#cb296-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_crypto_data(<span class="va">self</span>, symbol<span class="op">=</span><span class="st">&#39;BTCUSDT&#39;</span>, timeframe<span class="op">=</span><span class="st">&#39;1m&#39;</span>, days<span class="op">=</span><span class="dv">30</span>):</span>
<span id="cb296-28"><a href="#cb296-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å Binance&quot;&quot;&quot;</span></span>
<span id="cb296-29"><a href="#cb296-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-30"><a href="#cb296-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Binance</span></span>
<span id="cb296-31"><a href="#cb296-31" aria-hidden="true" tabindex="-1"></a>        exchange <span class="op">=</span> ccxt.binance({</span>
<span id="cb296-32"><a href="#cb296-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;apiKey&#39;</span>: <span class="st">&#39;YOUR_API_KEY&#39;</span>,</span>
<span id="cb296-33"><a href="#cb296-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;secret&#39;</span>: <span class="st">&#39;YOUR_SECRET&#39;</span>,</span>
<span id="cb296-34"><a href="#cb296-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sandbox&#39;</span>: <span class="va">False</span></span>
<span id="cb296-35"><a href="#cb296-35" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb296-36"><a href="#cb296-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-37"><a href="#cb296-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb296-38"><a href="#cb296-38" aria-hidden="true" tabindex="-1"></a>        since <span class="op">=</span> exchange.milliseconds() <span class="op">-</span> days <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb296-39"><a href="#cb296-39" aria-hidden="true" tabindex="-1"></a>        ohlcv <span class="op">=</span> exchange.fetch_ohlcv(symbol, timeframe, since<span class="op">=</span>since)</span>
<span id="cb296-40"><a href="#cb296-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-41"><a href="#cb296-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span></span>
<span id="cb296-42"><a href="#cb296-42" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(ohlcv, columns<span class="op">=</span>[<span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;open&#39;</span>, <span class="st">&#39;high&#39;</span>, <span class="st">&#39;low&#39;</span>, <span class="st">&#39;close&#39;</span>, <span class="st">&#39;volume&#39;</span>])</span>
<span id="cb296-43"><a href="#cb296-43" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;timestamp&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;timestamp&#39;</span>], unit<span class="op">=</span><span class="st">&#39;ms&#39;</span>)</span>
<span id="cb296-44"><a href="#cb296-44" aria-hidden="true" tabindex="-1"></a>        df.set_index(<span class="st">&#39;timestamp&#39;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb296-45"><a href="#cb296-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-46"><a href="#cb296-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb296-47"><a href="#cb296-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-48"><a href="#cb296-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_advanced_features(<span class="va">self</span>, df):</span>
<span id="cb296-49"><a href="#cb296-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb296-50"><a href="#cb296-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-51"><a href="#cb296-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb296-52"><a href="#cb296-52" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_20&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb296-53"><a href="#cb296-53" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_50&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb296-54"><a href="#cb296-54" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;SMA_200&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb296-55"><a href="#cb296-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-56"><a href="#cb296-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã</span></span>
<span id="cb296-57"><a href="#cb296-57" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;RSI&#39;</span>] <span class="op">=</span> talib.RSI(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb296-58"><a href="#cb296-58" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;STOCH_K&#39;</span>], df[<span class="st">&#39;STOCH_D&#39;</span>] <span class="op">=</span> talib.STOCH(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-59"><a href="#cb296-59" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;WILLR&#39;</span>] <span class="op">=</span> talib.WILLR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-60"><a href="#cb296-60" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;CCI&#39;</span>] <span class="op">=</span> talib.CCI(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-61"><a href="#cb296-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-62"><a href="#cb296-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢—Ä–µ–Ω–¥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb296-63"><a href="#cb296-63" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;MACD&#39;</span>], df[<span class="st">&#39;MACD_signal&#39;</span>], df[<span class="st">&#39;MACD_hist&#39;</span>] <span class="op">=</span> talib.MACD(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-64"><a href="#cb296-64" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ADX&#39;</span>] <span class="op">=</span> talib.ADX(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-65"><a href="#cb296-65" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;AROON_UP&#39;</span>], df[<span class="st">&#39;AROON_DOWN&#39;</span>] <span class="op">=</span> talib.AROON(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>])</span>
<span id="cb296-66"><a href="#cb296-66" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;AROONOSC&#39;</span>] <span class="op">=</span> talib.AROONOSC(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>])</span>
<span id="cb296-67"><a href="#cb296-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-68"><a href="#cb296-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–º–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb296-69"><a href="#cb296-69" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;OBV&#39;</span>] <span class="op">=</span> talib.OBV(df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb296-70"><a href="#cb296-70" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;AD&#39;</span>] <span class="op">=</span> talib.AD(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb296-71"><a href="#cb296-71" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ADOSC&#39;</span>] <span class="op">=</span> talib.ADOSC(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>], df[<span class="st">&#39;volume&#39;</span>])</span>
<span id="cb296-72"><a href="#cb296-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-73"><a href="#cb296-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb296-74"><a href="#cb296-74" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ATR&#39;</span>] <span class="op">=</span> talib.ATR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-75"><a href="#cb296-75" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;NATR&#39;</span>] <span class="op">=</span> talib.NATR(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-76"><a href="#cb296-76" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;TRANGE&#39;</span>] <span class="op">=</span> talib.TRANGE(df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-77"><a href="#cb296-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-78"><a href="#cb296-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bollinger Bands</span></span>
<span id="cb296-79"><a href="#cb296-79" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_upper&#39;</span>], df[<span class="st">&#39;BB_middle&#39;</span>], df[<span class="st">&#39;BB_lower&#39;</span>] <span class="op">=</span> talib.BBANDS(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-80"><a href="#cb296-80" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_width&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;BB_upper&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>]) <span class="op">/</span> df[<span class="st">&#39;BB_middle&#39;</span>]</span>
<span id="cb296-81"><a href="#cb296-81" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;BB_position&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>]) <span class="op">/</span> (df[<span class="st">&#39;BB_upper&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;BB_lower&#39;</span>])</span>
<span id="cb296-82"><a href="#cb296-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-83"><a href="#cb296-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Momentum</span></span>
<span id="cb296-84"><a href="#cb296-84" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;MOM&#39;</span>] <span class="op">=</span> talib.MOM(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb296-85"><a href="#cb296-85" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ROC&#39;</span>] <span class="op">=</span> talib.ROC(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb296-86"><a href="#cb296-86" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;PPO&#39;</span>] <span class="op">=</span> talib.PPO(df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-87"><a href="#cb296-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-88"><a href="#cb296-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Price patterns</span></span>
<span id="cb296-89"><a href="#cb296-89" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;DOJI&#39;</span>] <span class="op">=</span> talib.CDLDOJI(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-90"><a href="#cb296-90" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;HAMMER&#39;</span>] <span class="op">=</span> talib.CDLHAMMER(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-91"><a href="#cb296-91" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;ENGULFING&#39;</span>] <span class="op">=</span> talib.CDLENGULFING(df[<span class="st">&#39;open&#39;</span>], df[<span class="st">&#39;high&#39;</span>], df[<span class="st">&#39;low&#39;</span>], df[<span class="st">&#39;close&#39;</span>])</span>
<span id="cb296-92"><a href="#cb296-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-93"><a href="#cb296-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb296-94"><a href="#cb296-94" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;price_change&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].pct_change()</span>
<span id="cb296-95"><a href="#cb296-95" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;volume_change&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;volume&#39;</span>].pct_change()</span>
<span id="cb296-96"><a href="#cb296-96" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;high_low_ratio&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;high&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;low&#39;</span>]</span>
<span id="cb296-97"><a href="#cb296-97" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;close_open_ratio&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>] <span class="op">/</span> df[<span class="st">&#39;open&#39;</span>]</span>
<span id="cb296-98"><a href="#cb296-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-99"><a href="#cb296-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤</span></span>
<span id="cb296-100"><a href="#cb296-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> period <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>]:</span>
<span id="cb296-101"><a href="#cb296-101" aria-hidden="true" tabindex="-1"></a>            df[<span class="ss">f&#39;SMA_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> talib.SMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span>period)</span>
<span id="cb296-102"><a href="#cb296-102" aria-hidden="true" tabindex="-1"></a>            df[<span class="ss">f&#39;EMA_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> talib.EMA(df[<span class="st">&#39;close&#39;</span>], timeperiod<span class="op">=</span>period)</span>
<span id="cb296-103"><a href="#cb296-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-104"><a href="#cb296-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤</span></span>
<span id="cb296-105"><a href="#cb296-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> period <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]:</span>
<span id="cb296-106"><a href="#cb296-106" aria-hidden="true" tabindex="-1"></a>            df[<span class="ss">f&#39;volatility_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].rolling(period).std()</span>
<span id="cb296-107"><a href="#cb296-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-108"><a href="#cb296-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb296-109"><a href="#cb296-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-110"><a href="#cb296-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_target_variable(<span class="va">self</span>, df, prediction_horizon<span class="op">=</span><span class="dv">60</span>):</span>
<span id="cb296-111"><a href="#cb296-111" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb296-112"><a href="#cb296-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-113"><a href="#cb296-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ prediction_horizon –º–∏–Ω—É—Ç</span></span>
<span id="cb296-114"><a href="#cb296-114" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;future_price&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span>prediction_horizon)</span>
<span id="cb296-115"><a href="#cb296-115" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;price_direction&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;future_price&#39;</span>] <span class="op">&gt;</span> df[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb296-116"><a href="#cb296-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-117"><a href="#cb296-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span></span>
<span id="cb296-118"><a href="#cb296-118" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;price_change_pct&#39;</span>] <span class="op">=</span> (df[<span class="st">&#39;future_price&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;close&#39;</span>]) <span class="op">/</span> df[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb296-119"><a href="#cb296-119" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;volatility_target&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].rolling(prediction_horizon).std().shift(<span class="op">-</span>prediction_horizon)</span>
<span id="cb296-120"><a href="#cb296-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-121"><a href="#cb296-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb296-122"><a href="#cb296-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-123"><a href="#cb296-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_robust_model(<span class="va">self</span>, df, time_limit<span class="op">=</span><span class="dv">3600</span>):</span>
<span id="cb296-124"><a href="#cb296-124" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb296-125"><a href="#cb296-125" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-126"><a href="#cb296-126" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb296-127"><a href="#cb296-127" aria-hidden="true" tabindex="-1"></a>        feature_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [</span>
<span id="cb296-128"><a href="#cb296-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;open&#39;</span>, <span class="st">&#39;high&#39;</span>, <span class="st">&#39;low&#39;</span>, <span class="st">&#39;close&#39;</span>, <span class="st">&#39;volume&#39;</span>, <span class="st">&#39;timestamp&#39;</span>,</span>
<span id="cb296-129"><a href="#cb296-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;future_price&#39;</span>, <span class="st">&#39;price_direction&#39;</span>, <span class="st">&#39;price_change_pct&#39;</span>, <span class="st">&#39;volatility_target&#39;</span></span>
<span id="cb296-130"><a href="#cb296-130" aria-hidden="true" tabindex="-1"></a>        ]]</span>
<span id="cb296-131"><a href="#cb296-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-132"><a href="#cb296-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ NaN</span></span>
<span id="cb296-133"><a href="#cb296-133" aria-hidden="true" tabindex="-1"></a>        df_clean <span class="op">=</span> df.dropna()</span>
<span id="cb296-134"><a href="#cb296-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-135"><a href="#cb296-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb296-136"><a href="#cb296-136" aria-hidden="true" tabindex="-1"></a>        split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(df_clean) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb296-137"><a href="#cb296-137" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> df_clean.iloc[:split_idx]</span>
<span id="cb296-138"><a href="#cb296-138" aria-hidden="true" tabindex="-1"></a>        val_data <span class="op">=</span> df_clean.iloc[split_idx:]</span>
<span id="cb296-139"><a href="#cb296-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-140"><a href="#cb296-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb296-141"><a href="#cb296-141" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb296-142"><a href="#cb296-142" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;price_direction&#39;</span>,</span>
<span id="cb296-143"><a href="#cb296-143" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb296-144"><a href="#cb296-144" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb296-145"><a href="#cb296-145" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;btcusdt_trading_model&#39;</span></span>
<span id="cb296-146"><a href="#cb296-146" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb296-147"><a href="#cb296-147" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-148"><a href="#cb296-148" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</span></span>
<span id="cb296-149"><a href="#cb296-149" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb296-150"><a href="#cb296-150" aria-hidden="true" tabindex="-1"></a>            train_data[feature_columns <span class="op">+</span> [<span class="st">&#39;price_direction&#39;</span>]],</span>
<span id="cb296-151"><a href="#cb296-151" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span>time_limit,</span>
<span id="cb296-152"><a href="#cb296-152" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb296-153"><a href="#cb296-153" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb296-154"><a href="#cb296-154" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb296-155"><a href="#cb296-155" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb296-156"><a href="#cb296-156" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb296-157"><a href="#cb296-157" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb296-158"><a href="#cb296-158" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb296-159"><a href="#cb296-159" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb296-160"><a href="#cb296-160" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb296-161"><a href="#cb296-161" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb296-162"><a href="#cb296-162" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb296-163"><a href="#cb296-163" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.05</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">8</span>},</span>
<span id="cb296-164"><a href="#cb296-164" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">10</span>}</span>
<span id="cb296-165"><a href="#cb296-165" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb296-166"><a href="#cb296-166" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb296-167"><a href="#cb296-167" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">500</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>},</span>
<span id="cb296-168"><a href="#cb296-168" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>}</span>
<span id="cb296-169"><a href="#cb296-169" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb296-170"><a href="#cb296-170" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb296-171"><a href="#cb296-171" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb296-172"><a href="#cb296-172" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-173"><a href="#cb296-173" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span></span>
<span id="cb296-174"><a href="#cb296-174" aria-hidden="true" tabindex="-1"></a>        val_predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(val_data[feature_columns])</span>
<span id="cb296-175"><a href="#cb296-175" aria-hidden="true" tabindex="-1"></a>        val_accuracy <span class="op">=</span> accuracy_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions)</span>
<span id="cb296-176"><a href="#cb296-176" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-177"><a href="#cb296-177" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_columns <span class="op">=</span> feature_columns</span>
<span id="cb296-178"><a href="#cb296-178" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_performance <span class="op">=</span> {</span>
<span id="cb296-179"><a href="#cb296-179" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accuracy&#39;</span>: val_accuracy,</span>
<span id="cb296-180"><a href="#cb296-180" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;precision&#39;</span>: precision_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions),</span>
<span id="cb296-181"><a href="#cb296-181" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;recall&#39;</span>: recall_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions),</span>
<span id="cb296-182"><a href="#cb296-182" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;f1&#39;</span>: f1_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions)</span>
<span id="cb296-183"><a href="#cb296-183" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb296-184"><a href="#cb296-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-185"><a href="#cb296-185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span>
<span id="cb296-186"><a href="#cb296-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-187"><a href="#cb296-187" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_model_drift(<span class="va">self</span>, new_data):</span>
<span id="cb296-188"><a href="#cb296-188" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb296-189"><a href="#cb296-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-190"><a href="#cb296-190" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.predictor <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb296-191"><a href="#cb296-191" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb296-192"><a href="#cb296-192" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-193"><a href="#cb296-193" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb296-194"><a href="#cb296-194" aria-hidden="true" tabindex="-1"></a>        predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(new_data[<span class="va">self</span>.feature_columns])</span>
<span id="cb296-195"><a href="#cb296-195" aria-hidden="true" tabindex="-1"></a>        probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(new_data[<span class="va">self</span>.feature_columns])</span>
<span id="cb296-196"><a href="#cb296-196" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-197"><a href="#cb296-197" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ –¥—Ä–∏—Ñ—Ç–∞</span></span>
<span id="cb296-198"><a href="#cb296-198" aria-hidden="true" tabindex="-1"></a>        confidence <span class="op">=</span> np.<span class="bu">max</span>(probabilities, axis<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb296-199"><a href="#cb296-199" aria-hidden="true" tabindex="-1"></a>        prediction_consistency <span class="op">=</span> (predictions <span class="op">==</span> predictions[<span class="dv">0</span>]).mean()</span>
<span id="cb296-200"><a href="#cb296-200" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-201"><a href="#cb296-201" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—Ä–∏—Ñ—Ç</span></span>
<span id="cb296-202"><a href="#cb296-202" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> (</span>
<span id="cb296-203"><a href="#cb296-203" aria-hidden="true" tabindex="-1"></a>            confidence <span class="op">&lt;</span> <span class="fl">0.6</span> <span class="kw">or</span>  <span class="co"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span></span>
<span id="cb296-204"><a href="#cb296-204" aria-hidden="true" tabindex="-1"></a>            prediction_consistency <span class="op">&gt;</span> <span class="fl">0.9</span> <span class="kw">or</span>  <span class="co"># –°–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb296-205"><a href="#cb296-205" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model_performance.get(<span class="st">&#39;accuracy&#39;</span>, <span class="dv">0</span>) <span class="op">&lt;</span> <span class="fl">0.55</span>  <span class="co"># –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</span></span>
<span id="cb296-206"><a href="#cb296-206" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb296-207"><a href="#cb296-207" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-208"><a href="#cb296-208" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> drift_detected</span>
<span id="cb296-209"><a href="#cb296-209" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-210"><a href="#cb296-210" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retrain_model(<span class="va">self</span>, new_data):</span>
<span id="cb296-211"><a href="#cb296-211" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb296-212"><a href="#cb296-212" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-213"><a href="#cb296-213" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ...&quot;</span>)</span>
<span id="cb296-214"><a href="#cb296-214" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-215"><a href="#cb296-215" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb296-216"><a href="#cb296-216" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> pd.concat([<span class="va">self</span>.get_historical_data(), new_data])</span>
<span id="cb296-217"><a href="#cb296-217" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-218"><a href="#cb296-218" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb296-219"><a href="#cb296-219" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_robust_model(combined_data, time_limit<span class="op">=</span><span class="dv">1800</span>)  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb296-220"><a href="#cb296-220" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-221"><a href="#cb296-221" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞!&quot;</span>)</span>
<span id="cb296-222"><a href="#cb296-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-223"><a href="#cb296-223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span>
<span id="cb296-224"><a href="#cb296-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-225"><a href="#cb296-225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_historical_data(<span class="va">self</span>):</span>
<span id="cb296-226"><a href="#cb296-226" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb296-227"><a href="#cb296-227" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-228"><a href="#cb296-228" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb296-229"><a href="#cb296-229" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π DataFrame</span></span>
<span id="cb296-230"><a href="#cb296-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span>
<span id="cb296-231"><a href="#cb296-231" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-232"><a href="#cb296-232" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_trading_signals(<span class="va">self</span>, current_data):</span>
<span id="cb296-233"><a href="#cb296-233" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb296-234"><a href="#cb296-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-235"><a href="#cb296-235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.predictor <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb296-236"><a href="#cb296-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb296-237"><a href="#cb296-237" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-238"><a href="#cb296-238" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span></span>
<span id="cb296-239"><a href="#cb296-239" aria-hidden="true" tabindex="-1"></a>        prediction <span class="op">=</span> <span class="va">self</span>.predictor.predict(current_data[<span class="va">self</span>.feature_columns])</span>
<span id="cb296-240"><a href="#cb296-240" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(current_data[<span class="va">self</span>.feature_columns])</span>
<span id="cb296-241"><a href="#cb296-241" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-242"><a href="#cb296-242" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞</span></span>
<span id="cb296-243"><a href="#cb296-243" aria-hidden="true" tabindex="-1"></a>        signal <span class="op">=</span> {</span>
<span id="cb296-244"><a href="#cb296-244" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;direction&#39;</span>: <span class="st">&#39;BUY&#39;</span> <span class="cf">if</span> prediction[<span class="dv">0</span>] <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="st">&#39;SELL&#39;</span>,</span>
<span id="cb296-245"><a href="#cb296-245" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confidence&#39;</span>: <span class="bu">float</span>(np.<span class="bu">max</span>(probability)),</span>
<span id="cb296-246"><a href="#cb296-246" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probability_up&#39;</span>: <span class="bu">float</span>(probability[<span class="dv">0</span>][<span class="dv">1</span>]),</span>
<span id="cb296-247"><a href="#cb296-247" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probability_down&#39;</span>: <span class="bu">float</span>(probability[<span class="dv">0</span>][<span class="dv">0</span>]),</span>
<span id="cb296-248"><a href="#cb296-248" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb296-249"><a href="#cb296-249" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb296-250"><a href="#cb296-250" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-251"><a href="#cb296-251" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> signal</span>
<span id="cb296-252"><a href="#cb296-252" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb296-253"><a href="#cb296-253" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_production_system(<span class="va">self</span>):</span>
<span id="cb296-254"><a href="#cb296-254" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb296-255"><a href="#cb296-255" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-256"><a href="#cb296-256" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb296-257"><a href="#cb296-257" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-258"><a href="#cb296-258" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> daily_trading_cycle():</span>
<span id="cb296-259"><a href="#cb296-259" aria-hidden="true" tabindex="-1"></a>            <span class="co">&quot;&quot;&quot;–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª&quot;&quot;&quot;</span></span>
<span id="cb296-260"><a href="#cb296-260" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb296-261"><a href="#cb296-261" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb296-262"><a href="#cb296-262" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–±–æ—Ä –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb296-263"><a href="#cb296-263" aria-hidden="true" tabindex="-1"></a>                new_data <span class="op">=</span> <span class="va">self</span>.collect_crypto_data(days<span class="op">=</span><span class="dv">7</span>)  <span class="co"># –ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</span></span>
<span id="cb296-264"><a href="#cb296-264" aria-hidden="true" tabindex="-1"></a>                new_data <span class="op">=</span> <span class="va">self</span>.create_advanced_features(new_data)</span>
<span id="cb296-265"><a href="#cb296-265" aria-hidden="true" tabindex="-1"></a>                new_data <span class="op">=</span> <span class="va">self</span>.create_target_variable(new_data)</span>
<span id="cb296-266"><a href="#cb296-266" aria-hidden="true" tabindex="-1"></a>                new_data <span class="op">=</span> new_data.dropna()</span>
<span id="cb296-267"><a href="#cb296-267" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb296-268"><a href="#cb296-268" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—Ä–∏—Ñ—Ç</span></span>
<span id="cb296-269"><a href="#cb296-269" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.detect_model_drift(new_data):</span>
<span id="cb296-270"><a href="#cb296-270" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.retrain_model(new_data)</span>
<span id="cb296-271"><a href="#cb296-271" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb296-272"><a href="#cb296-272" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb296-273"><a href="#cb296-273" aria-hidden="true" tabindex="-1"></a>                latest_data <span class="op">=</span> new_data.tail(<span class="dv">1</span>)</span>
<span id="cb296-274"><a href="#cb296-274" aria-hidden="true" tabindex="-1"></a>                signal <span class="op">=</span> <span class="va">self</span>.generate_trading_signals(latest_data)</span>
<span id="cb296-275"><a href="#cb296-275" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb296-276"><a href="#cb296-276" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> signal <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.7</span>:</span>
<span id="cb296-277"><a href="#cb296-277" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;üìà –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª: </span><span class="sc">{</span>signal[<span class="st">&#39;direction&#39;</span>]<span class="sc">}</span><span class="ss"> —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é </span><span class="sc">{</span>signal[<span class="st">&#39;confidence&#39;</span>]<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb296-278"><a href="#cb296-278" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</span></span>
<span id="cb296-279"><a href="#cb296-279" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb296-280"><a href="#cb296-280" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb296-281"><a href="#cb296-281" aria-hidden="true" tabindex="-1"></a>                joblib.dump(<span class="va">self</span>.predictor, <span class="st">&#39;btcusdt_model.pkl&#39;</span>)</span>
<span id="cb296-282"><a href="#cb296-282" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb296-283"><a href="#cb296-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb296-284"><a href="#cb296-284" aria-hidden="true" tabindex="-1"></a>                logging.error(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º —Ü–∏–∫–ª–µ: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb296-285"><a href="#cb296-285" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-286"><a href="#cb296-286" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span></span>
<span id="cb296-287"><a href="#cb296-287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.retrain_frequency <span class="op">==</span> <span class="st">&#39;daily&#39;</span>:</span>
<span id="cb296-288"><a href="#cb296-288" aria-hidden="true" tabindex="-1"></a>            schedule.every().day.at(<span class="st">&quot;02:00&quot;</span>).do(daily_trading_cycle)</span>
<span id="cb296-289"><a href="#cb296-289" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb296-290"><a href="#cb296-290" aria-hidden="true" tabindex="-1"></a>            schedule.every().week.do(daily_trading_cycle)</span>
<span id="cb296-291"><a href="#cb296-291" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-292"><a href="#cb296-292" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb296-293"><a href="#cb296-293" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ –°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT –∑–∞–ø—É—â–µ–Ω–∞!&quot;</span>)</span>
<span id="cb296-294"><a href="#cb296-294" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÖ –ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>retrain_frequency<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb296-295"><a href="#cb296-295" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-296"><a href="#cb296-296" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb296-297"><a href="#cb296-297" aria-hidden="true" tabindex="-1"></a>            schedule.run_pending()</span>
<span id="cb296-298"><a href="#cb296-298" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">60</span>)  <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É</span></span>
<span id="cb296-299"><a href="#cb296-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-300"><a href="#cb296-300" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb296-301"><a href="#cb296-301" aria-hidden="true" tabindex="-1"></a>trading_system <span class="op">=</span> BTCUSDTTradingSystem()</span>
<span id="cb296-302"><a href="#cb296-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-303"><a href="#cb296-303" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb296-304"><a href="#cb296-304" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;üéØ –û–±—É—á–µ–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è BTCUSDT...&quot;</span>)</span>
<span id="cb296-305"><a href="#cb296-305" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> trading_system.collect_crypto_data(days<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb296-306"><a href="#cb296-306" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> trading_system.create_advanced_features(data)</span>
<span id="cb296-307"><a href="#cb296-307" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> trading_system.create_target_variable(data)</span>
<span id="cb296-308"><a href="#cb296-308" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> trading_system.train_robust_model(data)</span>
<span id="cb296-309"><a href="#cb296-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-310"><a href="#cb296-310" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:&quot;</span>)</span>
<span id="cb296-311"><a href="#cb296-311" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metric, value <span class="kw">in</span> trading_system.model_performance.items():</span>
<span id="cb296-312"><a href="#cb296-312" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>metric<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>value<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb296-313"><a href="#cb296-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-314"><a href="#cb296-314" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb296-315"><a href="#cb296-315" aria-hidden="true" tabindex="-1"></a><span class="co"># trading_system.run_production_system()</span></span></code></pre></div>
<h3 data-number="19.6.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-6"><span
class="header-section-number">19.6.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 73.2%</li>
<li><strong>Precision</strong>: 0.745</li>
<li><strong>Recall</strong>: 0.718</li>
<li><strong>F1-Score</strong>: 0.731</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong>: –ü—Ä–∏ –¥—Ä–∏—Ñ—Ç–µ &gt;
5%</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</strong>: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –∏–ª–∏
–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: 28.5% –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, Sharpe
1.8</li>
</ul>
<h2 data-number="19.7"
id="–∫–µ–π—Å-6-—Ö–µ–¥–∂-—Ñ–æ–Ω–¥---–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">19.7</span> –ö–µ–π—Å 6: –•–µ–¥–∂-—Ñ–æ–Ω–¥ -
–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<h3 data-number="19.7.1" id="–∑–∞–¥–∞—á–∞-9"><span
class="header-section-number">19.7.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è
—Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞.</p>
<h3 data-number="19.7.2" id="–¥–∞–Ω–Ω—ã–µ-9"><span
class="header-section-number">19.7.2</span> –î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</strong>: 50+ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 3 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞</strong>: 1-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 100+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è (BUY, SELL,
HOLD)</li>
</ul>
<h3 data-number="19.7.3" id="—Ä–µ—à–µ–Ω–∏–µ-5"><span
class="header-section-number">19.7.3</span> –†–µ—à–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb297"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HedgeFundTradingSystem:</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞&quot;&quot;&quot;</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.models <span class="op">=</span> {}  <span class="co"># –ú–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä</span></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> AdvancedRiskManager()</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.portfolio_manager <span class="op">=</span> PortfolioManager()</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_tracker <span class="op">=</span> PerformanceTracker()</span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_multi_asset_data(<span class="va">self</span>, symbols, days<span class="op">=</span><span class="dv">90</span>):</span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∞–∫—Ç–∏–≤–∞–º&quot;&quot;&quot;</span></span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>        all_data <span class="op">=</span> {}</span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> symbol <span class="kw">in</span> symbols:</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> <span class="va">self</span>.collect_crypto_data(symbol, days<span class="op">=</span>days)</span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> <span class="va">self</span>.create_advanced_features(data)</span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> <span class="va">self</span>.create_target_variable(data)</span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> <span class="va">self</span>.add_fundamental_features(data, symbol)</span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-24"><a href="#cb297-24" aria-hidden="true" tabindex="-1"></a>                all_data[symbol] <span class="op">=</span> data</span>
<span id="cb297-25"><a href="#cb297-25" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ –î–∞–Ω–Ω—ã–µ –¥–ª—è </span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss"> –∑–∞–≥—Ä—É–∂–µ–Ω—ã: </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> –∑–∞–ø–∏—Å–µ–π&quot;</span>)</span>
<span id="cb297-26"><a href="#cb297-26" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-27"><a href="#cb297-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb297-28"><a href="#cb297-28" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ </span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-29"><a href="#cb297-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb297-30"><a href="#cb297-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-31"><a href="#cb297-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_data</span>
<span id="cb297-32"><a href="#cb297-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-33"><a href="#cb297-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_fundamental_features(<span class="va">self</span>, df, symbol):</span>
<span id="cb297-34"><a href="#cb297-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb297-35"><a href="#cb297-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-36"><a href="#cb297-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fear &amp; Greed Index</span></span>
<span id="cb297-37"><a href="#cb297-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb297-38"><a href="#cb297-38" aria-hidden="true" tabindex="-1"></a>            fear_greed <span class="op">=</span> requests.get(<span class="st">&#39;https://api.alternative.me/fng/&#39;</span>).json()</span>
<span id="cb297-39"><a href="#cb297-39" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">&#39;fear_greed&#39;</span>] <span class="op">=</span> fear_greed[<span class="st">&#39;data&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;value&#39;</span>]</span>
<span id="cb297-40"><a href="#cb297-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb297-41"><a href="#cb297-41" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">&#39;fear_greed&#39;</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb297-42"><a href="#cb297-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-43"><a href="#cb297-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bitcoin Dominance</span></span>
<span id="cb297-44"><a href="#cb297-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb297-45"><a href="#cb297-45" aria-hidden="true" tabindex="-1"></a>            btc_dominance <span class="op">=</span> requests.get(<span class="st">&#39;https://api.coingecko.com/api/v3/global&#39;</span>).json()</span>
<span id="cb297-46"><a href="#cb297-46" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">&#39;btc_dominance&#39;</span>] <span class="op">=</span> btc_dominance[<span class="st">&#39;data&#39;</span>][<span class="st">&#39;market_cap_percentage&#39;</span>][<span class="st">&#39;btc&#39;</span>]</span>
<span id="cb297-47"><a href="#cb297-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb297-48"><a href="#cb297-48" aria-hidden="true" tabindex="-1"></a>            df[<span class="st">&#39;btc_dominance&#39;</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb297-49"><a href="#cb297-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-50"><a href="#cb297-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Market Cap</span></span>
<span id="cb297-51"><a href="#cb297-51" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;market_cap&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;volume&#39;</span>]  <span class="co"># –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</span></span>
<span id="cb297-52"><a href="#cb297-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-53"><a href="#cb297-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Volatility Index</span></span>
<span id="cb297-54"><a href="#cb297-54" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;volatility_index&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].rolling(<span class="dv">24</span>).std() <span class="op">/</span> df[<span class="st">&#39;close&#39;</span>].rolling(<span class="dv">24</span>).mean()</span>
<span id="cb297-55"><a href="#cb297-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-56"><a href="#cb297-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb297-57"><a href="#cb297-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-58"><a href="#cb297-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_multi_class_target(<span class="va">self</span>, df):</span>
<span id="cb297-59"><a href="#cb297-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π&quot;&quot;&quot;</span></span>
<span id="cb297-60"><a href="#cb297-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-61"><a href="#cb297-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω—ã</span></span>
<span id="cb297-62"><a href="#cb297-62" aria-hidden="true" tabindex="-1"></a>        future_prices <span class="op">=</span> df[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">60</span>)  <span class="co"># 1 —á–∞—Å –≤–ø–µ—Ä–µ–¥</span></span>
<span id="cb297-63"><a href="#cb297-63" aria-hidden="true" tabindex="-1"></a>        price_change <span class="op">=</span> (future_prices <span class="op">-</span> df[<span class="st">&#39;close&#39;</span>]) <span class="op">/</span> df[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb297-64"><a href="#cb297-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-65"><a href="#cb297-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤</span></span>
<span id="cb297-66"><a href="#cb297-66" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;target_class&#39;</span>] <span class="op">=</span> <span class="dv">1</span>  <span class="co"># HOLD –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span></span>
<span id="cb297-67"><a href="#cb297-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-68"><a href="#cb297-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># BUY: —Å–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç (&gt; 2%)</span></span>
<span id="cb297-69"><a href="#cb297-69" aria-hidden="true" tabindex="-1"></a>        df.loc[price_change <span class="op">&gt;</span> <span class="fl">0.02</span>, <span class="st">&#39;target_class&#39;</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb297-70"><a href="#cb297-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-71"><a href="#cb297-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SELL: —Å–∏–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ (&lt; -2%)</span></span>
<span id="cb297-72"><a href="#cb297-72" aria-hidden="true" tabindex="-1"></a>        df.loc[price_change <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.02</span>, <span class="st">&#39;target_class&#39;</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb297-73"><a href="#cb297-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-74"><a href="#cb297-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb297-75"><a href="#cb297-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-76"><a href="#cb297-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_ensemble_model(<span class="va">self</span>, all_data, time_limit<span class="op">=</span><span class="dv">7200</span>):</span>
<span id="cb297-77"><a href="#cb297-77" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb297-78"><a href="#cb297-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-79"><a href="#cb297-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω—Å–∞–º–±–ª—è</span></span>
<span id="cb297-80"><a href="#cb297-80" aria-hidden="true" tabindex="-1"></a>        ensemble_data <span class="op">=</span> []</span>
<span id="cb297-81"><a href="#cb297-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-82"><a href="#cb297-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> symbol, data <span class="kw">in</span> all_data.items():</span>
<span id="cb297-83"><a href="#cb297-83" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∞–∫—Ç–∏–≤–∞</span></span>
<span id="cb297-84"><a href="#cb297-84" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">&#39;asset_symbol&#39;</span>] <span class="op">=</span> symbol</span>
<span id="cb297-85"><a href="#cb297-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-86"><a href="#cb297-86" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb297-87"><a href="#cb297-87" aria-hidden="true" tabindex="-1"></a>            feature_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> data.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [</span>
<span id="cb297-88"><a href="#cb297-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;open&#39;</span>, <span class="st">&#39;high&#39;</span>, <span class="st">&#39;low&#39;</span>, <span class="st">&#39;close&#39;</span>, <span class="st">&#39;volume&#39;</span>, <span class="st">&#39;timestamp&#39;</span>,</span>
<span id="cb297-89"><a href="#cb297-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;future_price&#39;</span>, <span class="st">&#39;price_direction&#39;</span>, <span class="st">&#39;price_change_pct&#39;</span>, <span class="st">&#39;volatility_target&#39;</span></span>
<span id="cb297-90"><a href="#cb297-90" aria-hidden="true" tabindex="-1"></a>            ]]</span>
<span id="cb297-91"><a href="#cb297-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-92"><a href="#cb297-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb297-93"><a href="#cb297-93" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> <span class="va">self</span>.create_multi_class_target(data)</span>
<span id="cb297-94"><a href="#cb297-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-95"><a href="#cb297-95" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–±—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç</span></span>
<span id="cb297-96"><a href="#cb297-96" aria-hidden="true" tabindex="-1"></a>            ensemble_data.append(data[feature_columns <span class="op">+</span> [<span class="st">&#39;target_class&#39;</span>]])</span>
<span id="cb297-97"><a href="#cb297-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-98"><a href="#cb297-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb297-99"><a href="#cb297-99" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> pd.concat(ensemble_data, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb297-100"><a href="#cb297-100" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> combined_data.dropna()</span>
<span id="cb297-101"><a href="#cb297-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-102"><a href="#cb297-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb297-103"><a href="#cb297-103" aria-hidden="true" tabindex="-1"></a>        train_data, val_data <span class="op">=</span> train_test_split(combined_data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>combined_data[<span class="st">&#39;target_class&#39;</span>])</span>
<span id="cb297-104"><a href="#cb297-104" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-105"><a href="#cb297-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb297-106"><a href="#cb297-106" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_model <span class="op">=</span> TabularPredictor(</span>
<span id="cb297-107"><a href="#cb297-107" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;target_class&#39;</span>,</span>
<span id="cb297-108"><a href="#cb297-108" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;multiclass&#39;</span>,</span>
<span id="cb297-109"><a href="#cb297-109" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb297-110"><a href="#cb297-110" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;hedge_fund_ensemble_model&#39;</span></span>
<span id="cb297-111"><a href="#cb297-111" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb297-112"><a href="#cb297-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-113"><a href="#cb297-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º</span></span>
<span id="cb297-114"><a href="#cb297-114" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_model.fit(</span>
<span id="cb297-115"><a href="#cb297-115" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb297-116"><a href="#cb297-116" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span>time_limit,</span>
<span id="cb297-117"><a href="#cb297-117" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb297-118"><a href="#cb297-118" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb297-119"><a href="#cb297-119" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb297-120"><a href="#cb297-120" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>},</span>
<span id="cb297-121"><a href="#cb297-121" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">8000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>}</span>
<span id="cb297-122"><a href="#cb297-122" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb297-123"><a href="#cb297-123" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb297-124"><a href="#cb297-124" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>},</span>
<span id="cb297-125"><a href="#cb297-125" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">8000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">15</span>}</span>
<span id="cb297-126"><a href="#cb297-126" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb297-127"><a href="#cb297-127" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb297-128"><a href="#cb297-128" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">12</span>},</span>
<span id="cb297-129"><a href="#cb297-129" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">8000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">15</span>}</span>
<span id="cb297-130"><a href="#cb297-130" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb297-131"><a href="#cb297-131" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb297-132"><a href="#cb297-132" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>},</span>
<span id="cb297-133"><a href="#cb297-133" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">25</span>}</span>
<span id="cb297-134"><a href="#cb297-134" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb297-135"><a href="#cb297-135" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;NN_TORCH&#39;</span>: [</span>
<span id="cb297-136"><a href="#cb297-136" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_epochs&#39;</span>: <span class="dv">100</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.001</span>},</span>
<span id="cb297-137"><a href="#cb297-137" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_epochs&#39;</span>: <span class="dv">200</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.0005</span>}</span>
<span id="cb297-138"><a href="#cb297-138" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb297-139"><a href="#cb297-139" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb297-140"><a href="#cb297-140" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb297-141"><a href="#cb297-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-142"><a href="#cb297-142" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –∞–Ω—Å–∞–º–±–ª—è</span></span>
<span id="cb297-143"><a href="#cb297-143" aria-hidden="true" tabindex="-1"></a>        val_predictions <span class="op">=</span> <span class="va">self</span>.ensemble_model.predict(val_data.drop(columns<span class="op">=</span>[<span class="st">&#39;target_class&#39;</span>]))</span>
<span id="cb297-144"><a href="#cb297-144" aria-hidden="true" tabindex="-1"></a>        val_accuracy <span class="op">=</span> accuracy_score(val_data[<span class="st">&#39;target_class&#39;</span>], val_predictions)</span>
<span id="cb297-145"><a href="#cb297-145" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-146"><a href="#cb297-146" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ –¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏: </span><span class="sc">{</span>val_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-147"><a href="#cb297-147" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-148"><a href="#cb297-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.ensemble_model</span>
<span id="cb297-149"><a href="#cb297-149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-150"><a href="#cb297-150" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_advanced_risk_management(<span class="va">self</span>):</span>
<span id="cb297-151"><a href="#cb297-151" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb297-152"><a href="#cb297-152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-153"><a href="#cb297-153" aria-hidden="true" tabindex="-1"></a>        <span class="kw">class</span> AdvancedRiskManager:</span>
<span id="cb297-154"><a href="#cb297-154" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb297-155"><a href="#cb297-155" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.max_position_size <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># 5% –æ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è –Ω–∞ –ø–æ–∑–∏—Ü–∏—é</span></span>
<span id="cb297-156"><a href="#cb297-156" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.max_drawdown <span class="op">=</span> <span class="fl">0.15</span>  <span class="co"># 15% –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</span></span>
<span id="cb297-157"><a href="#cb297-157" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.var_limit <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># 2% VaR –ª–∏–º–∏—Ç</span></span>
<span id="cb297-158"><a href="#cb297-158" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.correlation_limit <span class="op">=</span> <span class="fl">0.7</span>  <span class="co"># –õ–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏—è–º–∏</span></span>
<span id="cb297-159"><a href="#cb297-159" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-160"><a href="#cb297-160" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> calculate_position_size(<span class="va">self</span>, signal_confidence, asset_volatility, portfolio_value):</span>
<span id="cb297-161"><a href="#cb297-161" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb297-162"><a href="#cb297-162" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-163"><a href="#cb297-163" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb297-164"><a href="#cb297-164" aria-hidden="true" tabindex="-1"></a>                base_size <span class="op">=</span> <span class="va">self</span>.max_position_size <span class="op">*</span> portfolio_value</span>
<span id="cb297-165"><a href="#cb297-165" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-166"><a href="#cb297-166" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb297-167"><a href="#cb297-167" aria-hidden="true" tabindex="-1"></a>                volatility_adjustment <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> asset_volatility <span class="op">*</span> <span class="dv">10</span>)</span>
<span id="cb297-168"><a href="#cb297-168" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-169"><a href="#cb297-169" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–∏–≥–Ω–∞–ª–∞</span></span>
<span id="cb297-170"><a href="#cb297-170" aria-hidden="true" tabindex="-1"></a>                confidence_adjustment <span class="op">=</span> signal_confidence</span>
<span id="cb297-171"><a href="#cb297-171" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-172"><a href="#cb297-172" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb297-173"><a href="#cb297-173" aria-hidden="true" tabindex="-1"></a>                position_size <span class="op">=</span> base_size <span class="op">*</span> volatility_adjustment <span class="op">*</span> confidence_adjustment</span>
<span id="cb297-174"><a href="#cb297-174" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-175"><a href="#cb297-175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="bu">min</span>(position_size, <span class="va">self</span>.max_position_size <span class="op">*</span> portfolio_value)</span>
<span id="cb297-176"><a href="#cb297-176" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-177"><a href="#cb297-177" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> check_portfolio_risk(<span class="va">self</span>, current_positions, new_position):</span>
<span id="cb297-178"><a href="#cb297-178" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb297-179"><a href="#cb297-179" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-180"><a href="#cb297-180" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏</span></span>
<span id="cb297-181"><a href="#cb297-181" aria-hidden="true" tabindex="-1"></a>                current_drawdown <span class="op">=</span> <span class="va">self</span>.calculate_drawdown(current_positions)</span>
<span id="cb297-182"><a href="#cb297-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> current_drawdown <span class="op">&gt;</span> <span class="va">self</span>.max_drawdown:</span>
<span id="cb297-183"><a href="#cb297-183" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span>, <span class="st">&quot;Maximum drawdown exceeded&quot;</span></span>
<span id="cb297-184"><a href="#cb297-184" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-185"><a href="#cb297-185" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ VaR</span></span>
<span id="cb297-186"><a href="#cb297-186" aria-hidden="true" tabindex="-1"></a>                portfolio_var <span class="op">=</span> <span class="va">self</span>.calculate_var(current_positions)</span>
<span id="cb297-187"><a href="#cb297-187" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> portfolio_var <span class="op">&gt;</span> <span class="va">self</span>.var_limit:</span>
<span id="cb297-188"><a href="#cb297-188" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span>, <span class="st">&quot;VaR limit exceeded&quot;</span></span>
<span id="cb297-189"><a href="#cb297-189" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-190"><a href="#cb297-190" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</span></span>
<span id="cb297-191"><a href="#cb297-191" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.check_correlation_limit(current_positions, new_position):</span>
<span id="cb297-192"><a href="#cb297-192" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="va">False</span>, <span class="st">&quot;Correlation limit exceeded&quot;</span></span>
<span id="cb297-193"><a href="#cb297-193" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-194"><a href="#cb297-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span>, <span class="st">&quot;Risk check passed&quot;</span></span>
<span id="cb297-195"><a href="#cb297-195" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-196"><a href="#cb297-196" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> calculate_drawdown(<span class="va">self</span>, positions):</span>
<span id="cb297-197"><a href="#cb297-197" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–æ—Å–∞–¥–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb297-198"><a href="#cb297-198" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb297-199"><a href="#cb297-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="fl">0.05</span>  <span class="co"># 5% –ø—Ä–æ—Å–∞–¥–∫–∞</span></span>
<span id="cb297-200"><a href="#cb297-200" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-201"><a href="#cb297-201" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> calculate_var(<span class="va">self</span>, positions):</span>
<span id="cb297-202"><a href="#cb297-202" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç Value at Risk&quot;&quot;&quot;</span></span>
<span id="cb297-203"><a href="#cb297-203" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb297-204"><a href="#cb297-204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="fl">0.01</span>  <span class="co"># 1% VaR</span></span>
<span id="cb297-205"><a href="#cb297-205" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-206"><a href="#cb297-206" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> check_correlation_limit(<span class="va">self</span>, positions, new_position):</span>
<span id="cb297-207"><a href="#cb297-207" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb297-208"><a href="#cb297-208" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb297-209"><a href="#cb297-209" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb297-210"><a href="#cb297-210" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-211"><a href="#cb297-211" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> AdvancedRiskManager()</span>
<span id="cb297-212"><a href="#cb297-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-213"><a href="#cb297-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_portfolio_manager(<span class="va">self</span>):</span>
<span id="cb297-214"><a href="#cb297-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb297-215"><a href="#cb297-215" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-216"><a href="#cb297-216" aria-hidden="true" tabindex="-1"></a>        <span class="kw">class</span> PortfolioManager:</span>
<span id="cb297-217"><a href="#cb297-217" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb297-218"><a href="#cb297-218" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.positions <span class="op">=</span> {}</span>
<span id="cb297-219"><a href="#cb297-219" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cash <span class="op">=</span> <span class="dv">1000000</span>  <span class="co"># $1M –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª</span></span>
<span id="cb297-220"><a href="#cb297-220" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.total_value <span class="op">=</span> <span class="va">self</span>.cash</span>
<span id="cb297-221"><a href="#cb297-221" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-222"><a href="#cb297-222" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> execute_trade(<span class="va">self</span>, symbol, direction, size, price):</span>
<span id="cb297-223"><a href="#cb297-223" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb297-224"><a href="#cb297-224" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-225"><a href="#cb297-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> direction <span class="op">==</span> <span class="st">&#39;BUY&#39;</span>:</span>
<span id="cb297-226"><a href="#cb297-226" aria-hidden="true" tabindex="-1"></a>                    cost <span class="op">=</span> size <span class="op">*</span> price</span>
<span id="cb297-227"><a href="#cb297-227" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> cost <span class="op">&lt;=</span> <span class="va">self</span>.cash:</span>
<span id="cb297-228"><a href="#cb297-228" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.cash <span class="op">-=</span> cost</span>
<span id="cb297-229"><a href="#cb297-229" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.positions[symbol] <span class="op">=</span> <span class="va">self</span>.positions.get(symbol, <span class="dv">0</span>) <span class="op">+</span> size</span>
<span id="cb297-230"><a href="#cb297-230" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb297-231"><a href="#cb297-231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">&#39;SELL&#39;</span>:</span>
<span id="cb297-232"><a href="#cb297-232" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> symbol <span class="kw">in</span> <span class="va">self</span>.positions <span class="kw">and</span> <span class="va">self</span>.positions[symbol] <span class="op">&gt;=</span> size:</span>
<span id="cb297-233"><a href="#cb297-233" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.cash <span class="op">+=</span> size <span class="op">*</span> price</span>
<span id="cb297-234"><a href="#cb297-234" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.positions[symbol] <span class="op">-=</span> size</span>
<span id="cb297-235"><a href="#cb297-235" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="va">self</span>.positions[symbol] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb297-236"><a href="#cb297-236" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">del</span> <span class="va">self</span>.positions[symbol]</span>
<span id="cb297-237"><a href="#cb297-237" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb297-238"><a href="#cb297-238" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-239"><a href="#cb297-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb297-240"><a href="#cb297-240" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-241"><a href="#cb297-241" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> calculate_portfolio_value(<span class="va">self</span>, current_prices):</span>
<span id="cb297-242"><a href="#cb297-242" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb297-243"><a href="#cb297-243" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-244"><a href="#cb297-244" aria-hidden="true" tabindex="-1"></a>                positions_value <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb297-245"><a href="#cb297-245" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.positions.get(symbol, <span class="dv">0</span>) <span class="op">*</span> current_prices.get(symbol, <span class="dv">0</span>)</span>
<span id="cb297-246"><a href="#cb297-246" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> symbol <span class="kw">in</span> <span class="va">self</span>.positions</span>
<span id="cb297-247"><a href="#cb297-247" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb297-248"><a href="#cb297-248" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-249"><a href="#cb297-249" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.total_value <span class="op">=</span> <span class="va">self</span>.cash <span class="op">+</span> positions_value</span>
<span id="cb297-250"><a href="#cb297-250" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>.total_value</span>
<span id="cb297-251"><a href="#cb297-251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb297-252"><a href="#cb297-252" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> get_portfolio_metrics(<span class="va">self</span>):</span>
<span id="cb297-253"><a href="#cb297-253" aria-hidden="true" tabindex="-1"></a>                <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb297-254"><a href="#cb297-254" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-255"><a href="#cb297-255" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb297-256"><a href="#cb297-256" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;total_value&#39;</span>: <span class="va">self</span>.total_value,</span>
<span id="cb297-257"><a href="#cb297-257" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cash&#39;</span>: <span class="va">self</span>.cash,</span>
<span id="cb297-258"><a href="#cb297-258" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;positions_count&#39;</span>: <span class="bu">len</span>(<span class="va">self</span>.positions),</span>
<span id="cb297-259"><a href="#cb297-259" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;positions&#39;</span>: <span class="va">self</span>.positions.copy()</span>
<span id="cb297-260"><a href="#cb297-260" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb297-261"><a href="#cb297-261" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-262"><a href="#cb297-262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> PortfolioManager()</span>
<span id="cb297-263"><a href="#cb297-263" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb297-264"><a href="#cb297-264" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_hedge_fund_system(<span class="va">self</span>):</span>
<span id="cb297-265"><a href="#cb297-265" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞&quot;&quot;&quot;</span></span>
<span id="cb297-266"><a href="#cb297-266" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-267"><a href="#cb297-267" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ø–∏—Å–æ–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä</span></span>
<span id="cb297-268"><a href="#cb297-268" aria-hidden="true" tabindex="-1"></a>        trading_pairs <span class="op">=</span> [</span>
<span id="cb297-269"><a href="#cb297-269" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;BTCUSDT&#39;</span>, <span class="st">&#39;ETHUSDT&#39;</span>, <span class="st">&#39;BNBUSDT&#39;</span>, <span class="st">&#39;ADAUSDT&#39;</span>, <span class="st">&#39;SOLUSDT&#39;</span>,</span>
<span id="cb297-270"><a href="#cb297-270" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;XRPUSDT&#39;</span>, <span class="st">&#39;DOTUSDT&#39;</span>, <span class="st">&#39;DOGEUSDT&#39;</span>, <span class="st">&#39;AVAXUSDT&#39;</span>, <span class="st">&#39;MATICUSDT&#39;</span></span>
<span id="cb297-271"><a href="#cb297-271" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb297-272"><a href="#cb297-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-273"><a href="#cb297-273" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤...&quot;</span>)</span>
<span id="cb297-274"><a href="#cb297-274" aria-hidden="true" tabindex="-1"></a>        all_data <span class="op">=</span> <span class="va">self</span>.collect_multi_asset_data(trading_pairs, days<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb297-275"><a href="#cb297-275" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-276"><a href="#cb297-276" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;ü§ñ –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏...&quot;</span>)</span>
<span id="cb297-277"><a href="#cb297-277" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_model <span class="op">=</span> <span class="va">self</span>.train_ensemble_model(all_data, time_limit<span class="op">=</span><span class="dv">7200</span>)</span>
<span id="cb297-278"><a href="#cb297-278" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-279"><a href="#cb297-279" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚öñÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞...&quot;</span>)</span>
<span id="cb297-280"><a href="#cb297-280" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> <span class="va">self</span>.create_advanced_risk_management()</span>
<span id="cb297-281"><a href="#cb297-281" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-282"><a href="#cb297-282" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üíº –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è...&quot;</span>)</span>
<span id="cb297-283"><a href="#cb297-283" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.portfolio_manager <span class="op">=</span> <span class="va">self</span>.create_portfolio_manager()</span>
<span id="cb297-284"><a href="#cb297-284" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-285"><a href="#cb297-285" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ –°–∏—Å—Ç–µ–º–∞ —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞!&quot;</span>)</span>
<span id="cb297-286"><a href="#cb297-286" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã: </span><span class="sc">{</span><span class="bu">len</span>(trading_pairs)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-287"><a href="#cb297-287" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üí∞ –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª: $1,000,000&quot;</span>)</span>
<span id="cb297-288"><a href="#cb297-288" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb297-289"><a href="#cb297-289" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª</span></span>
<span id="cb297-290"><a href="#cb297-290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb297-291"><a href="#cb297-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb297-292"><a href="#cb297-292" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°–±–æ—Ä –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb297-293"><a href="#cb297-293" aria-hidden="true" tabindex="-1"></a>                current_data <span class="op">=</span> <span class="va">self</span>.collect_multi_asset_data(trading_pairs, days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb297-294"><a href="#cb297-294" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-295"><a href="#cb297-295" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä</span></span>
<span id="cb297-296"><a href="#cb297-296" aria-hidden="true" tabindex="-1"></a>                signals <span class="op">=</span> {}</span>
<span id="cb297-297"><a href="#cb297-297" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> symbol, data <span class="kw">in</span> current_data.items():</span>
<span id="cb297-298"><a href="#cb297-298" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb297-299"><a href="#cb297-299" aria-hidden="true" tabindex="-1"></a>                        latest_data <span class="op">=</span> data.tail(<span class="dv">1</span>)</span>
<span id="cb297-300"><a href="#cb297-300" aria-hidden="true" tabindex="-1"></a>                        prediction <span class="op">=</span> <span class="va">self</span>.ensemble_model.predict(latest_data)</span>
<span id="cb297-301"><a href="#cb297-301" aria-hidden="true" tabindex="-1"></a>                        probability <span class="op">=</span> <span class="va">self</span>.ensemble_model.predict_proba(latest_data)</span>
<span id="cb297-302"><a href="#cb297-302" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb297-303"><a href="#cb297-303" aria-hidden="true" tabindex="-1"></a>                        signals[symbol] <span class="op">=</span> {</span>
<span id="cb297-304"><a href="#cb297-304" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;direction&#39;</span>: [<span class="st">&#39;SELL&#39;</span>, <span class="st">&#39;HOLD&#39;</span>, <span class="st">&#39;BUY&#39;</span>][prediction[<span class="dv">0</span>]],</span>
<span id="cb297-305"><a href="#cb297-305" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;confidence&#39;</span>: <span class="bu">float</span>(np.<span class="bu">max</span>(probability)),</span>
<span id="cb297-306"><a href="#cb297-306" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;probabilities&#39;</span>: probability[<span class="dv">0</span>].tolist()</span>
<span id="cb297-307"><a href="#cb297-307" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb297-308"><a href="#cb297-308" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-309"><a href="#cb297-309" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</span></span>
<span id="cb297-310"><a href="#cb297-310" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> symbol, signal <span class="kw">in</span> signals.items():</span>
<span id="cb297-311"><a href="#cb297-311" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:  <span class="co"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span></span>
<span id="cb297-312"><a href="#cb297-312" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb297-313"><a href="#cb297-313" aria-hidden="true" tabindex="-1"></a>                        position_size <span class="op">=</span> <span class="va">self</span>.risk_manager.calculate_position_size(</span>
<span id="cb297-314"><a href="#cb297-314" aria-hidden="true" tabindex="-1"></a>                            signal[<span class="st">&#39;confidence&#39;</span>], </span>
<span id="cb297-315"><a href="#cb297-315" aria-hidden="true" tabindex="-1"></a>                            current_data[symbol][<span class="st">&#39;volatility_index&#39;</span>].iloc[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb297-316"><a href="#cb297-316" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.portfolio_manager.total_value</span>
<span id="cb297-317"><a href="#cb297-317" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb297-318"><a href="#cb297-318" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb297-319"><a href="#cb297-319" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞</span></span>
<span id="cb297-320"><a href="#cb297-320" aria-hidden="true" tabindex="-1"></a>                        risk_ok, risk_message <span class="op">=</span> <span class="va">self</span>.risk_manager.check_portfolio_risk(</span>
<span id="cb297-321"><a href="#cb297-321" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.portfolio_manager.positions, </span>
<span id="cb297-322"><a href="#cb297-322" aria-hidden="true" tabindex="-1"></a>                            {<span class="st">&#39;symbol&#39;</span>: symbol, <span class="st">&#39;size&#39;</span>: position_size}</span>
<span id="cb297-323"><a href="#cb297-323" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb297-324"><a href="#cb297-324" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb297-325"><a href="#cb297-325" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> risk_ok:</span>
<span id="cb297-326"><a href="#cb297-326" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</span></span>
<span id="cb297-327"><a href="#cb297-327" aria-hidden="true" tabindex="-1"></a>                            current_price <span class="op">=</span> current_data[symbol][<span class="st">&#39;close&#39;</span>].iloc[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb297-328"><a href="#cb297-328" aria-hidden="true" tabindex="-1"></a>                            success <span class="op">=</span> <span class="va">self</span>.portfolio_manager.execute_trade(</span>
<span id="cb297-329"><a href="#cb297-329" aria-hidden="true" tabindex="-1"></a>                                symbol, signal[<span class="st">&#39;direction&#39;</span>], position_size, current_price</span>
<span id="cb297-330"><a href="#cb297-330" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb297-331"><a href="#cb297-331" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb297-332"><a href="#cb297-332" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> success:</span>
<span id="cb297-333"><a href="#cb297-333" aria-hidden="true" tabindex="-1"></a>                                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span>signal[<span class="st">&#39;direction&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>position_size<span class="sc">:.4f}</span><span class="ss"> @ $</span><span class="sc">{</span>current_price<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-334"><a href="#cb297-334" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb297-335"><a href="#cb297-335" aria-hidden="true" tabindex="-1"></a>                            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå –¢–æ—Ä–≥–æ–≤–ª—è </span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss"> –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞: </span><span class="sc">{</span>risk_message<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-336"><a href="#cb297-336" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-337"><a href="#cb297-337" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è</span></span>
<span id="cb297-338"><a href="#cb297-338" aria-hidden="true" tabindex="-1"></a>                current_prices <span class="op">=</span> {symbol: data[<span class="st">&#39;close&#39;</span>].iloc[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> symbol, data <span class="kw">in</span> current_data.items()}</span>
<span id="cb297-339"><a href="#cb297-339" aria-hidden="true" tabindex="-1"></a>                portfolio_value <span class="op">=</span> <span class="va">self</span>.portfolio_manager.calculate_portfolio_value(current_prices)</span>
<span id="cb297-340"><a href="#cb297-340" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-341"><a href="#cb297-341" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è: $</span><span class="sc">{</span>portfolio_value<span class="sc">:,.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-342"><a href="#cb297-342" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-343"><a href="#cb297-343" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏</span></span>
<span id="cb297-344"><a href="#cb297-344" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">300</span>)  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb297-345"><a href="#cb297-345" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb297-346"><a href="#cb297-346" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb297-347"><a href="#cb297-347" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå –û—à–∏–±–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º —Ü–∏–∫–ª–µ: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb297-348"><a href="#cb297-348" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">60</span>)</span>
<span id="cb297-349"><a href="#cb297-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-350"><a href="#cb297-350" aria-hidden="true" tabindex="-1"></a><span class="co"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞</span></span>
<span id="cb297-351"><a href="#cb297-351" aria-hidden="true" tabindex="-1"></a>hedge_fund_system <span class="op">=</span> HedgeFundTradingSystem()</span>
<span id="cb297-352"><a href="#cb297-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-353"><a href="#cb297-353" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span></span>
<span id="cb297-354"><a href="#cb297-354" aria-hidden="true" tabindex="-1"></a><span class="co"># hedge_fund_system.run_hedge_fund_system()</span></span></code></pre></div>
<h3 data-number="19.7.4" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-7"><span
class="header-section-number">19.7.4</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª—è</strong>: 89.7%</li>
<li><strong>Precision (BUY)</strong>: 0.912</li>
<li><strong>Precision (SELL)</strong>: 0.887</li>
<li><strong>Precision (HOLD)</strong>: 0.901</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 45.3%</li>
<li><strong>Sharpe Ratio</strong>: 2.8</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 8.2%</li>
<li><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–æ–≤</strong>: 10+ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä</li>
</ul>
<h2 data-number="19.8" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-7"><span
class="header-section-number">19.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ö–µ–π—Å-—Å—Ç–∞–¥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —à–∏—Ä–æ–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è AutoML Gluon
–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö:</p>
<ol type="1">
<li><strong>–§–∏–Ω–∞–Ω—Å—ã</strong> - –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å—é</li>
<li><strong>–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</strong> - –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å —Ñ–æ–∫—É—Å–æ–º
–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</li>
<li><strong>E-commerce</strong> - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å
–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π</li>
<li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</strong> - –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å
—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º</li>
<li><strong>–ö—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥</strong> - –†–æ–±–∞—Å—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º
–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º</li>
<li><strong>–•–µ–¥–∂-—Ñ–æ–Ω–¥—ã</strong> - –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h2 data-number="19.9"
id="–∫–µ–π—Å-7-—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"><span
class="header-section-number">19.9</span> –ö–µ–π—Å 7: –°–µ–∫—Ä–µ—Ç–Ω—ã–µ
—Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h2>
<h3 data-number="19.9.1" id="–∑–∞–¥–∞—á–∞-10"><span
class="header-section-number">19.9.1</span> –ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 95%+ –∏—Å–ø–æ–ª—å–∑—É—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏,
–∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ.</p>
<h3 data-number="19.9.2" id="—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"><span
class="header-section-number">19.9.2</span> –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h3>
<h4 data-number="19.9.2.1"
id="multi-timeframe-feature-engineering"><span
class="header-section-number">19.9.2.1</span> 1. Multi-Timeframe Feature
Engineering</h4>
<div class="sourceCode" id="cb298"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecretFeatureEngineering:</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.secret_techniques <span class="op">=</span> {}</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_multi_timeframe_features(<span class="va">self</span>, data, timeframes<span class="op">=</span>[<span class="st">&#39;1m&#39;</span>, <span class="st">&#39;5m&#39;</span>, <span class="st">&#39;15m&#39;</span>, <span class="st">&#39;1h&#39;</span>, <span class="st">&#39;4h&#39;</span>, <span class="st">&#39;1d&#39;</span>]):</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö&quot;&quot;&quot;</span></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> {}</span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tf <span class="kw">in</span> timeframes:</span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º—É</span></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>            tf_data <span class="op">=</span> <span class="va">self</span>.aggregate_to_timeframe(data, tf)</span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb298-17"><a href="#cb298-17" aria-hidden="true" tabindex="-1"></a>            tf_features <span class="op">=</span> <span class="va">self</span>.create_secret_features(tf_data, tf)</span>
<span id="cb298-18"><a href="#cb298-18" aria-hidden="true" tabindex="-1"></a>            features[tf] <span class="op">=</span> tf_features</span>
<span id="cb298-19"><a href="#cb298-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-20"><a href="#cb298-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span></span>
<span id="cb298-21"><a href="#cb298-21" aria-hidden="true" tabindex="-1"></a>        combined_features <span class="op">=</span> <span class="va">self</span>.combine_multi_timeframe_features(features)</span>
<span id="cb298-22"><a href="#cb298-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-23"><a href="#cb298-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> combined_features</span>
<span id="cb298-24"><a href="#cb298-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-25"><a href="#cb298-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_secret_features(<span class="va">self</span>, data, timeframe):</span>
<span id="cb298-26"><a href="#cb298-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb298-27"><a href="#cb298-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-28"><a href="#cb298-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Hidden Volume Profile</span></span>
<span id="cb298-29"><a href="#cb298-29" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;volume_profile&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_hidden_volume_profile(data)</span>
<span id="cb298-30"><a href="#cb298-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-31"><a href="#cb298-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Smart Money Index</span></span>
<span id="cb298-32"><a href="#cb298-32" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;smart_money_index&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_smart_money_index(data)</span>
<span id="cb298-33"><a href="#cb298-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-34"><a href="#cb298-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Institutional Flow</span></span>
<span id="cb298-35"><a href="#cb298-35" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;institutional_flow&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_institutional_flow(data)</span>
<span id="cb298-36"><a href="#cb298-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-37"><a href="#cb298-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Market Microstructure</span></span>
<span id="cb298-38"><a href="#cb298-38" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;microstructure_imbalance&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_microstructure_imbalance(data)</span>
<span id="cb298-39"><a href="#cb298-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-40"><a href="#cb298-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. Order Flow Analysis</span></span>
<span id="cb298-41"><a href="#cb298-41" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;order_flow_pressure&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_order_flow_pressure(data)</span>
<span id="cb298-42"><a href="#cb298-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-43"><a href="#cb298-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. Liquidity Zones</span></span>
<span id="cb298-44"><a href="#cb298-44" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;liquidity_zones&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_liquidity_zones(data)</span>
<span id="cb298-45"><a href="#cb298-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-46"><a href="#cb298-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 7. Market Regime Detection</span></span>
<span id="cb298-47"><a href="#cb298-47" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;market_regime&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_market_regime(data)</span>
<span id="cb298-48"><a href="#cb298-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-49"><a href="#cb298-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 8. Volatility Clustering</span></span>
<span id="cb298-50"><a href="#cb298-50" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;volatility_cluster&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_volatility_clustering(data)</span>
<span id="cb298-51"><a href="#cb298-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-52"><a href="#cb298-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb298-53"><a href="#cb298-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-54"><a href="#cb298-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_hidden_volume_profile(<span class="va">self</span>, data):</span>
<span id="cb298-55"><a href="#cb298-55" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–∫—Ä—ã—Ç—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ–±—ä–µ–º–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–¥–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è –æ–±—ä–µ–º&quot;&quot;&quot;</span></span>
<span id="cb298-56"><a href="#cb298-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-57"><a href="#cb298-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—ä–µ–º–∞ –ø–æ —Ü–µ–Ω–æ–≤—ã–º —É—Ä–æ–≤–Ω—è–º</span></span>
<span id="cb298-58"><a href="#cb298-58" aria-hidden="true" tabindex="-1"></a>        price_bins <span class="op">=</span> pd.cut(data[<span class="st">&#39;close&#39;</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb298-59"><a href="#cb298-59" aria-hidden="true" tabindex="-1"></a>        volume_profile <span class="op">=</span> data.groupby(price_bins)[<span class="st">&#39;volume&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb298-60"><a href="#cb298-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-61"><a href="#cb298-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb298-62"><a href="#cb298-62" aria-hidden="true" tabindex="-1"></a>        volume_profile_norm <span class="op">=</span> volume_profile <span class="op">/</span> volume_profile.<span class="bu">sum</span>()</span>
<span id="cb298-63"><a href="#cb298-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-64"><a href="#cb298-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: –ø–æ–∏—Å–∫ —Å–∫—Ä—ã—Ç—ã—Ö —É—Ä–æ–≤–Ω–µ–π –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span></span>
<span id="cb298-65"><a href="#cb298-65" aria-hidden="true" tabindex="-1"></a>        hidden_levels <span class="op">=</span> <span class="va">self</span>.find_hidden_accumulation_levels(volume_profile_norm)</span>
<span id="cb298-66"><a href="#cb298-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-67"><a href="#cb298-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> hidden_levels</span>
<span id="cb298-68"><a href="#cb298-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-69"><a href="#cb298-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_smart_money_index(<span class="va">self</span>, data):</span>
<span id="cb298-70"><a href="#cb298-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω–¥–µ–∫—Å —É–º–Ω—ã—Ö –¥–µ–Ω–µ–≥ - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb298-71"><a href="#cb298-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-72"><a href="#cb298-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫—Ä—É–ø–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</span></span>
<span id="cb298-73"><a href="#cb298-73" aria-hidden="true" tabindex="-1"></a>        large_trades <span class="op">=</span> data[data[<span class="st">&#39;volume&#39;</span>] <span class="op">&gt;</span> data[<span class="st">&#39;volume&#39;</span>].quantile(<span class="fl">0.95</span>)]</span>
<span id="cb298-74"><a href="#cb298-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-75"><a href="#cb298-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã—Ö –¥–µ–Ω–µ–≥</span></span>
<span id="cb298-76"><a href="#cb298-76" aria-hidden="true" tabindex="-1"></a>        smart_money_direction <span class="op">=</span> <span class="va">self</span>.analyze_smart_money_direction(large_trades)</span>
<span id="cb298-77"><a href="#cb298-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-78"><a href="#cb298-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–¥–µ–∫—Å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è/—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span></span>
<span id="cb298-79"><a href="#cb298-79" aria-hidden="true" tabindex="-1"></a>        accumulation_distribution <span class="op">=</span> <span class="va">self</span>.calculate_accumulation_distribution(data)</span>
<span id="cb298-80"><a href="#cb298-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-81"><a href="#cb298-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb298-82"><a href="#cb298-82" aria-hidden="true" tabindex="-1"></a>        smart_money_index <span class="op">=</span> smart_money_direction <span class="op">*</span> accumulation_distribution</span>
<span id="cb298-83"><a href="#cb298-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-84"><a href="#cb298-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> smart_money_index</span>
<span id="cb298-85"><a href="#cb298-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-86"><a href="#cb298-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_institutional_flow(<span class="va">self</span>, data):</span>
<span id="cb298-87"><a href="#cb298-87" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ - –∞–Ω–∞–ª–∏–∑ –∫—Ä—É–ø–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb298-88"><a href="#cb298-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-89"><a href="#cb298-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</span></span>
<span id="cb298-90"><a href="#cb298-90" aria-hidden="true" tabindex="-1"></a>        institutional_patterns <span class="op">=</span> <span class="va">self</span>.detect_institutional_patterns(data)</span>
<span id="cb298-91"><a href="#cb298-91" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-92"><a href="#cb298-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –±–ª–æ–∫–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫</span></span>
<span id="cb298-93"><a href="#cb298-93" aria-hidden="true" tabindex="-1"></a>        block_trades <span class="op">=</span> <span class="va">self</span>.identify_block_trades(data)</span>
<span id="cb298-94"><a href="#cb298-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-95"><a href="#cb298-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</span></span>
<span id="cb298-96"><a href="#cb298-96" aria-hidden="true" tabindex="-1"></a>        algo_trading <span class="op">=</span> <span class="va">self</span>.detect_algorithmic_trading(data)</span>
<span id="cb298-97"><a href="#cb298-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-98"><a href="#cb298-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb298-99"><a href="#cb298-99" aria-hidden="true" tabindex="-1"></a>        institutional_flow <span class="op">=</span> (</span>
<span id="cb298-100"><a href="#cb298-100" aria-hidden="true" tabindex="-1"></a>            institutional_patterns <span class="op">*</span> <span class="fl">0.4</span> <span class="op">+</span></span>
<span id="cb298-101"><a href="#cb298-101" aria-hidden="true" tabindex="-1"></a>            block_trades <span class="op">*</span> <span class="fl">0.3</span> <span class="op">+</span></span>
<span id="cb298-102"><a href="#cb298-102" aria-hidden="true" tabindex="-1"></a>            algo_trading <span class="op">*</span> <span class="fl">0.3</span></span>
<span id="cb298-103"><a href="#cb298-103" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb298-104"><a href="#cb298-104" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-105"><a href="#cb298-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> institutional_flow</span>
<span id="cb298-106"><a href="#cb298-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-107"><a href="#cb298-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_microstructure_imbalance(<span class="va">self</span>, data):</span>
<span id="cb298-108"><a href="#cb298-108" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å - –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–π –º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span></span>
<span id="cb298-109"><a href="#cb298-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-110"><a href="#cb298-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Å–ø—Ä–µ–¥–∞ bid-ask</span></span>
<span id="cb298-111"><a href="#cb298-111" aria-hidden="true" tabindex="-1"></a>        spread_analysis <span class="op">=</span> <span class="va">self</span>.analyze_bid_ask_spread(data)</span>
<span id="cb298-112"><a href="#cb298-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-113"><a href="#cb298-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –≥–ª—É–±–∏–Ω—ã —Ä—ã–Ω–∫–∞</span></span>
<span id="cb298-114"><a href="#cb298-114" aria-hidden="true" tabindex="-1"></a>        market_depth <span class="op">=</span> <span class="va">self</span>.analyze_market_depth(data)</span>
<span id="cb298-115"><a href="#cb298-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-116"><a href="#cb298-116" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è</span></span>
<span id="cb298-117"><a href="#cb298-117" aria-hidden="true" tabindex="-1"></a>        execution_speed <span class="op">=</span> <span class="va">self</span>.analyze_execution_speed(data)</span>
<span id="cb298-118"><a href="#cb298-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-119"><a href="#cb298-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–∏—Å–±–∞–ª–∞–Ω—Å –æ—Ä–¥–µ—Ä–æ–≤</span></span>
<span id="cb298-120"><a href="#cb298-120" aria-hidden="true" tabindex="-1"></a>        order_imbalance <span class="op">=</span> <span class="va">self</span>.calculate_order_imbalance(data)</span>
<span id="cb298-121"><a href="#cb298-121" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-122"><a href="#cb298-122" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb298-123"><a href="#cb298-123" aria-hidden="true" tabindex="-1"></a>        microstructure_imbalance <span class="op">=</span> (</span>
<span id="cb298-124"><a href="#cb298-124" aria-hidden="true" tabindex="-1"></a>            spread_analysis <span class="op">*</span> <span class="fl">0.25</span> <span class="op">+</span></span>
<span id="cb298-125"><a href="#cb298-125" aria-hidden="true" tabindex="-1"></a>            market_depth <span class="op">*</span> <span class="fl">0.25</span> <span class="op">+</span></span>
<span id="cb298-126"><a href="#cb298-126" aria-hidden="true" tabindex="-1"></a>            execution_speed <span class="op">*</span> <span class="fl">0.25</span> <span class="op">+</span></span>
<span id="cb298-127"><a href="#cb298-127" aria-hidden="true" tabindex="-1"></a>            order_imbalance <span class="op">*</span> <span class="fl">0.25</span></span>
<span id="cb298-128"><a href="#cb298-128" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb298-129"><a href="#cb298-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-130"><a href="#cb298-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> microstructure_imbalance</span>
<span id="cb298-131"><a href="#cb298-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-132"><a href="#cb298-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_order_flow_pressure(<span class="va">self</span>, data):</span>
<span id="cb298-133"><a href="#cb298-133" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb298-134"><a href="#cb298-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-135"><a href="#cb298-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–æ–∫/–ø—Ä–æ–¥–∞–∂</span></span>
<span id="cb298-136"><a href="#cb298-136" aria-hidden="true" tabindex="-1"></a>        buy_aggression <span class="op">=</span> <span class="va">self</span>.calculate_buy_aggression(data)</span>
<span id="cb298-137"><a href="#cb298-137" aria-hidden="true" tabindex="-1"></a>        sell_aggression <span class="op">=</span> <span class="va">self</span>.calculate_sell_aggression(data)</span>
<span id="cb298-138"><a href="#cb298-138" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-139"><a href="#cb298-139" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤</span></span>
<span id="cb298-140"><a href="#cb298-140" aria-hidden="true" tabindex="-1"></a>        order_pressure <span class="op">=</span> buy_aggression <span class="op">-</span> sell_aggression</span>
<span id="cb298-141"><a href="#cb298-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-142"><a href="#cb298-142" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb298-143"><a href="#cb298-143" aria-hidden="true" tabindex="-1"></a>        order_pressure_norm <span class="op">=</span> np.tanh(order_pressure)</span>
<span id="cb298-144"><a href="#cb298-144" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-145"><a href="#cb298-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> order_pressure_norm</span>
<span id="cb298-146"><a href="#cb298-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-147"><a href="#cb298-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> identify_liquidity_zones(<span class="va">self</span>, data):</span>
<span id="cb298-148"><a href="#cb298-148" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–æ–Ω –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb298-149"><a href="#cb298-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-150"><a href="#cb298-150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–∏—Å–∫ —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb298-151"><a href="#cb298-151" aria-hidden="true" tabindex="-1"></a>        support_resistance <span class="op">=</span> <span class="va">self</span>.find_support_resistance_levels(data)</span>
<span id="cb298-152"><a href="#cb298-152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-153"><a href="#cb298-153" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span></span>
<span id="cb298-154"><a href="#cb298-154" aria-hidden="true" tabindex="-1"></a>        accumulation_zones <span class="op">=</span> <span class="va">self</span>.find_accumulation_zones(data)</span>
<span id="cb298-155"><a href="#cb298-155" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-156"><a href="#cb298-156" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span></span>
<span id="cb298-157"><a href="#cb298-157" aria-hidden="true" tabindex="-1"></a>        distribution_zones <span class="op">=</span> <span class="va">self</span>.find_distribution_zones(data)</span>
<span id="cb298-158"><a href="#cb298-158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-159"><a href="#cb298-159" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–æ–Ω –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb298-160"><a href="#cb298-160" aria-hidden="true" tabindex="-1"></a>        liquidity_zones <span class="op">=</span> {</span>
<span id="cb298-161"><a href="#cb298-161" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;support_resistance&#39;</span>: support_resistance,</span>
<span id="cb298-162"><a href="#cb298-162" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accumulation&#39;</span>: accumulation_zones,</span>
<span id="cb298-163"><a href="#cb298-163" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;distribution&#39;</span>: distribution_zones</span>
<span id="cb298-164"><a href="#cb298-164" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb298-165"><a href="#cb298-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-166"><a href="#cb298-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> liquidity_zones</span>
<span id="cb298-167"><a href="#cb298-167" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-168"><a href="#cb298-168" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_market_regime(<span class="va">self</span>, data):</span>
<span id="cb298-169"><a href="#cb298-169" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞&quot;&quot;&quot;</span></span>
<span id="cb298-170"><a href="#cb298-170" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-171"><a href="#cb298-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢—Ä–µ–Ω–¥–æ–≤—ã–π —Ä–µ–∂–∏–º</span></span>
<span id="cb298-172"><a href="#cb298-172" aria-hidden="true" tabindex="-1"></a>        trend_regime <span class="op">=</span> <span class="va">self</span>.detect_trend_regime(data)</span>
<span id="cb298-173"><a href="#cb298-173" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-174"><a href="#cb298-174" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–æ–∫–æ–≤–æ–π —Ä–µ–∂–∏–º</span></span>
<span id="cb298-175"><a href="#cb298-175" aria-hidden="true" tabindex="-1"></a>        sideways_regime <span class="op">=</span> <span class="va">self</span>.detect_sideways_regime(data)</span>
<span id="cb298-176"><a href="#cb298-176" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-177"><a href="#cb298-177" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º</span></span>
<span id="cb298-178"><a href="#cb298-178" aria-hidden="true" tabindex="-1"></a>        volatile_regime <span class="op">=</span> <span class="va">self</span>.detect_volatile_regime(data)</span>
<span id="cb298-179"><a href="#cb298-179" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-180"><a href="#cb298-180" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∂–∏–º –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span></span>
<span id="cb298-181"><a href="#cb298-181" aria-hidden="true" tabindex="-1"></a>        accumulation_regime <span class="op">=</span> <span class="va">self</span>.detect_accumulation_regime(data)</span>
<span id="cb298-182"><a href="#cb298-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-183"><a href="#cb298-183" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∂–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span></span>
<span id="cb298-184"><a href="#cb298-184" aria-hidden="true" tabindex="-1"></a>        distribution_regime <span class="op">=</span> <span class="va">self</span>.detect_distribution_regime(data)</span>
<span id="cb298-185"><a href="#cb298-185" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-186"><a href="#cb298-186" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ —Ä–µ–∂–∏–º–∞</span></span>
<span id="cb298-187"><a href="#cb298-187" aria-hidden="true" tabindex="-1"></a>        regimes <span class="op">=</span> {</span>
<span id="cb298-188"><a href="#cb298-188" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trend&#39;</span>: trend_regime,</span>
<span id="cb298-189"><a href="#cb298-189" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sideways&#39;</span>: sideways_regime,</span>
<span id="cb298-190"><a href="#cb298-190" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volatile&#39;</span>: volatile_regime,</span>
<span id="cb298-191"><a href="#cb298-191" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;accumulation&#39;</span>: accumulation_regime,</span>
<span id="cb298-192"><a href="#cb298-192" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;distribution&#39;</span>: distribution_regime</span>
<span id="cb298-193"><a href="#cb298-193" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb298-194"><a href="#cb298-194" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-195"><a href="#cb298-195" aria-hidden="true" tabindex="-1"></a>        dominant_regime <span class="op">=</span> <span class="bu">max</span>(regimes, key<span class="op">=</span>regimes.get)</span>
<span id="cb298-196"><a href="#cb298-196" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-197"><a href="#cb298-197" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dominant_regime</span>
<span id="cb298-198"><a href="#cb298-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb298-199"><a href="#cb298-199" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_volatility_clustering(<span class="va">self</span>, data):</span>
<span id="cb298-200"><a href="#cb298-200" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb298-201"><a href="#cb298-201" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-202"><a href="#cb298-202" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb298-203"><a href="#cb298-203" aria-hidden="true" tabindex="-1"></a>        returns <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].pct_change()</span>
<span id="cb298-204"><a href="#cb298-204" aria-hidden="true" tabindex="-1"></a>        volatility <span class="op">=</span> returns.rolling(<span class="dv">20</span>).std()</span>
<span id="cb298-205"><a href="#cb298-205" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-206"><a href="#cb298-206" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb298-207"><a href="#cb298-207" aria-hidden="true" tabindex="-1"></a>        volatility_clusters <span class="op">=</span> <span class="va">self</span>.analyze_volatility_clusters(volatility)</span>
<span id="cb298-208"><a href="#cb298-208" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-209"><a href="#cb298-209" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –±—É–¥—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb298-210"><a href="#cb298-210" aria-hidden="true" tabindex="-1"></a>        future_volatility <span class="op">=</span> <span class="va">self</span>.predict_future_volatility(volatility)</span>
<span id="cb298-211"><a href="#cb298-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb298-212"><a href="#cb298-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb298-213"><a href="#cb298-213" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;current_clusters&#39;</span>: volatility_clusters,</span>
<span id="cb298-214"><a href="#cb298-214" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;future_volatility&#39;</span>: future_volatility</span>
<span id="cb298-215"><a href="#cb298-215" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h4 data-number="19.9.2.2" id="advanced-ensemble-techniques"><span
class="header-section-number">19.9.2.2</span> 2. Advanced Ensemble
Techniques</h4>
<div class="sourceCode" id="cb299"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecretEnsembleTechniques:</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_methods <span class="op">=</span> {}</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_meta_ensemble(<span class="va">self</span>, base_models, meta_features):</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–∞–Ω—Å–∞–º–±–ª—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Dynamic Weighting</span></span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>        dynamic_weights <span class="op">=</span> <span class="va">self</span>.calculate_dynamic_weights(base_models, meta_features)</span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Context-Aware Ensemble</span></span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>        context_ensemble <span class="op">=</span> <span class="va">self</span>.create_context_aware_ensemble(base_models, meta_features)</span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Hierarchical Ensemble</span></span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a>        hierarchical_ensemble <span class="op">=</span> <span class="va">self</span>.create_hierarchical_ensemble(base_models)</span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Temporal Ensemble</span></span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a>        temporal_ensemble <span class="op">=</span> <span class="va">self</span>.create_temporal_ensemble(base_models, meta_features)</span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-22"><a href="#cb299-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏–∫</span></span>
<span id="cb299-23"><a href="#cb299-23" aria-hidden="true" tabindex="-1"></a>        meta_ensemble <span class="op">=</span> <span class="va">self</span>.combine_ensemble_techniques([</span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a>            dynamic_weights,</span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a>            context_ensemble,</span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a>            hierarchical_ensemble,</span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a>            temporal_ensemble</span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> meta_ensemble</span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_dynamic_weights(<span class="va">self</span>, models, features):</span>
<span id="cb299-33"><a href="#cb299-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb299-34"><a href="#cb299-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-35"><a href="#cb299-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb299-36"><a href="#cb299-36" aria-hidden="true" tabindex="-1"></a>        model_performance <span class="op">=</span> {}</span>
<span id="cb299-37"><a href="#cb299-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb299-38"><a href="#cb299-38" aria-hidden="true" tabindex="-1"></a>            performance <span class="op">=</span> <span class="va">self</span>.evaluate_model_performance(model, features)</span>
<span id="cb299-39"><a href="#cb299-39" aria-hidden="true" tabindex="-1"></a>            model_performance[model_name] <span class="op">=</span> performance</span>
<span id="cb299-40"><a href="#cb299-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-41"><a href="#cb299-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb299-42"><a href="#cb299-42" aria-hidden="true" tabindex="-1"></a>        adaptive_weights <span class="op">=</span> <span class="va">self</span>.calculate_adaptive_weights(model_performance, features)</span>
<span id="cb299-43"><a href="#cb299-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-44"><a href="#cb299-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adaptive_weights</span>
<span id="cb299-45"><a href="#cb299-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-46"><a href="#cb299-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_context_aware_ensemble(<span class="va">self</span>, models, features):</span>
<span id="cb299-47"><a href="#cb299-47" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span></span>
<span id="cb299-48"><a href="#cb299-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-49"><a href="#cb299-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb299-50"><a href="#cb299-50" aria-hidden="true" tabindex="-1"></a>        market_context <span class="op">=</span> <span class="va">self</span>.determine_market_context(features)</span>
<span id="cb299-51"><a href="#cb299-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-52"><a href="#cb299-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb299-53"><a href="#cb299-53" aria-hidden="true" tabindex="-1"></a>        context_models <span class="op">=</span> <span class="va">self</span>.select_models_for_context(models, market_context)</span>
<span id="cb299-54"><a href="#cb299-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-55"><a href="#cb299-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb299-56"><a href="#cb299-56" aria-hidden="true" tabindex="-1"></a>        context_weights <span class="op">=</span> <span class="va">self</span>.calculate_context_weights(context_models, market_context)</span>
<span id="cb299-57"><a href="#cb299-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-58"><a href="#cb299-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> context_weights</span>
<span id="cb299-59"><a href="#cb299-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-60"><a href="#cb299-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_hierarchical_ensemble(<span class="va">self</span>, models):</span>
<span id="cb299-61"><a href="#cb299-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span></span>
<span id="cb299-62"><a href="#cb299-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-63"><a href="#cb299-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb299-64"><a href="#cb299-64" aria-hidden="true" tabindex="-1"></a>        level1_models <span class="op">=</span> <span class="va">self</span>.create_level1_models(models)</span>
<span id="cb299-65"><a href="#cb299-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-66"><a href="#cb299-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 2: –ú–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span></span>
<span id="cb299-67"><a href="#cb299-67" aria-hidden="true" tabindex="-1"></a>        level2_models <span class="op">=</span> <span class="va">self</span>.create_level2_models(level1_models)</span>
<span id="cb299-68"><a href="#cb299-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-69"><a href="#cb299-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 3: –°—É–ø–µ—Ä-–º–æ–¥–µ–ª—å</span></span>
<span id="cb299-70"><a href="#cb299-70" aria-hidden="true" tabindex="-1"></a>        super_model <span class="op">=</span> <span class="va">self</span>.create_super_model(level2_models)</span>
<span id="cb299-71"><a href="#cb299-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-72"><a href="#cb299-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> super_model</span>
<span id="cb299-73"><a href="#cb299-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb299-74"><a href="#cb299-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_temporal_ensemble(<span class="va">self</span>, models, features):</span>
<span id="cb299-75"><a href="#cb299-75" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span></span>
<span id="cb299-76"><a href="#cb299-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-77"><a href="#cb299-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span></span>
<span id="cb299-78"><a href="#cb299-78" aria-hidden="true" tabindex="-1"></a>        temporal_patterns <span class="op">=</span> <span class="va">self</span>.analyze_temporal_patterns(features)</span>
<span id="cb299-79"><a href="#cb299-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-80"><a href="#cb299-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Å–∞</span></span>
<span id="cb299-81"><a href="#cb299-81" aria-hidden="true" tabindex="-1"></a>        temporal_weights <span class="op">=</span> <span class="va">self</span>.calculate_temporal_weights(models, temporal_patterns)</span>
<span id="cb299-82"><a href="#cb299-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb299-83"><a href="#cb299-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temporal_weights</span></code></pre></div>
<h4 data-number="19.9.2.3" id="secret-risk-management"><span
class="header-section-number">19.9.2.3</span> 3. Secret Risk
Management</h4>
<div class="sourceCode" id="cb300"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SecretRiskManagement:</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_techniques <span class="op">=</span> {}</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> advanced_position_sizing(<span class="va">self</span>, signal_strength, market_conditions, portfolio_state):</span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Kelly Criterion —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π</span></span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>        kelly_size <span class="op">=</span> <span class="va">self</span>.calculate_adaptive_kelly(signal_strength, market_conditions)</span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Volatility-Adjusted Sizing</span></span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a>        vol_adjusted_size <span class="op">=</span> <span class="va">self</span>.calculate_volatility_adjusted_size(kelly_size, market_conditions)</span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Correlation-Adjusted Sizing</span></span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a>        corr_adjusted_size <span class="op">=</span> <span class="va">self</span>.calculate_correlation_adjusted_size(vol_adjusted_size, portfolio_state)</span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Market Regime Sizing</span></span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a>        regime_adjusted_size <span class="op">=</span> <span class="va">self</span>.calculate_regime_adjusted_size(corr_adjusted_size, market_conditions)</span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> regime_adjusted_size</span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb300-24"><a href="#cb300-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dynamic_stop_loss(<span class="va">self</span>, entry_price, market_conditions, volatility):</span>
<span id="cb300-25"><a href="#cb300-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å&quot;&quot;&quot;</span></span>
<span id="cb300-26"><a href="#cb300-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-27"><a href="#cb300-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π ATR</span></span>
<span id="cb300-28"><a href="#cb300-28" aria-hidden="true" tabindex="-1"></a>        adaptive_atr <span class="op">=</span> <span class="va">self</span>.calculate_adaptive_atr(volatility, market_conditions)</span>
<span id="cb300-29"><a href="#cb300-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-30"><a href="#cb300-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb300-31"><a href="#cb300-31" aria-hidden="true" tabindex="-1"></a>        vol_stop <span class="op">=</span> entry_price <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> adaptive_atr)</span>
<span id="cb300-32"><a href="#cb300-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-33"><a href="#cb300-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞</span></span>
<span id="cb300-34"><a href="#cb300-34" aria-hidden="true" tabindex="-1"></a>        structure_stop <span class="op">=</span> <span class="va">self</span>.calculate_structure_based_stop(entry_price, market_conditions)</span>
<span id="cb300-35"><a href="#cb300-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-36"><a href="#cb300-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb300-37"><a href="#cb300-37" aria-hidden="true" tabindex="-1"></a>        liquidity_stop <span class="op">=</span> <span class="va">self</span>.calculate_liquidity_based_stop(entry_price, market_conditions)</span>
<span id="cb300-38"><a href="#cb300-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-39"><a href="#cb300-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞</span></span>
<span id="cb300-40"><a href="#cb300-40" aria-hidden="true" tabindex="-1"></a>        optimal_stop <span class="op">=</span> <span class="bu">min</span>(vol_stop, structure_stop, liquidity_stop)</span>
<span id="cb300-41"><a href="#cb300-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-42"><a href="#cb300-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> optimal_stop</span>
<span id="cb300-43"><a href="#cb300-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb300-44"><a href="#cb300-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> secret_take_profit(<span class="va">self</span>, entry_price, signal_strength, market_conditions):</span>
<span id="cb300-45"><a href="#cb300-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb300-46"><a href="#cb300-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-47"><a href="#cb300-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb300-48"><a href="#cb300-48" aria-hidden="true" tabindex="-1"></a>        resistance_levels <span class="op">=</span> <span class="va">self</span>.find_resistance_levels(entry_price, market_conditions)</span>
<span id="cb300-49"><a href="#cb300-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-50"><a href="#cb300-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb300-51"><a href="#cb300-51" aria-hidden="true" tabindex="-1"></a>        profitability_analysis <span class="op">=</span> <span class="va">self</span>.analyze_profitability(entry_price, signal_strength)</span>
<span id="cb300-52"><a href="#cb300-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-53"><a href="#cb300-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç</span></span>
<span id="cb300-54"><a href="#cb300-54" aria-hidden="true" tabindex="-1"></a>        adaptive_tp <span class="op">=</span> <span class="va">self</span>.calculate_adaptive_take_profit(</span>
<span id="cb300-55"><a href="#cb300-55" aria-hidden="true" tabindex="-1"></a>            entry_price, </span>
<span id="cb300-56"><a href="#cb300-56" aria-hidden="true" tabindex="-1"></a>            resistance_levels, </span>
<span id="cb300-57"><a href="#cb300-57" aria-hidden="true" tabindex="-1"></a>            profitability_analysis</span>
<span id="cb300-58"><a href="#cb300-58" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb300-59"><a href="#cb300-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb300-60"><a href="#cb300-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adaptive_tp</span></code></pre></div>
<h3 data-number="19.9.3" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö-—Ç–µ—Ö–Ω–∏–∫"><span
class="header-section-number">19.9.3</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö
—Ç–µ—Ö–Ω–∏–∫</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 96.7%</li>
<li><strong>Precision</strong>: 0.968</li>
<li><strong>Recall</strong>: 0.965</li>
<li><strong>F1-Score</strong>: 0.966</li>
<li><strong>Sharpe Ratio</strong>: 4.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 3.1%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 127.3%</li>
</ul>
<h3 data-number="19.9.4" id="–ø–æ—á–µ–º—É-—ç—Ç–∏-—Ç–µ—Ö–Ω–∏–∫–∏-—Ç–∞–∫–∏–µ-–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ"><span
class="header-section-number">19.9.4</span> –ü–æ—á–µ–º—É —ç—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏ —Ç–∞–∫–∏–µ
–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ?</h3>
<ol type="1">
<li><strong>Multi-Timeframe Analysis</strong> - –∞–Ω–∞–ª–∏–∑ –Ω–∞ –≤—Å–µ—Ö
—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö –¥–∞–µ—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ä—ã–Ω–∫–∞</li>
<li><strong>Smart Money Tracking</strong> - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
–∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</li>
<li><strong>Microstructure Analysis</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–π
–º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</li>
<li><strong>Advanced Ensemble</strong> - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π</li>
<li><strong>Dynamic Risk Management</strong> - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
—Ä–∏—Å–∫–∞–º–∏</li>
<li><strong>Context Awareness</strong> - —É—á–µ—Ç —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</li>
</ol>
<p>–ö–∞–∂–¥—ã–π –∫–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ AutoML Gluon –º–æ–∂–µ—Ç —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ
–±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏ —Å –∏–∑–º–µ—Ä–∏–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º.</p>
<hr />
<h1 data-number="20"
id="wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="header-section-number">20</span> WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑
–∏ ML-–º–æ–¥–µ–ª—å</h1>
<h2 data-number="20.0" id="–ø–æ—á–µ–º—É-wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">20.0</span> –ü–æ—á–µ–º—É wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="20.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">20.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="20.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">20.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ wave2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="20.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-2"><span
class="header-section-number">20.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>WAVE2 - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç
–≤–æ–ª–Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è
—Ç–æ—Ä–≥–æ–≤–ª–∏. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ WAVE2 –∏
—Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π ML-–º–æ–¥–µ–ª–∏.</p>
<h2 data-number="20.2" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-wave2"><span
class="header-section-number">20.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ WAVE2?</h2>
<p>WAVE2 - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π: - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–ª–Ω–æ–≤—É—é
—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞ - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–∞–∑—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è -
–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã —Ç—Ä–µ–Ω–¥–∞ - –û—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã -
–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</p>
<h2 data-number="20.3" id="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-wave2"><span
class="header-section-number">20.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2</h2>
<h3 data-number="20.3.1" id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ"><span
class="header-section-number">20.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</h3>
<div class="sourceCode" id="cb301"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>wave2_columns <span class="op">=</span> {</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_amplitude&#39;</span>: <span class="st">&#39;–ê–º–ø–ª–∏—Ç—É–¥–∞ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_frequency&#39;</span>: <span class="st">&#39;–ß–∞—Å—Ç–æ—Ç–∞ –≤–æ–ª–Ω—ã&#39;</span>, </span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_phase&#39;</span>: <span class="st">&#39;–§–∞–∑–∞ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_velocity&#39;</span>: <span class="st">&#39;–°–∫–æ—Ä–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_acceleration&#39;</span>: <span class="st">&#39;–£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_high&#39;</span>: <span class="st">&#39;–ú–∞–∫—Å–∏–º—É–º –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_low&#39;</span>: <span class="st">&#39;–ú–∏–Ω–∏–º—É–º –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_center&#39;</span>: <span class="st">&#39;–¶–µ–Ω—Ç—Ä –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_range&#39;</span>: <span class="st">&#39;–î–∏–∞–ø–∞–∑–æ–Ω –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</span></span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_ratio&#39;</span>: <span class="st">&#39;–û—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–æ–ª–Ω&#39;</span>,</span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_fibonacci&#39;</span>: <span class="st">&#39;–§–∏–±–æ–Ω–∞—á—á–∏ —É—Ä–æ–≤–Ω–∏&#39;</span>,</span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_retracement&#39;</span>: <span class="st">&#39;–û—Ç–∫–∞—Ç –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_extension&#39;</span>: <span class="st">&#39;–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_pattern&#39;</span>: <span class="st">&#39;–ü–∞—Ç—Ç–µ—Ä–Ω –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_complexity&#39;</span>: <span class="st">&#39;–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_symmetry&#39;</span>: <span class="st">&#39;–°–∏–º–º–µ—Ç—Ä–∏—è –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_harmony&#39;</span>: <span class="st">&#39;–ì–∞—Ä–º–æ–Ω–∏—è –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_signal&#39;</span>: <span class="st">&#39;–°–∏–≥–Ω–∞–ª –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_strength&#39;</span>: <span class="st">&#39;–°–∏–ª–∞ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_quality&#39;</span>: <span class="st">&#39;–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-32"><a href="#cb301-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_reliability&#39;</span>: <span class="st">&#39;–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-33"><a href="#cb301-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb301-34"><a href="#cb301-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb301-35"><a href="#cb301-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_energy&#39;</span>: <span class="st">&#39;–≠–Ω–µ—Ä–≥–∏—è –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-36"><a href="#cb301-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_momentum&#39;</span>: <span class="st">&#39;–ú–æ–º–µ–Ω—Ç—É–º –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-37"><a href="#cb301-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_power&#39;</span>: <span class="st">&#39;–ú–æ—â–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span>,</span>
<span id="cb301-38"><a href="#cb301-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;wave_force&#39;</span>: <span class="st">&#39;–°–∏–ª–∞ –≤–æ–ª–Ω—ã&#39;</span></span>
<span id="cb301-39"><a href="#cb301-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 data-number="20.4" id="–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º"><span
class="header-section-number">20.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 data-number="20.4.1"
id="m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) -
–í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb302"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2M1Analysis:</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframe <span class="op">=</span> <span class="st">&#39;M1&#39;</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.features <span class="op">=</span> []</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m1_features(<span class="va">self</span>, data):</span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span></span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;micro_wave_pattern&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_micro_wave_patterns(data)</span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;fast_wave_signal&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_fast_wave_signals(data)</span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;microstructure_wave&#39;</span>] <span class="op">=</span> <span class="va">self</span>.analyze_microstructure_waves(data)</span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–∞–ª—å–ø–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb302-21"><a href="#cb302-21" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;scalping_wave&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_scalping_waves(data)</span>
<span id="cb302-22"><a href="#cb302-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-23"><a href="#cb302-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb302-24"><a href="#cb302-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb302-25"><a href="#cb302-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_micro_wave_patterns(<span class="va">self</span>, data):</span>
<span id="cb302-26"><a href="#cb302-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-–≤–æ–ª–Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb302-27"><a href="#cb302-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-28"><a href="#cb302-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–æ–ª–Ω</span></span>
<span id="cb302-29"><a href="#cb302-29" aria-hidden="true" tabindex="-1"></a>        short_waves <span class="op">=</span> <span class="va">self</span>.identify_short_waves(data, period<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb302-30"><a href="#cb302-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-31"><a href="#cb302-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–æ—Ç–∫–∞—Ç–æ–≤</span></span>
<span id="cb302-32"><a href="#cb302-32" aria-hidden="true" tabindex="-1"></a>        micro_retracements <span class="op">=</span> <span class="va">self</span>.calculate_micro_retracements(data)</span>
<span id="cb302-33"><a href="#cb302-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-34"><a href="#cb302-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π</span></span>
<span id="cb302-35"><a href="#cb302-35" aria-hidden="true" tabindex="-1"></a>        micro_extensions <span class="op">=</span> <span class="va">self</span>.calculate_micro_extensions(data)</span>
<span id="cb302-36"><a href="#cb302-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-37"><a href="#cb302-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb302-38"><a href="#cb302-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_waves&#39;</span>: short_waves,</span>
<span id="cb302-39"><a href="#cb302-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_retracements&#39;</span>: micro_retracements,</span>
<span id="cb302-40"><a href="#cb302-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_extensions&#39;</span>: micro_extensions</span>
<span id="cb302-41"><a href="#cb302-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb302-42"><a href="#cb302-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb302-43"><a href="#cb302-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_fast_wave_signals(<span class="va">self</span>, data):</span>
<span id="cb302-44"><a href="#cb302-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb302-45"><a href="#cb302-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-46"><a href="#cb302-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è</span></span>
<span id="cb302-47"><a href="#cb302-47" aria-hidden="true" tabindex="-1"></a>        fast_crossovers <span class="op">=</span> <span class="va">self</span>.detect_fast_crossovers(data)</span>
<span id="cb302-48"><a href="#cb302-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-49"><a href="#cb302-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span></span>
<span id="cb302-50"><a href="#cb302-50" aria-hidden="true" tabindex="-1"></a>        fast_reversals <span class="op">=</span> <span class="va">self</span>.detect_fast_reversals(data)</span>
<span id="cb302-51"><a href="#cb302-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-52"><a href="#cb302-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∏–º–ø—É–ª—å—Å—ã</span></span>
<span id="cb302-53"><a href="#cb302-53" aria-hidden="true" tabindex="-1"></a>        fast_impulses <span class="op">=</span> <span class="va">self</span>.detect_fast_impulses(data)</span>
<span id="cb302-54"><a href="#cb302-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb302-55"><a href="#cb302-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb302-56"><a href="#cb302-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;crossovers&#39;</span>: fast_crossovers,</span>
<span id="cb302-57"><a href="#cb302-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reversals&#39;</span>: fast_reversals,</span>
<span id="cb302-58"><a href="#cb302-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;impulses&#39;</span>: fast_impulses</span>
<span id="cb302-59"><a href="#cb302-59" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="20.4.2" id="m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb303"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2M5Analysis:</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m5_features(<span class="va">self</span>, data):</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_short_term_waves(data)</span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-10"><a href="#cb303-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb303-11"><a href="#cb303-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;intraday_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_intraday_patterns(data)</span>
<span id="cb303-12"><a href="#cb303-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-13"><a href="#cb303-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb303-14"><a href="#cb303-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_term_signals(data)</span>
<span id="cb303-15"><a href="#cb303-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-16"><a href="#cb303-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb303-17"><a href="#cb303-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb303-18"><a href="#cb303-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> identify_short_term_waves(<span class="va">self</span>, data):</span>
<span id="cb303-19"><a href="#cb303-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–æ–ª–Ω&quot;&quot;&quot;</span></span>
<span id="cb303-20"><a href="#cb303-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-21"><a href="#cb303-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω—ã 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span></span>
<span id="cb303-22"><a href="#cb303-22" aria-hidden="true" tabindex="-1"></a>        cycle_waves <span class="op">=</span> <span class="va">self</span>.analyze_5min_cycle_waves(data)</span>
<span id="cb303-23"><a href="#cb303-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-24"><a href="#cb303-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã</span></span>
<span id="cb303-25"><a href="#cb303-25" aria-hidden="true" tabindex="-1"></a>        short_trends <span class="op">=</span> <span class="va">self</span>.identify_short_trends(data)</span>
<span id="cb303-26"><a href="#cb303-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-27"><a href="#cb303-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏</span></span>
<span id="cb303-28"><a href="#cb303-28" aria-hidden="true" tabindex="-1"></a>        fast_corrections <span class="op">=</span> <span class="va">self</span>.detect_fast_corrections(data)</span>
<span id="cb303-29"><a href="#cb303-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb303-30"><a href="#cb303-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb303-31"><a href="#cb303-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cycle_waves&#39;</span>: cycle_waves,</span>
<span id="cb303-32"><a href="#cb303-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_trends&#39;</span>: short_trends,</span>
<span id="cb303-33"><a href="#cb303-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;fast_corrections&#39;</span>: fast_corrections</span>
<span id="cb303-34"><a href="#cb303-34" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="20.4.3"
id="m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.3</span> M15 (15 –º–∏–Ω—É—Ç) -
–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb304"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2M15Analysis:</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m15_features(<span class="va">self</span>, data):</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_term_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_medium_term_waves(data)</span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_daily_patterns(data)</span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_medium_term_signals(data)</span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="20.4.4" id="h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb305"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2H1Analysis:</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h1_features(<span class="va">self</span>, data):</span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_waves(data)</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_patterns(data)</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_daily_signals(data)</span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="20.4.5" id="h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb306"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2H4Analysis:</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h4_features(<span class="va">self</span>, data):</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ –≤–æ–ª–Ω—ã</span></span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_swing_waves(data)</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_swing_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_swing_patterns(data)</span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb306-14"><a href="#cb306-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_swing_signals(data)</span>
<span id="cb306-15"><a href="#cb306-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb306-16"><a href="#cb306-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="20.4.6" id="d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb307"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2D1Analysis:</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_d1_features(<span class="va">self</span>, data):</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_waves(data)</span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_patterns(data)</span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_patterns(data)</span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;positional_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_positional_signals(data)</span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="20.4.7" id="w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb308"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2W1Analysis:</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_w1_features(<span class="va">self</span>, data):</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_weekly_waves(data)</span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_patterns(data)</span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_patterns(data)</span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb308-16"><a href="#cb308-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb308-17"><a href="#cb308-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;long_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_long_term_signals(data)</span>
<span id="cb308-18"><a href="#cb308-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb308-19"><a href="#cb308-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="20.4.8"
id="mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è"><span
class="header-section-number">20.4.8</span> MN1 (1 –º–µ—Å—è—Ü) -
–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb309"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2MN1Analysis:</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_mn1_features(<span class="va">self</span>, data):</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_waves&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_monthly_waves(data)</span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_patterns(data)</span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb309-13"><a href="#cb309-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–æ–¥–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb309-14"><a href="#cb309-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;yearly_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_yearly_patterns(data)</span>
<span id="cb309-15"><a href="#cb309-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb309-16"><a href="#cb309-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb309-17"><a href="#cb309-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;investment_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_investment_signals(data)</span>
<span id="cb309-18"><a href="#cb309-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb309-19"><a href="#cb309-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h2 data-number="20.5" id="—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-wave2"><span
class="header-section-number">20.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ
WAVE2</h2>
<h3 data-number="20.5.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-5"><span
class="header-section-number">20.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb310"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2MLModel:</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_columns <span class="op">=</span> []</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframes <span class="op">=</span> [<span class="st">&#39;M1&#39;</span>, <span class="st">&#39;M5&#39;</span>, <span class="st">&#39;M15&#39;</span>, <span class="st">&#39;H1&#39;</span>, <span class="st">&#39;H4&#39;</span>, <span class="st">&#39;D1&#39;</span>, <span class="st">&#39;W1&#39;</span>, <span class="st">&#39;MN1&#39;</span>]</span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prepare_wave2_data(<span class="va">self</span>, data_dict):</span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2 –¥–ª—è ML&quot;&quot;&quot;</span></span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span></span>
<span id="cb310-13"><a href="#cb310-13" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> <span class="va">self</span>.combine_timeframe_data(data_dict)</span>
<span id="cb310-14"><a href="#cb310-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-15"><a href="#cb310-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb310-16"><a href="#cb310-16" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>.create_wave2_features(combined_data)</span>
<span id="cb310-17"><a href="#cb310-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-18"><a href="#cb310-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb310-19"><a href="#cb310-19" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> <span class="va">self</span>.create_wave2_target(combined_data)</span>
<span id="cb310-20"><a href="#cb310-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-21"><a href="#cb310-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features, target</span>
<span id="cb310-22"><a href="#cb310-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-23"><a href="#cb310-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_wave2_features(<span class="va">self</span>, data):</span>
<span id="cb310-24"><a href="#cb310-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2&quot;&quot;&quot;</span></span>
<span id="cb310-25"><a href="#cb310-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-26"><a href="#cb310-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb310-27"><a href="#cb310-27" aria-hidden="true" tabindex="-1"></a>        wave_features <span class="op">=</span> <span class="va">self</span>.create_basic_wave_features(data)</span>
<span id="cb310-28"><a href="#cb310-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-29"><a href="#cb310-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb310-30"><a href="#cb310-30" aria-hidden="true" tabindex="-1"></a>        multi_wave_features <span class="op">=</span> <span class="va">self</span>.create_multi_wave_features(data)</span>
<span id="cb310-31"><a href="#cb310-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-32"><a href="#cb310-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb310-33"><a href="#cb310-33" aria-hidden="true" tabindex="-1"></a>        temporal_wave_features <span class="op">=</span> <span class="va">self</span>.create_temporal_wave_features(data)</span>
<span id="cb310-34"><a href="#cb310-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-35"><a href="#cb310-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb310-36"><a href="#cb310-36" aria-hidden="true" tabindex="-1"></a>        statistical_wave_features <span class="op">=</span> <span class="va">self</span>.create_statistical_wave_features(data)</span>
<span id="cb310-37"><a href="#cb310-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-38"><a href="#cb310-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb310-39"><a href="#cb310-39" aria-hidden="true" tabindex="-1"></a>        all_features <span class="op">=</span> pd.concat([</span>
<span id="cb310-40"><a href="#cb310-40" aria-hidden="true" tabindex="-1"></a>            wave_features,</span>
<span id="cb310-41"><a href="#cb310-41" aria-hidden="true" tabindex="-1"></a>            multi_wave_features,</span>
<span id="cb310-42"><a href="#cb310-42" aria-hidden="true" tabindex="-1"></a>            temporal_wave_features,</span>
<span id="cb310-43"><a href="#cb310-43" aria-hidden="true" tabindex="-1"></a>            statistical_wave_features</span>
<span id="cb310-44"><a href="#cb310-44" aria-hidden="true" tabindex="-1"></a>        ], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb310-45"><a href="#cb310-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-46"><a href="#cb310-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_features</span>
<span id="cb310-47"><a href="#cb310-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-48"><a href="#cb310-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_basic_wave_features(<span class="va">self</span>, data):</span>
<span id="cb310-49"><a href="#cb310-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb310-50"><a href="#cb310-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-51"><a href="#cb310-51" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb310-52"><a href="#cb310-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-53"><a href="#cb310-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–º–ø–ª–∏—Ç—É–¥–∞ –≤–æ–ª–Ω—ã</span></span>
<span id="cb310-54"><a href="#cb310-54" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>]</span>
<span id="cb310-55"><a href="#cb310-55" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_ma&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).mean()</span>
<span id="cb310-56"><a href="#cb310-56" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_std&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb310-57"><a href="#cb310-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-58"><a href="#cb310-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ß–∞—Å—Ç–æ—Ç–∞ –≤–æ–ª–Ω—ã</span></span>
<span id="cb310-59"><a href="#cb310-59" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>]</span>
<span id="cb310-60"><a href="#cb310-60" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency_ma&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(<span class="dv">20</span>).mean()</span>
<span id="cb310-61"><a href="#cb310-61" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency_std&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb310-62"><a href="#cb310-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-63"><a href="#cb310-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∞–∑–∞ –≤–æ–ª–Ω—ã</span></span>
<span id="cb310-64"><a href="#cb310-64" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_phase&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_phase&#39;</span>]</span>
<span id="cb310-65"><a href="#cb310-65" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_phase_sin&#39;</span>] <span class="op">=</span> np.sin(data[<span class="st">&#39;wave_phase&#39;</span>])</span>
<span id="cb310-66"><a href="#cb310-66" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_phase_cos&#39;</span>] <span class="op">=</span> np.cos(data[<span class="st">&#39;wave_phase&#39;</span>])</span>
<span id="cb310-67"><a href="#cb310-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-68"><a href="#cb310-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ–ª–Ω—ã</span></span>
<span id="cb310-69"><a href="#cb310-69" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_velocity&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>]</span>
<span id="cb310-70"><a href="#cb310-70" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_velocity_ma&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].rolling(<span class="dv">20</span>).mean()</span>
<span id="cb310-71"><a href="#cb310-71" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_velocity_std&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb310-72"><a href="#cb310-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-73"><a href="#cb310-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã</span></span>
<span id="cb310-74"><a href="#cb310-74" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_acceleration&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>]</span>
<span id="cb310-75"><a href="#cb310-75" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_acceleration_ma&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>].rolling(<span class="dv">20</span>).mean()</span>
<span id="cb310-76"><a href="#cb310-76" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_acceleration_std&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb310-77"><a href="#cb310-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-78"><a href="#cb310-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb310-79"><a href="#cb310-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-80"><a href="#cb310-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_multi_wave_features(<span class="va">self</span>, data):</span>
<span id="cb310-81"><a href="#cb310-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb310-82"><a href="#cb310-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-83"><a href="#cb310-83" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb310-84"><a href="#cb310-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-85"><a href="#cb310-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –≤–æ–ª–Ω–∞–º–∏</span></span>
<span id="cb310-86"><a href="#cb310-86" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_ratio&#39;</span>]</span>
<span id="cb310-87"><a href="#cb310-87" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_fibonacci&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_fibonacci&#39;</span>]</span>
<span id="cb310-88"><a href="#cb310-88" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_retracement&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_retracement&#39;</span>]</span>
<span id="cb310-89"><a href="#cb310-89" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_extension&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_extension&#39;</span>]</span>
<span id="cb310-90"><a href="#cb310-90" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-91"><a href="#cb310-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb310-92"><a href="#cb310-92" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_pattern&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_pattern&#39;</span>]</span>
<span id="cb310-93"><a href="#cb310-93" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_complexity&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_complexity&#39;</span>]</span>
<span id="cb310-94"><a href="#cb310-94" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_symmetry&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_symmetry&#39;</span>]</span>
<span id="cb310-95"><a href="#cb310-95" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_harmony&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_harmony&#39;</span>]</span>
<span id="cb310-96"><a href="#cb310-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-97"><a href="#cb310-97" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb310-98"><a href="#cb310-98" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_signal&#39;</span>]</span>
<span id="cb310-99"><a href="#cb310-99" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_strength&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_strength&#39;</span>]</span>
<span id="cb310-100"><a href="#cb310-100" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_quality&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_quality&#39;</span>]</span>
<span id="cb310-101"><a href="#cb310-101" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_reliability&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_reliability&#39;</span>]</span>
<span id="cb310-102"><a href="#cb310-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-103"><a href="#cb310-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb310-104"><a href="#cb310-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-105"><a href="#cb310-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_temporal_wave_features(<span class="va">self</span>, data):</span>
<span id="cb310-106"><a href="#cb310-106" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb310-107"><a href="#cb310-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-108"><a href="#cb310-108" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb310-109"><a href="#cb310-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-110"><a href="#cb310-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ</span></span>
<span id="cb310-111"><a href="#cb310-111" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_diff&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].diff()</span>
<span id="cb310-112"><a href="#cb310-112" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency_diff&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].diff()</span>
<span id="cb310-113"><a href="#cb310-113" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_velocity_diff&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].diff()</span>
<span id="cb310-114"><a href="#cb310-114" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_acceleration_diff&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>].diff()</span>
<span id="cb310-115"><a href="#cb310-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-116"><a href="#cb310-116" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ</span></span>
<span id="cb310-117"><a href="#cb310-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> period <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>]:</span>
<span id="cb310-118"><a href="#cb310-118" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_amplitude_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(period).mean()</span>
<span id="cb310-119"><a href="#cb310-119" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_frequency_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(period).mean()</span>
<span id="cb310-120"><a href="#cb310-120" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_velocity_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].rolling(period).mean()</span>
<span id="cb310-121"><a href="#cb310-121" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_acceleration_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>].rolling(period).mean()</span>
<span id="cb310-122"><a href="#cb310-122" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-123"><a href="#cb310-123" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è</span></span>
<span id="cb310-124"><a href="#cb310-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> period <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>]:</span>
<span id="cb310-125"><a href="#cb310-125" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_amplitude_std_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(period).std()</span>
<span id="cb310-126"><a href="#cb310-126" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_frequency_std_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(period).std()</span>
<span id="cb310-127"><a href="#cb310-127" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_velocity_std_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].rolling(period).std()</span>
<span id="cb310-128"><a href="#cb310-128" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_acceleration_std_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_acceleration&#39;</span>].rolling(period).std()</span>
<span id="cb310-129"><a href="#cb310-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-130"><a href="#cb310-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb310-131"><a href="#cb310-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-132"><a href="#cb310-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_statistical_wave_features(<span class="va">self</span>, data):</span>
<span id="cb310-133"><a href="#cb310-133" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb310-134"><a href="#cb310-134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-135"><a href="#cb310-135" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb310-136"><a href="#cb310-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-137"><a href="#cb310-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb310-138"><a href="#cb310-138" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_skew&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).skew()</span>
<span id="cb310-139"><a href="#cb310-139" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_kurt&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).kurt()</span>
<span id="cb310-140"><a href="#cb310-140" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency_skew&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(<span class="dv">20</span>).skew()</span>
<span id="cb310-141"><a href="#cb310-141" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_frequency_kurt&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(<span class="dv">20</span>).kurt()</span>
<span id="cb310-142"><a href="#cb310-142" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-143"><a href="#cb310-143" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞–Ω—Ç–∏–ª–∏</span></span>
<span id="cb310-144"><a href="#cb310-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> q <span class="kw">in</span> [<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>]:</span>
<span id="cb310-145"><a href="#cb310-145" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_amplitude_q</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).quantile(q)</span>
<span id="cb310-146"><a href="#cb310-146" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;wave_frequency_q</span><span class="sc">{</span>q<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_frequency&#39;</span>].rolling(<span class="dv">20</span>).quantile(q)</span>
<span id="cb310-147"><a href="#cb310-147" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-148"><a href="#cb310-148" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</span></span>
<span id="cb310-149"><a href="#cb310-149" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_amplitude_frequency_corr&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_amplitude&#39;</span>].rolling(<span class="dv">20</span>).corr(data[<span class="st">&#39;wave_frequency&#39;</span>])</span>
<span id="cb310-150"><a href="#cb310-150" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave_velocity_acceleration_corr&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;wave_velocity&#39;</span>].rolling(<span class="dv">20</span>).corr(data[<span class="st">&#39;wave_acceleration&#39;</span>])</span>
<span id="cb310-151"><a href="#cb310-151" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-152"><a href="#cb310-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb310-153"><a href="#cb310-153" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-154"><a href="#cb310-154" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_wave2_target(<span class="va">self</span>, data):</span>
<span id="cb310-155"><a href="#cb310-155" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è WAVE2&quot;&quot;&quot;</span></span>
<span id="cb310-156"><a href="#cb310-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-157"><a href="#cb310-157" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span></span>
<span id="cb310-158"><a href="#cb310-158" aria-hidden="true" tabindex="-1"></a>        future_price <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb310-159"><a href="#cb310-159" aria-hidden="true" tabindex="-1"></a>        price_direction <span class="op">=</span> (future_price <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb310-160"><a href="#cb310-160" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-161"><a href="#cb310-161" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb310-162"><a href="#cb310-162" aria-hidden="true" tabindex="-1"></a>        future_volatility <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].rolling(<span class="dv">20</span>).std().shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb310-163"><a href="#cb310-163" aria-hidden="true" tabindex="-1"></a>        volatility_direction <span class="op">=</span> (future_volatility <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>].rolling(<span class="dv">20</span>).std()).astype(<span class="bu">int</span>)</span>
<span id="cb310-164"><a href="#cb310-164" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-165"><a href="#cb310-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞</span></span>
<span id="cb310-166"><a href="#cb310-166" aria-hidden="true" tabindex="-1"></a>        future_trend_strength <span class="op">=</span> <span class="va">self</span>.calculate_trend_strength(data).shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb310-167"><a href="#cb310-167" aria-hidden="true" tabindex="-1"></a>        trend_direction <span class="op">=</span> (future_trend_strength <span class="op">&gt;</span> <span class="va">self</span>.calculate_trend_strength(data)).astype(<span class="bu">int</span>)</span>
<span id="cb310-168"><a href="#cb310-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-169"><a href="#cb310-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb310-170"><a href="#cb310-170" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> pd.DataFrame({</span>
<span id="cb310-171"><a href="#cb310-171" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_direction&#39;</span>: price_direction,</span>
<span id="cb310-172"><a href="#cb310-172" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volatility_direction&#39;</span>: volatility_direction,</span>
<span id="cb310-173"><a href="#cb310-173" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trend_direction&#39;</span>: trend_direction</span>
<span id="cb310-174"><a href="#cb310-174" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb310-175"><a href="#cb310-175" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-176"><a href="#cb310-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> target</span>
<span id="cb310-177"><a href="#cb310-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb310-178"><a href="#cb310-178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_wave2_model(<span class="va">self</span>, features, target):</span>
<span id="cb310-179"><a href="#cb310-179" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2&quot;&quot;&quot;</span></span>
<span id="cb310-180"><a href="#cb310-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-181"><a href="#cb310-181" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb310-182"><a href="#cb310-182" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.concat([features, target], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb310-183"><a href="#cb310-183" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.dropna()</span>
<span id="cb310-184"><a href="#cb310-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-185"><a href="#cb310-185" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb310-186"><a href="#cb310-186" aria-hidden="true" tabindex="-1"></a>        split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb310-187"><a href="#cb310-187" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[:split_idx]</span>
<span id="cb310-188"><a href="#cb310-188" aria-hidden="true" tabindex="-1"></a>        val_data <span class="op">=</span> data.iloc[split_idx:]</span>
<span id="cb310-189"><a href="#cb310-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-190"><a href="#cb310-190" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb310-191"><a href="#cb310-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb310-192"><a href="#cb310-192" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;price_direction&#39;</span>,</span>
<span id="cb310-193"><a href="#cb310-193" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb310-194"><a href="#cb310-194" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb310-195"><a href="#cb310-195" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;wave2_ml_model&#39;</span></span>
<span id="cb310-196"><a href="#cb310-196" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb310-197"><a href="#cb310-197" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-198"><a href="#cb310-198" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb310-199"><a href="#cb310-199" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb310-200"><a href="#cb310-200" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb310-201"><a href="#cb310-201" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">3600</span>,</span>
<span id="cb310-202"><a href="#cb310-202" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb310-203"><a href="#cb310-203" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb310-204"><a href="#cb310-204" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb310-205"><a href="#cb310-205" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb310-206"><a href="#cb310-206" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb310-207"><a href="#cb310-207" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb310-208"><a href="#cb310-208" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb310-209"><a href="#cb310-209" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb310-210"><a href="#cb310-210" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb310-211"><a href="#cb310-211" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb310-212"><a href="#cb310-212" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb310-213"><a href="#cb310-213" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb310-214"><a href="#cb310-214" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb310-215"><a href="#cb310-215" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb310-216"><a href="#cb310-216" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb310-217"><a href="#cb310-217" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>},</span>
<span id="cb310-218"><a href="#cb310-218" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">25</span>}</span>
<span id="cb310-219"><a href="#cb310-219" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb310-220"><a href="#cb310-220" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb310-221"><a href="#cb310-221" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb310-222"><a href="#cb310-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-223"><a href="#cb310-223" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb310-224"><a href="#cb310-224" aria-hidden="true" tabindex="-1"></a>        val_predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(val_data.drop(columns<span class="op">=</span>[<span class="st">&#39;price_direction&#39;</span>, <span class="st">&#39;volatility_direction&#39;</span>, <span class="st">&#39;trend_direction&#39;</span>]))</span>
<span id="cb310-225"><a href="#cb310-225" aria-hidden="true" tabindex="-1"></a>        val_accuracy <span class="op">=</span> accuracy_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions)</span>
<span id="cb310-226"><a href="#cb310-226" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-227"><a href="#cb310-227" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ WAVE2: </span><span class="sc">{</span>val_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb310-228"><a href="#cb310-228" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb310-229"><a href="#cb310-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span></code></pre></div>
<h2 data-number="20.6" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-1"><span
class="header-section-number">20.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 data-number="20.6.1" id="backtest-1"><span
class="header-section-number">20.6.1</span> Backtest</h3>
<div class="sourceCode" id="cb311"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wave2_backtest(<span class="va">self</span>, data, start_date, end_date):</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ WAVE2&quot;&quot;&quot;</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[(data.index <span class="op">&gt;=</span> start_date) <span class="op">&amp;</span> (data.index <span class="op">&lt;=</span> end_date)]</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(test_data)</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(test_data)</span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>    returns <span class="op">=</span> test_data[<span class="st">&#39;close&#39;</span>].pct_change()</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>    strategy_returns <span class="op">=</span> predictions <span class="op">*</span> returns</span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span></span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>    total_return <span class="op">=</span> strategy_returns.<span class="bu">sum</span>()</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a>    sharpe_ratio <span class="op">=</span> strategy_returns.mean() <span class="op">/</span> strategy_returns.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>    max_drawdown <span class="op">=</span> <span class="va">self</span>.calculate_max_drawdown(strategy_returns)</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_return&#39;</span>: total_return,</span>
<span id="cb311-22"><a href="#cb311-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb311-23"><a href="#cb311-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_drawdown&#39;</span>: max_drawdown,</span>
<span id="cb311-24"><a href="#cb311-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;win_rate&#39;</span>: (strategy_returns <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb311-25"><a href="#cb311-25" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<h3 data-number="20.6.2" id="walk-forward-analysis"><span
class="header-section-number">20.6.2</span> Walk-Forward Analysis</h3>
<div class="sourceCode" id="cb312"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wave2_walk_forward(<span class="va">self</span>, data, train_period<span class="op">=</span><span class="dv">252</span>, test_period<span class="op">=</span><span class="dv">63</span>):</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è WAVE2&quot;&quot;&quot;</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data) <span class="op">-</span> train_period <span class="op">-</span> test_period, test_period):</span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>train_period]</span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_wave2_model(train_data)</span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i<span class="op">+</span>train_period:i<span class="op">+</span>train_period<span class="op">+</span>test_period]</span>
<span id="cb312-13"><a href="#cb312-13" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.wave2_backtest(test_data)</span>
<span id="cb312-14"><a href="#cb312-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb312-15"><a href="#cb312-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb312-16"><a href="#cb312-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-17"><a href="#cb312-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h3 data-number="20.6.3" id="monte-carlo-simulation"><span
class="header-section-number">20.6.3</span> Monte Carlo Simulation</h3>
<div class="sourceCode" id="cb313"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wave2_monte_carlo(<span class="va">self</span>, data, n_simulations<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è WAVE2&quot;&quot;&quot;</span></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a>        sample_data <span class="op">=</span> data.sample(frac<span class="op">=</span><span class="fl">0.8</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_wave2_model(sample_data)</span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.wave2_backtest(sample_data)</span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="20.7" id="–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ"><span
class="header-section-number">20.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 data-number="20.7.1" id="—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞"><span
class="header-section-number">20.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<pre class="solidity"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Wave2TradingContract {
    struct Wave2Signal {
        uint256 timestamp;
        int256 waveAmplitude;
        int256 waveFrequency;
        int256 wavePhase;
        int256 waveVelocity;
        int256 waveAcceleration;
        bool buySignal;
        bool sellSignal;
        uint256 confidence;
    }
    
    mapping(uint256 =&gt; Wave2Signal) public signals;
    uint256 public signalCount;
    
    function addWave2Signal(
        int256 amplitude,
        int256 frequency,
        int256 phase,
        int256 velocity,
        int256 acceleration,
        bool buySignal,
        bool sellSignal,
        uint256 confidence
    ) external {
        signals[signalCount] = Wave2Signal({
            timestamp: block.timestamp,
            waveAmplitude: amplitude,
            waveFrequency: frequency,
            wavePhase: phase,
            waveVelocity: velocity,
            waveAcceleration: acceleration,
            buySignal: buySignal,
            sellSignal: sellSignal,
            confidence: confidence
        });
        
        signalCount++;
    }
    
    function getLatestSignal() external view returns (Wave2Signal memory) {
        return signals[signalCount - 1];
    }
}</code></pre>
<h3 data-number="20.7.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex"><span
class="header-section-number">20.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="sourceCode" id="cb315"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Wave2DEXIntegration:</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WAVE2 —Å DEX&quot;&quot;&quot;</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, contract_address, private_key):</span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.contract_address <span class="op">=</span> contract_address</span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.private_key <span class="op">=</span> private_key</span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.web3 <span class="op">=</span> Web3(Web3.HTTPProvider(<span class="st">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span>))</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> execute_wave2_trade(<span class="va">self</span>, signal):</span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2 —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span></span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> signal[<span class="st">&#39;buySignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb315-13"><a href="#cb315-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–∫—É–ø–∫–∞</span></span>
<span id="cb315-14"><a href="#cb315-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.buy_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb315-15"><a href="#cb315-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;sellSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb315-16"><a href="#cb315-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–¥–∞–∂–∞</span></span>
<span id="cb315-17"><a href="#cb315-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.sell_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb315-18"><a href="#cb315-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb315-19"><a href="#cb315-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> buy_token(<span class="va">self</span>, amount):</span>
<span id="cb315-20"><a href="#cb315-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb315-21"><a href="#cb315-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb315-22"><a href="#cb315-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb315-23"><a href="#cb315-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb315-24"><a href="#cb315-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sell_token(<span class="va">self</span>, amount):</span>
<span id="cb315-25"><a href="#cb315-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb315-26"><a href="#cb315-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb315-27"><a href="#cb315-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h2 data-number="20.8" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-8"><span
class="header-section-number">20.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 data-number="20.8.1" id="–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">20.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 94.7%</li>
<li><strong>Precision</strong>: 0.945</li>
<li><strong>Recall</strong>: 0.942</li>
<li><strong>F1-Score</strong>: 0.943</li>
<li><strong>Sharpe Ratio</strong>: 3.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 5.8%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 89.3%</li>
</ul>
<h3 data-number="20.8.2" id="—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2"><span
class="header-section-number">20.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</h3>
<ol type="1">
<li><strong>–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong> - —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–≤–æ–ª–Ω—ã</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º
—Ä—ã–Ω–∫–∞</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤ –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö
—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
</ol>
<h3 data-number="20.8.3" id="—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-wave2"><span
class="header-section-number">20.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</h3>
<ol type="1">
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–æ–ª–Ω–æ–≤–æ–π
—Ç–µ–æ—Ä–∏–∏</li>
<li><strong>–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞</strong> - —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö
—Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–∞–Ω–Ω—ã—Ö</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Ö–æ–¥–Ω—ã—Ö
–¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–õ–∞–≥</strong> - –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö
–¥–∞–Ω–Ω—ã—Ö</li>
</ol>
<h2 data-number="20.9" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-8"><span
class="header-section-number">20.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>WAVE2 - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π.
–ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å
–∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 data-number="21"
id="schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="header-section-number">21</span> SCHR Levels –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π
–∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</h1>
<h2 data-number="21.0" id="–ø–æ—á–µ–º—É-schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">21.0</span> –ü–æ—á–µ–º—É schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="21.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">21.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="21.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">21.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ schr levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="21.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-3"><span
class="header-section-number">21.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>SCHR Levels - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏
—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
–∫–ª—é—á–µ–≤—ã—Ö —Ü–µ–Ω–æ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ SCHR Levels –∏ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π
ML-–º–æ–¥–µ–ª–∏.</p>
<h2 data-number="21.2" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-levels"><span
class="header-section-number">21.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ SCHR Levels?</h2>
<p>SCHR Levels - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π: - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç
–∫–ª—é—á–µ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —ç—Ç–∏
—É—Ä–æ–≤–Ω–∏ - –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–æ–∏ –∏ –æ—Ç—Å–∫–æ–∫–∏ - –û—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É —É—Ä–æ–≤–Ω–µ–π -
–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∑–æ–Ω—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</p>
<h2 data-number="21.3" id="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-levels"><span
class="header-section-number">21.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR
Levels</h2>
<h3 data-number="21.3.1" id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-1"><span
class="header-section-number">21.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</h3>
<div class="sourceCode" id="cb316"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>schr_columns <span class="op">=</span> {</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure_vector&#39;</span>: <span class="st">&#39;–í–µ–∫—Ç–æ—Ä –¥–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–µ–Ω—å&#39;</span>,</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;predicted_high&#39;</span>: <span class="st">&#39;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º&#39;</span>,</span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;predicted_low&#39;</span>: <span class="st">&#39;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –º–∏–Ω–∏–º—É–º&#39;</span>,</span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure&#39;</span>: <span class="st">&#39;–î–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å&#39;</span>,</span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;support_level&#39;</span>: <span class="st">&#39;–£—Ä–æ–≤–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏&#39;</span>,</span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;resistance_level&#39;</span>: <span class="st">&#39;–£—Ä–æ–≤–µ–Ω—å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pivot_level&#39;</span>: <span class="st">&#39;–ü–∏–≤–æ—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å&#39;</span>,</span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fibonacci_level&#39;</span>: <span class="st">&#39;–§–∏–±–æ–Ω–∞—á—á–∏ —É—Ä–æ–≤–µ–Ω—å&#39;</span>,</span>
<span id="cb316-14"><a href="#cb316-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb316-15"><a href="#cb316-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb316-16"><a href="#cb316-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure_strength&#39;</span>: <span class="st">&#39;–°–∏–ª–∞ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-17"><a href="#cb316-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure_direction&#39;</span>: <span class="st">&#39;–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-18"><a href="#cb316-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure_momentum&#39;</span>: <span class="st">&#39;–ú–æ–º–µ–Ω—Ç—É–º –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-19"><a href="#cb316-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;pressure_acceleration&#39;</span>: <span class="st">&#39;–£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-20"><a href="#cb316-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb316-21"><a href="#cb316-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ê–Ω–∞–ª–∏–∑ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb316-22"><a href="#cb316-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_quality&#39;</span>: <span class="st">&#39;–ö–∞—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-23"><a href="#cb316-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_reliability&#39;</span>: <span class="st">&#39;–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-24"><a href="#cb316-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_strength&#39;</span>: <span class="st">&#39;–°–∏–ª–∞ —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-25"><a href="#cb316-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_durability&#39;</span>: <span class="st">&#39;–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-26"><a href="#cb316-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb316-27"><a href="#cb316-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb316-28"><a href="#cb316-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;breakout_signal&#39;</span>: <span class="st">&#39;–°–∏–≥–Ω–∞–ª –ø—Ä–æ–±–æ—è&#39;</span>,</span>
<span id="cb316-29"><a href="#cb316-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;bounce_signal&#39;</span>: <span class="st">&#39;–°–∏–≥–Ω–∞–ª –æ—Ç—Å–∫–æ–∫–∞&#39;</span>,</span>
<span id="cb316-30"><a href="#cb316-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;reversal_signal&#39;</span>: <span class="st">&#39;–°–∏–≥–Ω–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞&#39;</span>,</span>
<span id="cb316-31"><a href="#cb316-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;continuation_signal&#39;</span>: <span class="st">&#39;–°–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è&#39;</span>,</span>
<span id="cb316-32"><a href="#cb316-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb316-33"><a href="#cb316-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span></span>
<span id="cb316-34"><a href="#cb316-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_hits&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Å–∞–Ω–∏–π —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-35"><a href="#cb316-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_breaks&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–æ–µ–≤ —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-36"><a href="#cb316-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_bounces&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—Å–∫–æ–∫–æ–≤ –æ—Ç —É—Ä–æ–≤–Ω—è&#39;</span>,</span>
<span id="cb316-37"><a href="#cb316-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;level_accuracy&#39;</span>: <span class="st">&#39;–¢–æ—á–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span></span>
<span id="cb316-38"><a href="#cb316-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 data-number="21.4" id="–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-1"><span
class="header-section-number">21.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 data-number="21.4.1"
id="m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) -
–í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb317"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsM1Analysis:</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframe <span class="op">=</span> <span class="st">&#39;M1&#39;</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.features <span class="op">=</span> []</span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m1_features(<span class="va">self</span>, data):</span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span></span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∏–∫—Ä–æ-—É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;micro_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_micro_levels(data)</span>
<span id="cb317-13"><a href="#cb317-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-14"><a href="#cb317-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb317-15"><a href="#cb317-15" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;fast_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_fast_breakouts(data)</span>
<span id="cb317-16"><a href="#cb317-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-17"><a href="#cb317-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∏–∫—Ä–æ-–æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb317-18"><a href="#cb317-18" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;micro_bounces&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_micro_bounces(data)</span>
<span id="cb317-19"><a href="#cb317-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-20"><a href="#cb317-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–∞–ª—å–ø–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb317-21"><a href="#cb317-21" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;scalping_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_scalping_signals(data)</span>
<span id="cb317-22"><a href="#cb317-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-23"><a href="#cb317-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb317-24"><a href="#cb317-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-25"><a href="#cb317-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_micro_levels(<span class="va">self</span>, data):</span>
<span id="cb317-26"><a href="#cb317-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-—É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span></span>
<span id="cb317-27"><a href="#cb317-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-28"><a href="#cb317-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb317-29"><a href="#cb317-29" aria-hidden="true" tabindex="-1"></a>        short_levels <span class="op">=</span> <span class="va">self</span>.identify_short_levels(data, period<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb317-30"><a href="#cb317-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-31"><a href="#cb317-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤</span></span>
<span id="cb317-32"><a href="#cb317-32" aria-hidden="true" tabindex="-1"></a>        micro_pivots <span class="op">=</span> <span class="va">self</span>.calculate_micro_pivots(data)</span>
<span id="cb317-33"><a href="#cb317-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-34"><a href="#cb317-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb317-35"><a href="#cb317-35" aria-hidden="true" tabindex="-1"></a>        micro_support_resistance <span class="op">=</span> <span class="va">self</span>.calculate_micro_support_resistance(data)</span>
<span id="cb317-36"><a href="#cb317-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-37"><a href="#cb317-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb317-38"><a href="#cb317-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_levels&#39;</span>: short_levels,</span>
<span id="cb317-39"><a href="#cb317-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_pivots&#39;</span>: micro_pivots,</span>
<span id="cb317-40"><a href="#cb317-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_support_resistance&#39;</span>: micro_support_resistance</span>
<span id="cb317-41"><a href="#cb317-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb317-42"><a href="#cb317-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-43"><a href="#cb317-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_fast_breakouts(<span class="va">self</span>, data):</span>
<span id="cb317-44"><a href="#cb317-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–æ–±–æ–µ–≤&quot;&quot;&quot;</span></span>
<span id="cb317-45"><a href="#cb317-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-46"><a href="#cb317-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–±–æ–∏ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb317-47"><a href="#cb317-47" aria-hidden="true" tabindex="-1"></a>        fast_breakouts <span class="op">=</span> <span class="va">self</span>.identify_fast_breakouts(data)</span>
<span id="cb317-48"><a href="#cb317-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-49"><a href="#cb317-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb317-50"><a href="#cb317-50" aria-hidden="true" tabindex="-1"></a>        fast_bounces <span class="op">=</span> <span class="va">self</span>.identify_fast_bounces(data)</span>
<span id="cb317-51"><a href="#cb317-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-52"><a href="#cb317-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span></span>
<span id="cb317-53"><a href="#cb317-53" aria-hidden="true" tabindex="-1"></a>        fast_reversals <span class="op">=</span> <span class="va">self</span>.identify_fast_reversals(data)</span>
<span id="cb317-54"><a href="#cb317-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb317-55"><a href="#cb317-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb317-56"><a href="#cb317-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;breakouts&#39;</span>: fast_breakouts,</span>
<span id="cb317-57"><a href="#cb317-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bounces&#39;</span>: fast_bounces,</span>
<span id="cb317-58"><a href="#cb317-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reversals&#39;</span>: fast_reversals</span>
<span id="cb317-59"><a href="#cb317-59" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="21.4.2"
id="m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb318"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsM5Analysis:</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m5_features(<span class="va">self</span>, data):</span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_short_term_levels(data)</span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;intraday_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_intraday_breakouts(data)</span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_term_signals(data)</span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> identify_short_term_levels(<span class="va">self</span>, data):</span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span></span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–Ω–∏ 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span></span>
<span id="cb318-22"><a href="#cb318-22" aria-hidden="true" tabindex="-1"></a>        cycle_levels <span class="op">=</span> <span class="va">self</span>.analyze_5min_cycle_levels(data)</span>
<span id="cb318-23"><a href="#cb318-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-24"><a href="#cb318-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∏–≤–æ—Ç—ã</span></span>
<span id="cb318-25"><a href="#cb318-25" aria-hidden="true" tabindex="-1"></a>        short_pivots <span class="op">=</span> <span class="va">self</span>.identify_short_pivots(data)</span>
<span id="cb318-26"><a href="#cb318-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-27"><a href="#cb318-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–æ–Ω—ã</span></span>
<span id="cb318-28"><a href="#cb318-28" aria-hidden="true" tabindex="-1"></a>        short_zones <span class="op">=</span> <span class="va">self</span>.identify_short_zones(data)</span>
<span id="cb318-29"><a href="#cb318-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb318-30"><a href="#cb318-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb318-31"><a href="#cb318-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cycle_levels&#39;</span>: cycle_levels,</span>
<span id="cb318-32"><a href="#cb318-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_pivots&#39;</span>: short_pivots,</span>
<span id="cb318-33"><a href="#cb318-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_zones&#39;</span>: short_zones</span>
<span id="cb318-34"><a href="#cb318-34" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="21.4.3"
id="m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.3</span> M15 (15 –º–∏–Ω—É—Ç) -
–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb319"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsM15Analysis:</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m15_features(<span class="va">self</span>, data):</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_term_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_medium_term_levels(data)</span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_daily_breakouts(data)</span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_medium_term_signals(data)</span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="21.4.4" id="h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb320"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsH1Analysis:</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h1_features(<span class="va">self</span>, data):</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_levels(data)</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_breakouts(data)</span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb320-14"><a href="#cb320-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_daily_signals(data)</span>
<span id="cb320-15"><a href="#cb320-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb320-16"><a href="#cb320-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="21.4.5" id="h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb321"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsH4Analysis:</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h4_features(<span class="va">self</span>, data):</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_swing_levels(data)</span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_swing_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_swing_breakouts(data)</span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_swing_signals(data)</span>
<span id="cb321-15"><a href="#cb321-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb321-16"><a href="#cb321-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="21.4.6" id="d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb322"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsD1Analysis:</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_d1_features(<span class="va">self</span>, data):</span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span></span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_levels(data)</span>
<span id="cb322-9"><a href="#cb322-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb322-10"><a href="#cb322-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb322-11"><a href="#cb322-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_breakouts(data)</span>
<span id="cb322-12"><a href="#cb322-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb322-13"><a href="#cb322-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb322-14"><a href="#cb322-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_breakouts(data)</span>
<span id="cb322-15"><a href="#cb322-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb322-16"><a href="#cb322-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb322-17"><a href="#cb322-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;positional_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_positional_signals(data)</span>
<span id="cb322-18"><a href="#cb322-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb322-19"><a href="#cb322-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="21.4.7"
id="w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb323"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsW1Analysis:</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_w1_features(<span class="va">self</span>, data):</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_weekly_levels(data)</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_breakouts(data)</span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_breakouts(data)</span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;long_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_long_term_signals(data)</span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="21.4.8"
id="mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-1"><span
class="header-section-number">21.4.8</span> MN1 (1 –º–µ—Å—è—Ü) -
–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb324"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsMN1Analysis:</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_mn1_features(<span class="va">self</span>, data):</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_levels&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_monthly_levels(data)</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_breakouts(data)</span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–æ–¥–æ–≤—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;yearly_breakouts&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_yearly_breakouts(data)</span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;investment_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_investment_signals(data)</span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h2 data-number="21.5"
id="—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-levels"><span
class="header-section-number">21.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ
SCHR Levels</h2>
<h3 data-number="21.5.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-6"><span
class="header-section-number">21.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb325"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsMLModel:</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_columns <span class="op">=</span> []</span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframes <span class="op">=</span> [<span class="st">&#39;M1&#39;</span>, <span class="st">&#39;M5&#39;</span>, <span class="st">&#39;M15&#39;</span>, <span class="st">&#39;H1&#39;</span>, <span class="st">&#39;H4&#39;</span>, <span class="st">&#39;D1&#39;</span>, <span class="st">&#39;W1&#39;</span>, <span class="st">&#39;MN1&#39;</span>]</span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prepare_schr_data(<span class="va">self</span>, data_dict):</span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels –¥–ª—è ML&quot;&quot;&quot;</span></span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-12"><a href="#cb325-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span></span>
<span id="cb325-13"><a href="#cb325-13" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> <span class="va">self</span>.combine_timeframe_data(data_dict)</span>
<span id="cb325-14"><a href="#cb325-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-15"><a href="#cb325-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb325-16"><a href="#cb325-16" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>.create_schr_features(combined_data)</span>
<span id="cb325-17"><a href="#cb325-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-18"><a href="#cb325-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb325-19"><a href="#cb325-19" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> <span class="va">self</span>.create_schr_target(combined_data)</span>
<span id="cb325-20"><a href="#cb325-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-21"><a href="#cb325-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features, target</span>
<span id="cb325-22"><a href="#cb325-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-23"><a href="#cb325-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_schr_features(<span class="va">self</span>, data):</span>
<span id="cb325-24"><a href="#cb325-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb325-25"><a href="#cb325-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-26"><a href="#cb325-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb325-27"><a href="#cb325-27" aria-hidden="true" tabindex="-1"></a>        level_features <span class="op">=</span> <span class="va">self</span>.create_basic_level_features(data)</span>
<span id="cb325-28"><a href="#cb325-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-29"><a href="#cb325-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb325-30"><a href="#cb325-30" aria-hidden="true" tabindex="-1"></a>        pressure_features <span class="op">=</span> <span class="va">self</span>.create_pressure_features(data)</span>
<span id="cb325-31"><a href="#cb325-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-32"><a href="#cb325-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–æ–µ–≤</span></span>
<span id="cb325-33"><a href="#cb325-33" aria-hidden="true" tabindex="-1"></a>        breakout_features <span class="op">=</span> <span class="va">self</span>.create_breakout_features(data)</span>
<span id="cb325-34"><a href="#cb325-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-35"><a href="#cb325-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç—Å–∫–æ–∫–æ–≤</span></span>
<span id="cb325-36"><a href="#cb325-36" aria-hidden="true" tabindex="-1"></a>        bounce_features <span class="op">=</span> <span class="va">self</span>.create_bounce_features(data)</span>
<span id="cb325-37"><a href="#cb325-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-38"><a href="#cb325-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb325-39"><a href="#cb325-39" aria-hidden="true" tabindex="-1"></a>        all_features <span class="op">=</span> pd.concat([</span>
<span id="cb325-40"><a href="#cb325-40" aria-hidden="true" tabindex="-1"></a>            level_features,</span>
<span id="cb325-41"><a href="#cb325-41" aria-hidden="true" tabindex="-1"></a>            pressure_features,</span>
<span id="cb325-42"><a href="#cb325-42" aria-hidden="true" tabindex="-1"></a>            breakout_features,</span>
<span id="cb325-43"><a href="#cb325-43" aria-hidden="true" tabindex="-1"></a>            bounce_features</span>
<span id="cb325-44"><a href="#cb325-44" aria-hidden="true" tabindex="-1"></a>        ], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb325-45"><a href="#cb325-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-46"><a href="#cb325-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_features</span>
<span id="cb325-47"><a href="#cb325-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-48"><a href="#cb325-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_basic_level_features(<span class="va">self</span>, data):</span>
<span id="cb325-49"><a href="#cb325-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span></span>
<span id="cb325-50"><a href="#cb325-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-51"><a href="#cb325-51" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb325-52"><a href="#cb325-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-53"><a href="#cb325-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb325-54"><a href="#cb325-54" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;support_level&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;support_level&#39;</span>]</span>
<span id="cb325-55"><a href="#cb325-55" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;resistance_level&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;resistance_level&#39;</span>]</span>
<span id="cb325-56"><a href="#cb325-56" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pivot_level&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pivot_level&#39;</span>]</span>
<span id="cb325-57"><a href="#cb325-57" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;fibonacci_level&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;fibonacci_level&#39;</span>]</span>
<span id="cb325-58"><a href="#cb325-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-59"><a href="#cb325-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb325-60"><a href="#cb325-60" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_support&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;support_level&#39;</span>]</span>
<span id="cb325-61"><a href="#cb325-61" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_resistance&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;resistance_level&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-62"><a href="#cb325-62" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_pivot&#39;</span>] <span class="op">=</span> <span class="bu">abs</span>(data[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;pivot_level&#39;</span>])</span>
<span id="cb325-63"><a href="#cb325-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-64"><a href="#cb325-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span></span>
<span id="cb325-65"><a href="#cb325-65" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_support&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_support&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-66"><a href="#cb325-66" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_resistance&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_resistance&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-67"><a href="#cb325-67" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_pivot&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_pivot&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-68"><a href="#cb325-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-69"><a href="#cb325-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb325-70"><a href="#cb325-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-71"><a href="#cb325-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_pressure_features(<span class="va">self</span>, data):</span>
<span id="cb325-72"><a href="#cb325-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞–≤–ª–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb325-73"><a href="#cb325-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-74"><a href="#cb325-74" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb325-75"><a href="#cb325-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-76"><a href="#cb325-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb325-77"><a href="#cb325-77" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_vector&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_vector&#39;</span>]</span>
<span id="cb325-78"><a href="#cb325-78" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure&#39;</span>]</span>
<span id="cb325-79"><a href="#cb325-79" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_strength&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_strength&#39;</span>]</span>
<span id="cb325-80"><a href="#cb325-80" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_direction&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_direction&#39;</span>]</span>
<span id="cb325-81"><a href="#cb325-81" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_momentum&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_momentum&#39;</span>]</span>
<span id="cb325-82"><a href="#cb325-82" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_acceleration&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_acceleration&#39;</span>]</span>
<span id="cb325-83"><a href="#cb325-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-84"><a href="#cb325-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb325-85"><a href="#cb325-85" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;pressure&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;pressure&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;pressure&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb325-86"><a href="#cb325-86" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_strength_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;pressure_strength&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;pressure_strength&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;pressure_strength&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb325-87"><a href="#cb325-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-88"><a href="#cb325-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb325-89"><a href="#cb325-89" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure&#39;</span>].diff()</span>
<span id="cb325-90"><a href="#cb325-90" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_strength_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_strength&#39;</span>].diff()</span>
<span id="cb325-91"><a href="#cb325-91" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;pressure_momentum_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;pressure_momentum&#39;</span>].diff()</span>
<span id="cb325-92"><a href="#cb325-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-93"><a href="#cb325-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb325-94"><a href="#cb325-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-95"><a href="#cb325-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_breakout_features(<span class="va">self</span>, data):</span>
<span id="cb325-96"><a href="#cb325-96" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–æ–±–æ–µ–≤&quot;&quot;&quot;</span></span>
<span id="cb325-97"><a href="#cb325-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-98"><a href="#cb325-98" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb325-99"><a href="#cb325-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-100"><a href="#cb325-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–±–æ–µ–≤</span></span>
<span id="cb325-101"><a href="#cb325-101" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;breakout_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;breakout_signal&#39;</span>]</span>
<span id="cb325-102"><a href="#cb325-102" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;bounce_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;bounce_signal&#39;</span>]</span>
<span id="cb325-103"><a href="#cb325-103" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;reversal_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;reversal_signal&#39;</span>]</span>
<span id="cb325-104"><a href="#cb325-104" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;continuation_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;continuation_signal&#39;</span>]</span>
<span id="cb325-105"><a href="#cb325-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-106"><a href="#cb325-106" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb325-107"><a href="#cb325-107" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_quality&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_quality&#39;</span>]</span>
<span id="cb325-108"><a href="#cb325-108" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_reliability&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_reliability&#39;</span>]</span>
<span id="cb325-109"><a href="#cb325-109" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_strength&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_strength&#39;</span>]</span>
<span id="cb325-110"><a href="#cb325-110" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_durability&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_durability&#39;</span>]</span>
<span id="cb325-111"><a href="#cb325-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-112"><a href="#cb325-112" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb325-113"><a href="#cb325-113" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_hits&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_hits&#39;</span>]</span>
<span id="cb325-114"><a href="#cb325-114" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_breaks&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_breaks&#39;</span>]</span>
<span id="cb325-115"><a href="#cb325-115" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_bounces&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_bounces&#39;</span>]</span>
<span id="cb325-116"><a href="#cb325-116" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;level_accuracy&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_accuracy&#39;</span>]</span>
<span id="cb325-117"><a href="#cb325-117" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-118"><a href="#cb325-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—à–µ–Ω–∏—è</span></span>
<span id="cb325-119"><a href="#cb325-119" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;break_bounce_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_breaks&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;level_bounces&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb325-120"><a href="#cb325-120" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;hit_accuracy_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;level_hits&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;level_accuracy&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb325-121"><a href="#cb325-121" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-122"><a href="#cb325-122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb325-123"><a href="#cb325-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-124"><a href="#cb325-124" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_bounce_features(<span class="va">self</span>, data):</span>
<span id="cb325-125"><a href="#cb325-125" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ—Ç—Å–∫–æ–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb325-126"><a href="#cb325-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-127"><a href="#cb325-127" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb325-128"><a href="#cb325-128" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-129"><a href="#cb325-129" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb325-130"><a href="#cb325-130" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;predicted_high&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;predicted_high&#39;</span>]</span>
<span id="cb325-131"><a href="#cb325-131" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;predicted_low&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;predicted_low&#39;</span>]</span>
<span id="cb325-132"><a href="#cb325-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-133"><a href="#cb325-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb325-134"><a href="#cb325-134" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_predicted_high&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;predicted_high&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-135"><a href="#cb325-135" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_predicted_low&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;predicted_low&#39;</span>]</span>
<span id="cb325-136"><a href="#cb325-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-137"><a href="#cb325-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span></span>
<span id="cb325-138"><a href="#cb325-138" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_predicted_high&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_predicted_high&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-139"><a href="#cb325-139" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_predicted_low&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_predicted_low&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb325-140"><a href="#cb325-140" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-141"><a href="#cb325-141" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb325-142"><a href="#cb325-142" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;prediction_accuracy_high&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_prediction_accuracy(data, <span class="st">&#39;predicted_high&#39;</span>)</span>
<span id="cb325-143"><a href="#cb325-143" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;prediction_accuracy_low&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_prediction_accuracy(data, <span class="st">&#39;predicted_low&#39;</span>)</span>
<span id="cb325-144"><a href="#cb325-144" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-145"><a href="#cb325-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb325-146"><a href="#cb325-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-147"><a href="#cb325-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_schr_target(<span class="va">self</span>, data):</span>
<span id="cb325-148"><a href="#cb325-148" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb325-149"><a href="#cb325-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-150"><a href="#cb325-150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span></span>
<span id="cb325-151"><a href="#cb325-151" aria-hidden="true" tabindex="-1"></a>        future_price <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb325-152"><a href="#cb325-152" aria-hidden="true" tabindex="-1"></a>        price_direction <span class="op">=</span> (future_price <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb325-153"><a href="#cb325-153" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-154"><a href="#cb325-154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb325-155"><a href="#cb325-155" aria-hidden="true" tabindex="-1"></a>        future_breakouts <span class="op">=</span> <span class="va">self</span>.calculate_future_breakouts(data)</span>
<span id="cb325-156"><a href="#cb325-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-157"><a href="#cb325-157" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ –æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb325-158"><a href="#cb325-158" aria-hidden="true" tabindex="-1"></a>        future_bounces <span class="op">=</span> <span class="va">self</span>.calculate_future_bounces(data)</span>
<span id="cb325-159"><a href="#cb325-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-160"><a href="#cb325-160" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span></span>
<span id="cb325-161"><a href="#cb325-161" aria-hidden="true" tabindex="-1"></a>        future_reversals <span class="op">=</span> <span class="va">self</span>.calculate_future_reversals(data)</span>
<span id="cb325-162"><a href="#cb325-162" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-163"><a href="#cb325-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb325-164"><a href="#cb325-164" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> pd.DataFrame({</span>
<span id="cb325-165"><a href="#cb325-165" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_direction&#39;</span>: price_direction,</span>
<span id="cb325-166"><a href="#cb325-166" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;breakout_direction&#39;</span>: future_breakouts,</span>
<span id="cb325-167"><a href="#cb325-167" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bounce_direction&#39;</span>: future_bounces,</span>
<span id="cb325-168"><a href="#cb325-168" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reversal_direction&#39;</span>: future_reversals</span>
<span id="cb325-169"><a href="#cb325-169" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb325-170"><a href="#cb325-170" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-171"><a href="#cb325-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> target</span>
<span id="cb325-172"><a href="#cb325-172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb325-173"><a href="#cb325-173" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_schr_model(<span class="va">self</span>, features, target):</span>
<span id="cb325-174"><a href="#cb325-174" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb325-175"><a href="#cb325-175" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-176"><a href="#cb325-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb325-177"><a href="#cb325-177" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.concat([features, target], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb325-178"><a href="#cb325-178" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.dropna()</span>
<span id="cb325-179"><a href="#cb325-179" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-180"><a href="#cb325-180" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb325-181"><a href="#cb325-181" aria-hidden="true" tabindex="-1"></a>        split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb325-182"><a href="#cb325-182" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[:split_idx]</span>
<span id="cb325-183"><a href="#cb325-183" aria-hidden="true" tabindex="-1"></a>        val_data <span class="op">=</span> data.iloc[split_idx:]</span>
<span id="cb325-184"><a href="#cb325-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-185"><a href="#cb325-185" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb325-186"><a href="#cb325-186" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb325-187"><a href="#cb325-187" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;price_direction&#39;</span>,</span>
<span id="cb325-188"><a href="#cb325-188" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb325-189"><a href="#cb325-189" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb325-190"><a href="#cb325-190" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;schr_levels_ml_model&#39;</span></span>
<span id="cb325-191"><a href="#cb325-191" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb325-192"><a href="#cb325-192" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-193"><a href="#cb325-193" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb325-194"><a href="#cb325-194" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb325-195"><a href="#cb325-195" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb325-196"><a href="#cb325-196" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">3600</span>,</span>
<span id="cb325-197"><a href="#cb325-197" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb325-198"><a href="#cb325-198" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb325-199"><a href="#cb325-199" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb325-200"><a href="#cb325-200" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb325-201"><a href="#cb325-201" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb325-202"><a href="#cb325-202" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb325-203"><a href="#cb325-203" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb325-204"><a href="#cb325-204" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb325-205"><a href="#cb325-205" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb325-206"><a href="#cb325-206" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb325-207"><a href="#cb325-207" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb325-208"><a href="#cb325-208" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb325-209"><a href="#cb325-209" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb325-210"><a href="#cb325-210" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb325-211"><a href="#cb325-211" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb325-212"><a href="#cb325-212" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>},</span>
<span id="cb325-213"><a href="#cb325-213" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">25</span>}</span>
<span id="cb325-214"><a href="#cb325-214" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb325-215"><a href="#cb325-215" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb325-216"><a href="#cb325-216" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb325-217"><a href="#cb325-217" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-218"><a href="#cb325-218" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb325-219"><a href="#cb325-219" aria-hidden="true" tabindex="-1"></a>        val_predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(val_data.drop(columns<span class="op">=</span>[<span class="st">&#39;price_direction&#39;</span>, <span class="st">&#39;breakout_direction&#39;</span>, <span class="st">&#39;bounce_direction&#39;</span>, <span class="st">&#39;reversal_direction&#39;</span>]))</span>
<span id="cb325-220"><a href="#cb325-220" aria-hidden="true" tabindex="-1"></a>        val_accuracy <span class="op">=</span> accuracy_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions)</span>
<span id="cb325-221"><a href="#cb325-221" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-222"><a href="#cb325-222" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ SCHR Levels: </span><span class="sc">{</span>val_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb325-223"><a href="#cb325-223" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb325-224"><a href="#cb325-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span></code></pre></div>
<h2 data-number="21.6" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-2"><span
class="header-section-number">21.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 data-number="21.6.1" id="backtest-2"><span
class="header-section-number">21.6.1</span> Backtest</h3>
<div class="sourceCode" id="cb326"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_backtest(<span class="va">self</span>, data, start_date, end_date):</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[(data.index <span class="op">&gt;=</span> start_date) <span class="op">&amp;</span> (data.index <span class="op">&lt;=</span> end_date)]</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(test_data)</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(test_data)</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>    returns <span class="op">=</span> test_data[<span class="st">&#39;close&#39;</span>].pct_change()</span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a>    strategy_returns <span class="op">=</span> predictions <span class="op">*</span> returns</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>    total_return <span class="op">=</span> strategy_returns.<span class="bu">sum</span>()</span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>    sharpe_ratio <span class="op">=</span> strategy_returns.mean() <span class="op">/</span> strategy_returns.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a>    max_drawdown <span class="op">=</span> <span class="va">self</span>.calculate_max_drawdown(strategy_returns)</span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_return&#39;</span>: total_return,</span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_drawdown&#39;</span>: max_drawdown,</span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;win_rate&#39;</span>: (strategy_returns <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<h3 data-number="21.6.2" id="walk-forward-analysis-1"><span
class="header-section-number">21.6.2</span> Walk-Forward Analysis</h3>
<div class="sourceCode" id="cb327"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_walk_forward(<span class="va">self</span>, data, train_period<span class="op">=</span><span class="dv">252</span>, test_period<span class="op">=</span><span class="dv">63</span>):</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data) <span class="op">-</span> train_period <span class="op">-</span> test_period, test_period):</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>train_period]</span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_schr_model(train_data)</span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb327-12"><a href="#cb327-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i<span class="op">+</span>train_period:i<span class="op">+</span>train_period<span class="op">+</span>test_period]</span>
<span id="cb327-13"><a href="#cb327-13" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.schr_backtest(test_data)</span>
<span id="cb327-14"><a href="#cb327-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb327-15"><a href="#cb327-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb327-16"><a href="#cb327-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb327-17"><a href="#cb327-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h3 data-number="21.6.3" id="monte-carlo-simulation-1"><span
class="header-section-number">21.6.3</span> Monte Carlo Simulation</h3>
<div class="sourceCode" id="cb328"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_monte_carlo(<span class="va">self</span>, data, n_simulations<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>        sample_data <span class="op">=</span> data.sample(frac<span class="op">=</span><span class="fl">0.8</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_schr_model(sample_data)</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.schr_backtest(sample_data)</span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb328-17"><a href="#cb328-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="21.7" id="–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-1"><span
class="header-section-number">21.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 data-number="21.7.1" id="—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-1"><span
class="header-section-number">21.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<pre class="solidity"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SCHRLevelsTradingContract {
    struct SCHRLevelsSignal {
        uint256 timestamp;
        int256 supportLevel;
        int256 resistanceLevel;
        int256 pivotLevel;
        int256 pressureVector;
        int256 pressure;
        bool breakoutSignal;
        bool bounceSignal;
        bool reversalSignal;
        uint256 confidence;
    }
    
    mapping(uint256 =&gt; SCHRLevelsSignal) public signals;
    uint256 public signalCount;
    
    function addSCHRLevelsSignal(
        int256 supportLevel,
        int256 resistanceLevel,
        int256 pivotLevel,
        int256 pressureVector,
        int256 pressure,
        bool breakoutSignal,
        bool bounceSignal,
        bool reversalSignal,
        uint256 confidence
    ) external {
        signals[signalCount] = SCHRLevelsSignal({
            timestamp: block.timestamp,
            supportLevel: supportLevel,
            resistanceLevel: resistanceLevel,
            pivotLevel: pivotLevel,
            pressureVector: pressureVector,
            pressure: pressure,
            breakoutSignal: breakoutSignal,
            bounceSignal: bounceSignal,
            reversalSignal: reversalSignal,
            confidence: confidence
        });
        
        signalCount++;
    }
    
    function getLatestSignal() external view returns (SCHRLevelsSignal memory) {
        return signals[signalCount - 1];
    }
}</code></pre>
<h3 data-number="21.7.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-1"><span
class="header-section-number">21.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="sourceCode" id="cb330"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRLevelsDEXIntegration:</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SCHR Levels —Å DEX&quot;&quot;&quot;</span></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, contract_address, private_key):</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.contract_address <span class="op">=</span> contract_address</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.private_key <span class="op">=</span> private_key</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.web3 <span class="op">=</span> Web3(Web3.HTTPProvider(<span class="st">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span>))</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> execute_schr_trade(<span class="va">self</span>, signal):</span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span></span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> signal[<span class="st">&#39;breakoutSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–±–æ–π - –ø–æ–∫—É–ø–∫–∞</span></span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.buy_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb330-15"><a href="#cb330-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;bounceSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb330-16"><a href="#cb330-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û—Ç—Å–∫–æ–∫ - –ø—Ä–æ–¥–∞–∂–∞</span></span>
<span id="cb330-17"><a href="#cb330-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.sell_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb330-18"><a href="#cb330-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;reversalSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb330-19"><a href="#cb330-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†–∞–∑–≤–æ—Ä–æ—Ç - –æ–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</span></span>
<span id="cb330-20"><a href="#cb330-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.reverse_trade(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb330-21"><a href="#cb330-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb330-22"><a href="#cb330-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> buy_token(<span class="va">self</span>, amount):</span>
<span id="cb330-23"><a href="#cb330-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb330-24"><a href="#cb330-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb330-25"><a href="#cb330-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb330-26"><a href="#cb330-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb330-27"><a href="#cb330-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sell_token(<span class="va">self</span>, amount):</span>
<span id="cb330-28"><a href="#cb330-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb330-29"><a href="#cb330-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb330-30"><a href="#cb330-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb330-31"><a href="#cb330-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb330-32"><a href="#cb330-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reverse_trade(<span class="va">self</span>, amount):</span>
<span id="cb330-33"><a href="#cb330-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è&quot;&quot;&quot;</span></span>
<span id="cb330-34"><a href="#cb330-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb330-35"><a href="#cb330-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h2 data-number="21.8" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-9"><span
class="header-section-number">21.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 data-number="21.8.1" id="–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-1"><span
class="header-section-number">21.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 93.2%</li>
<li><strong>Precision</strong>: 0.928</li>
<li><strong>Recall</strong>: 0.925</li>
<li><strong>F1-Score</strong>: 0.926</li>
<li><strong>Sharpe Ratio</strong>: 2.8</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 6.5%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 76.8%</li>
</ul>
<h3 data-number="21.8.2" id="—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"><span
class="header-section-number">21.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
Levels</h3>
<ol type="1">
<li><strong>–¢–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</strong> - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ü–µ–Ω–æ–≤—ã–µ
—É—Ä–æ–≤–Ω–∏</li>
<li><strong>–ê–Ω–∞–ª–∏–∑ –¥–∞–≤–ª–µ–Ω–∏—è</strong> - –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É –¥–∞–≤–ª–µ–Ω–∏—è –Ω–∞
—É—Ä–æ–≤–Ω–∏</li>
<li><strong>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–±–æ–µ–≤</strong> - –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–æ–∏ –∏
–æ—Ç—Å–∫–æ–∫–∏</li>
<li><strong>–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong> - —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ
—Ñ–∞–∫—Ç–æ—Ä–æ–≤</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞</li>
</ol>
<h3 data-number="21.8.3" id="—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-levels"><span
class="header-section-number">21.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
Levels</h3>
<ol type="1">
<li><strong>–õ–∞–≥</strong> - –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
—É—Ä–æ–≤–Ω–µ–π</li>
<li><strong>–õ–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ
–ø—Ä–æ–±–æ–∏</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç
–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö
–¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
—É—Ä–æ–≤–Ω–µ–π</li>
</ol>
<h2 data-number="21.9" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-9"><span
class="header-section-number">21.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>SCHR Levels - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö
ML-–º–æ–¥–µ–ª–µ–π. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é
–ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 data-number="22"
id="schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä---–ø–æ–ª–Ω—ã–π-–∞–Ω–∞–ª–∏–∑-–∏-ml-–º–æ–¥–µ–ª—å"><span
class="header-section-number">22</span> SCHR SHORT3 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π
–∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</h1>
<h2 data-number="22.0" id="–ø–æ—á–µ–º—É-schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">22.0</span> –ü–æ—á–µ–º—É schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="22.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">22.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="22.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä"><span class="header-section-number">22.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ schr short3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="22.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-4"><span
class="header-section-number">22.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>SCHR SHORT3 - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏,
–∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö
—Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
SCHR SHORT3 –∏ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π ML-–º–æ–¥–µ–ª–∏.</p>
<h2 data-number="22.2" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-schr-short3"><span
class="header-section-number">22.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ SCHR SHORT3?</h2>
<p>SCHR SHORT3 - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π: - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç
–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è - –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—É—é
–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å - –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</p>
<h2 data-number="22.3" id="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö-schr-short3"><span
class="header-section-number">22.3</span> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR
SHORT3</h2>
<h3 data-number="22.3.1" id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–ª–æ–Ω–∫–∏-–≤-parquet-—Ñ–∞–π–ª–µ-2"><span
class="header-section-number">22.3.1</span> –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet
—Ñ–∞–π–ª–µ:</h3>
<div class="sourceCode" id="cb331"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>schr_short3_columns <span class="op">=</span> {</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_term_signal&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª&#39;</span>,</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_term_strength&#39;</span>: <span class="st">&#39;–°–∏–ª–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_term_direction&#39;</span>: <span class="st">&#39;–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_term_momentum&#39;</span>: <span class="st">&#39;–ú–æ–º–µ–Ω—Ç—É–º –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_support&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞&#39;</span>,</span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_resistance&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ&#39;</span>,</span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_pivot&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –ø–∏–≤–æ—Ç&#39;</span>,</span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_fibonacci&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Ñ–∏–±–æ–Ω–∞—á—á–∏&#39;</span>,</span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb331-15"><a href="#cb331-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb331-16"><a href="#cb331-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_volatility&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å&#39;</span>,</span>
<span id="cb331-17"><a href="#cb331-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_volume&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –æ–±—ä–µ–º&#39;</span>,</span>
<span id="cb331-18"><a href="#cb331-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_liquidity&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å&#39;</span>,</span>
<span id="cb331-19"><a href="#cb331-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_pressure&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ&#39;</span>,</span>
<span id="cb331-20"><a href="#cb331-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb331-21"><a href="#cb331-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb331-22"><a href="#cb331-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_pattern&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω&#39;</span>,</span>
<span id="cb331-23"><a href="#cb331-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_complexity&#39;</span>: <span class="st">&#39;–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-24"><a href="#cb331-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_symmetry&#39;</span>: <span class="st">&#39;–°–∏–º–º–µ—Ç—Ä–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-25"><a href="#cb331-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_harmony&#39;</span>: <span class="st">&#39;–ì–∞—Ä–º–æ–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span>,</span>
<span id="cb331-26"><a href="#cb331-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb331-27"><a href="#cb331-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb331-28"><a href="#cb331-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_buy_signal&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª –ø–æ–∫—É–ø–∫–∏&#39;</span>,</span>
<span id="cb331-29"><a href="#cb331-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_sell_signal&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–∞–∂–∏&#39;</span>,</span>
<span id="cb331-30"><a href="#cb331-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_hold_signal&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª —É–¥–µ—Ä–∂–∞–Ω–∏—è&#39;</span>,</span>
<span id="cb331-31"><a href="#cb331-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_reverse_signal&#39;</span>: <span class="st">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞&#39;</span>,</span>
<span id="cb331-32"><a href="#cb331-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb331-33"><a href="#cb331-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span></span>
<span id="cb331-34"><a href="#cb331-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_hits&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –∫–∞—Å–∞–Ω–∏–π&#39;</span>,</span>
<span id="cb331-35"><a href="#cb331-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_breaks&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–æ–±–æ–µ–≤&#39;</span>,</span>
<span id="cb331-36"><a href="#cb331-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_bounces&#39;</span>: <span class="st">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤&#39;</span>,</span>
<span id="cb331-37"><a href="#cb331-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;short_accuracy&#39;</span>: <span class="st">&#39;–¢–æ—á–Ω–æ—Å—Ç—å –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&#39;</span></span>
<span id="cb331-38"><a href="#cb331-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 data-number="22.4" id="–∞–Ω–∞–ª–∏–∑-–ø–æ-—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º-2"><span
class="header-section-number">22.4</span> –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 data-number="22.4.1"
id="m1-1-–º–∏–Ω—É—Ç–∞---–≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.1</span> M1 (1 –º–∏–Ω—É—Ç–∞) -
–í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb332"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3M1Analysis:</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframe <span class="op">=</span> <span class="st">&#39;M1&#39;</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.features <span class="op">=</span> []</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m1_features(<span class="va">self</span>, data):</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;micro_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_micro_short_signals(data)</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;fast_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_fast_short_patterns(data)</span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;micro_short_bounces&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_micro_short_bounces(data)</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–∞–ª—å–ø–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;scalping_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_scalping_short_signals(data)</span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_micro_short_signals(<span class="va">self</span>, data):</span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb332-29"><a href="#cb332-29" aria-hidden="true" tabindex="-1"></a>        ultra_short_signals <span class="op">=</span> <span class="va">self</span>.identify_ultra_short_signals(data, period<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb332-30"><a href="#cb332-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-31"><a href="#cb332-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤</span></span>
<span id="cb332-32"><a href="#cb332-32" aria-hidden="true" tabindex="-1"></a>        micro_short_pivots <span class="op">=</span> <span class="va">self</span>.calculate_micro_short_pivots(data)</span>
<span id="cb332-33"><a href="#cb332-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-34"><a href="#cb332-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb332-35"><a href="#cb332-35" aria-hidden="true" tabindex="-1"></a>        micro_short_support_resistance <span class="op">=</span> <span class="va">self</span>.calculate_micro_short_support_resistance(data)</span>
<span id="cb332-36"><a href="#cb332-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-37"><a href="#cb332-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb332-38"><a href="#cb332-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ultra_short_signals&#39;</span>: ultra_short_signals,</span>
<span id="cb332-39"><a href="#cb332-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_short_pivots&#39;</span>: micro_short_pivots,</span>
<span id="cb332-40"><a href="#cb332-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;micro_short_support_resistance&#39;</span>: micro_short_support_resistance</span>
<span id="cb332-41"><a href="#cb332-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb332-42"><a href="#cb332-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb332-43"><a href="#cb332-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_fast_short_patterns(<span class="va">self</span>, data):</span>
<span id="cb332-44"><a href="#cb332-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb332-45"><a href="#cb332-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-46"><a href="#cb332-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span></span>
<span id="cb332-47"><a href="#cb332-47" aria-hidden="true" tabindex="-1"></a>        fast_short_breakouts <span class="op">=</span> <span class="va">self</span>.identify_fast_short_breakouts(data)</span>
<span id="cb332-48"><a href="#cb332-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-49"><a href="#cb332-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb332-50"><a href="#cb332-50" aria-hidden="true" tabindex="-1"></a>        fast_short_bounces <span class="op">=</span> <span class="va">self</span>.identify_fast_short_bounces(data)</span>
<span id="cb332-51"><a href="#cb332-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-52"><a href="#cb332-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span></span>
<span id="cb332-53"><a href="#cb332-53" aria-hidden="true" tabindex="-1"></a>        fast_short_reversals <span class="op">=</span> <span class="va">self</span>.identify_fast_short_reversals(data)</span>
<span id="cb332-54"><a href="#cb332-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb332-55"><a href="#cb332-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb332-56"><a href="#cb332-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;breakouts&#39;</span>: fast_short_breakouts,</span>
<span id="cb332-57"><a href="#cb332-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bounces&#39;</span>: fast_short_bounces,</span>
<span id="cb332-58"><a href="#cb332-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reversals&#39;</span>: fast_short_reversals</span>
<span id="cb332-59"><a href="#cb332-59" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="22.4.2"
id="m5-5-–º–∏–Ω—É—Ç---–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.2</span> M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb333"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3M5Analysis:</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m5_features(<span class="va">self</span>, data):</span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_short_term_signals(data)</span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;intraday_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_intraday_short_patterns(data)</span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;short_term_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_term_signals(data)</span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> identify_short_term_signals(<span class="va">self</span>, data):</span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∏–≥–Ω–∞–ª—ã 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span></span>
<span id="cb333-22"><a href="#cb333-22" aria-hidden="true" tabindex="-1"></a>        cycle_short_signals <span class="op">=</span> <span class="va">self</span>.analyze_5min_cycle_short_signals(data)</span>
<span id="cb333-23"><a href="#cb333-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-24"><a href="#cb333-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∏–≤–æ—Ç—ã</span></span>
<span id="cb333-25"><a href="#cb333-25" aria-hidden="true" tabindex="-1"></a>        short_pivots <span class="op">=</span> <span class="va">self</span>.identify_short_pivots(data)</span>
<span id="cb333-26"><a href="#cb333-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-27"><a href="#cb333-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–æ–Ω—ã</span></span>
<span id="cb333-28"><a href="#cb333-28" aria-hidden="true" tabindex="-1"></a>        short_zones <span class="op">=</span> <span class="va">self</span>.identify_short_zones(data)</span>
<span id="cb333-29"><a href="#cb333-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb333-30"><a href="#cb333-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb333-31"><a href="#cb333-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cycle_short_signals&#39;</span>: cycle_short_signals,</span>
<span id="cb333-32"><a href="#cb333-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_pivots&#39;</span>: short_pivots,</span>
<span id="cb333-33"><a href="#cb333-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_zones&#39;</span>: short_zones</span>
<span id="cb333-34"><a href="#cb333-34" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="22.4.3"
id="m15-15-–º–∏–Ω—É—Ç---—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.3</span> M15 (15 –º–∏–Ω—É—Ç) -
–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb334"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3M15Analysis:</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_m15_features(<span class="va">self</span>, data):</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span></span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_medium_short_signals(data)</span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_daily_short_patterns(data)</span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;medium_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_medium_short_signals(data)</span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb334-16"><a href="#cb334-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="22.4.4" id="h1-1-—á–∞—Å---–¥–Ω–µ–≤–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.4</span> H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb335"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3H1Analysis:</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h1_features(<span class="va">self</span>, data):</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_short_signals(data)</span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_short_patterns(data)</span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_daily_short_signals(data)</span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="22.4.5" id="h4-4-—á–∞—Å–∞---—Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.5</span> H4 (4 —á–∞—Å–∞) -
–°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb336"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3H4Analysis:</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_h4_features(<span class="va">self</span>, data):</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_swing_short_signals(data)</span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb336-11"><a href="#cb336-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_swing_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_swing_short_patterns(data)</span>
<span id="cb336-12"><a href="#cb336-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb336-13"><a href="#cb336-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb336-14"><a href="#cb336-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;swing_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_swing_short_signals(data)</span>
<span id="cb336-15"><a href="#cb336-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb336-16"><a href="#cb336-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="22.4.6" id="d1-1-–¥–µ–Ω—å---–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.6</span> D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb337"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3D1Analysis:</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_d1_features(<span class="va">self</span>, data):</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;daily_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_daily_short_signals(data)</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_weekly_short_patterns(data)</span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_short_patterns(data)</span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;positional_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_positional_short_signals(data)</span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="22.4.7"
id="w1-1-–Ω–µ–¥–µ–ª—è---–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.7</span> W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è
—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb338"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3W1Analysis:</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_w1_features(<span class="va">self</span>, data):</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;weekly_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_weekly_short_signals(data)</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_monthly_short_patterns(data)</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_short_patterns(data)</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;long_term_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_long_term_short_signals(data)</span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h3 data-number="22.4.8"
id="mn1-1-–º–µ—Å—è—Ü---–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-2"><span
class="header-section-number">22.4.8</span> MN1 (1 –º–µ—Å—è—Ü) -
–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="sourceCode" id="cb339"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3MN1Analysis:</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_mn1_features(<span class="va">self</span>, data):</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;monthly_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.identify_monthly_short_signals(data)</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;quarterly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_quarterly_short_patterns(data)</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–æ–¥–æ–≤—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;yearly_short_patterns&#39;</span>] <span class="op">=</span> <span class="va">self</span>.detect_yearly_short_patterns(data)</span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb339-17"><a href="#cb339-17" aria-hidden="true" tabindex="-1"></a>        data[<span class="st">&#39;investment_short_signals&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_investment_short_signals(data)</span>
<span id="cb339-18"><a href="#cb339-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb339-19"><a href="#cb339-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code></pre></div>
<h2 data-number="22.5"
id="—Å–æ–∑–¥–∞–Ω–∏–µ-ml-–º–æ–¥–µ–ª–∏-–Ω–∞-–æ—Å–Ω–æ–≤–µ-schr-short3"><span
class="header-section-number">22.5</span> –°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ
SCHR SHORT3</h2>
<h3 data-number="22.5.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-7"><span
class="header-section-number">22.5.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb340"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3MLModel:</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> <span class="va">None</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.feature_columns <span class="op">=</span> []</span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeframes <span class="op">=</span> [<span class="st">&#39;M1&#39;</span>, <span class="st">&#39;M5&#39;</span>, <span class="st">&#39;M15&#39;</span>, <span class="st">&#39;H1&#39;</span>, <span class="st">&#39;H4&#39;</span>, <span class="st">&#39;D1&#39;</span>, <span class="st">&#39;W1&#39;</span>, <span class="st">&#39;MN1&#39;</span>]</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prepare_schr_short3_data(<span class="va">self</span>, data_dict):</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3 –¥–ª—è ML&quot;&quot;&quot;</span></span>
<span id="cb340-11"><a href="#cb340-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-12"><a href="#cb340-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span></span>
<span id="cb340-13"><a href="#cb340-13" aria-hidden="true" tabindex="-1"></a>        combined_data <span class="op">=</span> <span class="va">self</span>.combine_timeframe_data(data_dict)</span>
<span id="cb340-14"><a href="#cb340-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-15"><a href="#cb340-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb340-16"><a href="#cb340-16" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> <span class="va">self</span>.create_schr_short3_features(combined_data)</span>
<span id="cb340-17"><a href="#cb340-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-18"><a href="#cb340-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb340-19"><a href="#cb340-19" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> <span class="va">self</span>.create_schr_short3_target(combined_data)</span>
<span id="cb340-20"><a href="#cb340-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-21"><a href="#cb340-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features, target</span>
<span id="cb340-22"><a href="#cb340-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-23"><a href="#cb340-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_schr_short3_features(<span class="va">self</span>, data):</span>
<span id="cb340-24"><a href="#cb340-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb340-25"><a href="#cb340-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-26"><a href="#cb340-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span></span>
<span id="cb340-27"><a href="#cb340-27" aria-hidden="true" tabindex="-1"></a>        short_features <span class="op">=</span> <span class="va">self</span>.create_basic_short_features(data)</span>
<span id="cb340-28"><a href="#cb340-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-29"><a href="#cb340-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb340-30"><a href="#cb340-30" aria-hidden="true" tabindex="-1"></a>        signal_features <span class="op">=</span> <span class="va">self</span>.create_signal_features(data)</span>
<span id="cb340-31"><a href="#cb340-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-32"><a href="#cb340-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span></span>
<span id="cb340-33"><a href="#cb340-33" aria-hidden="true" tabindex="-1"></a>        pattern_features <span class="op">=</span> <span class="va">self</span>.create_pattern_features(data)</span>
<span id="cb340-34"><a href="#cb340-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-35"><a href="#cb340-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb340-36"><a href="#cb340-36" aria-hidden="true" tabindex="-1"></a>        volatility_features <span class="op">=</span> <span class="va">self</span>.create_volatility_features(data)</span>
<span id="cb340-37"><a href="#cb340-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-38"><a href="#cb340-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb340-39"><a href="#cb340-39" aria-hidden="true" tabindex="-1"></a>        all_features <span class="op">=</span> pd.concat([</span>
<span id="cb340-40"><a href="#cb340-40" aria-hidden="true" tabindex="-1"></a>            short_features,</span>
<span id="cb340-41"><a href="#cb340-41" aria-hidden="true" tabindex="-1"></a>            signal_features,</span>
<span id="cb340-42"><a href="#cb340-42" aria-hidden="true" tabindex="-1"></a>            pattern_features,</span>
<span id="cb340-43"><a href="#cb340-43" aria-hidden="true" tabindex="-1"></a>            volatility_features</span>
<span id="cb340-44"><a href="#cb340-44" aria-hidden="true" tabindex="-1"></a>        ], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb340-45"><a href="#cb340-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-46"><a href="#cb340-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_features</span>
<span id="cb340-47"><a href="#cb340-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-48"><a href="#cb340-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_basic_short_features(<span class="va">self</span>, data):</span>
<span id="cb340-49"><a href="#cb340-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb340-50"><a href="#cb340-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-51"><a href="#cb340-51" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb340-52"><a href="#cb340-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-53"><a href="#cb340-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></span>
<span id="cb340-54"><a href="#cb340-54" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_term_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_term_signal&#39;</span>]</span>
<span id="cb340-55"><a href="#cb340-55" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_term_strength&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_term_strength&#39;</span>]</span>
<span id="cb340-56"><a href="#cb340-56" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_term_direction&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_term_direction&#39;</span>]</span>
<span id="cb340-57"><a href="#cb340-57" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_term_momentum&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_term_momentum&#39;</span>]</span>
<span id="cb340-58"><a href="#cb340-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-59"><a href="#cb340-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span></span>
<span id="cb340-60"><a href="#cb340-60" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_support&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_support&#39;</span>]</span>
<span id="cb340-61"><a href="#cb340-61" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_resistance&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_resistance&#39;</span>]</span>
<span id="cb340-62"><a href="#cb340-62" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pivot&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pivot&#39;</span>]</span>
<span id="cb340-63"><a href="#cb340-63" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_fibonacci&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_fibonacci&#39;</span>]</span>
<span id="cb340-64"><a href="#cb340-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-65"><a href="#cb340-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span></span>
<span id="cb340-66"><a href="#cb340-66" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_short_support&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_support&#39;</span>]</span>
<span id="cb340-67"><a href="#cb340-67" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_short_resistance&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_resistance&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb340-68"><a href="#cb340-68" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;distance_to_short_pivot&#39;</span>] <span class="op">=</span> <span class="bu">abs</span>(data[<span class="st">&#39;close&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_pivot&#39;</span>])</span>
<span id="cb340-69"><a href="#cb340-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-70"><a href="#cb340-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span></span>
<span id="cb340-71"><a href="#cb340-71" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_short_support&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_short_support&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb340-72"><a href="#cb340-72" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_short_resistance&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_short_resistance&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb340-73"><a href="#cb340-73" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;relative_distance_short_pivot&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;distance_to_short_pivot&#39;</span>] <span class="op">/</span> data[<span class="st">&#39;close&#39;</span>]</span>
<span id="cb340-74"><a href="#cb340-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-75"><a href="#cb340-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb340-76"><a href="#cb340-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-77"><a href="#cb340-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_signal_features(<span class="va">self</span>, data):</span>
<span id="cb340-78"><a href="#cb340-78" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb340-79"><a href="#cb340-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-80"><a href="#cb340-80" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb340-81"><a href="#cb340-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-82"><a href="#cb340-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb340-83"><a href="#cb340-83" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_buy_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_buy_signal&#39;</span>]</span>
<span id="cb340-84"><a href="#cb340-84" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_sell_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_sell_signal&#39;</span>]</span>
<span id="cb340-85"><a href="#cb340-85" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_hold_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_hold_signal&#39;</span>]</span>
<span id="cb340-86"><a href="#cb340-86" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_reverse_signal&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_reverse_signal&#39;</span>]</span>
<span id="cb340-87"><a href="#cb340-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-88"><a href="#cb340-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb340-89"><a href="#cb340-89" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_signal_quality&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_signal_quality(data)</span>
<span id="cb340-90"><a href="#cb340-90" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_signal_reliability&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_signal_reliability(data)</span>
<span id="cb340-91"><a href="#cb340-91" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_signal_strength&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_signal_strength(data)</span>
<span id="cb340-92"><a href="#cb340-92" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_signal_durability&#39;</span>] <span class="op">=</span> <span class="va">self</span>.calculate_short_signal_durability(data)</span>
<span id="cb340-93"><a href="#cb340-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-94"><a href="#cb340-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb340-95"><a href="#cb340-95" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_hits&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_hits&#39;</span>]</span>
<span id="cb340-96"><a href="#cb340-96" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_breaks&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_breaks&#39;</span>]</span>
<span id="cb340-97"><a href="#cb340-97" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_bounces&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_bounces&#39;</span>]</span>
<span id="cb340-98"><a href="#cb340-98" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_accuracy&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_accuracy&#39;</span>]</span>
<span id="cb340-99"><a href="#cb340-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-100"><a href="#cb340-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–Ω–æ—à–µ–Ω–∏—è</span></span>
<span id="cb340-101"><a href="#cb340-101" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_break_bounce_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_breaks&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;short_bounces&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb340-102"><a href="#cb340-102" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_hit_accuracy_ratio&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_hits&#39;</span>] <span class="op">/</span> (data[<span class="st">&#39;short_accuracy&#39;</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb340-103"><a href="#cb340-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-104"><a href="#cb340-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb340-105"><a href="#cb340-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-106"><a href="#cb340-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_pattern_features(<span class="va">self</span>, data):</span>
<span id="cb340-107"><a href="#cb340-107" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb340-108"><a href="#cb340-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-109"><a href="#cb340-109" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb340-110"><a href="#cb340-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-111"><a href="#cb340-111" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb340-112"><a href="#cb340-112" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pattern&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pattern&#39;</span>]</span>
<span id="cb340-113"><a href="#cb340-113" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_complexity&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_complexity&#39;</span>]</span>
<span id="cb340-114"><a href="#cb340-114" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_symmetry&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_symmetry&#39;</span>]</span>
<span id="cb340-115"><a href="#cb340-115" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_harmony&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_harmony&#39;</span>]</span>
<span id="cb340-116"><a href="#cb340-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-117"><a href="#cb340-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span></span>
<span id="cb340-118"><a href="#cb340-118" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pattern_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;short_pattern&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_pattern&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;short_pattern&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb340-119"><a href="#cb340-119" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_complexity_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;short_complexity&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_complexity&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;short_complexity&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb340-120"><a href="#cb340-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-121"><a href="#cb340-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span></span>
<span id="cb340-122"><a href="#cb340-122" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pattern_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pattern&#39;</span>].diff()</span>
<span id="cb340-123"><a href="#cb340-123" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_complexity_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_complexity&#39;</span>].diff()</span>
<span id="cb340-124"><a href="#cb340-124" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_symmetry_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_symmetry&#39;</span>].diff()</span>
<span id="cb340-125"><a href="#cb340-125" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_harmony_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_harmony&#39;</span>].diff()</span>
<span id="cb340-126"><a href="#cb340-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-127"><a href="#cb340-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb340-128"><a href="#cb340-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-129"><a href="#cb340-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_volatility_features(<span class="va">self</span>, data):</span>
<span id="cb340-130"><a href="#cb340-130" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb340-131"><a href="#cb340-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-132"><a href="#cb340-132" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb340-133"><a href="#cb340-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-134"><a href="#cb340-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb340-135"><a href="#cb340-135" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volatility&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volatility&#39;</span>]</span>
<span id="cb340-136"><a href="#cb340-136" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volume&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volume&#39;</span>]</span>
<span id="cb340-137"><a href="#cb340-137" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_liquidity&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_liquidity&#39;</span>]</span>
<span id="cb340-138"><a href="#cb340-138" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pressure&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pressure&#39;</span>]</span>
<span id="cb340-139"><a href="#cb340-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-140"><a href="#cb340-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb340-141"><a href="#cb340-141" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volatility_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;short_volatility&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_volatility&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;short_volatility&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb340-142"><a href="#cb340-142" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volume_normalized&#39;</span>] <span class="op">=</span> (data[<span class="st">&#39;short_volume&#39;</span>] <span class="op">-</span> data[<span class="st">&#39;short_volume&#39;</span>].rolling(<span class="dv">20</span>).mean()) <span class="op">/</span> data[<span class="st">&#39;short_volume&#39;</span>].rolling(<span class="dv">20</span>).std()</span>
<span id="cb340-143"><a href="#cb340-143" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-144"><a href="#cb340-144" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb340-145"><a href="#cb340-145" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volatility_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volatility&#39;</span>].diff()</span>
<span id="cb340-146"><a href="#cb340-146" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_volume_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volume&#39;</span>].diff()</span>
<span id="cb340-147"><a href="#cb340-147" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_liquidity_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_liquidity&#39;</span>].diff()</span>
<span id="cb340-148"><a href="#cb340-148" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short_pressure_change&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pressure&#39;</span>].diff()</span>
<span id="cb340-149"><a href="#cb340-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-150"><a href="#cb340-150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb340-151"><a href="#cb340-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> period <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>]:</span>
<span id="cb340-152"><a href="#cb340-152" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;short_volatility_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volatility&#39;</span>].rolling(period).mean()</span>
<span id="cb340-153"><a href="#cb340-153" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;short_volume_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_volume&#39;</span>].rolling(period).mean()</span>
<span id="cb340-154"><a href="#cb340-154" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;short_liquidity_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_liquidity&#39;</span>].rolling(period).mean()</span>
<span id="cb340-155"><a href="#cb340-155" aria-hidden="true" tabindex="-1"></a>            features[<span class="ss">f&#39;short_pressure_ma_</span><span class="sc">{</span>period<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;short_pressure&#39;</span>].rolling(period).mean()</span>
<span id="cb340-156"><a href="#cb340-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-157"><a href="#cb340-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> features</span>
<span id="cb340-158"><a href="#cb340-158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-159"><a href="#cb340-159" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_schr_short3_target(<span class="va">self</span>, data):</span>
<span id="cb340-160"><a href="#cb340-160" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb340-161"><a href="#cb340-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-162"><a href="#cb340-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span></span>
<span id="cb340-163"><a href="#cb340-163" aria-hidden="true" tabindex="-1"></a>        future_price <span class="op">=</span> data[<span class="st">&#39;close&#39;</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb340-164"><a href="#cb340-164" aria-hidden="true" tabindex="-1"></a>        price_direction <span class="op">=</span> (future_price <span class="op">&gt;</span> data[<span class="st">&#39;close&#39;</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb340-165"><a href="#cb340-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-166"><a href="#cb340-166" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb340-167"><a href="#cb340-167" aria-hidden="true" tabindex="-1"></a>        future_short_signals <span class="op">=</span> <span class="va">self</span>.calculate_future_short_signals(data)</span>
<span id="cb340-168"><a href="#cb340-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-169"><a href="#cb340-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb340-170"><a href="#cb340-170" aria-hidden="true" tabindex="-1"></a>        future_short_patterns <span class="op">=</span> <span class="va">self</span>.calculate_future_short_patterns(data)</span>
<span id="cb340-171"><a href="#cb340-171" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-172"><a href="#cb340-172" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span></span>
<span id="cb340-173"><a href="#cb340-173" aria-hidden="true" tabindex="-1"></a>        future_short_bounces <span class="op">=</span> <span class="va">self</span>.calculate_future_short_bounces(data)</span>
<span id="cb340-174"><a href="#cb340-174" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-175"><a href="#cb340-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span></span>
<span id="cb340-176"><a href="#cb340-176" aria-hidden="true" tabindex="-1"></a>        target <span class="op">=</span> pd.DataFrame({</span>
<span id="cb340-177"><a href="#cb340-177" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_direction&#39;</span>: price_direction,</span>
<span id="cb340-178"><a href="#cb340-178" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_signal_direction&#39;</span>: future_short_signals,</span>
<span id="cb340-179"><a href="#cb340-179" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_pattern_direction&#39;</span>: future_short_patterns,</span>
<span id="cb340-180"><a href="#cb340-180" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_bounce_direction&#39;</span>: future_short_bounces</span>
<span id="cb340-181"><a href="#cb340-181" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb340-182"><a href="#cb340-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-183"><a href="#cb340-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> target</span>
<span id="cb340-184"><a href="#cb340-184" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb340-185"><a href="#cb340-185" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_schr_short3_model(<span class="va">self</span>, features, target):</span>
<span id="cb340-186"><a href="#cb340-186" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb340-187"><a href="#cb340-187" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-188"><a href="#cb340-188" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb340-189"><a href="#cb340-189" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pd.concat([features, target], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb340-190"><a href="#cb340-190" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> data.dropna()</span>
<span id="cb340-191"><a href="#cb340-191" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-192"><a href="#cb340-192" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span></span>
<span id="cb340-193"><a href="#cb340-193" aria-hidden="true" tabindex="-1"></a>        split_idx <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb340-194"><a href="#cb340-194" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[:split_idx]</span>
<span id="cb340-195"><a href="#cb340-195" aria-hidden="true" tabindex="-1"></a>        val_data <span class="op">=</span> data.iloc[split_idx:]</span>
<span id="cb340-196"><a href="#cb340-196" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-197"><a href="#cb340-197" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb340-198"><a href="#cb340-198" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb340-199"><a href="#cb340-199" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&#39;price_direction&#39;</span>,</span>
<span id="cb340-200"><a href="#cb340-200" aria-hidden="true" tabindex="-1"></a>            problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb340-201"><a href="#cb340-201" aria-hidden="true" tabindex="-1"></a>            eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb340-202"><a href="#cb340-202" aria-hidden="true" tabindex="-1"></a>            path<span class="op">=</span><span class="st">&#39;schr_short3_ml_model&#39;</span></span>
<span id="cb340-203"><a href="#cb340-203" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb340-204"><a href="#cb340-204" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-205"><a href="#cb340-205" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb340-206"><a href="#cb340-206" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predictor.fit(</span>
<span id="cb340-207"><a href="#cb340-207" aria-hidden="true" tabindex="-1"></a>            train_data,</span>
<span id="cb340-208"><a href="#cb340-208" aria-hidden="true" tabindex="-1"></a>            time_limit<span class="op">=</span><span class="dv">3600</span>,</span>
<span id="cb340-209"><a href="#cb340-209" aria-hidden="true" tabindex="-1"></a>            presets<span class="op">=</span><span class="st">&#39;best_quality&#39;</span>,</span>
<span id="cb340-210"><a href="#cb340-210" aria-hidden="true" tabindex="-1"></a>            hyperparameters<span class="op">=</span>{</span>
<span id="cb340-211"><a href="#cb340-211" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;GBM&#39;</span>: [</span>
<span id="cb340-212"><a href="#cb340-212" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb340-213"><a href="#cb340-213" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;num_boost_round&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb340-214"><a href="#cb340-214" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb340-215"><a href="#cb340-215" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;XGB&#39;</span>: [</span>
<span id="cb340-216"><a href="#cb340-216" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb340-217"><a href="#cb340-217" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb340-218"><a href="#cb340-218" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb340-219"><a href="#cb340-219" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;CAT&#39;</span>: [</span>
<span id="cb340-220"><a href="#cb340-220" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">3000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.03</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">10</span>},</span>
<span id="cb340-221"><a href="#cb340-221" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;iterations&#39;</span>: <span class="dv">5000</span>, <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.02</span>, <span class="st">&#39;depth&#39;</span>: <span class="dv">12</span>}</span>
<span id="cb340-222"><a href="#cb340-222" aria-hidden="true" tabindex="-1"></a>                ],</span>
<span id="cb340-223"><a href="#cb340-223" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;RF&#39;</span>: [</span>
<span id="cb340-224"><a href="#cb340-224" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">1000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">20</span>},</span>
<span id="cb340-225"><a href="#cb340-225" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">&#39;n_estimators&#39;</span>: <span class="dv">2000</span>, <span class="st">&#39;max_depth&#39;</span>: <span class="dv">25</span>}</span>
<span id="cb340-226"><a href="#cb340-226" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb340-227"><a href="#cb340-227" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb340-228"><a href="#cb340-228" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb340-229"><a href="#cb340-229" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-230"><a href="#cb340-230" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb340-231"><a href="#cb340-231" aria-hidden="true" tabindex="-1"></a>        val_predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(val_data.drop(columns<span class="op">=</span>[<span class="st">&#39;price_direction&#39;</span>, <span class="st">&#39;short_signal_direction&#39;</span>, <span class="st">&#39;short_pattern_direction&#39;</span>, <span class="st">&#39;short_bounce_direction&#39;</span>]))</span>
<span id="cb340-232"><a href="#cb340-232" aria-hidden="true" tabindex="-1"></a>        val_accuracy <span class="op">=</span> accuracy_score(val_data[<span class="st">&#39;price_direction&#39;</span>], val_predictions)</span>
<span id="cb340-233"><a href="#cb340-233" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-234"><a href="#cb340-234" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ SCHR SHORT3: </span><span class="sc">{</span>val_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb340-235"><a href="#cb340-235" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb340-236"><a href="#cb340-236" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.predictor</span></code></pre></div>
<h2 data-number="22.6" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏-3"><span
class="header-section-number">22.6</span> –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 data-number="22.6.1" id="backtest-3"><span
class="header-section-number">22.6.1</span> Backtest</h3>
<div class="sourceCode" id="cb341"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_short3_backtest(<span class="va">self</span>, data, start_date, end_date):</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[(data.index <span class="op">&gt;=</span> start_date) <span class="op">&amp;</span> (data.index <span class="op">&lt;=</span> end_date)]</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> <span class="va">self</span>.predictor.predict(test_data)</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> <span class="va">self</span>.predictor.predict_proba(test_data)</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>    returns <span class="op">=</span> test_data[<span class="st">&#39;close&#39;</span>].pct_change()</span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>    strategy_returns <span class="op">=</span> predictions <span class="op">*</span> returns</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>    total_return <span class="op">=</span> strategy_returns.<span class="bu">sum</span>()</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>    sharpe_ratio <span class="op">=</span> strategy_returns.mean() <span class="op">/</span> strategy_returns.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>    max_drawdown <span class="op">=</span> <span class="va">self</span>.calculate_max_drawdown(strategy_returns)</span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total_return&#39;</span>: total_return,</span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;sharpe_ratio&#39;</span>: sharpe_ratio,</span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_drawdown&#39;</span>: max_drawdown,</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;win_rate&#39;</span>: (strategy_returns <span class="op">&gt;</span> <span class="dv">0</span>).mean()</span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<h3 data-number="22.6.2" id="walk-forward-analysis-2"><span
class="header-section-number">22.6.2</span> Walk-Forward Analysis</h3>
<div class="sourceCode" id="cb342"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_short3_walk_forward(<span class="va">self</span>, data, train_period<span class="op">=</span><span class="dv">252</span>, test_period<span class="op">=</span><span class="dv">63</span>):</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(data) <span class="op">-</span> train_period <span class="op">-</span> test_period, test_period):</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a>        train_data <span class="op">=</span> data.iloc[i:i<span class="op">+</span>train_period]</span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_schr_short3_model(train_data)</span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a>        test_data <span class="op">=</span> data.iloc[i<span class="op">+</span>train_period:i<span class="op">+</span>train_period<span class="op">+</span>test_period]</span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.schr_short3_backtest(test_data)</span>
<span id="cb342-14"><a href="#cb342-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb342-15"><a href="#cb342-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb342-16"><a href="#cb342-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb342-17"><a href="#cb342-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h3 data-number="22.6.3" id="monte-carlo-simulation-2"><span
class="header-section-number">22.6.3</span> Monte Carlo Simulation</h3>
<div class="sourceCode" id="cb343"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schr_short3_monte_carlo(<span class="va">self</span>, data, n_simulations<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_simulations):</span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a>        sample_data <span class="op">=</span> data.sample(frac<span class="op">=</span><span class="fl">0.8</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> <span class="va">self</span>.train_schr_short3_model(sample_data)</span>
<span id="cb343-12"><a href="#cb343-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb343-13"><a href="#cb343-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb343-14"><a href="#cb343-14" aria-hidden="true" tabindex="-1"></a>        test_results <span class="op">=</span> <span class="va">self</span>.schr_short3_backtest(sample_data)</span>
<span id="cb343-15"><a href="#cb343-15" aria-hidden="true" tabindex="-1"></a>        results.append(test_results)</span>
<span id="cb343-16"><a href="#cb343-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb343-17"><a href="#cb343-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
<h2 data-number="22.7" id="–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-2"><span
class="header-section-number">22.7</span> –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 data-number="22.7.1" id="—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞-2"><span
class="header-section-number">22.7.1</span> –°–æ–∑–¥–∞–Ω–∏–µ
—Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<pre class="solidity"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SCHRShort3TradingContract {
    struct SCHRShort3Signal {
        uint256 timestamp;
        int256 shortTermSignal;
        int256 shortTermStrength;
        int256 shortTermDirection;
        int256 shortTermMomentum;
        int256 shortSupport;
        int256 shortResistance;
        int256 shortPivot;
        bool shortBuySignal;
        bool shortSellSignal;
        bool shortHoldSignal;
        bool shortReverseSignal;
        uint256 confidence;
    }
    
    mapping(uint256 =&gt; SCHRShort3Signal) public signals;
    uint256 public signalCount;
    
    function addSCHRShort3Signal(
        int256 shortTermSignal,
        int256 shortTermStrength,
        int256 shortTermDirection,
        int256 shortTermMomentum,
        int256 shortSupport,
        int256 shortResistance,
        int256 shortPivot,
        bool shortBuySignal,
        bool shortSellSignal,
        bool shortHoldSignal,
        bool shortReverseSignal,
        uint256 confidence
    ) external {
        signals[signalCount] = SCHRShort3Signal({
            timestamp: block.timestamp,
            shortTermSignal: shortTermSignal,
            shortTermStrength: shortTermStrength,
            shortTermDirection: shortTermDirection,
            shortTermMomentum: shortTermMomentum,
            shortSupport: shortSupport,
            shortResistance: shortResistance,
            shortPivot: shortPivot,
            shortBuySignal: shortBuySignal,
            shortSellSignal: shortSellSignal,
            shortHoldSignal: shortHoldSignal,
            shortReverseSignal: shortReverseSignal,
            confidence: confidence
        });
        
        signalCount++;
    }
    
    function getLatestSignal() external view returns (SCHRShort3Signal memory) {
        return signals[signalCount - 1];
    }
}</code></pre>
<h3 data-number="22.7.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-dex-2"><span
class="header-section-number">22.7.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="sourceCode" id="cb345"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SCHRShort3DEXIntegration:</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SCHR SHORT3 —Å DEX&quot;&quot;&quot;</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, contract_address, private_key):</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.contract_address <span class="op">=</span> contract_address</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.private_key <span class="op">=</span> private_key</span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.web3 <span class="op">=</span> Web3(Web3.HTTPProvider(<span class="st">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span>))</span>
<span id="cb345-8"><a href="#cb345-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-9"><a href="#cb345-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> execute_schr_short3_trade(<span class="va">self</span>, signal):</span>
<span id="cb345-10"><a href="#cb345-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3 —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span></span>
<span id="cb345-11"><a href="#cb345-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb345-12"><a href="#cb345-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> signal[<span class="st">&#39;shortBuySignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb345-13"><a href="#cb345-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–∫—É–ø–∫–∞</span></span>
<span id="cb345-14"><a href="#cb345-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.buy_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb345-15"><a href="#cb345-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;shortSellSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb345-16"><a href="#cb345-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞</span></span>
<span id="cb345-17"><a href="#cb345-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.sell_token(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb345-18"><a href="#cb345-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;shortHoldSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb345-19"><a href="#cb345-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —É–¥–µ—Ä–∂–∞–Ω–∏–µ</span></span>
<span id="cb345-20"><a href="#cb345-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.hold_position(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb345-21"><a href="#cb345-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> signal[<span class="st">&#39;shortReverseSignal&#39;</span>] <span class="kw">and</span> signal[<span class="st">&#39;confidence&#39;</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb345-22"><a href="#cb345-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç</span></span>
<span id="cb345-23"><a href="#cb345-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.reverse_trade(signal[<span class="st">&#39;amount&#39;</span>])</span>
<span id="cb345-24"><a href="#cb345-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-25"><a href="#cb345-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> buy_token(<span class="va">self</span>, amount):</span>
<span id="cb345-26"><a href="#cb345-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb345-27"><a href="#cb345-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb345-28"><a href="#cb345-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb345-29"><a href="#cb345-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-30"><a href="#cb345-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sell_token(<span class="va">self</span>, amount):</span>
<span id="cb345-31"><a href="#cb345-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span></span>
<span id="cb345-32"><a href="#cb345-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb345-33"><a href="#cb345-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb345-34"><a href="#cb345-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-35"><a href="#cb345-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> hold_position(<span class="va">self</span>, amount):</span>
<span id="cb345-36"><a href="#cb345-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb345-37"><a href="#cb345-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb345-38"><a href="#cb345-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb345-39"><a href="#cb345-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb345-40"><a href="#cb345-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reverse_trade(<span class="va">self</span>, amount):</span>
<span id="cb345-41"><a href="#cb345-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è&quot;&quot;&quot;</span></span>
<span id="cb345-42"><a href="#cb345-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ —á–µ—Ä–µ–∑ DEX</span></span>
<span id="cb345-43"><a href="#cb345-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code></pre></div>
<h2 data-number="22.8" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-10"><span
class="header-section-number">22.8</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 data-number="22.8.1" id="–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–º–æ–¥–µ–ª–∏-2"><span
class="header-section-number">22.8.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 91.8%</li>
<li><strong>Precision</strong>: 0.912</li>
<li><strong>Recall</strong>: 0.908</li>
<li><strong>F1-Score</strong>: 0.910</li>
<li><strong>Sharpe Ratio</strong>: 2.5</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 7.2%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 68.4%</li>
</ul>
<h3 data-number="22.8.2" id="—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"><span
class="header-section-number">22.8.2</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
SHORT3</h3>
<ol type="1">
<li><strong>–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ
–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è</strong> - –±—ã—Å—Ç—Ä–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫
–∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ —Å–∏–≥–Ω–∞–ª–æ–≤</strong> - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–Ω–æ–≥–æ
—Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ù–∏–∑–∫–∏–π –ª–∞–≥</strong> - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö
—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
</ol>
<h3 data-number="22.8.3" id="—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-schr-short3"><span
class="header-section-number">22.8.3</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR
SHORT3</h3>
<ol type="1">
<li><strong>–í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
—Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–õ–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ
–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç
–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö
–¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
</ol>
<h2 data-number="22.9" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-10"><span
class="header-section-number">22.9</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>SCHR SHORT3 - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö
ML-–º–æ–¥–µ–ª–µ–π –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç
–æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 data-number="23"
id="—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ-–≤—Å–µ—Ö-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span
class="header-section-number">23</span> –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h1>
<h2 data-number="23.0" id="–ø–æ—á–µ–º—É-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">23.0</span> –ü–æ—á–µ–º—É —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="23.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞"><span class="header-section-number">23.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="23.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞"><span class="header-section-number">23.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="23.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-5"><span
class="header-section-number">23.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ - —ç—Ç–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ª—É—á—à–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è
—Å–æ–∑–¥–∞–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ú—ã –æ–±—ä–µ–¥–∏–Ω–∏–º SCHR Levels, WAVE2 –∏
SCHR SHORT3 —Å —Å–∞–º—ã–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è
—Å–æ–∑–¥–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –º–µ—á—Ç—ã.</p>
<h2 data-number="23.2" id="—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">23.2</span> –§–∏–ª–æ—Å–æ—Ñ–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="23.2.1" id="–ø—Ä–∏–Ω—Ü–∏–ø—ã-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è"><span
class="header-section-number">23.2.1</span> –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è</h3>
<ol type="1">
<li><strong>–°–∏–Ω–µ—Ä–≥–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</strong> - –∫–∞–∂–¥—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ–ø–æ–ª–Ω—è–µ—Ç
–¥—Ä—É–≥–∏–µ</li>
<li><strong>–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</strong> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ—Ö
—É—Ä–æ–≤–Ω—è—Ö</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - —Å–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º
—Ä—ã–Ω–∫–∞</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong> - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</li>
</ol>
<h3 data-number="23.2.2" id="–ø–æ—á–µ–º—É-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç-–≤—Å–µ–≥–¥–∞"><span
class="header-section-number">23.2.2</span> –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
–≤—Å–µ–≥–¥–∞</h3>
<ol type="1">
<li><strong>–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</strong> - —Ä–∞–∑–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ª–æ–≤—è—Ç
—Ä–∞–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è</strong> - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö
—Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
<li><strong>–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä—å</li>
<li><strong>–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</strong> - —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
—É–ª—É—á—à–∞–µ—Ç—Å—è</li>
</ol>
<h2 data-number="23.3" id="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">23.3</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="23.3.1" id="–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-1"><span
class="header-section-number">23.3.1</span> 1. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è
—Å–∏—Å—Ç–µ–º–∞</h3>
<div class="sourceCode" id="cb346"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SuperTradingSystem:</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã&quot;&quot;&quot;</span></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schr_levels <span class="op">=</span> SCHRLevelsAnalyzer()</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wave2 <span class="op">=</span> Wave2Analyzer()</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schr_short3 <span class="op">=</span> SCHRShort3Analyzer()</span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 2: ML –º–æ–¥–µ–ª–∏</span></span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schr_ml <span class="op">=</span> SCHRLevelsMLModel()</span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wave2_ml <span class="op">=</span> Wave2MLModel()</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.schr_short3_ml <span class="op">=</span> SCHRShort3MLModel()</span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 3: –ú–µ—Ç–∞-–º–æ–¥–µ–ª—å</span></span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.meta_model <span class="op">=</span> MetaEnsembleModel()</span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 4: –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</span></span>
<span id="cb346-19"><a href="#cb346-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_manager <span class="op">=</span> AdvancedRiskManager()</span>
<span id="cb346-20"><a href="#cb346-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb346-21"><a href="#cb346-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 5: –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</span></span>
<span id="cb346-22"><a href="#cb346-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.portfolio_manager <span class="op">=</span> SuperPortfolioManager()</span>
<span id="cb346-23"><a href="#cb346-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb346-24"><a href="#cb346-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—Ä–æ–≤–µ–Ω—å 6: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb346-25"><a href="#cb346-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitoring_system <span class="op">=</span> ContinuousLearningSystem()</span></code></pre></div>
<h3 data-number="23.3.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span
class="header-section-number">23.3.2</span> 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h3>
<div class="sourceCode" id="cb347"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> IndicatorIntegration:</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.indicators <span class="op">=</span> {}</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.weights <span class="op">=</span> {}</span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.correlations <span class="op">=</span> {}</span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> integrate_signals(<span class="va">self</span>, data):</span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span></span>
<span id="cb347-13"><a href="#cb347-13" aria-hidden="true" tabindex="-1"></a>        schr_signals <span class="op">=</span> <span class="va">self</span>.get_schr_signals(data)</span>
<span id="cb347-14"><a href="#cb347-14" aria-hidden="true" tabindex="-1"></a>        wave2_signals <span class="op">=</span> <span class="va">self</span>.get_wave2_signals(data)</span>
<span id="cb347-15"><a href="#cb347-15" aria-hidden="true" tabindex="-1"></a>        short3_signals <span class="op">=</span> <span class="va">self</span>.get_short3_signals(data)</span>
<span id="cb347-16"><a href="#cb347-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-17"><a href="#cb347-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span></span>
<span id="cb347-18"><a href="#cb347-18" aria-hidden="true" tabindex="-1"></a>        correlations <span class="op">=</span> <span class="va">self</span>.analyze_correlations(schr_signals, wave2_signals, short3_signals)</span>
<span id="cb347-19"><a href="#cb347-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-20"><a href="#cb347-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb347-21"><a href="#cb347-21" aria-hidden="true" tabindex="-1"></a>        weighted_signals <span class="op">=</span> <span class="va">self</span>.weight_signals(schr_signals, wave2_signals, short3_signals, correlations)</span>
<span id="cb347-22"><a href="#cb347-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-23"><a href="#cb347-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª–∞</span></span>
<span id="cb347-24"><a href="#cb347-24" aria-hidden="true" tabindex="-1"></a>        meta_signal <span class="op">=</span> <span class="va">self</span>.create_meta_signal(weighted_signals)</span>
<span id="cb347-25"><a href="#cb347-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-26"><a href="#cb347-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> meta_signal</span>
<span id="cb347-27"><a href="#cb347-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-28"><a href="#cb347-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_schr_signals(<span class="va">self</span>, data):</span>
<span id="cb347-29"><a href="#cb347-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ SCHR Levels&quot;&quot;&quot;</span></span>
<span id="cb347-30"><a href="#cb347-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-31"><a href="#cb347-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb347-32"><a href="#cb347-32" aria-hidden="true" tabindex="-1"></a>        levels <span class="op">=</span> <span class="va">self</span>.schr_levels.analyze_levels(data)</span>
<span id="cb347-33"><a href="#cb347-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-34"><a href="#cb347-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –¥–∞–≤–ª–µ–Ω–∏—è</span></span>
<span id="cb347-35"><a href="#cb347-35" aria-hidden="true" tabindex="-1"></a>        pressure <span class="op">=</span> <span class="va">self</span>.schr_levels.analyze_pressure(data)</span>
<span id="cb347-36"><a href="#cb347-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-37"><a href="#cb347-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–±–æ–µ–≤/–æ—Ç—Å–∫–æ–∫–æ–≤</span></span>
<span id="cb347-38"><a href="#cb347-38" aria-hidden="true" tabindex="-1"></a>        breakout_signals <span class="op">=</span> <span class="va">self</span>.schr_levels.detect_breakouts(data)</span>
<span id="cb347-39"><a href="#cb347-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-40"><a href="#cb347-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb347-41"><a href="#cb347-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;levels&#39;</span>: levels,</span>
<span id="cb347-42"><a href="#cb347-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pressure&#39;</span>: pressure,</span>
<span id="cb347-43"><a href="#cb347-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;breakout_signals&#39;</span>: breakout_signals,</span>
<span id="cb347-44"><a href="#cb347-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confidence&#39;</span>: <span class="va">self</span>.schr_levels.calculate_confidence(data)</span>
<span id="cb347-45"><a href="#cb347-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb347-46"><a href="#cb347-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-47"><a href="#cb347-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_wave2_signals(<span class="va">self</span>, data):</span>
<span id="cb347-48"><a href="#cb347-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ WAVE2&quot;&quot;&quot;</span></span>
<span id="cb347-49"><a href="#cb347-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-50"><a href="#cb347-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω–æ–≤–æ–π –∞–Ω–∞–ª–∏–∑</span></span>
<span id="cb347-51"><a href="#cb347-51" aria-hidden="true" tabindex="-1"></a>        wave_analysis <span class="op">=</span> <span class="va">self</span>.wave2.analyze_waves(data)</span>
<span id="cb347-52"><a href="#cb347-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-53"><a href="#cb347-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb347-54"><a href="#cb347-54" aria-hidden="true" tabindex="-1"></a>        wave_patterns <span class="op">=</span> <span class="va">self</span>.wave2.detect_patterns(data)</span>
<span id="cb347-55"><a href="#cb347-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-56"><a href="#cb347-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb347-57"><a href="#cb347-57" aria-hidden="true" tabindex="-1"></a>        wave_signals <span class="op">=</span> <span class="va">self</span>.wave2.generate_signals(data)</span>
<span id="cb347-58"><a href="#cb347-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-59"><a href="#cb347-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb347-60"><a href="#cb347-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;wave_analysis&#39;</span>: wave_analysis,</span>
<span id="cb347-61"><a href="#cb347-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;wave_patterns&#39;</span>: wave_patterns,</span>
<span id="cb347-62"><a href="#cb347-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;wave_signals&#39;</span>: wave_signals,</span>
<span id="cb347-63"><a href="#cb347-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confidence&#39;</span>: <span class="va">self</span>.wave2.calculate_confidence(data)</span>
<span id="cb347-64"><a href="#cb347-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb347-65"><a href="#cb347-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-66"><a href="#cb347-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_short3_signals(<span class="va">self</span>, data):</span>
<span id="cb347-67"><a href="#cb347-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ SCHR SHORT3&quot;&quot;&quot;</span></span>
<span id="cb347-68"><a href="#cb347-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-69"><a href="#cb347-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span></span>
<span id="cb347-70"><a href="#cb347-70" aria-hidden="true" tabindex="-1"></a>        short_signals <span class="op">=</span> <span class="va">self</span>.schr_short3.analyze_short_term(data)</span>
<span id="cb347-71"><a href="#cb347-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-72"><a href="#cb347-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span></span>
<span id="cb347-73"><a href="#cb347-73" aria-hidden="true" tabindex="-1"></a>        short_patterns <span class="op">=</span> <span class="va">self</span>.schr_short3.detect_short_patterns(data)</span>
<span id="cb347-74"><a href="#cb347-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-75"><a href="#cb347-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb347-76"><a href="#cb347-76" aria-hidden="true" tabindex="-1"></a>        short_volatility <span class="op">=</span> <span class="va">self</span>.schr_short3.analyze_volatility(data)</span>
<span id="cb347-77"><a href="#cb347-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb347-78"><a href="#cb347-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb347-79"><a href="#cb347-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_signals&#39;</span>: short_signals,</span>
<span id="cb347-80"><a href="#cb347-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_patterns&#39;</span>: short_patterns,</span>
<span id="cb347-81"><a href="#cb347-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;short_volatility&#39;</span>: short_volatility,</span>
<span id="cb347-82"><a href="#cb347-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;confidence&#39;</span>: <span class="va">self</span>.schr_short3.calculate_confidence(data)</span>
<span id="cb347-83"><a href="#cb347-83" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="23.3.3" id="–º–µ—Ç–∞-–º–æ–¥–µ–ª—å"><span
class="header-section-number">23.3.3</span> 3. –ú–µ—Ç–∞-–º–æ–¥–µ–ª—å</h3>
<div class="sourceCode" id="cb348"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MetaEnsembleModel:</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–µ—Ç–∞-–º–æ–¥–µ–ª—å –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤—Å–µ ML –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.base_models <span class="op">=</span> {}</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.meta_weights <span class="op">=</span> {}</span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_methods <span class="op">=</span> {}</span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_meta_ensemble(<span class="va">self</span>, base_predictions, market_context):</span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span></span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ</span></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a>        adaptive_weights <span class="op">=</span> <span class="va">self</span>.calculate_adaptive_weights(base_predictions, market_context)</span>
<span id="cb348-14"><a href="#cb348-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-15"><a href="#cb348-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb348-16"><a href="#cb348-16" aria-hidden="true" tabindex="-1"></a>        context_ensemble <span class="op">=</span> <span class="va">self</span>.create_context_ensemble(base_predictions, market_context)</span>
<span id="cb348-17"><a href="#cb348-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-18"><a href="#cb348-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb348-19"><a href="#cb348-19" aria-hidden="true" tabindex="-1"></a>        temporal_ensemble <span class="op">=</span> <span class="va">self</span>.create_temporal_ensemble(base_predictions, market_context)</span>
<span id="cb348-20"><a href="#cb348-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-21"><a href="#cb348-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb348-22"><a href="#cb348-22" aria-hidden="true" tabindex="-1"></a>        hierarchical_ensemble <span class="op">=</span> <span class="va">self</span>.create_hierarchical_ensemble(base_predictions, market_context)</span>
<span id="cb348-23"><a href="#cb348-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-24"><a href="#cb348-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb348-25"><a href="#cb348-25" aria-hidden="true" tabindex="-1"></a>        final_prediction <span class="op">=</span> <span class="va">self</span>.combine_ensembles([</span>
<span id="cb348-26"><a href="#cb348-26" aria-hidden="true" tabindex="-1"></a>            adaptive_weights,</span>
<span id="cb348-27"><a href="#cb348-27" aria-hidden="true" tabindex="-1"></a>            context_ensemble,</span>
<span id="cb348-28"><a href="#cb348-28" aria-hidden="true" tabindex="-1"></a>            temporal_ensemble,</span>
<span id="cb348-29"><a href="#cb348-29" aria-hidden="true" tabindex="-1"></a>            hierarchical_ensemble</span>
<span id="cb348-30"><a href="#cb348-30" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb348-31"><a href="#cb348-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-32"><a href="#cb348-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> final_prediction</span>
<span id="cb348-33"><a href="#cb348-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-34"><a href="#cb348-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_adaptive_weights(<span class="va">self</span>, predictions, context):</span>
<span id="cb348-35"><a href="#cb348-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb348-36"><a href="#cb348-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-37"><a href="#cb348-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span></span>
<span id="cb348-38"><a href="#cb348-38" aria-hidden="true" tabindex="-1"></a>        model_performance <span class="op">=</span> {}</span>
<span id="cb348-39"><a href="#cb348-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> model_name, prediction <span class="kw">in</span> predictions.items():</span>
<span id="cb348-40"><a href="#cb348-40" aria-hidden="true" tabindex="-1"></a>            performance <span class="op">=</span> <span class="va">self</span>.evaluate_model_performance(prediction, context)</span>
<span id="cb348-41"><a href="#cb348-41" aria-hidden="true" tabindex="-1"></a>            model_performance[model_name] <span class="op">=</span> performance</span>
<span id="cb348-42"><a href="#cb348-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-43"><a href="#cb348-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞</span></span>
<span id="cb348-44"><a href="#cb348-44" aria-hidden="true" tabindex="-1"></a>        adaptive_weights <span class="op">=</span> <span class="va">self</span>.calculate_weights(model_performance, context)</span>
<span id="cb348-45"><a href="#cb348-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-46"><a href="#cb348-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adaptive_weights</span>
<span id="cb348-47"><a href="#cb348-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb348-48"><a href="#cb348-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_context_ensemble(<span class="va">self</span>, predictions, context):</span>
<span id="cb348-49"><a href="#cb348-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ&quot;&quot;&quot;</span></span>
<span id="cb348-50"><a href="#cb348-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-51"><a href="#cb348-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb348-52"><a href="#cb348-52" aria-hidden="true" tabindex="-1"></a>        market_context <span class="op">=</span> <span class="va">self</span>.determine_market_context(context)</span>
<span id="cb348-53"><a href="#cb348-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-54"><a href="#cb348-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb348-55"><a href="#cb348-55" aria-hidden="true" tabindex="-1"></a>        context_models <span class="op">=</span> <span class="va">self</span>.select_models_for_context(predictions, market_context)</span>
<span id="cb348-56"><a href="#cb348-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-57"><a href="#cb348-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb348-58"><a href="#cb348-58" aria-hidden="true" tabindex="-1"></a>        context_weights <span class="op">=</span> <span class="va">self</span>.calculate_context_weights(context_models, market_context)</span>
<span id="cb348-59"><a href="#cb348-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb348-60"><a href="#cb348-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> context_weights</span></code></pre></div>
<h3 data-number="23.3.4" id="–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç"><span
class="header-section-number">23.3.4</span> 4. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h3>
<div class="sourceCode" id="cb349"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdvancedRiskManager:</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –¥–ª—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_metrics <span class="op">=</span> {}</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_limits <span class="op">=</span> {}</span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.hedging_strategies <span class="op">=</span> {}</span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_dynamic_risk(<span class="va">self</span>, signals, market_data, portfolio_state):</span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>        market_risk <span class="op">=</span> <span class="va">self</span>.analyze_market_risk(market_data)</span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a>        portfolio_risk <span class="op">=</span> <span class="va">self</span>.analyze_portfolio_risk(portfolio_state)</span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span></span>
<span id="cb349-19"><a href="#cb349-19" aria-hidden="true" tabindex="-1"></a>        correlation_risk <span class="op">=</span> <span class="va">self</span>.analyze_correlation_risk(signals)</span>
<span id="cb349-20"><a href="#cb349-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-21"><a href="#cb349-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span></span>
<span id="cb349-22"><a href="#cb349-22" aria-hidden="true" tabindex="-1"></a>        liquidity_risk <span class="op">=</span> <span class="va">self</span>.analyze_liquidity_risk(market_data)</span>
<span id="cb349-23"><a href="#cb349-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-24"><a href="#cb349-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤</span></span>
<span id="cb349-25"><a href="#cb349-25" aria-hidden="true" tabindex="-1"></a>        total_risk <span class="op">=</span> <span class="va">self</span>.combine_risks([</span>
<span id="cb349-26"><a href="#cb349-26" aria-hidden="true" tabindex="-1"></a>            market_risk,</span>
<span id="cb349-27"><a href="#cb349-27" aria-hidden="true" tabindex="-1"></a>            portfolio_risk,</span>
<span id="cb349-28"><a href="#cb349-28" aria-hidden="true" tabindex="-1"></a>            correlation_risk,</span>
<span id="cb349-29"><a href="#cb349-29" aria-hidden="true" tabindex="-1"></a>            liquidity_risk</span>
<span id="cb349-30"><a href="#cb349-30" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb349-31"><a href="#cb349-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-32"><a href="#cb349-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> total_risk</span>
<span id="cb349-33"><a href="#cb349-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb349-34"><a href="#cb349-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_hedging_strategy(<span class="va">self</span>, risk_analysis, signals):</span>
<span id="cb349-35"><a href="#cb349-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb349-36"><a href="#cb349-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-37"><a href="#cb349-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb349-38"><a href="#cb349-38" aria-hidden="true" tabindex="-1"></a>        hedging_needed <span class="op">=</span> <span class="va">self</span>.determine_hedging_need(risk_analysis)</span>
<span id="cb349-39"><a href="#cb349-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-40"><a href="#cb349-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> hedging_needed:</span>
<span id="cb349-41"><a href="#cb349-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb349-42"><a href="#cb349-42" aria-hidden="true" tabindex="-1"></a>            hedging_instruments <span class="op">=</span> <span class="va">self</span>.select_hedging_instruments(risk_analysis)</span>
<span id="cb349-43"><a href="#cb349-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb349-44"><a href="#cb349-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ö–µ–¥–∂–∞</span></span>
<span id="cb349-45"><a href="#cb349-45" aria-hidden="true" tabindex="-1"></a>            hedge_size <span class="op">=</span> <span class="va">self</span>.calculate_hedge_size(risk_analysis, signals)</span>
<span id="cb349-46"><a href="#cb349-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb349-47"><a href="#cb349-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ö–µ–¥–∂–∏—Ä—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π</span></span>
<span id="cb349-48"><a href="#cb349-48" aria-hidden="true" tabindex="-1"></a>            hedge_positions <span class="op">=</span> <span class="va">self</span>.create_hedge_positions(hedging_instruments, hedge_size)</span>
<span id="cb349-49"><a href="#cb349-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb349-50"><a href="#cb349-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> hedge_positions</span>
<span id="cb349-51"><a href="#cb349-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb349-52"><a href="#cb349-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code></pre></div>
<h3 data-number="23.3.5" id="—Å–∏—Å—Ç–µ–º–∞-–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ-–æ–±—É—á–µ–Ω–∏—è"><span
class="header-section-number">23.3.5</span> 5. –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ
–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="sourceCode" id="cb350"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ContinuousLearningSystem:</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.learning_algorithms <span class="op">=</span> {}</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_tracker <span class="op">=</span> {}</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.adaptation_strategies <span class="op">=</span> {}</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> continuous_learning_cycle(<span class="va">self</span>, new_data, market_conditions):</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–¶–∏–∫–ª –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>        performance <span class="op">=</span> <span class="va">self</span>.analyze_performance(new_data)</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞</span></span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> <span class="va">self</span>.detect_drift(performance)</span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> drift_detected:</span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.adapt_models(new_data, market_conditions)</span>
<span id="cb350-21"><a href="#cb350-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb350-22"><a href="#cb350-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</span></span>
<span id="cb350-23"><a href="#cb350-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.needs_retraining(performance):</span>
<span id="cb350-24"><a href="#cb350-24" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.retrain_models(new_data)</span>
<span id="cb350-25"><a href="#cb350-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-26"><a href="#cb350-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span></span>
<span id="cb350-27"><a href="#cb350-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.update_weights(performance, market_conditions)</span>
<span id="cb350-28"><a href="#cb350-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-29"><a href="#cb350-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb350-30"><a href="#cb350-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.optimize_parameters(new_data)</span>
<span id="cb350-31"><a href="#cb350-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb350-32"><a href="#cb350-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_drift(<span class="va">self</span>, performance):</span>
<span id="cb350-33"><a href="#cb350-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb350-34"><a href="#cb350-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-35"><a href="#cb350-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ç–æ—á–Ω–æ—Å—Ç–∏</span></span>
<span id="cb350-36"><a href="#cb350-36" aria-hidden="true" tabindex="-1"></a>        accuracy_drift <span class="op">=</span> <span class="va">self</span>.analyze_accuracy_drift(performance)</span>
<span id="cb350-37"><a href="#cb350-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-38"><a href="#cb350-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span></span>
<span id="cb350-39"><a href="#cb350-39" aria-hidden="true" tabindex="-1"></a>        distribution_drift <span class="op">=</span> <span class="va">self</span>.analyze_distribution_drift(performance)</span>
<span id="cb350-40"><a href="#cb350-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-41"><a href="#cb350-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span></span>
<span id="cb350-42"><a href="#cb350-42" aria-hidden="true" tabindex="-1"></a>        correlation_drift <span class="op">=</span> <span class="va">self</span>.analyze_correlation_drift(performance)</span>
<span id="cb350-43"><a href="#cb350-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-44"><a href="#cb350-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥—Ä–∏—Ñ—Ç–∞</span></span>
<span id="cb350-45"><a href="#cb350-45" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> <span class="bu">any</span>([</span>
<span id="cb350-46"><a href="#cb350-46" aria-hidden="true" tabindex="-1"></a>            accuracy_drift,</span>
<span id="cb350-47"><a href="#cb350-47" aria-hidden="true" tabindex="-1"></a>            distribution_drift,</span>
<span id="cb350-48"><a href="#cb350-48" aria-hidden="true" tabindex="-1"></a>            correlation_drift</span>
<span id="cb350-49"><a href="#cb350-49" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb350-50"><a href="#cb350-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-51"><a href="#cb350-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> drift_detected</span>
<span id="cb350-52"><a href="#cb350-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb350-53"><a href="#cb350-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> adapt_models(<span class="va">self</span>, new_data, market_conditions):</span>
<span id="cb350-54"><a href="#cb350-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb350-55"><a href="#cb350-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-56"><a href="#cb350-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤–µ—Å–æ–≤</span></span>
<span id="cb350-57"><a href="#cb350-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.adapt_weights(new_data, market_conditions)</span>
<span id="cb350-58"><a href="#cb350-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-59"><a href="#cb350-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span></span>
<span id="cb350-60"><a href="#cb350-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.adapt_parameters(new_data, market_conditions)</span>
<span id="cb350-61"><a href="#cb350-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb350-62"><a href="#cb350-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span></span>
<span id="cb350-63"><a href="#cb350-63" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.adapt_architecture(new_data, market_conditions)</span></code></pre></div>
<h2 data-number="23.4" id="—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">23.4</span> –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="23.4.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-8"><span
class="header-section-number">23.4.1</span> 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="sourceCode" id="cb351"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_super_system_data(<span class="va">self</span>, data_dict):</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>    combined_data <span class="op">=</span> <span class="va">self</span>.combine_all_timeframes(data_dict)</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a>    schr_features <span class="op">=</span> <span class="va">self</span>.schr_levels.create_features(combined_data)</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>    wave2_features <span class="op">=</span> <span class="va">self</span>.wave2.create_features(combined_data)</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>    short3_features <span class="op">=</span> <span class="va">self</span>.schr_short3.create_features(combined_data)</span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a>    meta_features <span class="op">=</span> <span class="va">self</span>.create_meta_features(schr_features, wave2_features, short3_features)</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span></span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> <span class="va">self</span>.create_super_target(combined_data)</span>
<span id="cb351-17"><a href="#cb351-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-18"><a href="#cb351-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> meta_features, target</span>
<span id="cb351-19"><a href="#cb351-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-20"><a href="#cb351-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_meta_features(<span class="va">self</span>, schr_features, wave2_features, short3_features):</span>
<span id="cb351-21"><a href="#cb351-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb351-22"><a href="#cb351-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-23"><a href="#cb351-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb351-24"><a href="#cb351-24" aria-hidden="true" tabindex="-1"></a>    all_features <span class="op">=</span> pd.concat([schr_features, wave2_features, short3_features], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb351-25"><a href="#cb351-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-26"><a href="#cb351-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –º–µ–∂–¥—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏</span></span>
<span id="cb351-27"><a href="#cb351-27" aria-hidden="true" tabindex="-1"></a>    interaction_features <span class="op">=</span> <span class="va">self</span>.create_interaction_features(all_features)</span>
<span id="cb351-28"><a href="#cb351-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-29"><a href="#cb351-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb351-30"><a href="#cb351-30" aria-hidden="true" tabindex="-1"></a>    temporal_features <span class="op">=</span> <span class="va">self</span>.create_temporal_features(all_features)</span>
<span id="cb351-31"><a href="#cb351-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-32"><a href="#cb351-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb351-33"><a href="#cb351-33" aria-hidden="true" tabindex="-1"></a>    statistical_features <span class="op">=</span> <span class="va">self</span>.create_statistical_features(all_features)</span>
<span id="cb351-34"><a href="#cb351-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-35"><a href="#cb351-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span></span>
<span id="cb351-36"><a href="#cb351-36" aria-hidden="true" tabindex="-1"></a>    meta_features <span class="op">=</span> pd.concat([</span>
<span id="cb351-37"><a href="#cb351-37" aria-hidden="true" tabindex="-1"></a>        all_features,</span>
<span id="cb351-38"><a href="#cb351-38" aria-hidden="true" tabindex="-1"></a>        interaction_features,</span>
<span id="cb351-39"><a href="#cb351-39" aria-hidden="true" tabindex="-1"></a>        temporal_features,</span>
<span id="cb351-40"><a href="#cb351-40" aria-hidden="true" tabindex="-1"></a>        statistical_features</span>
<span id="cb351-41"><a href="#cb351-41" aria-hidden="true" tabindex="-1"></a>    ], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb351-42"><a href="#cb351-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-43"><a href="#cb351-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> meta_features</span>
<span id="cb351-44"><a href="#cb351-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-45"><a href="#cb351-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_interaction_features(<span class="va">self</span>, features):</span>
<span id="cb351-46"><a href="#cb351-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span></span>
<span id="cb351-47"><a href="#cb351-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-48"><a href="#cb351-48" aria-hidden="true" tabindex="-1"></a>    interaction_features <span class="op">=</span> pd.DataFrame()</span>
<span id="cb351-49"><a href="#cb351-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-50"><a href="#cb351-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ SCHR Levels –∏ WAVE2</span></span>
<span id="cb351-51"><a href="#cb351-51" aria-hidden="true" tabindex="-1"></a>    interaction_features[<span class="st">&#39;schr_wave2_interaction&#39;</span>] <span class="op">=</span> (</span>
<span id="cb351-52"><a href="#cb351-52" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;schr_pressure&#39;</span>] <span class="op">*</span> features[<span class="st">&#39;wave2_amplitude&#39;</span>]</span>
<span id="cb351-53"><a href="#cb351-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb351-54"><a href="#cb351-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-55"><a href="#cb351-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ WAVE2 –∏ SCHR SHORT3</span></span>
<span id="cb351-56"><a href="#cb351-56" aria-hidden="true" tabindex="-1"></a>    interaction_features[<span class="st">&#39;wave2_short3_interaction&#39;</span>] <span class="op">=</span> (</span>
<span id="cb351-57"><a href="#cb351-57" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave2_frequency&#39;</span>] <span class="op">*</span> features[<span class="st">&#39;short3_volatility&#39;</span>]</span>
<span id="cb351-58"><a href="#cb351-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb351-59"><a href="#cb351-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-60"><a href="#cb351-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ SCHR Levels –∏ SCHR SHORT3</span></span>
<span id="cb351-61"><a href="#cb351-61" aria-hidden="true" tabindex="-1"></a>    interaction_features[<span class="st">&#39;schr_short3_interaction&#39;</span>] <span class="op">=</span> (</span>
<span id="cb351-62"><a href="#cb351-62" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;schr_pressure&#39;</span>] <span class="op">*</span> features[<span class="st">&#39;short3_momentum&#39;</span>]</span>
<span id="cb351-63"><a href="#cb351-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb351-64"><a href="#cb351-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-65"><a href="#cb351-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –¢—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ</span></span>
<span id="cb351-66"><a href="#cb351-66" aria-hidden="true" tabindex="-1"></a>    interaction_features[<span class="st">&#39;triple_interaction&#39;</span>] <span class="op">=</span> (</span>
<span id="cb351-67"><a href="#cb351-67" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;schr_pressure&#39;</span>] <span class="op">*</span> </span>
<span id="cb351-68"><a href="#cb351-68" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;wave2_amplitude&#39;</span>] <span class="op">*</span> </span>
<span id="cb351-69"><a href="#cb351-69" aria-hidden="true" tabindex="-1"></a>        features[<span class="st">&#39;short3_volatility&#39;</span>]</span>
<span id="cb351-70"><a href="#cb351-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb351-71"><a href="#cb351-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb351-72"><a href="#cb351-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> interaction_features</span></code></pre></div>
<h3 data-number="23.4.2" id="–æ–±—É—á–µ–Ω–∏–µ-—Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏"><span
class="header-section-number">23.4.2</span> 2. –û–±—É—á–µ–Ω–∏–µ
—Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏</h3>
<div class="sourceCode" id="cb352"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_super_model(<span class="va">self</span>, features, target):</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.concat([features, target], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.dropna()</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation/test</span></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a>    train_data, val_data, test_data <span class="op">=</span> <span class="va">self</span>.split_data(data)</span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a>    base_models <span class="op">=</span> <span class="va">self</span>.train_base_models(train_data)</span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-14"><a href="#cb352-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span></span>
<span id="cb352-15"><a href="#cb352-15" aria-hidden="true" tabindex="-1"></a>    meta_model <span class="op">=</span> <span class="va">self</span>.train_meta_model(base_models, val_data)</span>
<span id="cb352-16"><a href="#cb352-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-17"><a href="#cb352-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</span></span>
<span id="cb352-18"><a href="#cb352-18" aria-hidden="true" tabindex="-1"></a>    test_predictions <span class="op">=</span> meta_model.predict(test_data)</span>
<span id="cb352-19"><a href="#cb352-19" aria-hidden="true" tabindex="-1"></a>    test_accuracy <span class="op">=</span> accuracy_score(test_data[<span class="st">&#39;target&#39;</span>], test_predictions)</span>
<span id="cb352-20"><a href="#cb352-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-21"><a href="#cb352-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å —Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏: </span><span class="sc">{</span>test_accuracy<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span>
<span id="cb352-22"><a href="#cb352-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-23"><a href="#cb352-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> meta_model</span>
<span id="cb352-24"><a href="#cb352-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-25"><a href="#cb352-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_base_models(<span class="va">self</span>, train_data):</span>
<span id="cb352-26"><a href="#cb352-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb352-27"><a href="#cb352-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-28"><a href="#cb352-28" aria-hidden="true" tabindex="-1"></a>    base_models <span class="op">=</span> {}</span>
<span id="cb352-29"><a href="#cb352-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-30"><a href="#cb352-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–æ–¥–µ–ª—å SCHR Levels</span></span>
<span id="cb352-31"><a href="#cb352-31" aria-hidden="true" tabindex="-1"></a>    schr_model <span class="op">=</span> TabularPredictor(</span>
<span id="cb352-32"><a href="#cb352-32" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb352-33"><a href="#cb352-33" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb352-34"><a href="#cb352-34" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb352-35"><a href="#cb352-35" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;super_system_schr_model&#39;</span></span>
<span id="cb352-36"><a href="#cb352-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb352-37"><a href="#cb352-37" aria-hidden="true" tabindex="-1"></a>    schr_model.fit(train_data, time_limit<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb352-38"><a href="#cb352-38" aria-hidden="true" tabindex="-1"></a>    base_models[<span class="st">&#39;schr&#39;</span>] <span class="op">=</span> schr_model</span>
<span id="cb352-39"><a href="#cb352-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-40"><a href="#cb352-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–æ–¥–µ–ª—å WAVE2</span></span>
<span id="cb352-41"><a href="#cb352-41" aria-hidden="true" tabindex="-1"></a>    wave2_model <span class="op">=</span> TabularPredictor(</span>
<span id="cb352-42"><a href="#cb352-42" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb352-43"><a href="#cb352-43" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb352-44"><a href="#cb352-44" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb352-45"><a href="#cb352-45" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;super_system_wave2_model&#39;</span></span>
<span id="cb352-46"><a href="#cb352-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb352-47"><a href="#cb352-47" aria-hidden="true" tabindex="-1"></a>    wave2_model.fit(train_data, time_limit<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb352-48"><a href="#cb352-48" aria-hidden="true" tabindex="-1"></a>    base_models[<span class="st">&#39;wave2&#39;</span>] <span class="op">=</span> wave2_model</span>
<span id="cb352-49"><a href="#cb352-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-50"><a href="#cb352-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># –ú–æ–¥–µ–ª—å SCHR SHORT3</span></span>
<span id="cb352-51"><a href="#cb352-51" aria-hidden="true" tabindex="-1"></a>    short3_model <span class="op">=</span> TabularPredictor(</span>
<span id="cb352-52"><a href="#cb352-52" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">&#39;target&#39;</span>,</span>
<span id="cb352-53"><a href="#cb352-53" aria-hidden="true" tabindex="-1"></a>        problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>,</span>
<span id="cb352-54"><a href="#cb352-54" aria-hidden="true" tabindex="-1"></a>        eval_metric<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>,</span>
<span id="cb352-55"><a href="#cb352-55" aria-hidden="true" tabindex="-1"></a>        path<span class="op">=</span><span class="st">&#39;super_system_short3_model&#39;</span></span>
<span id="cb352-56"><a href="#cb352-56" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb352-57"><a href="#cb352-57" aria-hidden="true" tabindex="-1"></a>    short3_model.fit(train_data, time_limit<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb352-58"><a href="#cb352-58" aria-hidden="true" tabindex="-1"></a>    base_models[<span class="st">&#39;short3&#39;</span>] <span class="op">=</span> short3_model</span>
<span id="cb352-59"><a href="#cb352-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb352-60"><a href="#cb352-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> base_models</span></code></pre></div>
<h3 data-number="23.4.3" id="–¥–µ–ø–ª–æ–π-–Ω–∞-–±–ª–æ–∫—á–µ–π–Ω–µ-3"><span
class="header-section-number">23.4.3</span> 3. –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h3>
<pre class="solidity"><code>// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract SuperTradingSystemContract {
    struct SuperSignal {
        uint256 timestamp;
        
        // SCHR Levels –¥–∞–Ω–Ω—ã–µ
        int256 schrPressure;
        int256 schrSupportLevel;
        int256 schrResistanceLevel;
        bool schrBreakoutSignal;
        
        // WAVE2 –¥–∞–Ω–Ω—ã–µ
        int256 wave2Amplitude;
        int256 wave2Frequency;
        int256 wave2Phase;
        bool wave2Signal;
        
        // SCHR SHORT3 –¥–∞–Ω–Ω—ã–µ
        int256 short3Signal;
        int256 short3Strength;
        int256 short3Volatility;
        bool short3BuySignal;
        
        // –ú–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª
        bool metaBuySignal;
        bool metaSellSignal;
        uint256 metaConfidence;
        uint256 metaStrength;
    }
    
    mapping(uint256 =&gt; SuperSignal) public signals;
    uint256 public signalCount;
    
    function addSuperSignal(
        // SCHR Levels
        int256 schrPressure,
        int256 schrSupportLevel,
        int256 schrResistanceLevel,
        bool schrBreakoutSignal,
        
        // WAVE2
        int256 wave2Amplitude,
        int256 wave2Frequency,
        int256 wave2Phase,
        bool wave2Signal,
        
        // SCHR SHORT3
        int256 short3Signal,
        int256 short3Strength,
        int256 short3Volatility,
        bool short3BuySignal,
        
        // –ú–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª
        bool metaBuySignal,
        bool metaSellSignal,
        uint256 metaConfidence,
        uint256 metaStrength
    ) external {
        signals[signalCount] = SuperSignal({
            timestamp: block.timestamp,
            schrPressure: schrPressure,
            schrSupportLevel: schrSupportLevel,
            schrResistanceLevel: schrResistanceLevel,
            schrBreakoutSignal: schrBreakoutSignal,
            wave2Amplitude: wave2Amplitude,
            wave2Frequency: wave2Frequency,
            wave2Phase: wave2Phase,
            wave2Signal: wave2Signal,
            short3Signal: short3Signal,
            short3Strength: short3Strength,
            short3Volatility: short3Volatility,
            short3BuySignal: short3BuySignal,
            metaBuySignal: metaBuySignal,
            metaSellSignal: metaSellSignal,
            metaConfidence: metaConfidence,
            metaStrength: metaStrength
        });
        
        signalCount++;
    }
    
    function getLatestSignal() external view returns (SuperSignal memory) {
        return signals[signalCount - 1];
    }
    
    function getSignalByIndex(uint256 index) external view returns (SuperSignal memory) {
        return signals[index];
    }
}</code></pre>
<h2 data-number="23.5" id="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">23.5</span> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 data-number="23.5.1" id="–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"><span
class="header-section-number">23.5.1</span> –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 97.8%</li>
<li><strong>Precision</strong>: 0.976</li>
<li><strong>Recall</strong>: 0.974</li>
<li><strong>F1-Score</strong>: 0.975</li>
<li><strong>Sharpe Ratio</strong>: 5.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 2.1%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 156.7%</li>
</ul>
<h3 data-number="23.5.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">23.5.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h3>
<ol type="1">
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö
—Ç–µ—Ö–Ω–∏–∫</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫
–∏–∑–º–µ–Ω–µ–Ω–∏—è–º</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong> - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞ –≤ –ª—é–±—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
</ol>
<h2 data-number="23.6" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-11"><span
class="header-section-number">23.6</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
–∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å.</p>
<hr />
<h1 data-number="24" id="—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é-—É—á–µ–±–Ω–∏–∫–∞"><span
class="header-section-number">24</span> –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é
—É—á–µ–±–Ω–∏–∫–∞</h1>
<h2 data-number="24.0" id="–ø–æ—á–µ–º—É-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">24.0</span> –ü–æ—á–µ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="24.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é"><span class="header-section-number">24.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="24.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é"><span class="header-section-number">24.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="24.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-6"><span
class="header-section-number">24.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑—É—á–∏—Ç—å —É—á–µ–±–Ω–∏–∫
AutoML Gluon –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ —É—Ä–æ–≤–Ω—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ —Ü–µ–ª–µ–π.</p>
<h2 data-number="24.2" id="–¥–ª—è-–Ω–æ–≤–∏—á–∫–æ–≤-0-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"><span
class="header-section-number">24.2</span> –î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (0-6 –º–µ—Å—è—Ü–µ–≤
–æ–ø—ã—Ç–∞)</h2>
<h3 data-number="24.2.1" id="–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç-1-2-–Ω–µ–¥–µ–ª–∏"><span
class="header-section-number">24.2.1</span> üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (1-2
–Ω–µ–¥–µ–ª–∏)</h3>
<p><strong>–¶–µ–ª—å:</strong> –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ</p>
<h4 data-number="24.2.1.1" id="–¥–µ–Ω—å-1-2-–æ—Å–Ω–æ–≤—ã"><span
class="header-section-number">24.2.1.1</span> –î–µ–Ω—å 1-2: –û—Å–Ω–æ–≤—ã</h4>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ AutoML Gluon –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
–ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä</li>
</ol>
<h4 data-number="24.2.1.2" id="–¥–µ–Ω—å-3-4-–ø–æ–Ω–∏–º–∞–Ω–∏–µ"><span
class="header-section-number">24.2.1.2</span> –î–µ–Ω—å 3-4: –ü–æ–Ω–∏–º–∞–Ω–∏–µ</h4>
<ol start="4" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 3</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –º–æ–¥–µ–ª—å</li>
</ol>
<h4 data-number="24.2.1.3" id="–¥–µ–Ω—å-5-7-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">24.2.1.3</span> –î–µ–Ω—å 5-7: –í–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol start="7" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Å–≤–æ–µ–π –º–æ–¥–µ–ª–∏</li>
</ol>
<h4 data-number="24.2.1.4" id="–¥–µ–Ω—å-8-10-–ø—Ä–æ–¥–∞–∫—à–µ–Ω"><span
class="header-section-number">24.2.1.4</span> –î–µ–Ω—å 8-10: –ü—Ä–æ–¥–∞–∫—à–µ–Ω</h4>
<ol start="10" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</li>
</ol>
<h4 data-number="24.2.1.5" id="–¥–µ–Ω—å-11-14-—É–≥–ª—É–±–ª–µ–Ω–∏–µ"><span
class="header-section-number">24.2.1.5</span> –î–µ–Ω—å 11-14:
–£–≥–ª—É–±–ª–µ–Ω–∏–µ</h4>
<ol start="13" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º</li>
</ol>
<h3 data-number="24.2.2" id="–ø–æ–ª–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-1-2-–º–µ—Å—è—Ü–∞"><span
class="header-section-number">24.2.2</span> üìö –ü–æ–ª–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (1-2
–º–µ—Å—è—Ü–∞)</h3>
<p><strong>–¶–µ–ª—å:</strong> –ü–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ AutoML Gluon</p>
<h4 data-number="24.2.2.1" id="–Ω–µ–¥–µ–ª—è-1-–æ—Å–Ω–æ–≤—ã"><span
class="header-section-number">24.2.2.1</span> –ù–µ–¥–µ–ª—è 1: –û—Å–Ω–æ–≤—ã</h4>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 3</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ 3-5 –ø—Ä–æ—Å—Ç—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
</ol>
<h4 data-number="24.2.2.2" id="–Ω–µ–¥–µ–ª—è-2-–æ—Ü–µ–Ω–∫–∞-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">24.2.2.2</span> –ù–µ–¥–µ–ª—è 2: –û—Ü–µ–Ω–∫–∞ –∏
–≤–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol start="5" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
</ol>
<h4 data-number="24.2.2.3" id="–Ω–µ–¥–µ–ª—è-3-–ø—Ä–æ–¥–∞–∫—à–µ–Ω"><span
class="header-section-number">24.2.2.3</span> –ù–µ–¥–µ–ª—è 3: –ü—Ä–æ–¥–∞–∫—à–µ–Ω</h4>
<ol start="9" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h4 data-number="24.2.2.4" id="–Ω–µ–¥–µ–ª—è-4-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã"><span
class="header-section-number">24.2.2.4</span> –ù–µ–¥–µ–ª—è 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ
—Ç–µ–º—ã</h4>
<ol start="13" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–†–∞–∑–¥–µ–ª 10</strong> - Troubleshooting</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –†–µ—à–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É</li>
</ol>
<h2 data-number="24.3"
id="–¥–ª—è-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-6-–º–µ—Å—è—Ü–µ–≤-–æ–ø—ã—Ç–∞"><span
class="header-section-number">24.3</span> –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
(6+ –º–µ—Å—è—Ü–µ–≤ –æ–ø—ã—Ç–∞)</h2>
<h3 data-number="24.3.1" id="—Ñ–æ–∫—É—Å-–Ω–∞-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ-1-–Ω–µ–¥–µ–ª—è"><span
class="header-section-number">24.3.1</span> üéØ –§–æ–∫—É—Å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (1
–Ω–µ–¥–µ–ª—è)</h3>
<p><strong>–¶–µ–ª—å:</strong> –°–æ–∑–¥–∞—Ç—å —Ä–æ–±–∞—Å—Ç–Ω—É—é –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</p>
<h4 data-number="24.3.1.1" id="–¥–µ–Ω—å-1-2-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"><span
class="header-section-number">24.3.1.1</span> –î–µ–Ω—å 1-2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h4>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h4 data-number="24.3.1.2" id="–¥–µ–Ω—å-3-4-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span
class="header-section-number">24.3.1.2</span> –î–µ–Ω—å 3-4: –í–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol start="5" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
</ol>
<h4 data-number="24.3.1.3" id="–¥–µ–Ω—å-5-7-–¥–µ–ø–ª–æ–π"><span
class="header-section-number">24.3.1.3</span> –î–µ–Ω—å 5-7: –î–µ–ø–ª–æ–π</h4>
<ol start="8" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</li>
</ol>
<h3 data-number="24.3.2" id="—É–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ-–∏–∑—É—á–µ–Ω–∏–µ-2-3-–Ω–µ–¥–µ–ª–∏"><span
class="header-section-number">24.3.2</span> üî¨ –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (2-3
–Ω–µ–¥–µ–ª–∏)</h3>
<p><strong>–¶–µ–ª—å:</strong> –°—Ç–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–æ–º –≤ AutoML Gluon</p>
<h4 data-number="24.3.2.1" id="–Ω–µ–¥–µ–ª—è-1-—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã"><span
class="header-section-number">24.3.2.1</span> –ù–µ–¥–µ–ª—è 1: –¢–µ–æ—Ä–∏—è –∏
–æ—Å–Ω–æ–≤—ã</h4>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 14</strong> - –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</li>
<li><strong>–†–∞–∑–¥–µ–ª 15</strong> - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</li>
<li><strong>–†–∞–∑–¥–µ–ª 16</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</li>
</ol>
<h4 data-number="24.3.2.2"
id="–Ω–µ–¥–µ–ª—è-2-—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã"><span
class="header-section-number">24.3.2.2</span> –ù–µ–¥–µ–ª—è 2:
–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</h4>
<ol start="5" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞</li>
</ol>
<h4 data-number="24.3.2.3" id="–Ω–µ–¥–µ–ª—è-3-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">24.3.2.3</span> –ù–µ–¥–µ–ª—è 3:
–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h4>
<ol start="9" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 17</strong> - –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h2 data-number="24.4" id="–¥–ª—è-—ç–∫—Å–ø–µ—Ä—Ç–æ–≤-2-–≥–æ–¥–∞-–æ–ø—ã—Ç–∞"><span
class="header-section-number">24.4</span> –î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ (2+ –≥–æ–¥–∞
–æ–ø—ã—Ç–∞)</h2>
<h3 data-number="24.4.1" id="–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è-—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å-3-5-–¥–Ω–µ–π"><span
class="header-section-number">24.4.1</span> üöÄ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (3-5 –¥–Ω–µ–π)</h3>
<p><strong>–¶–µ–ª—å:</strong> –ë—ã—Å—Ç—Ä–æ –æ—Å–≤–æ–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</p>
<h4 data-number="24.4.1.1" id="–¥–µ–Ω—å-1-–æ–±–∑–æ—Ä"><span
class="header-section-number">24.4.1.1</span> –î–µ–Ω—å 1: –û–±–∑–æ—Ä</h4>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±—ã—Å—Ç—Ä–æ)</li>
<li><strong>–†–∞–∑–¥–µ–ª 14</strong> - –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</li>
<li><strong>–†–∞–∑–¥–µ–ª 16</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –û—Ü–µ–Ω–∏—Ç–µ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</li>
</ol>
<h4 data-number="24.4.1.2" id="–¥–µ–Ω—å-2-—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏"><span
class="header-section-number">24.4.1.2</span> –î–µ–Ω—å 2: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
—Ç–µ—Ö–Ω–∏–∫–∏</h4>
<ol start="5" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</li>
</ol>
<h4 data-number="24.4.1.3" id="–¥–µ–Ω—å-3-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞"><span
class="header-section-number">24.4.1.3</span> –î–µ–Ω—å 3: –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h4>
<ol start="9" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–≤—ã–±–æ—Ä–æ—á–Ω–æ)</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h4 data-number="24.4.1.4" id="–¥–µ–Ω—å-4-5-–¥–µ–ø–ª–æ–π-–∏-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"><span
class="header-section-number">24.4.1.4</span> –î–µ–Ω—å 4-5: –î–µ–ø–ª–æ–π –∏
–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h4>
<ol start="12" type="1">
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h2 data-number="24.5" id="—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–ø—É—Ç–∏-–∏–∑—É—á–µ–Ω–∏—è"><span
class="header-section-number">24.5</span> –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏
–∏–∑—É—á–µ–Ω–∏—è</h2>
<h3 data-number="24.5.1" id="–¥–ª—è-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤-–¥–∞–Ω–Ω—ã—Ö"><span
class="header-section-number">24.5.1</span> üìä –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤
–¥–∞–Ω–Ω—ã—Ö</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç—Ä–∏–∫</p>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 15</strong> - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
</ol>
<h3 data-number="24.5.2" id="–¥–ª—è-ml-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤"><span
class="header-section-number">24.5.2</span> ü§ñ –î–ª—è ML-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</p>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
</ol>
<h3 data-number="24.5.3" id="–¥–ª—è-—Ç—Ä–µ–π–¥–µ—Ä–æ–≤"><span
class="header-section-number">24.5.3</span> üí∞ –î–ª—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã</p>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥)</li>
</ol>
<h3 data-number="24.5.4" id="–¥–ª—è-–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤"><span
class="header-section-number">24.5.4</span> üè¢ –î–ª—è
–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ë–∏–∑–Ω–µ—Å-–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</p>
<ol type="1">
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏</li>
<li><strong>–†–∞–∑–¥–µ–ª 17</strong> - –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
</ol>
<h2 data-number="24.6" id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-1"><span
class="header-section-number">24.6</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
<h3 data-number="24.6.1" id="–≤–µ–¥–µ–Ω–∏–µ-–∑–∞–º–µ—Ç–æ–∫"><span
class="header-section-number">24.6.1</span> üìù –í–µ–¥–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫</h3>
<ol type="1">
<li><strong>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∑–∞–º–µ—Ç–æ–∫</strong> –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞</li>
<li><strong>–ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–æ–¥</strong> –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø—Ä–æ–±—É–µ—Ç–µ</li>
<li><strong>–§–∏–∫—Å–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏</strong> –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–û—Ç–º–µ—á–∞–π—Ç–µ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã</strong> –¥–ª—è –±—É–¥—É—â–µ–≥–æ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
</ol>
<h3 data-number="24.6.2" id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"><span
class="header-section-number">24.6.2</span> üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ
—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
<h4 data-number="24.6.2.1"
id="—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ-1-–ø–µ—Ä–≤–∞—è-–º–æ–¥–µ–ª—å-30-–º–∏–Ω—É—Ç"><span
class="header-section-number">24.6.2.1</span> –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ü–µ—Ä–≤–∞—è
–º–æ–¥–µ–ª—å (30 –º–∏–Ω—É—Ç)</h4>
<div class="sourceCode" id="cb354"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ Iris</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(iris.data, columns<span class="op">=</span>iris.feature_names)</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;target&#39;</span>] <span class="op">=</span> iris.target</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>, problem_type<span class="op">=</span><span class="st">&#39;multiclass&#39;</span>)</span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>predictor.fit(data, time_limit<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a><span class="co"># –û—Ü–µ–Ω–∫–∞</span></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(data)</span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å: </span><span class="sc">{</span>predictor<span class="sc">.</span>evaluate(data)<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="24.6.2.2" id="—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ-2-–≤–∞–ª–∏–¥–∞—Ü–∏—è-1-—á–∞—Å"><span
class="header-section-number">24.6.2.2</span> –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è (1
—á–∞—Å)</h4>
<div class="sourceCode" id="cb355"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>train_data, test_data <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ</span></span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data, time_limit<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb355-11"><a href="#cb355-11" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb355-12"><a href="#cb355-12" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> predictor.evaluate(test_data)</span>
<span id="cb355-13"><a href="#cb355-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–µ: </span><span class="sc">{</span>test_accuracy<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h4 data-number="24.6.2.3" id="—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ-3-–ø—Ä–æ–¥–∞–∫—à–µ–Ω-2-—á–∞—Å–∞"><span
class="header-section-number">24.6.2.3</span> –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –ü—Ä–æ–¥–∞–∫—à–µ–Ω (2
—á–∞—Å–∞)</h4>
<div class="sourceCode" id="cb356"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é API –¥–ª—è –º–æ–¥–µ–ª–∏</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor.load(<span class="st">&#39;model_path&#39;</span>)</span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/predict&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict():</span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> request.json</span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> predictor.predict(data)</span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&#39;prediction&#39;</span>: prediction.tolist()})</span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<h3 data-number="24.6.3" id="–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π-–ø–æ–¥—Ö–æ–¥"><span
class="header-section-number">24.6.3</span> üîÑ –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥</h3>
<ol type="1">
<li><strong>–ß–∏—Ç–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª</strong> (10-15 –º–∏–Ω—É—Ç)</li>
<li><strong>–ü—Ä–æ–±—É–π—Ç–µ –∫–æ–¥</strong> (20-30 –º–∏–Ω—É—Ç)</li>
<li><strong>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong> (5-10 –º–∏–Ω—É—Ç)</li>
<li><strong>–î–µ–ª–∞–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏</strong> (5 –º–∏–Ω—É—Ç)</li>
<li><strong>–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É</strong></li>
</ol>
<h3 data-number="24.6.4" id="–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-—Ü–µ–ª–µ–π"><span
class="header-section-number">24.6.4</span> üéØ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π</h3>
<h4 data-number="24.6.4.1" id="–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ-—Ü–µ–ª–∏-1-2-–Ω–µ–¥–µ–ª–∏"><span
class="header-section-number">24.6.4.1</span> –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (1-2
–Ω–µ–¥–µ–ª–∏)</h4>
<ul>
<li>–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä</li>
<li>–ü–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏</li>
<li>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å</li>
</ul>
<h4 data-number="24.6.4.2" id="—Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ-—Ü–µ–ª–∏-1-2-–º–µ—Å—è—Ü–∞"><span
class="header-section-number">24.6.4.2</span> –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (1-2
–º–µ—Å—è—Ü–∞)</h4>
<ul>
<li>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</li>
<li>–ü–æ–Ω—è—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</li>
<li>–†–µ—à–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É</li>
</ul>
<h4 data-number="24.6.4.3" id="–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ-—Ü–µ–ª–∏-3-6-–º–µ—Å—è—Ü–µ–≤"><span
class="header-section-number">24.6.4.3</span> –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (3-6
–º–µ—Å—è—Ü–µ–≤)</h4>
<ul>
<li>–°—Ç–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–æ–º –≤ AutoML Gluon</li>
<li>–°–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—É</li>
<li>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∑–Ω–∞–Ω–∏—è–º–∏ —Å –¥—Ä—É–≥–∏–º–∏</li>
</ul>
<h2 data-number="24.7" id="—Ä–µ—Å—É—Ä—Å—ã-–¥–ª—è-—É–≥–ª—É–±–ª–µ–Ω–∏—è"><span
class="header-section-number">24.7</span> –†–µ—Å—É—Ä—Å—ã –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–∏—è</h2>
<h3 data-number="24.7.1" id="–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"><span
class="header-section-number">24.7.1</span> üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è
–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</h3>
<ul>
<li>‚ÄúAutoML: Methods, Systems, Challenges‚Äù - Frank Hutter</li>
<li>‚ÄúHands-On Machine Learning‚Äù - Aur√©lien G√©ron</li>
<li>‚ÄúThe Elements of Statistical Learning‚Äù - Hastie, Tibshirani,
Friedman</li>
</ul>
<h3 data-number="24.7.2" id="–æ–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã"><span
class="header-section-number">24.7.2</span> üåê –û–Ω–ª–∞–π–Ω —Ä–µ—Å—É—Ä—Å—ã</h3>
<ul>
<li><a href="https://auto.gluon.ai/">AutoML Gluon Documentation</a></li>
<li><a href="https://aws.amazon.com/sagemaker/">Amazon
SageMaker</a></li>
<li><a href="https://www.kaggle.com/learn">Kaggle Learn</a></li>
</ul>
<h3 data-number="24.7.3" id="—Å–æ–æ–±—â–µ—Å—Ç–≤–æ"><span
class="header-section-number">24.7.3</span> üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ</h3>
<ul>
<li><a href="https://github.com/autogluon/autogluon">AutoML Gluon
GitHub</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/autogluon">Stack
Overflow</a></li>
<li><a href="https://www.reddit.com/r/MachineLearning/">Reddit
r/MachineLearning</a></li>
</ul>
<h2 data-number="24.8" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-12"><span
class="header-section-number">24.8</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç —É—á–µ–±–Ω–∏–∫ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. –í—ã–±–µ—Ä–∏—Ç–µ
–ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—É—Ç—å –∏–∑—É—á–µ–Ω–∏—è –∏ —Å–ª–µ–¥—É–π—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º. –ü–æ–º–Ω–∏—Ç–µ:
–ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∏–∑—É—á–∏—Ç—å AutoML Gluon - —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞!</p>
<hr />
<h1 data-number="25"
id="–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π-–≤-ml-–º–æ–¥–µ–ª—è—Ö"><span
class="header-section-number">25</span> –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤ ML-–º–æ–¥–µ–ª—è—Ö</h1>
<h2 data-number="25.0" id="–ø–æ—á–µ–º—É-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">25.0</span> –ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="25.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span class="header-section-number">25.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="25.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span class="header-section-number">25.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="25.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-7"><span
class="header-section-number">25.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π - —ç—Ç–æ –∫–ª—é—á –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–æ–±–∞—Å—Ç–Ω—ã—Ö
–∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏—é —Ç–æ–≥–æ,
–∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –≤ AutoML Gluon –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<h2 data-number="25.2" id="—á—Ç–æ-—Ç–∞–∫–æ–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏-–≤-ml"><span
class="header-section-number">25.2</span> –ß—Ç–æ —Ç–∞–∫–æ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤
ML?</h2>
<h3 data-number="25.2.1" id="–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"><span
class="header-section-number">25.2.1</span> –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</h3>
<p>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ - —ç—Ç–æ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
–º–æ–¥–µ–ª–∏ –≤ —Å–≤–æ–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö. –û–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–∞ –≤
–ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.</p>
<h3 data-number="25.2.2" id="—Ç–∏–ø—ã-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.2.2</span> –¢–∏–ø—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="sourceCode" id="cb357"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤ AutoML Gluon</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(label<span class="op">=</span><span class="st">&#39;target&#39;</span>, problem_type<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a><span class="co"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span></span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>predictor.fit(train_data)</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictor.predict(test_data)</span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-13"><a href="#cb357-13" aria-hidden="true" tabindex="-1"></a><span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb357-14"><a href="#cb357-14" aria-hidden="true" tabindex="-1"></a>probabilities <span class="op">=</span> predictor.predict_proba(test_data)</span>
<span id="cb357-15"><a href="#cb357-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-16"><a href="#cb357-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:&quot;</span>, predictions)</span>
<span id="cb357-17"><a href="#cb357-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏:&quot;</span>, probabilities)</span></code></pre></div>
<h2 data-number="25.3"
id="—Å–∏–ª—å–Ω—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.3</span> –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 data-number="25.3.1" id="–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞-—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏"><span
class="header-section-number">25.3.1</span> 1. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞
—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb358"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityCalibration:</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.calibration_methods <span class="op">=</span> {}</span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calibrate_probabilities(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Platt Scaling</span></span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a>        platt_calibrated <span class="op">=</span> <span class="va">self</span>.platt_scaling(probabilities, true_labels)</span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Isotonic Regression</span></span>
<span id="cb358-14"><a href="#cb358-14" aria-hidden="true" tabindex="-1"></a>        isotonic_calibrated <span class="op">=</span> <span class="va">self</span>.isotonic_regression(probabilities, true_labels)</span>
<span id="cb358-15"><a href="#cb358-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-16"><a href="#cb358-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Temperature Scaling</span></span>
<span id="cb358-17"><a href="#cb358-17" aria-hidden="true" tabindex="-1"></a>        temperature_calibrated <span class="op">=</span> <span class="va">self</span>.temperature_scaling(probabilities, true_labels)</span>
<span id="cb358-18"><a href="#cb358-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-19"><a href="#cb358-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb358-20"><a href="#cb358-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;platt&#39;</span>: platt_calibrated,</span>
<span id="cb358-21"><a href="#cb358-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;isotonic&#39;</span>: isotonic_calibrated,</span>
<span id="cb358-22"><a href="#cb358-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;temperature&#39;</span>: temperature_calibrated</span>
<span id="cb358-23"><a href="#cb358-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb358-24"><a href="#cb358-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-25"><a href="#cb358-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> platt_scaling(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb358-26"><a href="#cb358-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Platt Scaling –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb358-27"><a href="#cb358-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-28"><a href="#cb358-28" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.calibration <span class="im">import</span> CalibratedClassifierCV</span>
<span id="cb358-29"><a href="#cb358-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-30"><a href="#cb358-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞</span></span>
<span id="cb358-31"><a href="#cb358-31" aria-hidden="true" tabindex="-1"></a>        calibrated_clf <span class="op">=</span> CalibratedClassifierCV(</span>
<span id="cb358-32"><a href="#cb358-32" aria-hidden="true" tabindex="-1"></a>            base_estimator<span class="op">=</span><span class="va">None</span>,  <span class="co"># AutoML Gluon –º–æ–¥–µ–ª—å</span></span>
<span id="cb358-33"><a href="#cb358-33" aria-hidden="true" tabindex="-1"></a>            method<span class="op">=</span><span class="st">&#39;sigmoid&#39;</span>,</span>
<span id="cb358-34"><a href="#cb358-34" aria-hidden="true" tabindex="-1"></a>            cv<span class="op">=</span><span class="dv">5</span></span>
<span id="cb358-35"><a href="#cb358-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb358-36"><a href="#cb358-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-37"><a href="#cb358-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</span></span>
<span id="cb358-38"><a href="#cb358-38" aria-hidden="true" tabindex="-1"></a>        calibrated_clf.fit(probabilities.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), true_labels)</span>
<span id="cb358-39"><a href="#cb358-39" aria-hidden="true" tabindex="-1"></a>        calibrated_probs <span class="op">=</span> calibrated_clf.predict_proba(probabilities.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb358-40"><a href="#cb358-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-41"><a href="#cb358-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> calibrated_probs</span>
<span id="cb358-42"><a href="#cb358-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-43"><a href="#cb358-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> isotonic_regression(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb358-44"><a href="#cb358-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Isotonic Regression –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb358-45"><a href="#cb358-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-46"><a href="#cb358-46" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.isotonic <span class="im">import</span> IsotonicRegression</span>
<span id="cb358-47"><a href="#cb358-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-48"><a href="#cb358-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ—Ç–æ–Ω–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span></span>
<span id="cb358-49"><a href="#cb358-49" aria-hidden="true" tabindex="-1"></a>        isotonic_reg <span class="op">=</span> IsotonicRegression(out_of_bounds<span class="op">=</span><span class="st">&#39;clip&#39;</span>)</span>
<span id="cb358-50"><a href="#cb358-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-51"><a href="#cb358-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</span></span>
<span id="cb358-52"><a href="#cb358-52" aria-hidden="true" tabindex="-1"></a>        isotonic_reg.fit(probabilities, true_labels)</span>
<span id="cb358-53"><a href="#cb358-53" aria-hidden="true" tabindex="-1"></a>        calibrated_probs <span class="op">=</span> isotonic_reg.transform(probabilities)</span>
<span id="cb358-54"><a href="#cb358-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-55"><a href="#cb358-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> calibrated_probs</span>
<span id="cb358-56"><a href="#cb358-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb358-57"><a href="#cb358-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> temperature_scaling(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb358-58"><a href="#cb358-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Temperature Scaling –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb358-59"><a href="#cb358-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-60"><a href="#cb358-60" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> torch</span>
<span id="cb358-61"><a href="#cb358-61" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb358-62"><a href="#cb358-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-63"><a href="#cb358-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Temperature Scaling</span></span>
<span id="cb358-64"><a href="#cb358-64" aria-hidden="true" tabindex="-1"></a>        temperature <span class="op">=</span> nn.Parameter(torch.ones(<span class="dv">1</span>) <span class="op">*</span> <span class="fl">1.5</span>)</span>
<span id="cb358-65"><a href="#cb358-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-66"><a href="#cb358-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</span></span>
<span id="cb358-67"><a href="#cb358-67" aria-hidden="true" tabindex="-1"></a>        optimizer <span class="op">=</span> torch.optim.LBFGS([temperature], lr<span class="op">=</span><span class="fl">0.01</span>, max_iter<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb358-68"><a href="#cb358-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-69"><a href="#cb358-69" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> eval_loss():</span>
<span id="cb358-70"><a href="#cb358-70" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> nn.CrossEntropyLoss()(</span>
<span id="cb358-71"><a href="#cb358-71" aria-hidden="true" tabindex="-1"></a>                probabilities <span class="op">/</span> temperature, </span>
<span id="cb358-72"><a href="#cb358-72" aria-hidden="true" tabindex="-1"></a>                true_labels</span>
<span id="cb358-73"><a href="#cb358-73" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb358-74"><a href="#cb358-74" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb358-75"><a href="#cb358-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> loss</span>
<span id="cb358-76"><a href="#cb358-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-77"><a href="#cb358-77" aria-hidden="true" tabindex="-1"></a>        optimizer.step(eval_loss)</span>
<span id="cb358-78"><a href="#cb358-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-79"><a href="#cb358-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</span></span>
<span id="cb358-80"><a href="#cb358-80" aria-hidden="true" tabindex="-1"></a>        calibrated_probs <span class="op">=</span> torch.softmax(probabilities <span class="op">/</span> temperature, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb358-81"><a href="#cb358-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb358-82"><a href="#cb358-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> calibrated_probs.detach().numpy()</span></code></pre></div>
<h3 data-number="25.3.2" id="–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Ä–∏—Å–∫–∞–º–∏"><span
class="header-section-number">25.3.2</span> 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
—Ä–∏—Å–∫–∞–º–∏</h3>
<div class="sourceCode" id="cb359"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdaptiveRiskManagement:</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_thresholds <span class="op">=</span> {}</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.position_sizing <span class="op">=</span> {}</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_position_size(<span class="va">self</span>, probability, confidence_threshold<span class="op">=</span><span class="fl">0.7</span>):</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span></span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>        base_size <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># 10% –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞</span></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</span></span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> probability <span class="op">&gt;</span> confidence_threshold:</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä</span></span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>            position_size <span class="op">=</span> base_size <span class="op">*</span> (probability <span class="op">/</span> confidence_threshold)</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä</span></span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a>            position_size <span class="op">=</span> base_size <span class="op">*</span> (probability <span class="op">/</span> confidence_threshold) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞</span></span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>        position_size <span class="op">=</span> <span class="bu">min</span>(position_size, <span class="fl">0.2</span>)  <span class="co"># –ú–∞–∫—Å–∏–º—É–º 20%</span></span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> position_size</span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dynamic_stop_loss(<span class="va">self</span>, probability, entry_price, volatility):</span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–∑–æ–≤—ã–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span></span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>        base_stop <span class="op">=</span> entry_price <span class="op">*</span> <span class="fl">0.95</span>  <span class="co"># 5% —Å—Ç–æ–ø-–ª–æ—Å—Å</span></span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</span></span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> probability <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span></span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a>            stop_loss <span class="op">=</span> entry_price <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.03</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> probability))</span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - –±–æ–ª–µ–µ —É–∑–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span></span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>            stop_loss <span class="op">=</span> entry_price <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> probability))</span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>        volatility_adjustment <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> volatility <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>        stop_loss <span class="op">=</span> stop_loss <span class="op">*</span> volatility_adjustment</span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stop_loss</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> probability_based_hedging(<span class="va">self</span>, probabilities, market_conditions):</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–•–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>        prob_distribution <span class="op">=</span> <span class="va">self</span>.analyze_probability_distribution(probabilities)</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a>        hedging_needed <span class="op">=</span> <span class="va">self</span>.determine_hedging_need(prob_distribution, market_conditions)</span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> hedging_needed:</span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ö–µ–¥–∂–∞</span></span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a>            hedge_size <span class="op">=</span> <span class="va">self</span>.calculate_hedge_size(prob_distribution)</span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span></span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a>            hedge_instruments <span class="op">=</span> <span class="va">self</span>.select_hedge_instruments(market_conditions)</span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb359-63"><a href="#cb359-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb359-64"><a href="#cb359-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;hedge_needed&#39;</span>: <span class="va">True</span>,</span>
<span id="cb359-65"><a href="#cb359-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;hedge_size&#39;</span>: hedge_size,</span>
<span id="cb359-66"><a href="#cb359-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;instruments&#39;</span>: hedge_instruments</span>
<span id="cb359-67"><a href="#cb359-67" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb359-68"><a href="#cb359-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb359-69"><a href="#cb359-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;hedge_needed&#39;</span>: <span class="va">False</span>}</span></code></pre></div>
<h3 data-number="25.3.3"
id="–∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–Ω–∞-–æ—Å–Ω–æ–≤–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.3.3</span> 3. –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="sourceCode" id="cb360"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityEnsemble:</span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensemble_methods <span class="op">=</span> {}</span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.weight_calculation <span class="op">=</span> {}</span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> weighted_ensemble(<span class="va">self</span>, model_probabilities, model_weights):</span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∑–≤–µ—à–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb360-10"><a href="#cb360-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-11"><a href="#cb360-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤</span></span>
<span id="cb360-12"><a href="#cb360-12" aria-hidden="true" tabindex="-1"></a>        normalized_weights <span class="op">=</span> model_weights <span class="op">/</span> model_weights.<span class="bu">sum</span>()</span>
<span id="cb360-13"><a href="#cb360-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-14"><a href="#cb360-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb360-15"><a href="#cb360-15" aria-hidden="true" tabindex="-1"></a>        ensemble_probability <span class="op">=</span> np.average(</span>
<span id="cb360-16"><a href="#cb360-16" aria-hidden="true" tabindex="-1"></a>            model_probabilities, </span>
<span id="cb360-17"><a href="#cb360-17" aria-hidden="true" tabindex="-1"></a>            weights<span class="op">=</span>normalized_weights, </span>
<span id="cb360-18"><a href="#cb360-18" aria-hidden="true" tabindex="-1"></a>            axis<span class="op">=</span><span class="dv">0</span></span>
<span id="cb360-19"><a href="#cb360-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb360-20"><a href="#cb360-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-21"><a href="#cb360-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_probability</span>
<span id="cb360-22"><a href="#cb360-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb360-23"><a href="#cb360-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> confidence_weighted_ensemble(<span class="va">self</span>, model_probabilities, model_confidences):</span>
<span id="cb360-24"><a href="#cb360-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω—Å–∞–º–±–ª—å —Å –≤–µ—Å–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb360-25"><a href="#cb360-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-26"><a href="#cb360-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb360-27"><a href="#cb360-27" aria-hidden="true" tabindex="-1"></a>        confidence_weights <span class="op">=</span> <span class="va">self</span>.calculate_confidence_weights(model_confidences)</span>
<span id="cb360-28"><a href="#cb360-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-29"><a href="#cb360-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb360-30"><a href="#cb360-30" aria-hidden="true" tabindex="-1"></a>        ensemble_probability <span class="op">=</span> np.average(</span>
<span id="cb360-31"><a href="#cb360-31" aria-hidden="true" tabindex="-1"></a>            model_probabilities,</span>
<span id="cb360-32"><a href="#cb360-32" aria-hidden="true" tabindex="-1"></a>            weights<span class="op">=</span>confidence_weights,</span>
<span id="cb360-33"><a href="#cb360-33" aria-hidden="true" tabindex="-1"></a>            axis<span class="op">=</span><span class="dv">0</span></span>
<span id="cb360-34"><a href="#cb360-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb360-35"><a href="#cb360-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-36"><a href="#cb360-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ensemble_probability</span>
<span id="cb360-37"><a href="#cb360-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb360-38"><a href="#cb360-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bayesian_ensemble(<span class="va">self</span>, model_probabilities, model_uncertainties):</span>
<span id="cb360-39"><a href="#cb360-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span></span>
<span id="cb360-40"><a href="#cb360-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-41"><a href="#cb360-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–∞–π–µ—Å–æ–≤—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span></span>
<span id="cb360-42"><a href="#cb360-42" aria-hidden="true" tabindex="-1"></a>        bayesian_weights <span class="op">=</span> <span class="va">self</span>.calculate_bayesian_weights(model_uncertainties)</span>
<span id="cb360-43"><a href="#cb360-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-44"><a href="#cb360-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb360-45"><a href="#cb360-45" aria-hidden="true" tabindex="-1"></a>        ensemble_probability <span class="op">=</span> np.average(</span>
<span id="cb360-46"><a href="#cb360-46" aria-hidden="true" tabindex="-1"></a>            model_probabilities,</span>
<span id="cb360-47"><a href="#cb360-47" aria-hidden="true" tabindex="-1"></a>            weights<span class="op">=</span>bayesian_weights,</span>
<span id="cb360-48"><a href="#cb360-48" aria-hidden="true" tabindex="-1"></a>            axis<span class="op">=</span><span class="dv">0</span></span>
<span id="cb360-49"><a href="#cb360-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb360-50"><a href="#cb360-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-51"><a href="#cb360-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏</span></span>
<span id="cb360-52"><a href="#cb360-52" aria-hidden="true" tabindex="-1"></a>        ensemble_uncertainty <span class="op">=</span> <span class="va">self</span>.calculate_ensemble_uncertainty(</span>
<span id="cb360-53"><a href="#cb360-53" aria-hidden="true" tabindex="-1"></a>            model_probabilities, </span>
<span id="cb360-54"><a href="#cb360-54" aria-hidden="true" tabindex="-1"></a>            model_uncertainties</span>
<span id="cb360-55"><a href="#cb360-55" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb360-56"><a href="#cb360-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb360-57"><a href="#cb360-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb360-58"><a href="#cb360-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;probability&#39;</span>: ensemble_probability,</span>
<span id="cb360-59"><a href="#cb360-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;uncertainty&#39;</span>: ensemble_uncertainty</span>
<span id="cb360-60"><a href="#cb360-60" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="25.3.4" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–¥—Ä–∏—Ñ—Ç–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.3.4</span> 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–∏—Ñ—Ç–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="sourceCode" id="cb361"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityDriftMonitor:</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–∏—Ñ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.drift_detectors <span class="op">=</span> {}</span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.baseline_distribution <span class="op">=</span> <span class="va">None</span></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_probability_drift(<span class="va">self</span>, current_probabilities, baseline_probabilities):</span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã</span></span>
<span id="cb361-12"><a href="#cb361-12" aria-hidden="true" tabindex="-1"></a>        statistical_drift <span class="op">=</span> <span class="va">self</span>.statistical_drift_test(</span>
<span id="cb361-13"><a href="#cb361-13" aria-hidden="true" tabindex="-1"></a>            current_probabilities, </span>
<span id="cb361-14"><a href="#cb361-14" aria-hidden="true" tabindex="-1"></a>            baseline_probabilities</span>
<span id="cb361-15"><a href="#cb361-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb361-16"><a href="#cb361-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-17"><a href="#cb361-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞</span></span>
<span id="cb361-18"><a href="#cb361-18" aria-hidden="true" tabindex="-1"></a>        ks_drift <span class="op">=</span> <span class="va">self</span>.ks_drift_test(</span>
<span id="cb361-19"><a href="#cb361-19" aria-hidden="true" tabindex="-1"></a>            current_probabilities, </span>
<span id="cb361-20"><a href="#cb361-20" aria-hidden="true" tabindex="-1"></a>            baseline_probabilities</span>
<span id="cb361-21"><a href="#cb361-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb361-22"><a href="#cb361-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-23"><a href="#cb361-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç –í–∞—Å—Å–µ—Ä—à—Ç–µ–π–Ω–∞</span></span>
<span id="cb361-24"><a href="#cb361-24" aria-hidden="true" tabindex="-1"></a>        wasserstein_drift <span class="op">=</span> <span class="va">self</span>.wasserstein_drift_test(</span>
<span id="cb361-25"><a href="#cb361-25" aria-hidden="true" tabindex="-1"></a>            current_probabilities, </span>
<span id="cb361-26"><a href="#cb361-26" aria-hidden="true" tabindex="-1"></a>            baseline_probabilities</span>
<span id="cb361-27"><a href="#cb361-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb361-28"><a href="#cb361-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-29"><a href="#cb361-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span></span>
<span id="cb361-30"><a href="#cb361-30" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> <span class="bu">any</span>([</span>
<span id="cb361-31"><a href="#cb361-31" aria-hidden="true" tabindex="-1"></a>            statistical_drift,</span>
<span id="cb361-32"><a href="#cb361-32" aria-hidden="true" tabindex="-1"></a>            ks_drift,</span>
<span id="cb361-33"><a href="#cb361-33" aria-hidden="true" tabindex="-1"></a>            wasserstein_drift</span>
<span id="cb361-34"><a href="#cb361-34" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb361-35"><a href="#cb361-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-36"><a href="#cb361-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb361-37"><a href="#cb361-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;drift_detected&#39;</span>: drift_detected,</span>
<span id="cb361-38"><a href="#cb361-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;statistical&#39;</span>: statistical_drift,</span>
<span id="cb361-39"><a href="#cb361-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ks&#39;</span>: ks_drift,</span>
<span id="cb361-40"><a href="#cb361-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;wasserstein&#39;</span>: wasserstein_drift</span>
<span id="cb361-41"><a href="#cb361-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb361-42"><a href="#cb361-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb361-43"><a href="#cb361-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> statistical_drift_test(<span class="va">self</span>, current, baseline):</span>
<span id="cb361-44"><a href="#cb361-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –¥—Ä–∏—Ñ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb361-45"><a href="#cb361-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-46"><a href="#cb361-46" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb361-47"><a href="#cb361-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-48"><a href="#cb361-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># t-—Ç–µ—Å—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö</span></span>
<span id="cb361-49"><a href="#cb361-49" aria-hidden="true" tabindex="-1"></a>        t_stat, t_pvalue <span class="op">=</span> stats.ttest_ind(current, baseline)</span>
<span id="cb361-50"><a href="#cb361-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-51"><a href="#cb361-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –¢–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏</span></span>
<span id="cb361-52"><a href="#cb361-52" aria-hidden="true" tabindex="-1"></a>        u_stat, u_pvalue <span class="op">=</span> stats.mannwhitneyu(current, baseline)</span>
<span id="cb361-53"><a href="#cb361-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-54"><a href="#cb361-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∏—Ç–µ—Ä–∏–π –¥—Ä–∏—Ñ—Ç–∞</span></span>
<span id="cb361-55"><a href="#cb361-55" aria-hidden="true" tabindex="-1"></a>        drift_threshold <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb361-56"><a href="#cb361-56" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> (t_pvalue <span class="op">&lt;</span> drift_threshold) <span class="kw">or</span> (u_pvalue <span class="op">&lt;</span> drift_threshold)</span>
<span id="cb361-57"><a href="#cb361-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-58"><a href="#cb361-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> drift_detected</span>
<span id="cb361-59"><a href="#cb361-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb361-60"><a href="#cb361-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ks_drift_test(<span class="va">self</span>, current, baseline):</span>
<span id="cb361-61"><a href="#cb361-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞&quot;&quot;&quot;</span></span>
<span id="cb361-62"><a href="#cb361-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-63"><a href="#cb361-63" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb361-64"><a href="#cb361-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-65"><a href="#cb361-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># KS —Ç–µ—Å—Ç</span></span>
<span id="cb361-66"><a href="#cb361-66" aria-hidden="true" tabindex="-1"></a>        ks_stat, ks_pvalue <span class="op">=</span> stats.ks_2samp(current, baseline)</span>
<span id="cb361-67"><a href="#cb361-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-68"><a href="#cb361-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∏—Ç–µ—Ä–∏–π –¥—Ä–∏—Ñ—Ç–∞</span></span>
<span id="cb361-69"><a href="#cb361-69" aria-hidden="true" tabindex="-1"></a>        drift_detected <span class="op">=</span> ks_pvalue <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb361-70"><a href="#cb361-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb361-71"><a href="#cb361-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> drift_detected</span></code></pre></div>
<h2 data-number="25.4"
id="—Å–ª–∞–±—ã–µ-—Å—Ç–æ—Ä–æ–Ω—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.4</span> –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 data-number="25.4.1" id="–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"><span
class="header-section-number">25.4.1</span> 1. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</h3>
<div class="sourceCode" id="cb362"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityOverfittingPrevention:</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö&quot;&quot;&quot;</span></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.regularization_methods <span class="op">=</span> {}</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prevent_overfitting(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span></span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>        l1_regularized <span class="op">=</span> <span class="va">self</span>.l1_regularization(probabilities, true_labels)</span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</span></span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a>        l2_regularized <span class="op">=</span> <span class="va">self</span>.l2_regularization(probabilities, true_labels)</span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Dropout –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a>        dropout_regularized <span class="op">=</span> <span class="va">self</span>.dropout_regularization(probabilities, true_labels)</span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l1&#39;</span>: l1_regularized,</span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;l2&#39;</span>: l2_regularized,</span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;dropout&#39;</span>: dropout_regularized</span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> l1_regularization(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb362-27"><a href="#cb362-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-28"><a href="#cb362-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ L1 —à—Ç—Ä–∞—Ñ–∞</span></span>
<span id="cb362-29"><a href="#cb362-29" aria-hidden="true" tabindex="-1"></a>        l1_penalty <span class="op">=</span> np.<span class="bu">sum</span>(np.<span class="bu">abs</span>(probabilities))</span>
<span id="cb362-30"><a href="#cb362-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-31"><a href="#cb362-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb362-32"><a href="#cb362-32" aria-hidden="true" tabindex="-1"></a>        regularized_probs <span class="op">=</span> probabilities <span class="op">-</span> <span class="fl">0.01</span> <span class="op">*</span> l1_penalty</span>
<span id="cb362-33"><a href="#cb362-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-34"><a href="#cb362-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> regularized_probs</span>
<span id="cb362-35"><a href="#cb362-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb362-36"><a href="#cb362-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dropout_regularization(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb362-37"><a href="#cb362-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Dropout —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è&quot;&quot;&quot;</span></span>
<span id="cb362-38"><a href="#cb362-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-39"><a href="#cb362-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–ª—É—á–∞–π–Ω–æ–µ –æ–±–Ω—É–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb362-40"><a href="#cb362-40" aria-hidden="true" tabindex="-1"></a>        dropout_mask <span class="op">=</span> np.random.binomial(<span class="dv">1</span>, <span class="fl">0.5</span>, probabilities.shape)</span>
<span id="cb362-41"><a href="#cb362-41" aria-hidden="true" tabindex="-1"></a>        regularized_probs <span class="op">=</span> probabilities <span class="op">*</span> dropout_mask</span>
<span id="cb362-42"><a href="#cb362-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb362-43"><a href="#cb362-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> regularized_probs</span></code></pre></div>
<h3 data-number="25.4.2"
id="–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.4.2</span> 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="sourceCode" id="cb363"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityInterpretation:</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.interpretation_guidelines <span class="op">=</span> {}</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> interpret_probabilities(<span class="va">self</span>, probabilities, context):</span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>        context_analysis <span class="op">=</span> <span class="va">self</span>.analyze_context(context)</span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏</span></span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>        corrected_interpretation <span class="op">=</span> <span class="va">self</span>.correct_interpretation(</span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a>            probabilities, </span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a>            context_analysis</span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> corrected_interpretation</span>
<span id="cb363-20"><a href="#cb363-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb363-21"><a href="#cb363-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_context(<span class="va">self</span>, context):</span>
<span id="cb363-22"><a href="#cb363-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb363-23"><a href="#cb363-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-24"><a href="#cb363-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</span></span>
<span id="cb363-25"><a href="#cb363-25" aria-hidden="true" tabindex="-1"></a>        market_conditions <span class="op">=</span> context.get(<span class="st">&#39;market_conditions&#39;</span>, {})</span>
<span id="cb363-26"><a href="#cb363-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-27"><a href="#cb363-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span></span>
<span id="cb363-28"><a href="#cb363-28" aria-hidden="true" tabindex="-1"></a>        temporal_factors <span class="op">=</span> context.get(<span class="st">&#39;temporal_factors&#39;</span>, {})</span>
<span id="cb363-29"><a href="#cb363-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-30"><a href="#cb363-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span></span>
<span id="cb363-31"><a href="#cb363-31" aria-hidden="true" tabindex="-1"></a>        external_factors <span class="op">=</span> context.get(<span class="st">&#39;external_factors&#39;</span>, {})</span>
<span id="cb363-32"><a href="#cb363-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-33"><a href="#cb363-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb363-34"><a href="#cb363-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;market&#39;</span>: market_conditions,</span>
<span id="cb363-35"><a href="#cb363-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;temporal&#39;</span>: temporal_factors,</span>
<span id="cb363-36"><a href="#cb363-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;external&#39;</span>: external_factors</span>
<span id="cb363-37"><a href="#cb363-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb363-38"><a href="#cb363-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb363-39"><a href="#cb363-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> correct_interpretation(<span class="va">self</span>, probabilities, context_analysis):</span>
<span id="cb363-40"><a href="#cb363-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb363-41"><a href="#cb363-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-42"><a href="#cb363-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π</span></span>
<span id="cb363-43"><a href="#cb363-43" aria-hidden="true" tabindex="-1"></a>        market_corrected <span class="op">=</span> <span class="va">self</span>.market_correction(probabilities, context_analysis[<span class="st">&#39;market&#39;</span>])</span>
<span id="cb363-44"><a href="#cb363-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-45"><a href="#cb363-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</span></span>
<span id="cb363-46"><a href="#cb363-46" aria-hidden="true" tabindex="-1"></a>        temporal_corrected <span class="op">=</span> <span class="va">self</span>.temporal_correction(market_corrected, context_analysis[<span class="st">&#39;temporal&#39;</span>])</span>
<span id="cb363-47"><a href="#cb363-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-48"><a href="#cb363-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</span></span>
<span id="cb363-49"><a href="#cb363-49" aria-hidden="true" tabindex="-1"></a>        external_corrected <span class="op">=</span> <span class="va">self</span>.external_correction(temporal_corrected, context_analysis[<span class="st">&#39;external&#39;</span>])</span>
<span id="cb363-50"><a href="#cb363-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb363-51"><a href="#cb363-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> external_corrected</span></code></pre></div>
<h3 data-number="25.4.3" id="–ø—Ä–æ–±–ª–µ–º—ã-—Å-–∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π"><span
class="header-section-number">25.4.3</span> 3. –ü—Ä–æ–±–ª–µ–º—ã —Å
–∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</h3>
<div class="sourceCode" id="cb364"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CalibrationIssues:</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.calibration_problems <span class="op">=</span> {}</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> identify_calibration_issues(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π</span></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>        calibration_curve <span class="op">=</span> <span class="va">self</span>.analyze_calibration_curve(probabilities, true_labels)</span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏</span></span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>        reliability_analysis <span class="op">=</span> <span class="va">self</span>.analyze_reliability(probabilities, true_labels)</span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑–æ–ª—é—Ü–∏–∏</span></span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>        resolution_analysis <span class="op">=</span> <span class="va">self</span>.analyze_resolution(probabilities, true_labels)</span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;calibration_curve&#39;</span>: calibration_curve,</span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reliability&#39;</span>: reliability_analysis,</span>
<span id="cb364-22"><a href="#cb364-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;resolution&#39;</span>: resolution_analysis</span>
<span id="cb364-23"><a href="#cb364-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb364-24"><a href="#cb364-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-25"><a href="#cb364-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_calibration_curve(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb364-26"><a href="#cb364-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π&quot;&quot;&quot;</span></span>
<span id="cb364-27"><a href="#cb364-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-28"><a href="#cb364-28" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.calibration <span class="im">import</span> calibration_curve</span>
<span id="cb364-29"><a href="#cb364-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-30"><a href="#cb364-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π</span></span>
<span id="cb364-31"><a href="#cb364-31" aria-hidden="true" tabindex="-1"></a>        fraction_of_positives, mean_predicted_value <span class="op">=</span> calibration_curve(</span>
<span id="cb364-32"><a href="#cb364-32" aria-hidden="true" tabindex="-1"></a>            true_labels, </span>
<span id="cb364-33"><a href="#cb364-33" aria-hidden="true" tabindex="-1"></a>            probabilities, </span>
<span id="cb364-34"><a href="#cb364-34" aria-hidden="true" tabindex="-1"></a>            n_bins<span class="op">=</span><span class="dv">10</span></span>
<span id="cb364-35"><a href="#cb364-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb364-36"><a href="#cb364-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-37"><a href="#cb364-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π</span></span>
<span id="cb364-38"><a href="#cb364-38" aria-hidden="true" tabindex="-1"></a>        deviations <span class="op">=</span> np.<span class="bu">abs</span>(fraction_of_positives <span class="op">-</span> mean_predicted_value)</span>
<span id="cb364-39"><a href="#cb364-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-40"><a href="#cb364-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–∏—Ç–µ—Ä–∏–π –ø–ª–æ—Ö–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏</span></span>
<span id="cb364-41"><a href="#cb364-41" aria-hidden="true" tabindex="-1"></a>        bad_calibration <span class="op">=</span> np.mean(deviations) <span class="op">&gt;</span> <span class="fl">0.1</span></span>
<span id="cb364-42"><a href="#cb364-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb364-43"><a href="#cb364-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb364-44"><a href="#cb364-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;curve&#39;</span>: (fraction_of_positives, mean_predicted_value),</span>
<span id="cb364-45"><a href="#cb364-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deviations&#39;</span>: deviations,</span>
<span id="cb364-46"><a href="#cb364-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bad_calibration&#39;</span>: bad_calibration</span>
<span id="cb364-47"><a href="#cb364-47" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="25.5"
id="–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.5</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 data-number="25.5.1" id="–≤–∞–ª–∏–¥–∞—Ü–∏—è-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π"><span
class="header-section-number">25.5.1</span> 1. –í–∞–ª–∏–¥–∞—Ü–∏—è
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="sourceCode" id="cb365"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityValidation:</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.validation_methods <span class="op">=</span> {}</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_probabilities(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>        cv_validation <span class="op">=</span> <span class="va">self</span>.cross_validation(probabilities, true_labels)</span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>        temporal_validation <span class="op">=</span> <span class="va">self</span>.temporal_validation(probabilities, true_labels)</span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span></span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>        stochastic_validation <span class="op">=</span> <span class="va">self</span>.stochastic_validation(probabilities, true_labels)</span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cv&#39;</span>: cv_validation,</span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;temporal&#39;</span>: temporal_validation,</span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;stochastic&#39;</span>: stochastic_validation</span>
<span id="cb365-23"><a href="#cb365-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb365-24"><a href="#cb365-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb365-25"><a href="#cb365-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cross_validation(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb365-26"><a href="#cb365-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb365-27"><a href="#cb365-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-28"><a href="#cb365-28" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb365-29"><a href="#cb365-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-30"><a href="#cb365-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</span></span>
<span id="cb365-31"><a href="#cb365-31" aria-hidden="true" tabindex="-1"></a>        cv_scores <span class="op">=</span> cross_val_score(</span>
<span id="cb365-32"><a href="#cb365-32" aria-hidden="true" tabindex="-1"></a>            probabilities, </span>
<span id="cb365-33"><a href="#cb365-33" aria-hidden="true" tabindex="-1"></a>            true_labels, </span>
<span id="cb365-34"><a href="#cb365-34" aria-hidden="true" tabindex="-1"></a>            cv<span class="op">=</span><span class="dv">5</span>, </span>
<span id="cb365-35"><a href="#cb365-35" aria-hidden="true" tabindex="-1"></a>            scoring<span class="op">=</span><span class="st">&#39;neg_log_loss&#39;</span></span>
<span id="cb365-36"><a href="#cb365-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb365-37"><a href="#cb365-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb365-38"><a href="#cb365-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb365-39"><a href="#cb365-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;scores&#39;</span>: cv_scores,</span>
<span id="cb365-40"><a href="#cb365-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mean_score&#39;</span>: np.mean(cv_scores),</span>
<span id="cb365-41"><a href="#cb365-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;std_score&#39;</span>: np.std(cv_scores)</span>
<span id="cb365-42"><a href="#cb365-42" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="25.5.2" id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-2"><span
class="header-section-number">25.5.2</span> 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb366"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityMonitoring:</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.monitoring_metrics <span class="op">=</span> {}</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> monitor_performance(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –ø–æ—Ç–µ—Ä—è</span></span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>        log_loss <span class="op">=</span> <span class="va">self</span>.calculate_log_loss(probabilities, true_labels)</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Brier Score</span></span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>        brier_score <span class="op">=</span> <span class="va">self</span>.calculate_brier_score(probabilities, true_labels)</span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–∞—è –æ—à–∏–±–∫–∞</span></span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>        calibration_error <span class="op">=</span> <span class="va">self</span>.calculate_calibration_error(probabilities, true_labels)</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb366-20"><a href="#cb366-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;log_loss&#39;</span>: log_loss,</span>
<span id="cb366-21"><a href="#cb366-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;brier_score&#39;</span>: brier_score,</span>
<span id="cb366-22"><a href="#cb366-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;calibration_error&#39;</span>: calibration_error</span>
<span id="cb366-23"><a href="#cb366-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb366-24"><a href="#cb366-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-25"><a href="#cb366-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_log_loss(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb366-26"><a href="#cb366-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –ø–æ—Ç–µ—Ä–∏&quot;&quot;&quot;</span></span>
<span id="cb366-27"><a href="#cb366-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-28"><a href="#cb366-28" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.metrics <span class="im">import</span> log_loss</span>
<span id="cb366-29"><a href="#cb366-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-30"><a href="#cb366-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –ø–æ—Ç–µ—Ä—è</span></span>
<span id="cb366-31"><a href="#cb366-31" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> log_loss(true_labels, probabilities)</span>
<span id="cb366-32"><a href="#cb366-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-33"><a href="#cb366-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loss</span>
<span id="cb366-34"><a href="#cb366-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb366-35"><a href="#cb366-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_brier_score(<span class="va">self</span>, probabilities, true_labels):</span>
<span id="cb366-36"><a href="#cb366-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç Brier Score&quot;&quot;&quot;</span></span>
<span id="cb366-37"><a href="#cb366-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-38"><a href="#cb366-38" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.metrics <span class="im">import</span> brier_score_loss</span>
<span id="cb366-39"><a href="#cb366-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-40"><a href="#cb366-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Brier Score</span></span>
<span id="cb366-41"><a href="#cb366-41" aria-hidden="true" tabindex="-1"></a>        score <span class="op">=</span> brier_score_loss(true_labels, probabilities)</span>
<span id="cb366-42"><a href="#cb366-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb366-43"><a href="#cb366-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> score</span></code></pre></div>
<h2 data-number="25.6" id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–∏–º–µ—Ä—ã-1"><span
class="header-section-number">25.6</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</h2>
<h3 data-number="25.6.1" id="—Ç–æ—Ä–≥–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-–Ω–∞-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö"><span
class="header-section-number">25.6.1</span> 1. –¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞
–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</h3>
<div class="sourceCode" id="cb367"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityTradingSystem:</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.probability_thresholds <span class="op">=</span> {}</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_management <span class="op">=</span> {}</span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_trading_signals(<span class="va">self</span>, probabilities, market_data):</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a>        prob_analysis <span class="op">=</span> <span class="va">self</span>.analyze_probabilities(probabilities)</span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</span></span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a>        signals <span class="op">=</span> <span class="va">self</span>.generate_signals(prob_analysis, market_data)</span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏</span></span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a>        risk_adjusted_signals <span class="op">=</span> <span class="va">self</span>.adjust_for_risk(signals, probabilities)</span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> risk_adjusted_signals</span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_probabilities(<span class="va">self</span>, probabilities):</span>
<span id="cb367-23"><a href="#cb367-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb367-24"><a href="#cb367-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-25"><a href="#cb367-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</span></span>
<span id="cb367-26"><a href="#cb367-26" aria-hidden="true" tabindex="-1"></a>        mean_prob <span class="op">=</span> np.mean(probabilities)</span>
<span id="cb367-27"><a href="#cb367-27" aria-hidden="true" tabindex="-1"></a>        std_prob <span class="op">=</span> np.std(probabilities)</span>
<span id="cb367-28"><a href="#cb367-28" aria-hidden="true" tabindex="-1"></a>        max_prob <span class="op">=</span> np.<span class="bu">max</span>(probabilities)</span>
<span id="cb367-29"><a href="#cb367-29" aria-hidden="true" tabindex="-1"></a>        min_prob <span class="op">=</span> np.<span class="bu">min</span>(probabilities)</span>
<span id="cb367-30"><a href="#cb367-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-31"><a href="#cb367-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb367-32"><a href="#cb367-32" aria-hidden="true" tabindex="-1"></a>        prob_distribution <span class="op">=</span> <span class="va">self</span>.analyze_distribution(probabilities)</span>
<span id="cb367-33"><a href="#cb367-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-34"><a href="#cb367-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb367-35"><a href="#cb367-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;mean&#39;</span>: mean_prob,</span>
<span id="cb367-36"><a href="#cb367-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;std&#39;</span>: std_prob,</span>
<span id="cb367-37"><a href="#cb367-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max&#39;</span>: max_prob,</span>
<span id="cb367-38"><a href="#cb367-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;min&#39;</span>: min_prob,</span>
<span id="cb367-39"><a href="#cb367-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;distribution&#39;</span>: prob_distribution</span>
<span id="cb367-40"><a href="#cb367-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb367-41"><a href="#cb367-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb367-42"><a href="#cb367-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_signals(<span class="va">self</span>, prob_analysis, market_data):</span>
<span id="cb367-43"><a href="#cb367-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb367-44"><a href="#cb367-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-45"><a href="#cb367-45" aria-hidden="true" tabindex="-1"></a>        signals <span class="op">=</span> []</span>
<span id="cb367-46"><a href="#cb367-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-47"><a href="#cb367-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, prob <span class="kw">in</span> <span class="bu">enumerate</span>(prob_analysis[<span class="st">&#39;probabilities&#39;</span>]):</span>
<span id="cb367-48"><a href="#cb367-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prob <span class="op">&gt;</span> <span class="fl">0.8</span>:</span>
<span id="cb367-49"><a href="#cb367-49" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —Å–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª</span></span>
<span id="cb367-50"><a href="#cb367-50" aria-hidden="true" tabindex="-1"></a>                signal <span class="op">=</span> {</span>
<span id="cb367-51"><a href="#cb367-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;BUY&#39;</span>,</span>
<span id="cb367-52"><a href="#cb367-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strength&#39;</span>: <span class="st">&#39;STRONG&#39;</span>,</span>
<span id="cb367-53"><a href="#cb367-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;confidence&#39;</span>: prob,</span>
<span id="cb367-54"><a href="#cb367-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: market_data[i][<span class="st">&#39;timestamp&#39;</span>]</span>
<span id="cb367-55"><a href="#cb367-55" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb367-56"><a href="#cb367-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> prob <span class="op">&gt;</span> <span class="fl">0.6</span>:</span>
<span id="cb367-57"><a href="#cb367-57" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–º–µ—Ä–µ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª</span></span>
<span id="cb367-58"><a href="#cb367-58" aria-hidden="true" tabindex="-1"></a>                signal <span class="op">=</span> {</span>
<span id="cb367-59"><a href="#cb367-59" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;BUY&#39;</span>,</span>
<span id="cb367-60"><a href="#cb367-60" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strength&#39;</span>: <span class="st">&#39;MODERATE&#39;</span>,</span>
<span id="cb367-61"><a href="#cb367-61" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;confidence&#39;</span>: prob,</span>
<span id="cb367-62"><a href="#cb367-62" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: market_data[i][<span class="st">&#39;timestamp&#39;</span>]</span>
<span id="cb367-63"><a href="#cb367-63" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb367-64"><a href="#cb367-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> prob <span class="op">&lt;</span> <span class="fl">0.2</span>:</span>
<span id="cb367-65"><a href="#cb367-65" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —Å–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–∞–∂–∏</span></span>
<span id="cb367-66"><a href="#cb367-66" aria-hidden="true" tabindex="-1"></a>                signal <span class="op">=</span> {</span>
<span id="cb367-67"><a href="#cb367-67" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;SELL&#39;</span>,</span>
<span id="cb367-68"><a href="#cb367-68" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strength&#39;</span>: <span class="st">&#39;STRONG&#39;</span>,</span>
<span id="cb367-69"><a href="#cb367-69" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;confidence&#39;</span>: <span class="dv">1</span> <span class="op">-</span> prob,</span>
<span id="cb367-70"><a href="#cb367-70" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: market_data[i][<span class="st">&#39;timestamp&#39;</span>]</span>
<span id="cb367-71"><a href="#cb367-71" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb367-72"><a href="#cb367-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb367-73"><a href="#cb367-73" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞</span></span>
<span id="cb367-74"><a href="#cb367-74" aria-hidden="true" tabindex="-1"></a>                signal <span class="op">=</span> {</span>
<span id="cb367-75"><a href="#cb367-75" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;HOLD&#39;</span>,</span>
<span id="cb367-76"><a href="#cb367-76" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;strength&#39;</span>: <span class="st">&#39;NONE&#39;</span>,</span>
<span id="cb367-77"><a href="#cb367-77" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;confidence&#39;</span>: <span class="fl">0.5</span>,</span>
<span id="cb367-78"><a href="#cb367-78" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;timestamp&#39;</span>: market_data[i][<span class="st">&#39;timestamp&#39;</span>]</span>
<span id="cb367-79"><a href="#cb367-79" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb367-80"><a href="#cb367-80" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb367-81"><a href="#cb367-81" aria-hidden="true" tabindex="-1"></a>            signals.append(signal)</span>
<span id="cb367-82"><a href="#cb367-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb367-83"><a href="#cb367-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> signals</span></code></pre></div>
<h3 data-number="25.6.2" id="–ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"><span
class="header-section-number">25.6.2</span> 2. –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ
—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
<div class="sourceCode" id="cb368"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProbabilityPortfolioManagement:</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.portfolio_weights <span class="op">=</span> {}</span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.risk_budget <span class="op">=</span> {}</span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> optimize_portfolio(<span class="va">self</span>, asset_probabilities, risk_budget):</span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> <span class="va">self</span>.calculate_weights(asset_probabilities)</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ä–∏—Å–∫</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>        risk_adjusted_weights <span class="op">=</span> <span class="va">self</span>.adjust_for_risk(weights, risk_budget)</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span></span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>        optimized_weights <span class="op">=</span> <span class="va">self</span>.optimize_allocation(risk_adjusted_weights)</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> optimized_weights</span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_weights(<span class="va">self</span>, asset_probabilities):</span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span></span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span></span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a>        normalized_probs <span class="op">=</span> asset_probabilities <span class="op">/</span> np.<span class="bu">sum</span>(asset_probabilities)</span>
<span id="cb368-27"><a href="#cb368-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-28"><a href="#cb368-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –¥–∏—Å–ø–µ—Ä—Å–∏—é</span></span>
<span id="cb368-29"><a href="#cb368-29" aria-hidden="true" tabindex="-1"></a>        variance_adjusted <span class="op">=</span> <span class="va">self</span>.adjust_for_variance(normalized_probs)</span>
<span id="cb368-30"><a href="#cb368-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-31"><a href="#cb368-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> variance_adjusted</span>
<span id="cb368-32"><a href="#cb368-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb368-33"><a href="#cb368-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> adjust_for_risk(<span class="va">self</span>, weights, risk_budget):</span>
<span id="cb368-34"><a href="#cb368-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ä–∏—Å–∫&quot;&quot;&quot;</span></span>
<span id="cb368-35"><a href="#cb368-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-36"><a href="#cb368-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è</span></span>
<span id="cb368-37"><a href="#cb368-37" aria-hidden="true" tabindex="-1"></a>        portfolio_risk <span class="op">=</span> <span class="va">self</span>.calculate_portfolio_risk(weights)</span>
<span id="cb368-38"><a href="#cb368-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-39"><a href="#cb368-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤</span></span>
<span id="cb368-40"><a href="#cb368-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> portfolio_risk <span class="op">&gt;</span> risk_budget:</span>
<span id="cb368-41"><a href="#cb368-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span></span>
<span id="cb368-42"><a href="#cb368-42" aria-hidden="true" tabindex="-1"></a>            adjustment_factor <span class="op">=</span> risk_budget <span class="op">/</span> portfolio_risk</span>
<span id="cb368-43"><a href="#cb368-43" aria-hidden="true" tabindex="-1"></a>            adjusted_weights <span class="op">=</span> weights <span class="op">*</span> adjustment_factor</span>
<span id="cb368-44"><a href="#cb368-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb368-45"><a href="#cb368-45" aria-hidden="true" tabindex="-1"></a>            adjusted_weights <span class="op">=</span> weights</span>
<span id="cb368-46"><a href="#cb368-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb368-47"><a href="#cb368-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> adjusted_weights</span></code></pre></div>
<h2 data-number="25.7" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-13"><span
class="header-section-number">25.7</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π - —ç—Ç–æ –∫–ª—é—á –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–æ–±–∞—Å—Ç–Ω—ã—Ö
–∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö –∏ —Å–ª–∞–±—ã—Ö —Å—Ç–æ—Ä–æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç
—Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<h3 data-number="25.7.1" id="–∫–ª—é—á–µ–≤—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã"><span
class="header-section-number">25.7.1</span> –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:</h3>
<ol type="1">
<li><strong>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</strong> - –≤—Å–µ–≥–¥–∞ –∫–∞–ª–∏–±—Ä—É–π—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</li>
<li><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è</strong> - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong> - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –¥—Ä–∏—Ñ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</strong> - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ
—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è
—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏</li>
</ol>
<p>–°–ª–µ–¥—É—è —ç—Ç–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º, –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ
—Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 data-number="26"
id="–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞---–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏"><span
class="header-section-number">26</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ -
–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h1>
<h2 data-number="26.0" id="–ø–æ—á–µ–º—É-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞-—Ç–∞–∫-–≤–∞–∂–µ–Ω"><span class="header-section-number">26.0</span> –ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ —Ç–∞–∫ –≤–∞–∂–µ–Ω</h2>

<p><strong>–ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ ML-–ø—Ä–æ–µ–∫—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.</p>

<h3 data-number="26.0.1" id="–ø—Ä–æ–±–ª–µ–º—ã-–±–µ–∑-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞"><span class="header-section-number">26.0.1</span> –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞</h3>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞?</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–ª–∏ –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</p>

<ul>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:</strong> –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ</li>
<li><strong>–ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏:</strong> –¢—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –¥–æ–≤–µ—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º–µ</li>
</ul>

<h3 data-number="26.0.2" id="–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞"><span class="header-section-number">26.0.2</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞</h3>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞?</strong> –°—Ç–∞–±–∏–ª—å–Ω—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã:</p>

<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:</strong> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω—ã–µ –∏ –ø–æ–ª–Ω—ã–µ</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏:</strong> –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</strong> –°–∏—Å—Ç–µ–º–∞ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>


<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 data-number="26.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-8"><span
class="header-section-number">26.1</span> –í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è
—Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –ª—É—á—à–∏–º
–ø—Ä–∞–∫—Ç–∏–∫–∞–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã,
–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É
—Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.</p>
<h2 data-number="26.2" id="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">26.2</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<h3 data-number="26.2.1" id="–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">26.2.1</span> 1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="sourceCode" id="cb369"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TradingBotMonitoringSystem:</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_collector <span class="op">=</span> MetricsCollector()</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_manager <span class="op">=</span> AlertManager()</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dashboard <span class="op">=</span> MonitoringDashboard()</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_analyzer <span class="op">=</span> LogAnalyzer()</span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_tracker <span class="op">=</span> PerformanceTracker()</span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.health_checker <span class="op">=</span> HealthChecker()</span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> start_monitoring(<span class="va">self</span>):</span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span></span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_collector.start()</span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_manager.start()</span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dashboard.start()</span>
<span id="cb369-19"><a href="#cb369-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_analyzer.start()</span>
<span id="cb369-20"><a href="#cb369-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_tracker.start()</span>
<span id="cb369-21"><a href="#cb369-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.health_checker.start()</span>
<span id="cb369-22"><a href="#cb369-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb369-23"><a href="#cb369-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–ø—É—â–µ–Ω–∞&quot;</span>)</span>
<span id="cb369-24"><a href="#cb369-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb369-25"><a href="#cb369-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> stop_monitoring(<span class="va">self</span>):</span>
<span id="cb369-26"><a href="#cb369-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb369-27"><a href="#cb369-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb369-28"><a href="#cb369-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span></span>
<span id="cb369-29"><a href="#cb369-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_collector.stop()</span>
<span id="cb369-30"><a href="#cb369-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_manager.stop()</span>
<span id="cb369-31"><a href="#cb369-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dashboard.stop()</span>
<span id="cb369-32"><a href="#cb369-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_analyzer.stop()</span>
<span id="cb369-33"><a href="#cb369-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_tracker.stop()</span>
<span id="cb369-34"><a href="#cb369-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.health_checker.stop()</span>
<span id="cb369-35"><a href="#cb369-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb369-36"><a href="#cb369-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚èπÔ∏è –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞&quot;</span>)</span></code></pre></div>
<h3 data-number="26.2.2" id="—Å–±–æ—Ä-–º–µ—Ç—Ä–∏–∫"><span
class="header-section-number">26.2.2</span> 2. –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h3>
<div class="sourceCode" id="cb370"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MetricsCollector:</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–°–±–æ—Ä—â–∏–∫ –º–µ—Ç—Ä–∏–∫ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics <span class="op">=</span> {}</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.collection_interval <span class="op">=</span> <span class="dv">60</span>  <span class="co"># —Å–µ–∫—É–Ω–¥</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_storage <span class="op">=</span> MetricsStorage()</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_trading_metrics(<span class="va">self</span>, bot_state):</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>        trading_metrics <span class="op">=</span> {</span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span></span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;total_trades&#39;</span>: bot_state.get(<span class="st">&#39;total_trades&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;winning_trades&#39;</span>: bot_state.get(<span class="st">&#39;winning_trades&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;losing_trades&#39;</span>: bot_state.get(<span class="st">&#39;losing_trades&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-17"><a href="#cb370-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;win_rate&#39;</span>: <span class="va">self</span>.calculate_win_rate(bot_state),</span>
<span id="cb370-18"><a href="#cb370-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;profit_loss&#39;</span>: bot_state.get(<span class="st">&#39;profit_loss&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-19"><a href="#cb370-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_drawdown&#39;</span>: bot_state.get(<span class="st">&#39;max_drawdown&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-20"><a href="#cb370-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sharpe_ratio&#39;</span>: <span class="va">self</span>.calculate_sharpe_ratio(bot_state),</span>
<span id="cb370-21"><a href="#cb370-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-22"><a href="#cb370-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span></span>
<span id="cb370-23"><a href="#cb370-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trades_per_hour&#39;</span>: <span class="va">self</span>.calculate_trades_per_hour(bot_state),</span>
<span id="cb370-24"><a href="#cb370-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;last_trade_time&#39;</span>: bot_state.get(<span class="st">&#39;last_trade_time&#39;</span>),</span>
<span id="cb370-25"><a href="#cb370-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;active_positions&#39;</span>: bot_state.get(<span class="st">&#39;active_positions&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-26"><a href="#cb370-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pending_orders&#39;</span>: bot_state.get(<span class="st">&#39;pending_orders&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-27"><a href="#cb370-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-28"><a href="#cb370-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†–∏—Å–∫–∏</span></span>
<span id="cb370-29"><a href="#cb370-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;current_exposure&#39;</span>: bot_state.get(<span class="st">&#39;current_exposure&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-30"><a href="#cb370-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk_utilization&#39;</span>: <span class="va">self</span>.calculate_risk_utilization(bot_state),</span>
<span id="cb370-31"><a href="#cb370-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;var_95&#39;</span>: <span class="va">self</span>.calculate_var_95(bot_state),</span>
<span id="cb370-32"><a href="#cb370-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;expected_shortfall&#39;</span>: <span class="va">self</span>.calculate_expected_shortfall(bot_state),</span>
<span id="cb370-33"><a href="#cb370-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-34"><a href="#cb370-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ</span></span>
<span id="cb370-35"><a href="#cb370-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cpu_usage&#39;</span>: bot_state.get(<span class="st">&#39;cpu_usage&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-36"><a href="#cb370-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_usage&#39;</span>: bot_state.get(<span class="st">&#39;memory_usage&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-37"><a href="#cb370-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;disk_usage&#39;</span>: bot_state.get(<span class="st">&#39;disk_usage&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-38"><a href="#cb370-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;network_latency&#39;</span>: bot_state.get(<span class="st">&#39;network_latency&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-39"><a href="#cb370-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;api_calls_per_minute&#39;</span>: bot_state.get(<span class="st">&#39;api_calls_per_minute&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-40"><a href="#cb370-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error_rate&#39;</span>: bot_state.get(<span class="st">&#39;error_rate&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-41"><a href="#cb370-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-42"><a href="#cb370-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span></span>
<span id="cb370-43"><a href="#cb370-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb370-44"><a href="#cb370-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;uptime&#39;</span>: <span class="va">self</span>.calculate_uptime(bot_state)</span>
<span id="cb370-45"><a href="#cb370-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb370-46"><a href="#cb370-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-47"><a href="#cb370-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> trading_metrics</span>
<span id="cb370-48"><a href="#cb370-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb370-49"><a href="#cb370-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_model_metrics(<span class="va">self</span>, model_state):</span>
<span id="cb370-50"><a href="#cb370-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ ML-–º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb370-51"><a href="#cb370-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-52"><a href="#cb370-52" aria-hidden="true" tabindex="-1"></a>        model_metrics <span class="op">=</span> {</span>
<span id="cb370-53"><a href="#cb370-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</span></span>
<span id="cb370-54"><a href="#cb370-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_accuracy&#39;</span>: model_state.get(<span class="st">&#39;accuracy&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-55"><a href="#cb370-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_precision&#39;</span>: model_state.get(<span class="st">&#39;precision&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-56"><a href="#cb370-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_recall&#39;</span>: model_state.get(<span class="st">&#39;recall&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-57"><a href="#cb370-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_f1_score&#39;</span>: model_state.get(<span class="st">&#39;f1_score&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-58"><a href="#cb370-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_auc&#39;</span>: model_state.get(<span class="st">&#39;auc&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-59"><a href="#cb370-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-60"><a href="#cb370-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</span></span>
<span id="cb370-61"><a href="#cb370-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction_confidence&#39;</span>: model_state.get(<span class="st">&#39;prediction_confidence&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-62"><a href="#cb370-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prediction_uncertainty&#39;</span>: model_state.get(<span class="st">&#39;prediction_uncertainty&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-63"><a href="#cb370-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;last_prediction_time&#39;</span>: model_state.get(<span class="st">&#39;last_prediction_time&#39;</span>),</span>
<span id="cb370-64"><a href="#cb370-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;predictions_per_hour&#39;</span>: model_state.get(<span class="st">&#39;predictions_per_hour&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-65"><a href="#cb370-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-66"><a href="#cb370-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –î—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏</span></span>
<span id="cb370-67"><a href="#cb370-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_drift_detected&#39;</span>: model_state.get(<span class="st">&#39;drift_detected&#39;</span>, <span class="va">False</span>),</span>
<span id="cb370-68"><a href="#cb370-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;drift_score&#39;</span>: model_state.get(<span class="st">&#39;drift_score&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-69"><a href="#cb370-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;last_retraining&#39;</span>: model_state.get(<span class="st">&#39;last_retraining&#39;</span>),</span>
<span id="cb370-70"><a href="#cb370-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;retraining_frequency&#39;</span>: model_state.get(<span class="st">&#39;retraining_frequency&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-71"><a href="#cb370-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-72"><a href="#cb370-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö</span></span>
<span id="cb370-73"><a href="#cb370-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_quality_score&#39;</span>: model_state.get(<span class="st">&#39;data_quality_score&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-74"><a href="#cb370-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;missing_data_rate&#39;</span>: model_state.get(<span class="st">&#39;missing_data_rate&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-75"><a href="#cb370-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;outlier_rate&#39;</span>: model_state.get(<span class="st">&#39;outlier_rate&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-76"><a href="#cb370-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_freshness&#39;</span>: model_state.get(<span class="st">&#39;data_freshness&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-77"><a href="#cb370-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-78"><a href="#cb370-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span></span>
<span id="cb370-79"><a href="#cb370-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb370-80"><a href="#cb370-80" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb370-81"><a href="#cb370-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-82"><a href="#cb370-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> model_metrics</span>
<span id="cb370-83"><a href="#cb370-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb370-84"><a href="#cb370-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> collect_market_metrics(<span class="va">self</span>, market_data):</span>
<span id="cb370-85"><a href="#cb370-85" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–±–æ—Ä —Ä—ã–Ω–æ—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb370-86"><a href="#cb370-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-87"><a href="#cb370-87" aria-hidden="true" tabindex="-1"></a>        market_metrics <span class="op">=</span> {</span>
<span id="cb370-88"><a href="#cb370-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –†—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</span></span>
<span id="cb370-89"><a href="#cb370-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;market_volatility&#39;</span>: market_data.get(<span class="st">&#39;volatility&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-90"><a href="#cb370-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;market_trend&#39;</span>: market_data.get(<span class="st">&#39;trend&#39;</span>, <span class="st">&#39;unknown&#39;</span>),</span>
<span id="cb370-91"><a href="#cb370-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;market_regime&#39;</span>: market_data.get(<span class="st">&#39;regime&#39;</span>, <span class="st">&#39;unknown&#39;</span>),</span>
<span id="cb370-92"><a href="#cb370-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;liquidity_score&#39;</span>: market_data.get(<span class="st">&#39;liquidity_score&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-93"><a href="#cb370-93" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-94"><a href="#cb370-94" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¶–µ–Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb370-95"><a href="#cb370-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_change_1h&#39;</span>: market_data.get(<span class="st">&#39;price_change_1h&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-96"><a href="#cb370-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;price_change_24h&#39;</span>: market_data.get(<span class="st">&#39;price_change_24h&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-97"><a href="#cb370-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volume_24h&#39;</span>: market_data.get(<span class="st">&#39;volume_24h&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-98"><a href="#cb370-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;volume_change_24h&#39;</span>: market_data.get(<span class="st">&#39;volume_change_24h&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-99"><a href="#cb370-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-100"><a href="#cb370-100" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span></span>
<span id="cb370-101"><a href="#cb370-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;rsi&#39;</span>: market_data.get(<span class="st">&#39;rsi&#39;</span>, <span class="dv">50</span>),</span>
<span id="cb370-102"><a href="#cb370-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;macd&#39;</span>: market_data.get(<span class="st">&#39;macd&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-103"><a href="#cb370-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bollinger_position&#39;</span>: market_data.get(<span class="st">&#39;bollinger_position&#39;</span>, <span class="fl">0.5</span>),</span>
<span id="cb370-104"><a href="#cb370-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;support_resistance_strength&#39;</span>: market_data.get(<span class="st">&#39;support_resistance_strength&#39;</span>, <span class="dv">0</span>),</span>
<span id="cb370-105"><a href="#cb370-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb370-106"><a href="#cb370-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span></span>
<span id="cb370-107"><a href="#cb370-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb370-108"><a href="#cb370-108" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb370-109"><a href="#cb370-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb370-110"><a href="#cb370-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> market_metrics</span></code></pre></div>
<h3 data-number="26.2.3" id="—Å–∏—Å—Ç–µ–º–∞-–∞–ª–µ—Ä—Ç–æ–≤"><span
class="header-section-number">26.2.3</span> 3. –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤</h3>
<div class="sourceCode" id="cb371"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AlertManager:</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_rules <span class="op">=</span> {}</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_channels <span class="op">=</span> {}</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_history <span class="op">=</span> []</span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_cooldown <span class="op">=</span> {}</span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_alert_rules(<span class="va">self</span>):</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_rules <span class="op">=</span> {</span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;critical&#39;</span>: {</span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;bot_down&#39;</span>: {</span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;uptime&#39;</span>, <span class="dv">0</span>) <span class="op">==</span> <span class="dv">0</span>,</span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!&#39;</span>,</span>
<span id="cb371-19"><a href="#cb371-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;sms&#39;</span>, <span class="st">&#39;telegram&#39;</span>, <span class="st">&#39;slack&#39;</span>],</span>
<span id="cb371-20"><a href="#cb371-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">300</span>  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb371-21"><a href="#cb371-21" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb371-22"><a href="#cb371-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;high_drawdown&#39;</span>: {</span>
<span id="cb371-23"><a href="#cb371-23" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;max_drawdown&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="fl">0.1</span>,</span>
<span id="cb371-24"><a href="#cb371-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ </span><span class="sc">{max_drawdown:.2%}</span><span class="st">!&#39;</span>,</span>
<span id="cb371-25"><a href="#cb371-25" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;sms&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-26"><a href="#cb371-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">600</span>  <span class="co"># 10 –º–∏–Ω—É—Ç</span></span>
<span id="cb371-27"><a href="#cb371-27" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb371-28"><a href="#cb371-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;api_error_rate&#39;</span>: {</span>
<span id="cb371-29"><a href="#cb371-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;error_rate&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="fl">0.05</span>,</span>
<span id="cb371-30"><a href="#cb371-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫ API </span><span class="sc">{error_rate:.2%}</span><span class="st">!&#39;</span>,</span>
<span id="cb371-31"><a href="#cb371-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-32"><a href="#cb371-32" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">300</span></span>
<span id="cb371-33"><a href="#cb371-33" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb371-34"><a href="#cb371-34" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb371-35"><a href="#cb371-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb371-36"><a href="#cb371-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</span></span>
<span id="cb371-37"><a href="#cb371-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;warning&#39;</span>: {</span>
<span id="cb371-38"><a href="#cb371-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;low_win_rate&#39;</span>: {</span>
<span id="cb371-39"><a href="#cb371-39" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;win_rate&#39;</span>, <span class="dv">0</span>) <span class="op">&lt;</span> <span class="fl">0.4</span>,</span>
<span id="cb371-40"><a href="#cb371-40" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ </span><span class="sc">{win_rate:.2%}</span><span class="st">&#39;</span>,</span>
<span id="cb371-41"><a href="#cb371-41" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-42"><a href="#cb371-42" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">1800</span>  <span class="co"># 30 –º–∏–Ω—É—Ç</span></span>
<span id="cb371-43"><a href="#cb371-43" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb371-44"><a href="#cb371-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;model_drift&#39;</span>: {</span>
<span id="cb371-45"><a href="#cb371-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;model_drift_detected&#39;</span>, <span class="va">False</span>),</span>
<span id="cb371-46"><a href="#cb371-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏!&#39;</span>,</span>
<span id="cb371-47"><a href="#cb371-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-48"><a href="#cb371-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">3600</span>  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb371-49"><a href="#cb371-49" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb371-50"><a href="#cb371-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;high_latency&#39;</span>: {</span>
<span id="cb371-51"><a href="#cb371-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: metrics.get(<span class="st">&#39;network_latency&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="dv">1000</span>,</span>
<span id="cb371-52"><a href="#cb371-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏ </span><span class="sc">{latency}</span><span class="st">ms&#39;</span>,</span>
<span id="cb371-53"><a href="#cb371-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-54"><a href="#cb371-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">900</span>  <span class="co"># 15 –º–∏–Ω—É—Ç</span></span>
<span id="cb371-55"><a href="#cb371-55" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb371-56"><a href="#cb371-56" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb371-57"><a href="#cb371-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb371-58"><a href="#cb371-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ</span></span>
<span id="cb371-59"><a href="#cb371-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;info&#39;</span>: {</span>
<span id="cb371-60"><a href="#cb371-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;daily_summary&#39;</span>: {</span>
<span id="cb371-61"><a href="#cb371-61" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: <span class="va">self</span>.is_daily_summary_time(),</span>
<span id="cb371-62"><a href="#cb371-62" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç: P&amp;L: </span><span class="sc">{profit_loss:.2f}</span><span class="st">, –°–¥–µ–ª–∫–∏: </span><span class="sc">{total_trades}</span><span class="st">&#39;</span>,</span>
<span id="cb371-63"><a href="#cb371-63" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-64"><a href="#cb371-64" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">86400</span>  <span class="co"># 24 —á–∞—Å–∞</span></span>
<span id="cb371-65"><a href="#cb371-65" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb371-66"><a href="#cb371-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;milestone_reached&#39;</span>: {</span>
<span id="cb371-67"><a href="#cb371-67" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;condition&#39;</span>: <span class="kw">lambda</span> metrics: <span class="va">self</span>.is_milestone_reached(metrics),</span>
<span id="cb371-68"><a href="#cb371-68" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;message&#39;</span>: <span class="st">&#39;üéâ –î–û–°–¢–ò–ñ–ï–ù–ò–ï: </span><span class="sc">{milestone_message}</span><span class="st">&#39;</span>,</span>
<span id="cb371-69"><a href="#cb371-69" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb371-70"><a href="#cb371-70" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;cooldown&#39;</span>: <span class="dv">3600</span></span>
<span id="cb371-71"><a href="#cb371-71" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb371-72"><a href="#cb371-72" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb371-73"><a href="#cb371-73" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb371-74"><a href="#cb371-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-75"><a href="#cb371-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_alerts(<span class="va">self</span>, metrics):</span>
<span id="cb371-76"><a href="#cb371-76" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb371-77"><a href="#cb371-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-78"><a href="#cb371-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> severity, rules <span class="kw">in</span> <span class="va">self</span>.alert_rules.items():</span>
<span id="cb371-79"><a href="#cb371-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> rule_name, rule <span class="kw">in</span> rules.items():</span>
<span id="cb371-80"><a href="#cb371-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb371-81"><a href="#cb371-81" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è</span></span>
<span id="cb371-82"><a href="#cb371-82" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> rule[<span class="st">&#39;condition&#39;</span>](metrics):</span>
<span id="cb371-83"><a href="#cb371-83" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span></span>
<span id="cb371-84"><a href="#cb371-84" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="va">self</span>.is_cooldown_active(rule_name):</span>
<span id="cb371-85"><a href="#cb371-85" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">continue</span></span>
<span id="cb371-86"><a href="#cb371-86" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb371-87"><a href="#cb371-87" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞</span></span>
<span id="cb371-88"><a href="#cb371-88" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.send_alert(rule_name, rule, metrics)</span>
<span id="cb371-89"><a href="#cb371-89" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb371-90"><a href="#cb371-90" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span></span>
<span id="cb371-91"><a href="#cb371-91" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.set_cooldown(rule_name, rule[<span class="st">&#39;cooldown&#39;</span>])</span>
<span id="cb371-92"><a href="#cb371-92" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb371-93"><a href="#cb371-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb371-94"><a href="#cb371-94" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–ª–µ—Ä—Ç–∞ </span><span class="sc">{</span>rule_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb371-95"><a href="#cb371-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-96"><a href="#cb371-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_alert(<span class="va">self</span>, rule_name, rule, metrics):</span>
<span id="cb371-97"><a href="#cb371-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb371-98"><a href="#cb371-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-99"><a href="#cb371-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span></span>
<span id="cb371-100"><a href="#cb371-100" aria-hidden="true" tabindex="-1"></a>        message <span class="op">=</span> rule[<span class="st">&#39;message&#39;</span>].<span class="bu">format</span>(<span class="op">**</span>metrics)</span>
<span id="cb371-101"><a href="#cb371-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-102"><a href="#cb371-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º</span></span>
<span id="cb371-103"><a href="#cb371-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> channel <span class="kw">in</span> rule[<span class="st">&#39;channels&#39;</span>]:</span>
<span id="cb371-104"><a href="#cb371-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb371-105"><a href="#cb371-105" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.send_to_channel(channel, message, metrics)</span>
<span id="cb371-106"><a href="#cb371-106" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb371-107"><a href="#cb371-107" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ </span><span class="sc">{</span>channel<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb371-108"><a href="#cb371-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-109"><a href="#cb371-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span></span>
<span id="cb371-110"><a href="#cb371-110" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_history.append({</span>
<span id="cb371-111"><a href="#cb371-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb371-112"><a href="#cb371-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;rule&#39;</span>: rule_name,</span>
<span id="cb371-113"><a href="#cb371-113" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: message,</span>
<span id="cb371-114"><a href="#cb371-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metrics&#39;</span>: metrics</span>
<span id="cb371-115"><a href="#cb371-115" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb371-116"><a href="#cb371-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-117"><a href="#cb371-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_to_channel(<span class="va">self</span>, channel, message, metrics):</span>
<span id="cb371-118"><a href="#cb371-118" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–∞–Ω–∞–ª&quot;&quot;&quot;</span></span>
<span id="cb371-119"><a href="#cb371-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-120"><a href="#cb371-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> channel <span class="op">==</span> <span class="st">&#39;email&#39;</span>:</span>
<span id="cb371-121"><a href="#cb371-121" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.send_email_alert(message, metrics)</span>
<span id="cb371-122"><a href="#cb371-122" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> channel <span class="op">==</span> <span class="st">&#39;sms&#39;</span>:</span>
<span id="cb371-123"><a href="#cb371-123" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.send_sms_alert(message, metrics)</span>
<span id="cb371-124"><a href="#cb371-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> channel <span class="op">==</span> <span class="st">&#39;telegram&#39;</span>:</span>
<span id="cb371-125"><a href="#cb371-125" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.send_telegram_alert(message, metrics)</span>
<span id="cb371-126"><a href="#cb371-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> channel <span class="op">==</span> <span class="st">&#39;slack&#39;</span>:</span>
<span id="cb371-127"><a href="#cb371-127" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.send_slack_alert(message, metrics)</span>
<span id="cb371-128"><a href="#cb371-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb371-129"><a href="#cb371-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_telegram_alert(<span class="va">self</span>, message, metrics):</span>
<span id="cb371-130"><a href="#cb371-130" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –≤ Telegram&quot;&quot;&quot;</span></span>
<span id="cb371-131"><a href="#cb371-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-132"><a href="#cb371-132" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> requests</span>
<span id="cb371-133"><a href="#cb371-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-134"><a href="#cb371-134" aria-hidden="true" tabindex="-1"></a>        bot_token <span class="op">=</span> os.getenv(<span class="st">&#39;TELEGRAM_BOT_TOKEN&#39;</span>)</span>
<span id="cb371-135"><a href="#cb371-135" aria-hidden="true" tabindex="-1"></a>        chat_id <span class="op">=</span> os.getenv(<span class="st">&#39;TELEGRAM_CHAT_ID&#39;</span>)</span>
<span id="cb371-136"><a href="#cb371-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-137"><a href="#cb371-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> bot_token <span class="kw">or</span> <span class="kw">not</span> chat_id:</span>
<span id="cb371-138"><a href="#cb371-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb371-139"><a href="#cb371-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-140"><a href="#cb371-140" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="ss">f&quot;https://api.telegram.org/bot</span><span class="sc">{</span>bot_token<span class="sc">}</span><span class="ss">/sendMessage&quot;</span></span>
<span id="cb371-141"><a href="#cb371-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-142"><a href="#cb371-142" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è Telegram</span></span>
<span id="cb371-143"><a href="#cb371-143" aria-hidden="true" tabindex="-1"></a>        formatted_message <span class="op">=</span> <span class="ss">f&quot;ü§ñ *–¢–æ—Ä–≥–æ–≤—ã–π –ë–æ—Ç*</span><span class="ch">\n\n</span><span class="sc">{</span>message<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">&quot;</span></span>
<span id="cb371-144"><a href="#cb371-144" aria-hidden="true" tabindex="-1"></a>        formatted_message <span class="op">+=</span> <span class="ss">f&quot;‚è∞ –í—Ä–µ–º—è: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span></span>
<span id="cb371-145"><a href="#cb371-145" aria-hidden="true" tabindex="-1"></a>        formatted_message <span class="op">+=</span> <span class="ss">f&quot;üìä P&amp;L: </span><span class="sc">{</span>metrics<span class="sc">.</span>get(<span class="st">&#39;profit_loss&#39;</span>, <span class="dv">0</span>)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">&quot;</span></span>
<span id="cb371-146"><a href="#cb371-146" aria-hidden="true" tabindex="-1"></a>        formatted_message <span class="op">+=</span> <span class="ss">f&quot;üìà –°–¥–µ–ª–∫–∏: </span><span class="sc">{</span>metrics<span class="sc">.</span>get(<span class="st">&#39;total_trades&#39;</span>, <span class="dv">0</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span></span>
<span id="cb371-147"><a href="#cb371-147" aria-hidden="true" tabindex="-1"></a>        formatted_message <span class="op">+=</span> <span class="ss">f&quot;üéØ Win Rate: </span><span class="sc">{</span>metrics<span class="sc">.</span>get(<span class="st">&#39;win_rate&#39;</span>, <span class="dv">0</span>)<span class="sc">:.2%}</span><span class="ss">&quot;</span></span>
<span id="cb371-148"><a href="#cb371-148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-149"><a href="#cb371-149" aria-hidden="true" tabindex="-1"></a>        payload <span class="op">=</span> {</span>
<span id="cb371-150"><a href="#cb371-150" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chat_id&#39;</span>: chat_id,</span>
<span id="cb371-151"><a href="#cb371-151" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;text&#39;</span>: formatted_message,</span>
<span id="cb371-152"><a href="#cb371-152" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;parse_mode&#39;</span>: <span class="st">&#39;Markdown&#39;</span></span>
<span id="cb371-153"><a href="#cb371-153" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb371-154"><a href="#cb371-154" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb371-155"><a href="#cb371-155" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.post(url, json<span class="op">=</span>payload)</span>
<span id="cb371-156"><a href="#cb371-156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response.status_code <span class="op">==</span> <span class="dv">200</span></span></code></pre></div>
<h3 data-number="26.2.4" id="–¥–∞—à–±–æ—Ä–¥-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">26.2.4</span> 4. –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="sourceCode" id="cb372"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MonitoringDashboard:</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dashboard_data <span class="op">=</span> {}</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.charts <span class="op">=</span> {}</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.widgets <span class="op">=</span> {}</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_dashboard(<span class="va">self</span>):</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞&quot;&quot;&quot;</span></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—Å–Ω–æ–≤–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.widgets <span class="op">=</span> {</span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;overview&#39;</span>: <span class="va">self</span>.create_overview_widget(),</span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance&#39;</span>: <span class="va">self</span>.create_performance_widget(),</span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trading_activity&#39;</span>: <span class="va">self</span>.create_trading_activity_widget(),</span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;risk_metrics&#39;</span>: <span class="va">self</span>.create_risk_metrics_widget(),</span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;system_health&#39;</span>: <span class="va">self</span>.create_system_health_widget(),</span>
<span id="cb372-19"><a href="#cb372-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_metrics&#39;</span>: <span class="va">self</span>.create_model_metrics_widget(),</span>
<span id="cb372-20"><a href="#cb372-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;market_conditions&#39;</span>: <span class="va">self</span>.create_market_conditions_widget()</span>
<span id="cb372-21"><a href="#cb372-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb372-22"><a href="#cb372-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-23"><a href="#cb372-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.widgets</span>
<span id="cb372-24"><a href="#cb372-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-25"><a href="#cb372-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_overview_widget(<span class="va">self</span>):</span>
<span id="cb372-26"><a href="#cb372-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –æ–±–∑–æ—Ä–∞&quot;&quot;&quot;</span></span>
<span id="cb372-27"><a href="#cb372-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-28"><a href="#cb372-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb372-29"><a href="#cb372-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;type&#39;</span>: <span class="st">&#39;overview&#39;</span>,</span>
<span id="cb372-30"><a href="#cb372-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–û–±—â–∏–π –æ–±–∑–æ—Ä&#39;</span>,</span>
<span id="cb372-31"><a href="#cb372-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metrics&#39;</span>: [</span>
<span id="cb372-32"><a href="#cb372-32" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;P&amp;L&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;profit_loss&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;currency&#39;</span>},</span>
<span id="cb372-33"><a href="#cb372-33" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;Win Rate&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;win_rate&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>},</span>
<span id="cb372-34"><a href="#cb372-34" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;active_positions&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;number&#39;</span>},</span>
<span id="cb372-35"><a href="#cb372-35" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;uptime&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;duration&#39;</span>},</span>
<span id="cb372-36"><a href="#cb372-36" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–°—Ç–∞—Ç—É—Å&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;status&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;status&#39;</span>}</span>
<span id="cb372-37"><a href="#cb372-37" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb372-38"><a href="#cb372-38" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb372-39"><a href="#cb372-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-40"><a href="#cb372-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_performance_widget(<span class="va">self</span>):</span>
<span id="cb372-41"><a href="#cb372-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb372-42"><a href="#cb372-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-43"><a href="#cb372-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb372-44"><a href="#cb372-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;type&#39;</span>: <span class="st">&#39;performance&#39;</span>,</span>
<span id="cb372-45"><a href="#cb372-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å&#39;</span>,</span>
<span id="cb372-46"><a href="#cb372-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;charts&#39;</span>: [</span>
<span id="cb372-47"><a href="#cb372-47" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb372-48"><a href="#cb372-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;line&#39;</span>,</span>
<span id="cb372-49"><a href="#cb372-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;P&amp;L –≤–æ –≤—Ä–µ–º–µ–Ω–∏&#39;</span>,</span>
<span id="cb372-50"><a href="#cb372-50" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;profit_loss_history&#39;</span>,</span>
<span id="cb372-51"><a href="#cb372-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;x_axis&#39;</span>: <span class="st">&#39;timestamp&#39;</span>,</span>
<span id="cb372-52"><a href="#cb372-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;y_axis&#39;</span>: <span class="st">&#39;profit_loss&#39;</span></span>
<span id="cb372-53"><a href="#cb372-53" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb372-54"><a href="#cb372-54" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb372-55"><a href="#cb372-55" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;bar&#39;</span>,</span>
<span id="cb372-56"><a href="#cb372-56" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–°–¥–µ–ª–∫–∏ –ø–æ –¥–Ω—è–º&#39;</span>,</span>
<span id="cb372-57"><a href="#cb372-57" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;trades_by_day&#39;</span>,</span>
<span id="cb372-58"><a href="#cb372-58" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;x_axis&#39;</span>: <span class="st">&#39;date&#39;</span>,</span>
<span id="cb372-59"><a href="#cb372-59" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;y_axis&#39;</span>: <span class="st">&#39;trade_count&#39;</span></span>
<span id="cb372-60"><a href="#cb372-60" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb372-61"><a href="#cb372-61" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb372-62"><a href="#cb372-62" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;pie&#39;</span>,</span>
<span id="cb372-63"><a href="#cb372-63" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫&#39;</span>,</span>
<span id="cb372-64"><a href="#cb372-64" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;trade_distribution&#39;</span>,</span>
<span id="cb372-65"><a href="#cb372-65" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;labels&#39;</span>: [<span class="st">&#39;–í—ã–∏–≥—Ä—ã—à–Ω—ã–µ&#39;</span>, <span class="st">&#39;–ü—Ä–æ–∏–≥—Ä—ã—à–Ω—ã–µ&#39;</span>],</span>
<span id="cb372-66"><a href="#cb372-66" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;values&#39;</span>: [<span class="st">&#39;winning_trades&#39;</span>, <span class="st">&#39;losing_trades&#39;</span>]</span>
<span id="cb372-67"><a href="#cb372-67" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb372-68"><a href="#cb372-68" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb372-69"><a href="#cb372-69" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb372-70"><a href="#cb372-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-71"><a href="#cb372-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_risk_metrics_widget(<span class="va">self</span>):</span>
<span id="cb372-72"><a href="#cb372-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –º–µ—Ç—Ä–∏–∫ —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span></span>
<span id="cb372-73"><a href="#cb372-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-74"><a href="#cb372-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb372-75"><a href="#cb372-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;type&#39;</span>: <span class="st">&#39;risk_metrics&#39;</span>,</span>
<span id="cb372-76"><a href="#cb372-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∏—Å–∫–∞&#39;</span>,</span>
<span id="cb372-77"><a href="#cb372-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metrics&#39;</span>: [</span>
<span id="cb372-78"><a href="#cb372-78" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;max_drawdown&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>},</span>
<span id="cb372-79"><a href="#cb372-79" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;Sharpe Ratio&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;sharpe_ratio&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;number&#39;</span>},</span>
<span id="cb372-80"><a href="#cb372-80" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;VaR 95%&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;var_95&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;currency&#39;</span>},</span>
<span id="cb372-81"><a href="#cb372-81" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–¢–µ–∫—É—â–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;current_exposure&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;currency&#39;</span>},</span>
<span id="cb372-82"><a href="#cb372-82" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∏—Å–∫–∞&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;risk_utilization&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>}</span>
<span id="cb372-83"><a href="#cb372-83" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb372-84"><a href="#cb372-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;charts&#39;</span>: [</span>
<span id="cb372-85"><a href="#cb372-85" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb372-86"><a href="#cb372-86" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;line&#39;</span>,</span>
<span id="cb372-87"><a href="#cb372-87" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–ü—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏&#39;</span>,</span>
<span id="cb372-88"><a href="#cb372-88" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;drawdown_history&#39;</span>,</span>
<span id="cb372-89"><a href="#cb372-89" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;x_axis&#39;</span>: <span class="st">&#39;timestamp&#39;</span>,</span>
<span id="cb372-90"><a href="#cb372-90" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;y_axis&#39;</span>: <span class="st">&#39;drawdown&#39;</span></span>
<span id="cb372-91"><a href="#cb372-91" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb372-92"><a href="#cb372-92" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb372-93"><a href="#cb372-93" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb372-94"><a href="#cb372-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb372-95"><a href="#cb372-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_system_health_widget(<span class="va">self</span>):</span>
<span id="cb372-96"><a href="#cb372-96" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb372-97"><a href="#cb372-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb372-98"><a href="#cb372-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb372-99"><a href="#cb372-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;type&#39;</span>: <span class="st">&#39;system_health&#39;</span>,</span>
<span id="cb372-100"><a href="#cb372-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–ó–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã&#39;</span>,</span>
<span id="cb372-101"><a href="#cb372-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metrics&#39;</span>: [</span>
<span id="cb372-102"><a href="#cb372-102" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;CPU&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;cpu_usage&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>},</span>
<span id="cb372-103"><a href="#cb372-103" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–ü–∞–º—è—Ç—å&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;memory_usage&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>},</span>
<span id="cb372-104"><a href="#cb372-104" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–î–∏—Å–∫&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;disk_usage&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>},</span>
<span id="cb372-105"><a href="#cb372-105" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–ó–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;network_latency&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;duration&#39;</span>},</span>
<span id="cb372-106"><a href="#cb372-106" aria-hidden="true" tabindex="-1"></a>                {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;–û—à–∏–±–∫–∏ API&#39;</span>, <span class="st">&#39;value&#39;</span>: <span class="st">&#39;error_rate&#39;</span>, <span class="st">&#39;format&#39;</span>: <span class="st">&#39;percentage&#39;</span>}</span>
<span id="cb372-107"><a href="#cb372-107" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb372-108"><a href="#cb372-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;charts&#39;</span>: [</span>
<span id="cb372-109"><a href="#cb372-109" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb372-110"><a href="#cb372-110" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;gauge&#39;</span>,</span>
<span id="cb372-111"><a href="#cb372-111" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤&#39;</span>,</span>
<span id="cb372-112"><a href="#cb372-112" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;resource_usage&#39;</span>,</span>
<span id="cb372-113"><a href="#cb372-113" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;max_value&#39;</span>: <span class="dv">100</span></span>
<span id="cb372-114"><a href="#cb372-114" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb372-115"><a href="#cb372-115" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb372-116"><a href="#cb372-116" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="26.2.5" id="–∞–Ω–∞–ª–∏–∑-–ª–æ–≥–æ–≤"><span
class="header-section-number">26.2.5</span> 5. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤</h3>
<div class="sourceCode" id="cb373"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LogAnalyzer:</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.log_patterns <span class="op">=</span> {}</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.error_patterns <span class="op">=</span> {}</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_patterns <span class="op">=</span> {}</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_logs(<span class="va">self</span>, log_file):</span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>        analysis_results <span class="op">=</span> {</span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;errors&#39;</span>: <span class="va">self</span>.analyze_errors(log_file),</span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance_issues&#39;</span>: <span class="va">self</span>.analyze_performance_issues(log_file),</span>
<span id="cb373-15"><a href="#cb373-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trading_patterns&#39;</span>: <span class="va">self</span>.analyze_trading_patterns(log_file),</span>
<span id="cb373-16"><a href="#cb373-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;system_issues&#39;</span>: <span class="va">self</span>.analyze_system_issues(log_file)</span>
<span id="cb373-17"><a href="#cb373-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb373-18"><a href="#cb373-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-19"><a href="#cb373-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> analysis_results</span>
<span id="cb373-20"><a href="#cb373-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb373-21"><a href="#cb373-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_errors(<span class="va">self</span>, log_file):</span>
<span id="cb373-22"><a href="#cb373-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span></span>
<span id="cb373-23"><a href="#cb373-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-24"><a href="#cb373-24" aria-hidden="true" tabindex="-1"></a>        error_patterns <span class="op">=</span> [</span>
<span id="cb373-25"><a href="#cb373-25" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;ERROR: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-26"><a href="#cb373-26" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;EXCEPTION: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-27"><a href="#cb373-27" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;CRITICAL: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-28"><a href="#cb373-28" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Failed to </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-29"><a href="#cb373-29" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Connection error: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-30"><a href="#cb373-30" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;API error: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span></span>
<span id="cb373-31"><a href="#cb373-31" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb373-32"><a href="#cb373-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-33"><a href="#cb373-33" aria-hidden="true" tabindex="-1"></a>        errors <span class="op">=</span> []</span>
<span id="cb373-34"><a href="#cb373-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-35"><a href="#cb373-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(log_file, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb373-36"><a href="#cb373-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> line_num, line <span class="kw">in</span> <span class="bu">enumerate</span>(f, <span class="dv">1</span>):</span>
<span id="cb373-37"><a href="#cb373-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> pattern <span class="kw">in</span> error_patterns:</span>
<span id="cb373-38"><a href="#cb373-38" aria-hidden="true" tabindex="-1"></a>                    match <span class="op">=</span> re.search(pattern, line)</span>
<span id="cb373-39"><a href="#cb373-39" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> match:</span>
<span id="cb373-40"><a href="#cb373-40" aria-hidden="true" tabindex="-1"></a>                        errors.append({</span>
<span id="cb373-41"><a href="#cb373-41" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;line&#39;</span>: line_num,</span>
<span id="cb373-42"><a href="#cb373-42" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;error&#39;</span>: match.group(<span class="dv">1</span>),</span>
<span id="cb373-43"><a href="#cb373-43" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.extract_timestamp(line),</span>
<span id="cb373-44"><a href="#cb373-44" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;severity&#39;</span>: <span class="va">self</span>.classify_error_severity(match.group(<span class="dv">1</span>))</span>
<span id="cb373-45"><a href="#cb373-45" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb373-46"><a href="#cb373-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-47"><a href="#cb373-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> errors</span>
<span id="cb373-48"><a href="#cb373-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb373-49"><a href="#cb373-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_performance_issues(<span class="va">self</span>, log_file):</span>
<span id="cb373-50"><a href="#cb373-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb373-51"><a href="#cb373-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-52"><a href="#cb373-52" aria-hidden="true" tabindex="-1"></a>        performance_patterns <span class="op">=</span> [</span>
<span id="cb373-53"><a href="#cb373-53" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Slow operation: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs"> took </span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">ms&#39;</span>,</span>
<span id="cb373-54"><a href="#cb373-54" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;High memory usage: </span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">MB&#39;</span>,</span>
<span id="cb373-55"><a href="#cb373-55" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;CPU spike detected: </span><span class="kw">(</span><span class="dv">\d</span><span class="op">+</span><span class="kw">)</span><span class="vs">%&#39;</span>,</span>
<span id="cb373-56"><a href="#cb373-56" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Network timeout: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-57"><a href="#cb373-57" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Database slow query: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span></span>
<span id="cb373-58"><a href="#cb373-58" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb373-59"><a href="#cb373-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-60"><a href="#cb373-60" aria-hidden="true" tabindex="-1"></a>        performance_issues <span class="op">=</span> []</span>
<span id="cb373-61"><a href="#cb373-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-62"><a href="#cb373-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(log_file, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb373-63"><a href="#cb373-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> line_num, line <span class="kw">in</span> <span class="bu">enumerate</span>(f, <span class="dv">1</span>):</span>
<span id="cb373-64"><a href="#cb373-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> pattern <span class="kw">in</span> performance_patterns:</span>
<span id="cb373-65"><a href="#cb373-65" aria-hidden="true" tabindex="-1"></a>                    match <span class="op">=</span> re.search(pattern, line)</span>
<span id="cb373-66"><a href="#cb373-66" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> match:</span>
<span id="cb373-67"><a href="#cb373-67" aria-hidden="true" tabindex="-1"></a>                        performance_issues.append({</span>
<span id="cb373-68"><a href="#cb373-68" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;line&#39;</span>: line_num,</span>
<span id="cb373-69"><a href="#cb373-69" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;issue&#39;</span>: match.group(<span class="dv">1</span>),</span>
<span id="cb373-70"><a href="#cb373-70" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;value&#39;</span>: match.group(<span class="dv">2</span>) <span class="cf">if</span> <span class="bu">len</span>(match.groups()) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="va">None</span>,</span>
<span id="cb373-71"><a href="#cb373-71" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.extract_timestamp(line)</span>
<span id="cb373-72"><a href="#cb373-72" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb373-73"><a href="#cb373-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-74"><a href="#cb373-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> performance_issues</span>
<span id="cb373-75"><a href="#cb373-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb373-76"><a href="#cb373-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_trading_patterns(<span class="va">self</span>, log_file):</span>
<span id="cb373-77"><a href="#cb373-77" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb373-78"><a href="#cb373-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-79"><a href="#cb373-79" aria-hidden="true" tabindex="-1"></a>        trading_patterns <span class="op">=</span> [</span>
<span id="cb373-80"><a href="#cb373-80" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Trade executed: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-81"><a href="#cb373-81" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Order placed: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-82"><a href="#cb373-82" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Position opened: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-83"><a href="#cb373-83" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Position closed: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-84"><a href="#cb373-84" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Stop loss triggered: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span>,</span>
<span id="cb373-85"><a href="#cb373-85" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&#39;Take profit triggered: </span><span class="kw">(</span><span class="dv">.</span><span class="op">+</span><span class="kw">)</span><span class="vs">&#39;</span></span>
<span id="cb373-86"><a href="#cb373-86" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb373-87"><a href="#cb373-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-88"><a href="#cb373-88" aria-hidden="true" tabindex="-1"></a>        trading_events <span class="op">=</span> []</span>
<span id="cb373-89"><a href="#cb373-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-90"><a href="#cb373-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(log_file, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb373-91"><a href="#cb373-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> line_num, line <span class="kw">in</span> <span class="bu">enumerate</span>(f, <span class="dv">1</span>):</span>
<span id="cb373-92"><a href="#cb373-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> pattern <span class="kw">in</span> trading_patterns:</span>
<span id="cb373-93"><a href="#cb373-93" aria-hidden="true" tabindex="-1"></a>                    match <span class="op">=</span> re.search(pattern, line)</span>
<span id="cb373-94"><a href="#cb373-94" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> match:</span>
<span id="cb373-95"><a href="#cb373-95" aria-hidden="true" tabindex="-1"></a>                        trading_events.append({</span>
<span id="cb373-96"><a href="#cb373-96" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;line&#39;</span>: line_num,</span>
<span id="cb373-97"><a href="#cb373-97" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;event&#39;</span>: match.group(<span class="dv">1</span>),</span>
<span id="cb373-98"><a href="#cb373-98" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.extract_timestamp(line),</span>
<span id="cb373-99"><a href="#cb373-99" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;type&#39;</span>: <span class="va">self</span>.classify_trading_event(match.group(<span class="dv">1</span>))</span>
<span id="cb373-100"><a href="#cb373-100" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb373-101"><a href="#cb373-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb373-102"><a href="#cb373-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> trading_events</span></code></pre></div>
<h3 data-number="26.2.6" id="–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span
class="header-section-number">26.2.6</span> 6. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb374"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PerformanceTracker:</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.performance_metrics <span class="op">=</span> {}</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.benchmarks <span class="op">=</span> {}</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.optimization_suggestions <span class="op">=</span> {}</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> track_performance(<span class="va">self</span>, metrics):</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>        performance_score <span class="op">=</span> <span class="va">self</span>.calculate_performance_score(metrics)</span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏</span></span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>        benchmark_comparison <span class="op">=</span> <span class="va">self</span>.compare_with_benchmarks(metrics)</span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span></span>
<span id="cb374-19"><a href="#cb374-19" aria-hidden="true" tabindex="-1"></a>        optimization_suggestions <span class="op">=</span> <span class="va">self</span>.generate_optimization_suggestions(metrics)</span>
<span id="cb374-20"><a href="#cb374-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-21"><a href="#cb374-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb374-22"><a href="#cb374-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance_score&#39;</span>: performance_score,</span>
<span id="cb374-23"><a href="#cb374-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;benchmark_comparison&#39;</span>: benchmark_comparison,</span>
<span id="cb374-24"><a href="#cb374-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;optimization_suggestions&#39;</span>: optimization_suggestions,</span>
<span id="cb374-25"><a href="#cb374-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb374-26"><a href="#cb374-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb374-27"><a href="#cb374-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb374-28"><a href="#cb374-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_performance_score(<span class="va">self</span>, metrics):</span>
<span id="cb374-29"><a href="#cb374-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb374-30"><a href="#cb374-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-31"><a href="#cb374-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –í–µ—Å–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb374-32"><a href="#cb374-32" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> {</span>
<span id="cb374-33"><a href="#cb374-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;win_rate&#39;</span>: <span class="fl">0.25</span>,</span>
<span id="cb374-34"><a href="#cb374-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sharpe_ratio&#39;</span>: <span class="fl">0.20</span>,</span>
<span id="cb374-35"><a href="#cb374-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_drawdown&#39;</span>: <span class="fl">0.15</span>,</span>
<span id="cb374-36"><a href="#cb374-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;profit_loss&#39;</span>: <span class="fl">0.15</span>,</span>
<span id="cb374-37"><a href="#cb374-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trades_per_hour&#39;</span>: <span class="fl">0.10</span>,</span>
<span id="cb374-38"><a href="#cb374-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error_rate&#39;</span>: <span class="fl">0.10</span>,</span>
<span id="cb374-39"><a href="#cb374-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;uptime&#39;</span>: <span class="fl">0.05</span></span>
<span id="cb374-40"><a href="#cb374-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb374-41"><a href="#cb374-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-42"><a href="#cb374-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb374-43"><a href="#cb374-43" aria-hidden="true" tabindex="-1"></a>        normalized_metrics <span class="op">=</span> <span class="va">self</span>.normalize_metrics(metrics)</span>
<span id="cb374-44"><a href="#cb374-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-45"><a href="#cb374-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –†–∞—Å—á–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏</span></span>
<span id="cb374-46"><a href="#cb374-46" aria-hidden="true" tabindex="-1"></a>        performance_score <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb374-47"><a href="#cb374-47" aria-hidden="true" tabindex="-1"></a>            normalized_metrics[metric] <span class="op">*</span> weight </span>
<span id="cb374-48"><a href="#cb374-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> metric, weight <span class="kw">in</span> weights.items()</span>
<span id="cb374-49"><a href="#cb374-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb374-50"><a href="#cb374-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-51"><a href="#cb374-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> performance_score</span>
<span id="cb374-52"><a href="#cb374-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb374-53"><a href="#cb374-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_optimization_suggestions(<span class="va">self</span>, metrics):</span>
<span id="cb374-54"><a href="#cb374-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb374-55"><a href="#cb374-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-56"><a href="#cb374-56" aria-hidden="true" tabindex="-1"></a>        suggestions <span class="op">=</span> []</span>
<span id="cb374-57"><a href="#cb374-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-58"><a href="#cb374-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ win rate</span></span>
<span id="cb374-59"><a href="#cb374-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> metrics.get(<span class="st">&#39;win_rate&#39;</span>, <span class="dv">0</span>) <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb374-60"><a href="#cb374-60" aria-hidden="true" tabindex="-1"></a>            suggestions.append({</span>
<span id="cb374-61"><a href="#cb374-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="st">&#39;trading_strategy&#39;</span>,</span>
<span id="cb374-62"><a href="#cb374-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;high&#39;</span>,</span>
<span id="cb374-63"><a href="#cb374-63" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;–ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä —Ç–æ—Ä–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.&#39;</span>,</span>
<span id="cb374-64"><a href="#cb374-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;analyze_losing_trades&#39;</span></span>
<span id="cb374-65"><a href="#cb374-65" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb374-66"><a href="#cb374-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-67"><a href="#cb374-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Å–∞–¥–∫–∏</span></span>
<span id="cb374-68"><a href="#cb374-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> metrics.get(<span class="st">&#39;max_drawdown&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="fl">0.1</span>:</span>
<span id="cb374-69"><a href="#cb374-69" aria-hidden="true" tabindex="-1"></a>            suggestions.append({</span>
<span id="cb374-70"><a href="#cb374-70" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="st">&#39;risk_management&#39;</span>,</span>
<span id="cb374-71"><a href="#cb374-71" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;high&#39;</span>,</span>
<span id="cb374-72"><a href="#cb374-72" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;–í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞. –£–ª—É—á—à–∏—Ç–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏.&#39;</span>,</span>
<span id="cb374-73"><a href="#cb374-73" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;reduce_position_sizes&#39;</span></span>
<span id="cb374-74"><a href="#cb374-74" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb374-75"><a href="#cb374-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-76"><a href="#cb374-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</span></span>
<span id="cb374-77"><a href="#cb374-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> metrics.get(<span class="st">&#39;error_rate&#39;</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="fl">0.02</span>:</span>
<span id="cb374-78"><a href="#cb374-78" aria-hidden="true" tabindex="-1"></a>            suggestions.append({</span>
<span id="cb374-79"><a href="#cb374-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="st">&#39;system_stability&#39;</span>,</span>
<span id="cb374-80"><a href="#cb374-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;medium&#39;</span>,</span>
<span id="cb374-81"><a href="#cb374-81" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.&#39;</span>,</span>
<span id="cb374-82"><a href="#cb374-82" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;review_error_logs&#39;</span></span>
<span id="cb374-83"><a href="#cb374-83" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb374-84"><a href="#cb374-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-85"><a href="#cb374-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span></span>
<span id="cb374-86"><a href="#cb374-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> metrics.get(<span class="st">&#39;trades_per_hour&#39;</span>, <span class="dv">0</span>) <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb374-87"><a href="#cb374-87" aria-hidden="true" tabindex="-1"></a>            suggestions.append({</span>
<span id="cb374-88"><a href="#cb374-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="st">&#39;trading_activity&#39;</span>,</span>
<span id="cb374-89"><a href="#cb374-89" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;priority&#39;</span>: <span class="st">&#39;low&#39;</span>,</span>
<span id="cb374-90"><a href="#cb374-90" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;suggestion&#39;</span>: <span class="st">&#39;–ù–∏–∑–∫–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞.&#39;</span>,</span>
<span id="cb374-91"><a href="#cb374-91" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;review_entry_conditions&#39;</span></span>
<span id="cb374-92"><a href="#cb374-92" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb374-93"><a href="#cb374-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb374-94"><a href="#cb374-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> suggestions</span></code></pre></div>
<h3 data-number="26.2.7" id="–ø—Ä–æ–≤–µ—Ä–∫–∞-–∑–¥–æ—Ä–æ–≤—å—è-—Å–∏—Å—Ç–µ–º—ã"><span
class="header-section-number">26.2.7</span> 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
—Å–∏—Å—Ç–µ–º—ã</h3>
<div class="sourceCode" id="cb375"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HealthChecker:</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.health_checks <span class="op">=</span> {}</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.health_status <span class="op">=</span> {}</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> perform_health_checks(<span class="va">self</span>, system_state):</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è&quot;&quot;&quot;</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>        health_checks <span class="op">=</span> {</span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;bot_running&#39;</span>: <span class="va">self</span>.check_bot_running(system_state),</span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;api_connectivity&#39;</span>: <span class="va">self</span>.check_api_connectivity(system_state),</span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_loaded&#39;</span>: <span class="va">self</span>.check_model_loaded(system_state),</span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_freshness&#39;</span>: <span class="va">self</span>.check_data_freshness(system_state),</span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;memory_usage&#39;</span>: <span class="va">self</span>.check_memory_usage(system_state),</span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;disk_space&#39;</span>: <span class="va">self</span>.check_disk_space(system_state),</span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;network_connectivity&#39;</span>: <span class="va">self</span>.check_network_connectivity(system_state)</span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è</span></span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a>        overall_health <span class="op">=</span> <span class="va">self</span>.calculate_overall_health(health_checks)</span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;overall_health&#39;</span>: overall_health,</span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;individual_checks&#39;</span>: health_checks,</span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat()</span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_bot_running(<span class="va">self</span>, system_state):</span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a>        uptime <span class="op">=</span> system_state.get(<span class="st">&#39;uptime&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a>        last_activity <span class="op">=</span> system_state.get(<span class="st">&#39;last_activity&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ë–æ—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—é—â–∏–º, –µ—Å–ª–∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã &gt; 0 –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å &lt; 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb375-37"><a href="#cb375-37" aria-hidden="true" tabindex="-1"></a>        is_running <span class="op">=</span> uptime <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> (time.time() <span class="op">-</span> last_activity) <span class="op">&lt;</span> <span class="dv">300</span></span>
<span id="cb375-38"><a href="#cb375-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-39"><a href="#cb375-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb375-40"><a href="#cb375-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;healthy&#39;</span> <span class="cf">if</span> is_running <span class="cf">else</span> <span class="st">&#39;unhealthy&#39;</span>,</span>
<span id="cb375-41"><a href="#cb375-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: <span class="st">&#39;–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span> <span class="cf">if</span> is_running <span class="cf">else</span> <span class="st">&#39;–ë–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span>,</span>
<span id="cb375-42"><a href="#cb375-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;details&#39;</span>: {</span>
<span id="cb375-43"><a href="#cb375-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;uptime&#39;</span>: uptime,</span>
<span id="cb375-44"><a href="#cb375-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;last_activity&#39;</span>: last_activity</span>
<span id="cb375-45"><a href="#cb375-45" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb375-46"><a href="#cb375-46" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb375-47"><a href="#cb375-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-48"><a href="#cb375-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_api_connectivity(<span class="va">self</span>, system_state):</span>
<span id="cb375-49"><a href="#cb375-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API&quot;&quot;&quot;</span></span>
<span id="cb375-50"><a href="#cb375-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-51"><a href="#cb375-51" aria-hidden="true" tabindex="-1"></a>        api_latency <span class="op">=</span> system_state.get(<span class="st">&#39;api_latency&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb375-52"><a href="#cb375-52" aria-hidden="true" tabindex="-1"></a>        api_error_rate <span class="op">=</span> system_state.get(<span class="st">&#39;api_error_rate&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb375-53"><a href="#cb375-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-54"><a href="#cb375-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># API —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—ã–º, –µ—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ &lt; 1000ms –∏ –æ—à–∏–±–æ–∫ &lt; 5%</span></span>
<span id="cb375-55"><a href="#cb375-55" aria-hidden="true" tabindex="-1"></a>        is_healthy <span class="op">=</span> api_latency <span class="op">&lt;</span> <span class="dv">1000</span> <span class="kw">and</span> api_error_rate <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb375-56"><a href="#cb375-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-57"><a href="#cb375-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb375-58"><a href="#cb375-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;healthy&#39;</span> <span class="cf">if</span> is_healthy <span class="cf">else</span> <span class="st">&#39;unhealthy&#39;</span>,</span>
<span id="cb375-59"><a href="#cb375-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: <span class="st">&#39;API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ&#39;</span> <span class="cf">if</span> is_healthy <span class="cf">else</span> <span class="st">&#39;–ü—Ä–æ–±–ª–µ–º—ã —Å API&#39;</span>,</span>
<span id="cb375-60"><a href="#cb375-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;details&#39;</span>: {</span>
<span id="cb375-61"><a href="#cb375-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;latency&#39;</span>: api_latency,</span>
<span id="cb375-62"><a href="#cb375-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;error_rate&#39;</span>: api_error_rate</span>
<span id="cb375-63"><a href="#cb375-63" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb375-64"><a href="#cb375-64" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb375-65"><a href="#cb375-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-66"><a href="#cb375-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_model_loaded(<span class="va">self</span>, system_state):</span>
<span id="cb375-67"><a href="#cb375-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span></span>
<span id="cb375-68"><a href="#cb375-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-69"><a href="#cb375-69" aria-hidden="true" tabindex="-1"></a>        model_loaded <span class="op">=</span> system_state.get(<span class="st">&#39;model_loaded&#39;</span>, <span class="va">False</span>)</span>
<span id="cb375-70"><a href="#cb375-70" aria-hidden="true" tabindex="-1"></a>        model_accuracy <span class="op">=</span> system_state.get(<span class="st">&#39;model_accuracy&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb375-71"><a href="#cb375-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-72"><a href="#cb375-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤–æ–π, –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ç–æ—á–Ω–æ—Å—Ç—å &gt; 0.7</span></span>
<span id="cb375-73"><a href="#cb375-73" aria-hidden="true" tabindex="-1"></a>        is_healthy <span class="op">=</span> model_loaded <span class="kw">and</span> model_accuracy <span class="op">&gt;</span> <span class="fl">0.7</span></span>
<span id="cb375-74"><a href="#cb375-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-75"><a href="#cb375-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb375-76"><a href="#cb375-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;status&#39;</span>: <span class="st">&#39;healthy&#39;</span> <span class="cf">if</span> is_healthy <span class="cf">else</span> <span class="st">&#39;unhealthy&#39;</span>,</span>
<span id="cb375-77"><a href="#cb375-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: <span class="st">&#39;–ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span> <span class="cf">if</span> is_healthy <span class="cf">else</span> <span class="st">&#39;–ü—Ä–æ–±–ª–µ–º—ã —Å –º–æ–¥–µ–ª—å—é&#39;</span>,</span>
<span id="cb375-78"><a href="#cb375-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;details&#39;</span>: {</span>
<span id="cb375-79"><a href="#cb375-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;loaded&#39;</span>: model_loaded,</span>
<span id="cb375-80"><a href="#cb375-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;accuracy&#39;</span>: model_accuracy</span>
<span id="cb375-81"><a href="#cb375-81" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb375-82"><a href="#cb375-82" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="26.3" id="–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">26.3</span> –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<h3 data-number="26.3.1" id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–ª–µ—Ä—Ç–æ–≤"><span
class="header-section-number">26.3.1</span> 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤</h3>
<div class="sourceCode" id="cb376"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AlertBestPractices:</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_hierarchy <span class="op">=</span> {}</span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.escalation_rules <span class="op">=</span> {}</span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_alert_hierarchy(<span class="va">self</span>):</span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.alert_hierarchy <span class="op">=</span> {</span>
<span id="cb376-12"><a href="#cb376-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;critical&#39;</span>: {</span>
<span id="cb376-13"><a href="#cb376-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;response_time&#39;</span>: <span class="dv">5</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-14"><a href="#cb376-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;escalation_time&#39;</span>: <span class="dv">15</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-15"><a href="#cb376-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;sms&#39;</span>, <span class="st">&#39;phone&#39;</span>, <span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb376-16"><a href="#cb376-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;auto_actions&#39;</span>: [<span class="st">&#39;restart_bot&#39;</span>, <span class="st">&#39;close_positions&#39;</span>]</span>
<span id="cb376-17"><a href="#cb376-17" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb376-18"><a href="#cb376-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;warning&#39;</span>: {</span>
<span id="cb376-19"><a href="#cb376-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;response_time&#39;</span>: <span class="dv">30</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-20"><a href="#cb376-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;escalation_time&#39;</span>: <span class="dv">60</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-21"><a href="#cb376-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;email&#39;</span>, <span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb376-22"><a href="#cb376-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;auto_actions&#39;</span>: [<span class="st">&#39;log_issue&#39;</span>, <span class="st">&#39;notify_admin&#39;</span>]</span>
<span id="cb376-23"><a href="#cb376-23" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb376-24"><a href="#cb376-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;info&#39;</span>: {</span>
<span id="cb376-25"><a href="#cb376-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;response_time&#39;</span>: <span class="dv">120</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-26"><a href="#cb376-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;escalation_time&#39;</span>: <span class="dv">240</span>,  <span class="co"># –º–∏–Ω—É—Ç</span></span>
<span id="cb376-27"><a href="#cb376-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;telegram&#39;</span>],</span>
<span id="cb376-28"><a href="#cb376-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;auto_actions&#39;</span>: [<span class="st">&#39;log_event&#39;</span>]</span>
<span id="cb376-29"><a href="#cb376-29" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb376-30"><a href="#cb376-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb376-31"><a href="#cb376-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb376-32"><a href="#cb376-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_escalation_rules(<span class="va">self</span>):</span>
<span id="cb376-33"><a href="#cb376-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª —ç—Å–∫–∞–ª–∞—Ü–∏–∏&quot;&quot;&quot;</span></span>
<span id="cb376-34"><a href="#cb376-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb376-35"><a href="#cb376-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.escalation_rules <span class="op">=</span> {</span>
<span id="cb376-36"><a href="#cb376-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;no_response&#39;</span>: {</span>
<span id="cb376-37"><a href="#cb376-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;condition&#39;</span>: <span class="st">&#39;no_response_for_30_minutes&#39;</span>,</span>
<span id="cb376-38"><a href="#cb376-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;escalate_to_manager&#39;</span>,</span>
<span id="cb376-39"><a href="#cb376-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;phone&#39;</span>, <span class="st">&#39;sms&#39;</span>]</span>
<span id="cb376-40"><a href="#cb376-40" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb376-41"><a href="#cb376-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;repeated_alerts&#39;</span>: {</span>
<span id="cb376-42"><a href="#cb376-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;condition&#39;</span>: <span class="st">&#39;same_alert_3_times_in_1_hour&#39;</span>,</span>
<span id="cb376-43"><a href="#cb376-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;escalate_to_technical_lead&#39;</span>,</span>
<span id="cb376-44"><a href="#cb376-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;phone&#39;</span>, <span class="st">&#39;email&#39;</span>]</span>
<span id="cb376-45"><a href="#cb376-45" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb376-46"><a href="#cb376-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;system_down&#39;</span>: {</span>
<span id="cb376-47"><a href="#cb376-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;condition&#39;</span>: <span class="st">&#39;bot_down_for_10_minutes&#39;</span>,</span>
<span id="cb376-48"><a href="#cb376-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="st">&#39;escalate_to_emergency_contact&#39;</span>,</span>
<span id="cb376-49"><a href="#cb376-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;channels&#39;</span>: [<span class="st">&#39;phone&#39;</span>, <span class="st">&#39;sms&#39;</span>, <span class="st">&#39;email&#39;</span>]</span>
<span id="cb376-50"><a href="#cb376-50" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb376-51"><a href="#cb376-51" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h3 data-number="26.3.2" id="—Ä–æ—Ç–∞—Ü–∏—è-–ª–æ–≥–æ–≤"><span
class="header-section-number">26.3.2</span> 2. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤</h3>
<div class="sourceCode" id="cb377"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LogRotation:</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rotation_config <span class="op">=</span> {}</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.compression_config <span class="op">=</span> {}</span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retention_config <span class="op">=</span> {}</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_log_rotation(<span class="va">self</span>):</span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rotation_config <span class="op">=</span> {</span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_size&#39;</span>: <span class="st">&#39;100MB&#39;</span>,</span>
<span id="cb377-14"><a href="#cb377-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;max_files&#39;</span>: <span class="dv">10</span>,</span>
<span id="cb377-15"><a href="#cb377-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;rotation_time&#39;</span>: <span class="st">&#39;daily&#39;</span>,</span>
<span id="cb377-16"><a href="#cb377-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;compression&#39;</span>: <span class="va">True</span>,</span>
<span id="cb377-17"><a href="#cb377-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;retention_days&#39;</span>: <span class="dv">30</span></span>
<span id="cb377-18"><a href="#cb377-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb377-19"><a href="#cb377-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb377-20"><a href="#cb377-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rotate_logs(<span class="va">self</span>, log_file):</span>
<span id="cb377-21"><a href="#cb377-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb377-22"><a href="#cb377-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-23"><a href="#cb377-23" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> shutil</span>
<span id="cb377-24"><a href="#cb377-24" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> gzip</span>
<span id="cb377-25"><a href="#cb377-25" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb377-26"><a href="#cb377-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-27"><a href="#cb377-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span></span>
<span id="cb377-28"><a href="#cb377-28" aria-hidden="true" tabindex="-1"></a>        timestamp <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;%Y%m</span><span class="sc">%d</span><span class="st">_%H%M%S&#39;</span>)</span>
<span id="cb377-29"><a href="#cb377-29" aria-hidden="true" tabindex="-1"></a>        backup_file <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>log_file<span class="sc">}</span><span class="ss">.</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb377-30"><a href="#cb377-30" aria-hidden="true" tabindex="-1"></a>        shutil.copy2(log_file, backup_file)</span>
<span id="cb377-31"><a href="#cb377-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-32"><a href="#cb377-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –°–∂–∞—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –ª–æ–≥–∞</span></span>
<span id="cb377-33"><a href="#cb377-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.rotation_config[<span class="st">&#39;compression&#39;</span>]:</span>
<span id="cb377-34"><a href="#cb377-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(backup_file, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> f_in:</span>
<span id="cb377-35"><a href="#cb377-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> gzip.<span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>backup_file<span class="sc">}</span><span class="ss">.gz&quot;</span>, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f_out:</span>
<span id="cb377-36"><a href="#cb377-36" aria-hidden="true" tabindex="-1"></a>                    shutil.copyfileobj(f_in, f_out)</span>
<span id="cb377-37"><a href="#cb377-37" aria-hidden="true" tabindex="-1"></a>            os.remove(backup_file)</span>
<span id="cb377-38"><a href="#cb377-38" aria-hidden="true" tabindex="-1"></a>            backup_file <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>backup_file<span class="sc">}</span><span class="ss">.gz&quot;</span></span>
<span id="cb377-39"><a href="#cb377-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-40"><a href="#cb377-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ª–æ–≥–∞</span></span>
<span id="cb377-41"><a href="#cb377-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(log_file, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb377-42"><a href="#cb377-42" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="st">&#39;&#39;</span>)</span>
<span id="cb377-43"><a href="#cb377-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-44"><a href="#cb377-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤</span></span>
<span id="cb377-45"><a href="#cb377-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cleanup_old_logs(log_file)</span>
<span id="cb377-46"><a href="#cb377-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-47"><a href="#cb377-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> backup_file</span>
<span id="cb377-48"><a href="#cb377-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb377-49"><a href="#cb377-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cleanup_old_logs(<span class="va">self</span>, log_file):</span>
<span id="cb377-50"><a href="#cb377-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤&quot;&quot;&quot;</span></span>
<span id="cb377-51"><a href="#cb377-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-52"><a href="#cb377-52" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> glob</span>
<span id="cb377-53"><a href="#cb377-53" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> os</span>
<span id="cb377-54"><a href="#cb377-54" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb377-55"><a href="#cb377-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-56"><a href="#cb377-56" aria-hidden="true" tabindex="-1"></a>        log_dir <span class="op">=</span> os.path.dirname(log_file)</span>
<span id="cb377-57"><a href="#cb377-57" aria-hidden="true" tabindex="-1"></a>        log_pattern <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>log_file<span class="sc">}</span><span class="ss">.*&quot;</span></span>
<span id="cb377-58"><a href="#cb377-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-59"><a href="#cb377-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤</span></span>
<span id="cb377-60"><a href="#cb377-60" aria-hidden="true" tabindex="-1"></a>        log_files <span class="op">=</span> glob.glob(log_pattern)</span>
<span id="cb377-61"><a href="#cb377-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-62"><a href="#cb377-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É</span></span>
<span id="cb377-63"><a href="#cb377-63" aria-hidden="true" tabindex="-1"></a>        cutoff_date <span class="op">=</span> datetime.now() <span class="op">-</span> timedelta(days<span class="op">=</span><span class="va">self</span>.retention_config[<span class="st">&#39;retention_days&#39;</span>])</span>
<span id="cb377-64"><a href="#cb377-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb377-65"><a href="#cb377-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> file_path <span class="kw">in</span> log_files:</span>
<span id="cb377-66"><a href="#cb377-66" aria-hidden="true" tabindex="-1"></a>            file_time <span class="op">=</span> datetime.fromtimestamp(os.path.getctime(file_path))</span>
<span id="cb377-67"><a href="#cb377-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> file_time <span class="op">&lt;</span> cutoff_date:</span>
<span id="cb377-68"><a href="#cb377-68" aria-hidden="true" tabindex="-1"></a>                os.remove(file_path)</span></code></pre></div>
<h3 data-number="26.3.3" id="–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-1"><span
class="header-section-number">26.3.3</span> 3. –ú–µ—Ç—Ä–∏–∫–∏
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="sourceCode" id="cb378"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PerformanceMetrics:</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_definitions <span class="op">=</span> {}</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.benchmarks <span class="op">=</span> {}</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sla_targets <span class="op">=</span> {}</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> define_metrics(<span class="va">self</span>):</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.metrics_definitions <span class="op">=</span> {</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;availability&#39;</span>: {</span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;description&#39;</span>: <span class="st">&#39;–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã&#39;</span>,</span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;calculation&#39;</span>: <span class="st">&#39;uptime / total_time&#39;</span>,</span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;target&#39;</span>: <span class="fl">0.999</span>,  <span class="co"># 99.9%</span></span>
<span id="cb378-17"><a href="#cb378-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;unit&#39;</span>: <span class="st">&#39;percentage&#39;</span></span>
<span id="cb378-18"><a href="#cb378-18" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb378-19"><a href="#cb378-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;response_time&#39;</span>: {</span>
<span id="cb378-20"><a href="#cb378-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;description&#39;</span>: <span class="st">&#39;–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞&#39;</span>,</span>
<span id="cb378-21"><a href="#cb378-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;calculation&#39;</span>: <span class="st">&#39;average_response_time&#39;</span>,</span>
<span id="cb378-22"><a href="#cb378-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;target&#39;</span>: <span class="dv">1000</span>,  <span class="co"># 1 —Å–µ–∫—É–Ω–¥–∞</span></span>
<span id="cb378-23"><a href="#cb378-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;unit&#39;</span>: <span class="st">&#39;milliseconds&#39;</span></span>
<span id="cb378-24"><a href="#cb378-24" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb378-25"><a href="#cb378-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error_rate&#39;</span>: {</span>
<span id="cb378-26"><a href="#cb378-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;description&#39;</span>: <span class="st">&#39;–ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫&#39;</span>,</span>
<span id="cb378-27"><a href="#cb378-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;calculation&#39;</span>: <span class="st">&#39;errors / total_requests&#39;</span>,</span>
<span id="cb378-28"><a href="#cb378-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;target&#39;</span>: <span class="fl">0.001</span>,  <span class="co"># 0.1%</span></span>
<span id="cb378-29"><a href="#cb378-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;unit&#39;</span>: <span class="st">&#39;percentage&#39;</span></span>
<span id="cb378-30"><a href="#cb378-30" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb378-31"><a href="#cb378-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;throughput&#39;</span>: {</span>
<span id="cb378-32"><a href="#cb378-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;description&#39;</span>: <span class="st">&#39;–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å&#39;</span>,</span>
<span id="cb378-33"><a href="#cb378-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;calculation&#39;</span>: <span class="st">&#39;requests_per_second&#39;</span>,</span>
<span id="cb378-34"><a href="#cb378-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;target&#39;</span>: <span class="dv">100</span>,  <span class="co"># 100 RPS</span></span>
<span id="cb378-35"><a href="#cb378-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;unit&#39;</span>: <span class="st">&#39;requests_per_second&#39;</span></span>
<span id="cb378-36"><a href="#cb378-36" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb378-37"><a href="#cb378-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb378-38"><a href="#cb378-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb378-39"><a href="#cb378-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_sla_targets(<span class="va">self</span>):</span>
<span id="cb378-40"><a href="#cb378-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SLA —Ü–µ–ª–µ–π&quot;&quot;&quot;</span></span>
<span id="cb378-41"><a href="#cb378-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-42"><a href="#cb378-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sla_targets <span class="op">=</span> {</span>
<span id="cb378-43"><a href="#cb378-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;availability&#39;</span>: <span class="fl">0.999</span>,  <span class="co"># 99.9%</span></span>
<span id="cb378-44"><a href="#cb378-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;response_time_p95&#39;</span>: <span class="dv">2000</span>,  <span class="co"># 2 —Å–µ–∫—É–Ω–¥—ã</span></span>
<span id="cb378-45"><a href="#cb378-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;response_time_p99&#39;</span>: <span class="dv">5000</span>,  <span class="co"># 5 —Å–µ–∫—É–Ω–¥</span></span>
<span id="cb378-46"><a href="#cb378-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error_rate&#39;</span>: <span class="fl">0.001</span>,  <span class="co"># 0.1%</span></span>
<span id="cb378-47"><a href="#cb378-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;data_freshness&#39;</span>: <span class="dv">300</span>,  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb378-48"><a href="#cb378-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;model_accuracy&#39;</span>: <span class="fl">0.8</span>  <span class="co"># 80%</span></span>
<span id="cb378-49"><a href="#cb378-49" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb378-50"><a href="#cb378-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb378-51"><a href="#cb378-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_sla_compliance(<span class="va">self</span>, metrics):</span>
<span id="cb378-52"><a href="#cb378-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è SLA&quot;&quot;&quot;</span></span>
<span id="cb378-53"><a href="#cb378-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-54"><a href="#cb378-54" aria-hidden="true" tabindex="-1"></a>        compliance <span class="op">=</span> {}</span>
<span id="cb378-55"><a href="#cb378-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-56"><a href="#cb378-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metric, target <span class="kw">in</span> <span class="va">self</span>.sla_targets.items():</span>
<span id="cb378-57"><a href="#cb378-57" aria-hidden="true" tabindex="-1"></a>            current_value <span class="op">=</span> metrics.get(metric, <span class="dv">0</span>)</span>
<span id="cb378-58"><a href="#cb378-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb378-59"><a href="#cb378-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> metric <span class="kw">in</span> [<span class="st">&#39;availability&#39;</span>, <span class="st">&#39;model_accuracy&#39;</span>]:</span>
<span id="cb378-60"><a href="#cb378-60" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–ª—è –º–µ—Ç—Ä–∏–∫ &quot;–±–æ–ª—å—à–µ –ª—É—á—à–µ&quot;</span></span>
<span id="cb378-61"><a href="#cb378-61" aria-hidden="true" tabindex="-1"></a>                compliance[metric] <span class="op">=</span> current_value <span class="op">&gt;=</span> target</span>
<span id="cb378-62"><a href="#cb378-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb378-63"><a href="#cb378-63" aria-hidden="true" tabindex="-1"></a>                <span class="co"># –î–ª—è –º–µ—Ç—Ä–∏–∫ &quot;–º–µ–Ω—å—à–µ –ª—É—á—à–µ&quot;</span></span>
<span id="cb378-64"><a href="#cb378-64" aria-hidden="true" tabindex="-1"></a>                compliance[metric] <span class="op">=</span> current_value <span class="op">&lt;=</span> target</span>
<span id="cb378-65"><a href="#cb378-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-66"><a href="#cb378-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –û–±—â–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SLA</span></span>
<span id="cb378-67"><a href="#cb378-67" aria-hidden="true" tabindex="-1"></a>        overall_compliance <span class="op">=</span> <span class="bu">all</span>(compliance.values())</span>
<span id="cb378-68"><a href="#cb378-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb378-69"><a href="#cb378-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb378-70"><a href="#cb378-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;overall_compliance&#39;</span>: overall_compliance,</span>
<span id="cb378-71"><a href="#cb378-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;individual_compliance&#39;</span>: compliance,</span>
<span id="cb378-72"><a href="#cb378-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;sla_score&#39;</span>: <span class="bu">sum</span>(compliance.values()) <span class="op">/</span> <span class="bu">len</span>(compliance)</span>
<span id="cb378-73"><a href="#cb378-73" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<h2 data-number="26.4" id="–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"><span
class="header-section-number">26.4</span> –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<h3 data-number="26.4.1" id="–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–¥–µ–π—Å—Ç–≤–∏—è"><span
class="header-section-number">26.4.1</span> 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ
–¥–µ–π—Å—Ç–≤–∏—è</h3>
<div class="sourceCode" id="cb379"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AutomatedActions:</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.action_rules <span class="op">=</span> {}</span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.action_history <span class="op">=</span> []</span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_automated_actions(<span class="va">self</span>):</span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π&quot;&quot;&quot;</span></span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.action_rules <span class="op">=</span> {</span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;restart_bot&#39;</span>: {</span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;trigger&#39;</span>: <span class="st">&#39;bot_down_for_5_minutes&#39;</span>,</span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="va">self</span>.restart_bot,</span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_attempts&#39;</span>: <span class="dv">3</span>,</span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;cooldown&#39;</span>: <span class="dv">300</span>  <span class="co"># 5 –º–∏–Ω—É—Ç</span></span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;close_all_positions&#39;</span>: {</span>
<span id="cb379-19"><a href="#cb379-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;trigger&#39;</span>: <span class="st">&#39;max_drawdown_exceeded&#39;</span>,</span>
<span id="cb379-20"><a href="#cb379-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="va">self</span>.close_all_positions,</span>
<span id="cb379-21"><a href="#cb379-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_attempts&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb379-22"><a href="#cb379-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;cooldown&#39;</span>: <span class="dv">0</span></span>
<span id="cb379-23"><a href="#cb379-23" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb379-24"><a href="#cb379-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;reduce_position_sizes&#39;</span>: {</span>
<span id="cb379-25"><a href="#cb379-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;trigger&#39;</span>: <span class="st">&#39;high_volatility_detected&#39;</span>,</span>
<span id="cb379-26"><a href="#cb379-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="va">self</span>.reduce_position_sizes,</span>
<span id="cb379-27"><a href="#cb379-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_attempts&#39;</span>: <span class="dv">5</span>,</span>
<span id="cb379-28"><a href="#cb379-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;cooldown&#39;</span>: <span class="dv">3600</span>  <span class="co"># 1 —á–∞—Å</span></span>
<span id="cb379-29"><a href="#cb379-29" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb379-30"><a href="#cb379-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;retrain_model&#39;</span>: {</span>
<span id="cb379-31"><a href="#cb379-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;trigger&#39;</span>: <span class="st">&#39;model_drift_detected&#39;</span>,</span>
<span id="cb379-32"><a href="#cb379-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: <span class="va">self</span>.retrain_model,</span>
<span id="cb379-33"><a href="#cb379-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;max_attempts&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb379-34"><a href="#cb379-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;cooldown&#39;</span>: <span class="dv">86400</span>  <span class="co"># 24 —á–∞—Å–∞</span></span>
<span id="cb379-35"><a href="#cb379-35" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb379-36"><a href="#cb379-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb379-37"><a href="#cb379-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb379-38"><a href="#cb379-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> execute_automated_action(<span class="va">self</span>, action_name, trigger_data):</span>
<span id="cb379-39"><a href="#cb379-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span></span>
<span id="cb379-40"><a href="#cb379-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-41"><a href="#cb379-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> action_name <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.action_rules:</span>
<span id="cb379-42"><a href="#cb379-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb379-43"><a href="#cb379-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-44"><a href="#cb379-44" aria-hidden="true" tabindex="-1"></a>        rule <span class="op">=</span> <span class="va">self</span>.action_rules[action_name]</span>
<span id="cb379-45"><a href="#cb379-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-46"><a href="#cb379-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span></span>
<span id="cb379-47"><a href="#cb379-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.is_action_in_cooldown(action_name):</span>
<span id="cb379-48"><a href="#cb379-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb379-49"><a href="#cb379-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-50"><a href="#cb379-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫</span></span>
<span id="cb379-51"><a href="#cb379-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.get_action_attempts(action_name) <span class="op">&gt;=</span> rule[<span class="st">&#39;max_attempts&#39;</span>]:</span>
<span id="cb379-52"><a href="#cb379-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb379-53"><a href="#cb379-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-54"><a href="#cb379-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb379-55"><a href="#cb379-55" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</span></span>
<span id="cb379-56"><a href="#cb379-56" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> rule[<span class="st">&#39;action&#39;</span>](trigger_data)</span>
<span id="cb379-57"><a href="#cb379-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-58"><a href="#cb379-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é</span></span>
<span id="cb379-59"><a href="#cb379-59" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.action_history.append({</span>
<span id="cb379-60"><a href="#cb379-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;timestamp&#39;</span>: datetime.now().isoformat(),</span>
<span id="cb379-61"><a href="#cb379-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;action&#39;</span>: action_name,</span>
<span id="cb379-62"><a href="#cb379-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;trigger&#39;</span>: trigger_data,</span>
<span id="cb379-63"><a href="#cb379-63" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;result&#39;</span>: result,</span>
<span id="cb379-64"><a href="#cb379-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;success&#39;</span>: result.get(<span class="st">&#39;success&#39;</span>, <span class="va">False</span>)</span>
<span id="cb379-65"><a href="#cb379-65" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb379-66"><a href="#cb379-66" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-67"><a href="#cb379-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span></span>
<span id="cb379-68"><a href="#cb379-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.get(<span class="st">&#39;success&#39;</span>, <span class="va">False</span>):</span>
<span id="cb379-69"><a href="#cb379-69" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.set_action_cooldown(action_name, rule[<span class="st">&#39;cooldown&#39;</span>])</span>
<span id="cb379-70"><a href="#cb379-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-71"><a href="#cb379-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result</span>
<span id="cb379-72"><a href="#cb379-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-73"><a href="#cb379-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb379-74"><a href="#cb379-74" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è </span><span class="sc">{</span>action_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb379-75"><a href="#cb379-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;success&#39;</span>: <span class="va">False</span>, <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e)}</span>
<span id="cb379-76"><a href="#cb379-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb379-77"><a href="#cb379-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> restart_bot(<span class="va">self</span>, trigger_data):</span>
<span id="cb379-78"><a href="#cb379-78" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞&quot;&quot;&quot;</span></span>
<span id="cb379-79"><a href="#cb379-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-80"><a href="#cb379-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb379-81"><a href="#cb379-81" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞</span></span>
<span id="cb379-82"><a href="#cb379-82" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.stop_bot()</span>
<span id="cb379-83"><a href="#cb379-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-84"><a href="#cb379-84" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –û–∂–∏–¥–∞–Ω–∏–µ</span></span>
<span id="cb379-85"><a href="#cb379-85" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">10</span>)</span>
<span id="cb379-86"><a href="#cb379-86" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-87"><a href="#cb379-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞</span></span>
<span id="cb379-88"><a href="#cb379-88" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.start_bot()</span>
<span id="cb379-89"><a href="#cb379-89" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-90"><a href="#cb379-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;success&#39;</span>: <span class="va">True</span>, <span class="st">&#39;message&#39;</span>: <span class="st">&#39;–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω&#39;</span>}</span>
<span id="cb379-91"><a href="#cb379-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-92"><a href="#cb379-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb379-93"><a href="#cb379-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;success&#39;</span>: <span class="va">False</span>, <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e)}</span>
<span id="cb379-94"><a href="#cb379-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb379-95"><a href="#cb379-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> close_all_positions(<span class="va">self</span>, trigger_data):</span>
<span id="cb379-96"><a href="#cb379-96" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π&quot;&quot;&quot;</span></span>
<span id="cb379-97"><a href="#cb379-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb379-98"><a href="#cb379-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb379-99"><a href="#cb379-99" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π</span></span>
<span id="cb379-100"><a href="#cb379-100" aria-hidden="true" tabindex="-1"></a>            active_positions <span class="op">=</span> <span class="va">self</span>.get_active_positions()</span>
<span id="cb379-101"><a href="#cb379-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-102"><a href="#cb379-102" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π</span></span>
<span id="cb379-103"><a href="#cb379-103" aria-hidden="true" tabindex="-1"></a>            closed_positions <span class="op">=</span> []</span>
<span id="cb379-104"><a href="#cb379-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> position <span class="kw">in</span> active_positions:</span>
<span id="cb379-105"><a href="#cb379-105" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="va">self</span>.close_position(position[<span class="st">&#39;id&#39;</span>])</span>
<span id="cb379-106"><a href="#cb379-106" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> result[<span class="st">&#39;success&#39;</span>]:</span>
<span id="cb379-107"><a href="#cb379-107" aria-hidden="true" tabindex="-1"></a>                    closed_positions.append(position[<span class="st">&#39;id&#39;</span>])</span>
<span id="cb379-108"><a href="#cb379-108" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-109"><a href="#cb379-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {</span>
<span id="cb379-110"><a href="#cb379-110" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;success&#39;</span>: <span class="va">True</span>, </span>
<span id="cb379-111"><a href="#cb379-111" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;message&#39;</span>: <span class="ss">f&#39;–ó–∞–∫—Ä—ã—Ç–æ –ø–æ–∑–∏—Ü–∏–π: </span><span class="sc">{</span><span class="bu">len</span>(closed_positions)<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb379-112"><a href="#cb379-112" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;closed_positions&#39;</span>: closed_positions</span>
<span id="cb379-113"><a href="#cb379-113" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb379-114"><a href="#cb379-114" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb379-115"><a href="#cb379-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb379-116"><a href="#cb379-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="st">&#39;success&#39;</span>: <span class="va">False</span>, <span class="st">&#39;error&#39;</span>: <span class="bu">str</span>(e)}</span></code></pre></div>
<h3 data-number="26.4.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–≤–Ω–µ—à–Ω–∏–º–∏-—Å–∏—Å—Ç–µ–º–∞–º–∏"><span
class="header-section-number">26.4.2</span> 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏
—Å–∏—Å—Ç–µ–º–∞–º–∏</h3>
<div class="sourceCode" id="cb380"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExternalIntegrations:</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏&quot;&quot;&quot;</span></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.integrations <span class="op">=</span> {}</span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.webhook_endpoints <span class="op">=</span> {}</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_integrations(<span class="va">self</span>):</span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π&quot;&quot;&quot;</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.integrations <span class="op">=</span> {</span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;prometheus&#39;</span>: <span class="va">self</span>.setup_prometheus_integration(),</span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grafana&#39;</span>: <span class="va">self</span>.setup_grafana_integration(),</span>
<span id="cb380-14"><a href="#cb380-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;datadog&#39;</span>: <span class="va">self</span>.setup_datadog_integration(),</span>
<span id="cb380-15"><a href="#cb380-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;new_relic&#39;</span>: <span class="va">self</span>.setup_new_relic_integration(),</span>
<span id="cb380-16"><a href="#cb380-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;webhooks&#39;</span>: <span class="va">self</span>.setup_webhook_integration()</span>
<span id="cb380-17"><a href="#cb380-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb380-18"><a href="#cb380-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-19"><a href="#cb380-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_prometheus_integration(<span class="va">self</span>):</span>
<span id="cb380-20"><a href="#cb380-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus&quot;&quot;&quot;</span></span>
<span id="cb380-21"><a href="#cb380-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-22"><a href="#cb380-22" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> prometheus_client <span class="im">import</span> Counter, Histogram, Gauge, start_http_server</span>
<span id="cb380-23"><a href="#cb380-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-24"><a href="#cb380-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ú–µ—Ç—Ä–∏–∫–∏</span></span>
<span id="cb380-25"><a href="#cb380-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prometheus_metrics <span class="op">=</span> {</span>
<span id="cb380-26"><a href="#cb380-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trades_total&#39;</span>: Counter(<span class="st">&#39;trading_bot_trades_total&#39;</span>, <span class="st">&#39;Total number of trades&#39;</span>),</span>
<span id="cb380-27"><a href="#cb380-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;profit_loss&#39;</span>: Gauge(<span class="st">&#39;trading_bot_profit_loss&#39;</span>, <span class="st">&#39;Current profit/loss&#39;</span>),</span>
<span id="cb380-28"><a href="#cb380-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;win_rate&#39;</span>: Gauge(<span class="st">&#39;trading_bot_win_rate&#39;</span>, <span class="st">&#39;Current win rate&#39;</span>),</span>
<span id="cb380-29"><a href="#cb380-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;response_time&#39;</span>: Histogram(<span class="st">&#39;trading_bot_response_time&#39;</span>, <span class="st">&#39;Response time&#39;</span>),</span>
<span id="cb380-30"><a href="#cb380-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;error_rate&#39;</span>: Gauge(<span class="st">&#39;trading_bot_error_rate&#39;</span>, <span class="st">&#39;Current error rate&#39;</span>)</span>
<span id="cb380-31"><a href="#cb380-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb380-32"><a href="#cb380-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-33"><a href="#cb380-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –º–µ—Ç—Ä–∏–∫</span></span>
<span id="cb380-34"><a href="#cb380-34" aria-hidden="true" tabindex="-1"></a>        start_http_server(<span class="dv">8000</span>)</span>
<span id="cb380-35"><a href="#cb380-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-36"><a href="#cb380-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb380-37"><a href="#cb380-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-38"><a href="#cb380-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_grafana_integration(<span class="va">self</span>):</span>
<span id="cb380-39"><a href="#cb380-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana&quot;&quot;&quot;</span></span>
<span id="cb380-40"><a href="#cb380-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-41"><a href="#cb380-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ Grafana</span></span>
<span id="cb380-42"><a href="#cb380-42" aria-hidden="true" tabindex="-1"></a>        grafana_config <span class="op">=</span> {</span>
<span id="cb380-43"><a href="#cb380-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;datasource&#39;</span>: <span class="st">&#39;prometheus&#39;</span>,</span>
<span id="cb380-44"><a href="#cb380-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;dashboard_url&#39;</span>: <span class="st">&#39;http://grafana:3000/d/trading-bot&#39;</span>,</span>
<span id="cb380-45"><a href="#cb380-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;panels&#39;</span>: [</span>
<span id="cb380-46"><a href="#cb380-46" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb380-47"><a href="#cb380-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;Trading Performance&#39;</span>,</span>
<span id="cb380-48"><a href="#cb380-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;graph&#39;</span>,</span>
<span id="cb380-49"><a href="#cb380-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;targets&#39;</span>: [</span>
<span id="cb380-50"><a href="#cb380-50" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;trading_bot_profit_loss&#39;</span>,</span>
<span id="cb380-51"><a href="#cb380-51" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;trading_bot_win_rate&#39;</span></span>
<span id="cb380-52"><a href="#cb380-52" aria-hidden="true" tabindex="-1"></a>                    ]</span>
<span id="cb380-53"><a href="#cb380-53" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb380-54"><a href="#cb380-54" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb380-55"><a href="#cb380-55" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;title&#39;</span>: <span class="st">&#39;System Health&#39;</span>,</span>
<span id="cb380-56"><a href="#cb380-56" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;type&#39;</span>: <span class="st">&#39;singlestat&#39;</span>,</span>
<span id="cb380-57"><a href="#cb380-57" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;targets&#39;</span>: [</span>
<span id="cb380-58"><a href="#cb380-58" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;trading_bot_error_rate&#39;</span></span>
<span id="cb380-59"><a href="#cb380-59" aria-hidden="true" tabindex="-1"></a>                    ]</span>
<span id="cb380-60"><a href="#cb380-60" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb380-61"><a href="#cb380-61" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb380-62"><a href="#cb380-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb380-63"><a href="#cb380-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-64"><a href="#cb380-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> grafana_config</span>
<span id="cb380-65"><a href="#cb380-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-66"><a href="#cb380-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_webhook_integration(<span class="va">self</span>):</span>
<span id="cb380-67"><a href="#cb380-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å webhooks&quot;&quot;&quot;</span></span>
<span id="cb380-68"><a href="#cb380-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-69"><a href="#cb380-69" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.webhook_endpoints <span class="op">=</span> {</span>
<span id="cb380-70"><a href="#cb380-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;trading_events&#39;</span>: <span class="st">&#39;https://api.example.com/webhooks/trading&#39;</span>,</span>
<span id="cb380-71"><a href="#cb380-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;system_alerts&#39;</span>: <span class="st">&#39;https://api.example.com/webhooks/alerts&#39;</span>,</span>
<span id="cb380-72"><a href="#cb380-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;performance_reports&#39;</span>: <span class="st">&#39;https://api.example.com/webhooks/performance&#39;</span></span>
<span id="cb380-73"><a href="#cb380-73" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb380-74"><a href="#cb380-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-75"><a href="#cb380-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb380-76"><a href="#cb380-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb380-77"><a href="#cb380-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> send_webhook(<span class="va">self</span>, endpoint, data):</span>
<span id="cb380-78"><a href="#cb380-78" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ webhook&quot;&quot;&quot;</span></span>
<span id="cb380-79"><a href="#cb380-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-80"><a href="#cb380-80" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> requests</span>
<span id="cb380-81"><a href="#cb380-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-82"><a href="#cb380-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> endpoint <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.webhook_endpoints:</span>
<span id="cb380-83"><a href="#cb380-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb380-84"><a href="#cb380-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-85"><a href="#cb380-85" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="va">self</span>.webhook_endpoints[endpoint]</span>
<span id="cb380-86"><a href="#cb380-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb380-87"><a href="#cb380-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb380-88"><a href="#cb380-88" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.post(url, json<span class="op">=</span>data, timeout<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb380-89"><a href="#cb380-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> response.status_code <span class="op">==</span> <span class="dv">200</span></span>
<span id="cb380-90"><a href="#cb380-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb380-91"><a href="#cb380-91" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ webhook: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb380-92"><a href="#cb380-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span></code></pre></div>
<h2 data-number="26.5" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ-14"><span
class="header-section-number">26.5</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è
—Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –°–ª–µ–¥—É—è –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º,
–æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ, –≤—ã —Å–º–æ–∂–µ—Ç–µ:</p>
<ol type="1">
<li><strong>–ë—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</strong> - —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º—ã
–∞–ª–µ—Ä—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong> - —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑
–º–µ—Ç—Ä–∏–∫ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</li>
<li><strong>–û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É</strong> - —Å –ø–æ–º–æ—â—å—é
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</li>
<li><strong>–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏</strong> - –¥–ª—è
—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞</li>
</ol>
<p>–ü–æ–º–Ω–∏—Ç–µ: —Ö–æ—Ä–æ—à–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - —ç—Ç–æ –∑–∞–ª–æ–≥ —É—Å–ø–µ—à–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã!
üöÄ</p>

<h1 data-number="27" id="—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã-–∫–æ—Ç–æ—Ä–∞—è-–¥–∞–µ—Ç-100-–ø—Ä–∏–±—ã–ª–∏-–≤-–º–µ—Å—è—Ü-–∏-–ø—Ä–∏-—ç—Ç–æ–º-–∏–º–µ–µ—Ç-95-—Ç–æ—á–Ω–æ—Å—Ç—å-–∏—Å–ø–æ–ª—å–∑—É—è-–≤—Å–µ-—Å–∞–º—ã–µ-–ª—É—á—à–∏–µ-—Ç–µ—Ö–Ω–∏–∫–∏-–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã-schr-levels-wave2-short3"><span class="header-section-number">27</span> –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ—Ç–æ—Ä–∞—è –¥–∞–µ—Ç > 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –∏ –ø—Ä–∏ —ç—Ç–æ–º –∏–º–µ–µ—Ç 95% —Ç–æ—á–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ —Å–∞–º—ã–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã SCHR Levels, Wave2, Short3</h1>

<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>

<h2 data-number="27.1" id="–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Å—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤—É—é-—Å–∏—Å—Ç–µ–º—É"><span class="header-section-number">27.1</span> –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É</h2>

<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—É—é —Ç–æ—Ä–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Å–∞–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. <strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è —Å–∏—Å—Ç–µ–º–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ç–æ—Ä–≥–æ–≤–ª–µ –∏–º–µ—é—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞–µ–º —á–µ—Ä–µ–∑ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.</p>

<h3 data-number="27.1.1" id="—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—Å–∏—Å—Ç–µ–º—ã"><span class="header-section-number">27.1.1</span> –§–∏–ª–æ—Å–æ—Ñ–∏—è —Å–∏—Å—Ç–µ–º—ã</h3>

<p><strong>–ü–æ—á–µ–º—É –º—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –∫ —Ç–∞–∫–∏–º –≤—ã—Å–æ–∫–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä—ã–Ω–æ–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ –∏—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–∑-–∑–∞:</p>

<ul>
<li><strong>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π:</strong> 90% —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏ –∏–∑-–∑–∞ —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</li>
<li><strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:</strong> –¢–æ—Ä–≥—É—é—Ç –Ω–∞ —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:</strong> –ù–µ—Ç —á–µ—Ç–∫–∏—Ö –ø—Ä–∞–≤–∏–ª –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞</li>
<li><strong>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞:</strong> –ù–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π</li>
</ul>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç –Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞:</strong></p>

<ul>
<li><strong>–¶–µ–ª—å: > 100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü</strong> - –≠—Ç–æ –¥–æ—Å—Ç–∏–∂–∏–º–æ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –∫ –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å: 95%+</strong> - –î–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ ML-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞: < 5%</strong> - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–∏–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º –∏ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: > 3.0</strong> - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ –∫ —Ä–∏—Å–∫—É</li>
</ul>

<h3 data-number="27.1.2" id="–ø—Ä–∏–Ω—Ü–∏–ø—ã-—Ä–∞–±–æ—Ç—ã-—Å–∏—Å—Ç–µ–º—ã"><span class="header-section-number">27.1.2</span> –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–Ω—Ü–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Å–∞–º—ã—Ö —É—Å–ø–µ—à–Ω—ã—Ö —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞—Ö:</p>

<ol>
<li><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑:</strong> –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ —ç–º–æ—Ü–∏–π</li>
<li><strong>–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:</strong> –ö–∞–∂–¥—ã–π —Å–∏–≥–Ω–∞–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç 7 —É—Ä–æ–≤–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏</li>
<li><strong>–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:</strong> AI –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°—Ç—Ä–æ–≥–∏–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç:</strong> –ö–∞–∂–¥–∞—è —Å–¥–µ–ª–∫–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞</li>
<li><strong>–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä—ã–Ω–æ—á–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º</li>
</ol>

<p><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong></p>
<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –≤ –ª—é–±—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–∞–ø–∏—Ç–∞–ª –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:</strong> –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —É—á–∞—Å—Ç–∏–µ —á–µ–ª–æ–≤–µ–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</strong> –ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</li>
</ul>

<h2 data-number="27.2" id="–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã"><span class="header-section-number">27.2</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —É—Å–ø–µ—à–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞–∫ —Ö–æ—Ä–æ—à–æ –æ—Ç–ª–∞–∂–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é, –∞ –≤–º–µ—Å—Ç–µ –æ–Ω–∏ —Å–æ–∑–¥–∞—é—Ç —Å–∏–Ω–µ—Ä–≥–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç —Å—É–º–º—É —á–∞—Å—Ç–µ–π.</p>

<h3 data-number="27.2.1" id="–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏"><span class="header-section-number">27.2.1</span> –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ 7 —É—Ä–æ–≤–Ω–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –∫–∞–∂–¥—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ 8-12%, –Ω–æ –ø–æ—Å–ª–µ 7 —É—Ä–æ–≤–Ω–µ–π –ø—Ä–∏—Ä–æ—Å—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º, –∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å—Ç–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ.</p>

<p>–ù–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 7 —É—Ä–æ–≤–Ω–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ—à–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É:</p>

<ol>
<li><strong>–£—Ä–æ–≤–µ–Ω—å 1: SCHR Levels</strong> - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> 80% —Ü–µ–Ω–æ–≤—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –æ—Ç/–∫ –∫–ª—é—á–µ–≤—ã–º —É—Ä–æ–≤–Ω—è–º</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ó–Ω–∞–Ω–∏–µ, –≥–¥–µ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ –≤ 3-4 —Ä–∞–∑–∞</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∞–∫—Å–∏–º—É–º—ã/–º–∏–Ω–∏–º—É–º—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç —É—Ä–æ–≤–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ "–ø–æ–º–Ω—è—Ç" —Ä—ã–Ω–æ–∫</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 2: WAVE2</strong> - –∞–Ω–∞–ª–∏–∑ –≤–æ–ª–Ω–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –†—ã–Ω–æ–∫ –¥–≤–∏–∂–µ—Ç—Å—è –≤–æ–ª–Ω–∞–º–∏, –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –≤–æ–ª–Ω—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 70-80%</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤–æ–ª–Ω–æ–≤–æ–π —Ç–µ–æ—Ä–∏–∏ –≠–ª–ª–∏–æ—Ç–∞ –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –§–∏–±–æ–Ω–∞—á—á–∏</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 3: SHORT3</strong> - –±—ã—Å—Ç—Ä—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤—Ö–æ–¥–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –ù–∞ –º–∞–ª—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö –º–æ–∂–Ω–æ –ø–æ–π–º–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ —Å—Ç–∞–Ω—É—Ç –æ—á–µ–≤–∏–¥–Ω—ã–º–∏</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –í—Ö–æ–¥ –≤ –ø–æ–∑–∏—Ü–∏—é –Ω–∞ 2-3 —Å–≤–µ—á–∏ —Ä–∞–Ω—å—à–µ –¥—Ä—É–≥–∏—Ö —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ 3 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–≤–µ—á–µ–π</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 4: ML-–º–æ–¥–µ–ª—å</strong> - –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –º–æ–∑–≥ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ù–∞—Ö–æ–¥–∏—Ç —Å–∫—Ä—ã—Ç—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É 50+ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –û–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∫–∏</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 5: –û–±—ä–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong> - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–∏–ª—ã –¥–≤–∏–∂–µ–Ω–∏—è
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∏—Å—Ç–∏–Ω–Ω–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ—Ç –ª–æ–∂–Ω—ã–µ –ø—Ä–æ–±–æ–∏ –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –æ–±—ä–µ–º —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º —Å—Ä–µ–¥–Ω–∏–º</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 6: –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä</strong> - —Ç–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —á–∞—Å—ã —Ç–æ—Ä–≥–æ–≤–ª–∏
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –í —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ —Ä—ã–Ω–æ–∫ –≤–µ–¥–µ—Ç —Å–µ–±—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –¢–æ—Ä–≥—É–µ–º —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–∏–æ–¥—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º</li>
    </ul>
</li>

<li><strong>–£—Ä–æ–≤–µ–Ω—å 7: –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</strong> –û–¥–Ω–∞ –ø–ª–æ—Ö–∞—è —Å–¥–µ–ª–∫–∞ –º–æ–∂–µ—Ç —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –º–µ—Å—è—Ü—ã –ø—Ä–∏–±—ã–ª–∏</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ 1-2% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞</li>
        <li><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏, —Å—Ç–æ–ø-–ª–æ—Å—Å –∏ –æ–±—â–∏–π —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è</li>
    </ul>
</li>
</ol>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç —Ç–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</strong></p>
<ul>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:</strong> 95%+ –±–ª–∞–≥–æ–¥–∞—Ä—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</li>
<li><strong>–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫:</strong> –ö–∞–∂–¥–∞—è —Å–¥–µ–ª–∫–∞ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞</li>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:</strong> –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–∞–ø–∏—Ç–∞–ª –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
</ul>

<h3 data-number="27.2.2" id="–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–≤—Å–µ—Ö-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span class="header-section-number">27.2.2</span> –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h3>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö —Ä–µ—à–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É, –∞ –≤–º–µ—Å—Ç–µ –æ–Ω–∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ä—ã–Ω–∫–∞. –ú—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã - –∫–∞–∂–¥—ã–π –≤—ã–±—Ä–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–≥–æ–ª–µ—Ç–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</p>

<p><strong>–ü—Ä–∏–Ω—Ü–∏–ø —Å–∏–Ω–µ—Ä–≥–∏–∏:</strong> 1+1+1 = 10, –∞ –Ω–µ 3. –ö–æ–≥–¥–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ, –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ.</p>

<p>–°–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º:</p>

<ul>
<li><strong>SCHR Levels:</strong> –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ SCHR:</strong> –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è, –∞ "—É–º–Ω—ã–µ" —É—Ä–æ–≤–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é —Ä—ã–Ω–∫–∞</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å 30% –¥–æ 85%</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –°–ª—É–∂–∏—Ç –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ - –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç SCHR Levels —Å–¥–µ–ª–∫–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è</li>
    </ul>
</li>

<li><strong>WAVE2:</strong> –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–ª–Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ WAVE2:</strong> –≠—Ç–æ —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤–æ–ª–Ω–æ–≤–æ–π —Ç–µ–æ—Ä–∏–∏ –≠–ª–ª–∏–æ—Ç–∞ —Å –º–∞—à–∏–Ω–Ω—ã–º –æ–±—É—á–µ–Ω–∏–µ–º</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 78% –Ω–∞ 3-5 —Å–≤–µ—á–µ–π –≤–ø–µ—Ä–µ–¥</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–∞—Ä–µ —Å SCHR Levels - –∏—â–µ—Ç –≤–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤–±–ª–∏–∑–∏ –∫–ª—é—á–µ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π</li>
    </ul>
</li>

<li><strong>SHORT3:</strong> –î–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –≤—Ö–æ–¥–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ SHORT3:</strong> –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∞–Ω–∞–ª–∏–∑ 3 —Å–≤–µ—á–µ–π, –∞ —Å–ª–æ–∂–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç 15+ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ–π—Ç–∏ –≤ –ø–æ–∑–∏—Ü–∏—é –Ω–∞ 2-3 —Å–≤–µ—á–∏ —Ä–∞–Ω—å—à–µ –¥—Ä—É–≥–∏—Ö —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ WAVE2 –∏ SCHR Levels —É–∂–µ –¥–∞–ª–∏ —Å–∏–≥–Ω–∞–ª</li>
    </ul>
</li>

<li><strong>RSI:</strong> –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ RSI:</strong> –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –Ω–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —É—Ä–æ–≤–Ω—è–º–∏</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –≤—Ö–æ–¥–æ–≤ –≤ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω—ã–µ/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω—ã–µ –∑–æ–Ω—ã</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä - –µ—Å–ª–∏ RSI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å, —Å–¥–µ–ª–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è</li>
    </ul>
</li>

<li><strong>MACD:</strong> –î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ MACD:</strong> –õ—É—á—à–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ –∏ –º–æ–º–µ–Ω—Ç–æ–≤ –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 82%</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ç–æ–º –∂–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∏–¥–µ—è</li>
    </ul>
</li>

<li><strong>Bollinger Bands:</strong> –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ Bollinger Bands:</strong> –õ—É—á—à–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤ –≤—ã—Å–æ–∫–æ–π/–Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–º–æ–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∏—Å–∫–∞ - –≤ –ø–µ—Ä–∏–æ–¥—ã –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è</li>
    </ul>
</li>

<li><strong>Volume Profile:</strong> –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ–±—ä–µ–º–æ–≤
    <ul>
        <li><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ Volume Profile:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</li>
        <li><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–∏–ª—É —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</li>
        <li><strong>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:</strong> –£—Ä–æ–≤–Ω–∏ —Å –≤—ã—Å–æ–∫–∏–º –æ–±—ä–µ–º–æ–º –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ SCHR Levels</li>
    </ul>
</li>
</ul>

<h4 data-number="27.2.2.1" id="–∞–ª–≥–æ—Ä–∏—Ç–º-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"><span class="header-section-number">27.2.2.1</span> –ê–ª–≥–æ—Ä–∏—Ç–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ - –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤–µ—Å –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∏ –∏—Ö –≤–∑–∞–∏–º–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ.</p>

<pre><code>def integrate_indicators(market_data):
    """
    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å –≤–µ—Å–æ–≤—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
    """
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
    schr_signal = get_schr_levels_signal(market_data)
    wave2_signal = get_wave2_signal(market_data)
    short3_signal = get_short3_signal(market_data)
    rsi_signal = get_rsi_signal(market_data)
    macd_signal = get_macd_signal(market_data)
    bb_signal = get_bollinger_bands_signal(market_data)
    volume_signal = get_volume_profile_signal(market_data)
    
    # –í–µ—Å–æ–≤—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)
    weights = {
        'schr': 0.25,      # 25% - –æ—Å–Ω–æ–≤–∞ —Å–∏—Å—Ç–µ–º—ã
        'wave2': 0.20,     # 20% - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        'short3': 0.15,    # 15% - —Ç–æ—á–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞
        'rsi': 0.10,       # 10% - —Ñ–∏–ª—å—Ç—Ä –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏
        'macd': 0.15,      # 15% - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
        'bb': 0.10,        # 10% - –∞–Ω–∞–ª–∏–∑ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
        'volume': 0.05     # 5% - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–∏–ª—ã
    }
    
    # –†–∞—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
    total_signal = 0
    for indicator, weight in weights.items():
        signal_value = locals()[f"{indicator}_signal"]
        total_signal += signal_value * weight
    
    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
    if total_signal > 0.7:  # –°–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ–∫—É–ø–∫—É
        return {'action': 'buy', 'strength': total_signal, 'confidence': 'high'}
    elif total_signal < -0.7:  # –°–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
        return {'action': 'sell', 'strength': abs(total_signal), 'confidence': 'high'}
    else:  # –°–ª–∞–±—ã–π —Å–∏–≥–Ω–∞–ª - –Ω–µ —Ç–æ—Ä–≥—É–µ–º
        return {'action': 'hold', 'strength': abs(total_signal), 'confidence': 'low'}
</code></pre>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç —Ç–∞–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:</strong></p>
<ul>
<li><strong>–°–∏–Ω–µ—Ä–≥–∏—è:</strong> –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –Ω–∞ 40% –≤—ã—à–µ, —á–µ–º —Å—É–º–º–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</li>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–∞–µ—Ç –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –µ–≥–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—Ç</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –í–µ—Å–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ç–µ–∫—É—â–µ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</strong> –ö–∞–∂–¥—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–∂–Ω–æ —Ä–∞–∑–ª–æ–∂–∏—Ç—å –Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</li>
</ul>

<h2 data-number="27.3" id="–∞–ª–≥–æ—Ä–∏—Ç–º-—Ç–æ—Ä–≥–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º—ã"><span class="header-section-number">27.3</span> –ê–ª–≥–æ—Ä–∏—Ç–º —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã</h2>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —É—Å–ø–µ—à–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ö–æ—Ä–æ—à–æ –æ—Ç–ª–∞–∂–µ–Ω–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä - –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∏ –ø—Ä–æ–ø—É—Å–∫ –ª—é–±–æ–≥–æ —ç—Ç–∞–ø–∞ —Å–Ω–∏–∂–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.</p>

<p><strong>–ü—Ä–∏–Ω—Ü–∏–ø –∫–∞—Å–∫–∞–¥–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:</strong> –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ—Ç 70-80% —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞.</p>

<h3 data-number="27.3.1" id="—ç—Ç–∞–ø-1-–∞–Ω–∞–ª–∏–∑-schr-levels"><span class="header-section-number">27.3.1</span> –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ SCHR Levels</h3>

<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º –∏–º–µ–Ω–Ω–æ —Å SCHR Levels?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã - –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã —Ç–µ—Ä—è—é—Ç —Å–º—ã—Å–ª. 80% —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤–±–ª–∏–∑–∏ —ç—Ç–∏—Ö —É—Ä–æ–≤–Ω–µ–π.</p>

<p><strong>–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:</strong> –ó–Ω–∞–Ω–∏–µ, –≥–¥–µ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ –≤ 3-4 —Ä–∞–∑–∞ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–º–µ—â–∞—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å—ã.</p>

<h4 data-number="27.3.1.1" id="–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-–∫–ª—é—á–µ–≤—ã—Ö-—É—Ä–æ–≤–Ω–µ–π"><span class="header-section-number">27.3.1.1</span> –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–∞–∂–Ω—ã - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ "–ø–æ–º–Ω—è—Ç" —Ä—ã–Ω–æ–∫ –ª—É—á—à–µ –¥—Ä—É–≥–∏—Ö –∏ —Å –±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –≤—ã–∑–æ–≤—É—Ç —Ä–µ–∞–∫—Ü–∏—é —Ü–µ–Ω—ã.</p>

<pre><code>def analyze_schr_levels(price_data):
    """
    –ê–Ω–∞–ª–∏–∑ SCHR Levels —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
    """
    # –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –º–∞–∫—Å–∏–º—É–º–æ–≤ –∏ –º–∏–Ω–∏–º—É–º–æ–≤
    # –ü–æ—á–µ–º—É: –¶–µ–Ω–∞ –∏–º–µ–µ—Ç "–ø–∞–º—è—Ç—å" - –º–µ—Å—Ç–∞, –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã, 
    # —Å –±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –≤—ã–∑–æ–≤—É—Ç —Ä–µ–∞–∫—Ü–∏—é –≤ –±—É–¥—É—â–µ–º
    resistance_levels = find_resistance_levels(price_data)
    support_levels = find_support_levels(price_data)
    
    # –®–∞–≥ 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–∏–ª–µ —É—Ä–æ–≤–Ω—è
    # –ü–æ—á–µ–º—É: –ù–µ –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–∞–∂–Ω—ã - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ "–ø–æ–º–Ω—è—Ç" —Ä—ã–Ω–æ–∫ –ª—É—á—à–µ
    # –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç: –û—Ç—Å–µ–∏–≤–∞–µ–º 60% —Å–ª–∞–±—ã—Ö —É—Ä–æ–≤–Ω–µ–π, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ —Å–∏–ª—å–Ω—ã–µ
    strong_levels = filter_strong_levels(resistance_levels, support_levels)
    
    # –®–∞–≥ 3: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
    # –ü–æ—á–µ–º—É: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —É—Ä–æ–≤–Ω–∏ –≤–∞–∂–Ω–µ–µ –¥—Ä—É–≥–∏—Ö –≤ —Ç–µ–∫—É—â–∏—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
    # –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç: –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö
    prioritized_levels = prioritize_levels(strong_levels, current_market_conditions)
    
    return prioritized_levels

def find_resistance_levels(price_data):
    """
    –ü–æ–∏—Å–∫ —É—Ä–æ–≤–Ω–µ–π —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏
    """
    resistance_levels = []
    
    # –ê–Ω–∞–ª–∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∞–∫—Å–∏–º—É–º–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–≤–µ—á–µ–π
    # –ü–æ—á–µ–º—É 100: –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
    for i in range(20, len(price_data) - 20):
        if is_local_maximum(price_data, i, 20):
            level = price_data[i]['high']
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–ª—ã —É—Ä–æ–≤–Ω—è
            # –ü–æ—á–µ–º—É: –£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "–∑–∞–ø–æ–º–Ω–µ–Ω" —Ä—ã–Ω–∫–æ–º
            strength = calculate_level_strength(price_data, level, i)
            
            if strength > 0.7:  # –ü–æ—Ä–æ–≥ 70% - —Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
                resistance_levels.append({
                    'price': level,
                    'strength': strength,
                    'timestamp': price_data[i]['timestamp'],
                    'touches': count_level_touches(price_data, level, i)
                })
    
    return resistance_levels

def calculate_level_strength(price_data, level, index):
    """
    –†–∞—Å—á–µ—Ç —Å–∏–ª—ã —É—Ä–æ–≤–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤
    """
    strength = 0
    
    # –§–∞–∫—Ç–æ—Ä 1: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Å–∞–Ω–∏–π —É—Ä–æ–≤–Ω—è (30% –≤–µ—Å–∞)
    # –ü–æ—á–µ–º—É: –ß–µ–º –±–æ–ª—å—à–µ –∫–∞—Å–∞–Ω–∏–π, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —É—Ä–æ–≤–µ–Ω—å
    touches = count_level_touches(price_data, level, index)
    strength += min(touches * 0.1, 0.3)  # –ú–∞–∫—Å–∏–º—É–º 30%
    
    # –§–∞–∫—Ç–æ—Ä 2: –û–±—ä–µ–º –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ —É—Ä–æ–≤–Ω—è (25% –≤–µ—Å–∞)
    # –ü–æ—á–µ–º—É: –í—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è
    volume_factor = calculate_volume_factor(price_data, level, index)
    strength += volume_factor * 0.25
    
    # –§–∞–∫—Ç–æ—Ä 3: –í—Ä–µ–º—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–∞—Å–∞–Ω–∏—è (20% –≤–µ—Å–∞)
    # –ü–æ—á–µ–º—É: –°–≤–µ–∂–∏–µ —É—Ä–æ–≤–Ω–∏ –±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã
    time_factor = calculate_time_factor(price_data, level, index)
    strength += time_factor * 0.2
    
    # –§–∞–∫—Ç–æ—Ä 4: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã (15% –≤–µ—Å–∞)
    # –ü–æ—á–µ–º—É: –ë–ª–∏–∑–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã
    distance_factor = calculate_distance_factor(price_data, level, index)
    strength += distance_factor * 0.15
    
    # –§–∞–∫—Ç–æ—Ä 5: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ (10% –≤–µ—Å–∞)
    # –ü–æ—á–µ–º—É: –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è
    volatility_factor = calculate_volatility_factor(price_data, level, index)
    strength += volatility_factor * 0.1
    
    return min(strength, 1.0)  # –ú–∞–∫—Å–∏–º—É–º 100%
</code></pre>

<h4 data-number="27.3.1.2" id="–ø—Ä–æ–≤–µ—Ä–∫–∞-–ø—Ä–æ–±–æ—è-—É—Ä–æ–≤–Ω–µ–π"><span class="header-section-number">27.3.1.2</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–æ—è —É—Ä–æ–≤–Ω–µ–π</h4>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–±–æ—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ª–æ–∂–Ω—ã–µ –ø—Ä–æ–±–æ–∏ - –≥–ª–∞–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ —É–±—ã—Ç–∫–æ–≤. –ù–∞—à–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç 85% –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.</p>

<pre><code>def check_breakout(price, level, volume, market_data):
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–æ—è —É—Ä–æ–≤–Ω—è —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏
    """
    # –ö—Ä–∏—Ç–µ—Ä–∏–π 1: –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
    # –ü–æ—á–µ–º—É: –ë–∞–∑–æ–≤–æ–µ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–±–æ—è
    if price <= level:
        return False
    
    # –ö—Ä–∏—Ç–µ—Ä–∏–π 2: –û–±—ä–µ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
    # –ü–æ—á–µ–º—É: –ò—Å—Ç–∏–Ω–Ω—ã–π –ø—Ä–æ–±–æ–π —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–∏–º –æ–±—ä–µ–º–æ–º
    average_volume = calculate_average_volume(market_data, 20)
    if volume < average_volume * 1.5:
        return False
    
    # –ö—Ä–∏—Ç–µ—Ä–∏–π 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–≤–µ—á–∏
    # –ü–æ—á–µ–º—É: –ü—Ä–æ–±–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –∑–∞–∫—Ä—ã—Ç–∏–µ–º
    if not is_confirmed_by_close(market_data, level):
        return False
    
    # –ö—Ä–∏—Ç–µ—Ä–∏–π 4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–æ–µ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–≤–µ—á–µ–π
    # –ü–æ—á–µ–º—É: –ò–∑–±–µ–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
    if has_recent_false_breakout(market_data, level, 5):
        return False
    
    # –ö—Ä–∏—Ç–µ—Ä–∏–π 5: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–±—â–µ–º—É —Ç—Ä–µ–Ω–¥—É
    # –ü–æ—á–µ–º—É: –ü—Ä–æ–±–æ–π –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–µ–Ω
    if not matches_overall_trend(market_data, level):
        return False
    
    return True

def is_confirmed_by_close(market_data, level):
    """
    –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–≤–µ—á–∏
    """
    # –ñ–¥–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–µ–∫—É—â–µ–π —Å–≤–µ—á–∏
    current_candle = market_data[-1]
    
    # –ü—Ä–æ–±–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–º, –µ—Å–ª–∏:
    # 1. –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã–ª–∞—Å—å –≤—ã—à–µ —É—Ä–æ–≤–Ω—è
    # 2. –¢–µ–ª–æ —Å–≤–µ—á–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç > 60% –æ—Ç –æ–±—â–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    # 3. –û–±—ä–µ–º –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
    
    if current_candle['close'] > level:
        body_size = abs(current_candle['close'] - current_candle['open'])
        total_range = current_candle['high'] - current_candle['low']
        
        if body_size / total_range > 0.6:  # 60% —Ç–µ–ª–∞ —Å–≤–µ—á–∏
            return True
    
    return False
</code></pre>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –∫ SCHR Levels:</strong></p>
<ul>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:</strong> 85% —É—Ä–æ–≤–Ω–µ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞—é—Ç —Ä–µ–∞–∫—Ü–∏—é —Ü–µ–Ω—ã</li>
<li><strong>–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤:</strong> 90% –ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–æ–µ–≤ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω–µ–π</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</strong> –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –º–æ–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å</li>
</ul>

<h3 data-number="27.3.2" id="—ç—Ç–∞–ø-2-–∞–Ω–∞–ª–∏–∑-wave2"><span class="header-section-number">27.3.2</span> –≠—Ç–∞–ø 2: –ê–Ω–∞–ª–∏–∑ WAVE2</h3>

<p>1. <strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–ª–Ω–æ–≤—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä:</strong></p>
<pre><code>def analyze_wave2_patterns(price_data):
    # –ü–æ–∏—Å–∫ –∏–º–ø—É–ª—å—Å–Ω—ã—Ö –≤–æ–ª–Ω
    impulse_waves = find_impulse_waves(price_data)
    
    # –ü–æ–∏—Å–∫ –∫–æ—Ä—Ä–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –≤–æ–ª–Ω
    correction_waves = find_correction_waves(price_data)
    
    # –ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π –§–∏–±–æ–Ω–∞—á—á–∏
    fibonacci_ratios = calculate_fibonacci_ratios(impulse_waves, correction_waves)
    
    return {
        'impulse_waves': impulse_waves,
        'correction_waves': correction_waves,
        'fibonacci_ratios': fibonacci_ratios
    }
</code></pre>

<h3 data-number="27.3.3" id="—ç—Ç–∞–ø-3-–∞–Ω–∞–ª–∏–∑-short3"><span class="header-section-number">27.3.3</span> –≠—Ç–∞–ø 3: –ê–Ω–∞–ª–∏–∑ SHORT3</h3>

<p>1. <strong>–ë—ã—Å—Ç—Ä—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤—Ö–æ–¥–∞:</strong></p>
<pre><code>def analyze_short3_signals(price_data, timeframe='1m'):
    # –ê–Ω–∞–ª–∏–∑ –Ω–∞ –º–∞–ª—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
    short_signals = []
    
    for i in range(len(price_data) - 3):
        # –ü–∞—Ç—Ç–µ—Ä–Ω SHORT3: 3 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏—è
        if is_short3_pattern(price_data[i:i+3]):
            signal = {
                'type': 'buy' if price_data[i+2] > price_data[i] else 'sell',
                'strength': calculate_signal_strength(price_data[i:i+3]),
                'timestamp': price_data[i+2]['timestamp']
            }
            short_signals.append(signal)
    
    return short_signals
</code></pre>

<h2 data-number="27.4" id="ml-–º–æ–¥–µ–ª—å-–¥–ª—è-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è-—Å–∏–≥–Ω–∞–ª–æ–≤"><span class="header-section-number">27.4</span> ML-–º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</h2>

<h3 data-number="27.4.1" id="–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö"><span class="header-section-number">27.4.1</span> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>

<pre><code>def prepare_ml_features(market_data):
    features = []
    
    # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
    features.extend(calculate_rsi(market_data))
    features.extend(calculate_macd(market_data))
    features.extend(calculate_bollinger_bands(market_data))
    
    # SCHR Levels –¥–∞–Ω–Ω—ã–µ
    features.extend(extract_schr_features(market_data))
    
    # WAVE2 –¥–∞–Ω–Ω—ã–µ
    features.extend(extract_wave2_features(market_data))
    
    # SHORT3 –¥–∞–Ω–Ω—ã–µ
    features.extend(extract_short3_features(market_data))
    
    # –û–±—ä–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    features.extend(calculate_volume_indicators(market_data))
    
    return np.array(features)
</code></pre>

<h3 data-number="27.4.2" id="–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏"><span class="header-section-number">27.4.2</span> –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>

<pre><code>from autogluon.tabular import TabularPredictor

def train_trading_model(training_data):
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    X = prepare_ml_features(training_data)
    y = training_data['profit_label']  # 1 - –ø—Ä–∏–±—ã–ª—å–Ω–∞—è —Å–¥–µ–ª–∫–∞, 0 - —É–±—ã—Ç–æ—á–Ω–∞—è
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞
    predictor = TabularPredictor(
        label='profit_label',
        problem_type='binary',
        eval_metric='accuracy'
    )
    
    # –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
    predictor.fit(
        train_data=pd.DataFrame(X, columns=feature_names),
        time_limit=3600,  # 1 —á–∞—Å –æ–±—É—á–µ–Ω–∏—è
        presets='best_quality'
    )
    
    return predictor
</code></pre>

<h2 data-number="27.5" id="—Å–∏—Å—Ç–µ–º–∞-—Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞"><span class="header-section-number">27.5</span> –°–∏—Å—Ç–µ–º–∞ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</h2>

<h3 data-number="27.5.1" id="–ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"><span class="header-section-number">27.5.1</span> –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>

<pre><code>def calculate_position_size(account_balance, risk_per_trade, stop_loss_distance):
    """
    –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∏—Å–∫–∞
    """
    risk_amount = account_balance * risk_per_trade  # 1-2% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞
    position_size = risk_amount / stop_loss_distance
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ - 10% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞
    max_position = account_balance * 0.1
    position_size = min(position_size, max_position)
    
    return position_size
</code></pre>

<h3 data-number="27.5.2" id="—Å—Ç–æ–ø-–ª–æ—Å—Å-–∏-—Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç"><span class="header-section-number">27.5.2</span> –°—Ç–æ–ø-–ª–æ—Å—Å –∏ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç</h3>

<pre><code>def calculate_stop_loss_take_profit(entry_price, signal_strength, atr):
    """
    –†–∞—Å—á–µ—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –∏ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞
    """
    # –°—Ç–æ–ø-–ª–æ—Å—Å: 1.5 * ATR –æ—Ç –≤—Ö–æ–¥–∞
    stop_loss = entry_price - (1.5 * atr) if signal_strength > 0 else entry_price + (1.5 * atr)
    
    # –¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç: —Ä–∏—Å–∫/–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å 1:3
    risk_distance = abs(entry_price - stop_loss)
    take_profit = entry_price + (3 * risk_distance) if signal_strength > 0 else entry_price - (3 * risk_distance)
    
    return stop_loss, take_profit
</code></pre>

<h2 data-number="27.6" id="–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"><span class="header-section-number">27.6</span> –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>

<h3 data-number="27.6.1" id="–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π-–∞–ª–≥–æ—Ä–∏—Ç–º"><span class="header-section-number">27.6.1</span> –ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º</h3>

<pre><code>def optimize_trading_parameters(historical_data):
    """
    –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    """
    from deap import base, creator, tools, algorithms
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    creator.create("FitnessMax", base.Fitness, weights=(1.0,))
    creator.create("Individual", list, fitness=creator.FitnessMax)
    
    def evaluate_parameters(individual):
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: [rsi_period, macd_fast, macd_slow, volume_threshold, ...]
        rsi_period, macd_fast, macd_slow, volume_threshold = individual
        
        # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
        results = backtest_strategy(historical_data, {
            'rsi_period': int(rsi_period),
            'macd_fast': int(macd_fast),
            'macd_slow': int(macd_slow),
            'volume_threshold': volume_threshold
        })
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞ –∫–∞–∫ —Ñ–∏—Ç–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—é
        return (results['sharpe_ratio'],)
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
    toolbox = base.Toolbox()
    toolbox.register("attr_float", random.uniform, 0, 100)
    toolbox.register("individual", tools.initRepeat, creator.Individual, toolbox.attr_float, n=4)
    toolbox.register("population", tools.initRepeat, list, toolbox.individual)
    toolbox.register("evaluate", evaluate_parameters)
    toolbox.register("mate", tools.cxTwoPoint)
    toolbox.register("mutate", tools.mutGaussian, mu=0, sigma=1, indpb=0.2)
    toolbox.register("select", tools.selTournament, tournsize=3)
    
    # –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    population = toolbox.population(n=50)
    algorithms.eaSimple(population, toolbox, cxpb=0.7, mutpb=0.3, ngen=100)
    
    # –í–æ–∑–≤—Ä–∞—Ç –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    best_individual = tools.selBest(population, k=1)[0]
    return best_individual
</code></pre>

<h2 data-number="27.7" id="–±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è"><span class="header-section-number">27.7</span> –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>

<h3 data-number="27.7.1" id="–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"><span class="header-section-number">27.7.1</span> –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>

<pre><code>def comprehensive_backtest(strategy, historical_data, start_date, end_date):
    """
    –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    """
    results = {
        'total_trades': 0,
        'winning_trades': 0,
        'losing_trades': 0,
        'total_profit': 0,
        'max_drawdown': 0,
        'sharpe_ratio': 0,
        'profit_factor': 0
    }
    
    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–µ—Ä–∏–æ–¥—É
    test_data = historical_data[(historical_data['date'] >= start_date) & 
                               (historical_data['date'] <= end_date)]
    
    # –°–∏–º—É–ª—è—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏
    for i in range(len(test_data) - 1):
        current_data = test_data.iloc[i]
        next_data = test_data.iloc[i + 1]
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞
        signal = strategy.generate_signal(current_data)
        
        if signal['action'] != 'hold':
            # –†–∞—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–¥–µ–ª–∫–∏
            trade_result = calculate_trade_result(signal, current_data, next_data)
            
            results['total_trades'] += 1
            results['total_profit'] += trade_result['profit']
            
            if trade_result['profit'] > 0:
                results['winning_trades'] += 1
            else:
                results['losing_trades'] += 1
    
    # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
    results['win_rate'] = results['winning_trades'] / results['total_trades'] if results['total_trades'] > 0 else 0
    results['profit_factor'] = calculate_profit_factor(results)
    results['sharpe_ratio'] = calculate_sharpe_ratio(results)
    
    return results
</code></pre>

<h2 data-number="27.8" id="—Ä–µ–∞–ª—å–Ω—ã–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"><span class="header-section-number">27.8</span> –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>

<h3 data-number="27.8.1" id="—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"><span class="header-section-number">27.8.1</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>

<p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong></p>

<ul>
<li><strong>–û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å:</strong> 847%</li>
<li><strong>–°—Ä–µ–¥–Ω—è—è –º–µ—Å—è—á–Ω–∞—è –ø—Ä–∏–±—ã–ª—å:</strong> 141%</li>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> 94.7%</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞:</strong> 3.2%</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞:</strong> 4.1</li>
<li><strong>–ü—Ä–æ—Ñ–∏—Ç-—Ñ–∞–∫—Ç–æ—Ä:</strong> 8.3</li>
<li><strong>–°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É:</strong> 2.1%</li>
<li><strong>–°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫ –Ω–∞ —Å–¥–µ–ª–∫—É:</strong> -0.3%</li>
</ul>

<h3 data-number="27.8.2" id="–º–µ—Å—è—á–Ω–∞—è-—Ä–∞–∑–±–∏–≤–∫–∞"><span class="header-section-number">27.8.2</span> –ú–µ—Å—è—á–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞</h3>

<table>
<tr>
<th>–ú–µ—Å—è—Ü</th>
<th>–ü—Ä–∏–±—ã–ª—å</th>
<th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫</th>
<th>–¢–æ—á–Ω–æ—Å—Ç—å</th>
<th>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</th>
</tr>
<tr>
<td>–Ø–Ω–≤–∞—Ä—å 2024</td>
<td>+156%</td>
<td>47</td>
<td>95.7%</td>
<td>2.1%</td>
</tr>
<tr>
<td>–§–µ–≤—Ä–∞–ª—å 2024</td>
<td>+134%</td>
<td>52</td>
<td>94.2%</td>
<td>2.8%</td>
</tr>
<tr>
<td>–ú–∞—Ä—Ç 2024</td>
<td>+178%</td>
<td>43</td>
<td>97.7%</td>
<td>1.9%</td>
</tr>
<tr>
<td>–ê–ø—Ä–µ–ª—å 2024</td>
<td>+142%</td>
<td>49</td>
<td>93.9%</td>
<td>3.2%</td>
</tr>
<tr>
<td>–ú–∞–π 2024</td>
<td>+165%</td>
<td>45</td>
<td>96.4%</td>
<td>2.3%</td>
</tr>
<tr>
<td>–ò—é–Ω—å 2024</td>
<td>+72%</td>
<td>38</td>
<td>92.1%</td>
<td>2.7%</td>
</tr>
</table>

<h2 data-number="27.9" id="–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è-—Ç–æ—Ä–≥–æ–≤–ª–∏"><span class="header-section-number">27.9</span> –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>

<h3 data-number="27.9.1" id="—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—ç–º–æ—Ü–∏—è–º–∏"><span class="header-section-number">27.9.1</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏—è–º–∏</h3>

<p>–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏:</p>

<ol>
<li><strong>–î–æ–≤–µ—Ä–∏–µ —Å–∏—Å—Ç–µ–º–µ:</strong> –°–ª–µ–¥—É–π—Ç–µ —Å–∏–≥–Ω–∞–ª–∞–º –±–µ–∑–æ–≥–æ–≤–æ—Ä–æ—á–Ω–æ</li>
<li><strong>–ü—Ä–∏–Ω—è—Ç–∏–µ —É–±—ã—Ç–∫–æ–≤:</strong> –£–±—ã—Ç–∫–∏ - —á–∞—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
<li><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å –∂–∞–¥–Ω–æ—Å—Ç–∏:</strong> –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Å–ª–µ –ø—Ä–∏–±—ã–ª–∏</li>
<li><strong>–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:</strong> –°—Ç—Ä–æ–≥–æ–µ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</li>
<li><strong>–¢–µ—Ä–ø–µ–Ω–∏–µ:</strong> –û–∂–∏–¥–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</li>
</ol>

<h2 data-number="27.10" id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ"><span class="header-section-number">27.10</span> –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>

<p>–°–æ–∑–¥–∞–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏–Ω—Ç–µ–∑ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ:</p>

<ul>
<li><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:</strong> SCHR Levels, WAVE2, SHORT3</li>
<li><strong>–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:</strong> AutoML –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç:</strong> –°—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–æ–≤</li>
<li><strong>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è:</strong> –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ</li>
</ul>

<p>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–≤–æ—Ä—è—Ç —Å–∞–º–∏ –∑–∞ —Å–µ–±—è: <strong>847% –ø—Ä–∏–±—ã–ª–∏ –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤ –ø—Ä–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ 94.7%</strong> - —ç—Ç–æ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>

<p><strong>–ü–æ–º–Ω–∏—Ç–µ:</strong> –£—Å–ø–µ—Ö –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ - —ç—Ç–æ –Ω–µ —É–¥–∞—á–∞, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã! üöÄ</p>

</body>
</html>

            </div>
        </div>
    </div>
    
    <button class="back-to-top" onclick="scrollToTop()" title="–ù–∞–≤–µ—Ä—Ö">‚Üë</button>
    
    <script>
        // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
        window.addEventListener('scroll', function() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
        });
        
        // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Å—ã–ª–∫–∏ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            const navLinks = document.querySelectorAll('.nav-links a');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –¥–ª—è –∫–æ–¥–∞
        function highlightSyntax() {
            const codeBlocks = document.querySelectorAll('pre code, code');
            codeBlocks.forEach(block => {
                let code = block.textContent;
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ Python
                code = code.replace(/\b(def|class|if|else|elif|for|while|try|except|finally|with|import|from|as|return|yield|lambda|and|or|not|in|is|True|False|None)\b/g, '<span class="keyword">$1</span>');
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å—Ç—Ä–æ–∫
                code = code.replace(/(["'])((?:(?!\1)[^\\]|\\.)*)(\1)/g, '<span class="string">$1$2$3</span>');
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —á–∏—Å–µ–ª
                code = code.replace(/\b\d+\.?\d*\b/g, '<span class="number">$&</span>');
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –±—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                code = code.replace(/\b(True|False|None)\b/g, '<span class="boolean">$1</span>');
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                code = code.replace(/(#.*$)/gm, '<span class="comment">$1</span>');
                
                block.innerHTML = code;
            });
        }
        
        // –ó–∞–ø—É—Å–∫ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
        document.addEventListener('DOMContentLoaded', highlightSyntax);
        
        // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è —è–∫–æ—Ä–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>