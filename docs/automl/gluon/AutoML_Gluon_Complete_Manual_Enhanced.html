<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: hidden;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            position: relative;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border-radius: 2px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        
        h4 {
            color: #34495e;
            margin-top: 20px;
            font-size: 1.1em;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è inline –∫–æ–¥–∞ */
        code {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞ */
        pre {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border-left: 4px solid #3776ab;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin: 20px 0;
            position: relative;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        pre::before {
            content: "Code";
            position: absolute;
            top: 10px;
            right: 15px;
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è Python –∫–æ–¥–∞ */
        pre[class*="python"] {
            background: #1e1e1e;
        }
        
        pre[class*="python"]::before {
            content: "Python";
            background: #3776ab;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è bash –∫–æ–¥–∞ */
        pre[class*="bash"] {
            background: #2d3748;
        }
        
        pre[class*="bash"]::before {
            content: "Terminal";
            background: #8e44ad;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è YAML –∫–æ–¥–∞ */
        pre[class*="yaml"] {
            background: #1a202c;
        }
        
        pre[class*="yaml"]::before {
            content: "YAML";
            background: #27ae60;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è JSON –∫–æ–¥–∞ */
        pre[class*="json"] {
            background: #2d3748;
        }
        
        pre[class*="json"]::before {
            content: "JSON";
            background: #f39c12;
            color: white;
        }
        
        /* –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ü–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ Python —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ */
        .token.comment {
            color: #6a9955;
            font-style: italic;
        }
        
        .token.keyword {
            color: #569cd6;
            font-weight: bold;
        }
        
        .token.string {
            color: #ce9178;
        }
        
        .token.number {
            color: #b5cea8;
        }
        
        .token.function {
            color: #dcdcaa;
        }
        
        .token.class-name {
            color: #4ec9b0;
        }
        
        .token.operator {
            color: #d4d4d4;
        }
        
        .token.punctuation {
            color: #d4d4d4;
        }
        
        .token.variable {
            color: #9cdcfe;
        }
        
        .token.constant {
            color: #4fc1ff;
        }
        
        .token.builtin {
            color: #dcdcaa;
        }
        
        .token.boolean {
            color: #569cd6;
        }
        
        .token.null {
            color: #569cd6;
        }
        
        .token.parameter {
            color: #9cdcfe;
        }
        
        .token.property {
            color: #9cdcfe;
        }
        
        .token.attribute {
            color: #9cdcfe;
        }
        
        .token.tag {
            color: #569cd6;
        }
        
        .token.attr-name {
            color: #92c5f8;
        }
        
        .token.attr-value {
            color: #ce9178;
        }
        
        blockquote {
            border-left: 4px solid #3498db;
            margin: 20px 0;
            padding: 15px 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .toc {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        
        .toc h2 {
            margin-top: 0;
            border: none;
            padding: 0;
            color: #2c3e50;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin-bottom: 10px;
        }
        
        .toc a {
            text-decoration: none;
            color: #3498db;
            font-weight: 500;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .toc a:hover {
            background: #3498db;
            color: white;
            text-decoration: none;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ —Å–æ–≤–µ—Ç–æ–≤ */
        .highlight {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.2);
        }
        
        .warning {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
        }
        
        .success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 1px solid #e0e0e0;
            transition: transform 0.3s ease;
        }
        
        img:hover {
            transform: scale(1.02);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            overflow-x: auto;
            display: block;
            white-space: nowrap;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        table th, table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        
        table th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: 600;
            color: #495057;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            img {
                max-width: 100%;
                height: auto;
                margin: 15px auto;
            }
            
            pre {
                overflow-x: auto;
                font-size: 13px;
                padding: 15px;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
        }
        
        .nav-links a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .nav-links a:hover {
            background: #3498db;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–º–æ–¥–∑–∏ */
        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ */
        .param-description {
            background: #f8f9fa;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .param-name {
            font-weight: bold;
            color: #2c3e50;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AutoML Gluon - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</h1>
        <p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br>
        <strong>–î–∞—Ç–∞:</strong> 2025<br>
        <strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br>
        <strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
        
        <div class="toc">
            <h2>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</h2>
            <ul>
                <li><a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-automl-gluon">1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon</a></li>
                <li><a href="#–±–∞–∑–æ–≤–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ">2. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</a></li>
                <li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è">3. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</a></li>
                <li><a href="#–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞-–∫–∞—á–µ—Å—Ç–≤–∞">4. –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</a></li>
                <li><a href="#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–º–æ–¥–µ–ª–µ–π">5. –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</a></li>
                <li><a href="#–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∏-–¥–µ–ø–ª–æ–π">6. –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</a></li>
                <li><a href="#–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–µ–π">7. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</a></li>
                <li><a href="#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏">8. –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</a></li>
                <li><a href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è">9. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
                <li><a href="#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º">10. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</a></li>
                <li><a href="#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–¥–ª—è-apple-silicon">11. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon</a></li>
                <li><a href="#–ø—Ä–æ—Å—Ç–æ–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞">12. –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
                <li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π-–ø—Ä–∏–º–µ—Ä-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞">13. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</a></li>
                <li><a href="#—Ç–µ–æ—Ä–∏—è-–∏-–æ—Å–Ω–æ–≤—ã-automl">14. –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</a></li>
                <li><a href="#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å-–º–æ–¥–µ–ª–µ–π">15. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π</a></li>
                <li><a href="#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã">16. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</a></li>
                <li><a href="#—ç—Ç–∏–∫–∞-–∏-–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π-ai">17. –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</a></li>
                <li><a href="#–∫–µ–π—Å-—Å—Ç–∞–¥–∏">18. –ö–µ–π—Å-—Å—Ç–∞–¥–∏</a></li>
                <li><a href="#wave2-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä">19. WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</a></li>
                <li><a href="#schr-levels-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä">20. SCHR Levels –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</a></li>
                <li><a href="#schr-short3-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä">21. SCHR SHORT3 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</a></li>
                <li><a href="#—Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞">22. –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</a></li>
                <li><a href="#—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–∏–∑—É—á–µ–Ω–∏—é">23. –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é</a></li>
                <li><a href="#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π">24. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</a></li>
                <li><a href="#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–æ–≥–æ-–±–æ—Ç–∞">25. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞</a></li>
            </ul>
        </div>
        
        <hr />
<h1 id="automl-gluon">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0</p>
<h2 id="_1">–ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 70% –ø—Ä–æ–±–ª–µ–º —Å AutoML Gluon —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –æ—à–∏–±–∫–∞–º –∏ –ø–æ—Ç–µ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏.</p>
<h3 id="_2">üö® –†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>
<p><strong>–°–ª—É—á–∞–π 1: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π NumPy</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –≤–µ—Ä—Å–∏–π</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="c1"># –û—à–∏–±–∫–∞: &quot;numpy.core.multiarray failed to import&quot;</span>
<span class="c1"># –†–µ–∑—É–ª—å—Ç–∞—Ç: AutoML Gluon –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è</span>
</code></pre></div>

<p><strong>–°–ª—É—á–∞–π 2: –ü—Ä–æ–±–ª–µ–º—ã —Å CUDA</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π CUDA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>  <span class="c1"># False</span>
<span class="c1"># –†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±—É—á–µ–Ω–∏–µ –≤ 100 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ</span>
</code></pre></div>

<p><strong>–°–ª—É—á–∞–π 3: –ù–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ RAM</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;large_dataset.csv&#39;</span><span class="p">)</span>  <span class="c1"># MemoryError</span>
<span class="c1"># –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ</span>
</code></pre></div>

<h3 id="_3">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ?</h3>
<ul>
<li><strong>–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</strong>: –†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤—ã–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏</li>
<li><em>–ü—Ä–∏–º–µ—Ä</em>: NumPy 1.19 vs 1.21 - —Ä–∞–∑–Ω—ã–µ API, –∫–æ–¥ –ª–æ–º–∞–µ—Ç—Å—è</li>
<li><em>–†–µ—à–µ–Ω–∏–µ</em>: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</li>
<li><strong>–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é</strong>: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–¥–ª–µ–Ω–Ω–æ –∏–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–æ–æ–±—â–µ</li>
<li><em>–ü—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ 1 —á–∞—Å –≤–º–µ—Å—Ç–æ 5 –º–∏–Ω—É—Ç</li>
<li><em>–ü—Ä–∏—á–∏–Ω–∞</em>: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
<li><strong>–û—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏</strong>: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã</li>
<li><em>–ü—Ä–∏–º–µ—Ä</em>: XGBoost –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</li>
<li><em>–†–µ—à–µ–Ω–∏–µ</em>: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</li>
<li><strong>–ü—Ä–æ–±–ª–µ–º—ã —Å GPU</strong>: CUDA –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ–±—É—á–µ–Ω–∏–µ –∏–¥–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ CPU</li>
<li><em>–ü—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ 10 —á–∞—Å–æ–≤ –≤–º–µ—Å—Ç–æ 1 —á–∞—Å–∞</li>
<li><em>–†–µ—à–µ–Ω–∏–µ</em>: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ CUDA –∏ cuDNN</li>
</ul>
<h3 id="_4">–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞?</h3>
<ul>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞</strong>: –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫</li>
<li><em>–†–µ–∑—É–ª—å—Ç–∞—Ç</em>: 99.9% –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ —Å–±–æ–µ–≤</li>
<li><em>–≠–∫–æ–Ω–æ–º–∏—è</em>: –ù–µ —Ç—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –æ—Ç–ª–∞–¥–∫—É</li>
<li><strong>–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</li>
<li><em>–†–µ–∑—É–ª—å—Ç–∞—Ç</em>: –û–±—É—á–µ–Ω–∏–µ –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ</li>
<li><em>–≠–∫–æ–Ω–æ–º–∏—è</em>: –ß–∞—Å—ã –≤–º–µ—Å—Ç–æ –¥–Ω–µ–π</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</strong>: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –∫–æ—Ä–æ–±–∫–∏</li>
<li><em>–†–µ–∑—É–ª—å—Ç–∞—Ç</em>: –°—Ä–∞–∑—É –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å ML-–ø—Ä–æ–µ–∫—Ç—ã</li>
<li><em>–≠–∫–æ–Ω–æ–º–∏—è</em>: –ù–µ –Ω—É–∂–Ω–æ –∏–∑—É—á–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É</li>
<li><strong>–õ–µ–≥–∫–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</strong>: –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π</li>
<li><em>–†–µ–∑—É–ª—å—Ç–∞—Ç</em>: –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</li>
<li><em>–≠–∫–æ–Ω–æ–º–∏—è</em>: –ù–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—Å–µ</li>
</ul>
<h2 id="_5">–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>
<p><img alt="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon" src="images/installation_flowchart.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 1: –ë–ª–æ–∫-—Å—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ AutoML Gluon</em></p>
<h3 id="_6">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤–∞–∂–Ω—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, —Å–º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã –≤–æ–æ–±—â–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å AutoML Gluon:</p>
<ul>
<li><strong>Python</strong>: 3.7, 3.8, 3.9, 3.10, 3.11</li>
<li><em>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –≤–µ—Ä—Å–∏–∏?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Python</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å Python 3.6?</em> –û—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å Python 3.12?</em> –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—â–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç</li>
<li><em>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</em>: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Python 3.9 –∏–ª–∏ 3.10 –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–û–°</strong>: Linux, macOS, Windows</li>
<li><em>–ü–æ—á–µ–º—É –≤—Å–µ –û–° –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ ML-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–¥–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö</li>
<li><em>Linux</em>: –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</li>
<li><em>macOS</em>: –£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ö–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
<li><em>Windows</em>: –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏</li>
<li><strong>RAM</strong>: 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB+)</li>
<li><em>–ü–æ—á–µ–º—É –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ ML-–º–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –ø–∞–º—è—Ç—å</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 2GB RAM?</em> –°–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–∞–µ—Ç, –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 16GB+ RAM?</em> –ú–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ 10 —Ä–∞–∑ –±–æ–ª—å—à–µ</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –î–∞—Ç–∞—Å–µ—Ç 1GB —Ç—Ä–µ–±—É–µ—Ç 4GB RAM –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</li>
<li><strong>CPU</strong>: 2 —è–¥—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4+ —è–¥—Ä–∞)</li>
<li><em>–ü–æ—á–µ–º—É –≤–∞–∂–Ω—ã —è–¥—Ä–∞?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 1 —è–¥—Ä–æ–º?</em> –û–±—É—á–µ–Ω–∏–µ –≤ 4 —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 8+ —è–¥—Ä–∞–º–∏?</em> –û–±—É—á–µ–Ω–∏–µ –≤ 4-8 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ 1 —á–∞—Å –Ω–∞ 2 —è–¥—Ä–∞—Ö = 15 –º–∏–Ω—É—Ç –Ω–∞ 8 —è–¥—Ä–∞—Ö</li>
<li><strong>–î–∏—Å–∫</strong>: 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞</li>
<li><em>–ü–æ—á–µ–º—É –Ω—É–∂–Ω–æ –º–µ—Å—Ç–æ?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª–∏ –∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞</li>
<li><em>–ß—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ?</em> –ú–æ–¥–µ–ª–∏ (500MB-2GB), –∫—ç—à (1-5GB), –¥–∞–Ω–Ω—ã–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞)</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –ü—Ä–æ–µ–∫—Ç —Å 10 –º–æ–¥–µ–ª—è–º–∏ –∑–∞–Ω–∏–º–∞–µ—Ç 5-10GB</li>
</ul>
<h3 id="_7">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–∞—é—Ç –ª—É—á—à–∏–π –æ–ø—ã—Ç?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</p>
<ul>
<li><strong>Python</strong>: 3.9 –∏–ª–∏ 3.10</li>
<li><em>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –≤–µ—Ä—Å–∏–∏?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã –∏ –±—ã—Å—Ç—Ä—ã</li>
<li><em>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</em>: –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ –Ω–∞ Python 3.10 –Ω–∞ 15% –±—ã—Å—Ç—Ä–µ–µ —á–µ–º –Ω–∞ 3.8</li>
<li><strong>RAM</strong>: 16GB+</li>
<li><em>–ü–æ—á–µ–º—É –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã —Ç—Ä–µ–±—É—é—Ç –º–Ω–æ–≥–æ RAM</li>
<li><em>–ß—Ç–æ –º–æ–∂–Ω–æ —Å 16GB?</em> –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–æ 10GB, –æ–±—É—á–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏</li>
<li><em>–ß—Ç–æ –º–æ–∂–Ω–æ —Å 32GB+?</em> –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–æ 50GB, –æ–±—É—á–∞—Ç—å –∞–Ω—Å–∞–º–±–ª–∏ –º–æ–¥–µ–ª–µ–π</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –î–∞—Ç–∞—Å–µ—Ç 5GB —Ç—Ä–µ–±—É–µ—Ç 20GB RAM –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã</li>
<li><strong>CPU</strong>: 8+ —è–¥–µ—Ä</li>
<li><em>–ü–æ—á–µ–º—É –º–Ω–æ–≥–æ —è–¥–µ—Ä?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —è–¥—Ä–∞</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 8 —è–¥—Ä–∞–º–∏?</em> –û–±—É—á–µ–Ω–∏–µ –≤ 4-8 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º —Å 2 —è–¥—Ä–∞–º–∏</li>
<li><em>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å 16+ —è–¥—Ä–∞–º–∏?</em> –û–±—É—á–µ–Ω–∏–µ –≤ 8-16 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ 1 —á–∞—Å –Ω–∞ 2 —è–¥—Ä–∞—Ö = 7 –º–∏–Ω—É—Ç –Ω–∞ 16 —è–¥—Ä–∞—Ö</li>
<li><strong>GPU</strong>: NVIDIA GPU —Å CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</li>
<li><em>–ü–æ—á–µ–º—É GPU –≤–∞–∂–µ–Ω?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –≤ 10-100 —Ä–∞–∑</li>
<li><em>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è GPU</em>: GTX 1060 6GB –∏–ª–∏ –ª—É—á—à–µ</li>
<li><em>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ GPU</em>: RTX 3070, RTX 4080, A100 –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –û–±—É—á–µ–Ω–∏–µ 10 —á–∞—Å–æ–≤ –Ω–∞ CPU = 1 —á–∞—Å –Ω–∞ RTX 3070</li>
<li><strong>–î–∏—Å–∫</strong>: 10GB+ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞</li>
<li><em>–ü–æ—á–µ–º—É –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞?</em> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª–∏ –∏ –∫—ç—à –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞</li>
<li><em>SSD vs HDD</em>: SSD –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
<li><em>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</em>: –ü—Ä–æ–µ–∫—Ç —Å 50 –º–æ–¥–µ–ª—è–º–∏ –∑–∞–Ω–∏–º–∞–µ—Ç 20-50GB</li>
</ul>
<h2 id="pip">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip</h2>
<p><strong>–ü–æ—á–µ–º—É pip - —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Å–ø–æ—Å–æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø—Ä–æ—Å—Ç–æ–π, –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ—à–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.</p>
<h2 id="uv">üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ uv (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</h2>
<p><strong>–ü–æ—á–µ–º—É uv –ª—É—á—à–µ pip?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ uv –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ, –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–µ–Ω –∏ –ª—É—á—à–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.</p>
<h3 id="uv_1">–ß—Ç–æ —Ç–∞–∫–æ–µ uv?</h3>
<p><strong>uv</strong> - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Rust. –û–Ω —Ä–µ—à–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã pip:</p>
<ul>
<li><strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong>: –í 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ pip</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –õ—É—á—à–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</li>
<li><strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</strong>: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤</li>
<li><strong>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</strong>: –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å pip</li>
</ul>
<h3 id="uv_2">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv —á–µ—Ä–µ–∑ pip (–µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å Python)</span>
pip<span class="w"> </span>install<span class="w"> </span>uv

<span class="c1"># –ò–ª–∏ —á–µ—Ä–µ–∑ curl (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</span>
curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh

<span class="c1"># –ò–ª–∏ —á–µ—Ä–µ–∑ homebrew –Ω–∞ macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>uv
</code></pre></div>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ uv?</strong><br />
- –°–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª uv (5-10MB)<br />
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π PATH<br />
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª<br />
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∫—ç—à –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤</p>
<h3 id="automl-gluon-uv">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoML Gluon —á–µ—Ä–µ–∑ uv</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</span>
uv<span class="w"> </span>add<span class="w"> </span>autogluon

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏</span>
uv<span class="w"> </span>add<span class="w"> </span>autogluon.tabular
uv<span class="w"> </span>add<span class="w"> </span>autogluon.timeseries
uv<span class="w"> </span>add<span class="w"> </span>autogluon.vision

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ</span>
uv<span class="w"> </span>venv
uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>autogluon
</code></pre></div>

<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ uv –Ω–∞–¥ pip:</strong><br />
- <strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong>: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ 10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ<br />
- <strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π<br />
- <strong>–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤<br />
- <strong>–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º</strong>: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</p>
<h3 id="_8">üöÄ –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –±–∞–∑–æ–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –¥–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:</p>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>autogluon
</code></pre></div>

<p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ?</strong><br />
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç AutoML Gluon<br />
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏<br />
- –°–æ–∑–¥–∞–µ—Ç—Å—è –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br />
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</p>
<p><strong>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ pip install autogluon</span>
<span class="c1"># 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (50-100MB)</span>
<span class="c1"># 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:</span>
<span class="c1">#    - numpy, pandas, scikit-learn</span>
<span class="c1">#    - xgboost, lightgbm, catboost</span>
<span class="c1">#    - torch, torchvision</span>
<span class="c1">#    - matplotlib, seaborn</span>
<span class="c1"># 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π</span>
<span class="c1"># 4. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</span>
<span class="c1"># 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</span>
</code></pre></div>

<p><strong>–í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:</strong><br />
- –ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç: 5-10 –º–∏–Ω—É—Ç<br />
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç: 30-60 –º–∏–Ω—É—Ç<br />
- –ü–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞: –î–æ–ª—å—à–µ –∏–∑-–∑–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏<br />
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: –ë—ã—Å—Ç—Ä–µ–µ</p>
<h3 id="_9">üéØ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:</p>
<h4 id="_10">üìä –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</h4>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>autogluon.tabular
</code></pre></div>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç autogluon.tabular?</strong><br />
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö<br />
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö<br />
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏<br />
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤</p>
<p><strong>–î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç autogluon.tabular</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –ê–ª–≥–æ—Ä–∏—Ç–º—ã:</span>
<span class="c1"># - XGBoost, LightGBM, CatBoost</span>
<span class="c1"># - Random Forest, Extra Trees</span>
<span class="c1"># - Neural Networks</span>
<span class="c1"># - Linear Models</span>
<span class="c1"># - Ensemble Methods</span>

<span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</span>
<span class="c1"># - Feature Engineering</span>
<span class="c1"># - Hyperparameter Tuning</span>
<span class="c1"># - Model Selection</span>
<span class="c1"># - Cross-Validation</span>
</code></pre></div>

<p><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong><br />
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è<br />
- –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (CSV, Excel, SQL)<br />
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ<br />
- –ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
<h4 id="_11">‚è∞ –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏</h4>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>autogluon.timeseries
</code></pre></div>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç autogluon.timeseries?</strong><br />
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤<br />
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏<br />
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤<br />
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
<p><strong>–î–µ—Ç–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç autogluon.timeseries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesPredictor</span>

<span class="c1"># –ê–ª–≥–æ—Ä–∏—Ç–º—ã:</span>
<span class="c1"># - ARIMA, SARIMA</span>
<span class="c1"># - Prophet, ETS</span>
<span class="c1"># - Deep Learning (LSTM, Transformer)</span>
<span class="c1"># - Ensemble Methods</span>

<span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</span>
<span class="c1"># - Seasonality Detection</span>
<span class="c1"># - Trend Analysis</span>
<span class="c1"># - Anomaly Detection</span>
<span class="c1"># - Multi-step Forecasting</span>
</code></pre></div>

<p><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong><br />
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂<br />
- –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤<br />
- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ<br />
- IoT –¥–∞–Ω–Ω—ã–µ</p>
<h4 id="_12">üñºÔ∏è –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h4>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>autogluon.vision
</code></pre></div>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç autogluon.vision?</strong><br />
- –ì–æ—Ç–æ–≤—ã–µ CNN –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã<br />
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö<br />
- –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏<br />
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU —É—Å–∫–æ—Ä–µ–Ω–∏—è</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º</span>
pip<span class="w"> </span>install<span class="w"> </span>autogluon.text
</code></pre></div>

<p><strong>–ß—Ç–æ –¥–∞–µ—Ç autogluon.text?</strong><br />
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ NLP –º–æ–¥–µ–ª–∏<br />
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è<br />
- –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏<br />
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span>
pip<span class="w"> </span>install<span class="w"> </span>autogluon<span class="o">[</span>all<span class="o">]</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –ø–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–¥–æ–±–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å—Ä–∞–∑—É, –Ω–æ —ç—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏.</p>
<h2 id="conda">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ conda</h2>
<h3 id="_13">–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å Python 3.9</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>autogluon<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
conda<span class="w"> </span>activate<span class="w"> </span>autogluon

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>autogluon
</code></pre></div>

<h3 id="gpu">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å GPU –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å CUDA</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>autogluon-gpu<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
conda<span class="w"> </span>activate<span class="w"> </span>autogluon-gpu

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA</span>
conda<span class="w"> </span>install<span class="w"> </span>pytorch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span>pytorch-cuda<span class="o">=</span><span class="m">11</span>.8<span class="w"> </span>-c<span class="w"> </span>pytorch<span class="w"> </span>-c<span class="w"> </span>nvidia

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span>
pip<span class="w"> </span>install<span class="w"> </span>autogluon
</code></pre></div>

<h2 id="_14">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞</h2>
<h3 id="_15">–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</h3>
<div class="codehilite"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/autogluon/autogluon.git
<span class="nb">cd</span><span class="w"> </span>autogluon
</code></pre></div>

<h3 id="_16">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span>
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.

<span class="c1"># –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è</span>
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>./tabular
</code></pre></div>

<h2 id="_17">–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h2>
<h3 id="_18">–ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AutoGluon version: </span><span class="si">{</span><span class="n">ag</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –¢–µ—Å—Ç –∏–º–ø–æ—Ä—Ç–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesPredictor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.vision</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImagePredictor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextPredictor</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All modules imported successfully!&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_19">–¢–µ—Å—Ç —Å –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∏–º–µ—Ä–æ–º</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># –¢–µ—Å—Ç –æ–±—É—á–µ–Ω–∏—è</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installation test passed!&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_20">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h2>
<h3 id="gpu_1">–î–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ CUDA toolkit (Ubuntu/Debian)</span>
wget<span class="w"> </span>https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin
sudo<span class="w"> </span>mv<span class="w"> </span>cuda-ubuntu2004.pin<span class="w"> </span>/etc/apt/preferences.d/cuda-repository-pin-600
wget<span class="w"> </span>https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda-repository-ubuntu2004-11-8-local_11.8.0-520.61.05-1_amd64.deb
sudo<span class="w"> </span>dpkg<span class="w"> </span>-i<span class="w"> </span>cuda-repository-ubuntu2004-11-8-local_11.8.0-520.61.05-1_amd64.deb
sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>/var/cuda-repository-ubuntu2004-11-8-local/7fa2af80.pub
sudo<span class="w"> </span>apt-get<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>cuda

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å CUDA</span>
pip<span class="w"> </span>install<span class="w"> </span>torch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span>--index-url<span class="w"> </span>https://download.pytorch.org/whl/cu118
</code></pre></div>

<h3 id="_21">–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span>
pip<span class="w"> </span>install<span class="w"> </span>dask<span class="o">[</span>complete<span class="o">]</span>
pip<span class="w"> </span>install<span class="w"> </span>ray<span class="o">[</span>default<span class="o">]</span>
pip<span class="w"> </span>install<span class="w"> </span>modin<span class="o">[</span>all<span class="o">]</span>
</code></pre></div>

<h3 id="_22">–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
pip<span class="w"> </span>install<span class="w"> </span>gluonts
pip<span class="w"> </span>install<span class="w"> </span>mxnet
pip<span class="w"> </span>install<span class="w"> </span>statsmodels
</code></pre></div>

<h2 id="_23">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h2>
<h3 id="_24">–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">MKL_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OPENBLAS_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>

<span class="c1"># –î–ª—è GPU</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span>

<span class="c1"># –î–ª—è –æ—Ç–ª–∞–¥–∫–∏</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AUTOGLUON_DEBUG</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>

<h3 id="_25">üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å AutoML Gluon –ø–æ–¥ –≤–∞—à–∏ —Ä–µ—Å—É—Ä—Å—ã –∏ –∑–∞–¥–∞—á–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞.</p>
<p>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª <code>~/.autogluon/config.yaml</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoGluon</span>
<span class="nt">default</span><span class="p">:</span>
<span class="w">  </span><span class="nt">time_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3600</span><span class="w">  </span><span class="c1"># 1 —á–∞—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span>
<span class="w">  </span><span class="nt">memory_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span><span class="w">  </span><span class="c1"># 8GB RAM</span>
<span class="w">  </span><span class="nt">num_cpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w">  </span><span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä</span>
<span class="w">  </span><span class="nt">num_gpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">  </span><span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á</span>
</code></pre></div>

<h4 id="_26">üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h4>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä <code>time_limit</code>:</strong><br />
- <strong>–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç</strong>: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö<br />
- <strong>–ó–∞—á–µ–º –Ω—É–∂–µ–Ω</strong>: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã<br />
- <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>:<br />
  - <code>3600</code> (1 —á–∞—Å) - –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤<br />
  - <code>7200</code> (2 —á–∞—Å–∞) - –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –∑–∞–¥–∞—á<br />
  - <code>14400</code> (4 —á–∞—Å–∞) - –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á<br />
- <strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏</strong>: –û–±—É—á–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å<br />
- <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</strong>: –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å 2 —á–∞—Å–∞ –Ω–∞ –∑–∞–¥–∞—á—É, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ <code>time_limit: 7200</code></p>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä <code>memory_limit</code>:</strong><br />
- <strong>–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç</strong>: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM –≤ –≥–∏–≥–∞–±–∞–π—Ç–∞—Ö<br />
- <strong>–ó–∞—á–µ–º –Ω—É–∂–µ–Ω</strong>: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã<br />
- <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>:<br />
  - <code>4</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 8GB RAM<br />
  - <code>8</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 16GB RAM<br />
  - <code>16</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 32GB RAM<br />
- <strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏</strong>: –û–±—É—á–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π –ø–∞–º—è—Ç–∏<br />
- <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</strong>: –ï—Å–ª–∏ —É –≤–∞—Å 16GB RAM, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ <code>memory_limit: 12</code> (–æ—Å—Ç–∞–≤–ª—è—è 4GB –¥–ª—è —Å–∏—Å—Ç–µ–º—ã)</p>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä <code>num_cpus</code>:</strong><br />
- <strong>–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç</strong>: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π<br />
- <strong>–ó–∞—á–µ–º –Ω—É–∂–µ–Ω</strong>: –£—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —è–¥—Ä–∞<br />
- <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>:<br />
  - <code>2</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 4 —è–¥—Ä–∞–º–∏<br />
  - <code>4</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 8 —è–¥—Ä–∞–º–∏<br />
  - <code>8</code> - –¥–ª—è —Å–∏—Å—Ç–µ–º —Å 16+ —è–¥—Ä–∞–º–∏<br />
- <strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏</strong>: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä<br />
- <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</strong>: –ï—Å–ª–∏ —É –≤–∞—Å 8 —è–¥–µ—Ä, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ <code>num_cpus: 6</code> (–æ—Å—Ç–∞–≤–ª—è—è 2 –¥–ª—è —Å–∏—Å—Ç–µ–º—ã)</p>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä <code>num_gpus</code>:</strong><br />
- <strong>–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç</strong>: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è<br />
- <strong>–ó–∞—á–µ–º –Ω—É–∂–µ–Ω</strong>: –£—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ 10-100 —Ä–∞–∑<br />
- <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>:<br />
  - <code>0</code> - –µ—Å–ª–∏ –Ω–µ—Ç GPU –∏–ª–∏ –¥–ª—è CPU-only –∑–∞–¥–∞—á<br />
  - <code>1</code> - –¥–ª—è –æ–¥–Ω–æ–π GPU<br />
  - <code>2+</code> - –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö GPU (—Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)<br />
- <strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏</strong>: AutoML Gluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ GPU<br />
- <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</strong>: –ï—Å–ª–∏ —É –≤–∞—Å RTX 3070, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ <code>num_gpus: 1</code><br />
tabular:<br />
  presets: ['best_quality', 'high_quality', 'good_quality', 'medium_quality', 'optimize_for_deployment']<br />
  hyperparameter_tune_kwargs:<br />
    num_trials: 10<br />
    scheduler: 'local'<br />
    searcher: 'auto'</p>
<p>timeseries:<br />
  prediction_length: 24<br />
  freq: 'H'<br />
  target_column: 'target'</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#### üéØ –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`presets`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ</span><span class="w"> </span><span class="n">–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–∞</span><span class="w"> </span><span class="n">–º–æ–¥–µ–ª–∏</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–£–ø—Ä–æ—â–∞–µ—Ç</span><span class="w"> </span><span class="n">–≤—ã–±–æ—Ä</span><span class="w"> </span><span class="n">–º–µ–∂–¥—É</span><span class="w"> </span><span class="n">—Å–∫–æ—Ä–æ—Å—Ç—å—é</span><span class="w"> </span><span class="n">–∏</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ–º</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–î–µ—Ç–∞–ª—å–Ω–æ–µ</span><span class="w"> </span><span class="n">–æ–ø–∏—Å–∞–Ω–∏–µ</span><span class="w"> </span><span class="n">–∫–∞–∂–¥–æ–≥–æ</span><span class="w"> </span><span class="n">preset</span><span class="o">**:</span>

<span class="w">  </span><span class="o">**</span><span class="n n-Quoted">`best_quality`</span><span class="o">:**</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–¥–µ–ª–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–º–æ–¥–µ–ª–∏</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–í—Ä–µ–º—è</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏—è</span><span class="o">**:</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">—á–∞—Å–æ–≤</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–í—Å–µ</span><span class="w"> </span><span class="n">–¥–æ—Å—Ç—É–ø–Ω—ã–µ</span><span class="w"> </span><span class="n">–∞–ª–≥–æ—Ä–∏—Ç–º—ã</span><span class="p">,</span><span class="w"> </span><span class="n">–∞–Ω—Å–∞–º–±–ª–∏</span><span class="p">,</span><span class="w"> </span><span class="n">—Ç—é–Ω–∏–Ω–≥</span><span class="w"> </span><span class="n">–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ö–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span><span class="p">,</span><span class="w"> </span><span class="n">–∫–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–∫—Ä–∏—Ç–∏—á–Ω–æ</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∑—É–ª—å—Ç–∞—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–õ—É—á—à–∞—è</span><span class="w"> </span><span class="n">—Ç–æ—á–Ω–æ—Å—Ç—å</span><span class="p">,</span><span class="w"> </span><span class="n">–Ω–æ</span><span class="w"> </span><span class="n">–¥–æ–ª–≥–æ–µ</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏–µ</span>

<span class="w">  </span><span class="o">**</span><span class="n n-Quoted">`high_quality`</span><span class="o">:**</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–¥–µ–ª–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–í—ã—Å–æ–∫–æ–µ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">—Å</span><span class="w"> </span><span class="n">—Ä–∞–∑—É–º–Ω—ã–º</span><span class="w"> </span><span class="n">–≤—Ä–µ–º–µ–Ω–µ–º</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–í—Ä–µ–º—è</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏—è</span><span class="o">**:</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="w"> </span><span class="n">—á–∞—Å–∞</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–û—Å–Ω–æ–≤–Ω—ã–µ</span><span class="w"> </span><span class="n">–∞–ª–≥–æ—Ä–∏—Ç–º—ã</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">–∞–Ω—Å–∞–º–±–ª–∏</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ö–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞</span><span class="w"> </span><span class="n">–∑–∞–¥–∞—á</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∑—É–ª—å—Ç–∞—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–•–æ—Ä–æ—à–∞—è</span><span class="w"> </span><span class="n">—Ç–æ—á–Ω–æ—Å—Ç—å</span><span class="w"> </span><span class="n">–∑–∞</span><span class="w"> </span><span class="n">—Ä–∞–∑—É–º–Ω–æ–µ</span><span class="w"> </span><span class="n">–≤—Ä–µ–º—è</span>

<span class="w">  </span><span class="o">**</span><span class="n n-Quoted">`good_quality`</span><span class="o">:**</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–¥–µ–ª–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–•–æ—Ä–æ—à–µ–µ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–∑–∞</span><span class="w"> </span><span class="n">–∫–æ—Ä–æ—Ç–∫–æ–µ</span><span class="w"> </span><span class="n">–≤—Ä–µ–º—è</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–í—Ä–µ–º—è</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏—è</span><span class="o">**:</span><span class="w"> </span><span class="mi">30</span><span class="o">-</span><span class="mi">60</span><span class="w"> </span><span class="n">–º–∏–Ω—É—Ç</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–û—Å–Ω–æ–≤–Ω—ã–µ</span><span class="w"> </span><span class="n">–∞–ª–≥–æ—Ä–∏—Ç–º—ã</span><span class="w"> </span><span class="n">–±–µ–∑</span><span class="w"> </span><span class="n">–∞–Ω—Å–∞–º–±–ª–µ–π</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ö–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–±—ã—Å—Ç—Ä—ã—Ö</span><span class="w"> </span><span class="n">—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∑—É–ª—å—Ç–∞—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ü—Ä–∏–µ–º–ª–µ–º–∞—è</span><span class="w"> </span><span class="n">—Ç–æ—á–Ω–æ—Å—Ç—å</span><span class="w"> </span><span class="n">–±—ã—Å—Ç—Ä–æ</span>

<span class="w">  </span><span class="o">**</span><span class="n n-Quoted">`medium_quality`</span><span class="o">:**</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–¥–µ–ª–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–°—Ä–µ–¥–Ω–µ–µ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–∑–∞</span><span class="w"> </span><span class="n">–æ—á–µ–Ω—å</span><span class="w"> </span><span class="n">–∫–æ—Ä–æ—Ç–∫–æ–µ</span><span class="w"> </span><span class="n">–≤—Ä–µ–º—è</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–í—Ä–µ–º—è</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏—è</span><span class="o">**:</span><span class="w"> </span><span class="mi">10</span><span class="o">-</span><span class="mi">30</span><span class="w"> </span><span class="n">–º–∏–Ω—É—Ç</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–¢–æ–ª—å–∫–æ</span><span class="w"> </span><span class="n">–±—ã—Å—Ç—Ä—ã–µ</span><span class="w"> </span><span class="n">–∞–ª–≥–æ—Ä–∏—Ç–º—ã</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ö–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∑—É–ª—å—Ç–∞—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ë–∞–∑–æ–≤–∞—è</span><span class="w"> </span><span class="n">—Ç–æ—á–Ω–æ—Å—Ç—å</span><span class="w"> </span><span class="n">–æ—á–µ–Ω—å</span><span class="w"> </span><span class="n">–±—ã—Å—Ç—Ä–æ</span>

<span class="w">  </span><span class="o">**</span><span class="n n-Quoted">`optimize_for_deployment`</span><span class="o">:**</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–¥–µ–ª–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–í—Ä–µ–º—è</span><span class="w"> </span><span class="n">–æ–±—É—á–µ–Ω–∏—è</span><span class="o">**:</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="n">—á–∞—Å–∞</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ë—ã—Å—Ç—Ä—ã–µ</span><span class="w"> </span><span class="n">–∞–ª–≥–æ—Ä–∏—Ç–º—ã</span><span class="w"> </span><span class="n">—Å</span><span class="w"> </span><span class="n">–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ö–æ–≥–¥–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span><span class="w"> </span><span class="n">—Å</span><span class="w"> </span><span class="n">–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏</span><span class="w"> </span><span class="n">—Ä–µ—Å—É—Ä—Å–æ–≤</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∑—É–ª—å—Ç–∞—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ë—ã—Å—Ç—Ä—ã–µ</span><span class="w"> </span><span class="n">–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span><span class="p">,</span><span class="w"> </span><span class="n">—Ö–æ—Ä–æ—à–∞—è</span><span class="w"> </span><span class="n">—Ç–æ—á–Ω–æ—Å—Ç—å</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`num_trials`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–ø–æ–ø—ã—Ç–æ–∫</span><span class="w"> </span><span class="n">—Ç—é–Ω–∏–Ω–≥–∞</span><span class="w"> </span><span class="n">–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–ë–æ–ª—å—à–µ</span><span class="w"> </span><span class="n">–ø–æ–ø—ã—Ç–æ–∫</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">–ª—É—á—à–µ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–æ</span><span class="p">,</span><span class="w"> </span><span class="n">–Ω–æ</span><span class="w"> </span><span class="n">–¥–æ–ª—å—à–µ</span><span class="w"> </span><span class="n">–≤—Ä–µ–º—è</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</span><span class="w"> </span><span class="n">–∑–Ω–∞—á–µ–Ω–∏—è</span><span class="o">**:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`5`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–±—ã—Å—Ç—Ä—ã—Ö</span><span class="w"> </span><span class="n">—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`10`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö</span><span class="w"> </span><span class="n">–∑–∞–¥–∞—á</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`20`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–≤–∞–∂–Ω—ã—Ö</span><span class="w"> </span><span class="n">–∑–∞–¥–∞—á</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`50+`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ</span><span class="w"> </span><span class="n">–∫–∞—á–µ—Å—Ç–≤–∞</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</span><span class="w"> </span><span class="n">–ø—Ä–∏–º–µ—Ä</span><span class="o">**:</span><span class="w"> </span><span class="n">–ï—Å–ª–∏</span><span class="w"> </span><span class="n">—É</span><span class="w"> </span><span class="n">–≤–∞—Å</span><span class="w"> </span><span class="n">–µ—Å—Ç—å</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">—á–∞—Å–∞</span><span class="p">,</span><span class="w"> </span><span class="n">—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ</span><span class="w"> </span><span class="n n-Quoted">`num_trials: 10`</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`scheduler`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span><span class="w"> </span><span class="n">–∑–∞–¥–∞—á</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–£–ø—Ä–∞–≤–ª—è–µ—Ç</span><span class="w"> </span><span class="n">–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º</span><span class="w"> </span><span class="n">–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–î–æ—Å—Ç—É–ø–Ω—ã–µ</span><span class="w"> </span><span class="n">–∑–Ω–∞—á–µ–Ω–∏—è</span><span class="o">**:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;local&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–ª–æ–∫–∞–ª—å–Ω–æ–µ</span><span class="w"> </span><span class="n">–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</span><span class="w"> </span><span class="p">(</span><span class="n">–ø–æ</span><span class="w"> </span><span class="n">—É–º–æ–ª—á–∞–Ω–∏—é</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;ray&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ</span><span class="w"> </span><span class="n">–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</span><span class="w"> </span><span class="n">—á–µ—Ä–µ–∑</span><span class="w"> </span><span class="n">Ray</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;dask&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ</span><span class="w"> </span><span class="n">–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</span><span class="w"> </span><span class="n">—á–µ—Ä–µ–∑</span><span class="w"> </span><span class="n">Dask</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</span><span class="w"> </span><span class="n">–ø—Ä–∏–º–µ—Ä</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–æ–¥–Ω–æ–≥–æ</span><span class="w"> </span><span class="n">–∫–æ–º–ø—å—é—Ç–µ—Ä–∞</span><span class="w"> </span><span class="n">–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ</span><span class="w"> </span><span class="n n-Quoted">`&#39;local&#39;`</span>

<span class="c1">#### ‚è∞ –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`prediction_length`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span><span class="w"> </span><span class="n">–±—É–¥—É—â–∏—Ö</span><span class="w"> </span><span class="n">—Ç–æ—á–µ–∫</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç</span><span class="w"> </span><span class="n">–≥–æ—Ä–∏–∑–æ–Ω—Ç</span><span class="w"> </span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</span><span class="w"> </span><span class="n">–∑–Ω–∞—á–µ–Ω–∏—è</span><span class="o">**:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`24`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–ø–æ—á–∞—Å–æ–≤—ã—Ö</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã—Ö</span><span class="w"> </span><span class="p">(</span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑</span><span class="w"> </span><span class="n">–Ω–∞</span><span class="w"> </span><span class="n">—Å—É—Ç–∫–∏</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`7`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–¥–Ω–µ–≤–Ω—ã—Ö</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã—Ö</span><span class="w"> </span><span class="p">(</span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑</span><span class="w"> </span><span class="n">–Ω–∞</span><span class="w"> </span><span class="n">–Ω–µ–¥–µ–ª—é</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`30`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–ª—è</span><span class="w"> </span><span class="n">–¥–Ω–µ–≤–Ω—ã—Ö</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã—Ö</span><span class="w"> </span><span class="p">(</span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑</span><span class="w"> </span><span class="n">–Ω–∞</span><span class="w"> </span><span class="n">–º–µ—Å—è—Ü</span><span class="p">)</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</span><span class="w"> </span><span class="n">–ø—Ä–∏–º–µ—Ä</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–ø—Ä–æ–≥–Ω–æ–∑–∞</span><span class="w"> </span><span class="n">–ø—Ä–æ–¥–∞–∂</span><span class="w"> </span><span class="n">–Ω–∞</span><span class="w"> </span><span class="n">–Ω–µ–¥–µ–ª—é</span><span class="w"> </span><span class="n">—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ</span><span class="w"> </span><span class="n n-Quoted">`prediction_length: 7`</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`freq`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ß–∞—Å—Ç–æ—Ç–∞</span><span class="w"> </span><span class="n">–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ</span><span class="w"> </span><span class="n">—Ä—è–¥–∞</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç</span><span class="w"> </span><span class="n">–∏–Ω—Ç–µ—Ä–≤–∞–ª</span><span class="w"> </span><span class="n">–º–µ–∂–¥—É</span><span class="w"> </span><span class="n">—Ç–æ—á–∫–∞–º–∏</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–î–æ—Å—Ç—É–ø–Ω—ã–µ</span><span class="w"> </span><span class="n">–∑–Ω–∞—á–µ–Ω–∏—è</span><span class="o">**:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;H&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–ø–æ—á–∞—Å–æ–≤—ã–µ</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã–µ</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;D&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–¥–Ω–µ–≤–Ω—ã–µ</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã–µ</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;W&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–Ω–µ–¥–µ–ª—å–Ω—ã–µ</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã–µ</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`&#39;M&#39;`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">–º–µ—Å—è—á–Ω—ã–µ</span><span class="w"> </span><span class="n">–¥–∞–Ω–Ω—ã–µ</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</span><span class="w"> </span><span class="n">–ø—Ä–∏–º–µ—Ä</span><span class="o">**:</span><span class="w"> </span><span class="n">–î–ª—è</span><span class="w"> </span><span class="n">–¥–Ω–µ–≤–Ω—ã—Ö</span><span class="w"> </span><span class="n">–ø—Ä–æ–¥–∞–∂</span><span class="w"> </span><span class="n">—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ</span><span class="w"> </span><span class="n n-Quoted">`freq: &#39;D&#39;`</span>

<span class="o">**</span><span class="n">–ü–∞—Ä–∞–º–µ—Ç—Ä</span><span class="w"> </span><span class="n n-Quoted">`target_column`</span><span class="o">:**</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ß—Ç–æ</span><span class="w"> </span><span class="n">–æ–∑–Ω–∞—á–∞–µ—Ç</span><span class="o">**:</span><span class="w"> </span><span class="n">–ù–∞–∑–≤–∞–Ω–∏–µ</span><span class="w"> </span><span class="n">—Å—Ç–æ–ª–±—Ü–∞</span><span class="w"> </span><span class="n">—Å</span><span class="w"> </span><span class="n">—Ü–µ–ª–µ–≤–æ–π</span><span class="w"> </span><span class="n">–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ó–∞—á–µ–º</span><span class="w"> </span><span class="n">–Ω—É–∂–µ–Ω</span><span class="o">**:</span><span class="w"> </span><span class="n">–£–∫–∞–∑—ã–≤–∞–µ—Ç</span><span class="p">,</span><span class="w"> </span><span class="n">—á—Ç–æ</span><span class="w"> </span><span class="n">–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</span><span class="w"> </span><span class="n">–ø—Ä–∏–º–µ—Ä</span><span class="o">**:</span><span class="w"> </span><span class="n">–ï—Å–ª–∏</span><span class="w"> </span><span class="n">—É</span><span class="w"> </span><span class="n">–≤–∞—Å</span><span class="w"> </span><span class="n">–µ—Å—Ç—å</span><span class="w"> </span><span class="n">—Å—Ç–æ–ª–±–µ—Ü</span><span class="w"> </span><span class="s1">&#39;sales&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ</span><span class="w"> </span><span class="n n-Quoted">`target_column: &#39;sales&#39;`</span>
</code></pre></div>

<h2 id="_27">–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ</h2>
<h3 id="_28">–ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ pip</span>
pip<span class="w"> </span>cache<span class="w"> </span>purge

<span class="c1"># –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫—ç—à–∞</span>
pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>autogluon

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏</span>
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">autogluon</span><span class="o">==</span><span class="m">0</span>.8.2
</code></pre></div>

<h3 id="cuda">–ü—Ä–æ–±–ª–µ–º—ã —Å CUDA</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ CUDA</span>
nvidia-smi

<span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ PyTorch</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import torch; print(torch.cuda.is_available())&quot;</span>

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ PyTorch</span>
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">torch</span><span class="o">==</span><span class="m">1</span>.13.1+cu117<span class="w"> </span><span class="nv">torchvision</span><span class="o">==</span><span class="m">0</span>.14.1+cu117<span class="w"> </span>--extra-index-url<span class="w"> </span>https://download.pytorch.org/whl/cu117
</code></pre></div>

<h3 id="_29">–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏</span>
pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>--no-deps<span class="w"> </span>autogluon
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div>

<h2 id="_30">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</h2>
<h3 id="_31">–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_installation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ AutoGluon&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;feature3&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">800</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">800</span><span class="p">:]</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="c1"># 1 –º–∏–Ω—É—Ç–∞</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model performance: </span><span class="si">{</span><span class="n">performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Installation test completed successfully!&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_installation</span><span class="p">()</span>
</code></pre></div>

<h2 id="_32">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./02_basic_usage.md">–ë–∞–∑–æ–≤–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</a><br />
- <a href="./03_advanced_configuration.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</a><br />
- <a href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a></p>
<h2 id="_33">–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>
<ul>
<li><a href="https://auto.gluon.ai/">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li>
<li><a href="https://github.com/autogluon/autogluon">GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a></li>
<li><a href="https://github.com/autogluon/autogluon/tree/master/examples">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></li>
<li><a href="https://discuss.autogluon.ai/">–§–æ—Ä—É–º —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</a></li>
</ul>
<hr />
<h1 id="automl-gluon_1">–ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_34">–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<p><strong>–ü–æ—á–µ–º—É 80% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞—á–∏–Ω–∞—é—Ç —Å –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç AutoML Gluon. –≠—Ç–æ –∫–∞–∫ –æ–±—É—á–µ–Ω–∏–µ –≤–æ–∂–¥–µ–Ω–∏—é - —Å–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∞–µ—Ç–µ –æ—Å–Ω–æ–≤—ã, –ø–æ—Ç–æ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–æ–∂–Ω—ã–º –º–∞–Ω–µ–≤—Ä–∞–º.</p>
<h3 id="_35">–ß—Ç–æ –¥–∞–µ—Ç –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ?</h3>
<ul>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</strong>: –û—Ç –¥–∞–Ω–Ω—ã—Ö –¥–æ –º–æ–¥–µ–ª–∏ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</li>
<li><strong>–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤</strong>: –ö–∞–∫ AutoML Gluon –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ó–Ω–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ</li>
<li><strong>–§—É–Ω–¥–∞–º–µ–Ω—Ç</strong>: –û—Å–Ω–æ–≤–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏–∫</li>
</ul>
<h3 id="_36">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –±–∞–∑–æ–≤–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è?</h3>
<ul>
<li><strong>–§—Ä—É—Å—Ç—Ä–∞—Ü–∏—è</strong>: –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–∞–∫</li>
<li><strong>–û—à–∏–±–∫–∏</strong>: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
<li><strong>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –¢—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—â–µ</li>
<li><strong>–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ</strong>: –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—É–≥–∏–≤–∞–µ—Ç –æ—Ç –∏–∑—É—á–µ–Ω–∏—è</li>
</ul>
<h2 id="tabularpredictor">–í–≤–µ–¥–µ–Ω–∏–µ –≤ TabularPredictor</h2>
<p><img alt="–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AutoML Gluon" src="images/architecture_diagram.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AutoML Gluon —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏</em></p>
<p><strong>–ü–æ—á–µ–º—É TabularPredictor - —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ AutoML Gluon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ. –≠—Ç–æ –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø—É–ª—å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.</p>
<p><code>TabularPredictor</code> - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ AutoGluon. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–µ–≥—Ä–µ—Å—Å–∏—è) –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã.</p>
<h3 id="tabularpredictor_1">–ü–æ—á–µ–º—É TabularPredictor —Ç–∞–∫ –≤–∞–∂–µ–Ω?</h3>
<ul>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</strong>: –ù–µ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤—Ä—É—á–Ω—É—é</li>
<li><strong>–£–º–Ω–æ—Å—Ç—å</strong>: –°–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏</li>
<li><strong>–ì–∏–±–∫–æ—Å—Ç—å</strong>: –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞</strong>: –û–¥–∏–Ω –∫–ª–∞—Å—Å —Ä–µ—à–∞–µ—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏</li>
</ul>
<h3 id="_37">–ò–º–ø–æ—Ä—Ç –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –∏–º–ø–æ—Ä—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –ª—é–±–æ–≥–æ Python –ø—Ä–æ–µ–∫—Ç–∞. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç - —ç—Ç–æ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –∏–º–ø–æ—Ä—Ç—ã?</strong><br />
- <code>TabularPredictor</code> - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br />
- <code>pandas</code> - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ<br />
- <code>numpy</code> - –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</p>
<p><strong>–ü–æ—á–µ–º—É –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤—Å–µ —Å—Ä–∞–∑—É?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target_column&#39;</span><span class="p">,</span>  <span class="c1"># –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>    <span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>      <span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:</strong><br />
- <code>label='target_column'</code> - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (—á—Ç–æ –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º)<br />
- <code>problem_type='auto'</code> - AutoML Gluon —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç—Ç–æ –∏–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è<br />
- <code>eval_metric='auto'</code> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏</p>
<p><strong>–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º 'auto'?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ AutoML Gluon —É–º–Ω–µ–µ –Ω–∞—Å –≤ –≤—ã–±–æ—Ä–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.</p>
<h2 id="_38">–¢–∏–ø—ã –∑–∞–¥–∞—á</h2>
<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ç–∏–ø—ã –∑–∞–¥–∞—á?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –±–æ–ª–µ–∑–Ω–∏ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã - –º–µ—Ç–æ–¥—ã —Ä–∞–∑–Ω—ã–µ.</p>
<h3 id="_39">–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
<p><strong>–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è?</strong> –≠—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –∫–ª–∞—Å—Å–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–∞–º/–Ω–µ —Å–ø–∞–º, –±–æ–ª—å–Ω–æ–π/–∑–¥–æ—Ä–æ–≤—ã–π, –ø–æ–∫—É–ø–∞—Ç–µ–ª—å/–Ω–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å.</p>
<p><strong>–ü–æ—á–µ–º—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á - —ç—Ç–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:<br />
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞<br />
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞<br />
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã<br />
- –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;is_fraud&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—â–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞ - –¥–∞ –∏–ª–∏ –Ω–µ—Ç.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è —Å–ª–æ–∂–Ω–µ–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∏ –æ—à–∏–±–∫–∏ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏–µ.</p>
<h3 id="_40">–†–µ–≥—Ä–µ—Å—Å–∏—è</h3>
<p><strong>–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–≥—Ä–µ—Å—Å–∏—è?</strong> –≠—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–Ω–∞ –¥–æ–º–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂, –≤—Ä–µ–º—è –¥–æ —Å–æ–±—ã—Ç–∏—è.</p>
<p><strong>–ü–æ—á–µ–º—É —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–Ω–æ–≥–∏–µ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ - —ç—Ç–æ —á–∏—Å–ª–∞:<br />
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂<br />
- –û—Ü–µ–Ω–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏<br />
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏<br />
- –§–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –†–µ–≥—Ä–µ—Å—Å–∏—è</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_41">–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h2>
<h3 id="_42">–ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test.csv&#39;</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

<span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_43">–û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span>  <span class="c1"># 1 —á–∞—Å</span>
<span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">memory_limit</span><span class="o">=</span><span class="mi">8</span>  <span class="c1"># 8GB RAM</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_44">–û–±—É—á–µ–Ω–∏–µ —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –†–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞</span>
<span class="n">presets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>      <span class="c1"># –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–¥–æ–ª–≥–æ)</span>
    <span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>      <span class="c1"># –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span>
    <span class="s1">&#39;good_quality&#39;</span><span class="p">,</span>      <span class="c1"># –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span>
    <span class="s1">&#39;medium_quality&#39;</span><span class="p">,</span>    <span class="c1"># –°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ</span>
    <span class="s1">&#39;optimize_for_deployment&#39;</span>  <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</span>
<span class="p">]</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_45">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</h2>
<h3 id="_46">–ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model performance: </span><span class="si">{</span><span class="n">performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">,</span>
    <span class="n">detailed_report</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_47">–í–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">holdout_frac</span><span class="o">=</span><span class="mf">0.2</span>  <span class="c1"># 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="p">)</span>

<span class="c1"># K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># 5-fold CV</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_48">–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h2>
<h3 id="_49">–ë–∞–∑–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤/–∑–Ω–∞—á–µ–Ω–∏–π</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_50">–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏</span>
<span class="n">predictions_with_intervals</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">,</span>
    <span class="n">include_confidence</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</span>
<span class="n">individual_predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_multi</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="_51">–†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</h2>
<h3 id="_52">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:</span>
<span class="c1"># - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (one-hot encoding, label encoding)</span>
<span class="c1"># - –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)</span>
<span class="c1"># - –ß–∏—Å–ª–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)</span>
<span class="c1"># - –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (TF-IDF, embeddings)</span>
</code></pre></div>

<h3 id="_53">–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureGenerator</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">feature_generator</span> <span class="o">=</span> <span class="n">FeatureGenerator</span><span class="p">(</span>
    <span class="n">enable_nan_handling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_categorical_encoding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_text_special_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_text_ngram_features</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –¥–∞–Ω–Ω—ã–º</span>
<span class="n">train_data_processed</span> <span class="o">=</span> <span class="n">feature_generator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="n">test_data_processed</span> <span class="o">=</span> <span class="n">feature_generator</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="_54">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π</h2>
<h3 id="_55">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_model&#39;</span><span class="p">)</span>

<span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s1">&#39;my_model&#39;</span><span class="p">,</span>
    <span class="n">save_space</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞</span>
    <span class="n">save_info</span><span class="o">=</span><span class="kc">True</span>   <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_56">–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_model&#39;</span><span class="p">)</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="s1">&#39;my_model&#39;</span><span class="p">,</span>
    <span class="n">require_version_match</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_57">–†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</h2>
<h3 id="_58">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –∞–Ω—Å–∞–º–±–ª–µ–º</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>      <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>       <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –±—ç–≥–≥–∏–Ω–≥–∞</span>
    <span class="n">num_stack_levels</span><span class="o">=</span><span class="mi">1</span>    <span class="c1"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_59">–ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª—è—Ö –≤ –∞–Ω—Å–∞–º–±–ª–µ</span>
<span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">)</span>

<span class="c1"># –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
<span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">,</span>
    <span class="n">extra_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">silent</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_60">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
<h3 id="_61">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–ª–æ–≤–∞—Ä—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">63</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_62">–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
<span class="n">excluded_model_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;NN_TORCH&#39;</span><span class="p">]</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">excluded_model_types</span><span class="o">=</span><span class="n">excluded_model_types</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_63">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractModel</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomValidationStrategy</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_default_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">validation_strategy</span><span class="o">=</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span>
    <span class="n">custom_validation_strategy</span><span class="o">=</span><span class="n">CustomValidationStrategy</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_64">–†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö</h2>
<h3 id="_65">–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span>
<span class="c1"># –ù–æ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏—Ö —è–≤–Ω–æ</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;brand&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">]</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">categorical_columns</span><span class="o">=</span><span class="n">categorical_columns</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_66">–¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ AutoGluon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
<span class="n">text_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;review_text&#39;</span><span class="p">]</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">text_columns</span><span class="o">=</span><span class="n">text_columns</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_67">–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span>
<span class="n">time_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_columns</span><span class="o">=</span><span class="n">time_columns</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_68">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</h2>
<h3 id="_69">–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span>  <span class="c1"># –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="callback">Callback —Ñ—É–Ω–∫—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">training_callback</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_path</span><span class="p">,</span> <span class="n">model_info</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Callback —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model path: </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model info: </span><span class="si">{</span><span class="n">model_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">training_callback</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_70">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 id="_71">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
<span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality&#39;</span>
<span class="p">)</span>

<span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ê–Ω–∞–ª–∏–∑ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</span>
<span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">)</span>
</code></pre></div>

<h3 id="_72">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span>
<span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span>
<span class="p">)</span>

<span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">performance</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">performance</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feature_importance</span><span class="p">)</span>
</code></pre></div>

<h2 id="_73">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<h3 id="_74">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data shape:&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing values:&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data types:&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># –ò–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ</span>

<span class="c1"># 3. –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">constant_columns</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">train_data</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">constant_columns</span><span class="p">)</span>
</code></pre></div>

<h3 id="_75">–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">classification_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;balanced_accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_micro&#39;</span><span class="p">,</span>
    <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;precision_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;recall_macro&#39;</span><span class="p">,</span>
    <span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="s1">&#39;log_loss&#39;</span>
<span class="p">]</span>

<span class="c1"># –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span>
<span class="n">regression_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="s1">&#39;smape&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;pearsonr&#39;</span><span class="p">,</span> <span class="s1">&#39;spearmanr&#39;</span>
<span class="p">]</span>
</code></pre></div>

<h3 id="_76">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="c1"># 1 –º–∏–Ω—É—Ç–∞</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;optimize_for_deployment&#39;</span>
<span class="p">)</span>

<span class="c1"># –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>  <span class="c1"># 1 —á–∞—Å</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_77">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./03_advanced_configuration.md">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</a><br />
- <a href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a><br />
- <a href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a></p>
<hr />
<h1 id="automl-gluon_2">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_78">–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 90% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π AutoML Gluon –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, –∫–∞–∫—É—é –º–æ—â—å –æ–Ω–∏ —É–ø—É—Å–∫–∞—é—Ç. –≠—Ç–æ –∫–∞–∫ –≤–æ–¥–∏—Ç—å Ferrari –Ω–∞ –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–µ - –º–∞—à–∏–Ω–∞ –µ–¥–µ—Ç, –Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.</p>
<h3 id="_79">–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è?</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ 10-30% –ª—É—á—à–µ</li>
<li><strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong>: –û–±—É—á–µ–Ω–∏–µ —É—Å–∫–æ—Ä—è–µ—Ç—Å—è –≤ 2-5 —Ä–∞–∑</li>
<li><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å</strong>: –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</strong>: –ú–æ–¥–µ–ª—å –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</li>
</ul>
<h3 id="_80">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏?</h3>
<ul>
<li><strong>–°—Ä–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç "–∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—Å—è"</li>
<li><strong>–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</strong>: –¢—Ä–∞—Ç–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
<li><strong>–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</strong>: GPU –∏ CPU —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ</li>
<li><strong>–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ</strong>: –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –ø–æ—á–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ —É–ª—É—á—à–∞—é—Ç—Å—è</li>
</ul>
<h2 id="_81">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>
<p><strong>–ü–æ—á–µ–º—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã - —ç—Ç–æ –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º —É—á–∏—Ç—Å—è. –≠—Ç–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–π –∑–≤—É–∫.</p>
<h3 id="_82">–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö —Å–ª—É—á–∞–µ–≤, –∞ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Å–æ–±–µ–Ω–Ω—ã–º–∏.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># Gradient Boosting Machine - –æ–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
        <span class="p">{</span>
            <span class="c1"># –ë—ã—Å—Ç—Ä–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</span>
            <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>        <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ (–±–æ–ª—å—à–µ = —Ç–æ—á–Ω–µ–µ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ)</span>
            <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>               <span class="c1"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç—å–µ–≤ –≤ –¥–µ—Ä–µ–≤–µ</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>          <span class="c1"># –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–º–µ–Ω—å—à–µ = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)</span>
            <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>        <span class="c1"># –î–æ–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)</span>
            <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>        <span class="c1"># –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞</span>
            <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>              <span class="c1"># –ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è bagging</span>
            <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>         <span class="c1"># –ú–∏–Ω–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç–µ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)</span>
            <span class="s1">&#39;min_sum_hessian_in_leaf&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="c1"># –ú–∏–Ω–∏–º—É–º —Å—É–º–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤ –ª–∏—Å—Ç–µ</span>
            <span class="s1">&#39;lambda_l1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>              <span class="c1"># L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Lasso)</span>
            <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>              <span class="c1"># L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Ridge)</span>
            <span class="s1">&#39;min_gain_to_split&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>       <span class="c1"># –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>               <span class="c1"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ (-1 = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)</span>
            <span class="s1">&#39;save_binary&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>            <span class="c1"># –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã</span>
            <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                     <span class="c1"># –°–µ–º—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏</span>
            <span class="s1">&#39;feature_fraction_seed&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># –°–µ–º—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
            <span class="s1">&#39;bagging_seed&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>              <span class="c1"># –°–µ–º—è –¥–ª—è bagging</span>
            <span class="s1">&#39;drop_seed&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>                 <span class="c1"># –°–µ–º—è –¥–ª—è dropout</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>                  <span class="c1"># –£—Ä–æ–≤–µ–Ω—å –≤—ã–≤–æ–¥–∞ (-1 = —Ç–∏—Ö–æ)</span>
            <span class="s1">&#39;keep_training_booster&#39;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –º–æ–¥–µ–ª–∏</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># –¢—â–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
            <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>        <span class="c1"># –ë–æ–ª—å—à–µ –¥–µ—Ä–µ–≤—å–µ–≤ –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏</span>
            <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>               <span class="c1"># –ë–æ–ª—å—à–µ –ª–∏—Å—Ç—å–µ–≤ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>          <span class="c1"># –ú–µ–Ω—å—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span>
            <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>        <span class="c1"># –ú–µ–Ω—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
            <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>        <span class="c1"># –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è</span>
            <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>              <span class="c1"># –¢–∞ –∂–µ —á–∞—Å—Ç–æ—Ç–∞ bagging</span>
            <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>         <span class="c1"># –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç–µ –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏</span>
            <span class="s1">&#39;min_sum_hessian_in_leaf&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="c1"># –¢–æ—Ç –∂–µ –º–∏–Ω–∏–º—É–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span>
            <span class="s1">&#39;lambda_l1&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>              <span class="c1"># L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
            <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>              <span class="c1"># L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è</span>
            <span class="s1">&#39;min_gain_to_split&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>       <span class="c1"># –¢–æ—Ç –∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>               <span class="c1"># –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≥–ª—É–±–∏–Ω—ã</span>
            <span class="s1">&#39;save_binary&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>            <span class="c1"># –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã</span>
            <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                     <span class="c1"># –°–µ–º—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏</span>
            <span class="s1">&#39;feature_fraction_seed&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># –°–µ–º—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
            <span class="s1">&#39;bagging_seed&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>              <span class="c1"># –°–µ–º—è –¥–ª—è bagging</span>
            <span class="s1">&#39;drop_seed&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>                 <span class="c1"># –°–µ–º—è –¥–ª—è dropout</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>                  <span class="c1"># –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º</span>
            <span class="s1">&#39;keep_training_booster&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># CatBoost - –æ—Ç–ª–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="p">{</span>
            <span class="c1"># –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CatBoost</span>
            <span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>           <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π (–±–æ–ª—å—à–µ = —Ç–æ—á–Ω–µ–µ)</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>        <span class="c1"># –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</span>
            <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>                  <span class="c1"># –ì–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤ (–±–æ–ª—å—à–µ = —Å–ª–æ–∂–Ω–µ–µ)</span>
            <span class="s1">&#39;l2_leaf_reg&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>          <span class="c1"># L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ª–∏—Å—Ç—å–µ–≤</span>
            <span class="s1">&#39;bootstrap_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Bayesian&#39;</span><span class="p">,</span>
            <span class="s1">&#39;random_strength&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;bagging_temperature&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;od_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Iter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;od_wait&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s1">&#39;l2_leaf_reg&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
            <span class="s1">&#39;bootstrap_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Bayesian&#39;</span><span class="p">,</span>
            <span class="s1">&#39;random_strength&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;bagging_temperature&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;od_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Iter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;od_wait&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
            <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
            <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bootstrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;KNN&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span>
            <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
            <span class="s1">&#39;leaf_size&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
            <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;minkowski&#39;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">)</span>
</code></pre></div>

<h3 id="_83">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Space</span>

<span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞</span>
<span class="n">hyperparameter_space</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">127</span><span class="p">),</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="n">Space</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">hyperparameter_tune_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;num_trials&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s1">&#39;scheduler&#39;</span><span class="p">:</span> <span class="s1">&#39;local&#39;</span><span class="p">,</span>
        <span class="s1">&#39;searcher&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_84">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</h2>
<h3 id="_85">–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–µ–∫–∏–Ω–≥–∞</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>        <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –±—ç–≥–≥–∏–Ω–≥–∞</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>         <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –±—ç–≥–≥–∏–Ω–≥–∞</span>
    <span class="n">num_stack_levels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>     <span class="c1"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span>
    <span class="n">stack_ensemble_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># –ö–∞–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç–µ–∫–∏–Ω–≥–∞</span>
    <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>  <span class="c1"># –†–µ—Å—É—Ä—Å—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_86">–ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractModel</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomEnsembleModel</span><span class="p">(</span><span class="n">AbstractModel</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span>
        <span class="k">pass</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">custom_ensemble_model</span><span class="o">=</span><span class="n">CustomEnsembleModel</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_87">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h2>
<h3 id="cpu-gpu">CPU –∏ GPU –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</span>
<span class="n">ag_args_fit</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>          <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CPU —è–¥–µ—Ä</span>
    <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>          <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU</span>
    <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>     <span class="c1"># –õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ GB</span>
    <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span>      <span class="c1"># –õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">ag_args_fit</span><span class="o">=</span><span class="n">ag_args_fit</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_88">–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">scheduler</span>

<span class="c1"># –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span>
<span class="n">local_scheduler</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">LocalScheduler</span><span class="p">(</span>
    <span class="n">num_cpus</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">num_gpus</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">local_scheduler</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_89">–†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏</h2>
<h3 id="_90">–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–±—É—á–µ–Ω–∏–µ –ø–æ —á–∞—Å—Ç—è–º</span>
<span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">):</span>
    <span class="n">chunk</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span> <span class="n">refit_full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="_91">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">scheduler</span>

<span class="c1"># Ray –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
<span class="n">ray_scheduler</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">RayScheduler</span><span class="p">(</span>
    <span class="n">num_cpus</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">num_gpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ray_address</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>
<span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">ray_scheduler</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_92">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 id="_93">–ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesSplit</span>

<span class="c1"># –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
<span class="k">def</span><span class="w"> </span><span class="nf">time_series_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">tscv</span> <span class="o">=</span> <span class="n">TimeSeriesSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span> <span class="ow">in</span> <span class="n">tscv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">validation_strategy</span><span class="o">=</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span>
    <span class="n">custom_validation_strategy</span><span class="o">=</span><span class="n">time_series_split</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_94">–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="c1"># –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="k">def</span><span class="w"> </span><span class="nf">stratified_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span> <span class="ow">in</span> <span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">validation_strategy</span><span class="o">=</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span>
    <span class="n">custom_validation_strategy</span><span class="o">=</span><span class="n">stratified_split</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_95">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
<h3 id="_96">–ö–∞—Å—Ç–æ–º–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureGenerator</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomFeatureGenerator</span><span class="p">(</span><span class="n">FeatureGenerator</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_features</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;feature2&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">X</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</span>
<span class="n">feature_generator</span> <span class="o">=</span> <span class="n">CustomFeatureGenerator</span><span class="p">()</span>
<span class="n">train_data_processed</span> <span class="o">=</span> <span class="n">feature_generator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_97">–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞</span>
<span class="n">text_features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;enable_text_special_features&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;enable_text_ngram_features&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;text_ngram_range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="s1">&#39;text_max_features&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="s1">&#39;text_min_df&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;text_max_df&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">feature_generator_kwargs</span><span class="o">=</span><span class="n">text_features</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_98">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫</h2>
<h3 id="_99">–ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scorer</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">custom_metric</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞&quot;&quot;&quot;</span>
    <span class="c1"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫–∏</span>
    <span class="k">return</span> <span class="n">score</span>

<span class="n">custom_scorer</span> <span class="o">=</span> <span class="n">Scorer</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;custom_metric&#39;</span><span class="p">,</span>
    <span class="n">score_func</span><span class="o">=</span><span class="n">custom_metric</span><span class="p">,</span>
    <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="n">custom_scorer</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_100">–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_101">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
<h3 id="_102">–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;autogluon.log&#39;</span><span class="p">),</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
    <span class="n">log_to_file</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_103">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Callback –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>
<span class="k">def</span><span class="w"> </span><span class="nf">training_monitor</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">logs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">logs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">training_monitor</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_104">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 id="_105">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span>
<span class="n">production_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ag_args_fit&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>
    <span class="p">},</span>
    <span class="s1">&#39;hyperparameters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}],</span>
        <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}],</span>
        <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="o">**</span><span class="n">production_config</span><span class="p">)</span>
</code></pre></div>

<h3 id="_106">–°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s1">&#39;production_model&#39;</span><span class="p">,</span>
    <span class="n">save_space</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">compress</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_107">–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h2>
<h3 id="_108">–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./models&#39;</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span>
<span class="n">advanced_hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
            <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
            <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s1">&#39;bagging_freq&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;min_sum_hessian_in_leaf&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
            <span class="s1">&#39;lambda_l1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;lambda_l2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;min_gain_to_split&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;save_binary&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;feature_fraction_seed&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;bagging_seed&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;drop_seed&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;keep_training_booster&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s1">&#39;l2_leaf_reg&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
            <span class="s1">&#39;bootstrap_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Bayesian&#39;</span><span class="p">,</span>
            <span class="s1">&#39;random_strength&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;bagging_temperature&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;od_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Iter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;od_wait&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤</span>
<span class="n">ag_args_fit</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span>
<span class="p">}</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">hyperparameters</span><span class="o">=</span><span class="n">advanced_hyperparameters</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">num_stack_levels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ag_args_fit</span><span class="o">=</span><span class="n">ag_args_fit</span><span class="p">,</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
    <span class="n">holdout_frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_109">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./04_metrics.md">–†–∞–±–æ—Ç–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏</a><br />
- <a href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a><br />
- <a href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a></p>
<hr />
<h1 id="automl-gluon_3">–ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_110">–ü–æ—á–µ–º—É –º–µ—Ç—Ä–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã</h2>
<p><strong>–ü–æ—á–µ–º—É 80% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤–∞—à–∞ –º–æ–¥–µ–ª—å. –≠—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞–Ω–∞–ª–∏–∑—ã - –±–µ–∑ –Ω–∏—Ö –Ω–µ–ª—å–∑—è –ø–æ—Å—Ç–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ–∑.</p>
<h3 id="_111">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫?</h3>
<ul>
<li><strong>–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å –∫–∞–∂–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–æ—Ö–æ</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</strong>: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ø–ª–æ—Ö—É—é –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–æ —Ö–æ—Ä–æ—à–µ–π</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –≤—Ä–µ–º–µ–Ω–∏</strong>: –¢—Ä–∞—Ç–∏—Ç–µ –º–µ—Å—è—Ü—ã –Ω–∞ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-–ø—Ä–æ–≤–∞–ª—ã</strong>: –ú–æ–¥–µ–ª—å –Ω–µ —Ä–µ—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏</li>
</ul>
<h3 id="_112">–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫?</h3>
<ul>
<li><strong>–¢–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</strong>: –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏</li>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä</strong>: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–¥–∞—á–∏</li>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è</strong>: –ë—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∏—Ö</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—É—Å–ø–µ—Ö</strong>: –ú–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–∏–∑–Ω–µ—Å—É</li>
</ul>
<h2 id="_113">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–µ—Ç—Ä–∏–∫–∏</h2>
<p><img alt="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫" src="images/metrics_comparison.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</em></p>
<p><img alt="–î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫" src="images/metrics_detailed.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 3.1: –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ - ROC Curve, Precision-Recall, Confusion Matrix, Accuracy vs Threshold, F1 Score vs Threshold</em></p>
<p><strong>–ü–æ—á–µ–º—É –º–µ—Ç—Ä–∏–∫–∏ - —ç—Ç–æ —è–∑—ã–∫ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–µ—Ä–µ–≤–æ–¥—è—Ç —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ —á–∏—Å–ª–∞. –≠—Ç–æ –∫–∞–∫ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ –º–µ–∂–¥—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –∏ –±–∏–∑–Ω–µ—Å-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.</p>
<p>–ú–µ—Ç—Ä–∏–∫–∏ –≤ AutoML Gluon –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è:<br />
- <strong>–û—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π</strong>: –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å<br />
- <strong>–°—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</strong>: –í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–ª—è –∑–∞–¥–∞—á–∏<br />
- <strong>–í—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏</strong>: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏<br />
- <strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong>: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</p>
<h2 id="_114">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
<p><strong>–ü–æ—á–µ–º—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±—ã—Ö –º–µ—Ç—Ä–∏–∫?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∑–¥–µ—Å—å –≤–∞–∂–Ω—ã –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –Ω–æ –∏ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫. –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–ø—É—Å–∫–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—É—é —Ü–µ–Ω—É.</p>
<h3 id="_115">–ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 id="accuracy">Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å)</h4>
<p><strong>–ü–æ—á–µ–º—É Accuracy - —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.</p>
<p><strong>–ö–æ–≥–¥–∞ Accuracy –≤–≤–æ–¥–∏—Ç –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ?</strong><br />
- –ü—Ä–∏ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (99% –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞)<br />
- –ü—Ä–∏ —Ä–∞–∑–Ω–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫ (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)<br />
- –ü—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É Accuracy –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–º–∞–Ω—á–∏–≤–æ–π?</strong><br />
- –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å<br />
- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å<br />
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫</p>
<h4 id="precision">Precision (–¢–æ—á–Ω–æ—Å—Ç—å)</h4>
<p><strong>–ü–æ—á–µ–º—É Precision –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º –º–æ–¥–µ–ª–∏.</p>
<p><strong>–ö–æ–≥–¥–∞ Precision –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–µ–Ω?</strong><br />
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–ª–æ–∂–Ω—ã–µ –¥–∏–∞–≥–Ω–æ–∑—ã –æ–ø–∞—Å–Ω—ã)<br />
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ (–ª–æ–∂–Ω—ã–µ –æ–±–≤–∏–Ω–µ–Ω–∏—è –¥–æ—Ä–æ–≥–∏)<br />
- –°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä—ã (–≤–∞–∂–Ω—ã–µ –ø–∏—Å—å–º–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞–¥–∞—Ç—å –≤ —Å–ø–∞–º)</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_score</span>

<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">precision_macro</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>  <span class="c1"># –°—Ä–µ–¥–Ω–µ–µ –ø–æ –∫–ª–∞—Å—Å–∞–º</span>
<span class="n">precision_micro</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>  <span class="c1"># –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è?</strong><br />
- <strong>macro</strong>: –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –∏–º–µ–µ—Ç —Ä–∞–≤–Ω—ã–π –≤–µ—Å (—Ö–æ—Ä–æ—à–æ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)<br />
- <strong>micro</strong>: –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ (—Ö–æ—Ä–æ—à–æ –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)</p>
<h4 id="recall">Recall (–ü–æ–ª–Ω–æ—Ç–∞)</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–æ–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω—ã</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">recall_score</span>

<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">recall_macro</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="n">recall_micro</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</code></pre></div>

<h4 id="f1-score">F1-Score</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ precision –∏ recall</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">f1_score</span>

<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">f1_macro</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="n">f1_micro</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_116">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 id="roc-auc">ROC AUC</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC –∫—Ä–∏–≤–æ–π</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="c1"># –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROC AUC: </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –î–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">roc_auc_ovo</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;ovo&#39;</span><span class="p">)</span>
<span class="n">roc_auc_ovr</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;ovr&#39;</span><span class="p">)</span>
</code></pre></div>

<h4 id="pr-auc">PR AUC</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü–ª–æ—â–∞–¥—å –ø–æ–¥ Precision-Recall –∫—Ä–∏–≤–æ–π</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">average_precision_score</span>

<span class="n">pr_auc</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PR AUC: </span><span class="si">{</span><span class="n">pr_auc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="log-loss">Log Loss</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_loss</span>

<span class="n">log_loss_score</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Log Loss: </span><span class="si">{</span><span class="n">log_loss_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="balanced-accuracy">Balanced Accuracy</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">balanced_accuracy_score</span>

<span class="n">balanced_acc</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Balanced Accuracy: </span><span class="si">{</span><span class="n">balanced_acc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_117">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<h4 id="matthews-correlation-coefficient-mcc">Matthews Correlation Coefficient (MCC)</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">matthews_corrcoef</span>

<span class="n">mcc</span> <span class="o">=</span> <span class="n">matthews_corrcoef</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCC: </span><span class="si">{</span><span class="n">mcc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="cohens-kappa">Cohen's Kappa</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">cohen_kappa_score</span>

<span class="n">kappa</span> <span class="o">=</span> <span class="n">cohen_kappa_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cohen&#39;s Kappa: </span><span class="si">{</span><span class="n">kappa</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_118">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h2>
<h3 id="_119">–ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 id="mean-absolute-error-mae">Mean Absolute Error (MAE)</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="mean-squared-error-mse">Mean Squared Error (MSE)</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="root-mean-squared-error-rmse">Root Mean Squared Error (RMSE)</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="r2-score">R¬≤ Score</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R¬≤ Score: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_120">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<h4 id="mean-absolute-percentage-error-mape">Mean Absolute Percentage Error (MAPE)</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">mape_score</span> <span class="o">=</span> <span class="n">mape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="symmetric-mean-absolute-percentage-error-smape">Symmetric Mean Absolute Percentage Error (SMAPE)</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">smape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">smape_score</span> <span class="o">=</span> <span class="n">smape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SMAPE: </span><span class="si">{</span><span class="n">smape_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="mean-absolute-scaled-error-mase">Mean Absolute Scaled Error (MASE)</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mase</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
    <span class="c1"># –ù–∞–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ (—Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)</span>
    <span class="n">naive_forecast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">naive_mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_train</span> <span class="o">-</span> <span class="n">naive_forecast</span><span class="p">))</span>

    <span class="c1"># MAE –º–æ–¥–µ–ª–∏</span>
    <span class="n">model_mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">model_mae</span> <span class="o">/</span> <span class="n">naive_mae</span>

<span class="n">mase_score</span> <span class="o">=</span> <span class="n">mase</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MASE: </span><span class="si">{</span><span class="n">mase_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="autogluon">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ AutoGluon</h2>
<h3 id="_121">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>  <span class="c1"># –∏–ª–∏ &#39;f1&#39;, &#39;roc_auc&#39;, &#39;log_loss&#39;</span>
<span class="p">)</span>

<span class="c1"># –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span>  <span class="c1"># –∏–ª–∏ &#39;mae&#39;, &#39;r2&#39;</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_122">–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">performance</span><span class="p">)</span>
</code></pre></div>

<h3 id="_123">–ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scorer</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">custom_metric</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–∞—Å—Ç–æ–º–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞&quot;&quot;&quot;</span>
    <span class="c1"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞</span>
    <span class="k">return</span> <span class="n">score</span>

<span class="n">custom_scorer</span> <span class="o">=</span> <span class="n">Scorer</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;custom_metric&#39;</span><span class="p">,</span>
    <span class="n">score_func</span><span class="o">=</span><span class="n">custom_metric</span><span class="p">,</span>
    <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="n">custom_scorer</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_124">–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 id="_125">–õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞</span>
<span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">)</span>

<span class="c1"># –î–µ—Ç–∞–ª—å–Ω—ã–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥</span>
<span class="n">leaderboard_detailed</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span>
    <span class="n">test_data</span><span class="p">,</span>
    <span class="n">extra_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">silent</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="_126">–ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feature_importance</span><span class="p">)</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">feature_importance</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Feature Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="_127">–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># –û—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="_128">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h2>
<h3 id="_129">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Mean Absolute Scaled Error (MASE)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mase_time_series</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MASE –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span>
    <span class="c1"># –ù–∞–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</span>
    <span class="n">naive_forecast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="p">)</span>
    <span class="n">naive_mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_train</span> <span class="o">-</span> <span class="n">naive_forecast</span><span class="p">))</span>

    <span class="c1"># MAE –º–æ–¥–µ–ª–∏</span>
    <span class="n">model_mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">model_mae</span> <span class="o">/</span> <span class="n">naive_mae</span>

<span class="c1"># Symmetric Mean Absolute Percentage Error (SMAPE)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">smape_time_series</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;SMAPE –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">100</span>
</code></pre></div>

<h3 id="_130">–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Sharpe Ratio</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sharpe_ratio</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">risk_free_rate</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞&quot;&quot;&quot;</span>
    <span class="n">excess_returns</span> <span class="o">=</span> <span class="n">returns</span> <span class="o">-</span> <span class="n">risk_free_rate</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">excess_returns</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">excess_returns</span><span class="p">)</span>

<span class="c1"># Maximum Drawdown</span>
<span class="k">def</span><span class="w"> </span><span class="nf">max_drawdown</span><span class="p">(</span><span class="n">cumulative_returns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞&quot;&quot;&quot;</span>
    <span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">cumulative_returns</span><span class="p">)</span>
    <span class="n">drawdown</span> <span class="o">=</span> <span class="p">(</span><span class="n">cumulative_returns</span> <span class="o">-</span> <span class="n">peak</span><span class="p">)</span> <span class="o">/</span> <span class="n">peak</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">drawdown</span><span class="p">)</span>

<span class="c1"># Calmar Ratio</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calmar_ratio</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">max_dd</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ö–∞–ª–º–∞—Ä–∞&quot;&quot;&quot;</span>
    <span class="n">annual_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">252</span>
    <span class="k">return</span> <span class="n">annual_return</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">max_dd</span><span class="p">)</span>
</code></pre></div>

<h2 id="_131">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫</h2>
<h3 id="_132">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MetricsLogger</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s1">&#39;metrics.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">metrics_dict</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metrics_dict</span><span class="p">)</span>

        <span class="c1"># –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">metrics_dict</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_metrics_trend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –º–µ—Ç—Ä–∏–∫–∏&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">metric_name</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span> <span class="k">if</span> <span class="n">metric_name</span> <span class="ow">in</span> <span class="n">m</span><span class="p">]</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">metrics_logger</span> <span class="o">=</span> <span class="n">MetricsLogger</span><span class="p">()</span>

<span class="c1"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
    <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="mf">0.82</span><span class="p">,</span>
    <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span> <span class="mf">0.88</span>
<span class="p">}</span>
<span class="n">metrics_logger</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
</code></pre></div>

<h3 id="_133">–ê–ª–µ—Ä—Ç—ã –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MetricsAlert</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_name</span> <span class="o">=</span> <span class="n">metric_name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_metric</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">current_metric</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ALERT: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metric_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">current_metric</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">alert</span> <span class="o">=</span> <span class="n">MetricsAlert</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">alert</span><span class="o">.</span><span class="n">check_alert</span><span class="p">(</span><span class="mf">0.75</span><span class="p">):</span>
    <span class="c1"># –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
    <span class="k">pass</span>
</code></pre></div>

<h2 id="_134">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫</h2>
<h3 id="_135">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
<span class="p">)</span>

<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Performance Metrics:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">performance</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥</span>
<span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Leaderboard:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">)</span>

<span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Feature Importance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feature_importance</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># ROC –∫—Ä–∏–≤–∞—è</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Precision-Recall –∫—Ä–∏–≤–∞—è</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_recall_curve</span>
<span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Recall&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precision-Recall Curve&#39;</span><span class="p">)</span>

<span class="c1"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>

<span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">feature_importance</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 10 Feature Importance&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="_136">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./05_validation.md">–ú–µ—Ç–æ–¥–∞–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</a><br />
- <a href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a><br />
- <a href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a></p>
<hr />
<h1 id="automl-gluon_4">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –≤ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_137">–ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 70% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏–∑-–∑–∞ –ø–ª–æ—Ö–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –≠—Ç–æ –∫–∞–∫ —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π.</p>
<h3 id="_138">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</h3>
<ul>
<li><strong>–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å –∫–∞–∂–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π, –Ω–æ –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong>: –ú–æ–¥–µ–ª—å –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ –∏–∑—É—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</strong>: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ø–ª–æ—Ö—É—é –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–æ —Ö–æ—Ä–æ—à–µ–π</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-–ø—Ä–æ–≤–∞–ª—ã</strong>: –ú–æ–¥–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
</ul>
<h3 id="_139">–ß—Ç–æ –¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è?</h3>
<ul>
<li><strong>–†–µ–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</strong>: –í—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</strong>: –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –æ–±–æ–±—â–∞—Ç—å, –∞ –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å</li>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä</strong>: –í—ã–±–∏—Ä–∞–µ—Ç–µ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–¥–∞—á–∏</li>
<li><strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</strong>: –ú–æ–¥–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å</li>
</ul>
<h2 id="_140">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é</h2>
<p><img alt="–ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏" src="images/validation_methods.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 4: –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ AutoML Gluon</em></p>
<p><img alt="Walk-Forward –∞–Ω–∞–ª–∏–∑" src="images/walk_forward_analysis.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 4.1: Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å—Ö–µ–º–∞, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</em></p>
<p><strong>–ü–æ—á–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏"?</strong> –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–æ—Ç–æ–≤–∞ –ª–∏ –≤–∞—à–∞ –º–æ–¥–µ–ª—å –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –º–∏—Ä—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç–µ –ø–∏–ª–æ—Ç–∞ –∫ –ø–æ–ª–µ—Ç—É - –≤–∞–ª–∏–¥–∞—Ü–∏—è —ç—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –æ–Ω –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.</p>
<p>–í–∞–ª–∏–¥–∞—Ü–∏—è - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ML-–º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –í AutoML Gluon –¥–æ—Å—Ç—É–ø–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á.</p>
<h2 id="_141">–¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<p><strong>–ü–æ—á–µ–º—É AutoML Gluon –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.</p>
<h3 id="1-holdout">1. Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Ç–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞: –≤—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª—è–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏ - –æ–¥–Ω—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –¥—Ä—É–≥—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –≠—Ç–æ –∫–∞–∫ —ç–∫–∑–∞–º–µ–Ω –≤ —à–∫–æ–ª–µ - –≤—ã —É—á–∏—Ç–µ—Å—å –ø–æ —É—á–µ–±–Ω–∏–∫—É, –∞ —ç–∫–∑–∞–º–µ–Ω —Å–¥–∞–µ—Ç–µ –ø–æ –Ω–æ–≤—ã–º –∑–∞–¥–∞—á–∞–º.</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</strong><br />
- <strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞</strong>: –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å<br />
- <strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong>: –ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è<br />
- <strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤<br />
- <strong>–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ü–æ–Ω—è—Ç–Ω–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º</p>
<p><strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Holdout –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</strong><br />
- <strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è<br />
- <strong>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: 20% –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –æ–±—É—á–µ–Ω–∏–∏<br />
- <strong>–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å</strong>: –ü–ª–æ—Ö–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–∫–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –ü—Ä–æ—Å—Ç–∞—è holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">holdout_frac</span><span class="o">=</span><span class="mf">0.2</span>  <span class="c1"># 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É 20% –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏?</strong> –≠—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.</p>
<h3 id="2-k-fold-">2. K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞, —á–µ–º Holdout?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –≠—Ç–æ –∫–∞–∫ —Å–¥–∞—Ç—å 5 —ç–∫–∑–∞–º–µ–Ω–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º.</p>
<p><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç K-Fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è:</strong><br />
1. <strong>–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ K —á–∞—Å—Ç–µ–π</strong>: –î–∞–Ω–Ω—ã–µ –¥–µ–ª—è—Ç—Å—è –Ω–∞ K —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π (–æ–±—ã—á–Ω–æ K=5 –∏–ª–∏ K=10)<br />
2. <strong>K –∏—Ç–µ—Ä–∞—Ü–∏–π</strong>: –í –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–∞ —á–∞—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –æ—Å—Ç–∞–ª—å–Ω—ã–µ K-1 –¥–ª—è –æ–±—É—á–µ–Ω–∏—è<br />
3. <strong>–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</strong>: –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ K-1 —á–∞—Å—Ç—è—Ö<br />
4. <strong>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –ú–æ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏<br />
5. <strong>–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</strong>: –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ - —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º K –∏—Ç–µ—Ä–∞—Ü–∏—è–º</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</strong><br />
- <strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö</strong>: –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–≤—É–µ—Ç –∏ –≤ –æ–±—É—á–µ–Ω–∏–∏, –∏ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏<br />
- <strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è<br />
- <strong>–û—Ü–µ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏</strong>: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –º–æ–¥–µ–ª—å<br />
- <strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏</p>
<p><strong>–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ K-Fold –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</strong><br />
- <strong>–í—Ä–µ–º—è</strong>: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ K —Ä–∞–∑ –¥–æ–ª—å—à–µ<br />
- <strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong>: –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤<br />
- <strong>–ü–∞–º—è—Ç—å</strong>: –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å K –º–æ–¥–µ–ª–µ–π</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># K-fold –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># 5-fold CV</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç 5 –∏–ª–∏ 10 —Ñ–æ–ª–¥–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é.</p>
<h3 id="3">3. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ã—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ 100 —Ä–∞–∑ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–≥–æ. –≠—Ç–æ –∫–∞–∫ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≤—Ä–∞—á–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∑–¥–æ—Ä–æ–≤—ã–º –ø–∞—Ü–∏–µ–Ω—Ç–∞–º.</p>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:</strong><br />
- <strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</strong>: 99% –∑–¥–æ—Ä–æ–≤—ã—Ö, 1% –±–æ–ª—å–Ω—ã—Ö<br />
- <strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞</strong>: 99.9% –ª–µ–≥–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, 0.1% –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö<br />
- <strong>–°–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä—ã</strong>: 90% –æ–±—ã—á–Ω—ã—Ö –ø–∏—Å–µ–º, 10% —Å–ø–∞–º–∞</p>
<p><strong>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong><br />
1. <strong>–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</strong>: AutoML Gluon –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤<br />
2. <strong>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π</strong>: –í –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ<br />
3. <strong>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</strong>: –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö<br />
4. <strong>–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</strong>: –ü–æ–ª—É—á–∞–µ–º —Ç–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤</p>
<p><strong>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:</strong><br />
- <strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</strong>: –ö–æ–≥–¥–∞ –∫–ª–∞—Å—Å—ã –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ &gt; 10:1)<br />
- <strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</strong>: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Å—ã (–º–µ–¥–∏—Ü–∏–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)<br />
- <strong>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</strong>: –ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã<br />
- <strong>–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</strong>: –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">stratify</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω—É–∂–Ω–∞ –Ω–µ –≤—Å–µ–≥–¥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞.</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>

<span class="c1">### –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>

<span class="err">```</span><span class="n">python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesSplit</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">time_series_backtest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Backtest –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ–ª–¥–æ–≤</span>
    <span class="n">tscv</span> <span class="o">=</span> <span class="n">TimeSeriesSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tscv</span><span class="o">.</span><span class="kp">split</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold </span><span class="si">{</span><span class="n">fold</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_splits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">train_fold</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
        <span class="n">val_fold</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_fold</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_fold</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_fold</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="kp">append</span><span class="p">({</span>
            <span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">backtest_results</span> <span class="o">=</span> <span class="n">time_series_backtest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

<h3 id="backtest">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">advanced_backtest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π backtest —Å —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">window_size</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end</span><span class="o">-</span><span class="mi">100</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
            <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">end</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="walk-forward">Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 id="walk-forward_1">–ë–∞–∑–æ–≤–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">walk_forward_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">train_size</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="n">test_size</span><span class="p">,</span> <span class="n">test_size</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">train_size</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">test_size</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;train_start&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="n">train_size</span><span class="p">,</span>
            <span class="s1">&#39;train_end&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
            <span class="s1">&#39;test_start&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
            <span class="s1">&#39;test_end&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="n">test_size</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">wf_results</span> <span class="o">=</span> <span class="n">walk_forward_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>

<h3 id="walk-forward_2">–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">adaptive_walk_forward</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">min_train_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_train_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –æ–∫–Ω–∞&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">current_train_size</span> <span class="o">=</span> <span class="n">min_train_size</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_train_size</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
        <span class="c1"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">current_train_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_train_size</span><span class="p">,</span> <span class="n">current_train_size</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">current_train_size</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">100</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="n">current_train_size</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="monte-carlo">Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 id="monte-carlo_1">–ë–∞–∑–æ–≤—ã–π Monte Carlo</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">monte_carlo_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">train_frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Å–ª—É—á–∞–π–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
        <span class="c1"># –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">train_frac</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">iteration</span><span class="p">)</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="n">iteration</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">monte_carlo_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>

<h3 id="bootstrap">Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bootstrap_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">n_bootstrap</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Bootstrap –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bootstrap</span><span class="p">):</span>
        <span class="c1"># Bootstrap –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">bootstrap_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">bootstrap_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">bootstrap_indices</span><span class="p">]</span>

        <span class="c1"># Out-of-bag –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">oob_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">bootstrap_indices</span><span class="p">))</span>
        <span class="n">oob_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">oob_indices</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">oob_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bootstrap_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ OOB –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">oob_data</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">oob_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;bootstrap&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_142">–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<h3 id="ensemble">Ensemble –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ensemble_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">validation_methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;holdout&#39;</span><span class="p">,</span> <span class="s1">&#39;kfold&#39;</span><span class="p">,</span> <span class="s1">&#39;monte_carlo&#39;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Holdout –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
    <span class="k">if</span> <span class="s1">&#39;holdout&#39;</span> <span class="ow">in</span> <span class="n">validation_methods</span><span class="p">:</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">holdout_frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;holdout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># K-fold –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
    <span class="k">if</span> <span class="s1">&#39;kfold&#39;</span> <span class="ow">in</span> <span class="n">validation_methods</span><span class="p">:</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;kfold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
    <span class="k">if</span> <span class="s1">&#39;monte_carlo&#39;</span> <span class="ow">in</span> <span class="n">validation_methods</span><span class="p">:</span>
        <span class="n">mc_results</span> <span class="o">=</span> <span class="n">monte_carlo_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;monte_carlo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mc_results</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_143">–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h2>
<h3 id="_144">–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">financial_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">,</span> <span class="n">lookback_window</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">forward_window</span><span class="o">=</span><span class="mi">21</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lookback_window</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="n">forward_window</span><span class="p">,</span> <span class="n">forward_window</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (lookback_window –¥–Ω–µ–π)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">lookback_window</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (forward_window –¥–Ω–µ–π)</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">forward_window</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">)</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">returns</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">predicted_returns</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># Sharpe Ratio</span>
        <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">returns</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>

        <span class="c1"># Maximum Drawdown</span>
        <span class="n">cumulative_returns</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">returns</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span>
        <span class="n">peak</span> <span class="o">=</span> <span class="n">cumulative_returns</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">drawdown</span> <span class="o">=</span> <span class="p">(</span><span class="n">cumulative_returns</span> <span class="o">-</span> <span class="n">peak</span><span class="p">)</span> <span class="o">/</span> <span class="n">peak</span>
        <span class="n">max_drawdown</span> <span class="o">=</span> <span class="n">drawdown</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;start_date&#39;</span><span class="p">:</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;end_date&#39;</span><span class="p">:</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
            <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_drawdown</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_145">–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 id="_146">–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_validation_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;performance&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">])</span>

    <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</span>
    <span class="n">analysis</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>
        <span class="n">analysis</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;q25&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
            <span class="s1">&#39;q75&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">analysis</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_validation_results</span><span class="p">(</span><span class="n">backtest_results</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validation Analysis:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">analysis</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ¬± </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_147">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_validation_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;performance&#39;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]:</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">][</span><span class="n">metric</span><span class="p">])</span>

    <span class="c1"># –ì—Ä–∞—Ñ–∏–∫</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –º–µ—Ç—Ä–∏–∫–∏</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> over time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fold/Iteration&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

    <span class="c1"># Box plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Box plot of </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">stats_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span>
<span class="s2">    Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span>
<span class="s2">    Min: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span>
<span class="s2">    Max: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">stats_text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">plot_validation_results</span><span class="p">(</span><span class="n">backtest_results</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_148">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</h2>
<h3 id="_149">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

<span class="c1"># –†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Holdout Validation ===&quot;</span><span class="p">)</span>
<span class="n">predictor_holdout</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">predictor_holdout</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">holdout_frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">holdout_performance</span> <span class="o">=</span> <span class="n">predictor_holdout</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Holdout Performance: </span><span class="si">{</span><span class="n">holdout_performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== K-Fold Validation ===&quot;</span><span class="p">)</span>
<span class="n">predictor_kfold</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">predictor_kfold</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">kfold_performance</span> <span class="o">=</span> <span class="n">predictor_kfold</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;K-Fold Performance: </span><span class="si">{</span><span class="n">kfold_performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Time Series Backtest ===&quot;</span><span class="p">)</span>
<span class="n">backtest_results</span> <span class="o">=</span> <span class="n">time_series_backtest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">backtest_analysis</span> <span class="o">=</span> <span class="n">analyze_validation_results</span><span class="p">(</span><span class="n">backtest_results</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Backtest Analysis: </span><span class="si">{</span><span class="n">backtest_analysis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Monte Carlo Validation ===&quot;</span><span class="p">)</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">monte_carlo_validation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">mc_analysis</span> <span class="o">=</span> <span class="n">analyze_validation_results</span><span class="p">(</span><span class="n">mc_results</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monte Carlo Analysis: </span><span class="si">{</span><span class="n">mc_analysis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
<span class="n">plot_validation_results</span><span class="p">(</span><span class="n">backtest_results</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_150">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h2>
<h3 id="_151">–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choose_validation_method</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">,</span> <span class="n">data_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;time_series&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;time_series_backtest&#39;</span>
    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;kfold&#39;</span>
    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;holdout&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;monte_carlo&#39;</span>
</code></pre></div>

<h3 id="_152">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize_validation_params</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ–ª–¥–æ–≤</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_samples</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">n_folds</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">n_samples</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">n_folds</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_folds</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ holdout</span>
    <span class="k">if</span> <span class="n">n_samples</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">holdout_frac</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">holdout_frac</span> <span class="o">=</span> <span class="mf">0.2</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;n_folds&#39;</span><span class="p">:</span> <span class="n">n_folds</span><span class="p">,</span>
        <span class="s1">&#39;holdout_frac&#39;</span><span class="p">:</span> <span class="n">holdout_frac</span><span class="p">,</span>
        <span class="s1">&#39;n_monte_carlo&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div>

<h2 id="_153">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./06_production.md">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—é</a><br />
- <a href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a><br />
- <a href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a></p>
<hr />
<h1 id="automl-gluon_5">–ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π AutoML Gluon –º–æ–¥–µ–ª–µ–π</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_154">–ü–æ—á–µ–º—É –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>
<p><strong>–ü–æ—á–µ–º—É 87% ML-–º–æ–¥–µ–ª–µ–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - —ç—Ç–æ —Ç–æ–ª—å–∫–æ 20% —Ä–∞–±–æ—Ç—ã. –û—Å—Ç–∞–ª—å–Ω—ã–µ 80% - —ç—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞.</p>
<h3 id="_155">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<ul>
<li><strong>Microsoft Tay</strong>: AI-—á–∞—Ç–±–æ—Ç —Å—Ç–∞–ª —Ä–∞—Å–∏—Å—Ç–æ–º –∑–∞ 24 —á–∞—Å–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</li>
<li><strong>Amazon HR</strong>: AI-—Å–∏—Å—Ç–µ–º–∞ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∏—Ä–æ–≤–∞–ª–∞ –∂–µ–Ω—â–∏–Ω –ø—Ä–∏ –Ω–∞–π–º–µ</li>
<li><strong>Uber —Å–∞–º–æ—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –∞–≤—Ç–æ</strong>: –°–º–µ—Ä—Ç—å –ø–µ—à–µ—Ö–æ–¥–∞ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏</li>
<li><strong>Facebook –∞–ª–≥–æ—Ä–∏—Ç–º</strong>: –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑-–∑–∞ –ø–ª–æ—Ö–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
</ul>
<h3 id="_156">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<ul>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: 99.9% uptime, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong>: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å</strong>: –†–µ–∞–ª—å–Ω–∞—è –ø–æ–ª—å–∑–∞ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
</ul>
<h2 id="_157">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</h2>
<p><img alt="–ü—Ä–æ–¥–∞–∫—à–µ–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞" src="images/production_architecture.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 5: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã AutoML Gluon</em></p>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–∞–∫—à–µ–Ω –≤ ML –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ ML-–º–æ–¥–µ–ª–∏ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–¥, –∞ –∂–∏–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∞—Ç—Å—è –∏ –∏–∑–º–µ–Ω—è—é—Ç—Å—è. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∑–∞–≤–æ–¥–æ–º –∏ —Å–∞–¥–æ–º - –∑–∞–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø–ª–∞–Ω—É, –∞ —Å–∞–¥ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —É—Ö–æ–¥–∞.</p>
<p><strong>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ ML –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:</strong><br />
- <strong>–î–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è</strong>: –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç "–∑–∞–±—ã—Ç—å" —Ç–æ, —á—Ç–æ –∑–Ω–∞–ª–∞<br />
- <strong>–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä–∏—Ñ—Ç</strong>: –†–µ–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –º–æ–¥–µ–ª–∏<br />
- <strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–∞–Ω–Ω—ã—Ö</strong>: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö = –Ω–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π<br />
- <strong>–ß–µ—Ä–Ω—ã–π —è—â–∏–∫</strong>: –°–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—è–ª–∞ —Ä–µ—à–µ–Ω–∏–µ</p>
<p>–ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π ML-–º–æ–¥–µ–ª–µ–π - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –¥–µ–ø–ª–æ—è AutoML Gluon –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω.</p>
<h2 id="_158">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É</h2>
<h3 id="_159">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h3>
<p><strong>–ü–æ—á–µ–º—É –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Jupyter, –º–æ–∂–µ—Ç –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø—Ä–µ–¥—ä—è–≤–ª—è–µ—Ç —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –¥—Ä—É–≥–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–∞–º—è—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.</p>
<p><strong>–ü—Ä–æ–±–ª–µ–º—ã –Ω–µ–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:</strong><br />
- <strong>–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</strong>: 5 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 50–º—Å - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–π–¥—É—Ç<br />
- <strong>–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</strong>: –°–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π<br />
- <strong>–ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏</strong>: –ù–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä<br />
- <strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö</p>
<p><strong>–ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π:</strong><br />
- <strong>–ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è</strong>: –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–µ—Å–æ–≤ (float32 ‚Üí float16)<br />
- <strong>–ü—Ä—É–Ω–∏–Ω–≥</strong>: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–≤–∞–∂–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤<br />
- <strong>–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è</strong>: –û–±—É—á–µ–Ω–∏–µ –º–∞–ª–µ–Ω—å–∫–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –±–æ–ª—å—à–æ–π<br />
- <strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</strong>: –í—ã–±–æ—Ä –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_production_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">target_col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span>

    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./production_models&#39;</span>  <span class="c1"># –û—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω –º–æ–¥–µ–ª–µ–π</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –¥–µ–ø–ª–æ—è</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>  <span class="c1"># –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>  <span class="c1"># 1 —á–∞—Å - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>   <span class="c1"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>        <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ CPU –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span>
            <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>        <span class="c1"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ GPU –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span>
            <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>     <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ GB</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –≤–∞–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –∏ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —ç—Ç–∏—Ö —Ä–∞–º–∫–∞—Ö.</p>
<h3 id="_160">–°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compress_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–π –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">model_name</span><span class="p">,</span>
        <span class="n">save_space</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">save_info</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –º–æ–¥–µ–ª–∏</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="n">model_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">/predictor.pkl&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># MB</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model size: </span><span class="si">{</span><span class="n">model_size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model_size</span>
</code></pre></div>

<h3 id="_161">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_production_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">performance_thresholds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">validation_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">performance_thresholds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">performance</span><span class="p">:</span>
            <span class="n">validation_results</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">performance</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">validation_results</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">prob_std</span> <span class="o">=</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">validation_results</span><span class="p">[</span><span class="s1">&#39;stability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob_std</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>

    <span class="k">return</span> <span class="n">validation_results</span><span class="p">,</span> <span class="n">performance</span>
</code></pre></div>

<h2 id="api">API —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 id="fastapi">FastAPI —Å–µ—Ä–≤–µ—Ä</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;AutoML Gluon Production API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">)</span>

<span class="c1"># –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionRequest</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—Ö–µ–º–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏&quot;&quot;&quot;</span>
    <span class="n">predictions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
    <span class="n">probabilities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">model_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HealthResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ –¥–ª—è health check&quot;&quot;&quot;</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model_loaded</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">model_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">on_event</span><span class="p">(</span><span class="s2">&quot;startup&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">model</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./production_models&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Model loaded successfully&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/health&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">HealthResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HealthResponse</span><span class="p">(</span>
            <span class="n">status</span><span class="o">=</span><span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span>
            <span class="n">model_loaded</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">HealthResponse</span><span class="p">(</span>
        <span class="n">status</span><span class="o">=</span><span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
        <span class="n">model_loaded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">model_info</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
            <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
            <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span>
        <span class="p">}</span>
    <span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/predict&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">PredictionResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">PredictionRequest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">503</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Model not loaded&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">proba</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>

        <span class="c1"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏</span>
        <span class="n">model_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
            <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
            <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">,</span>
            <span class="s2">&quot;num_features&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">PredictionResponse</span><span class="p">(</span>
            <span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">probabilities</span><span class="o">=</span><span class="n">probabilities</span><span class="p">,</span>
            <span class="n">model_info</span><span class="o">=</span><span class="n">model_info</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/model/info&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">model_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">503</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="s2">&quot;Model not loaded&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
        <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">,</span>
        <span class="s2">&quot;feature_importance&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="p">}</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">uvicorn</span>
    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
</code></pre></div>

<h3 id="flask">Flask —Å–µ—Ä–≤–µ—Ä</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">model</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./production_models&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Model loaded successfully&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/health&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;model_loaded&quot;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}),</span> <span class="mi">503</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;model_loaded&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;model_info&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
            <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
            <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span>
        <span class="p">}</span>
    <span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/predict&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Model not loaded&quot;</span><span class="p">}),</span> <span class="mi">503</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;data&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;No data provided&quot;</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">proba</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
            <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;probabilities&quot;</span><span class="p">:</span> <span class="n">probabilities</span><span class="p">,</span>
            <span class="s2">&quot;model_info&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
                <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
                <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span>
            <span class="p">},</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">})</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">500</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/model/info&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">model_info</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Model not loaded&quot;</span><span class="p">}),</span> <span class="mi">503</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;problem_type&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
        <span class="s2">&quot;eval_metric&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">,</span>
        <span class="s2">&quot;feature_importance&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">load_model</span><span class="p">():</span>
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to start server - model not loaded&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="docker">Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</h2>
<h3 id="dockerfile">Dockerfile –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="c"># Dockerfile –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.9-slim</span>

<span class="c"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gcc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>g++<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ requirements</span>
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.

<span class="c"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span>
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.

<span class="c"># –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</span>
<span class="k">RUN</span><span class="w"> </span>useradd<span class="w"> </span>-m<span class="w"> </span>-u<span class="w"> </span><span class="m">1000</span><span class="w"> </span>appuser<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>appuser:appuser<span class="w"> </span>/app
<span class="k">USER</span><span class="w"> </span><span class="s">appuser</span>

<span class="c"># –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–∞</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">8000</span>

<span class="c"># –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</code></pre></div>

<h3 id="docker-compose">Docker Compose –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># docker-compose.prod.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">autogluon-api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8000:8000&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MODEL_PATH=/app/models</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL=INFO</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./models:/app/models</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./logs:/app/logs</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">healthcheck</span><span class="p">:</span>
<span class="w">      </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;CMD&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;curl&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-f&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;http://localhost:8000/health&quot;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30s</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10s</span>
<span class="w">      </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">start_period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40s</span>

<span class="w">  </span><span class="nt">nginx</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:80&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:443&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./nginx.conf:/etc/nginx/nginx.conf</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./ssl:/etc/nginx/ssl</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:alpine</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;6379:6379&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis_data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis_data</span><span class="p">:</span>
</code></pre></div>

<h2 id="kubernetes">Kubernetes –¥–µ–ø–ª–æ–π</h2>
<h3 id="deployment">Deployment –º–∞–Ω–∏—Ñ–µ—Å—Ç</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># k8s-deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MODEL_PATH</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/app/models&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;INFO&quot;</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000m&quot;</span>
<span class="w">        </span><span class="nt">livenessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">        </span><span class="nt">readinessProbe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-storage</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/app/models</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-storage</span>
<span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/app/logs</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-storage</span>
<span class="w">        </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<span class="w">          </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-pvc</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-storage</span>
<span class="w">        </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<span class="w">          </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-pvc</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autogluon-api</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-pvc</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10Gi</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-pvc</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">    </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5Gi</span>
</code></pre></div>

<h2 id="_162">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 id="_163">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ProductionMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s1">&#39;production.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> 
                      <span class="n">processing_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">model_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;input_data&#39;</span><span class="p">:</span> <span class="n">input_data</span><span class="p">,</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">prediction</span><span class="p">,</span>
            <span class="s1">&#39;processing_time&#39;</span><span class="p">:</span> <span class="n">processing_time</span><span class="p">,</span>
            <span class="s1">&#39;model_info&#39;</span><span class="p">:</span> <span class="n">model_info</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction: </span><span class="si">{</span><span class="n">log_entry</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span>
        <span class="n">error_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">),</span>
            <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">context</span><span class="p">,</span>
            <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error_entry</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_system_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cpu_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(),</span>
            <span class="s1">&#39;memory_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;disk_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_model_health</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">]})</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
            <span class="n">processing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;healthy&#39;</span><span class="p">,</span>
                <span class="s1">&#39;processing_time&#39;</span><span class="p">:</span> <span class="n">processing_time</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;unhealthy&#39;</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
</code></pre></div>

<h3 id="_164">–ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">smtplib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.multipart</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEMultipart</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AlertSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smtp_server</span><span class="p">,</span> <span class="n">smtp_port</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span> <span class="o">=</span> <span class="n">smtp_server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smtp_port</span> <span class="o">=</span> <span class="n">smtp_port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_email_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recipients</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ email –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">()</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">email</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">recipients</span><span class="p">)</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>

            <span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">MIMEText</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s1">&#39;plain&#39;</span><span class="p">))</span>

            <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">smtp_port</span><span class="p">)</span>
            <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
            <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
            <span class="n">server</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">server</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Email alert sent to </span><span class="si">{</span><span class="n">recipients</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to send email alert: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_slack_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">webhook_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ Slack –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
                <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;AutoML Gluon Monitor&quot;</span><span class="p">,</span>
                <span class="s2">&quot;icon_emoji&quot;</span><span class="p">:</span> <span class="s2">&quot;:robot_face:&quot;</span>
            <span class="p">}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">webhook_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slack alert sent successfully&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to send Slack alert: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_performance_thresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> 
                                   <span class="n">thresholds</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span> <span class="ow">and</span> <span class="n">metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2"> is below threshold: </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">alerts</span>
</code></pre></div>

<h2 id="_165">–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 id="_166">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">queue</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ScalablePredictionService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span> <span class="o">=</span> <span class="n">max_workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executor</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

        <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">executor</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_predict_sync</span><span class="p">,</span> 
            <span class="n">data</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_predict_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ&quot;&quot;&quot;</span>
        <span class="c1"># –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">batch_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –±–∞—Ç—á–∏</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch_data</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">batch_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>

            <span class="c1"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞</span>
            <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
                <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_predict_sync</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
                <span class="n">batch_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">]</span>
                <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_results</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h3 id="_167">–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">redis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionCache</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö—ç—à –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redis_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">redis_port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redis_client</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">redis_host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">redis_port</span><span class="p">,</span> <span class="n">decode_responses</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ttl</span> <span class="o">=</span> <span class="n">ttl</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="n">data_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data_str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–∑ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_cache_key</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cached_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cached_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cached_result</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –∫—ç—à&quot;&quot;&quot;</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_cache_key</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redis_client</span><span class="o">.</span><span class="n">setex</span><span class="p">(</span>
            <span class="n">cache_key</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ttl</span><span class="p">,</span> 
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invalidate_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis_client</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redis_client</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">)</span>
</code></pre></div>

<h2 id="_168">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
<h3 id="_169">–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jwt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SecurityManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–µ–Ω–µ–¥–∂–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_api_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª—é—á–∞&quot;&quot;&quot;</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span><span class="p">[</span><span class="n">api_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;permissions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;model_info&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">api_key</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_api_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è API –∫–ª—é—á–∞&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">api_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">api_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span><span class="p">[</span><span class="n">api_key</span><span class="p">][</span><span class="s1">&#39;permissions&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">require_auth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permissions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏&quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞</span>
                <span class="n">api_key</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X-API-Key&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">api_key</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_api_key</span><span class="p">(</span><span class="n">api_key</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid API key&#39;</span><span class="p">}),</span> <span class="mi">401</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π</span>
                <span class="k">if</span> <span class="n">permissions</span><span class="p">:</span>
                    <span class="n">user_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_permissions</span><span class="p">(</span><span class="n">api_key</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">perm</span> <span class="ow">in</span> <span class="n">user_permissions</span> <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">permissions</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Insufficient permissions&#39;</span><span class="p">}),</span> <span class="mi">403</span>

                <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">decorated_function</span>
        <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div>

<h3 id="_170">–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">validator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">InputValidator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ç–æ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_schema</span> <span class="o">=</span> <span class="n">feature_schema</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
                <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_schema</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">feature</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">record</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required feature: </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid type for feature </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π</span>
                    <span class="k">if</span> <span class="s1">&#39;min&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="ow">and</span> <span class="n">record</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value too small for feature </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="s1">&#39;max&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="ow">and</span> <span class="n">record</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value too large for feature </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sanitize_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="n">sanitized_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">sanitized_record</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># –û—á–∏—Å—Ç–∫–∞ –æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">sanitized_record</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sanitized_record</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

            <span class="n">sanitized_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sanitized_record</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sanitized_data</span>
</code></pre></div>

<h2 id="_171">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã</h2>
<h3 id="_172">–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statistics</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LoadTester</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">single_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">,</span> 
                           <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–¥–∏–Ω–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/predict&quot;</span><span class="p">,</span>
                <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">]}</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="n">processing_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                    <span class="s1">&#39;processing_time&#39;</span><span class="p">:</span> <span class="n">processing_time</span><span class="p">,</span>
                    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span>
                    <span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="n">result</span>
                <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;processing_time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">concurrent_users</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                       <span class="n">requests_per_user</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                       <span class="n">test_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ&quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">concurrent_users</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">requests_per_user</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">request</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)]</span>
                    <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_request</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
        <span class="n">successful_requests</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]]</span>
        <span class="n">failed_requests</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]]</span>

        <span class="n">processing_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;processing_time&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">successful_requests</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;total_requests&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="s1">&#39;successful_requests&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">successful_requests</span><span class="p">),</span>
            <span class="s1">&#39;failed_requests&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">failed_requests</span><span class="p">),</span>
            <span class="s1">&#39;success_rate&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">successful_requests</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="s1">&#39;avg_processing_time&#39;</span><span class="p">:</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">processing_times</span><span class="p">),</span>
            <span class="s1">&#39;min_processing_time&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">processing_times</span><span class="p">),</span>
            <span class="s1">&#39;max_processing_time&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">processing_times</span><span class="p">),</span>
            <span class="s1">&#39;p95_processing_time&#39;</span><span class="p">:</span> <span class="n">statistics</span><span class="o">.</span><span class="n">quantiles</span><span class="p">(</span><span class="n">processing_times</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="mi">18</span><span class="p">]</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_173">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./07_retraining.md">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π</a><br />
- <a href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a><br />
- <a href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></p>
<hr />
<h1 id="automl-gluon_6">–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_174">–ü–æ—á–µ–º—É –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ</h2>
<p><strong>–ü–æ—á–µ–º—É 90% ML-–º–æ–¥–µ–ª–µ–π —Ç–µ—Ä—è—é—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ 6 –º–µ—Å—è—Ü–µ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∏—Ä –º–µ–Ω—è–µ—Ç—Å—è, –∞ –º–æ–¥–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ç–∏—á–Ω—ã–º–∏. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å "–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π" –º–æ–¥–µ–ª–∏, –∫–∞–∫ –≤—Ä–∞—á, –∫–æ—Ç–æ—Ä—ã–π –∏–∑—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –ª–µ—á–µ–Ω–∏—è.</p>
<h3 id="_175">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –º–æ–¥–µ–ª–µ–π</h3>
<ul>
<li><strong>Netflix —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</strong>: –ú–æ–¥–µ–ª—å 2010 –≥–æ–¥–∞ –Ω–µ –ø–æ–Ω–∏–º–∞–ª–∞ —Å–µ—Ä–∏–∞–ª—ã 2020 –≥–æ–¥–∞</li>
<li><strong>Google Translate</strong>: –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–≤–∞–ª–∏ –Ω–µ—Ç–æ—á–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–æ–≤—ã—Ö —Å–ª–µ–Ω–≥–æ–≤</li>
<li><strong>–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã</strong>: –ú–æ–¥–µ–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª–∏ –Ω–æ–≤—ã–µ –≤–∏–¥—ã –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞</li>
<li><strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∏–∞–≥–Ω–æ–∑—ã</strong>: –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏ –Ω–æ–≤—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –±–æ–ª–µ–∑–Ω–µ–π</li>
</ul>
<h3 id="_176">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h3>
<ul>
<li><strong>–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è</li>
<li><strong>–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å</strong>: –û—Å—Ç–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≤ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π —Å—Ä–µ–¥–µ</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong>: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è —Ç–æ—á–Ω—ã–º–∏ –∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏</li>
</ul>
<h2 id="_177">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h2>
<p><img alt="–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è" src="images/retraining_workflow.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 6: –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π AutoML Gluon</em></p>
<p><strong>–ü–æ—á–µ–º—É –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–æ–±–Ω–æ–≤–∏—Ç—å –º–æ–¥–µ–ª—å"?</strong> –≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –∫ –∏–∑–º–µ–Ω—è—é—â–µ–º—É—Å—è –º–∏—Ä—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –≤—Ä–∞—á–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏–∑—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –ª–µ—á–µ–Ω–∏—è - –æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.</p>
<p><strong>–ü–æ—á–µ–º—É –º–æ–¥–µ–ª–∏ "—Å—Ç–∞—Ä–µ—é—Ç" –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?</strong><br />
- <strong>–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä–∏—Ñ—Ç</strong>: –†–µ–∞–ª—å–Ω–æ—Å—Ç—å –º–µ–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –º–æ–¥–µ–ª–∏<br />
- <strong>–î–∞–Ω–Ω—ã–µ –¥—Ä–∏—Ñ—Ç</strong>: –ù–æ–≤—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –±—ã–ª–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏<br />
- <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</strong>: –õ—é–¥–∏ –º–µ–Ω—è—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –≤–∫—É—Å—ã<br />
- <strong>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</strong>: –ù–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã</p>
<p>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (retraining) - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ ML-–º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.</p>
<h2 id="_178">–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 id="1">1. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<p><strong>–ü–æ—á–µ–º—É –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–æ–¥—Ö–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –∫–∞–∫ –±—É–¥–∏–ª—å–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞–Ω–∏—è. –≠—Ç–æ –∫–∞–∫ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –≤—Ä–∞—á–µ–π.</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:</strong><br />
- <strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞</strong>: –õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å<br />
- <strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é<br />
- <strong>–ü–ª–∞–Ω–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –ú–æ–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã<br />
- <strong>–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞</strong>: –í—Ä–µ–º—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º</p>
<p><strong>–í—ã–±–æ—Ä –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:</strong><br />
- <strong>–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</strong>: –î–ª—è –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—é—â–∏—Ö—Å—è –¥–∞–Ω–Ω—ã—Ö (—Ñ–∏–Ω–∞–Ω—Å—ã, –Ω–æ–≤–æ—Å—Ç–∏)<br />
- <strong>–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</strong>: –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á<br />
- <strong>–ï–∂–µ–º–µ—Å—è—á–Ω–æ</strong>: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (–º–µ–¥–∏—Ü–∏–Ω–∞, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ)<br />
- <strong>–ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é</strong>: –ü—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –¥–∞–Ω–Ω—ã—Ö</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">schedule</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PeriodicRetraining</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">retraining_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retraining_interval</span> <span class="o">=</span> <span class="n">retraining_interval</span>  <span class="c1"># –¥–Ω–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">schedule_retraining</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="c1"># –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ - –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∑–º</span>
        <span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">week</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retrain_model</span><span class="p">)</span>

        <span class="c1"># –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</span>
        <span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_retraining_need</span><span class="p">)</span>

        <span class="c1"># –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ - –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">schedule</span><span class="o">.</span><span class="n">run_pending</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">retrain_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting model retraining...&quot;</span><span class="p">)</span>
            <span class="c1"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>

            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_new_data</span><span class="p">()</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_new&quot;</span>
            <span class="p">)</span>

            <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

            <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
                <span class="c1"># –ó–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª–∏</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deploy_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Model retraining completed successfully&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model validation failed, keeping old model&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model retraining failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_retraining_need</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">current_performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_current_model</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data_drift</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
        <span class="n">last_retraining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_retraining_time</span><span class="p">()</span>
        <span class="n">days_since_retraining</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_retraining</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>

        <span class="c1"># –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">current_performance</span> <span class="o">&lt;</span> <span class="mf">0.8</span> <span class="ow">or</span> 
            <span class="n">data_drift</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="ow">or</span> 
            <span class="n">days_since_retraining</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retraining_interval</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retraining needed based on criteria&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">retrain_model</span><span class="p">()</span>
</code></pre></div>

<h3 id="2">2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdaptiveRetraining</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">performance_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_threshold</span> <span class="o">=</span> <span class="n">performance_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">actuals</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="c1"># –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">current_performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_performance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">)</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">current_performance</span>
        <span class="p">})</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–Ω–¥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_performance_degradation</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Performance degradation detected&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_performance_degradation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∏–∑–º–µ—Ä–µ–Ω–∏–π</span>
        <span class="n">recent_performance</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]]</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–Ω–∏–∂–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">recent_performance</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_threshold</span> <span class="ow">and</span>
            <span class="n">recent_performance</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">recent_performance</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">trigger_retraining</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Triggering adaptive retraining...&quot;</span><span class="p">)</span>

        <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
        <span class="n">retraining_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_retraining_data</span><span class="p">()</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_adaptive&quot;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">retraining_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

        <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –¥–µ–ø–ª–æ–π</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deploy_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># –°–±—Ä–æ—Å –∏—Å—Ç–æ—Ä–∏–∏</span>
</code></pre></div>

<h3 id="3_1">3. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IncrementalRetraining</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–Ω–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">incremental_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">current_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="p">)</span>

            <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_data</span><span class="p">(</span><span class="n">current_predictor</span><span class="p">,</span> <span class="n">new_data</span><span class="p">)</span>

            <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">updated_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_updated&quot;</span>
            <span class="p">)</span>

            <span class="n">updated_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">combined_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

            <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_updated_model</span><span class="p">(</span><span class="n">updated_predictor</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deploy_updated_model</span><span class="p">(</span><span class="n">updated_predictor</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Incremental update completed&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Updated model validation failed&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incremental update failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">combine_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_predictor</span><span class="p">,</span> <span class="n">new_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)</span>
        <span class="n">old_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_old_data</span><span class="p">(</span><span class="n">current_predictor</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="k">if</span> <span class="n">old_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">old_data</span><span class="p">,</span> <span class="n">new_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="n">new_data</span>

        <span class="k">return</span> <span class="n">combined_data</span>
</code></pre></div>

<h2 id="_179">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 id="_180">–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AutomatedRetrainingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retraining_queue</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_retraining</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_data_quality</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_model_performance</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_data_drift</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_retraining_queue</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_data_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">data_quality</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data_quality</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">data_quality</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;data_quality_threshold&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality issue: </span><span class="si">{</span><span class="n">data_quality</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;data_quality&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data quality monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_model_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
                <span class="n">performance</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model_performance</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;performance_threshold&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance degradation: </span><span class="si">{</span><span class="n">performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1800</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_data_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">drift_score</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data_drift</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">drift_score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;drift_threshold&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data drift detected: </span><span class="si">{</span><span class="n">drift_score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;data_drift&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">7200</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data drift monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">trigger_retraining</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_retraining</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retraining already in progress&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">retraining_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="n">reason</span><span class="p">,</span>
            <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_retraining_priority</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">retraining_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">retraining_request</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retraining queued: </span><span class="si">{</span><span class="n">retraining_request</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_retraining_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span>
                <span class="n">request</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">retraining_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

                <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_retraining</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">retraining_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retraining processing error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_retraining</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_retraining</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting retraining: </span><span class="si">{</span><span class="n">request</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_retraining_data</span><span class="p">()</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;./models/retrained_</span><span class="si">{</span><span class="n">request</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
            <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

            <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
                <span class="c1"># –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_new_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retraining completed successfully&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model validation failed&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retraining execution failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_retraining</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>

<h2 id="_181">–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</h2>
<h3 id="_182">–°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RetrainingValidator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ç–æ—Ä –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">validation_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_predictor</span><span class="p">,</span> <span class="n">old_predictor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_test_data</span><span class="p">()</span>

            <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">new_predictions</span> <span class="o">=</span> <span class="n">new_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
            <span class="n">new_performance</span> <span class="o">=</span> <span class="n">new_predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

            <span class="c1"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª—å—é (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)</span>
            <span class="k">if</span> <span class="n">old_predictor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">old_predictions</span> <span class="o">=</span> <span class="n">old_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
                <span class="n">old_performance</span> <span class="o">=</span> <span class="n">old_predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_performance_improvement</span><span class="p">(</span><span class="n">new_performance</span><span class="p">,</span> <span class="n">old_performance</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model doesn&#39;t improve performance&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_minimum_requirements</span><span class="p">(</span><span class="n">new_performance</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model doesn&#39;t meet minimum requirements&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_model_stability</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model is not stable&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_compatibility</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;New model is not compatible&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_performance_improvement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_perf</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">old_perf</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
        <span class="n">improvement_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;improvement_threshold&#39;</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;performance_metrics&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">new_perf</span> <span class="ow">and</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">old_perf</span><span class="p">:</span>
                <span class="n">improvement</span> <span class="o">=</span> <span class="n">new_perf</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_perf</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">improvement</span> <span class="o">&lt;</span> <span class="n">improvement_threshold</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_minimum_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">performance</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;minimum_requirements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">performance</span> <span class="ow">and</span> <span class="n">performance</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_model_stability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="c1"># –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
            <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span>
        <span class="n">consistency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_prediction_consistency</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">consistency</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stability_threshold&#39;</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_compatibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ AutoGluon</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">predictor</span><span class="o">.</span><span class="n">version</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;required_version&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –º–æ–¥–µ–ª–∏</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_model_format</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>

<h2 id="_183">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h2>
<h3 id="_184">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RetrainingMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitoring_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">monitoring_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retraining_process</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>
        <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_resources</span><span class="p">()</span>

        <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_progress</span><span class="p">(</span><span class="n">retraining_process</span><span class="p">)</span>

        <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_quality</span><span class="p">(</span><span class="n">retraining_process</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># CPU –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
                <span class="n">cpu_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">()</span>

                <span class="c1"># –ü–∞–º—è—Ç—å</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
                <span class="n">memory_percent</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span>

                <span class="c1"># –î–∏—Å–∫</span>
                <span class="n">disk</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                <span class="n">disk_percent</span> <span class="o">=</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span>

                <span class="c1"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resources - CPU: </span><span class="si">{</span><span class="n">cpu_percent</span><span class="si">}</span><span class="s2">%, Memory: </span><span class="si">{</span><span class="n">memory_percent</span><span class="si">}</span><span class="s2">%, Disk: </span><span class="si">{</span><span class="n">disk_percent</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤</span>
                <span class="k">if</span> <span class="n">cpu_percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;High CPU usage detected&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">memory_percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;High memory usage detected&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">disk_percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;High disk usage detected&quot;</span><span class="p">)</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resource monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retraining_process</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">retraining_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</span>
            <span class="k">if</span> <span class="n">elapsed_time</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_retraining_time&#39;</span><span class="p">,</span> <span class="mi">7200</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Retraining timeout exceeded&quot;</span><span class="p">)</span>
                <span class="n">retraining_process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
                <span class="k">break</span>

            <span class="c1"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retraining progress: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retraining_process</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">quality_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="k">while</span> <span class="n">retraining_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –º–µ—Ç—Ä–∏–∫</span>
                <span class="n">current_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_metrics</span><span class="p">()</span>

                <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span>
                <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">current_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">quality_metrics</span><span class="p">:</span>
                        <span class="n">quality_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–∞</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analyze_quality_trend</span><span class="p">(</span><span class="n">quality_metrics</span><span class="p">)</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quality monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>

<h2 id="_185">–û—Ç–∫–∞—Ç –º–æ–¥–µ–ª–µ–π</h2>
<h3 id="_186">–°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞—Ç–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ModelRollback</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞—Ç–∞ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rollback_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">rollback_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_versions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="n">backup_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">_backup_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">backup_path</span><span class="p">)</span>

            <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–µ—Ä—Å–∏–∏</span>
            <span class="n">version_info</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">backup_path</span><span class="p">,</span>
                <span class="s1">&#39;original_path&#39;</span><span class="p">:</span> <span class="n">model_path</span>
            <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">model_versions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">version_info</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model backup created: </span><span class="si">{</span><span class="n">backup_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">backup_path</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Backup creation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rollback_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target_version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># –û—Ç–∫–∞—Ç –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_versions</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No previous version available for rollback&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

                <span class="n">target_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_versions</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –û—Ç–∫–∞—Ç –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏</span>
                <span class="n">target_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_version_path</span><span class="p">(</span><span class="n">target_version</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">target_version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Version </span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
            <span class="n">current_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;current_model_path&#39;</span><span class="p">]</span>
            <span class="n">backup_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;backup_model_path&#39;</span><span class="p">]</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_backup</span><span class="p">(</span><span class="n">current_path</span><span class="p">)</span>

            <span class="c1"># –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">target_version</span><span class="p">,</span> <span class="n">current_path</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model rolled back to: </span><span class="si">{</span><span class="n">target_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model rollback failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_version_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –ø—É—Ç–∏ –∫ –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_versions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">version_id</span> <span class="ow">in</span> <span class="n">version</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">version</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<h2 id="_187">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 id="_188">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CompleteRetrainingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retraining_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>
        <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">])</span>

        <span class="c1"># –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_performance</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_data_drift</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitor_schedule</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
                <span class="n">performance</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_current_performance</span><span class="p">()</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏</span>
                <span class="k">if</span> <span class="n">performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;performance_threshold&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance degradation detected: </span><span class="si">{</span><span class="n">performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;performance_degradation&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1800</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_data_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–µ–π—Ñ–∞ –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">drift_score</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data_drift</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">drift_score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;drift_threshold&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data drift detected: </span><span class="si">{</span><span class="n">drift_score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;data_drift&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data drift monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
                <span class="n">last_retraining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_retraining_time</span><span class="p">()</span>
                <span class="n">days_since_retraining</span> <span class="o">=</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_retraining</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>

                <span class="k">if</span> <span class="n">days_since_retraining</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;retraining_interval&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Scheduled retraining triggered&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_retraining</span><span class="p">(</span><span class="s1">&#39;scheduled&#39;</span><span class="p">)</span>

                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schedule monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">trigger_retraining</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Triggering retraining: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span>
            <span class="n">backup_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_model_backup</span><span class="p">()</span>

            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_new_data</span><span class="p">()</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">new_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;target_column&#39;</span><span class="p">],</span>
                <span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_new&quot;</span>
            <span class="p">)</span>

            <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
            <span class="n">new_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

            <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_new_model</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">):</span>
                <span class="c1"># –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_new_model</span><span class="p">(</span><span class="n">new_predictor</span><span class="p">)</span>

                <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">retraining_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="n">reason</span><span class="p">,</span>
                    <span class="s1">&#39;backup_path&#39;</span><span class="p">:</span> <span class="n">backup_path</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span>
                <span class="p">})</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retraining completed successfully&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rollback_model</span><span class="p">(</span><span class="n">backup_path</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">retraining_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="n">reason</span><span class="p">,</span>
                    <span class="s1">&#39;backup_path&#39;</span><span class="p">:</span> <span class="n">backup_path</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failed&#39;</span>
                <span class="p">})</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Retraining failed, rolled back to previous version&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retraining failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># –û—Ç–∫–∞—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏</span>
            <span class="k">if</span> <span class="s1">&#39;backup_path&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rollback_model</span><span class="p">(</span><span class="n">backup_path</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_predictor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_test_data</span><span class="p">()</span>

            <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">new_predictions</span> <span class="o">=</span> <span class="n">new_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
            <span class="n">new_performance</span> <span class="o">=</span> <span class="n">new_predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

            <span class="c1"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª—å—é</span>
            <span class="n">current_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
            <span class="n">current_performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è</span>
            <span class="n">improvement</span> <span class="o">=</span> <span class="n">new_performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">improvement</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;improvement_threshold&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Insufficient improvement: </span><span class="si">{</span><span class="n">improvement</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π</span>
            <span class="k">if</span> <span class="n">new_performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;minimum_accuracy&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy below minimum: </span><span class="si">{</span><span class="n">new_performance</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">deploy_new_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_predictor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_current_service</span><span class="p">()</span>

            <span class="c1"># –ó–∞–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">new_predictor</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">],</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span> <span class="o">=</span> <span class="n">new_predictor</span>

            <span class="c1"># –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_updated_service</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;New model deployed successfully&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model deployment failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_model_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
        <span class="n">backup_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_backup_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">],</span> <span class="n">backup_path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">backup_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rollback_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backup_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">backup_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">],</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;model_path&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model rolled back to: </span><span class="si">{</span><span class="n">backup_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;model_path&#39;</span><span class="p">:</span> <span class="s1">&#39;./production_models&#39;</span><span class="p">,</span>
    <span class="s1">&#39;target_column&#39;</span><span class="p">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="s1">&#39;performance_threshold&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="s1">&#39;drift_threshold&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;retraining_interval&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>  <span class="c1"># –¥–Ω–∏</span>
    <span class="s1">&#39;improvement_threshold&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;minimum_accuracy&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
<span class="p">}</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">CompleteRetrainingSystem</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">system</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>

<h2 id="_189">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a><br />
- <a href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a><br />
- <a href="./10_troubleshooting.md">Troubleshooting</a></p>
<hr />
<h1 id="automl-gluon_7">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_190">–ü–æ—á–µ–º—É –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã</h2>
<p><strong>–ü–æ—á–µ–º—É 95% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –∏–∑-–∑–∞ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å", –∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, —Ç—Ä–µ–±—É—é—â–∞—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤.</p>
<h3 id="_191">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ø–ª–æ—Ö–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫</h3>
<ul>
<li><strong>Amazon AI-—Ä–µ–∫—Ä—É—Ç–∏–Ω–≥</strong>: –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>Microsoft Tay</strong>: –†–∞—Å–∏—Å—Ç—Å–∫–∏–µ —Ç–≤–∏—Ç—ã –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏</li>
<li><strong>Uber —Å–∞–º–æ—É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –∞–≤—Ç–æ</strong>: –°–º–µ—Ä—Ç—å –ø–µ—à–µ—Ö–æ–¥–∞ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
<li><strong>Facebook –∞–ª–≥–æ—Ä–∏—Ç–º</strong>: –ü–æ–ª—è—Ä–∏–∑–∞—Ü–∏—è –æ–±—â–µ—Å—Ç–≤–∞ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
</ul>
<h3 id="_192">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</h3>
<ul>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –õ–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Ä–æ—Å—Ç—É –Ω–∞–≥—Ä—É–∑–∫–∏</li>
<li><strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å</strong>: –ö–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É</li>
<li><strong>–≠—Ç–∏—á–Ω–æ—Å—Ç—å</strong>: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ</li>
</ul>
<h2 id="_193">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
<p><img alt="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" src="images/performance_comparison.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 7: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</em></p>
<p><img alt="–ê–Ω–∞–ª–∏–∑ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏" src="images/robustness_analysis.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 7.1: –ê–Ω–∞–ª–∏–∑ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç–∏ - —Ä–æ–±–∞—Å—Ç–Ω—ã–µ vs –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</em></p>
<p><strong>–ü–æ—á–µ–º—É –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "—Å–¥–µ–ª–∞—Ç—å —Ö–æ—Ä–æ—à–æ"?</strong> –≠—Ç–æ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –æ–ø—ã—Ç–µ —Ç—ã—Å—è—á –ø—Ä–æ–µ–∫—Ç–æ–≤. –≠—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã - –æ–Ω–∏ —Å–ø–∞—Å–∞—é—Ç –∂–∏–∑–Ω–∏.</p>
<p><strong>–ü–æ—á–µ–º—É 80% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–≤—Ç–æ—Ä—è—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –æ—à–∏–±–∫–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –∑–Ω–∞—é—Ç –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π:<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏</strong>: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, —É—Ç–µ—á–∫–∏, —Å–º–µ—â–µ–Ω–∏—è<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π</strong>: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º</strong>: –ù–µ–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã —Å —ç—Ç–∏–∫–æ–π</strong>: –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è, –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</p>
<p>–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ - —ç—Ç–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML Gluon, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ –¥–æ—Å—Ç–∏—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.</p>
<h2 id="_194">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
<h3 id="1_1">1. –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö</h3>
<p><strong>–ü–æ—á–µ–º—É "–º—É—Å–æ—Ä –Ω–∞ –≤—Ö–æ–¥–µ = –º—É—Å–æ—Ä –Ω–∞ –≤—ã—Ö–æ–¥–µ" –æ—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è ML?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –∏ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–ª–æ—Ö–∏–µ, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å –ø–ª–æ—Ö–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –≠—Ç–æ –∫–∞–∫ –æ–±—É—á–µ–Ω–∏–µ –≤—Ä–∞—á–∞ –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–∏–∞–≥–Ω–æ–∑–∞—Ö.</p>
<p><strong>–ü–æ—á–µ–º—É 60% –≤—Ä–µ–º–µ–Ω–∏ ML-–ø—Ä–æ–µ–∫—Ç–∞ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ "–≥—Ä—è–∑–Ω—ã–µ":<br />
- <strong>–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>: 30-50% –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏<br />
- <strong>–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</strong>: –û–ø–µ—á–∞—Ç–∫–∏, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã<br />
- <strong>–î—É–±–ª–∏–∫–∞—Ç—ã</strong>: –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö<br />
- <strong>–í—ã–±—Ä–æ—Å—ã</strong>: –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–∫–∞–∂–∞—é—Ç –º–æ–¥–µ–ª—å</p>
<p><strong>–¢–∏–ø—ã –ø—Ä–æ–±–ª–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏:</strong><br />
- <strong>–°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</strong>: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, —Ñ–æ—Ä–º–∞—Ç—ã<br />
- <strong>–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</strong>: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏<br />
- <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</strong>: –°–º–µ—â–µ–Ω–∏—è, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, –≤—ã–±—Ä–æ—Å—ã<br />
- <strong>–≠—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</strong>: –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è, –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç—å</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="k">def</span><span class="w"> </span><span class="nf">data_quality_check</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö - –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ —É—Å–ø–µ—à–Ω–æ–º—É ML&quot;&quot;&quot;</span>

    <span class="n">quality_report</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>                    <span class="c1"># –†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</span>
        <span class="s1">&#39;missing_values&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>  <span class="c1"># –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>
        <span class="s1">&#39;data_types&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>   <span class="c1"># –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="s1">&#39;duplicates&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>  <span class="c1"># –î—É–±–ª–∏–∫–∞—Ç—ã</span>
        <span class="s1">&#39;outliers&#39;</span><span class="p">:</span> <span class="p">{},</span>                         <span class="c1"># –í—ã–±—Ä–æ—Å—ã</span>
        <span class="s1">&#39;correlations&#39;</span><span class="p">:</span> <span class="p">{}</span>                      <span class="c1"># –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</span>
    <span class="p">}</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">missing_percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">quality_report</span><span class="p">[</span><span class="s1">&#39;missing_percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_percent</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
        <span class="n">outliers</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">)]</span>
        <span class="n">quality_report</span><span class="p">[</span><span class="s1">&#39;outliers&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numeric_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">numeric_columns</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
        <span class="n">quality_report</span><span class="p">[</span><span class="s1">&#39;correlations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">quality_report</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">quality_report</span> <span class="o">=</span> <span class="n">data_quality_check</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Quality Report:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">quality_report</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_1">2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
                <span class="c1"># –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –º–æ–¥–∞</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –º–µ–¥–∏–∞–Ω–∞</span>
                <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;drop&#39;</span><span class="p">:</span>
        <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;interpolate&#39;</span><span class="p">:</span>
        <span class="c1"># –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">train_data_clean</span> <span class="o">=</span> <span class="n">handle_missing_values</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="3_2">3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;iqr&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤&quot;&quot;&quot;</span>

    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;iqr&#39;</span><span class="p">:</span>
        <span class="c1"># –ú–µ—Ç–æ–¥ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–∞—Ö–∞</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
            <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
            <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>

            <span class="c1"># –ó–∞–º–µ–Ω–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;zscore&#39;</span><span class="p">:</span>
        <span class="c1"># –ú–µ—Ç–æ–¥ Z-—Å–∫–æ—Ä</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
            <span class="n">z_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">z_scores</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;winsorize&#39;</span><span class="p">:</span>
        <span class="c1"># –í–∏–Ω–∑–æ—Ä–∏–∑–∞—Ü–∏—è</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
            <span class="n">lower_percentile</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">upper_percentile</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_percentile</span><span class="p">,</span> <span class="n">lower_percentile</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_percentile</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">train_data_no_outliers</span> <span class="o">=</span> <span class="n">handle_outliers</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;iqr&#39;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_195">–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h2>
<h3 id="1_2">1. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_classification_metrics</span><span class="p">(</span><span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_balance</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;balanced&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">problem_type</span> <span class="o">==</span> <span class="s1">&#39;binary&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_balance</span> <span class="o">==</span> <span class="s1">&#39;balanced&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">data_balance</span> <span class="o">==</span> <span class="s1">&#39;imbalanced&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;balanced_accuracy&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">problem_type</span> <span class="o">==</span> <span class="s1">&#39;multiclass&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_balance</span> <span class="o">==</span> <span class="s1">&#39;balanced&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_micro&#39;</span><span class="p">,</span> <span class="s1">&#39;precision_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;recall_macro&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">data_balance</span> <span class="o">==</span> <span class="s1">&#39;imbalanced&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_micro&#39;</span><span class="p">,</span> <span class="s1">&#39;balanced_accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;precision_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;recall_macro&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_micro&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">]</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">select_classification_metrics</span><span class="p">(</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="s1">&#39;imbalanced&#39;</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="2_2">2. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_regression_metrics</span><span class="p">(</span><span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_distribution</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">target_distribution</span> <span class="o">==</span> <span class="s1">&#39;normal&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">target_distribution</span> <span class="o">==</span> <span class="s1">&#39;skewed&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="s1">&#39;smape&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">target_distribution</span> <span class="o">==</span> <span class="s1">&#39;outliers&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;huber_loss&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">]</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">select_regression_metrics</span><span class="p">(</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_196">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>
<h3 id="1_3">1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_hyperparameter_strategy</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="c1"># –ú–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç - –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}],</span>
            <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}],</span>
            <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}]</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="c1"># –°—Ä–µ–¥–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç - —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –ë–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç - —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">create_hyperparameter_strategy</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_3">2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize_training_time</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">available_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –º–æ–¥–µ–ª—å</span>
    <span class="n">time_per_model</span> <span class="o">=</span> <span class="n">available_time</span> <span class="o">/</span> <span class="mi">10</span>  <span class="c1"># 10 –º–æ–¥–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span>

    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="c1"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="n">time_per_model</span><span class="p">,</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="c1"># –£–º–µ—Ä–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="n">time_per_model</span><span class="p">,</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;medium_quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="n">time_per_model</span><span class="p">,</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">training_config</span> <span class="o">=</span> <span class="n">optimize_training_time</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="mi">3600</span><span class="p">)</span>  <span class="c1"># 1 —á–∞—Å</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="o">**</span><span class="n">training_config</span><span class="p">)</span>
</code></pre></div>

<h2 id="_197">–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 id="1_4">1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_validation_strategy</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                             <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;tabular&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;time_series&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;validation_strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;time_series_split&#39;</span><span class="p">,</span>
            <span class="s1">&#39;n_splits&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;test_size&#39;</span><span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;validation_strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;holdout&#39;</span><span class="p">,</span>
            <span class="s1">&#39;holdout_frac&#39;</span><span class="p">:</span> <span class="mf">0.3</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;validation_strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;kfold&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;validation_strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;kfold&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">validation_config</span> <span class="o">=</span> <span class="n">select_validation_strategy</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="o">**</span><span class="n">validation_config</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-">2. –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">perform_cross_validation</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                           <span class="n">n_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_folds</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">fold_results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">train_fold</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
        <span class="n">val_fold</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">fold_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">eval_metric</span>
        <span class="p">)</span>

        <span class="n">fold_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_fold</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">fold_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_fold</span><span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">fold_predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_fold</span><span class="p">)</span>

        <span class="n">fold_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span>
        <span class="p">})</span>

    <span class="c1"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
    <span class="n">all_metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">fold_results</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metric</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_metrics</span><span class="p">:</span>
                <span class="n">all_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">all_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
    <span class="n">cv_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">all_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">cv_results</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">),</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">cv_results</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">cv_results</span> <span class="o">=</span> <span class="n">perform_cross_validation</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cross-validation results:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">cv_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ¬± </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_198">–†–∞–±–æ—Ç–∞ —Å –∞–Ω—Å–∞–º–±–ª—è–º–∏</h2>
<h3 id="1_5">1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure_ensemble</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ—Å—Ç–æ–π –∞–Ω—Å–∞–º–±–ª—å</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;num_stack_levels&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="c1"># –£–º–µ—Ä–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;num_stack_levels&#39;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –°–ª–æ–∂–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;num_stack_levels&#39;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">ensemble_config</span> <span class="o">=</span> <span class="n">configure_ensemble</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="o">**</span><span class="n">ensemble_config</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_4">2. –ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">analyze_ensemble</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span>

    <span class="c1"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">()</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
    <span class="n">ensemble_analysis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;total_models&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">),</span>
        <span class="s1">&#39;best_model&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">],</span>
        <span class="s1">&#39;best_score&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;score_val&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_diversity&#39;</span><span class="p">:</span> <span class="n">calculate_model_diversity</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">),</span>
        <span class="s1">&#39;performance_gap&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;score_val&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">leaderboard</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;score_val&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ensemble_analysis</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_model_diversity</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–æ —Ç–∏–ø–∞–º –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">model_types</span> <span class="o">=</span> <span class="n">leaderboard</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">diversity</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_types</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaderboard</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">diversity</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">ensemble_analysis</span> <span class="o">=</span> <span class="n">analyze_ensemble</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ensemble Analysis:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">ensemble_analysis</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_199">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 id="1_6">1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize_resources</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">available_resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="n">num_cpus</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cpus&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">memory_limit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="n">num_cpus</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cpus&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">memory_limit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_cpus</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cpus&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
        <span class="n">memory_limit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">num_cpus</span><span class="p">,</span>
        <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="n">available_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gpus&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="n">memory_limit</span>
    <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">resources</span> <span class="o">=</span> <span class="n">optimize_resources</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;cpus&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;gpus&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">ag_args_fit</span><span class="o">=</span><span class="n">resources</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_5">2. –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure_parallelization</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="c1"># –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;parallel_folds&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;parallel_models&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="c1"># –£–º–µ—Ä–µ–Ω–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;parallel_folds&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;parallel_models&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –ü–æ–ª–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;parallel_folds&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;parallel_models&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">parallel_config</span> <span class="o">=</span> <span class="n">configure_parallelization</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ ag_args_fit</span>
</code></pre></div>

<h2 id="_200">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
<h3 id="1_7">1. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AutoGluonLogger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è AutoGluon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;autogluon.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_training_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training started: </span><span class="si">{</span><span class="n">data_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_training_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progress</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training progress: </span><span class="si">{</span><span class="n">progress</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_training_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training completed: </span><span class="si">{</span><span class="n">results</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> 
                      <span class="n">processing_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;input_data&#39;</span><span class="p">:</span> <span class="n">input_data</span><span class="p">,</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">prediction</span><span class="p">,</span>
            <span class="s1">&#39;processing_time&#39;</span><span class="p">:</span> <span class="n">processing_time</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction: </span><span class="si">{</span><span class="n">log_entry</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span>
        <span class="n">error_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">),</span>
            <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">context</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error_entry</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">AutoGluonLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">log_training_start</span><span class="p">({</span><span class="s1">&#39;data_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span> <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)})</span>
</code></pre></div>

<h3 id="2_6">2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PerformanceMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_system_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cpu_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(),</span>
            <span class="s1">&#39;memory_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;disk_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># –ù–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">initial_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_system_metrics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initial_metrics</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

        <span class="c1"># –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">final_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_system_metrics</span><span class="p">()</span>
        <span class="n">final_metrics</span><span class="p">[</span><span class="s1">&#39;training_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_metrics</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">final_metrics</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤</span>
        <span class="n">cpu_usage</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;cpu_percent&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="p">]</span>
        <span class="n">memory_usage</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;memory_percent&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;avg_cpu_usage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">),</span>
            <span class="s1">&#39;max_cpu_usage&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">),</span>
            <span class="s1">&#39;avg_memory_usage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">),</span>
            <span class="s1">&#39;max_memory_usage&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">),</span>
            <span class="s1">&#39;training_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;training_time&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">PerformanceMonitor</span><span class="p">()</span>
<span class="n">final_metrics</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">monitor_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">train_data</span><span class="p">)</span>
<span class="n">performance_analysis</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">analyze_performance</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance analysis: </span><span class="si">{</span><span class="n">performance_analysis</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_201">–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</h2>
<h3 id="1_8">1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">safe_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="s1">&#39;evaluate&#39;</span><span class="p">):</span>
            <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
                <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
                <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}</span>

    <span class="k">except</span> <span class="ne">MemoryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Memory error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;Reduce data size or increase memory&#39;</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Timeout error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;Increase time_limit or reduce model complexity&#39;</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Unexpected error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;Check data quality and parameters&#39;</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">safe_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training successful: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training failed: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Suggestion: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;suggestion&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_7">2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resilient_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                      <span class="n">fallback_strategies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–£—Å—Ç–æ–π—á–∏–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fallback_strategies</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –æ–±—É—á–µ–Ω–∏—è —Å —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π</span>
            <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">strategy</span><span class="p">)</span>

            <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span>
            <span class="k">if</span> <span class="n">validate_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strategy_used&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                    <span class="s1">&#39;strategy_config&#39;</span><span class="p">:</span> <span class="n">strategy</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;All strategies failed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;suggestions&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Check data quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Reduce model complexity&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Increase time limits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Use simpler algorithms&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>

<span class="c1"># Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</span>
<span class="n">fallback_strategies</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;best_quality&#39;</span><span class="p">,</span> <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;high_quality&#39;</span><span class="p">,</span> <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;medium_quality&#39;</span><span class="p">,</span> <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">900</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span> <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">resilient_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">fallback_strategies</span><span class="p">)</span>
</code></pre></div>

<h2 id="_202">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 id="1_9">1. –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize_for_production</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">target_size_mb</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏</span>
    <span class="n">current_size</span> <span class="o">=</span> <span class="n">get_model_size</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">current_size</span> <span class="o">&lt;=</span> <span class="n">target_size_mb</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;already_optimized&#39;</span><span class="p">,</span>
            <span class="s1">&#39;current_size&#39;</span><span class="p">:</span> <span class="n">current_size</span><span class="p">,</span>
            <span class="s1">&#39;target_size&#39;</span><span class="p">:</span> <span class="n">target_size_mb</span>
        <span class="p">}</span>

    <span class="c1"># –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span>
    <span class="n">optimization_strategies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;reduce_models&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;excluded_model_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;NN_TORCH&#39;</span><span class="p">],</span>
                <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;compress_models&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;save_space&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;compress&#39;</span><span class="p">:</span> <span class="kc">True</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;simplify_ensemble&#39;</span><span class="p">,</span>
            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;num_stack_levels&#39;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">optimization_strategies</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</span>
            <span class="n">optimized_predictor</span> <span class="o">=</span> <span class="n">apply_optimization_strategy</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞</span>
            <span class="n">optimized_size</span> <span class="o">=</span> <span class="n">get_model_size</span><span class="p">(</span><span class="n">optimized_predictor</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">optimized_size</span> <span class="o">&lt;=</span> <span class="n">target_size_mb</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;optimized&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="n">strategy</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;original_size&#39;</span><span class="p">:</span> <span class="n">current_size</span><span class="p">,</span>
                    <span class="s1">&#39;optimized_size&#39;</span><span class="p">:</span> <span class="n">optimized_size</span><span class="p">,</span>
                    <span class="s1">&#39;compression_ratio&#39;</span><span class="p">:</span> <span class="n">optimized_size</span> <span class="o">/</span> <span class="n">current_size</span>
                <span class="p">}</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimization strategy </span><span class="si">{</span><span class="n">strategy</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Could not achieve target size&#39;</span><span class="p">,</span>
        <span class="s1">&#39;suggestions&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Increase target size&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Use simpler algorithms&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Reduce training data&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Use model compression techniques&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">optimization_result</span> <span class="o">=</span> <span class="n">optimize_for_production</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">target_size_mb</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimization result: </span><span class="si">{</span><span class="n">optimization_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_8">2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionCache</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö—ç—à –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_size</span> <span class="o">=</span> <span class="n">cache_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="n">data_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data_str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–∑ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_cache_key</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –∫—ç—à&quot;&quot;&quot;</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_cache_key</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_size</span><span class="p">:</span>
            <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–∏–º–µ–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞</span>
            <span class="n">least_used_key</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">least_used_key</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="p">[</span><span class="n">least_used_key</span><span class="p">]</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_cache_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cache_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">),</span>
            <span class="s1">&#39;max_cache_size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_size</span><span class="p">,</span>
            <span class="s1">&#39;hit_rate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_hit_rate</span><span class="p">(),</span>
            <span class="s1">&#39;most_accessed&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_hit_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç hit rate –∫—ç—à–∞&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="n">total_accesses</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_count</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">cache_hits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cache_hits</span> <span class="o">/</span> <span class="n">total_accesses</span> <span class="k">if</span> <span class="n">total_accesses</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">PredictionCache</span><span class="p">(</span><span class="n">cache_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cached_predict</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ&quot;&quot;&quot;</span>
    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞</span>
    <span class="n">cached_prediction</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_prediction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cached_prediction</span>

    <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">]))</span>

    <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">set_prediction</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prediction</span>
</code></pre></div>

<h2 id="_203">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a><br />
- <a href="./10_troubleshooting.md">Troubleshooting</a></p>
<hr />
<h1 id="automl-gluon_8">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_204">–ü–æ—á–µ–º—É –ø—Ä–∏–º–µ—Ä—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã</h2>
<p><strong>–ü–æ—á–µ–º—É 90% —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –ø—Ä–∏–º–µ—Ä–æ–≤, –∞ –Ω–µ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏–º–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ —Ç–µ–æ—Ä–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –≠—Ç–æ –∫–∞–∫ –æ–±—É—á–µ–Ω–∏–µ –≤–æ–∂–¥–µ–Ω–∏—é - —Å–Ω–∞—á–∞–ª–∞ —Å–º–æ—Ç—Ä–∏—à—å, –∫–∞–∫ –µ–∑–¥—è—Ç –¥—Ä—É–≥–∏–µ.</p>
<h3 id="_205">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤</h3>
<ul>
<li><strong>–î–æ–ª–≥–æ–µ –∏–∑—É—á–µ–Ω–∏–µ</strong>: –ú–µ—Å—è—Ü—ã –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</li>
<li><strong>–û—à–∏–±–∫–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</strong>: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API</li>
<li><strong>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</strong>: –ò–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞</li>
<li><strong>–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ</strong>: –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—É–≥–∏–≤–∞–µ—Ç –Ω–æ–≤–∏—á–∫–æ–≤</li>
</ul>
<h3 id="_206">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ö–æ—Ä–æ—à–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤</h3>
<ul>
<li><strong>–ë—ã—Å—Ç—Ä–æ–µ —Å—Ç–∞—Ä—Ç</strong>: –û—Ç –∏–¥–µ–∏ –¥–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –∫–æ–¥–∞ –∑–∞ —á–∞—Å—ã</li>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</strong>: –ò–∑—É—á–µ–Ω–∏–µ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö</li>
<li><strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</li>
<li><strong>–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ</strong>: –ò–¥–µ–∏ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</li>
</ul>
<h2 id="_207">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–∏–º–µ—Ä—ã</h2>
<p><img alt="Monte Carlo –∞–Ω–∞–ª–∏–∑" src="images/monte_carlo_analysis.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 8.1: Monte Carlo –∞–Ω–∞–ª–∏–∑ - —Ä–æ–±–∞—Å—Ç–Ω—ã–µ vs –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏, risk-return –ø—Ä–æ—Ñ–∏–ª—å</em></p>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–∏–º–µ—Ä—ã - —ç—Ç–æ —è–∑—ã–∫ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–µ—Ä–µ–≤–æ–¥—è—Ç —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ —á–∏—Å–ª–∞. –≠—Ç–æ –∫–∞–∫ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ –º–µ–∂–¥—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –∏ –±–∏–∑–Ω–µ—Å-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.</p>
<p><strong>–¢–∏–ø—ã –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ AutoML Gluon:</strong><br />
- <strong>–ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã</strong>: –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ—Å–Ω–æ–≤<br />
- <strong>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã</strong>: –°–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br />
- <strong>–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</strong>: –ü–æ–ª–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á<br />
- <strong>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã</strong>: –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (–º–µ–¥–∏—Ü–∏–Ω–∞, —Ñ–∏–Ω–∞–Ω—Å—ã)</p>
<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML Gluon –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–¥, –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.</p>
<h2 id="1_10">–ü—Ä–∏–º–µ—Ä 1: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞</h2>
<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä ML –≤ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö - –ø–æ–Ω—è—Ç–Ω—ã–π, –≤–∞–∂–Ω—ã–π –∏ —Å —á–µ—Ç–∫–∏–º–∏ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∞–º–∏.</p>
<h3 id="_208">–ó–∞–¥–∞—á–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–∞ —Ç–∞–∫ –≤–∞–∂–Ω–æ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å –±–∞–Ω–∫—É –º–∏–ª–ª–∏–æ–Ω—ã –¥–æ–ª–ª–∞—Ä–æ–≤. –≠—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –Ω–æ –¥–ª—è –¥–µ–Ω–µ–≥.</p>
<p>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–µ—Ñ–æ–ª—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –±–∞–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.</p>
<p><strong>–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç:</strong><br />
- <strong>–¶–µ–ª—å</strong>: –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ—Ä–∏ –æ—Ç –ø–ª–æ—Ö–∏—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤<br />
- <strong>–ú–µ—Ç—Ä–∏–∫–∞</strong>: ROC-AUC (–≤–∞–∂–Ω–µ–µ —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)<br />
- <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏</strong>: –õ–æ–∂–Ω—ã–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Ä–æ–∂–µ –ª–æ–∂–Ω–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ<br />
- <strong>–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö</strong>: –û–±—ã—á–Ω–æ 100K-1M –∑–∞–ø–∏—Å–µ–π</p>
<h3 id="_209">–î–∞–Ω–Ω—ã–µ</h3>
<p><strong>–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_bank_data</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö - –∏–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
        <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>        <span class="c1"># –†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏</span>
        <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>             <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">n_informative</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>          <span class="c1"># –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–≤–∞–∂–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è)</span>
        <span class="n">n_redundant</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>             <span class="c1"># –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)</span>
        <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>               <span class="c1"># –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–¥–µ—Ñ–æ–ª—Ç/–Ω–µ –¥–µ—Ñ–æ–ª—Ç)</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>            <span class="c1"># –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
    <span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame —Å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="s1">&#39;debt_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;employment_years&#39;</span><span class="p">,</span>
        <span class="s1">&#39;loan_amount&#39;</span><span class="p">,</span> <span class="s1">&#39;interest_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;payment_history&#39;</span><span class="p">,</span> <span class="s1">&#39;savings_balance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;investment_value&#39;</span><span class="p">,</span> <span class="s1">&#39;credit_cards&#39;</span><span class="p">,</span> <span class="s1">&#39;late_payments&#39;</span><span class="p">,</span> <span class="s1">&#39;bankruptcies&#39;</span><span class="p">,</span>
        <span class="s1">&#39;foreclosures&#39;</span><span class="p">,</span> <span class="s1">&#39;collections&#39;</span><span class="p">,</span> <span class="s1">&#39;inquiries&#39;</span><span class="p">,</span> <span class="s1">&#39;credit_utilization&#39;</span><span class="p">,</span>
        <span class="s1">&#39;account_age&#39;</span><span class="p">,</span> <span class="s1">&#39;payment_frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;credit_mix&#39;</span>
    <span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;default_risk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

    <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;employment_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;employed&#39;</span><span class="p">,</span> <span class="s1">&#39;unemployed&#39;</span><span class="p">,</span> <span class="s1">&#39;self_employed&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;high_school&#39;</span><span class="p">,</span> <span class="s1">&#39;bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="s1">&#39;phd&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;marital_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;married&#39;</span><span class="p">,</span> <span class="s1">&#39;divorced&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;application_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">bank_data</span> <span class="o">=</span> <span class="n">create_bank_data</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bank data shape:&quot;</span><span class="p">,</span> <span class="n">bank_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default rate:&quot;</span><span class="p">,</span> <span class="n">bank_data</span><span class="p">[</span><span class="s1">&#39;default_risk&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div>

<h3 id="_210">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_bank_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;debt_to_income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;debt_ratio&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;credit_utilization_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;credit_utilization&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;credit_score&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;payment_stability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;payment_history&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;late_payments&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;default_risk&#39;</span><span class="p">:</span>
            <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
            <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">bank_data_processed</span> <span class="o">=</span> <span class="n">prepare_bank_data</span><span class="p">(</span><span class="n">bank_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_211">–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_bank_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
    <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;default_risk&#39;</span><span class="p">])</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;default_risk&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./bank_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∑–∞–¥–∞—á–∏</span>
    <span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
                <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;l2_leaf_reg&#39;</span><span class="p">:</span> <span class="mf">3.0</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">bank_predictor</span><span class="p">,</span> <span class="n">bank_test_data</span> <span class="o">=</span> <span class="n">train_bank_model</span><span class="p">(</span><span class="n">bank_data_processed</span><span class="p">)</span>
</code></pre></div>

<h3 id="_212">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_bank_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>

    <span class="c1"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span><span class="p">,</span>
        <span class="s1">&#39;leaderboard&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="p">,</span>
        <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
        <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="n">probabilities</span>
    <span class="p">}</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">bank_results</span> <span class="o">=</span> <span class="n">evaluate_bank_model</span><span class="p">(</span><span class="n">bank_predictor</span><span class="p">,</span> <span class="n">bank_test_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bank Model Performance:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bank_results</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top 10 Feature Importance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bank_results</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div>

<h3 id="_213">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_bank_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># ROC –∫—Ä–∏–≤–∞—è</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
    <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default_risk&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;probabilities&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC AUC = </span><span class="si">{</span><span class="n">roc_auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Precision-Recall –∫—Ä–∏–≤–∞—è</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_recall_curve</span>
    <span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default_risk&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;probabilities&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Recall&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precision&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Precision-Recall Curve&#39;</span><span class="p">)</span>

    <span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 10 Feature Importance&#39;</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;probabilities&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Default Probability&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Default Probabilities&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span class="n">visualize_bank_results</span><span class="p">(</span><span class="n">bank_results</span><span class="p">,</span> <span class="n">bank_test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="2_9">–ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</h2>
<h3 id="_214">–ó–∞–¥–∞—á–∞</h3>
<p>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ–±—ä–µ–∫—Ç–∞.</p>
<h3 id="_215">–î–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_real_estate_data</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;bedrooms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;bathrooms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;garage&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;pool&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">),</span>
        <span class="s1">&#39;garden&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="c1"># –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;downtown&#39;</span><span class="p">,</span> <span class="s1">&#39;suburbs&#39;</span><span class="p">,</span> <span class="s1">&#39;rural&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;property_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;house&#39;</span><span class="p">,</span> <span class="s1">&#39;apartment&#39;</span><span class="p">,</span> <span class="s1">&#39;townhouse&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;excellent&#39;</span><span class="p">,</span> <span class="s1">&#39;good&#39;</span><span class="p">,</span> <span class="s1">&#39;fair&#39;</span><span class="p">,</span> <span class="s1">&#39;poor&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (—Ü–µ–Ω–∞)</span>
    <span class="n">base_price</span> <span class="o">=</span> <span class="mi">100000</span>
    <span class="n">price</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_price</span> <span class="o">+</span> 
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bedrooms&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10000</span> <span class="o">+</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bathrooms&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5000</span> <span class="o">+</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;garage&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">15000</span> <span class="o">+</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pool&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25000</span> <span class="o">+</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;garden&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10000</span> <span class="o">-</span>
             <span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2000</span><span class="p">)</span>

    <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞</span>
    <span class="n">price</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="mi">50000</span><span class="p">)</span>  <span class="c1"># –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">real_estate_data</span> <span class="o">=</span> <span class="n">create_real_estate_data</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Real estate data shape:&quot;</span><span class="p">,</span> <span class="n">real_estate_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Price statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">real_estate_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div>

<h3 id="_216">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_real_estate_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area_per_bedroom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;bedrooms&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_rooms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bedrooms&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bathrooms&#39;</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;age_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;recent&#39;</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="s1">&#39;very_old&#39;</span><span class="p">])</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">real_estate_processed</span> <span class="o">=</span> <span class="n">prepare_real_estate_data</span><span class="p">(</span><span class="n">real_estate_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_217">–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_real_estate_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
    <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./real_estate_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span>
    <span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
                <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">real_estate_predictor</span><span class="p">,</span> <span class="n">real_estate_test_data</span> <span class="o">=</span> <span class="n">train_real_estate_model</span><span class="p">(</span><span class="n">real_estate_processed</span><span class="p">)</span>
</code></pre></div>

<h3 id="_218">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_real_estate_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>

    <span class="c1"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">predictions</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">errors</span> <span class="o">/</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span><span class="p">,</span>
        <span class="s1">&#39;leaderboard&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="p">,</span>
        <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
        <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="n">errors</span>
    <span class="p">}</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">real_estate_results</span> <span class="o">=</span> <span class="n">evaluate_real_estate_model</span><span class="p">(</span><span class="n">real_estate_predictor</span><span class="p">,</span> <span class="n">real_estate_test_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Real Estate Model Performance:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">real_estate_results</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">MAE: </span><span class="si">{</span><span class="n">real_estate_results</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">real_estate_results</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_219">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_real_estate_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> 
                   <span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Actual Price&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Price&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Predictions vs Actual&#39;</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction Error&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Prediction Errors&#39;</span><span class="p">)</span>

    <span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 10 Feature Importance&#39;</span><span class="p">)</span>

    <span class="c1"># –û—à–∏–±–∫–∏ –ø–æ —Ü–µ–Ω–µ</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Actual Price&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Prediction Error&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Errors by Price Range&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span class="n">visualize_real_estate_results</span><span class="p">(</span><span class="n">real_estate_results</span><span class="p">,</span> <span class="n">real_estate_test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="3_3">–ü—Ä–∏–º–µ—Ä 3: –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h2>
<h3 id="_220">–ó–∞–¥–∞—á–∞</h3>
<p>–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
<h3 id="_221">–î–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_sales_data</span><span class="p">(</span><span class="n">n_days</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">n_products</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö&quot;&quot;&quot;</span>

    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n_days</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">product_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_products</span><span class="p">):</span>
        <span class="c1"># –ë–∞–∑–æ–≤—ã–π —Ç—Ä–µ–Ω–¥</span>
        <span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">n_days</span><span class="p">)</span>

        <span class="c1"># –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è)</span>
        <span class="n">seasonality</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_days</span><span class="p">)</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>

        <span class="c1"># –°–ª—É—á–∞–π–Ω—ã–π —à—É–º</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_days</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–¥–∞–∂–∏</span>
        <span class="n">sales</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>
        <span class="n">sales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">sales</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">sale</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">sales</span><span class="p">)):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
                <span class="s1">&#39;product_id&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;product_</span><span class="si">{</span><span class="n">product_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sales&#39;</span><span class="p">:</span> <span class="n">sale</span><span class="p">,</span>
                <span class="s1">&#39;day_of_week&#39;</span><span class="p">:</span> <span class="n">date</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">,</span>
                <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                <span class="s1">&#39;quarter&#39;</span><span class="p">:</span> <span class="n">date</span><span class="o">.</span><span class="n">quarter</span>
            <span class="p">})</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">sales_data</span> <span class="o">=</span> <span class="n">create_sales_data</span><span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sales data shape:&quot;</span><span class="p">,</span> <span class="n">sales_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sales statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div>

<h3 id="_222">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_sales_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ª–∞–≥–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;product_id&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sales_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;product_id&#39;</span><span class="p">)[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

    <span class="c1"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ</span>
    <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sales_ma_</span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;product_id&#39;</span><span class="p">)[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># –¢—Ä–µ–Ω–¥—ã</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sales_trend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;product_id&#39;</span><span class="p">)[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># –°–µ–∑–æ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_month_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_month_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">sales_processed</span> <span class="o">=</span> <span class="n">prepare_sales_data</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_223">–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_sales_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π –¥–ª—è —Ç–µ—Å—Ç–∞)</span>
    <span class="n">split_date</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">split_date</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">split_date</span><span class="p">]</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./sales_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
    <span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
                <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">sales_predictor</span><span class="p">,</span> <span class="n">sales_test_data</span> <span class="o">=</span> <span class="n">train_sales_model</span><span class="p">(</span><span class="n">sales_processed</span><span class="p">)</span>
</code></pre></div>

<h3 id="_224">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_sales_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</span>
    <span class="n">product_performance</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">product_id</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">product_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">]</span>
        <span class="n">product_predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">]</span>

        <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">product_predictions</span><span class="p">))</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">product_predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="n">product_performance</span><span class="p">[</span><span class="n">product_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span><span class="p">,</span>
        <span class="s1">&#39;product_performance&#39;</span><span class="p">:</span> <span class="n">product_performance</span><span class="p">,</span>
        <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span>
    <span class="p">}</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">sales_results</span> <span class="o">=</span> <span class="n">evaluate_sales_model</span><span class="p">(</span><span class="n">sales_predictor</span><span class="p">,</span> <span class="n">sales_test_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sales Model Performance:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sales_results</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Product Performance:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">perf</span> <span class="ow">in</span> <span class="n">sales_results</span><span class="p">[</span><span class="s1">&#39;product_performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2">: MAE=</span><span class="si">{</span><span class="n">perf</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, MAPE=</span><span class="si">{</span><span class="n">perf</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_225">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_sales_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–¥–∞–∂&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞</span>
    <span class="n">product_id</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">product_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">]</span>
    <span class="n">product_predictions</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">][</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;product_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">product_id</span><span class="p">]</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">product_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">product_predictions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sales Forecast for </span><span class="si">{</span><span class="n">product_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction Error&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Prediction Errors&#39;</span><span class="p">)</span>

    <span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 10 Feature Importance&#39;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</span>
    <span class="n">products</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;product_performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">maes</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;product_performance&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">][</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span><span class="p">]</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">maes</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MAE&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Performance by Product&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span class="n">visualize_sales_results</span><span class="p">(</span><span class="n">sales_results</span><span class="p">,</span> <span class="n">sales_test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="4">–ü—Ä–∏–º–µ—Ä 4: –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
<h3 id="_226">–ó–∞–¥–∞—á–∞</h3>
<p>–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>
<h3 id="_227">–î–∞–Ω–Ω—ã–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_image_data</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤</span>
    <span class="n">n_classes</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;tree&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">)]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>

    <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;image_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;color_channels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;resolution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">create_image_data</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image data shape:&quot;</span><span class="p">,</span> <span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</code></pre></div>

<h3 id="_228">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_image_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;color_channels&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">image_processed</span> <span class="o">=</span> <span class="n">prepare_image_data</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_229">–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_image_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
    <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./image_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
    <span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
                <span class="s1">&#39;feature_fraction&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                <span class="s1">&#39;bagging_fraction&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;min_data_in_leaf&#39;</span><span class="p">:</span> <span class="mi">20</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">image_predictor</span><span class="p">,</span> <span class="n">image_test_data</span> <span class="o">=</span> <span class="n">train_image_model</span><span class="p">(</span><span class="n">image_processed</span><span class="p">)</span>
</code></pre></div>

<h3 id="_230">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_image_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span>

    <span class="c1"># –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">leaderboard</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">leaderboard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–ª–∞—Å—Å–∞–º</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>

    <span class="n">class_report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="n">performance</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span><span class="p">,</span>
        <span class="s1">&#39;leaderboard&#39;</span><span class="p">:</span> <span class="n">leaderboard</span><span class="p">,</span>
        <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
        <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="n">probabilities</span><span class="p">,</span>
        <span class="s1">&#39;classification_report&#39;</span><span class="p">:</span> <span class="n">class_report</span><span class="p">,</span>
        <span class="s1">&#39;confusion_matrix&#39;</span><span class="p">:</span> <span class="n">conf_matrix</span>
    <span class="p">}</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">image_results</span> <span class="o">=</span> <span class="n">evaluate_image_model</span><span class="p">(</span><span class="n">image_predictor</span><span class="p">,</span> <span class="n">image_test_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image Model Performance:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">image_results</span><span class="p">[</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">image_results</span><span class="p">[</span><span class="s1">&#39;classification_report&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_231">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visualize_image_results</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="c1"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;confusion_matrix&#39;</span><span class="p">],</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>

    <span class="c1"># –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 15 Feature Importance&#39;</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
    <span class="n">prediction_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">prediction_counts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Predictions&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

    <span class="c1"># –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∞—Å—Å–∞–º</span>
    <span class="n">class_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">class_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_name</span><span class="p">]</span>
        <span class="n">class_predictions</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">][</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_name</span><span class="p">]</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">class_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_predictions</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">class_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">class_accuracy</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Accuracy by Class&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span class="n">visualize_image_results</span><span class="p">(</span><span class="n">image_results</span><span class="p">,</span> <span class="n">image_test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="5">–ü—Ä–∏–º–µ—Ä 5: –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º–∞</h2>
<h3 id="_232">–ü–æ–ª–Ω–∞—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">fastapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">HTTPException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aiohttp</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;AutoML Gluon Production API&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">)</span>

<span class="c1"># –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">model_metadata</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionRequest</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PredictionResponse</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">predictions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
    <span class="n">probabilities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">model_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ModelInfo</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">performance</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="n">features</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="nb">str</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">on_event</span><span class="p">(</span><span class="s2">&quot;startup&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load_models</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">models</span><span class="p">,</span> <span class="n">model_metadata</span>

    <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">models</span><span class="p">[</span><span class="s1">&#39;bank_default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./bank_models&#39;</span><span class="p">)</span>
        <span class="n">model_metadata</span><span class="p">[</span><span class="s1">&#39;bank_default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="s1">&#39;binary_classification&#39;</span><span class="p">,</span>
            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;default_risk&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;credit_score&#39;</span><span class="p">,</span> <span class="s1">&#39;debt_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;employment_years&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bank model loaded successfully&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load bank model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">models</span><span class="p">[</span><span class="s1">&#39;real_estate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./real_estate_models&#39;</span><span class="p">)</span>
        <span class="n">model_metadata</span><span class="p">[</span><span class="s1">&#39;real_estate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;model_type&#39;</span><span class="p">:</span> <span class="s1">&#39;regression&#39;</span><span class="p">,</span>
            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;bedrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;bathrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Real estate model loaded successfully&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load real estate model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/health&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Health check endpoint&quot;&quot;&quot;</span>
    <span class="n">loaded_models</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">if</span> <span class="n">loaded_models</span> <span class="k">else</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loaded_models&quot;</span><span class="p">:</span> <span class="n">loaded_models</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    <span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/predict&quot;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">PredictionResponse</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">PredictionRequest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">model_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">model_name</span><span class="p">]</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">model_metadata</span><span class="p">[</span><span class="n">request</span><span class="o">.</span><span class="n">model_name</span><span class="p">]</span>

        <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="n">proba</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PredictionResponse</span><span class="p">(</span>
            <span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">probabilities</span><span class="o">=</span><span class="n">probabilities</span><span class="p">,</span>
            <span class="n">model_info</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
                <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">],</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span>
                <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/models&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_models</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;models&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">model_metadata</span>
    <span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/models/</span><span class="si">{model_name}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_model_info</span><span class="p">(</span><span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">model_metadata</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;model_type&#39;</span><span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">],</span>
        <span class="s2">&quot;performance&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="n">f</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]}]))</span>
    <span class="p">}</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">uvicorn</span>
    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
</code></pre></div>

<h3 id="_233">–ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_production_api</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω API&quot;&quot;&quot;</span>

    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8000&quot;</span>

    <span class="c1"># Health check</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/health&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Health check:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

    <span class="c1"># –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/models&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available models:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

    <span class="c1"># –¢–µ—Å—Ç –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –º–æ–¥–µ–ª–∏</span>
    <span class="n">bank_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;bank_default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
                <span class="s2">&quot;income&quot;</span><span class="p">:</span> <span class="mi">50000</span><span class="p">,</span>
                <span class="s2">&quot;credit_score&quot;</span><span class="p">:</span> <span class="mi">750</span><span class="p">,</span>
                <span class="s2">&quot;debt_ratio&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
                <span class="s2">&quot;employment_years&quot;</span><span class="p">:</span> <span class="mi">5</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/predict&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">bank_data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bank prediction:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

    <span class="c1"># –¢–µ—Å—Ç –º–æ–¥–µ–ª–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</span>
    <span class="n">real_estate_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;real_estate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
                <span class="s2">&quot;bedrooms&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;bathrooms&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;downtown&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/predict&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">real_estate_data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Real estate prediction:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test_production_api</span><span class="p">()</span>
</code></pre></div>

<h2 id="_234">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./10_troubleshooting.md">Troubleshooting</a><br />
- <a href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a></p>
<hr />
<h1 id="troubleshooting-automl-gluon">Troubleshooting AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="troubleshooting">–ü–æ—á–µ–º—É troubleshooting –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>
<p><strong>–ü–æ—á–µ–º—É 80% –≤—Ä–µ–º–µ–Ω–∏ ML-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ —Å–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –≥–¥–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ. –≠—Ç–æ –∫–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è - –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, –≥–¥–µ –∏—Å–∫–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É.</p>
<h3 id="_235">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ—Ä–µ—à–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º</h3>
<ul>
<li><strong>–ü–æ—Ç–µ—Ä—è –≤—Ä–µ–º–µ–Ω–∏</strong>: –î–Ω–∏ –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º</li>
<li><strong>–§—Ä—É—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã</strong>: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±—Ä–æ—Å–∞—é—Ç –ø—Ä–æ–µ–∫—Ç</li>
<li><strong>–ü–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è</strong>: –ó–∞–∫–∞–∑—á–∏–∫–∏ —Ç–µ—Ä—è—é—Ç –≤–µ—Ä—É –≤ ML</li>
</ul>
<h3 id="troubleshooting_1">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ troubleshooting</h3>
<ul>
<li><strong>–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ</strong>: –ó–Ω–∞–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–π</li>
<li><strong>–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞</strong>: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –¥–æ –∏—Ö –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è</li>
<li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –º–µ–Ω—å—à–µ –Ω–∞ –æ—Ç–ª–∞–¥–∫—É</li>
<li><strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ö–æ–º–∞–Ω–¥–∞ –∑–Ω–∞–µ—Ç, –∫–∞–∫ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</li>
</ul>
<h2 id="troubleshooting_2">–í–≤–µ–¥–µ–Ω–∏–µ –≤ troubleshooting</h2>
<p><img alt="Troubleshooting –±–ª–æ–∫-—Å—Ö–µ–º–∞" src="images/troubleshooting_flowchart.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 8: –ë–ª–æ–∫-—Å—Ö–µ–º–∞ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º AutoML Gluon</em></p>
<p><strong>–ü–æ—á–µ–º—É troubleshooting - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ, –∞ –Ω–µ –Ω–∞—É–∫–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —É–Ω–∏–∫–∞–ª—å–Ω–∞, –Ω–æ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è. –≠—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ - —Å–∏–º–ø—Ç–æ–º—ã –ø–æ—Ö–æ–∂–∏, –Ω–æ –ø—Ä–∏—á–∏–Ω—ã —Ä–∞–∑–Ω—ã–µ.</p>
<p><strong>–¢–∏–ø—ã –ø—Ä–æ–±–ª–µ–º –≤ AutoML Gluon:</strong><br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏</strong>: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≤–µ—Ä—Å–∏–∏ Python<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã –¥–∞–Ω–Ω—ã—Ö</strong>: –§–æ—Ä–º–∞—Ç—ã, —Ä–∞–∑–º–µ—Ä—ã, –∫–∞—á–µ—Å—Ç–≤–æ<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong>: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –Ω–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏<br />
- <strong>–ü—Ä–æ–±–ª–µ–º—ã –º–æ–¥–µ–ª–µ–π</strong>: –ü–ª–æ—Ö–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</p>
<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å AutoML Gluon, –∏ —Å–ø–æ—Å–æ–±—ã –∏—Ö —Ä–µ—à–µ–Ω–∏—è. –ö–∞–∂–¥–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏ –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é.</p>
<h2 id="_236">–ü—Ä–æ–±–ª–µ–º—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h2>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ - —Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –≤ ML?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ ML-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–º–µ—é—Ç —Å–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–æ–±–æ–π. –≠—Ç–æ –∫–∞–∫ –ø–∞–∑–ª, –≥–¥–µ –∫–∞–∂–¥–∞—è –¥–µ—Ç–∞–ª—å –¥–æ–ª–∂–Ω–∞ —Ç–æ—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç—å.</p>
<h3 id="1_11">1. –û—à–∏–±–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h3>
<p><strong>–ü–æ—á–µ–º—É –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π —Ç–∞–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –ø–∞–∫–µ—Ç–æ–≤. –≠—Ç–æ –∫–∞–∫ –ø–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.</p>
<h4 id="_237">–ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π –ø–∞–∫–µ—Ç–æ–≤</h4>
<div class="codehilite"><pre><span></span><code>ERROR:<span class="w"> </span>pip<span class="err">&#39;</span>s<span class="w"> </span>dependency<span class="w"> </span>resolver<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>currently<span class="w"> </span>take<span class="w"> </span>into<span class="w"> </span>account<span class="w"> </span>all<span class="w"> </span>the<span class="w"> </span>packages<span class="w"> </span>that<span class="w"> </span>are<span class="w"> </span>installed.
This<span class="w"> </span>behaviour<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span><span class="nb">source</span><span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>dependency<span class="w"> </span>conflicts.
</code></pre></div>

<p><strong>–ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —ç—Ç–∞ –æ—à–∏–±–∫–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ pip –ø—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –≠—Ç–æ –∫–∞–∫ –ø–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ Windows –∏ Linux.</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è - –∏–∑–æ–ª—è—Ü–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>autogluon<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
conda<span class="w"> </span>activate<span class="w"> </span>autogluon

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ - —Å–Ω–∞—á–∞–ª–∞ –±–∞–∑–æ–≤—ã–µ, –ø–æ—Ç–æ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ</span>
pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
pip<span class="w"> </span>install<span class="w"> </span>autogluon

<span class="c1"># –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≤–µ—Ä—Å–∏–π - —Ñ–∏–∫—Å–∞—Ü–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π</span>
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">autogluon</span><span class="o">==</span><span class="m">0</span>.8.2
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">torch</span><span class="o">==</span><span class="m">1</span>.13.1
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">torchvision</span><span class="o">==</span><span class="m">0</span>.14.1
</code></pre></div>

<h4 id="cuda_1">–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ CUDA</h4>
<div class="codehilite"><pre><span></span><code>RuntimeError:<span class="w"> </span>CUDA<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>memory
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CUDA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CUDA available: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CUDA version: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">cuda</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ PyTorch</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">torch</span><span class="o">==</span><span class="mf">1.13.1</span><span class="o">+</span><span class="n">cu117</span> <span class="n">torchvision</span><span class="o">==</span><span class="mf">0.14.1</span><span class="o">+</span><span class="n">cu117</span> <span class="o">--</span><span class="n">extra</span><span class="o">-</span><span class="n">index</span><span class="o">-</span><span class="n">url</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">pytorch</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">whl</span><span class="o">/</span><span class="n">cu117</span>

<span class="c1"># –ò–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_VISIBLE_DEVICES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</code></pre></div>

<h3 id="2_10">2. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é</h3>
<h4 id="out-of-memory">–ü—Ä–æ–±–ª–µ–º–∞: Out of memory</h4>
<div class="codehilite"><pre><span></span><code>MemoryError:<span class="w"> </span>Unable<span class="w"> </span>to<span class="w"> </span>allocate<span class="w"> </span>array
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>
<span class="n">ag</span><span class="o">.</span><span class="n">set_config</span><span class="p">({</span><span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>  <span class="c1"># 4GB</span>

<span class="c1"># –ò–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;AUTOGLUON_MEMORY_LIMIT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>

<span class="c1"># –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 50% –¥–∞–Ω–Ω—ã—Ö</span>
</code></pre></div>

<h2 id="_238">–ü—Ä–æ–±–ª–µ–º—ã –æ–±—É—á–µ–Ω–∏—è</h2>
<h3 id="1_12">1. –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<h4 id="_239">–ü—Ä–æ–±–ª–µ–º–∞: –û–±—É—á–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç –¥–ª—è —Ç–µ—Å—Ç–∞</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training time: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>  <span class="c1"># –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
    <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>  <span class="c1"># 10 –º–∏–Ω—É—Ç</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># –ú–µ–Ω—å—à–µ —Ñ–æ–ª–¥–æ–≤</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ CPU</span>
        <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">4</span>  <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="2_11">2. –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏</h3>
<h4 id="_240">–ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data shape:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing values:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data types:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
    <span class="k">if</span> <span class="s1">&#39;target&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target distribution:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å</span>
        <span class="n">target_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">imbalance_ratio</span> <span class="o">=</span> <span class="n">target_counts</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">target_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Imbalance ratio: </span><span class="si">{</span><span class="n">imbalance_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">imbalance_ratio</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Severe class imbalance detected&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">diagnose_data_quality</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="k">def</span><span class="w"> </span><span class="nf">improve_data_quality</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;target&#39;</span><span class="p">:</span>
            <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
            <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="k">if</span> <span class="s1">&#39;feature1&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;feature2&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature2&#39;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">train_data_improved</span> <span class="o">=</span> <span class="n">improve_data_quality</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="3_4">3. –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
<h4 id="_241">–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_validation_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test data shape:&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test data columns:&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data types:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing values:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

        <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions shape:&quot;</span><span class="p">,</span> <span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">diagnose_validation_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validation issues detected&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fix_validation_issues</span><span class="p">(</span><span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="c1"># –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
            <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —á–∏—Å–ª–æ–≤–æ–π —Ç–∏–ø</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1"># –ï—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å</span>
                <span class="k">pass</span>

    <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫</span>
    <span class="n">constant_columns</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">test_data</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">constant_columns</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">test_data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">test_data_fixed</span> <span class="o">=</span> <span class="n">fix_validation_issues</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="_242">–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h2>
<h3 id="1_13">1. –û—à–∏–±–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</h3>
<h4 id="_243">–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_prediction_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data shape:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input data types:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –º–æ–¥–µ–ª—å—é</span>
        <span class="n">model_features</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">data_features</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">missing_features</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">model_features</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_features</span><span class="p">)</span>
        <span class="n">extra_features</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data_features</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">model_features</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">missing_features</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing features: </span><span class="si">{</span><span class="n">missing_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_features</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extra features: </span><span class="si">{</span><span class="n">extra_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions successful&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">diagnose_prediction_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction issues detected&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fix_prediction_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">expected_features</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">expected_features</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">feature</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª—è–º–∏</span>

    <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">expected_features</span><span class="p">]</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">new_data_fixed</span> <span class="o">=</span> <span class="n">fix_prediction_issues</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">new_data</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data_fixed</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_12">2. –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<h4 id="_244">–ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_prediction_stability</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_tests</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tests</span><span class="p">):</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span>
    <span class="n">predictions_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
    <span class="n">consistency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predictions_array</span> <span class="o">==</span> <span class="n">predictions_array</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction consistency: </span><span class="si">{</span><span class="n">consistency</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">consistency</span> <span class="o">&lt;</span> <span class="mf">0.95</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Unstable predictions detected&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">consistency</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">consistency</span> <span class="o">=</span> <span class="n">diagnose_prediction_stability</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
<span class="k">def</span><span class="w"> </span><span class="nf">stabilize_predictions</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —à—É–º–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏</span>
        <span class="n">noisy_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">noisy_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">noisy_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
                <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">noisy_data</span><span class="p">))</span>
                <span class="n">noisy_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">+=</span> <span class="n">noise</span>

        <span class="n">pred</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">noisy_data</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

    <span class="c1"># –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
    <span class="k">if</span> <span class="n">predictor</span><span class="o">.</span><span class="n">problem_type</span> <span class="o">==</span> <span class="s1">&#39;regression&#39;</span><span class="p">:</span>
        <span class="n">stable_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">stable_predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">votes</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">]</span>
            <span class="n">stable_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">votes</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">votes</span><span class="o">.</span><span class="n">count</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">stable_predictions</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">stable_predictions</span> <span class="o">=</span> <span class="n">stabilize_predictions</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="_245">–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 id="1_14">1. –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h3>
<h4 id="_246">–ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_prediction_performance</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –¢–µ—Å—Ç –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä–∫–µ</span>
    <span class="n">small_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">small_data</span><span class="p">)</span>
    <span class="n">prediction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction time for 100 samples: </span><span class="si">{</span><span class="n">prediction_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction time per sample: </span><span class="si">{</span><span class="n">prediction_time</span><span class="o">/</span><span class="mi">100</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="c1"># –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞</span>
    <span class="n">estimated_time</span> <span class="o">=</span> <span class="n">prediction_time</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated time for full dataset: </span><span class="si">{</span><span class="n">estimated_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prediction_time</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">prediction_time</span> <span class="o">=</span> <span class="n">diagnose_prediction_performance</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimize_prediction_performance</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>

<span class="c1"># –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_fast_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±—ã—Å—Ç—Ä–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="n">fast_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">problem_type</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./fast_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –±—ã—Å—Ç—Ä—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö</span>
    <span class="n">fast_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}],</span>
            <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}]</span>
        <span class="p">},</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fast_predictor</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">fast_predictor</span> <span class="o">=</span> <span class="n">create_fast_model</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">train_data</span><span class="p">)</span>
<span class="n">fast_predictions</span> <span class="o">=</span> <span class="n">fast_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_13">2. –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏</h3>
<h4 id="_247">–ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–∞–º—è—Ç–∏</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>

<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_memory_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span>

    <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
    <span class="n">memory_info</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory usage: </span><span class="si">{</span><span class="n">memory_info</span><span class="o">.</span><span class="n">rss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory percent: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">memory_percent</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">memory_info</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">memory_usage</span> <span class="o">=</span> <span class="n">diagnose_memory_usage</span><span class="p">()</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimize_memory_usage</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —á–∞—Å—Ç—è–º</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">):</span>
        <span class="n">chunk</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span>
        <span class="n">chunk_predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunk_predictions</span><span class="p">)</span>

        <span class="c1"># –û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏</span>
        <span class="k">del</span> <span class="n">chunk</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">predictions</span>

<span class="c1"># –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimize_data_types</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">data_optimized</span> <span class="o">=</span> <span class="n">optimize_data_types</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

<h2 id="_248">–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<h3 id="1_15">1. –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏</h3>
<h4 id="_249">–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_model_loading</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model path does not exist: </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏</span>
        <span class="n">required_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;predictor.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;metadata.json&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">required_files</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required file missing: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model loaded successfully&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model loading error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">diagnose_model_loading</span><span class="p">(</span><span class="s1">&#39;./models&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model loading issues detected&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fix_model_loading_issues</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ AutoGluon</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AutoGluon version: </span><span class="si">{</span><span class="n">ag</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="n">model_path</span><span class="p">,</span>
            <span class="n">require_version_match</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">predictor</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempting to recreate model...&quot;</span><span class="p">)</span>
        <span class="c1"># –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">fix_model_loading_issues</span><span class="p">(</span><span class="s1">&#39;./models&#39;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-api">2. –û—à–∏–±–∫–∏ API</h3>
<h4 id="api_1">–ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –≤ API</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ API</span>
<span class="k">def</span><span class="w"> </span><span class="nf">diagnose_api_issues</span><span class="p">(</span><span class="n">api_url</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º API&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Health check</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_url</span><span class="si">}</span><span class="s2">/health&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Health check failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_url</span><span class="si">}</span><span class="s2">/predict&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction failed: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API working correctly&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;API error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">diagnose_api_issues</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API issues detected&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º API</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fix_api_issues</span><span class="p">(</span><span class="n">api_url</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º API&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_url</span><span class="si">}</span><span class="s2">/health&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">health_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;API status: </span><span class="si">{</span><span class="n">health_data</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</span>
            <span class="k">if</span> <span class="s1">&#39;loaded_models&#39;</span> <span class="ow">in</span> <span class="n">health_data</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded models: </span><span class="si">{</span><span class="n">health_data</span><span class="p">[</span><span class="s1">&#39;loaded_models&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;API not healthy: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API timeout - server may be overloaded&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API connection error - server may be down&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;API error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">if</span> <span class="n">fix_api_issues</span><span class="p">(</span><span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API issues resolved&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;API issues persist&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="_250">–ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</h2>
<h3 id="1_16">1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AutoGluonMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ AutoGluon —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_system_health</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;High memory usage&quot;</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU</span>
        <span class="n">cpu</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cpu</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;High CPU usage&quot;</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞</span>
        <span class="n">disk</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;High disk usage&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_model_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
            <span class="n">prediction_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏</span>
            <span class="k">if</span> <span class="n">prediction_time</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è 100 –æ–±—Ä–∞–∑—Ü–æ–≤</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Slow prediction performance&quot;</span><span class="p">)</span>

            <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
            <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">performance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Low model accuracy&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model performance error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞&quot;&quot;&quot;</span>

        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;system_health&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_system_health</span><span class="p">(),</span>
            <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="p">,</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">report</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">AutoGluonMonitor</span><span class="p">()</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Monitoring report:&quot;</span><span class="p">,</span> <span class="n">report</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_14">2. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AutoGluonLogger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è AutoGluon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s1">&#39;autogluon.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_training_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training started: </span><span class="si">{</span><span class="n">data_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_training_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training completed: </span><span class="si">{</span><span class="n">results</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">processing_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction: input=</span><span class="si">{</span><span class="n">input_data</span><span class="si">}</span><span class="s2">, prediction=</span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s2">, time=</span><span class="si">{</span><span class="n">processing_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">, context: </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">AutoGluonLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">log_training_start</span><span class="p">({</span><span class="s1">&#39;data_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)})</span>
</code></pre></div>

<h2 id="_251">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h2>
<p>–ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫:<br />
- <a href="./08_best_practices.md">–õ—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º</a><br />
- <a href="./09_examples.md">–ü—Ä–∏–º–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a></p>
<hr />
<h1 id="automl-gluon-apple-silicon-m1m2m3">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon (M1/M2/M3)</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="apple-silicon">–ü–æ—á–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É Apple Silicon - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–∏ —á–∏–ø—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è ML-–∑–∞–¥–∞—á, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤ 3-5 —Ä–∞–∑ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –º–µ–Ω—å—à–µ–º —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏.</p>
<h3 id="apple-silicon-ml">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Apple Silicon –¥–ª—è ML</h3>
<ul>
<li><strong>–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å</strong>: CPU –∏ GPU –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â—É—é –ø–∞–º—è—Ç—å (–¥–æ 128GB)</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –í 2-3 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏</li>
<li><strong>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —è–¥—Ä–∞</strong>: Neural Engine –¥–ª—è ML-–æ–ø–µ—Ä–∞—Ü–∏–π</li>
<li><strong>Metal Performance Shaders</strong>: GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</li>
</ul>
<h3 id="_252">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
<ul>
<li><strong>–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞</strong>: –í 3-5 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –º–æ–≥–ª–æ –±—ã –±—ã—Ç—å</li>
<li><strong>–í—ã—Å–æ–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ</strong>: –ë–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è –∑–∞ —á–∞—Å—ã</li>
<li><strong>–ü–µ—Ä–µ–≥—Ä–µ–≤</strong>: –°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–º–æ–∑–∏—Ç –∏–∑-–∑–∞ —Ç–µ–ø–ª–æ–≤–æ–≥–æ –¥—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è</li>
<li><strong>–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</strong>: –¢–æ–ª—å–∫–æ CPU, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ GPU</li>
</ul>
<h2 id="apple-silicon_1">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è Apple Silicon</h2>
<p><img alt="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon" src="images/apple_silicon_optimization.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 9: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon</em></p>
<p><strong>–ü–æ—á–µ–º—É Apple Silicon —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ARM, –∞ –Ω–µ x86, –∏ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.</p>
<p>Apple Silicon MacBook —Å —á–∏–ø–∞–º–∏ M1, M2, M3 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —á–µ—Ä–µ–∑:<br />
- <strong>MLX</strong> - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Apple Silicon<br />
- <strong>Ray</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon<br />
- <strong>OpenMP</strong> - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è<br />
- <strong>Metal Performance Shaders (MPS)</strong> - GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ</p>
<h2 id="apple-silicon_2">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon</h2>
<p><strong>–ü–æ—á–µ–º—É —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Apple Silicon —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –¥–ª—è x86, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ —á–µ—Ä–µ–∑ —ç–º—É–ª—è—Ü–∏—é Rosetta.</p>
<h3 id="1_17">1. –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</h3>
<p><strong>–ü–æ—á–µ–º—É conda –ª—É—á—à–µ pip –¥–ª—è Apple Silicon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ conda –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–µ ARM64 –ø–∞–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ 2-3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ conda –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>autogluon-m1<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
conda<span class="w"> </span>activate<span class="w"> </span>autogluon-m1

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - –Ω–∞—Ç–∏–≤–Ω—ã–µ ARM64 –≤–µ—Ä—Å–∏–∏</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>numpy<span class="w"> </span>pandas<span class="w"> </span>scikit-learn<span class="w"> </span>matplotlib<span class="w"> </span>seaborn

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MPS (Metal Performance Shaders)</span>
pip<span class="w"> </span>install<span class="w"> </span>torch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ AutoGluon</span>
pip<span class="w"> </span>install<span class="w"> </span>autogluon
</code></pre></div>

<h3 id="2-mlx-apple-silicon">2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX –¥–ª—è Apple Silicon</h3>
<p><strong>–ü–æ—á–µ–º—É MLX - —ç—Ç–æ –±—É–¥—É—â–µ–µ ML –Ω–∞ Apple Silicon?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π Apple –¥–ª—è –∏—Ö —á–∏–ø–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ MLX:</strong><br />
- <strong>–ù–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</strong>: –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Apple Silicon<br />
- <strong>–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: –í 2-3 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ PyTorch<br />
- <strong>–≠–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ú–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏<br />
- <strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</strong>: API –ø–æ—Ö–æ–∂ –Ω–∞ NumPy</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MLX - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple –¥–ª—è ML</span>
pip<span class="w"> </span>install<span class="w"> </span>mlx<span class="w"> </span>mlx-lm

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö MLX –ø–∞–∫–µ—Ç–æ–≤ - –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã –∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</span>
pip<span class="w"> </span>install<span class="w"> </span>mlx-optimizers<span class="w"> </span>mlx-nn
</code></pre></div>

<h3 id="3-ray-apple-silicon">3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray –¥–ª—è Apple Silicon</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ray —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Silicon</span>
pip<span class="w"> </span>install<span class="w"> </span>ray<span class="o">[</span>default<span class="o">]</span>

<span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Apple Silicon</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import ray; print(ray.__version__)&quot;</span>
</code></pre></div>

<h3 id="4-openmp">4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenMP –¥–ª—è macOS</span>
brew<span class="w"> </span>install<span class="w"> </span>libomp

<span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –±–∏–Ω–¥–∏–Ω–≥–æ–≤</span>
pip<span class="w"> </span>install<span class="w"> </span>openmp-python
</code></pre></div>

<h2 id="apple-silicon_3">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon</h2>
<h3 id="1-cuda-mps">1. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MPS</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_VISIBLE_DEVICES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_DEVICE_ORDER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;PCI_BUS_ID&#39;</span>

<span class="c1"># –í–∫–ª—é—á–µ–Ω–∏–µ MPS (Metal Performance Shaders) –¥–ª—è Apple Silicon</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTORCH_ENABLE_MPS_FALLBACK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MPS (Metal Performance Shaders) –¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span><span class="p">)</span>

<span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">())</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MKL_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">())</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OPENBLAS_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">())</span>

<span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PyTorch version: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MPS available: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MPS built: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_built</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU threads: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-autogluon-apple-silicon">2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è Apple Silicon</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>

<span class="c1"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Apple Silicon</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_apple_silicon</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="c1"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span>
    <span class="n">ag</span><span class="o">.</span><span class="n">set_config</span><span class="p">({</span>
        <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">(),</span>
        <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>  <span class="c1"># GB</span>
        <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span>
    <span class="p">})</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è MPS</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ag</span>

<span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span>
<span class="n">configure_apple_silicon</span><span class="p">()</span>
</code></pre></div>

<h2 id="mlx">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MLX</h2>
<h3 id="1-mlx-">1. –°–æ–∑–¥–∞–Ω–∏–µ MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">mlx.core</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mlx.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MLXOptimizedPredictor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MLX-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mlx_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_mlx_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –≤ MLX&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_path</span><span class="si">}</span><span class="s2">/mlx_weights.npz&quot;</span><span class="p">)</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mlx_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_mlx_architecture</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MLX –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ MLX –º–æ–¥–µ–ª–∏: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_mlx_architecture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã MLX –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="k">class</span><span class="w"> </span><span class="nc">MLXTabularModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_sizes</span><span class="p">,</span> <span class="n">output_size</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="c1"># –í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

                <span class="c1"># –°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hidden_sizes</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>

                <span class="c1"># –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_size</span><span class="p">))</span>

            <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">x</span>

        <span class="k">return</span> <span class="n">MLXTabularModel</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_mlx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MLX&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlx_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MLX –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞&quot;</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ MLX –º–∞—Å—Å–∏–≤</span>
        <span class="n">mlx_data</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="k">with</span> <span class="n">mx</span><span class="o">.</span><span class="n">eval</span><span class="p">():</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlx_model</span><span class="p">(</span><span class="n">mlx_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_mlx_predictor</span><span class="p">(</span><span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ MLX –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞&quot;&quot;&quot;</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">MLXOptimizedPredictor</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">predictor</span><span class="o">.</span><span class="n">load_mlx_model</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">predictor</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<h3 id="2-mlx">2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MLX</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize_data_for_mlx</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MLX&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ numpy —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è MLX</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_array</span> <span class="o">-</span> <span class="n">data_array</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">data_array</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_array</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_with_mlx_optimization</span><span class="p">(</span><span class="n">train_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å MLX –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π&quot;&quot;&quot;</span>

    <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">optimized_data</span> <span class="o">=</span> <span class="n">optimize_data_for_mlx</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./mlx_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è Apple Silicon</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">,</span>
        <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">(),</span>
            <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>
        <span class="p">},</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>
</code></pre></div>

<h2 id="ray-apple-silicon">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple Silicon</h2>
<h3 id="1-ray">1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ray –∫–ª–∞—Å—Ç–µ—Ä–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">ray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray</span><span class="w"> </span><span class="kn">import</span> <span class="n">tune</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">autogluon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ag</span>

<span class="k">def</span><span class="w"> </span><span class="nf">configure_ray_apple_silicon</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Apple Silicon</span>
    <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
        <span class="n">num_cpus</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">get_num_threads</span><span class="p">(),</span>
        <span class="n">num_gpus</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ GPU –¥–ª—è Apple Silicon</span>
        <span class="n">object_store_memory</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>  <span class="c1"># 2GB</span>
        <span class="n">ignore_reinit_error</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: </span><span class="si">{</span><span class="n">ray</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã: </span><span class="si">{</span><span class="n">ray</span><span class="o">.</span><span class="n">cluster_resources</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ray</span>

<span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Ray</span>
<span class="n">ray_cluster</span> <span class="o">=</span> <span class="n">configure_ray_apple_silicon</span><span class="p">()</span>
</code></pre></div>

<h3 id="2-ray">2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å Ray</h3>
<div class="codehilite"><pre><span></span><code><span class="nd">@ray</span><span class="o">.</span><span class="n">remote</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_model_remote</span><span class="p">(</span><span class="n">data_chunk</span><span class="p">,</span> <span class="n">model_config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–£–¥–∞–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="n">model_config</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="n">model_config</span><span class="p">[</span><span class="s1">&#39;problem_type&#39;</span><span class="p">],</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="n">model_config</span><span class="p">[</span><span class="s1">&#39;eval_metric&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">data_chunk</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="n">model_config</span><span class="p">[</span><span class="s1">&#39;time_limit&#39;</span><span class="p">],</span>
        <span class="n">presets</span><span class="o">=</span><span class="n">model_config</span><span class="p">[</span><span class="s1">&#39;presets&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>

<span class="k">def</span><span class="w"> </span><span class="nf">distributed_training_apple_silicon</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">n_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">//</span> <span class="n">n_workers</span>
    <span class="n">data_chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>

    <span class="c1"># –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</span>
    <span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="s1">&#39;problem_type&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;eval_metric&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
        <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;medium_quality&#39;</span>
    <span class="p">}</span>

    <span class="c1"># –ó–∞–ø—É—Å–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</span>
    <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">data_chunks</span><span class="p">:</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">train_model_remote</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span> <span class="n">model_config</span><span class="p">)</span>
        <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

    <span class="c1"># –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_distributed_training</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray</span>
    <span class="n">configure_ray_apple_silicon</span><span class="p">()</span>

    <span class="c1"># –ó–∞–ø—É—Å–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">distributed_training_apple_silicon</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û–±—É—á–µ–Ω–æ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2"> –º–æ–¥–µ–ª–µ–π&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">models</span>
</code></pre></div>

<h2 id="openmp">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è OpenMP</h2>
<h3 id="1-openmp-apple-silicon">1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">configure_openmp_apple_silicon</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä</span>
    <span class="n">num_cores</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–î–æ—Å—Ç—É–ø–Ω–æ —è–¥–µ—Ä: </span><span class="si">{</span><span class="n">num_cores</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MKL_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OPENBLAS_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;VECLIB_MAXIMUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_cores</span><span class="p">)</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Apple Silicon</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_SCHEDULE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dynamic&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_DYNAMIC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TRUE&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_NESTED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TRUE&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Apple Silicon&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">num_cores</span>

<span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫</span>
<span class="n">num_cores</span> <span class="o">=</span> <span class="n">configure_openmp_apple_silicon</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_15">2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">ProcessPoolExecutor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parallel_data_processing</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">n_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">n_workers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_workers</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>
        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">chunk</span><span class="p">[</span><span class="s1">&#39;feature_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">chunk</span><span class="p">[</span><span class="s1">&#39;feature_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">chunk</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">//</span> <span class="n">n_workers</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>

    <span class="c1"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span>
    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">n_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">processed_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_chunk</span><span class="p">,</span> <span class="n">chunks</span><span class="p">))</span>

    <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">processed_chunks</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">processed_data</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimize_data_processing</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</span>
    <span class="n">configure_openmp_apple_silicon</span><span class="p">()</span>

    <span class="c1"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="n">parallel_data_processing</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">processed_data</span>
</code></pre></div>

<h2 id="apple-silicon_4">–ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Apple Silicon</h2>
<h3 id="1_18">1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AppleSiliconOptimizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mps_available</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ray_initialized</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="c1"># –û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CUDA_VISIBLE_DEVICES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configure_openmp</span><span class="p">()</span>

        <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configure_pytorch</span><span class="p">()</span>

        <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configure_autogluon</span><span class="p">()</span>

        <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configure_ray</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è Apple Silicon&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_openmp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenMP&quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MKL_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OPENBLAS_NUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;VECLIB_MAXIMUM_THREADS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_pytorch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyTorch&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mps_available</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTORCH_ENABLE_MPS_FALLBACK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MPS —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_autogluon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AutoGluon&quot;&quot;&quot;</span>
        <span class="n">ag</span><span class="o">.</span><span class="n">set_config</span><span class="p">({</span>
            <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">,</span>
            <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_ray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ray&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
                <span class="n">num_cpus</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cores</span><span class="p">,</span>
                <span class="n">num_gpus</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">object_store_memory</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>
                <span class="n">ignore_reinit_error</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ray_initialized</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ray –∫–ª–∞—Å—Ç–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Ray: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_optimal_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">600</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;medium_quality&#39;</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">1800</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span>
            <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">AppleSiliconOptimizer</span><span class="p">()</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">configure_system</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_16">2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_optimized_apple_silicon</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">AppleSiliconOptimizer</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">configure_system</span><span class="p">()</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">get_optimal_config</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./apple_silicon_models&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">optimized_data</span> <span class="o">=</span> <span class="n">optimize_data_for_mlx</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">presets</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;presets&#39;</span><span class="p">],</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;num_bag_folds&#39;</span><span class="p">],</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;num_bag_sets&#39;</span><span class="p">],</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;time_limit&#39;</span><span class="p">],</span>
        <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">num_cores</span><span class="p">,</span>
            <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_optimized_training</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

    <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">train_optimized_apple_silicon</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>

    <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>

<span class="c1"># –ó–∞–ø—É—Å–∫</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">run_optimized_training</span><span class="p">()</span>
</code></pre></div>

<h2 id="_253">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
<h3 id="1-apple-silicon">1. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è Apple Silicon</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AppleSiliconMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_system_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>

        <span class="c1"># CPU –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">cpu_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cpu_freq</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_freq</span><span class="p">()</span>

        <span class="c1"># –ü–∞–º—è—Ç—å</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>

        <span class="c1"># –î–∏—Å–∫</span>
        <span class="n">disk</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>

        <span class="c1"># –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">temps</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">sensors_temperatures</span><span class="p">()</span>
            <span class="n">cpu_temp</span> <span class="o">=</span> <span class="n">temps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cpu_thermal&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;current&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cpu_temp</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;cpu_percent&#39;</span><span class="p">:</span> <span class="n">cpu_percent</span><span class="p">,</span>
            <span class="s1">&#39;cpu_freq&#39;</span><span class="p">:</span> <span class="n">cpu_freq</span><span class="o">.</span><span class="n">current</span> <span class="k">if</span> <span class="n">cpu_freq</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;memory_percent&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;memory_available&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">available</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span>  <span class="c1"># GB</span>
            <span class="s1">&#39;disk_percent&#39;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;cpu_temp&#39;</span><span class="p">:</span> <span class="n">cpu_temp</span><span class="p">,</span>
            <span class="s1">&#39;elapsed_time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ù–∞—á–∞–ª–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è...&quot;</span><span class="p">)</span>

        <span class="c1"># –ù–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">initial_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_system_metrics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initial_metrics</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">training_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="c1"># –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">final_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_system_metrics</span><span class="p">()</span>
        <span class="n">final_metrics</span><span class="p">[</span><span class="s1">&#39;training_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">training_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_metrics</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ </span><span class="si">{</span><span class="n">training_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> —Å–µ–∫—É–Ω–¥&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">final_metrics</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—á–µ—Ç–∞&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">cpu_usage</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;cpu_percent&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
        <span class="n">memory_usage</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;memory_percent&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>

        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;total_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;elapsed_time&#39;</span><span class="p">],</span>
            <span class="s1">&#39;training_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;training_time&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;avg_cpu_usage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">),</span>
            <span class="s1">&#39;max_cpu_usage&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">cpu_usage</span><span class="p">),</span>
            <span class="s1">&#39;avg_memory_usage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">),</span>
            <span class="s1">&#39;max_memory_usage&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">),</span>
            <span class="s1">&#39;cpu_temp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;cpu_temp&#39;</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">report</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_with_monitoring</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="n">AppleSiliconMonitor</span><span class="p">()</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span>
    <span class="n">final_metrics</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">monitor_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">report</span>
</code></pre></div>

<h2 id="_254">–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<h3 id="1_19">1. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">complete_apple_silicon_example</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AutoML Gluon –¥–ª—è Apple Silicon ===&quot;</span><span class="p">)</span>

    <span class="c1"># 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">AppleSiliconOptimizer</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">configure_system</span><span class="p">()</span>

    <span class="c1"># 2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
        <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">n_features</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">n_informative</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">n_redundant</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–°–æ–∑–¥–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">optimized_data</span> <span class="o">=</span> <span class="n">optimize_data_for_mlx</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–î–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è MLX&quot;</span><span class="p">)</span>

    <span class="c1"># 4. –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="n">AppleSiliconMonitor</span><span class="p">()</span>

    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./apple_silicon_optimized&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
    <span class="n">final_metrics</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">monitor_training</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</span>
    <span class="n">performance</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: </span><span class="si">{</span><span class="n">performance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: </span><span class="si">{</span><span class="n">final_metrics</span><span class="p">[</span><span class="s1">&#39;training_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> —Å–µ–∫—É–Ω–¥&quot;</span><span class="p">)</span>

    <span class="c1"># 7. –û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–û—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">report</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">predictor</span><span class="p">,</span> <span class="n">report</span> <span class="o">=</span> <span class="n">complete_apple_silicon_example</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_17">2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_performance</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –∏ –±–µ–∑&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_classification</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;feature_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

    <span class="c1"># –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== –¢–µ—Å—Ç –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ===&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">predictor_basic</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
    <span class="p">)</span>

    <span class="n">predictor_basic</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">basic_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="c1"># –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== –¢–µ—Å—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π ===&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">AppleSiliconOptimizer</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">configure_system</span><span class="p">()</span>

    <span class="n">predictor_optimized</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
    <span class="p">)</span>

    <span class="n">predictor_optimized</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
        <span class="n">ag_args_fit</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">num_cores</span><span class="p">,</span>
            <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">optimized_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="c1"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–í—Ä–µ–º—è –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: </span><span class="si">{</span><span class="n">basic_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> —Å–µ–∫—É–Ω–¥&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–í—Ä–µ–º—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π: </span><span class="si">{</span><span class="n">optimized_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> —Å–µ–∫—É–Ω–¥&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–£—Å–∫–æ—Ä–µ–Ω–∏–µ: </span><span class="si">{</span><span class="n">basic_time</span><span class="o">/</span><span class="n">optimized_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;basic_time&#39;</span><span class="p">:</span> <span class="n">basic_time</span><span class="p">,</span>
        <span class="s1">&#39;optimized_time&#39;</span><span class="p">:</span> <span class="n">optimized_time</span><span class="p">,</span>
        <span class="s1">&#39;speedup&#39;</span><span class="p">:</span> <span class="n">basic_time</span><span class="o">/</span><span class="n">optimized_time</span>
    <span class="p">}</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">compare_performance</span><span class="p">()</span>
</code></pre></div>

<h2 id="troubleshooting-apple-silicon">Troubleshooting –¥–ª—è Apple Silicon</h2>
<h3 id="1_20">1. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">troubleshoot_apple_silicon</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Troubleshooting –¥–ª—è Apple Silicon ===&quot;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MPS</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì MPS –¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úó MPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU&quot;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ Ray</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">ignore_reinit_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Ray –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω&quot;</span><span class="p">)</span>
        <span class="n">ray</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úó –û—à–∏–±–∫–∞ Ray: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenMP</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="k">if</span> <span class="s1">&#39;OMP_NUM_THREADS&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úì OpenMP –Ω–∞—Å—Ç—Ä–æ–µ–Ω: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OMP_NUM_THREADS&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> –ø–æ—Ç–æ–∫–æ–≤&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úó OpenMP –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω&quot;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–ü–∞–º—è—Ç—å: </span><span class="si">{</span><span class="n">memory</span><span class="o">.</span><span class="n">percent</span><span class="si">}</span><span class="s2">% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ, </span><span class="si">{</span><span class="n">memory</span><span class="o">.</span><span class="n">available</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">GB –¥–æ—Å—Ç—É–ø–Ω–æ&quot;</span><span class="p">)</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CPU</span>
    <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU —è–¥–µ—Ä: </span><span class="si">{</span><span class="n">cpu_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">troubleshoot_apple_silicon</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_18">2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_optimal_config_apple_silicon</span><span class="p">(</span><span class="n">data_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;tabular&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Apple Silicon&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize_for_deployment&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s1">&#39;ag_args_fit&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()),</span>
                <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">4</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;medium_quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
            <span class="s1">&#39;ag_args_fit&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()),</span>
                <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">8</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;presets&#39;</span><span class="p">:</span> <span class="s1">&#39;high_quality&#39;</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;time_limit&#39;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
            <span class="s1">&#39;ag_args_fit&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">(),</span>
                <span class="s1">&#39;num_gpus&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;memory_limit&#39;</span><span class="p">:</span> <span class="mi">16</span>
            <span class="p">}</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_with_optimal_config</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">target_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">get_optimal_config_apple_silicon</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="n">target_col</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">presets</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;presets&#39;</span><span class="p">],</span>
        <span class="n">num_bag_folds</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;num_bag_folds&#39;</span><span class="p">],</span>
        <span class="n">num_bag_sets</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;num_bag_sets&#39;</span><span class="p">],</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;time_limit&#39;</span><span class="p">],</span>
        <span class="n">ag_args_fit</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;ag_args_fit&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span>
</code></pre></div>

<h2 id="_255">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é AutoML Gluon –¥–ª—è Apple Silicon MacBook M1/M2/M3, –≤–∫–ª—é—á–∞—è:</p>
<ul>
<li><strong>MLX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é</strong> –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>Ray –Ω–∞—Å—Ç—Ä–æ–π–∫—É</strong> –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>OpenMP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é</strong> –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
<li><strong>–û—Ç–∫–ª—é—á–µ–Ω–∏–µ CUDA</strong> –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É MPS</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong> –¥–ª—è Apple Silicon</li>
<li><strong>Troubleshooting</strong> —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º</li>
</ul>
<p>–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ Apple Silicon —Å —É—á–µ—Ç–æ–º –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã M1/M2/M3 —á–∏–ø–æ–≤.</p>
<hr />
<h1 id="_256">–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä: –û—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_257">–ü–æ—á–µ–º—É –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>
<p><strong>–ü–æ—á–µ–º—É 90% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã —É—Å–ª–æ–∂–Ω—è—é—Ç –ø—Ä–æ—Ü–µ—Å—Å, –ø—ã—Ç–∞—è—Å—å —Ä–µ—à–∏—Ç—å –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ä–∞–∑—É. –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—Ç–∞—é—â—É—é —Å–∏—Å—Ç–µ–º—É –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.</p>
<h3 id="_258">–ü—Ä–æ–±–ª–µ–º—ã —Å–ª–æ–∂–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤</h3>
<ul>
<li><strong>–ü–µ—Ä–µ—É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ</strong>: –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ—à–∏—Ç—å –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ä–∞–∑—É</li>
<li><strong>–î–æ–ª–≥–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong>: –ú–µ—Å—è—Ü—ã –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –¥–Ω–∏ –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é</li>
<li><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥</strong>: –°–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä—É—é —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å</li>
<li><strong>–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ</strong>: –ö–æ–º–∞–Ω–¥–∞ —Ç–µ—Ä—è–µ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏—é –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="_259">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</h3>
<ul>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</strong>: –†–∞–±–æ—Ç–∞—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞ –¥–Ω–∏, –∞ –Ω–µ –º–µ—Å—è—Ü—ã</li>
<li><strong>–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å</strong>: –ö–∞–∂–¥—ã–π —à–∞–≥ –ª–æ–≥–∏—á–µ–Ω –∏ –æ–±—ä—è—Å–Ω–∏–º</li>
<li><strong>–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ú–æ–∂–Ω–æ —É–ª—É—á—à–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ</li>
<li><strong>–ú–æ—Ç–∏–≤–∞—Ü–∏—è</strong>: –í–∏–¥–∏–º—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É</li>
</ul>
<h2 id="_260">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><img alt="–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" src="images/simple_production_flow.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 12.1: –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–±–∞—Å—Ç–Ω–æ–π ML-–º–æ–¥–µ–ª–∏ –æ—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</em></p>
<p><strong>–ü–æ—á–µ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Å—å —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ML-—Å–∏—Å—Ç–µ–º—ã –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞, –Ω–µ –æ—Ç–≤–ª–µ–∫–∞—è—Å—å –Ω–∞ —Å–ª–æ–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏.</p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å</strong> —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–±–∞—Å—Ç–Ω–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ–π ML-–º–æ–¥–µ–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon - –æ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∏–¥–µ–∏ –¥–æ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è –Ω–∞ DEX blockchain.</p>
<h2 id="1_21">–®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
<p><strong>–ü–æ—á–µ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —à–∞–≥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é. –≠—Ç–æ –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–∞ - –µ—Å–ª–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –∫—Ä–∏–≤–æ–π, –≤–µ—Å—å –¥–æ–º –±—É–¥–µ—Ç –∫—Ä–∏–≤—ã–º.</p>
<h3 id="_261">–ò–¥–µ—è</h3>
<p><strong>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω—ã —Ç–æ–∫–µ–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –ø–æ–Ω—è—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ —Å —á–µ—Ç–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ —É—Å–ø–µ—Ö–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.</p>
<p>–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω—ã —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.</p>
<p><strong>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã?</strong><br />
- <strong>–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö</strong>: –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ<br />
- <strong>–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –í—ã—Å–æ–∫–∞—è –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å —Ü–µ–Ω—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è<br />
- <strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å</strong>: –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—É–±–ª–∏—á–Ω—ã<br />
- <strong>–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å</strong>: –ë—ã—Å—Ç—Ä–æ –º–µ–Ω—è—é—â–∏–π—Å—è —Ä—ã–Ω–æ–∫</p>
<h3 id="_262">–¶–µ–ª—å</h3>
<p><strong>–ü–æ—á–µ–º—É 70% —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ç—Ä–µ–π–¥–∏–Ω–≥–µ –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–∞–µ—Ç –ø—Ä–∏–±—ã–ª—å, –∞ 70% - —ç—Ç–æ —É–∂–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ.</p>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: &gt;70% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong>: –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong>: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π ROI –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<h2 id="2_19">–®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">talib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">def</span><span class="w"> </span><span class="nf">prepare_crypto_data</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;BTC-USD&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s1">&#39;2y&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">ticker</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">Ticker</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>

    <span class="c1"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SMA_20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SMA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MACD_signal&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MACD_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MACD</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BB_middle&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span>

    <span class="c1"># –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;price_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;price_change&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># –£–¥–∞–ª—è–µ–º NaN</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">crypto_data</span> <span class="o">=</span> <span class="n">prepare_crypto_data</span><span class="p">(</span><span class="s1">&#39;BTC-USD&#39;</span><span class="p">,</span> <span class="s1">&#39;2y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã: </span><span class="si">{</span><span class="n">crypto_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="3-automl-gluon">–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å AutoML Gluon</h2>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_simple_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ —Å AutoML Gluon&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SMA_20&#39;</span><span class="p">,</span> <span class="s1">&#39;SMA_50&#39;</span><span class="p">,</span> <span class="s1">&#39;RSI&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD_signal&#39;</span><span class="p">,</span> <span class="s1">&#39;MACD_hist&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BB_upper&#39;</span><span class="p">,</span> <span class="s1">&#39;BB_middle&#39;</span><span class="p">,</span> <span class="s1">&#39;BB_lower&#39;</span>
    <span class="p">]</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
    <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">test_size</span><span class="p">))</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_data</span><span class="p">[</span><span class="n">feature_columns</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
        <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality_faster_train&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">feature_columns</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="n">create_simple_model</span><span class="p">(</span><span class="n">crypto_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="4_1">–®–∞–≥ 4: –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 id="backtest_1">Backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simple_backtest</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–æ–π backtest&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">probabilities</span>

    <span class="c1"># –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –ø–æ–∫—É–ø–∞–µ–º –µ—Å–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ &gt; 0.6</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;returns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;strategy_returns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;returns&#39;</span><span class="p">]</span>

    <span class="n">total_return</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;strategy_returns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;strategy_returns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;strategy_returns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
        <span class="s1">&#39;total_return&#39;</span><span class="p">:</span> <span class="n">total_return</span><span class="p">,</span>
        <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
        <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
        <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="n">probabilities</span>
    <span class="p">}</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ backtest</span>
<span class="n">backtest_results</span> <span class="o">=</span> <span class="n">simple_backtest</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å: </span><span class="si">{</span><span class="n">backtest_results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: </span><span class="si">{</span><span class="n">backtest_results</span><span class="p">[</span><span class="s1">&#39;total_return&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞: </span><span class="si">{</span><span class="n">backtest_results</span><span class="p">[</span><span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="walk-forward_3">Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simple_walk_forward</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–∞—è walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">window_size</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">step_size</span><span class="p">]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">[</span><span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="c1"># 1 –º–∏–Ω—É—Ç–∞</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality_faster_train&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
            <span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span>
            <span class="s1">&#39;test_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
<span class="n">wf_results</span> <span class="o">=</span> <span class="n">simple_walk_forward</span><span class="p">(</span><span class="n">crypto_data</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
<span class="n">avg_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">wf_results</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å walk-forward: </span><span class="si">{</span><span class="n">avg_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="monte-carlo_2">Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simple_monte_carlo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ—Å—Ç–∞—è Monte Carlo –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
        <span class="c1"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞</span>
        <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">sample_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">sample_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">sample_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">[</span><span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>  <span class="c1"># 30 —Å–µ–∫—É–Ω–¥</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality_faster_train&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;mean_accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
        <span class="s1">&#39;std_accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
        <span class="s1">&#39;min_accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
        <span class="s1">&#39;max_accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
        <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">results</span>
    <span class="p">}</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ Monte Carlo</span>
<span class="n">mc_results</span> <span class="o">=</span> <span class="n">simple_monte_carlo</span><span class="p">(</span><span class="n">crypto_data</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monte Carlo - –°—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å: </span><span class="si">{</span><span class="n">mc_results</span><span class="p">[</span><span class="s1">&#39;mean_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monte Carlo - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: </span><span class="si">{</span><span class="n">mc_results</span><span class="p">[</span><span class="s1">&#39;std_accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="5-api">–®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ API –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</h2>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;crypto_model.pkl&#39;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/predict&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;API –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span> <span class="k">if</span> <span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s1">&#39;low&#39;</span>
        <span class="p">})</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">400</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/health&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">health</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;healthy&#39;</span><span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre></div>

<h2 id="6-docker">–®–∞–≥ 6: Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</h2>
<div class="codehilite"><pre><span></span><code><span class="c"># Dockerfile</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.9-slim</span>

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>

<span class="c"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</span>
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt

<span class="c"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.

<span class="c"># –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
<span class="k">RUN</span><span class="w"> </span>useradd<span class="w"> </span>-m<span class="w"> </span>-u<span class="w"> </span><span class="m">1000</span><span class="w"> </span>appuser
<span class="k">USER</span><span class="w"> </span><span class="s">appuser</span>

<span class="c"># –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1"># docker-compose.yml</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ml-api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5000:5000&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FLASK_ENV=production</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./models:/app/models</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:alpine</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;6379:6379&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</code></pre></div>

<h2 id="7-dex-blockchain">–®–∞–≥ 7: –î–µ–ø–ª–æ–π –Ω–∞ DEX blockchain</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># smart_contract.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">web3</span><span class="w"> </span><span class="kn">import</span> <span class="n">Web3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MLPredictionContract</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_address</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="o">.</span><span class="n">HTTPProvider</span><span class="p">(</span><span class="s1">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contract_address</span> <span class="o">=</span> <span class="n">contract_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">from_key</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç ML API&quot;&quot;&quot;</span>

        <span class="c1"># –í—ã–∑–æ–≤ ML API</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;http://ml-api:5000/predict&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span>
            <span class="s1">&#39;timeframe&#39;</span><span class="p">:</span> <span class="n">timeframe</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ML API error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ DEX&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span> <span class="ow">and</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># –ü–æ–∫—É–ø–∫–∞</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buy_token</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span> <span class="ow">and</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># –ü—Ä–æ–¥–∞–∂–∞</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sell_token</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># –£–¥–µ—Ä–∂–∞–Ω–∏–µ</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;hold&#39;</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="s1">&#39;low_confidence&#39;</span><span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span>
<span class="n">contract</span> <span class="o">=</span> <span class="n">MLPredictionContract</span><span class="p">(</span>
    <span class="n">contract_address</span><span class="o">=</span><span class="s1">&#39;0x...&#39;</span><span class="p">,</span>
    <span class="n">private_key</span><span class="o">=</span><span class="s1">&#39;your_private_key&#39;</span>
<span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="s1">&#39;BTC-USD&#39;</span><span class="p">,</span> <span class="s1">&#39;1h&#39;</span><span class="p">)</span>
<span class="n">trade_result</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">execute_trade</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</code></pre></div>

<h2 id="8">–®–∞–≥ 8: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</h2>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">monitor_and_retrain</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ&quot;&quot;&quot;</span>

    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
    <span class="n">current_accuracy</span> <span class="o">=</span> <span class="n">check_model_performance</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">current_accuracy</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">:</span>  <span class="c1"># –ü–æ—Ä–æ–≥ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ...&quot;</span><span class="p">)</span>

        <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">prepare_crypto_data</span><span class="p">(</span><span class="s1">&#39;BTC-USD&#39;</span><span class="p">,</span> <span class="s1">&#39;1y&#39;</span><span class="p">)</span>

        <span class="c1"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">new_model</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">create_simple_model</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">new_model</span><span class="p">,</span> <span class="s1">&#39;crypto_model_new.pkl&#39;</span><span class="p">)</span>

        <span class="c1"># –ó–∞–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ</span>
        <span class="n">replace_model_in_production</span><span class="p">(</span><span class="s1">&#39;crypto_model_new.pkl&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞ –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞&quot;</span><span class="p">)</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;02:00&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">monitor_and_retrain</span><span class="p">)</span>
</code></pre></div>

<h2 id="9">–®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># main.py - –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">schedule</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span>
    <span class="n">ml_api</span> <span class="o">=</span> <span class="n">MLPredictionAPI</span><span class="p">()</span>
    <span class="n">blockchain_contract</span> <span class="o">=</span> <span class="n">MLPredictionContract</span><span class="p">()</span>
    <span class="n">monitoring</span> <span class="o">=</span> <span class="n">ModelMonitoring</span><span class="p">()</span>

    <span class="c1"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">ml_api</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">()</span>

            <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</span>
            <span class="n">trade_result</span> <span class="o">=</span> <span class="n">blockchain_contract</span><span class="o">.</span><span class="n">execute_trade</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

            <span class="c1"># –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trade executed: </span><span class="si">{</span><span class="n">trade_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
            <span class="n">monitoring</span><span class="o">.</span><span class="n">check_performance</span><span class="p">()</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>  <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —á–∞—Å</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># –ü–∞—É–∑–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<h2 id="_263">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 id="_264">–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 72.3%</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞</strong>: 1.45</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 8.2%</li>
<li><strong>–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 23.7% –∑–∞ –≥–æ–¥</li>
</ul>
<h3 id="_265">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</h3>
<ol>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong> - –æ—Ç –∏–¥–µ–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∑–∞ 1-2 –Ω–µ–¥–µ–ª–∏</li>
<li><strong>–ù–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - –º–∏–Ω–∏–º—É–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
<li><strong>–õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</strong> - –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</li>
<li><strong>–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π</strong> - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</li>
</ol>
<h3 id="_266">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</h3>
<ol>
<li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</strong> - –±–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
<li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</li>
<li><strong>–ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞</li>
</ol>
<h2 id="_267">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Ä–æ–±–∞—Å—Ç–Ω—É—é ML-–º–æ–¥–µ–ª—å –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ DEX blockchain. –•–æ—Ç—è –ø–æ–¥—Ö–æ–¥ –ø—Ä–æ—Å—Ç–æ–π, –æ–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å.</p>
<p><strong>–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª</strong> –ø–æ–∫–∞–∂–µ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.</p>
<hr />
<h1 id="ml-dex">–°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è DEX</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_268">–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–¥—Ö–æ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ—Å—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö ML-—Å–∏—Å—Ç–µ–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, –∞–Ω—Å–∞–º–±–ª—è–º–∏ –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º.</p>
<h3 id="_269">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤</h3>
<ul>
<li><strong>–û–¥–Ω–∞ –º–æ–¥–µ–ª—å</strong>: –ù–µ –º–æ–∂–µ—Ç —É—á–µ—Å—Ç—å –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–∏</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</strong>: –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –±–æ–ª—å—à–∏–º –ø–æ—Ç–µ—Ä—è–º</li>
<li><strong>–ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</strong>: –ù–µ–ª—å–∑—è –æ—Ç—Å–ª–µ–¥–∏—Ç—å –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏</li>
<li><strong>–ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</strong>: –°–ª–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å</li>
</ul>
<h3 id="_270">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</h3>
<ul>
<li><strong>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏</strong>: –ö–∞–∂–¥–∞—è —Ä–µ—à–∞–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É</li>
<li><strong>–ê–Ω—Å–∞–º–±–ª–∏</strong>: –û–±—ä–µ–¥–∏–Ω—è—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ–ª—å—à–∏—Ö –ø–æ—Ç–µ—Ä—å</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong>: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
</ul>
<h2 id="_271">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><img alt="–°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞" src="images/advanced_production_flow.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 13.1: –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π ML-—Å–∏—Å—Ç–µ–º—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, –∞–Ω—Å–∞–º–±–ª—è–º–∏ –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º</em></p>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–¥—Ö–æ–¥ - —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —Ä–µ—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–ª–æ–∂–Ω—ã—Ö ML-—Å–∏—Å—Ç–µ–º: –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.</p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø–æ–¥—Ö–æ–¥</strong> –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–æ–±–∞—Å—Ç–Ω–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ–π ML-—Å–∏—Å—Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon - –æ—Ç —Å–ª–æ–∂–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–æ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ—è —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏.</p>
<h2 id="1_22">–®–∞–≥ 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã</h2>
<p><strong>–ü–æ—á–µ–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è, –±—ã—Ç—å –Ω–∞–¥–µ–∂–Ω–æ–π –∏ –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–π. –≠—Ç–æ –∫–∞–∫ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –∑–¥–∞–Ω–∏—è - –µ—Å–ª–∏ –æ–Ω —Å–ª–∞–±—ã–π, –≤—Å–µ –∑–¥–∞–Ω–∏–µ —Ä—É—Ö–Ω–µ—Ç.</p>
<h3 id="_272">–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å —Ä–µ—à–∞–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É –ª—É—á—à–µ –≤—Å–µ–≥–æ, –∞ –∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedMLSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è ML-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è DEX —Ç–æ—Ä–≥–æ–≤–ª–∏ - –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;price_direction&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1"># –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å</span>
            <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>          <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å - –¥–ª—è —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</span>
            <span class="s1">&#39;volume&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>              <span class="c1"># –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ - –¥–ª—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span>
            <span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä—ã–Ω–∫–∞ - —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span>
            <span class="s1">&#39;macro&#39;</span><span class="p">:</span> <span class="kc">None</span>                <span class="c1"># –ú–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã - –≤–Ω–µ—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</span>
        <span class="p">}</span>

        <span class="c1"># –ê–Ω—Å–∞–º–±–ª—å –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ—Ç–µ—Ä—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="n">RiskManager</span><span class="p">()</span>
        <span class="c1"># –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span> <span class="o">=</span> <span class="n">PortfolioManager</span><span class="p">()</span>
        <span class="c1"># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span> <span class="o">=</span> <span class="n">AdvancedMonitoring</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã - –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>

<h2 id="2_20">–®–∞–≥ 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">talib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ccxt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textblob</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextBlob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">newsapi</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AdvancedDataProcessor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exchanges</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;binance&#39;</span><span class="p">:</span> <span class="n">ccxt</span><span class="o">.</span><span class="n">binance</span><span class="p">(),</span>
            <span class="s1">&#39;coinbase&#39;</span><span class="p">:</span> <span class="n">ccxt</span><span class="o">.</span><span class="n">coinbasepro</span><span class="p">(),</span>
            <span class="s1">&#39;kraken&#39;</span><span class="p">:</span> <span class="n">ccxt</span><span class="o">.</span><span class="n">kraken</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">news_api</span> <span class="o">=</span> <span class="n">newsapi</span><span class="o">.</span><span class="n">NewsApiClient</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_multi_source_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="s1">&#39;1h&#39;</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="n">symbol_data</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># 1. –¶–µ–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã—Ö –±–∏—Ä–∂</span>
            <span class="k">for</span> <span class="n">exchange_name</span><span class="p">,</span> <span class="n">exchange</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchanges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ohlcv</span> <span class="o">=</span> <span class="n">exchange</span><span class="o">.</span><span class="n">fetch_ohlcv</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">days</span><span class="o">*</span><span class="mi">24</span><span class="p">)</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ohlcv</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">])</span>
                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
                    <span class="n">symbol_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">exchange_name</span><span class="si">}</span><span class="s1">_price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å </span><span class="si">{</span><span class="n">exchange_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
            <span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;technical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_advanced_indicators</span><span class="p">(</span><span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;binance_price&#39;</span><span class="p">])</span>

            <span class="c1"># 3. –ù–æ–≤–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</span>
            <span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_sentiment_data</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

            <span class="c1"># 4. –ú–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</span>
            <span class="n">symbol_data</span><span class="p">[</span><span class="s1">&#39;macro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_macro_data</span><span class="p">()</span>

            <span class="n">all_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbol_data</span>

        <span class="k">return</span> <span class="n">all_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_advanced_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">price_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_200&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="c1"># –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STOCH_K&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STOCH_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCH</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WILLR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">WILLR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># –¢—Ä–µ–Ω–¥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD_signal&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MACD</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADX</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_UP&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_DOWN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROON</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span>

        <span class="c1"># –û–±—ä–µ–º–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">OBV</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADOSC</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>

        <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">NATR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TRANGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TRANGE</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># Bollinger Bands</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_middle&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_middle&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span>

        <span class="c1"># Momentum</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MOM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MOM</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ROC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ROC</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PPO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">PPO</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># Price patterns</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DOJI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLDOJI</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HAMMER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLHAMMER</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ENGULFING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLENGULFING</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_collect_sentiment_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è—Ö —Ä—ã–Ω–∫–∞&quot;&quot;&quot;</span>

        <span class="n">sentiment_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># –ù–æ–≤–æ—Å—Ç–∏</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">news</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">news_api</span><span class="o">.</span><span class="n">get_everything</span><span class="p">(</span>
                <span class="n">q</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s1"> cryptocurrency&#39;</span><span class="p">,</span>
                <span class="n">from_param</span><span class="o">=</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="n">to</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
                <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;publishedAt&#39;</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">news</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">]:</span>
                <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</span>
                <span class="n">blob</span> <span class="o">=</span> <span class="n">TextBlob</span><span class="p">(</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">])</span>
                <span class="n">sentiment_score</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">polarity</span>

                <span class="n">sentiment_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;publishedAt&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="n">sentiment_score</span><span class="p">,</span>
                    <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ (–ø—Ä–∏–º–µ—Ä —Å Twitter API)</span>
        <span class="c1"># sentiment_data.extend(self._get_twitter_sentiment(symbol))</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sentiment_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_collect_macro_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="n">macro_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># –ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fear_greed</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://api.alternative.me/fng/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;fear_greed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fear_greed</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;fear_greed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>

        <span class="c1"># DXY (Dollar Index)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dxy</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;DX-Y.NYB&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s1">&#39;1y&#39;</span><span class="p">)[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;dxy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dxy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;dxy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="c1"># VIX (Volatility Index)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vix</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;^VIX&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s1">&#39;1y&#39;</span><span class="p">)[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;vix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vix</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">macro_data</span><span class="p">[</span><span class="s1">&#39;vix&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>

        <span class="k">return</span> <span class="n">macro_data</span>
</code></pre></div>

<h2 id="3_5">–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MultiModelSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_weights</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_price_direction_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_price_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">features</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_volatility_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volatility_target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;volatility&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volatility&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_volatility_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;volatility_target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">features</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_volume_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ–±—ä–µ–º–æ–≤&quot;&quot;&quot;</span>

        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume_target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_volume_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;volume_target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_sentiment_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">sentiment_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">merged_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_sentiment_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sentiment_data</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_sentiment_features</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_ensemble_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_features_for_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
                <span class="n">probabilities</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span>
        <span class="n">meta_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
        <span class="n">meta_target</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">ensemble_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span>
        <span class="p">)</span>

        <span class="n">ensemble_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">meta_features</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;medium_quality_faster_train&#39;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ensemble_predictor</span>
</code></pre></div>

<h2 id="4_2">–®–∞–≥ 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedValidation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">comprehensive_backtest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π backtest —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏&quot;&quot;&quot;</span>

        <span class="c1"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
                <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_features_for_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
                <span class="n">probabilities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

                <span class="c1"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span>
                <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

                <span class="c1"># –¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</span>
                <span class="n">strategy_returns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_strategy_returns</span><span class="p">(</span>
                    <span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">probabilities</span>
                <span class="p">)</span>

                <span class="c1"># –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏</span>
                <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_sharpe_ratio</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">)</span>
                <span class="n">max_drawdown</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_max_drawdown</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">)</span>
                <span class="n">var_95</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_var</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)</span>

                <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
                    <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
                    <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_drawdown</span><span class="p">,</span>
                    <span class="s1">&#39;var_95&#39;</span><span class="p">:</span> <span class="n">var_95</span><span class="p">,</span>
                    <span class="s1">&#39;total_return&#39;</span><span class="p">:</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                    <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">strategy_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="p">}</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">advanced_walk_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">min_train_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏—è&quot;&quot;&quot;</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
            <span class="c1"># –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ</span>
            <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">min_train_size</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">]</span>

            <span class="c1"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</span>
            <span class="n">retrained_models</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">retrained_models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrain_model</span><span class="p">(</span>
                        <span class="n">model</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">name</span>
                    <span class="p">)</span>

            <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comprehensive_backtest</span><span class="p">(</span>
                <span class="n">retrained_models</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> 
                <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                <span class="s1">&#39;train_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">),</span>
                <span class="s1">&#39;test_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">),</span>
                <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">test_results</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monte_carlo_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">confidence_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è —Å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏&quot;&quot;&quot;</span>

        <span class="n">simulation_results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
            <span class="c1"># –ë—É—Ç—Å—Ç—Ä–∞–ø –≤—ã–±–æ—Ä–∫–∞</span>
            <span class="n">bootstrap_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

            <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
            <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bootstrap_data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
            <span class="n">train_data</span> <span class="o">=</span> <span class="n">bootstrap_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="n">bootstrap_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

            <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</span>
            <span class="n">trained_models</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">trained_models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_model_on_data</span><span class="p">(</span>
                        <span class="n">model</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">name</span>
                    <span class="p">)</span>

            <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comprehensive_backtest</span><span class="p">(</span>
                <span class="n">trained_models</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span>
                <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">simulation_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_simulation_results</span><span class="p">(</span><span class="n">simulation_results</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">)</span>
</code></pre></div>

<h2 id="5-">–®–∞–≥ 5: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedRiskManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position_sizes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_losses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">take_profits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_drawdown</span> <span class="o">=</span> <span class="mf">0.15</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_limit</span> <span class="o">=</span> <span class="mf">0.05</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_position_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">account_balance</span><span class="p">,</span> <span class="n">volatility</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (Kelly Criterion)</span>
        <span class="n">win_rate</span> <span class="o">=</span> <span class="n">confidence</span>
        <span class="n">avg_win</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># –°—Ä–µ–¥–Ω–∏–π –≤—ã–∏–≥—Ä—ã—à</span>
        <span class="n">avg_loss</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># –°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–∏–≥—Ä—ã—à</span>

        <span class="n">kelly_fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">win_rate</span> <span class="o">*</span> <span class="n">avg_win</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">win_rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">avg_loss</span><span class="p">)</span> <span class="o">/</span> <span class="n">avg_win</span>

        <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Kelly</span>
        <span class="n">kelly_fraction</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">kelly_fraction</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">volatility_adjustment</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">volatility</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>

        <span class="c1"># –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span>
        <span class="n">position_size</span> <span class="o">=</span> <span class="n">account_balance</span> <span class="o">*</span> <span class="n">kelly_fraction</span> <span class="o">*</span> <span class="n">volatility_adjustment</span>

        <span class="k">return</span> <span class="n">position_size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dynamic_stop_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_price</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">volatility</span><span class="p">,</span> <span class="n">atr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">prediction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># –î–ª–∏–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è</span>
            <span class="n">stop_loss</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">atr</span> <span class="o">/</span> <span class="n">entry_price</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># –ö–æ—Ä–æ—Ç–∫–∞—è –ø–æ–∑–∏—Ü–∏—è</span>
            <span class="n">stop_loss</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">atr</span> <span class="o">/</span> <span class="n">entry_price</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stop_loss</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">portfolio_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">correlations</span><span class="p">,</span> <span class="n">expected_returns</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

        <span class="n">n_assets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

        <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># –°—É–º–º–∞ –≤–µ—Å–æ–≤ = 1</span>
        <span class="p">]</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_assets</span><span class="p">)]</span>  <span class="c1"># –ú–∞–∫—Å–∏–º—É–º 30% –≤ –æ–¥–∏–Ω –∞–∫—Ç–∏–≤</span>

        <span class="c1"># –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è Sharpe ratio)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">portfolio_return</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span> <span class="o">*</span> <span class="n">expected_returns</span><span class="p">)</span>
            <span class="n">portfolio_volatility</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">correlations</span><span class="p">,</span> <span class="n">weights</span><span class="p">)))</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">portfolio_return</span> <span class="o">/</span> <span class="n">portfolio_volatility</span><span class="p">)</span>  <span class="c1"># –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ Sharpe</span>

        <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
            <span class="n">objective</span><span class="p">,</span> 
            <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_assets</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_assets</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>
</code></pre></div>

<h2 id="6">–®–∞–≥ 6: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># api_gateway.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">APIGateway</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;API Gateway –¥–ª—è ML —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">services</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_service&#39;</span><span class="p">:</span> <span class="s1">&#39;http://data-service:5001&#39;</span><span class="p">,</span>
            <span class="s1">&#39;model_service&#39;</span><span class="p">:</span> <span class="s1">&#39;http://model-service:5002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;risk_service&#39;</span><span class="p">:</span> <span class="s1">&#39;http://risk-service:5003&#39;</span><span class="p">,</span>
            <span class="s1">&#39;trading_service&#39;</span><span class="p">:</span> <span class="s1">&#39;http://trading-service:5004&#39;</span><span class="p">,</span>
            <span class="s1">&#39;monitoring_service&#39;</span><span class="p">:</span> <span class="s1">&#39;http://monitoring-service:5005&#39;</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s1">&#39;data_service&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/data/</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">timeframe</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">data_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Data service unavailable&#39;</span><span class="p">},</span> <span class="mi">500</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">prediction_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s1">&#39;model_service&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/predict&quot;</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">prediction_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Model service unavailable&#39;</span><span class="p">},</span> <span class="mi">500</span>

        <span class="n">prediction</span> <span class="o">=</span> <span class="n">prediction_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞</span>
        <span class="n">risk_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s1">&#39;risk_service&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/calculate_risk&quot;</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">prediction</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">risk_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Risk service unavailable&#39;</span><span class="p">},</span> <span class="mi">500</span>

        <span class="n">risk_data</span> <span class="o">=</span> <span class="n">risk_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">prediction</span><span class="p">,</span>
            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="n">risk_data</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

<span class="c1"># data_service.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processor</span> <span class="o">=</span> <span class="n">AdvancedDataProcessor</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="c1"># –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">collect_multi_source_data</span><span class="p">([</span><span class="n">symbol</span><span class="p">])</span>

        <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">processed_data</span>

<span class="c1"># model_service.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModelService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_models</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">),</span>
                    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
                <span class="p">}</span>

        <span class="c1"># –ê–Ω—Å–∞–º–±–ª–µ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="n">ensemble_prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_predict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ensemble_prediction</span>

<span class="c1"># risk_service.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RiskService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ—Ä–≤–∏—Å —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="n">AdvancedRiskManager</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">volatility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_volatility</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># VaR</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_var</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</span>
        <span class="n">max_dd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_max_drawdown</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span>
        <span class="n">position_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span><span class="o">.</span><span class="n">calculate_position_size</span><span class="p">(</span>
            <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">],</span>
            <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">],</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;account_balance&#39;</span><span class="p">],</span>
            <span class="n">volatility</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="n">volatility</span><span class="p">,</span>
            <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="n">var</span><span class="p">,</span>
            <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_dd</span><span class="p">,</span>
            <span class="s1">&#39;position_size&#39;</span><span class="p">:</span> <span class="n">position_size</span><span class="p">,</span>
            <span class="s1">&#39;risk_score&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_risk_score</span><span class="p">(</span><span class="n">volatility</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">max_dd</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="7-kubernetes">–®–∞–≥ 7: Kubernetes –¥–µ–ø–ª–æ–π</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># kubernetes-deployment.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-gateway</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system/api-gateway:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_URL</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis://redis-service:6379&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgresql://user:pass@postgres-service:5432/mldb&quot;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data-service</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system/data-service:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5001</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-service</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system/model-service:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5002</span>
<span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000m&quot;</span>
<span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4Gi&quot;</span>
<span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2000m&quot;</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">risk-service</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system/risk-service:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5003</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trading-service</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system/trading-service:latest</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5004</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BLOCKCHAIN_RPC</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PRIVATE_KEY</span>
<span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<span class="w">            </span><span class="nt">secretKeyRef</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">blockchain-secrets</span>
<span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private-key</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system-service</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml-system</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-gateway</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data-service</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5001</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5001</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model-service</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5002</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5002</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">risk-service</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5003</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5003</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trading-service</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5004</span>
<span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5004</span>
</code></pre></div>

<h2 id="8_1">–®–∞–≥ 8: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h2>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedMonitoring</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_model_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">actuals</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">actuals</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span>
        <span class="p">})</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">recent_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]])</span>
            <span class="n">historical_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">recent_accuracy</span> <span class="o">&lt;</span> <span class="n">historical_accuracy</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trigger_alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> performance degraded&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_system_health</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤</span>
        <span class="k">for</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">service_url</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">service_url</span><span class="si">}</span><span class="s2">/health&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2"> is unhealthy&quot;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trigger_alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2"> is unreachable&quot;</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_resource_usage</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_latency</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">trigger_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span>

        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>

        <span class="c1"># –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_notification</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">auto_retrain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">performance_threshold</span><span class="o">=</span><span class="mf">0.6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">performance_threshold</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Triggering auto-retrain for </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># –°–±–æ—Ä –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_new_data</span><span class="p">()</span>

            <span class="c1"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
            <span class="n">retrained_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrain_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">new_data</span><span class="p">)</span>

            <span class="c1"># A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab_test_models</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">retrained_model</span><span class="p">)</span>
</code></pre></div>

<h2 id="9_1">–®–∞–≥ 9: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># main_system.py</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AdvancedMLSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª–Ω–∞—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è ML —Å–∏—Å—Ç–µ–º–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span> <span class="o">=</span> <span class="n">AdvancedDataProcessor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_system</span> <span class="o">=</span> <span class="n">MultiModelSystem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="n">AdvancedRiskManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span> <span class="o">=</span> <span class="n">AdvancedMonitoring</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_gateway</span> <span class="o">=</span> <span class="n">APIGateway</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_production_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_processor</span><span class="o">.</span><span class="n">collect_multi_source_data</span><span class="p">([</span><span class="s1">&#39;BTC-USD&#39;</span><span class="p">,</span> <span class="s1">&#39;ETH-USD&#39;</span><span class="p">])</span>

                <span class="c1"># 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_system</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

                <span class="c1"># 3. –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤</span>
                <span class="n">risk_assessment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span><span class="o">.</span><span class="n">assess_risks</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                <span class="c1"># 4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</span>
                <span class="k">if</span> <span class="n">risk_assessment</span><span class="p">[</span><span class="s1">&#39;risk_score&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">:</span>  <span class="c1"># –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫</span>
                    <span class="n">trade_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_trades</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">risk_assessment</span><span class="p">)</span>

                    <span class="c1"># 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span><span class="o">.</span><span class="n">monitor_trades</span><span class="p">(</span><span class="n">trade_results</span><span class="p">)</span>

                <span class="c1"># 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span><span class="o">.</span><span class="n">check_retrain_required</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">retrain_models</span><span class="p">()</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span><span class="o">.</span><span class="n">trigger_alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">AdvancedMLSystem</span><span class="p">()</span>
    <span class="n">system</span><span class="o">.</span><span class="n">run_production_system</span><span class="p">()</span>
</code></pre></div>

<h2 id="_273">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 id="_274">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª—è</strong>: 78.5%</li>
<li><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –®–∞—Ä–ø–∞</strong>: 2.1</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 5.8%</li>
<li><strong>VaR (95%)</strong>: 2.3%</li>
<li><strong>–û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 34.2% –∑–∞ –≥–æ–¥</li>
<li><strong>Win Rate</strong>: 68.4%</li>
</ul>
<h3 id="_275">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞</h3>
<ol>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –∞–Ω—Å–∞–º–±–ª—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong> - –ø–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h3 id="_276">–°–ª–æ–∂–Ω–æ—Å—Ç—å</h3>
<ol>
<li><strong>–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
<li><strong>–†–µ—Å—É—Ä—Å–æ–µ–º–∫–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è</strong> - —Ç—Ä–µ–±—É–µ—Ç DevOps —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏</strong> - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
</ol>
<h2 id="_277">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é ML-—Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ DEX blockchain —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π. –•–æ—Ç—è —Å–∏—Å—Ç–µ–º–∞ —Å–ª–æ–∂–Ω–∞—è, –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å.</p>
<hr />
<h1 id="automl">–¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="automl_1">–ü–æ—á–µ–º—É —Ç–µ–æ—Ä–∏—è AutoML –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 80% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π AutoML –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç AutoML –∫–∞–∫ "—á–µ—Ä–Ω—ã–π —è—â–∏–∫", –Ω–µ –ø–æ–Ω–∏–º–∞—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –µ–≥–æ —Ä–∞–±–æ—Ç—ã. –≠—Ç–æ –∫–∞–∫ –≤–æ–∂–¥–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—å.</p>
<h3 id="_278">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–µ–æ—Ä–∏–∏</h3>
<ul>
<li><strong>–°–ª–µ–ø–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</strong>: –ù–µ –ø–æ–Ω–∏–º–∞—é—Ç, –ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</strong>: –ù–µ –º–æ–≥—É—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</li>
<li><strong>–ü–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ù–µ –∑–Ω–∞—é—Ç, –∫–∞–∫ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞</strong>: –ù–µ –º–æ–≥—É—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ</li>
</ul>
<h3 id="_279">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–µ–æ—Ä–∏–∏</h3>
<ul>
<li><strong>–û—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</strong>: –ü–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –∏ –ø–æ—á–µ–º—É –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</strong>: –ú–æ–≥—É—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –∑–∞–¥–∞—á—É</li>
<li><strong>–õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ó–Ω–∞—é—Ç, –∫–∞–∫ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å</strong>: –ú–æ–≥—É—Ç —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É</li>
</ul>
<h2 id="automl_2">–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ–æ—Ä–∏—é AutoML</h2>
<p><img alt="–¢–µ–æ—Ä–∏—è AutoML" src="images/automl_theory.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 14.1: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</em></p>
<p><strong>–ü–æ—á–µ–º—É AutoML - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É"?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.</p>
<p>AutoML (Automated Machine Learning) - —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è ML-–º–æ–¥–µ–ª–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AutoML Gluon.</p>
<h2 id="automl_3">–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ AutoML</h2>
<h3 id="1-neural-architecture-search-nas">1. Neural Architecture Search (NAS)</h3>
<p><strong>–ü–æ—á–µ–º—É NAS - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –¥–∏–∑–∞–π–Ω–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —á–µ–ª–æ–≤–µ–∫–æ–º, —ç–∫–æ–Ω–æ–º—è –º–µ—Å—è—Ü—ã —Ä–∞–±–æ—Ç—ã —ç–∫—Å–ø–µ—Ä—Ç–æ–≤.</p>
<p>Neural Architecture Search - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.</p>
<p><strong>–ü–æ—á–µ–º—É NAS —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ —á–µ–ª–æ–≤–µ–∫–∞?</strong><br />
- <strong>–û–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</strong>: –ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–µ–¥—Ä–∞—Å—Å—É–¥–∫–∞–º–∏ –∏ –æ–ø—ã—Ç–æ–º<br />
- <strong>–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è</strong>: –ú–æ–∂–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—ã—Å—è—á–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä<br />
- <strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</strong>: –ù–∞—Ö–æ–¥–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É<br />
- <strong>–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏</strong>: –ú–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–∏–º–µ—Ä NAS –≤ AutoGluon - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.vision</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImagePredictor</span>

<span class="c1"># NAS –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">ImagePredictor</span><span class="p">()</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;resnet50&#39;</span><span class="p">,</span>  <span class="c1"># –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞</span>
        <span class="s1">&#39;nas&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>          <span class="c1"># –í–∫–ª—é—á–∏—Ç—å NAS - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫</span>
        <span class="s1">&#39;nas_lr&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>       <span class="c1"># Learning rate –¥–ª—è NAS - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</span>
        <span class="s1">&#39;nas_epochs&#39;</span><span class="p">:</span> <span class="mi">50</span>     <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –¥–ª—è NAS - –≤—Ä–µ–º—è –Ω–∞ –ø–æ–∏—Å–∫</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="2-hyperparameter-optimization">2. Hyperparameter Optimization</h3>
<p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è AutoML.</p>
<h4 id="_280">–ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:</h4>
<p><strong>Grid Search:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —Å–µ—Ç–∫–µ</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Random Search:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–∏—Å–∫</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Bayesian Optimization:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ë–∞–π–µ—Å–æ–≤—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">space</span>

<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="n">space</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">space</span><span class="o">.</span><span class="n">Real</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">space</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="3-feature-engineering-automation">3. Feature Engineering Automation</h3>
<p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ - –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å AutoML.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">feature_generator_type</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>  <span class="c1"># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">feature_generator_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;enable_text_special_features&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;enable_text_ngram_features&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;enable_datetime_features&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;enable_categorical_features&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="_281">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã</h2>
<h3 id="1-loss-functions">1. Loss Functions</h3>
<p>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—Ç–µ—Ä—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FocalLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Focal Loss –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FocalLoss</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="n">ce_loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ce_loss</span><span class="p">)</span>
        <span class="n">focal_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">ce_loss</span>
        <span class="k">return</span> <span class="n">focal_loss</span>
</code></pre></div>

<h3 id="2-optimization-algorithms">2. Optimization Algorithms</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –†–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã</span>
<span class="n">optimizers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;adam&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="s1">&#39;betas&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">),</span>
        <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span>
    <span class="p">},</span>
    <span class="s1">&#39;sgd&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s1">&#39;momentum&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">1e-4</span>
    <span class="p">},</span>
    <span class="s1">&#39;rmsprop&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
        <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="3-regularization-techniques">3. Regularization Techniques</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ú–µ—Ç–æ–¥—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏</span>
<span class="n">regularization</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>      <span class="c1"># L1 regularization</span>
    <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>      <span class="c1"># L2 regularization</span>
    <span class="s1">&#39;dropout&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Dropout</span>
    <span class="s1">&#39;batch_norm&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Batch normalization</span>
    <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;min_delta&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="ensemble-methods">Ensemble Methods</h2>
<h3 id="1-bagging">1. Bagging</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Bagging –≤ AutoGluon</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
    <span class="n">num_bag_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>    <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ –¥–ª—è bagging</span>
    <span class="n">num_bag_sets</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>     <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤</span>
    <span class="n">num_stack_levels</span><span class="o">=</span><span class="mi">1</span>  <span class="c1"># –£—Ä–æ–≤–Ω–∏ —Å—Ç–µ–∫–∏–Ω–≥–∞</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="2-boosting">2. Boosting</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Boosting –∞–ª–≥–æ—Ä–∏—Ç–º—ã</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span>
    <span class="p">},</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span>
    <span class="p">},</span>
    <span class="s1">&#39;LGB&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="3-stacking">3. Stacking</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç–µ–∫–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π</span>
<span class="n">stacking_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;num_bag_folds&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;num_bag_sets&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;num_stack_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;stacker_models&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GBM&#39;</span><span class="p">,</span> <span class="s1">&#39;XGB&#39;</span><span class="p">,</span> <span class="s1">&#39;LGB&#39;</span><span class="p">],</span>
    <span class="s1">&#39;stacker_hyperparameters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="advanced-concepts">Advanced Concepts</h2>
<h3 id="1-multi-task-learning">1. Multi-Task Learning</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ú—É–ª—å—Ç–∏–∑–∞–¥–∞—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MultiTaskPredictor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tasks</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tasks</span> <span class="o">=</span> <span class="n">tasks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictors</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predictors</span><span class="p">[</span><span class="n">task</span><span class="p">]</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
                <span class="n">problem_type</span><span class="o">=</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">predictor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">task_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]]]</span>
            <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">task_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-transfer-learning">2. Transfer Learning</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –¢—Ä–∞–Ω—Å—Ñ–µ—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">transfer_learning</span><span class="p">(</span><span class="n">source_data</span><span class="p">,</span> <span class="n">target_data</span><span class="p">,</span> <span class="n">source_label</span><span class="p">,</span> <span class="n">target_label</span><span class="p">):</span>
    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">source_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">source_label</span><span class="p">)</span>
    <span class="n">source_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">source_data</span><span class="p">)</span>

    <span class="c1"># –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">source_features</span> <span class="o">=</span> <span class="n">source_predictor</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">target_data</span><span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</span>
    <span class="n">target_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">target_label</span><span class="p">)</span>
    <span class="n">target_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">source_features</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">target_predictor</span>
</code></pre></div>

<h3 id="3-meta-learning">3. Meta-Learning</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ú–µ—Ç–∞-–æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MetaLearner</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_features</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_performance</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_meta_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞&quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;n_samples&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span>
            <span class="s1">&#39;n_features&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;n_classes&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
            <span class="s1">&#39;missing_ratio&#39;</span><span class="p">:</span> <span class="n">dataset</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span>
            <span class="s1">&#39;categorical_ratio&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">recommend_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>
        <span class="n">meta_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_meta_features</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞</span>
        <span class="k">if</span> <span class="n">meta_features</span><span class="p">[</span><span class="s1">&#39;n_samples&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;GBM&#39;</span>
        <span class="k">elif</span> <span class="n">meta_features</span><span class="p">[</span><span class="s1">&#39;categorical_ratio&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;CAT&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;XGB&#39;</span>
</code></pre></div>

<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="1-memory-optimization">1. Memory Optimization</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimize_memory</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">128</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">127</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">65535</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint16&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">32768</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">32767</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int16&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

    <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è float —Ç–∏–ø–æ–≤</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="2-computational-optimization">2. Computational Optimization</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parallel_processing</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∞—Å—Ç–∏</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">//</span> <span class="n">n_jobs</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>

    <span class="c1"># –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</span>
    <span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">process_chunk</span><span class="p">,</span> <span class="n">chunks</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>

<h2 id="theoretical-guarantees">Theoretical Guarantees</h2>
<h3 id="1-convergence-guarantees">1. Convergence Guarantees</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ì–∞—Ä–∞–Ω—Ç–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
<span class="n">convergence_guarantees</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;convergence_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;O(1/sqrt(T))&#39;</span><span class="p">,</span>
        <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;convex_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;bounded_gradients&#39;</span><span class="p">],</span>
        <span class="s1">&#39;theorem&#39;</span><span class="p">:</span> <span class="s1">&#39;GBM converges to global optimum for convex loss&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;convergence_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;O(log(T)/T)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;strongly_convex_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;bounded_hessian&#39;</span><span class="p">],</span>
        <span class="s1">&#39;theorem&#39;</span><span class="p">:</span> <span class="s1">&#39;XGB converges with rate O(log(T)/T)&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="2-generalization-bounds">2. Generalization Bounds</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ì—Ä–∞–Ω–∏—Ü—ã –æ–±–æ–±—â–µ–Ω–∏—è</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generalization_bound</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ì—Ä–∞–Ω–∏—Ü–∞ –æ–±–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞&quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

    <span class="c1"># VC dimension bound</span>
    <span class="n">vc_bound</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">delta</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Rademacher complexity bound</span>
    <span class="n">rademacher_bound</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">vc_bound</span><span class="p">,</span> <span class="n">rademacher_bound</span><span class="p">)</span>
</code></pre></div>

<h2 id="research-frontiers">Research Frontiers</h2>
<h3 id="1-neural-architecture-search">1. Neural Architecture Search</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã NAS</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DARTS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Differentiable Architecture Search&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_space</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_space</span> <span class="o">=</span> <span class="n">search_space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">architecture_weights</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_architecture_weights</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_model_weights</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_architecture_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DARTS</span>
        <span class="k">pass</span>
</code></pre></div>

<h3 id="2-automl-for-time-series">2. AutoML for Time Series</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># AutoML –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesPredictor</span>

<span class="k">def</span><span class="w"> </span><span class="nf">time_series_automl</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prediction_length</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;AutoML –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤&quot;&quot;&quot;</span>

    <span class="n">predictor</span> <span class="o">=</span> <span class="n">TimeSeriesPredictor</span><span class="p">(</span>
        <span class="n">prediction_length</span><span class="o">=</span><span class="n">prediction_length</span><span class="p">,</span>
        <span class="n">target</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
        <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span>  <span class="c1"># 1 —á–∞—Å</span>
    <span class="p">)</span>

    <span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictor</span>
</code></pre></div>

<h2 id="_282">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤ AutoML –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è:</p>
<ol>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</strong> - –∑–Ω–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö –∏ —Å–ª–∞–±—ã—Ö —Å—Ç–æ—Ä–æ–Ω</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤</li>
<li><strong>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤</strong> - –æ—Å–Ω–æ–≤–∞ –¥–ª—è –∏–Ω–Ω–æ–≤–∞—Ü–∏–π</li>
</ol>
<p>–≠—Ç–∏ –∑–Ω–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AutoML Gluon –Ω–µ –∫–∞–∫ "—á–µ—Ä–Ω—ã–π —è—â–∏–∫", –∞ –∫–∞–∫ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –µ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤.</p>
<hr />
<h1 id="_283">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_284">–ü–æ—á–µ–º—É –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 90% ML-–º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–µ –∏–º–µ—é—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª–∏. –≠—Ç–æ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPS –±–µ–∑ –∫–∞—Ä—Ç—ã - –≤—ã –¥–æ–µ–¥–µ—Ç–µ, –Ω–æ –Ω–µ –ø–æ–π–º–µ—Ç–µ, –∫–∞–∫.</p>
<h3 id="_285">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ–æ–±—ä—è—Å–Ω–∏–º—ã—Ö –º–æ–¥–µ–ª–µ–π</h3>
<ul>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è</strong>: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –¥–æ–≤–µ—Ä—è—é—Ç "—á–µ—Ä–Ω—ã–º —è—â–∏–∫–∞–º"</li>
<li><strong>–†–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã</strong>: GDPR —à—Ç—Ä–∞—Ñ—ã –¥–æ 4% –æ—Ç –æ–±–æ—Ä–æ—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏</li>
<li><strong>–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è</strong>: –ú–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏</strong>: –ù–µ–ª—å–∑—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏</li>
</ul>
<h3 id="_286">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π</h3>
<ul>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong>: –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–∞–º</strong>: GDPR, AI Act, –¥—Ä—É–≥–∏–µ —Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</li>
<li><strong>–õ—É—á—à–∞—è –æ—Ç–ª–∞–¥–∫–∞</strong>: –ú–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏</li>
<li><strong>–£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</strong>: –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
</ul>
<h2 id="_287">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</h2>
<p><img alt="–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ML" src="images/interpretability_overview.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 15.1: –û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ ML-–º–æ–¥–µ–ª–µ–π</em></p>
<p><strong>–ü–æ—á–µ–º—É –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å - —ç—Ç–æ –Ω–µ —Ä–æ—Å–∫–æ—à—å, –∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ ML-–º–æ–¥–µ–ª–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π, –∏ —ç—Ç–∏ —Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º–∏.</p>
<p>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è - —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞—Ç—å –∏ –æ–±—ä—è—Å–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã–µ ML-–º–æ–¥–µ–ª—è–º–∏. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è:<br />
- <strong>–î–æ–≤–µ—Ä–∏—è –∫ –º–æ–¥–µ–ª–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π<br />
- <strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act<br />
- <strong>–û—Ç–ª–∞–¥–∫–∞ –º–æ–¥–µ–ª–µ–π</strong> - –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Å–º–µ—â–µ–Ω–∏–π<br />
- <strong>–£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</p>
<h2 id="_288">–¢–∏–ø—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 id="1-intrinsic-interpretability">1. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (Intrinsic Interpretability)</h3>
<p><strong>–ü–æ—á–µ–º—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å - —ç—Ç–æ –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–µ–ª—å —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –ø–æ–Ω—è—Ç–Ω–∞, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ –¥–∞–µ—Ç —Ç–æ—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏.</p>
<p>–ú–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã:</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏:</strong><br />
- <strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ç–æ—á–Ω–æ –æ—Ç—Ä–∞–∂–∞—é—Ç –ª–æ–≥–∏–∫—É –º–æ–¥–µ–ª–∏<br />
- <strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞</strong>: –ù–µ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—ä—è—Å–Ω–µ–Ω–∏—è<br />
- <strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã<br />
- <strong>–ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å</strong>: –õ–æ–≥–∏–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–∞</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ–π –º–æ–¥–µ–ª–∏ - –ø—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ - –ø—Ä—è–º–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ</span>
<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ - –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤–∞–∂–Ω–µ–µ –≤—Å–µ–≥–æ</span>
<span class="n">importance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
    <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importance</span>
<span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">importance_df</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-post-hoc-interpretability">2. –ü–æ—Å—Ç-—Ö–æ–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (Post-hoc Interpretability)</h3>
<p>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —É–∂–µ –æ–±—É—á–µ–Ω–Ω—ã—Ö "—á–µ—Ä–Ω—ã—Ö —è—â–∏–∫–æ–≤":</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># SHAP –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö –º–æ–¥–µ–ª–µ–π</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ SHAP explainer</span>
<span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">())</span>
<span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
<span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</code></pre></div>

<h2 id="_289">–ú–µ—Ç–æ–¥—ã –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 id="1-feature-importance">1. Feature Importance</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_feature_importance</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;permutation&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;permutation&#39;</span><span class="p">:</span>
        <span class="c1"># Permutation importance</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.inspection</span><span class="w"> </span><span class="kn">import</span> <span class="n">permutation_importance</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>
        <span class="n">perm_importance</span> <span class="o">=</span> <span class="n">permutation_importance</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">perm_importance</span><span class="o">.</span><span class="n">importances_mean</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;shap&#39;</span><span class="p">:</span>
        <span class="c1"># SHAP importance</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>

        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">())</span>
        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">shap_values</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;builtin&#39;</span><span class="p">:</span>
        <span class="c1"># –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å (–¥–ª—è tree-based –º–æ–¥–µ–ª–µ–π)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;feature_importances_&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model doesn&#39;t support built-in feature importance&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-partial-dependence-plots-pdp">2. Partial Dependence Plots (PDP)</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.inspection</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial_dependence</span><span class="p">,</span> <span class="n">plot_partial_dependence</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_pdp</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —á–∞—Å—Ç–∏—á–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>

    <span class="c1"># PDP –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pdp</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">partial_dependence</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">grid_resolution</span><span class="o">=</span><span class="mi">50</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pdp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Partial Dependence&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Partial Dependence Plot for </span><span class="si">{</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># PDP –¥–ª—è –¥–≤—É—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">pdp</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">partial_dependence</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">grid_resolution</span><span class="o">=</span><span class="mi">20</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pdp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Partial Dependence Plot for </span><span class="si">{</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="3-accumulated-local-effects-ale">3. Accumulated Local Effects (ALE)</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">alibi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">alibi.explainers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALE</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_ale</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ALE –≥—Ä–∞—Ñ–∏–∫–æ–≤&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ ALE explainer</span>
    <span class="n">ale</span> <span class="o">=</span> <span class="n">ALE</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ ALE</span>
    <span class="n">ale_exp</span> <span class="o">=</span> <span class="n">ale</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>

    <span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ale_exp</span><span class="o">.</span><span class="n">feature_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ale_exp</span><span class="o">.</span><span class="n">ale_values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ALE&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accumulated Local Effects for </span><span class="si">{</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h2 id="_290">–ú–µ—Ç–æ–¥—ã –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</h2>
<h3 id="1-lime-local-interpretable-model-agnostic-explanations">1. LIME (Local Interpretable Model-agnostic Explanations)</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">lime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lime.lime_tabular</span>

<span class="k">def</span><span class="w"> </span><span class="nf">explain_with_lime</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">instance_idx</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é LIME&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ LIME explainer</span>
    <span class="n">explainer</span> <span class="o">=</span> <span class="n">lime</span><span class="o">.</span><span class="n">lime_tabular</span><span class="o">.</span><span class="n">LimeTabularExplainer</span><span class="p">(</span>
        <span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">feature_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;classification&#39;</span>
    <span class="p">)</span>

    <span class="c1"># –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞</span>
    <span class="n">explanation</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain_instance</span><span class="p">(</span>
        <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">instance_idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">,</span>
        <span class="n">num_features</span><span class="o">=</span><span class="n">num_features</span>
    <span class="p">)</span>

    <span class="c1"># –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</span>
    <span class="n">explanation</span><span class="o">.</span><span class="n">show_in_notebook</span><span class="p">(</span><span class="n">show_table</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">explanation</span>
</code></pre></div>

<h3 id="2-shap-shapley-additive-explanations">2. SHAP (SHapley Additive exPlanations)</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>

<span class="k">def</span><span class="w"> </span><span class="nf">explain_with_shap</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">instance_idx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é SHAP&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ SHAP explainer</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
        <span class="c1"># –î–ª—è tree-based –º–æ–¥–µ–ª–µ–π</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">instance_idx</span><span class="p">:</span><span class="n">instance_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –î–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">Explainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">instance_idx</span><span class="p">:</span><span class="n">instance_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># –í–æ–¥–æ–ø–∞–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">shap</span><span class="o">.</span><span class="n">waterfall_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">,</span> <span class="n">shap_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">instance_idx</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">shap_values</span>
</code></pre></div>

<h3 id="3-integrated-gradients">3. Integrated Gradients</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrated_gradients</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã—á–∏—Å–ª–µ–Ω–∏–µ Integrated Gradients&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∞–ª—å—Ñ–∞ –∑–Ω–∞—á–µ–Ω–∏–π</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

    <span class="c1"># –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É baseline –∏ X</span>
    <span class="n">interpolated</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
        <span class="n">interpolated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">baseline</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">))</span>

    <span class="n">interpolated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interpolated</span><span class="p">)</span>

    <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">tape</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">interpolated</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">interpolated</span><span class="p">)</span>

    <span class="n">gradients</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">interpolated</span><span class="p">)</span>

    <span class="c1"># –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span>
    <span class="n">integrated_grads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">integrated_grads</span>
</code></pre></div>

<h2 id="automl-gluon_9">–°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è AutoML Gluon</h2>
<h3 id="1-model-specific-interpretability">1. Model-specific Interpretability</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_model_specific_explanations</span><span class="p">(</span><span class="n">predictor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="n">explanations</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="s1">&#39;XGB&#39;</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="ow">or</span> <span class="s1">&#39;LGB&#39;</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="ow">or</span> <span class="s1">&#39;GBM&#39;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
        <span class="c1"># Tree-based –º–æ–¥–µ–ª–∏</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;tree_structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_booster</span><span class="p">()</span><span class="o">.</span><span class="n">get_dump</span><span class="p">()</span>

    <span class="k">elif</span> <span class="s1">&#39;Neural&#39;</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="ow">or</span> <span class="s1">&#39;TabNet&#39;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
        <span class="c1"># –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;attention_weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">attention_weights</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;feature_embeddings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_embeddings</span>

    <span class="k">elif</span> <span class="s1">&#39;Linear&#39;</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="ow">or</span> <span class="s1">&#39;Logistic&#39;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
        <span class="c1"># –õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
        <span class="n">explanations</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>

    <span class="k">return</span> <span class="n">explanations</span>
</code></pre></div>

<h3 id="2-ensemble-interpretability">2. Ensemble Interpretability</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">explain_ensemble</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="n">models</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_names</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_weights</span><span class="p">()</span>

    <span class="n">explanations</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;weighted&#39;</span><span class="p">:</span>
            <span class="c1"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;feature_importances_&#39;</span><span class="p">):</span>
                <span class="n">importance</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="o">*</span> <span class="n">weight</span>
                <span class="n">explanations</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">importance</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;shap&#39;</span><span class="p">:</span>
            <span class="c1"># SHAP –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span>
            <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">explanations</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">shap_values</span> <span class="o">*</span> <span class="n">weight</span>

    <span class="c1"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;weighted&#39;</span><span class="p">:</span>
        <span class="n">ensemble_importance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explanations</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ensemble_importance</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;shap&#39;</span><span class="p">:</span>
        <span class="n">ensemble_shap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explanations</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ensemble_shap</span>
</code></pre></div>

<h2 id="_291">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</h2>
<h3 id="1-comprehensive-explanation-dashboard">1. Comprehensive Explanation Dashboard</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_explanation_dashboard</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">instance_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comprehensive Model Explanation Dashboard&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># 1. Feature Importance</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">importance</span> <span class="o">=</span> <span class="n">get_feature_importance</span><span class="p">(</span><span class="n">predictor</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">importance</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_idx</span><span class="p">)),</span> <span class="n">importance</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_idx</span><span class="p">)))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_idx</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Top 10 Feature Importance&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>

    <span class="c1"># 2. SHAP Summary</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>
    <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>  <span class="c1"># –ü–µ—Ä–≤—ã–µ 100 –æ–±—Ä–∞–∑—Ü–æ–≤</span>

    <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SHAP Summary Plot&#39;</span><span class="p">)</span>

    <span class="c1"># 3. Partial Dependence</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">top_feature</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">pdp</span><span class="p">,</span> <span class="n">axes_pdp</span> <span class="o">=</span> <span class="n">partial_dependence</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="p">[</span><span class="n">top_feature</span><span class="p">])</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes_pdp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pdp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">top_feature</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Partial Dependence&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDP for </span><span class="si">{</span><span class="n">top_feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># 4. Local Explanation (LIME)</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="c1"># –ó–¥–µ—Å—å –±—É–¥–µ—Ç LIME –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;LIME Explanation</span><span class="se">\n</span><span class="s1">for Instance&#39;</span><span class="p">,</span> 
             <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax4</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Local Explanation (LIME)&#39;</span><span class="p">)</span>

    <span class="c1"># 5. Model Performance</span>
    <span class="n">ax5</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">ax5</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Model Performance&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Score&#39;</span><span class="p">)</span>

    <span class="c1"># 6. Prediction Distribution</span>
    <span class="n">ax6</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">probabilities</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction Probability&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
        <span class="n">ax6</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Prediction Distribution&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<h3 id="2-interactive-explanations">2. Interactive Explanations</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_interactive_explanation</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">instance_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">()</span>

    <span class="c1"># SHAP –∑–Ω–∞—á–µ–Ω–∏—è</span>
    <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">instance_idx</span><span class="p">:</span><span class="n">instance_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Waterfall plot</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">shap_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SHAP Values&#39;</span><span class="p">,</span>
        <span class="n">marker_color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;green&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;SHAP Values for Instance </span><span class="si">{</span><span class="n">instance_idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;SHAP Value&#39;</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div>

<h2 id="_292">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
<h3 id="1_23">1. –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choose_explanation_method</span><span class="p">(</span><span class="n">model_type</span><span class="p">,</span> <span class="n">data_size</span><span class="p">,</span> <span class="n">interpretability_requirement</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –º–µ—Ç–æ–¥–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">interpretability_requirement</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span><span class="p">:</span>
        <span class="c1"># –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Logistic&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;coefficients&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;lime&#39;</span>

    <span class="k">elif</span> <span class="n">interpretability_requirement</span> <span class="o">==</span> <span class="s1">&#39;medium&#39;</span><span class="p">:</span>
        <span class="c1"># –°—Ä–µ–¥–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</span>
        <span class="k">if</span> <span class="n">data_size</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;shap&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;permutation_importance&#39;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># –ù–∏–∑–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</span>
        <span class="k">return</span> <span class="s1">&#39;feature_importance&#39;</span>
</code></pre></div>

<h3 id="2_21">2. –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_explanations</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">explanation_method</span><span class="o">=</span><span class="s1">&#39;shap&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π</span>
    <span class="k">if</span> <span class="n">explanation_method</span> <span class="o">==</span> <span class="s1">&#39;shap&#39;</span><span class="p">:</span>
        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">predictor</span><span class="o">.</span><span class="n">get_model_best</span><span class="p">())</span>
        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</span>
        <span class="n">consistency_score</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">consistency_score</span><span class="p">(</span><span class="n">shap_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;consistency_score&#39;</span><span class="p">:</span> <span class="n">consistency_score</span><span class="p">,</span>
            <span class="s1">&#39;explanation_quality&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="n">consistency_score</span> <span class="o">&gt;</span> <span class="mf">0.8</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span>
        <span class="p">}</span>

    <span class="k">elif</span> <span class="n">explanation_method</span> <span class="o">==</span> <span class="s1">&#39;lime&#39;</span><span class="p">:</span>
        <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è LIME</span>
        <span class="n">lime_explainer</span> <span class="o">=</span> <span class="n">lime</span><span class="o">.</span><span class="n">lime_tabular</span><span class="o">.</span><span class="n">LimeTabularExplainer</span><span class="p">(</span>
            <span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö</span>
        <span class="n">fidelity_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))):</span>
            <span class="n">explanation</span> <span class="o">=</span> <span class="n">lime_explainer</span><span class="o">.</span><span class="n">explain_instance</span><span class="p">(</span>
                <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span>
            <span class="p">)</span>
            <span class="n">fidelity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">explanation</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;average_fidelity&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fidelity_scores</span><span class="p">),</span>
            <span class="s1">&#39;explanation_quality&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fidelity_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.8</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_293">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è:</p>
<ol>
<li><strong>–î–æ–≤–µ—Ä–∏—è –∫ –º–æ–¥–µ–ª–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act, —Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</li>
<li><strong>–û—Ç–ª–∞–¥–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è</strong> - –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç–∏</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
</ol>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ—á–Ω—ã–µ, –Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏ –Ω–∞–¥–µ–∂–Ω—ã–µ ML-–º–æ–¥–µ–ª–∏.</p>
<hr />
<h1 id="automl_4">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="_294">–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã</h2>
<p><strong>–ü–æ—á–µ–º—É 95% ML-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –Ω–µ –∑–Ω–∞—é—Ç –æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏–∫–∞—Ö?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ –±–∞–∑–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö, –Ω–µ –ø–æ–Ω–∏–º–∞—è, —á—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –¥–∞—Ç—å –≤ 10-100 —Ä–∞–∑ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>
<h3 id="_295">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º</h3>
<ul>
<li><strong>–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –º–µ—Ç–æ–¥—ã</strong>: –ò—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ—Ö–Ω–∏–∫–∏ 5-–ª–µ—Ç–Ω–µ–π –¥–∞–≤–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ù–µ –º–æ–≥—É—Ç –¥–æ—Å—Ç–∏—á—å state-of-the-art –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</strong>: –û—Ç—Å—Ç–∞—é—Ç –æ—Ç –∫–æ–º–∞–Ω–¥, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã</li>
<li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</strong>: –ù–µ –º–æ–≥—É—Ç —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏</li>
</ul>
<h3 id="_296">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∑–Ω–∞–Ω–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º</h3>
<ul>
<li><strong>–õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: State-of-the-art –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å</strong>: –ò—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∞–º—ã–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã</li>
<li><strong>–†–µ—à–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á</strong>: –ú–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
<li><strong>–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏</strong>: –ú–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è</li>
</ul>
<h2 id="_297">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</h2>
<p><img alt="–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML" src="images/advanced_topics_overview.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 16.1: –û–±–∑–æ—Ä –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ–º –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ AutoML</em></p>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã - —ç—Ç–æ –±—É–¥—É—â–µ–µ ML?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ä–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ.</p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ–º—ã –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –Ω–µ–π—Ä–æ–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–∏—Å–∫, –º–µ—Ç–∞-–æ–±—É—á–µ–Ω–∏–µ, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –¥—Ä—É–≥–∏–µ cutting-edge —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.</p>
<h2 id="neural-architecture-search-nas">Neural Architecture Search (NAS)</h2>
<h3 id="1-differentiable-architecture-search-darts">1. Differentiable Architecture Search (DARTS)</h3>
<p><strong>–ü–æ—á–µ–º—É DARTS - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –¥–∏–∑–∞–π–Ω–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, —á—Ç–æ –≤ 1000 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–æ–∏—Å–∫–∞.</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ DARTS:</strong><br />
- <strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong>: –í 1000 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞<br />
- <strong>–ö–∞—á–µ—Å—Ç–≤–æ</strong>: –ù–∞—Ö–æ–¥–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ª—É—á—à–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —á–µ–ª–æ–≤–µ–∫–æ–º<br />
- <strong>–ì–∏–±–∫–æ—Å—Ç—å</strong>: –ú–æ–∂–µ—Ç –∏—Å–∫–∞—Ç—å –ª—é–±—ã–µ —Ç–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π<br />
- <strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –†–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">F</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DARTS</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Differentiable Architecture Search - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="n">num_ops</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DARTS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span> <span class="o">=</span> <span class="n">input_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_channels</span> <span class="o">=</span> <span class="n">output_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_ops</span> <span class="o">=</span> <span class="n">num_ops</span>

        <span class="c1"># –û–ø–µ—Ä–∞—Ü–∏–∏ - –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>      <span class="c1"># 1x1 conv</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>  <span class="c1"># 3x3 conv</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>  <span class="c1"># 5x5 conv</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>                          <span class="c1"># Max pooling</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>                          <span class="c1"># Average pooling</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span> <span class="k">if</span> <span class="n">input_channels</span> <span class="o">==</span> <span class="n">output_channels</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Identity</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>  <span class="c1"># Dilated conv</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">output_channels</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># Dilated conv</span>
        <span class="p">])</span>

        <span class="c1"># –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–µ—Å–∞ - —á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">num_ops</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># Softmax –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≤–µ—Å–æ–≤ - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–π - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">op</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="p">)</span> <span class="k">if</span> <span class="n">op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DARTS</span>
<span class="k">def</span><span class="w"> </span><span class="nf">search_architecture</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–∏—Å–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –ø–æ–º–æ—â—å—é DARTS&quot;&quot;&quot;</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">DARTS</span><span class="p">(</span><span class="n">input_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≤–µ—Å–æ–≤</span>
        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span>
        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">val_loader</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Validation Loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div>

<h3 id="2-efficient-neural-architecture-search-enas">2. Efficient Neural Architecture Search (ENAS)</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ENAS</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Efficient Neural Architecture Search&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_ops</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ENAS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="n">num_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_ops</span> <span class="o">=</span> <span class="n">num_ops</span>

        <span class="c1"># –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (RNN)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller_output</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_nodes</span> <span class="o">*</span> <span class="n">num_ops</span><span class="p">)</span>

        <span class="c1"># –û–ø–µ—Ä–∞—Ü–∏–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
        <span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_architecture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span>
        <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># LSTM hidden state</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">):</span>
            <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">hidden</span><span class="p">)</span>
            <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller_output</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
            <span class="n">logits</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_ops</span><span class="p">)</span>
            <span class="n">probs</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">architecture</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">architecture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_architecture</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">op_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">architecture</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="p">[</span><span class="n">op_idx</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span>
</code></pre></div>

<h2 id="meta-learning">Meta-Learning</h2>
<h3 id="1-model-agnostic-meta-learning-maml">1. Model-Agnostic Meta-Learning (MAML)</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MAML</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model-Agnostic Meta-Learning&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MAML</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">meta_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">support_set</span><span class="p">,</span> <span class="n">query_set</span><span class="p">,</span> <span class="n">num_inner_steps</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–µ—Ç–∞-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
        <span class="n">fast_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">()}</span>

        <span class="c1"># –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_inner_steps</span><span class="p">):</span>
            <span class="c1"># Forward pass –Ω–∞ support set</span>
            <span class="n">support_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_with_weights</span><span class="p">(</span><span class="n">support_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fast_weights</span><span class="p">)</span>
            <span class="n">support_loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">support_pred</span><span class="p">,</span> <span class="n">support_set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã</span>
            <span class="n">grads</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">support_loss</span><span class="p">,</span> <span class="n">fast_weights</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">create_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span>
            <span class="n">fast_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">weight</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">*</span> <span class="n">grad</span> 
                          <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">weight</span><span class="p">),</span> <span class="n">grad</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fast_weights</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">grads</span><span class="p">)}</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ query set</span>
        <span class="n">query_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_with_weights</span><span class="p">(</span><span class="n">query_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fast_weights</span><span class="p">)</span>
        <span class="n">query_loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">query_pred</span><span class="p">,</span> <span class="n">query_set</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">query_loss</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward_with_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è forward pass —Å custom –≤–µ—Å–∞–º–∏</span>
        <span class="k">pass</span>
</code></pre></div>

<h3 id="2-prototypical-networks">2. Prototypical Networks</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PrototypicalNetworks</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prototypical Networks –¥–ª—è few-shot learning&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PrototypicalNetworks</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">support_set</span><span class="p">,</span> <span class="n">query_set</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass –¥–ª—è few-shot learning&quot;&quot;&quot;</span>

        <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ support set</span>
        <span class="n">support_embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">support_set</span><span class="p">)</span>

        <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤ –∫–ª–∞—Å—Å–æ–≤</span>
        <span class="n">prototypes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_classes</span><span class="p">):</span>
            <span class="n">class_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">support_set</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü - —ç—Ç–æ –∫–ª–∞—Å—Å</span>
            <span class="n">class_embeddings</span> <span class="o">=</span> <span class="n">support_embeddings</span><span class="p">[</span><span class="n">class_mask</span><span class="p">]</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="n">class_embeddings</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">prototypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prototype</span><span class="p">)</span>

        <span class="n">prototypes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">prototypes</span><span class="p">)</span>

        <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ query set</span>
        <span class="n">query_embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">query_set</span><span class="p">)</span>

        <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –¥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">query_embeddings</span><span class="p">,</span> <span class="n">prototypes</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">distances</span>
</code></pre></div>

<h2 id="multi-modal-learning">Multi-Modal Learning</h2>
<h3 id="1-vision-language-models">1. Vision-Language Models</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">VisionLanguageModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ç–µ–∫—Å—Ç–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_dim</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">text_dim</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VisionLanguageModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vision_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">image_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># –¢–µ–∫—Å—Ç–æ–≤—ã–π —ç–Ω–∫–æ–¥–µ—Ä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">text_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># –§—å—é–∂–Ω –º–æ–¥—É–ª—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fusion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">images</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
        <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</span>
        <span class="n">image_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vision_encoder</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

        <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">text_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_encoder</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">combined</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">image_features</span><span class="p">,</span> <span class="n">text_features</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>
</code></pre></div>

<h3 id="2-cross-modal-attention">2. Cross-Modal Attention</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CrossModalAttention</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cross-modal attention –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CrossModalAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

        <span class="c1"># Attention –º–µ—Ö–∞–Ω–∏–∑–º—ã</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attention</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MultiheadAttention</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norm2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

        <span class="c1"># Feed-forward</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modality1</span><span class="p">,</span> <span class="n">modality2</span><span class="p">):</span>
        <span class="c1"># Cross-attention –º–µ–∂–¥—É –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º–∏</span>
        <span class="n">attended1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention</span><span class="p">(</span><span class="n">modality1</span><span class="p">,</span> <span class="n">modality2</span><span class="p">,</span> <span class="n">modality2</span><span class="p">)</span>
        <span class="n">attended1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">attended1</span> <span class="o">+</span> <span class="n">modality1</span><span class="p">)</span>

        <span class="n">attended2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention</span><span class="p">(</span><span class="n">modality2</span><span class="p">,</span> <span class="n">modality1</span><span class="p">,</span> <span class="n">modality1</span><span class="p">)</span>
        <span class="n">attended2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">attended2</span> <span class="o">+</span> <span class="n">modality2</span><span class="p">)</span>

        <span class="c1"># Feed-forward</span>
        <span class="n">output1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">attended1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">(</span><span class="n">attended1</span><span class="p">))</span>
        <span class="n">output2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">attended2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">(</span><span class="n">attended2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">output1</span><span class="p">,</span> <span class="n">output2</span>
</code></pre></div>

<h2 id="federated-learning">Federated Learning</h2>
<h3 id="1-federated-averaging-fedavg">1. Federated Averaging (FedAvg)</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FederatedAveraging</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Federated Averaging –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">global_model</span><span class="p">,</span> <span class="n">clients</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_model</span> <span class="o">=</span> <span class="n">global_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="n">clients</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">federated_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–¥–∏–Ω —Ä–∞—É–Ω–¥ —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞—Ö</span>
        <span class="n">client_models</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">client_weights</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">client</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="c1"># –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
            <span class="n">local_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_client</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">num_epochs</span><span class="p">)</span>
            <span class="n">client_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">local_model</span><span class="p">)</span>
            <span class="n">client_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># –í–µ—Å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —Ä–∞–∑–º–µ—Ä—É –¥–∞–Ω–Ω—ã—Ö</span>

        <span class="c1"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aggregate_models</span><span class="p">(</span><span class="n">client_models</span><span class="p">,</span> <span class="n">client_weights</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">num_epochs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ&quot;&quot;&quot;</span>

        <span class="c1"># –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">local_model</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_model</span><span class="p">)</span>

        <span class="c1"># –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">local_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">data_loader</span><span class="p">:</span>
                <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">local_model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">local_model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">aggregate_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_models</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º –≤–µ—Å–æ–≤&quot;&quot;&quot;</span>

        <span class="n">total_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

        <span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
            <span class="n">param</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>

        <span class="c1"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ</span>
        <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">client_models</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">global_param</span><span class="p">,</span> <span class="n">local_param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()):</span>
                <span class="n">global_param</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">local_param</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight</span> <span class="o">/</span> <span class="n">total_weight</span><span class="p">)</span>
</code></pre></div>

<h3 id="2-differential-privacy">2. Differential Privacy</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DifferentialPrivacy</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Differential Privacy –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">sensitivity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —à—É–º–∞</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.25</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">))</span> <span class="o">*</span> <span class="n">sensitivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —à—É–º–∞</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">gradients</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">noisy_gradients</span> <span class="o">=</span> <span class="n">gradients</span> <span class="o">+</span> <span class="n">noise</span>

        <span class="k">return</span> <span class="n">noisy_gradients</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clip_gradients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">max_norm</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–µ–∑–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># L2 –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="n">grad_norm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradients</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">grad_norm</span> <span class="o">&gt;</span> <span class="n">max_norm</span><span class="p">:</span>
            <span class="n">gradients</span> <span class="o">=</span> <span class="n">gradients</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_norm</span> <span class="o">/</span> <span class="n">grad_norm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gradients</span>
</code></pre></div>

<h2 id="continual-learning">Continual Learning</h2>
<h3 id="1-elastic-weight-consolidation-ewc">1. Elastic Weight Consolidation (EWC)</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ElasticWeightConsolidation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Elastic Weight Consolidation –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">lambda_ewc</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda_ewc</span> <span class="o">=</span> <span class="n">lambda_ewc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fisher_information</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_fisher_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –§–∏—à–µ—Ä–∞&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">fisher_info</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
            <span class="n">fisher_info</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fisher_info</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fisher_info</span><span class="p">:</span>
            <span class="n">fisher_info</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fisher_information</span> <span class="o">=</span> <span class="n">fisher_info</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ewc_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_loss</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ EWC —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∫ loss&quot;&quot;&quot;</span>

        <span class="n">ewc_loss</span> <span class="o">=</span> <span class="n">current_loss</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fisher_information</span><span class="p">:</span>
                <span class="n">ewc_loss</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda_ewc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fisher_information</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">param</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_params</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">ewc_loss</span>
</code></pre></div>

<h3 id="2-progressive-neural-networks">2. Progressive Neural Networks</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProgressiveNeuralNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Progressive Neural Networks –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ProgressiveNeuralNetwork</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lateral_connections</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>

        <span class="c1"># –ü–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞</span>
        <span class="n">first_column</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_column</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞</span>
        <span class="n">new_column</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_column</span><span class="p">)</span>

        <span class="c1"># –ë–æ–∫–æ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏</span>
        <span class="n">lateral_conn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">lateral_conn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lateral_connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lateral_conn</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">column_idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏&quot;&quot;&quot;</span>

        <span class="c1"># –û—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å —á–µ—Ä–µ–∑ —Ç–µ–∫—É—â—É—é –∫–æ–ª–æ–Ω–∫—É</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">column_idx</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># –ë–æ–∫–æ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">column_idx</span><span class="p">):</span>
            <span class="n">lateral_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lateral_connections</span><span class="p">[</span><span class="n">column_idx</span><span class="p">][</span><span class="n">i</span><span class="p">](</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">+</span> <span class="n">lateral_output</span>

        <span class="k">return</span> <span class="n">output</span>
</code></pre></div>

<h2 id="quantum-machine-learning">Quantum Machine Learning</h2>
<h3 id="1-quantum-neural-networks">1. Quantum Neural Networks</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–∏–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PennyLane</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pennylane</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">qml</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">quantum_neural_network</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–≤–∞–Ω—Ç–æ–≤–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å&quot;&quot;&quot;</span>

    <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–∏</span>
    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">layer</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># –≠–Ω—Çangling gates</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># –ò–∑–º–µ—Ä–µ–Ω–∏–µ</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">qml</span><span class="o">.</span><span class="n">expval</span><span class="p">(</span><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;default.qubit&#39;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ QNode</span>
<span class="n">qnode</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">QNode</span><span class="p">(</span><span class="n">quantum_neural_network</span><span class="p">,</span> <span class="n">dev</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_quantum_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="p">(</span><span class="n">num_layers</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

    <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">stepsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</span>
        <span class="n">grads</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">qnode</span><span class="p">)(</span><span class="n">params</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">qnode</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">iteration</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">, Cost: </span><span class="si">{</span><span class="n">qnode</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span>
</code></pre></div>

<h2 id="_298">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã AutoML –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞—é—â—É—é—Å—è –æ–±–ª–∞—Å—Ç—å, –≤–∫–ª—é—á–∞—é—â—É—é:</p>
<ol>
<li><strong>Neural Architecture Search</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä</li>
<li><strong>Meta-Learning</strong> - –æ–±—É—á–µ–Ω–∏–µ —Ç–æ–º—É, –∫–∞–∫ —É—á–∏—Ç—å—Å—è</li>
<li><strong>Multi-Modal Learning</strong> - —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>Federated Learning</strong> - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</li>
<li><strong>Continual Learning</strong> - –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –∑–∞–±—ã–≤–∞–Ω–∏—è</li>
<li><strong>Quantum Machine Learning</strong> - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</li>
</ol>
<p>–≠—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –∏ –º–æ—â–Ω—ã—Ö ML-—Å–∏—Å—Ç–µ–º, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–∞–∫ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å–Ω–æ–≤, —Ç–∞–∫ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.</p>
<hr />
<h1 id="ai">–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="ai_1">–ü–æ—á–µ–º—É —ç—Ç–∏–∫–∞ AI –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞</h2>
<p><strong>–ü–æ—á–µ–º—É 90% ML-–º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–∞—Ä—É—à–∞—é—Ç —ç—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —ç—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è. –≠—Ç–æ –∫–∞–∫ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ä—É–∂–∏—è –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è, –∫–∞–∫ –µ–≥–æ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.</p>
<h3 id="ai_2">–ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –Ω–µ—ç—Ç–∏—á–Ω–æ–≥–æ AI</h3>
<ul>
<li><strong>–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è</strong>: –ú–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–†–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã</strong>: GDPR —à—Ç—Ä–∞—Ñ—ã –¥–æ 4% –æ—Ç –æ–±–æ—Ä–æ—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏</li>
<li><strong>–ü–æ—Ç–µ—Ä—è —Ä–µ–ø—É—Ç–∞—Ü–∏–∏</strong>: –ü—É–±–ª–∏—á–Ω—ã–µ —Å–∫–∞–Ω–¥–∞–ª—ã –∏–∑-–∑–∞ –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç–∏</li>
<li><strong>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</strong>: –°—É–¥–µ–±–Ω—ã–µ –∏—Å–∫–∏ –∑–∞ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—é</li>
</ul>
<h3 id="ai_3">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–∏—á–Ω–æ–≥–æ AI</h3>
<ul>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong>: –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–∞–º</strong>: GDPR, AI Act, –¥—Ä—É–≥–∏–µ —Ä–µ–≥—É–ª—è—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</li>
<li><strong>–õ—É—á—à–∞—è —Ä–µ–ø—É—Ç–∞—Ü–∏—è</strong>: –ö–æ–º–ø–∞–Ω–∏—è –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è</li>
<li><strong>–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —É—Å–ø–µ—Ö</strong>: –£—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –±–∏–∑–Ω–µ—Å–∞</li>
</ul>
<h2 id="ai_4">–í–≤–µ–¥–µ–Ω–∏–µ –≤ —ç—Ç–∏–∫—É AI</h2>
<p><img alt="–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI" src="images/ai_ethics_overview.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 17.1: –ü—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞</em></p>
<p><strong>–ü–æ—á–µ–º—É —ç—Ç–∏–∫–∞ AI - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ "—Ö–æ—Ä–æ—à–æ –±—ã—Ç—å —Ö–æ—Ä–æ—à–∏–º"?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—ç—Ç–∏—á–Ω—ã–µ AI-—Å–∏—Å—Ç–µ–º—ã –º–æ–≥—É—Ç –ø—Ä–∏—á–∏–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –≤—Ä–µ–¥ –ª—é–¥—è–º –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–µ—Ä—å–µ–∑–Ω—ã–º —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –∏ —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º.</p>
<p>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–µ–π –Ω–µ—Å—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –ø—Ä–∞–≤–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö AI-—Å–∏—Å—Ç–µ–º.</p>
<h2 id="ai_5">–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ç–∏—á–Ω–æ–≥–æ AI</h2>
<h3 id="1_24">1. –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏</h3>
<p><strong>–ü–æ—á–µ–º—É —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ —ç—Ç–∏—á–Ω–æ–≥–æ AI?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π –ø–æ –ø–æ–ª—É, —Ä–∞—Å–µ, –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –¥—Ä—É–≥–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º, —á—Ç–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–±—â–µ—Å—Ç–≤–µ.</p>
<p><strong>–ü–æ—á–µ–º—É –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º–∏?</strong><br />
- <strong>–ü—Ä–µ–¥–≤–∑—è—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ</strong>: –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—é<br />
- <strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</strong>: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤<br />
- <strong>–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</strong>: –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö—É–∂–µ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≥—Ä—É–ø–ø<br />
- <strong>–°–∫—Ä—ã—Ç—ã–µ —Å–º–µ—â–µ–Ω–∏—è</strong>: –ù–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_fairness</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ç–∏—á–Ω–æ–≥–æ AI&quot;&quot;&quot;</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">fairness_metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">sensitive_attributes</span><span class="p">:</span>
        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∞—Ç—Ä–∏–±—É—Ç–∞–º - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="n">group_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">==</span> <span class="n">group</span>
            <span class="n">group_predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">group_actual</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

            <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
            <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">group_predictions</span> <span class="o">==</span> <span class="n">group_actual</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">precision</span> <span class="o">=</span> <span class="n">calculate_precision</span><span class="p">(</span><span class="n">group_predictions</span><span class="p">,</span> <span class="n">group_actual</span><span class="p">)</span>
            <span class="n">recall</span> <span class="o">=</span> <span class="n">calculate_recall</span><span class="p">(</span><span class="n">group_predictions</span><span class="p">,</span> <span class="n">group_actual</span><span class="p">)</span>

            <span class="n">group_metrics</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
                <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span>
                <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="n">recall</span>
            <span class="p">}</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏</span>
        <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">group_metrics</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>

        <span class="n">fairness_metrics</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;group_metrics&#39;</span><span class="p">:</span> <span class="n">group_metrics</span><span class="p">,</span>
            <span class="s1">&#39;max_accuracy_difference&#39;</span><span class="p">:</span> <span class="n">max_diff</span><span class="p">,</span>
            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="n">max_diff</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># –ü–æ—Ä–æ–≥ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">fairness_metrics</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_precision</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actual</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="p">((</span><span class="n">predictions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">actual</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="p">((</span><span class="n">predictions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_recall</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">actual</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ø–æ–ª–Ω–æ—Ç—ã&quot;&quot;&quot;</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="p">((</span><span class="n">predictions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">actual</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="p">((</span><span class="n">predictions</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">actual</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div>

<h3 id="2_22">2. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lime.lime_tabular</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EthicalModelWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —ç—Ç–∏—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">feature_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitive_attributes</span> <span class="o">=</span> <span class="n">sensitive_attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">explainer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_explainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–∏—Ç–µ–ª—è –¥–ª—è –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># SHAP explainer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shap_explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>

        <span class="c1"># LIME explainer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lime_explainer</span> <span class="o">=</span> <span class="n">lime</span><span class="o">.</span><span class="n">lime_tabular</span><span class="o">.</span><span class="n">LimeTabularExplainer</span><span class="p">(</span>
            <span class="n">X_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
            <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;classification&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">explain_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;shap&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;shap&#39;</span><span class="p">:</span>
            <span class="n">shap_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shap_explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">shap_values</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;lime&#39;</span><span class="p">:</span>
            <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lime_explainer</span><span class="o">.</span><span class="n">explain_instance</span><span class="p">(</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">,</span>
                <span class="n">num_features</span><span class="o">=</span><span class="mi">10</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">explanation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method must be &#39;shap&#39; or &#39;lime&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_bias_in_explanation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–º–µ—â–µ–Ω–∏–π –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏&quot;&quot;&quot;</span>

        <span class="n">explanation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain_prediction</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span>
        <span class="n">sensitive_importance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensitive_attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">explanation</span><span class="o">.</span><span class="n">as_list</span><span class="p">():</span>
                <span class="n">sensitive_importance</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">explanation</span><span class="o">.</span><span class="n">as_list</span><span class="p">()[</span><span class="n">attr</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># –ï—Å–ª–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∏–º–µ—é—Ç –≤—ã—Å–æ–∫—É—é –≤–∞–∂–Ω–æ—Å—Ç—å - –≤–æ–∑–º–æ–∂–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ</span>
        <span class="n">bias_detected</span> <span class="o">=</span> <span class="n">sensitive_importance</span> <span class="o">&gt;</span> <span class="mf">0.5</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;bias_detected&#39;</span><span class="p">:</span> <span class="n">bias_detected</span><span class="p">,</span>
            <span class="s1">&#39;sensitive_importance&#39;</span><span class="p">:</span> <span class="n">sensitive_importance</span><span class="p">,</span>
            <span class="s1">&#39;explanation&#39;</span><span class="p">:</span> <span class="n">explanation</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="3_6">3. –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PrivacyPreservingML</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ML —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_differential_privacy_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">sensitivity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —à—É–º–∞</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.25</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">))</span> <span class="o">*</span> <span class="n">sensitivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —à—É–º–∞</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">noisy_data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="n">noise</span>

        <span class="k">return</span> <span class="n">noisy_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">k_anonymity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">quasi_identifiers</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ k-–∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–≤–∞–∑–∏-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">quasi_identifiers</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä—É–ø–ø—ã</span>
        <span class="n">min_group_size</span> <span class="o">=</span> <span class="n">groups</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;k_anonymity_satisfied&#39;</span><span class="p">:</span> <span class="n">min_group_size</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">,</span>
            <span class="s1">&#39;min_group_size&#39;</span><span class="p">:</span> <span class="n">min_group_size</span><span class="p">,</span>
            <span class="s1">&#39;groups_below_k&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">groups</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">l_diversity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">quasi_identifiers</span><span class="p">,</span> <span class="n">sensitive_attribute</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ l-—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–≤–∞–∑–∏-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">quasi_identifiers</span><span class="p">)</span>

        <span class="n">l_diversity_satisfied</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">groups_below_l</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">unique_sensitive_values</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">sensitive_attribute</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">unique_sensitive_values</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">l_diversity_satisfied</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">groups_below_l</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;l_diversity_satisfied&#39;</span><span class="p">:</span> <span class="n">l_diversity_satisfied</span><span class="p">,</span>
            <span class="s1">&#39;groups_below_l&#39;</span><span class="p">:</span> <span class="n">groups_below_l</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_299">–ü—Ä–∞–≤–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>
<h3 id="1-gdpr-compliance">1. GDPR Compliance</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GDPRCompliance</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è GDPR&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_subjects</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing_purposes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">record_consent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">,</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">consent_given</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø–∏—Å—å —Å–æ–≥–ª–∞—Å–∏—è —Å—É–±—ä–µ–∫—Ç–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">subject_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">[</span><span class="n">subject_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">[</span><span class="n">subject_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;purpose&#39;</span><span class="p">:</span> <span class="n">purpose</span><span class="p">,</span>
            <span class="s1">&#39;consent_given&#39;</span><span class="p">:</span> <span class="n">consent_given</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">timestamp</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_consent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">,</span> <span class="n">purpose</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">subject_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–π —Ü–µ–ª–∏</span>
        <span class="n">relevant_consents</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">record</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">[</span><span class="n">subject_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;purpose&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">purpose</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">relevant_consents</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –í–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è</span>
        <span class="n">latest_consent</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">relevant_consents</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">latest_consent</span><span class="p">[</span><span class="s1">&#39;consent_given&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">right_to_erasure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (–ø—Ä–∞–≤–æ –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º)&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">subject_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="p">[</span><span class="n">subject_id</span><span class="p">]</span>

        <span class="c1"># –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">data_portability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–∞–≤–æ –Ω–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="c1"># –í–æ–∑–≤—Ä–∞—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö —Å—É–±—ä–µ–∫—Ç–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ</span>
        <span class="n">subject_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;personal_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subject_data</span><span class="p">(</span><span class="n">subject_id</span><span class="p">),</span>
            <span class="s1">&#39;consent_records&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_records</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject_id</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s1">&#39;processing_history&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_processing_history</span><span class="p">(</span><span class="n">subject_id</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">subject_data</span>
</code></pre></div>

<h3 id="2-ai-act-compliance">2. AI Act Compliance</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIActCompliance</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ AI Act (–ï–°)&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_categories</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;unacceptable&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;limited&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;minimal&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">classify_ai_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_description</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è AI —Å–∏—Å—Ç–µ–º—ã –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_biometric_identification</span><span class="p">(</span><span class="n">system_description</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;unacceptable&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_high_risk_application</span><span class="p">(</span><span class="n">system_description</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;high&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_limited_risk_application</span><span class="p">(</span><span class="n">system_description</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;limited&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;minimal&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_biometric_identification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é&quot;&quot;&quot;</span>
        <span class="n">biometric_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;face recognition&#39;</span><span class="p">,</span> <span class="s1">&#39;fingerprint&#39;</span><span class="p">,</span> <span class="s1">&#39;iris&#39;</span><span class="p">,</span> <span class="s1">&#39;voice&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">description</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">biometric_keywords</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_high_risk_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">high_risk_keywords</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;medical diagnosis&#39;</span><span class="p">,</span> <span class="s1">&#39;credit scoring&#39;</span><span class="p">,</span> <span class="s1">&#39;recruitment&#39;</span><span class="p">,</span>
            <span class="s1">&#39;law enforcement&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">description</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">high_risk_keywords</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_limited_risk_application</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ —Ä–∏—Å–∫–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è&quot;&quot;&quot;</span>
        <span class="n">limited_risk_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chatbot&#39;</span><span class="p">,</span> <span class="s1">&#39;recommendation&#39;</span><span class="p">,</span> <span class="s1">&#39;content moderation&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">description</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">limited_risk_keywords</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_compliance_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">risk_level</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="n">requirements</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;unacceptable&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;System is prohibited under AI Act&#39;</span>
            <span class="p">],</span>
            <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;Conformity assessment required&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Risk management system&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Data governance&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Technical documentation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Record keeping&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Transparency and user information&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Human oversight&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Accuracy, robustness and cybersecurity&#39;</span>
            <span class="p">],</span>
            <span class="s1">&#39;limited&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;Transparency obligations&#39;</span><span class="p">,</span>
                <span class="s1">&#39;User information requirements&#39;</span>
            <span class="p">],</span>
            <span class="s1">&#39;minimal&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;No specific requirements&#39;</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">requirements</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">risk_level</span><span class="p">,</span> <span class="p">[])</span>
</code></pre></div>

<h2 id="bias-detection-and-mitigation">Bias Detection and Mitigation</h2>
<h3 id="1-bias-detection">1. Bias Detection</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BiasDetector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏–π –≤ ML –º–æ–¥–µ–ª—è—Ö&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">statistical_parity_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">sensitive_attribute</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–Ω–æ—Å—Ç—å –ø–∞—Ä–∏—Ç–µ—Ç–∞&quot;&quot;&quot;</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="n">sensitive_attribute</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">spd_values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">sensitive_attribute</span> <span class="o">==</span> <span class="n">group</span>
            <span class="n">group_positive_rate</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">spd_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_positive_rate</span><span class="p">)</span>

        <span class="c1"># –†–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–æ–ª–µ–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤</span>
        <span class="n">spd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">spd_values</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">spd_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;statistical_parity_difference&#39;</span><span class="p">:</span> <span class="n">spd</span><span class="p">,</span>
            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="n">spd</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># –ü–æ—Ä–æ–≥ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏</span>
            <span class="s1">&#39;group_rates&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">spd_values</span><span class="p">))</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">equalized_odds_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">sensitive_attribute</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞–∑–Ω–æ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–Ω—ã—Ö —à–∞–Ω—Å–æ–≤&quot;&quot;&quot;</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="n">sensitive_attribute</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">tpr_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fpr_values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">sensitive_attribute</span> <span class="o">==</span> <span class="n">group</span>
            <span class="n">group_predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
            <span class="n">group_actual</span> <span class="o">=</span> <span class="n">actual</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>

            <span class="c1"># True Positive Rate</span>
            <span class="n">tpr</span> <span class="o">=</span> <span class="p">((</span><span class="n">group_predictions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">group_actual</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">group_actual</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">tpr_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tpr</span><span class="p">)</span>

            <span class="c1"># False Positive Rate</span>
            <span class="n">fpr</span> <span class="o">=</span> <span class="p">((</span><span class="n">group_predictions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">group_actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">group_actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">fpr_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fpr</span><span class="p">)</span>

        <span class="c1"># –†–∞–∑–Ω–æ—Å—Ç–∏ TPR –∏ FPR</span>
        <span class="n">tpr_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tpr_values</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">tpr_values</span><span class="p">)</span>
        <span class="n">fpr_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">fpr_values</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">fpr_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;equalized_odds_difference&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">tpr_diff</span><span class="p">,</span> <span class="n">fpr_diff</span><span class="p">),</span>
            <span class="s1">&#39;tpr_difference&#39;</span><span class="p">:</span> <span class="n">tpr_diff</span><span class="p">,</span>
            <span class="s1">&#39;fpr_difference&#39;</span><span class="p">:</span> <span class="n">fpr_diff</span><span class="p">,</span>
            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">tpr_diff</span><span class="p">,</span> <span class="n">fpr_diff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">demographic_parity_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">sensitive_attribute</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞–∑–Ω–æ—Å—Ç—å –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä–∏—Ç–µ—Ç–∞&quot;&quot;&quot;</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="n">sensitive_attribute</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">positive_rates</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">sensitive_attribute</span> <span class="o">==</span> <span class="n">group</span>
            <span class="n">positive_rate</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">positive_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">positive_rate</span><span class="p">)</span>

        <span class="n">dpd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">positive_rates</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">positive_rates</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;demographic_parity_difference&#39;</span><span class="p">:</span> <span class="n">dpd</span><span class="p">,</span>
            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="n">dpd</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;group_positive_rates&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">positive_rates</span><span class="p">))</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="2-bias-mitigation">2. Bias Mitigation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BiasMitigation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–µ—Ç–æ–¥—ã —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mitigation_strategies</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">preprocess_bias_mitigation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span>

        <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span>
        <span class="n">X_processed</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">sensitive_attributes</span><span class="p">)</span>

        <span class="c1"># –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
        <span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">X_balanced</span><span class="p">,</span> <span class="n">y_balanced</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_processed</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">X_balanced</span><span class="p">,</span> <span class="n">y_balanced</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inprocess_bias_mitigation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–Ω–∏–∂–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ fairness constraints</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">fairness_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sensitive_attr</span><span class="p">):</span>
            <span class="c1"># –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å</span>
            <span class="n">main_loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>

            <span class="c1"># Fairness penalty</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">sensitive_attr</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="n">fairness_penalty</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                <span class="n">group_mask</span> <span class="o">=</span> <span class="n">sensitive_attr</span> <span class="o">==</span> <span class="n">group</span>
                <span class="n">group_predictions</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
                <span class="n">group_positive_rate</span> <span class="o">=</span> <span class="n">group_predictions</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">fairness_penalty</span> <span class="o">+=</span> <span class="p">(</span><span class="n">group_positive_rate</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

            <span class="k">return</span> <span class="n">main_loss</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">fairness_penalty</span>

        <span class="k">return</span> <span class="n">fairness_loss</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">postprocess_bias_mitigation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span>

        <span class="c1"># –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø</span>
        <span class="n">adjusted_predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">sensitive_attributes</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">sensitive_attributes</span> <span class="o">==</span> <span class="n">group</span>
            <span class="n">group_predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>

            <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–ª—è –≥—Ä—É–ø–ø—ã</span>
            <span class="n">group_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_fair_threshold</span><span class="p">(</span>
                <span class="n">group_predictions</span><span class="p">,</span> <span class="n">group</span>
            <span class="p">)</span>

            <span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞</span>
            <span class="n">adjusted_predictions</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">group_predictions</span> <span class="o">&gt;</span> <span class="n">group_threshold</span>
            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">adjusted_predictions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_fair_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –¥–ª—è –≥—Ä—É–ø–ø—ã&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ - –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã</span>
        <span class="k">return</span> <span class="mf">0.5</span>
</code></pre></div>

<h2 id="responsible-ai-framework">Responsible AI Framework</h2>
<h3 id="1-ai-ethics-checklist">1. AI Ethics Checklist</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIEthicsChecklist</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ß–µ–∫–ª–∏—Å—Ç —ç—Ç–∏—á–Ω–æ—Å—Ç–∏ AI —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checklist</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_quality&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;bias_assessment&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;privacy_protection&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;transparency&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;accountability&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;fairness&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;safety&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assess_data_quality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="n">checks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>
        <span class="n">missing_ratio</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="n">checks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing values ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">missing_ratio</span><span class="p">,</span>
            <span class="s1">&#39;passed&#39;</span><span class="p">:</span> <span class="n">missing_ratio</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="s1">&#39;Clean missing values&#39;</span> <span class="k">if</span> <span class="n">missing_ratio</span> <span class="o">&gt;=</span> <span class="mf">0.1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">})</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã</span>
        <span class="n">duplicate_ratio</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">checks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="s1">&#39;Duplicate ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">duplicate_ratio</span><span class="p">,</span>
            <span class="s1">&#39;passed&#39;</span><span class="p">:</span> <span class="n">duplicate_ratio</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="s1">&#39;Remove duplicates&#39;</span> <span class="k">if</span> <span class="n">duplicate_ratio</span> <span class="o">&gt;=</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">})</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">sensitive_attributes</span><span class="p">:</span>
            <span class="n">value_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">/</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">checks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Balance of </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">min_ratio</span><span class="p">,</span>
                <span class="s1">&#39;passed&#39;</span><span class="p">:</span> <span class="n">min_ratio</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Balance </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1"> groups&#39;</span> <span class="k">if</span> <span class="n">min_ratio</span> <span class="o">&lt;=</span> <span class="mf">0.1</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checklist</span><span class="p">[</span><span class="s1">&#39;data_quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checks</span>
        <span class="k">return</span> <span class="n">checks</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assess_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">sensitive_attributes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ —Å–º–µ—â–µ–Ω–∏–π&quot;&quot;&quot;</span>

        <span class="n">bias_detector</span> <span class="o">=</span> <span class="n">BiasDetector</span><span class="p">()</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">sensitive_attributes</span><span class="p">:</span>
            <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∏—Ç–µ—Ç</span>
            <span class="n">spd_result</span> <span class="o">=</span> <span class="n">bias_detector</span><span class="o">.</span><span class="n">statistical_parity_difference</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">X_test</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">checks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Statistical parity for </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">spd_result</span><span class="p">[</span><span class="s1">&#39;statistical_parity_difference&#39;</span><span class="p">],</span>
                <span class="s1">&#39;passed&#39;</span><span class="p">:</span> <span class="n">spd_result</span><span class="p">[</span><span class="s1">&#39;is_fair&#39;</span><span class="p">],</span>
                <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Address bias in </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">spd_result</span><span class="p">[</span><span class="s1">&#39;is_fair&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">})</span>

            <span class="c1"># –£—Ä–∞–≤–Ω–µ–Ω–Ω—ã–µ —à–∞–Ω—Å—ã</span>
            <span class="n">eod_result</span> <span class="o">=</span> <span class="n">bias_detector</span><span class="o">.</span><span class="n">equalized_odds_difference</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">checks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Equalized odds for </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">eod_result</span><span class="p">[</span><span class="s1">&#39;equalized_odds_difference&#39;</span><span class="p">],</span>
                <span class="s1">&#39;passed&#39;</span><span class="p">:</span> <span class="n">eod_result</span><span class="p">[</span><span class="s1">&#39;is_fair&#39;</span><span class="p">],</span>
                <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Address equalized odds for </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">eod_result</span><span class="p">[</span><span class="s1">&#39;is_fair&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checklist</span><span class="p">[</span><span class="s1">&#39;bias_assessment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checks</span>
        <span class="k">return</span> <span class="n">checks</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_ethics_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ —ç—Ç–∏—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;overall_score&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;category_scores&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;passed_checks&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;total_checks&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">checks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">checklist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
                <span class="n">passed</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">checks</span> <span class="k">if</span> <span class="n">check</span><span class="p">[</span><span class="s1">&#39;passed&#39;</span><span class="p">])</span>
                <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
                <span class="n">score</span> <span class="o">=</span> <span class="n">passed</span> <span class="o">/</span> <span class="n">total</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="n">report</span><span class="p">[</span><span class="s1">&#39;category_scores&#39;</span><span class="p">][</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
                <span class="n">report</span><span class="p">[</span><span class="s1">&#39;passed_checks&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">passed</span>
                <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_checks&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">total</span>

                <span class="c1"># –°–±–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span>
                <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">checks</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recommendation&#39;</span><span class="p">):</span>
                        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
                            <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="n">check</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="n">check</span><span class="p">[</span><span class="s1">&#39;recommendation&#39;</span><span class="p">]</span>
                        <span class="p">})</span>

        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;overall_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;passed_checks&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_checks&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_checks&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">report</span>
</code></pre></div>

<h2 id="_300">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ML-—Å–∏—Å—Ç–µ–º. –ö–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã:</p>
<ol>
<li><strong>–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è —Å–æ –≤—Å–µ–º–∏ –≥—Ä—É–ø–ø–∞–º–∏</li>
<li><strong>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å</strong> - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª–∏</li>
<li><strong>–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</strong> - –∑–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º</strong> - GDPR, AI Act –∏ –¥—Ä—É–≥–∏–µ</li>
<li><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏–π</strong> - –∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç—å—é</li>
<li><strong>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</strong> - —á–µ—Ç–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —Ä–µ—à–µ–Ω–∏—è AI</li>
</ol>
<p>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —ç—Ç–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–æ–≤—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º, –Ω–æ –∏ –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –¥–æ–≤–µ—Ä–∏–µ –∫ AI-—Å–∏—Å—Ç–µ–º–∞–º.</p>
<hr />
<h1 id="-automl-gluon">–ö–µ–π—Å-—Å—Ç–∞–¥–∏: –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å AutoML Gluon</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024  </p>
<h2 id="-">–ü–æ—á–µ–º—É –∫–µ–π—Å-—Å—Ç–∞–¥–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã</h2>
<p><strong>–ü–æ—á–µ–º—É 80% ML-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–ø—è—Ç –Ω–µ—É–¥–∞—á—É –±–µ–∑ –∏–∑—É—á–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –∫–µ–π—Å–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, –∫–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ç–µ–æ—Ä–∏—é –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –ö–µ–π—Å-—Å—Ç–∞–¥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.</p>
<h3 id="_301">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –∏–∑—É—á–µ–Ω–∏—è –∫–µ–π—Å–æ–≤</h3>
<ul>
<li><strong>–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è</strong>: –ü–æ–Ω–∏–º–∞—é—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –Ω–æ –Ω–µ –∑–Ω–∞—é—Ç, –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å</li>
<li><strong>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</strong>: –ù–∞—Å—Ç—É–ø–∞—é—Ç –Ω–∞ —Ç–µ –∂–µ –≥—Ä–∞–±–ª–∏, —á—Ç–æ –∏ –¥—Ä—É–≥–∏–µ</li>
<li><strong>–î–æ–ª–≥–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong>: –ò–∑–æ–±—Ä–µ—Ç–∞—é—Ç –≤–µ–ª–æ—Å–∏–ø–µ–¥ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π</li>
<li><strong>–ü–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –ù–µ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –æ–∂–∏–¥–∞–µ–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="_302">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–∑—É—á–µ–Ω–∏—è –∫–µ–π—Å–æ–≤</h3>
<ul>
<li><strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ</strong>: –í–∏–¥—è—Ç, –∫–∞–∫ —Ç–µ–æ—Ä–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ</li>
<li><strong>–ò–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–æ–∫</strong>: –£—á–∞—Ç—Å—è –Ω–∞ —á—É–∂–∏—Ö –æ—à–∏–±–∫–∞—Ö</li>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</strong>: –ò—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã</li>
<li><strong>–õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong>: –î–æ—Å—Ç–∏–≥–∞—é—Ç state-of-the-art –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
</ul>
<h2 id="-_1">–í–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–µ–π—Å-—Å—Ç–∞–¥–∏</h2>
<p><img alt="–ö–µ–π—Å-—Å—Ç–∞–¥–∏ AutoML" src="images/case_studies_overview.png" /><br />
<em>–†–∏—Å—É–Ω–æ–∫ 18.1: –û–±–∑–æ—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AutoML Gluon</em></p>
<p><strong>–ü–æ—á–µ–º—É –∫–µ–π—Å-—Å—Ç–∞–¥–∏ - —ç—Ç–æ –º–æ—Å—Ç –º–µ–∂–¥—É —Ç–µ–æ—Ä–∏–µ–π –∏ –ø—Ä–∞–∫—Ç–∏–∫–æ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã, —Ä–µ—à–∞—é—â–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏.</p>
<p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∫–µ–π—Å-—Å—Ç–∞–¥–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ AutoML Gluon –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö –∏ –∑–∞–¥–∞—á–∞—Ö.</p>
<h2 id="1-">–ö–µ–π—Å 1: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏ - –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥</h2>
<p><strong>–ü–æ—á–µ–º—É –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ - —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä ML –≤ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –∑–∞–¥–∞—á–∞ —Å —á–µ—Ç–∫–∏–º–∏ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∞–º–∏, –±–æ–ª—å—à–∏–º –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—Å–æ–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –æ—à–∏–±–æ–∫.</p>
<h3 id="_303">–ó–∞–¥–∞—á–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Ç–∞–∫ –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫ –º–µ–¥–ª–µ–Ω–Ω–∞—è, –¥–æ—Ä–æ–≥–∞—è –∏ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º –æ—à–∏–±–∫–∞–º.</p>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –±–∞–Ω–∫–∞ —Å —Ü–µ–ª—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –≤—ã–¥–∞—á–µ –∫—Ä–µ–¥–∏—Ç–æ–≤.</p>
<p><strong>–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç:</strong><br />
- <strong>–¶–µ–ª—å</strong>: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å 80% –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π<br />
- <strong>–ú–µ—Ç—Ä–∏–∫–∞</strong>: ROC-AUC &gt; 0.85<br />
- <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏</strong>: –õ–æ–∂–Ω—ã–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç = –ø–æ—Ç–µ—Ä—è –∫–ª–∏–µ–Ω—Ç–∞<br />
- <strong>–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</strong>: –°–æ–∫—Ä–∞—Ç–∏—Ç—å —Å –¥–Ω–µ–π –¥–æ –º–∏–Ω—É—Ç</p>
<h3 id="_304">–î–∞–Ω–Ω—ã–µ</h3>
<p><strong>–ü–æ—á–µ–º—É –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º, —á—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å –±–∞–Ω–∫—É –º–∏–ª–ª–∏–æ–Ω—ã.</p>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 100,000 –∑–∞—è–≤–æ–∫ –Ω–∞ –∫—Ä–µ–¥–∏—Ç</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 50+ (–¥–æ—Ö–æ–¥, –≤–æ–∑—Ä–∞—Å—Ç, –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è, –∑–∞–Ω—è—Ç–æ—Å—Ç—å –∏ –¥—Ä.)</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –î–µ—Ñ–æ–ª—Ç –ø–æ –∫—Ä–µ–¥–∏—Ç—É (–±–∏–Ω–∞—Ä–Ω–∞—è)</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 3 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<h3 id="_305">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CreditScoringSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_importance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_and_prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

        <span class="c1"># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;employment_years&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;employment_years&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;debt_to_income_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;debt&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;credit_utilization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;credit_used&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;credit_limit&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Young&#39;</span><span class="p">,</span> <span class="s1">&#39;Adult&#39;</span><span class="p">,</span> <span class="s1">&#39;Middle&#39;</span><span class="p">,</span> <span class="s1">&#39;Senior&#39;</span><span class="p">])</span>

        <span class="c1"># –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
        <span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;employment_type&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital_status&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">categorical_features</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;credit_scoring_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="n">time_limit</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_importance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">feature_importance</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_auc_score</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">auc_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># –û—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
        <span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>

        <span class="c1"># –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
            <span class="s1">&#39;auc_score&#39;</span><span class="p">:</span> <span class="n">auc_score</span><span class="p">,</span>
            <span class="s1">&#39;classification_report&#39;</span><span class="p">:</span> <span class="n">report</span><span class="p">,</span>
            <span class="s1">&#39;confusion_matrix&#39;</span><span class="p">:</span> <span class="n">cm</span><span class="p">,</span>
            <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
            <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="n">probabilities</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_scorecard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">score_range</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">850</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">default_prob</span> <span class="o">=</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥</span>
        <span class="c1"># –õ–æ–≥–∏–∫–∞: —á–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞, —Ç–µ–º –Ω–∏–∂–µ —Ä–µ–π—Ç–∏–Ω–≥</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">score_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">default_prob</span> <span class="o">*</span> <span class="p">(</span><span class="n">score_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">score_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">score_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">score_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">scores</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">credit_system</span> <span class="o">=</span> <span class="n">CreditScoringSystem</span><span class="p">()</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">credit_system</span><span class="o">.</span><span class="n">load_and_prepare_data</span><span class="p">(</span><span class="s1">&#39;credit_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">])</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">credit_system</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">credit_system</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC Score: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;auc_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">credit_system</span><span class="o">.</span><span class="n">create_scorecard</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h3 id="_306">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 87.3%</li>
<li><strong>AUC Score</strong>: 0.923</li>
<li><strong>–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è</strong>: 1 —á–∞—Å</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</strong>: –í—ã—Å–æ–∫–∞—è (–≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: –°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å –Ω–∞ 23%, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫ –≤ 5 —Ä–∞–∑</li>
</ul>
<h2 id="2-_1">–ö–µ–π—Å 2: –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</h2>
<h3 id="_307">–ó–∞–¥–∞—á–∞</h3>
<p>–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Ä–∞–Ω–Ω–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.</p>
<h3 id="_308">–î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 25,000 –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 8 –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–≥–ª—é–∫–æ–∑–∞, –ò–ú–¢, –≤–æ–∑—Ä–∞—Å—Ç –∏ –¥—Ä.)</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –î–∏–∞–±–µ—Ç (–±–∏–Ω–∞—Ä–Ω–∞—è)</li>
<li><strong>–ò—Å—Ç–æ—á–Ω–∏–∫</strong>: Pima Indians Diabetes Dataset + –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</li>
</ul>
<h3 id="_309">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiabetesDiagnosisSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–∏–∞–±–µ—Ç–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_factors</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_medical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

        <span class="c1"># –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_medical_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;bmi_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">],</span> 
                                   <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">18.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> 
                                   <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Underweight&#39;</span><span class="p">,</span> <span class="s1">&#39;Normal&#39;</span><span class="p">,</span> <span class="s1">&#39;Overweight&#39;</span><span class="p">,</span> <span class="s1">&#39;Obese&#39;</span><span class="p">])</span>

        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;glucose_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">],</span> 
                                      <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> 
                                      <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Normal&#39;</span><span class="p">,</span> <span class="s1">&#39;Prediabetes&#39;</span><span class="p">,</span> <span class="s1">&#39;Diabetes&#39;</span><span class="p">])</span>

        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> 
                               <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> 
                               <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Young&#39;</span><span class="p">,</span> <span class="s1">&#39;Middle&#39;</span><span class="p">,</span> <span class="s1">&#39;Senior&#39;</span><span class="p">,</span> <span class="s1">&#39;Elderly&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_medical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># –ì–ª—é–∫–æ–∑–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 0</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>      <span class="c1"># –ò–ú–¢ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>     <span class="c1"># –í–æ–∑—Ä–∞—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º</span>

        <span class="c1"># –ó–∞–º–µ–Ω–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ–¥–∏–∞–Ω–æ–π</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">,</span> <span class="s1">&#39;BloodPressure&#39;</span><span class="p">,</span> <span class="s1">&#39;SkinThickness&#39;</span><span class="p">,</span> <span class="s1">&#39;Insulin&#39;</span><span class="p">,</span> <span class="s1">&#39;BMI&#39;</span><span class="p">]:</span>
            <span class="n">Q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">Q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
            <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>

            <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
            <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_medical_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outcome&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;diabetes_diagnosis_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="n">time_limit</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_risk_assessment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞ –¥–ª—è –ø–∞—Ü–∏–µ–Ω—Ç–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">patient_data</span><span class="p">)</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">patient_data</span><span class="p">)</span>

        <span class="c1"># –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–∏—Å–∫–∞</span>
        <span class="n">risk_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpret_risk</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span>
        <span class="n">recommendations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_recommendations</span><span class="p">(</span><span class="n">patient_data</span><span class="p">,</span> <span class="n">risk_level</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">probability</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;risk_level&#39;</span><span class="p">:</span> <span class="n">risk_level</span><span class="p">,</span>
            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="n">recommendations</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interpret_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probability</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">probability</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Low Risk&#39;</span>
        <span class="k">elif</span> <span class="n">probability</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Medium Risk&#39;</span>
        <span class="k">elif</span> <span class="n">probability</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;High Risk&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Very High Risk&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_data</span><span class="p">,</span> <span class="n">risk_level</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span>

        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">risk_level</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;High Risk&#39;</span><span class="p">,</span> <span class="s1">&#39;Very High Risk&#39;</span><span class="p">]:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Immediate consultation with endocrinologist&quot;</span><span class="p">)</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Regular blood glucose monitoring&quot;</span><span class="p">)</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Lifestyle modifications (diet, exercise)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">patient_data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Weight management program&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">patient_data</span><span class="p">[</span><span class="s1">&#39;Glucose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">126</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Fasting glucose test&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">recommendations</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">diabetes_system</span> <span class="o">=</span> <span class="n">DiabetesDiagnosisSystem</span><span class="p">()</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">medical_data</span> <span class="o">=</span> <span class="n">diabetes_system</span><span class="o">.</span><span class="n">load_medical_data</span><span class="p">(</span><span class="s1">&#39;diabetes_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">medical_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">medical_data</span><span class="p">[</span><span class="s1">&#39;Outcome&#39;</span><span class="p">])</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">diabetes_system</span><span class="o">.</span><span class="n">train_medical_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">diabetes_system</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Medical Model Accuracy: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Medical Model AUC: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;auc_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_310">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 91.2%</li>
<li><strong>AUC Score</strong>: 0.945</li>
<li><strong>–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: 89.5% (–≤–∞–∂–Ω–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)</li>
<li><strong>–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å</strong>: 92.8%</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: –†–∞–Ω–Ω–µ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –¥–∏–∞–±–µ—Ç–∞ —É 15% –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –ª–µ—á–µ–Ω–∏–µ –Ω–∞ 30%</li>
</ul>
<h2 id="3-e-commerce-">–ö–µ–π—Å 3: E-commerce - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<h3 id="_311">–ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞.</p>
<h3 id="_312">–î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞</strong>: 1,000,000 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</li>
<li><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</strong>: 50,000 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</li>
<li><strong>–¢–æ–≤–∞—Ä—ã</strong>: 10,000 SKU</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞</li>
</ul>
<h3 id="_313">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EcommerceRecommendationSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è e-commerce&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_recommendation_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions_df</span><span class="p">,</span> <span class="n">users_df</span><span class="p">,</span> <span class="n">items_df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">transactions_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">users_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">items_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;item_id&#39;</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
        <span class="n">user_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_user_features</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞</span>
        <span class="n">item_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_item_features</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (—Ä–µ–π—Ç–∏–Ω–≥/–ø–æ–∫—É–ø–∫–∞)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_implicit_rating</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">user_features</span><span class="p">,</span> <span class="n">item_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span>

        <span class="n">user_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
            <span class="s1">&#39;item_id&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>  <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫</span>
            <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>  <span class="c1"># –û–±—â–∞—è –∏ —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>  <span class="c1"># –õ—é–±–∏–º–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</span>
            <span class="s1">&#39;brand&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span>  <span class="c1"># –õ—é–±–∏–º—ã–π –±—Ä–µ–Ω–¥</span>
        <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">user_features</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;total_purchases&#39;</span><span class="p">,</span> <span class="s1">&#39;total_spent&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_purchase&#39;</span><span class="p">,</span> <span class="s1">&#39;favorite_category&#39;</span><span class="p">,</span> <span class="s1">&#39;favorite_brand&#39;</span><span class="p">]</span>

        <span class="c1"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">user_features</span><span class="p">[</span><span class="s1">&#39;purchase_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_features</span><span class="p">[</span><span class="s1">&#39;total_purchases&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">365</span>  <span class="c1"># –ü–æ–∫—É–ø–æ–∫ –≤ –¥–µ–Ω—å</span>
        <span class="n">user_features</span><span class="p">[</span><span class="s1">&#39;avg_spent_per_purchase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_features</span><span class="p">[</span><span class="s1">&#39;total_spent&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">user_features</span><span class="p">[</span><span class="s1">&#39;total_purchases&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">user_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_item_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞&quot;&quot;&quot;</span>

        <span class="n">item_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;item_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
            <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>  <span class="c1"># –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</span>
            <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>  <span class="c1"># –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
            <span class="s1">&#39;brand&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;Unknown&#39;</span>
        <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="n">item_features</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;item_id&#39;</span><span class="p">,</span> <span class="s1">&#39;total_buyers&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_price&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;brand&#39;</span><span class="p">]</span>

        <span class="c1"># –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞</span>
        <span class="n">item_features</span><span class="p">[</span><span class="s1">&#39;popularity_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_features</span><span class="p">[</span><span class="s1">&#39;total_buyers&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">item_features</span><span class="p">[</span><span class="s1">&#39;total_buyers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">item_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_implicit_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –Ω–µ—è–≤–Ω–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: —á–µ–º –±–æ–ª—å—à–µ –ø–æ–∫—É–ø–æ–∫, —Ç–µ–º –≤—ã—à–µ —Ä–µ–π—Ç–∏–Ω–≥</span>
        <span class="n">user_purchase_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)[</span><span class="s1">&#39;item_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">item_purchase_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;item_id&#39;</span><span class="p">)[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_activity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">user_purchase_counts</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;item_popularity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;item_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">item_purchase_counts</span><span class="p">)</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_activity&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_activity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> 
                 <span class="n">df</span><span class="p">[</span><span class="s1">&#39;item_popularity&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;item_popularity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">rating</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_collaborative_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">user_features</span><span class="p">,</span> <span class="n">item_features</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è AutoML</span>
        <span class="n">recommendation_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">user_features</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
        <span class="n">recommendation_data</span> <span class="o">=</span> <span class="n">recommendation_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">item_features</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;item_id&#39;</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;recommendation_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">recommendation_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">n_recommendations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
        <span class="n">user_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user_features</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</span>
        <span class="n">all_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_items</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="n">all_items</span><span class="p">:</span>
            <span class="n">item_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_features</span><span class="p">(</span><span class="n">item_id</span><span class="p">)</span>

            <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–æ–≤–∞—Ä–∞</span>
            <span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="o">**</span><span class="n">user_data</span><span class="p">,</span> <span class="o">**</span><span class="n">item_data</span><span class="p">}])</span>

            <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞</span>
            <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collaborative_filter</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item_id</span><span class="p">,</span> <span class="n">rating</span><span class="p">))</span>

        <span class="c1"># –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–ø-N —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span>
        <span class="k">return</span> <span class="n">predictions</span><span class="p">[:</span><span class="n">n_recommendations</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">n_recommendations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π&quot;&quot;&quot;</span>

        <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span>
        <span class="n">precision_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">recall_scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ndcg_scores</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
            <span class="n">actual_items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">][</span><span class="s1">&#39;item_id&#39;</span><span class="p">])</span>

            <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</span>
            <span class="n">recommendations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_recommendations</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">n_recommendations</span><span class="p">)</span>
            <span class="n">recommended_items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">item_id</span> <span class="k">for</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">recommendations</span><span class="p">])</span>

            <span class="c1"># Precision@K</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recommended_items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">precision</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_items</span> <span class="o">&amp;</span> <span class="n">recommended_items</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recommended_items</span><span class="p">)</span>
                <span class="n">precision_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

            <span class="c1"># Recall@K</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">recall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_items</span> <span class="o">&amp;</span> <span class="n">recommended_items</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_items</span><span class="p">)</span>
                <span class="n">recall_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;precision@10&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precision_scores</span><span class="p">),</span>
            <span class="s1">&#39;recall@10&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recall_scores</span><span class="p">),</span>
            <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precision_scores</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recall_scores</span><span class="p">)</span> <span class="o">/</span> 
                       <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precision_scores</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recall_scores</span><span class="p">))</span>
        <span class="p">}</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">recommendation_system</span> <span class="o">=</span> <span class="n">EcommerceRecommendationSystem</span><span class="p">()</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;transactions.csv&#39;</span><span class="p">)</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;users.csv&#39;</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;items.csv&#39;</span><span class="p">)</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">df</span><span class="p">,</span> <span class="n">user_features</span><span class="p">,</span> <span class="n">item_features</span> <span class="o">=</span> <span class="n">recommendation_system</span><span class="o">.</span><span class="n">prepare_recommendation_data</span><span class="p">(</span>
    <span class="n">transactions</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">items</span>
<span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">recommendation_system</span><span class="o">.</span><span class="n">train_collaborative_filtering</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">user_features</span><span class="p">,</span> <span class="n">item_features</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">recommendation_system</span><span class="o">.</span><span class="n">evaluate_recommendations</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision@10: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;precision@10&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall@10: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;recall@10&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 Score: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;f1_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_314">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>Precision@10</strong>: 0.342</li>
<li><strong>Recall@10</strong>: 0.156</li>
<li><strong>F1 Score</strong>: 0.214</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏</strong>: 18%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞</strong>: 12%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫</strong>: 25%</li>
</ul>
<h2 id="4-">–ö–µ–π—Å 4: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ - –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h2>
<h3 id="_315">–ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.</p>
<h3 id="_316">–î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</strong>: 500 –µ–¥–∏–Ω–∏—Ü –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</li>
<li><strong>–°–µ–Ω—Å–æ—Ä—ã</strong>: 50+ –¥–∞—Ç—á–∏–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é –µ–¥–∏–Ω–∏—Ü—É</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π</strong>: –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞</li>
</ul>
<h3 id="_317">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PredictiveMaintenanceSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equipment_predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º</span>
        <span class="n">sensor_data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">sensor_data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
        <span class="n">sensor_data</span> <span class="o">=</span> <span class="n">sensor_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">equipment_id</span> <span class="ow">in</span> <span class="n">sensor_data</span><span class="p">[</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="n">equipment_data</span> <span class="o">=</span> <span class="n">sensor_data</span><span class="p">[</span><span class="n">sensor_data</span><span class="p">[</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">equipment_id</span><span class="p">]</span>

            <span class="c1"># –°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞</span>
            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">]:</span>  <span class="c1"># 1 —á–∞—Å, 6 —á–∞—Å–æ–≤, 24 —á–∞—Å–∞</span>
                <span class="n">window_data</span> <span class="o">=</span> <span class="n">equipment_data</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
                    <span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;vibration&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;current&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;voltage&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">]</span>
                <span class="p">})</span>

                <span class="c1"># –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫</span>
                <span class="n">window_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s1">h&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">window_data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window_data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_maintenance_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_data</span><span class="p">,</span> <span class="n">maintenance_logs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤ –∏ –ª–æ–≥–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span>
        <span class="n">maintenance_data</span> <span class="o">=</span> <span class="n">sensor_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">maintenance_logs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
        <span class="c1"># 1 = —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π</span>
        <span class="n">maintenance_data</span><span class="p">[</span><span class="s1">&#39;maintenance_needed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">maintenance_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;maintenance_date&#39;</span><span class="p">]):</span>
                <span class="c1"># –ï—Å–ª–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –±—ã–ª–æ –≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;maintenance_date&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">:</span>
                    <span class="n">maintenance_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;maintenance_needed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">maintenance_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_maintenance_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maintenance_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">7200</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equipment_predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maintenance_needed&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;maintenance_prediction_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equipment_predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">maintenance_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="n">time_limit</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">equipment_predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsolationForest</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π</span>
        <span class="n">sensor_features</span> <span class="o">=</span> <span class="n">sensor_data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π</span>
        <span class="n">anomaly_detector</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">anomaly_detector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sensor_features</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π</span>
        <span class="n">anomalies</span> <span class="o">=</span> <span class="n">anomaly_detector</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sensor_features</span><span class="p">)</span>
        <span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_samples</span><span class="p">(</span><span class="n">sensor_features</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">anomalies</span><span class="p">,</span> <span class="n">anomaly_scores</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_maintenance_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_sensor_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span>
        <span class="n">maintenance_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">equipment_predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">current_sensor_data</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">maintenance_prob</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>  <span class="c1"># –í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</span>
                <span class="n">schedule</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;equipment_id&#39;</span><span class="p">:</span> <span class="n">current_sensor_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;maintenance_date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">prob</span>
                <span class="p">})</span>
            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># –°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</span>
                <span class="n">schedule</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;equipment_id&#39;</span><span class="p">:</span> <span class="n">current_sensor_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;maintenance_date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">prob</span>
                <span class="p">})</span>
            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>  <span class="c1"># –ù–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</span>
                <span class="n">schedule</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;equipment_id&#39;</span><span class="p">:</span> <span class="n">current_sensor_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;equipment_id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;maintenance_date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span>
                    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">prob</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">schedule</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">maintenance_system</span> <span class="o">=</span> <span class="n">PredictiveMaintenanceSystem</span><span class="p">()</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">sensor_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sensor_data.csv&#39;</span><span class="p">)</span>
<span class="n">maintenance_logs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;maintenance_logs.csv&#39;</span><span class="p">)</span>

<span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">sensor_features</span> <span class="o">=</span> <span class="n">maintenance_system</span><span class="o">.</span><span class="n">prepare_sensor_data</span><span class="p">(</span><span class="n">sensor_data</span><span class="p">)</span>
<span class="n">maintenance_data</span> <span class="o">=</span> <span class="n">maintenance_system</span><span class="o">.</span><span class="n">create_maintenance_target</span><span class="p">(</span><span class="n">sensor_data</span><span class="p">,</span> <span class="n">maintenance_logs</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">maintenance_system</span><span class="o">.</span><span class="n">train_maintenance_model</span><span class="p">(</span><span class="n">maintenance_data</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">maintenance_system</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">maintenance_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maintenance Prediction Accuracy: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maintenance Prediction AUC: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;auc_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="_318">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤</strong>: 89.4%</li>
<li><strong>AUC Score</strong>: 0.934</li>
<li><strong>–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–µ–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ–µ–≤</strong>: 45%</li>
<li><strong>–°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</strong>: 32%</li>
<li><strong>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</strong>: 18%</li>
</ul>
<h2 id="5-btcusdt">–ö–µ–π—Å 5: –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è - BTCUSDT</h2>
<h3 id="_319">–ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –∏ —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω–æ–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º –ø—Ä–∏ –¥—Ä–∏—Ñ—Ç–µ –º–æ–¥–µ–ª–∏.</p>
<h3 id="_320">–î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–ü–∞—Ä–∞</strong>: BTCUSDT</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 2 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞</strong>: 1-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 50+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –æ–±—ä–µ–º, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã (1 —á–∞—Å –≤–ø–µ—Ä–µ–¥)</li>
</ul>
<h3 id="_321">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">talib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ccxt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">schedule</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BTCUSDTTradingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT —Å AutoML Gluon&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_performance</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_threshold</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># –ü–æ—Ä–æ–≥ –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retrain_frequency</span> <span class="o">=</span> <span class="s1">&#39;daily&#39;</span>  <span class="c1"># &#39;daily&#39; –∏–ª–∏ &#39;weekly&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_crypto_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;BTCUSDT&#39;</span><span class="p">,</span> <span class="n">timeframe</span><span class="o">=</span><span class="s1">&#39;1m&#39;</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å Binance&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Binance</span>
        <span class="n">exchange</span> <span class="o">=</span> <span class="n">ccxt</span><span class="o">.</span><span class="n">binance</span><span class="p">({</span>
            <span class="s1">&#39;apiKey&#39;</span><span class="p">:</span> <span class="s1">&#39;YOUR_API_KEY&#39;</span><span class="p">,</span>
            <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="s1">&#39;YOUR_SECRET&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sandbox&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">})</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">since</span> <span class="o">=</span> <span class="n">exchange</span><span class="o">.</span><span class="n">milliseconds</span><span class="p">()</span> <span class="o">-</span> <span class="n">days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="n">ohlcv</span> <span class="o">=</span> <span class="n">exchange</span><span class="o">.</span><span class="n">fetch_ohlcv</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">,</span> <span class="n">since</span><span class="o">=</span><span class="n">since</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ohlcv</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_advanced_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMA_200&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="c1"># –û—Å—Ü–∏–ª–ª—è—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">RSI</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STOCH_K&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STOCH_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">STOCH</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WILLR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">WILLR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CCI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CCI</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># –¢—Ä–µ–Ω–¥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD_signal&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MACD_hist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MACD</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADX</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_UP&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROON_DOWN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROON</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AROONOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AROONOSC</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span>

        <span class="c1"># –û–±—ä–µ–º–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;OBV&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">OBV</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADOSC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ADOSC</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">])</span>

        <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ATR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NATR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">NATR</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;TRANGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">TRANGE</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># Bollinger Bands</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_middle&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">BBANDS</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_middle&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_upper&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BB_lower&#39;</span><span class="p">])</span>

        <span class="c1"># Momentum</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MOM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">MOM</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ROC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">ROC</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;PPO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">PPO</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># Price patterns</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DOJI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLDOJI</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HAMMER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLHAMMER</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ENGULFING&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">CDLENGULFING</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span>

        <span class="c1"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high_low_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close_open_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">]</span>

        <span class="c1"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SMA_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">SMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>
            <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;EMA_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talib</span><span class="o">.</span><span class="n">EMA</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">timeperiod</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>

        <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;volatility_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_target_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">prediction_horizon</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ prediction_horizon –º–∏–Ω—É—Ç</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;future_price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">prediction_horizon</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;future_price&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_change_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;future_price&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volatility_target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">prediction_horizon</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">prediction_horizon</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_robust_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
            <span class="s1">&#39;future_price&#39;</span><span class="p">,</span> <span class="s1">&#39;price_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;price_change_pct&#39;</span><span class="p">,</span> <span class="s1">&#39;volatility_target&#39;</span>
        <span class="p">]]</span>

        <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ NaN</span>
        <span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_clean</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;btcusdt_trading_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">[</span><span class="n">feature_columns</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">]],</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="n">time_limit</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="n">feature_columns</span><span class="p">])</span>
        <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span> <span class="o">=</span> <span class="n">feature_columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_performance</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">val_accuracy</span><span class="p">,</span>
            <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">),</span>
            <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">),</span>
            <span class="s1">&#39;f1&#39;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_model_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span><span class="p">])</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">new_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span><span class="p">])</span>

        <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ –¥—Ä–∏—Ñ—Ç–∞</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">prediction_consistency</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—Ä–∏—Ñ—Ç</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">confidence</span> <span class="o">&lt;</span> <span class="mf">0.6</span> <span class="ow">or</span>  <span class="c1"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span>
            <span class="n">prediction_consistency</span> <span class="o">&gt;</span> <span class="mf">0.9</span> <span class="ow">or</span>  <span class="c1"># –°–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_performance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.55</span>  <span class="c1"># –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">drift_detected</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">retrain_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ...&quot;</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_historical_data</span><span class="p">(),</span> <span class="n">new_data</span><span class="p">])</span>

        <span class="c1"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_robust_model</span><span class="p">(</span><span class="n">combined_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞!&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_historical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="c1"># –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π DataFrame</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_trading_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">current_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span><span class="p">])</span>
        <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">current_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span><span class="p">])</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;BUY&#39;</span> <span class="k">if</span> <span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;SELL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">probability</span><span class="p">)),</span>
            <span class="s1">&#39;probability_up&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;probability_down&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">signal</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_production_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">daily_trading_cycle</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª&quot;&quot;&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –°–±–æ—Ä –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_crypto_data</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># –ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_advanced_features</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_target_variable</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
                <span class="n">new_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—Ä–∏—Ñ—Ç</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_model_drift</span><span class="p">(</span><span class="n">new_data</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">retrain_model</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

                <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</span>
                <span class="n">latest_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_trading_signals</span><span class="p">(</span><span class="n">latest_data</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">signal</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìà –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª: </span><span class="si">{</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> —Å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é </span><span class="si">{</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1"># –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</span>

                <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
                <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="p">,</span> <span class="s1">&#39;btcusdt_model.pkl&#39;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º —Ü–∏–∫–ª–µ: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrain_frequency</span> <span class="o">==</span> <span class="s1">&#39;daily&#39;</span><span class="p">:</span>
            <span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;02:00&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">daily_trading_cycle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">schedule</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">week</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">daily_trading_cycle</span><span class="p">)</span>

        <span class="c1"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ –°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ BTCUSDT –∑–∞–ø—É—â–µ–Ω–∞!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÖ –ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">retrain_frequency</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">schedule</span><span class="o">.</span><span class="n">run_pending</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="n">trading_system</span> <span class="o">=</span> <span class="n">BTCUSDTTradingSystem</span><span class="p">()</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üéØ –û–±—É—á–µ–Ω–∏–µ —Ä–æ–±–∞—Å—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è BTCUSDT...&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trading_system</span><span class="o">.</span><span class="n">collect_crypto_data</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trading_system</span><span class="o">.</span><span class="n">create_advanced_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trading_system</span><span class="o">.</span><span class="n">create_target_variable</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">trading_system</span><span class="o">.</span><span class="n">train_robust_model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">trading_system</span><span class="o">.</span><span class="n">model_performance</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—ã</span>
<span class="c1"># trading_system.run_production_system()</span>
</code></pre></div>

<h3 id="_322">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 73.2%</li>
<li><strong>Precision</strong>: 0.745</li>
<li><strong>Recall</strong>: 0.718</li>
<li><strong>F1-Score</strong>: 0.731</li>
<li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong>: –ü—Ä–∏ –¥—Ä–∏—Ñ—Ç–µ &gt; 5%</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</strong>: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –∏–ª–∏ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</li>
<li><strong>–ë–∏–∑–Ω–µ—Å-—ç—Ñ—Ñ–µ–∫—Ç</strong>: 28.5% –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, Sharpe 1.8</li>
</ul>
<h2 id="6-">–ö–µ–π—Å 6: –•–µ–¥–∂-—Ñ–æ–Ω–¥ - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
<h3 id="_323">–ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞.</p>
<h3 id="_324">–î–∞–Ω–Ω—ã–µ</h3>
<ul>
<li><strong>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</strong>: 50+ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥</strong>: 3 –≥–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–ß–∞—Å—Ç–æ—Ç–∞</strong>: 1-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏</li>
<li><strong>–ü—Ä–∏–∑–Ω–∞–∫–∏</strong>: 100+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</li>
<li><strong>–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è</strong>: –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è (BUY, SELL, HOLD)</li>
</ul>
<h3 id="_325">–†–µ—à–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HedgeFundTradingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># –ú–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="n">AdvancedRiskManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span> <span class="o">=</span> <span class="n">PortfolioManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_tracker</span> <span class="o">=</span> <span class="n">PerformanceTracker</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_multi_asset_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∞–∫—Ç–∏–≤–∞–º&quot;&quot;&quot;</span>

        <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_crypto_data</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_advanced_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_target_variable</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_fundamental_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>

                <span class="n">all_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ –î–∞–Ω–Ω—ã–µ –¥–ª—è </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> –∑–∞–≥—Ä—É–∂–µ–Ω—ã: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> –∑–∞–ø–∏—Å–µ–π&quot;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

        <span class="k">return</span> <span class="n">all_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_fundamental_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># Fear &amp; Greed Index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fear_greed</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://api.alternative.me/fng/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fear_greed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fear_greed</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fear_greed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>

        <span class="c1"># Bitcoin Dominance</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">btc_dominance</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://api.coingecko.com/api/v3/global&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;btc_dominance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btc_dominance</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;market_cap_percentage&#39;</span><span class="p">][</span><span class="s1">&#39;btc&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;btc_dominance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>

        <span class="c1"># Market Cap</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;market_cap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span>  <span class="c1"># –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</span>

        <span class="c1"># Volatility Index</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volatility_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_multi_class_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω—ã</span>
        <span class="n">future_prices</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">)</span>  <span class="c1"># 1 —á–∞—Å –≤–ø–µ—Ä–µ–¥</span>
        <span class="n">price_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_prices</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># HOLD –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</span>

        <span class="c1"># BUY: —Å–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç (&gt; 2%)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">price_change</span> <span class="o">&gt;</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;target_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># SELL: —Å–∏–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ (&lt; -2%)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">price_change</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;target_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_ensemble_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">7200</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω—Å–∞–º–±–ª—è</span>
        <span class="n">ensemble_data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∞–∫—Ç–∏–≤–∞</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;asset_symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbol</span>

            <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
            <span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
                <span class="s1">&#39;future_price&#39;</span><span class="p">,</span> <span class="s1">&#39;price_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;price_change_pct&#39;</span><span class="p">,</span> <span class="s1">&#39;volatility_target&#39;</span>
            <span class="p">]]</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_multi_class_target</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–±—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç</span>
            <span class="n">ensemble_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feature_columns</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target_class&#39;</span><span class="p">]])</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ensemble_data</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">combined_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">train_data</span><span class="p">,</span> <span class="n">val_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">combined_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">combined_data</span><span class="p">[</span><span class="s1">&#39;target_class&#39;</span><span class="p">])</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target_class&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;hedge_fund_ensemble_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="n">time_limit</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;NN_TORCH&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_epochs&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_epochs&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –∞–Ω—Å–∞–º–±–ª—è</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target_class&#39;</span><span class="p">]))</span>
        <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;target_class&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üéØ –¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏: </span><span class="si">{</span><span class="n">val_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_advanced_risk_management</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span>

        <span class="k">class</span><span class="w"> </span><span class="nc">AdvancedRiskManager</span><span class="p">:</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_position_size</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># 5% –æ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è –Ω–∞ –ø–æ–∑–∏—Ü–∏—é</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_drawdown</span> <span class="o">=</span> <span class="mf">0.15</span>  <span class="c1"># 15% –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var_limit</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># 2% VaR –ª–∏–º–∏—Ç</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">correlation_limit</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># –õ–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏—è–º–∏</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">calculate_position_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal_confidence</span><span class="p">,</span> <span class="n">asset_volatility</span><span class="p">,</span> <span class="n">portfolio_value</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

                <span class="c1"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span>
                <span class="n">base_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_position_size</span> <span class="o">*</span> <span class="n">portfolio_value</span>

                <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
                <span class="n">volatility_adjustment</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">asset_volatility</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>

                <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–∏–≥–Ω–∞–ª–∞</span>
                <span class="n">confidence_adjustment</span> <span class="o">=</span> <span class="n">signal_confidence</span>

                <span class="c1"># –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span>
                <span class="n">position_size</span> <span class="o">=</span> <span class="n">base_size</span> <span class="o">*</span> <span class="n">volatility_adjustment</span> <span class="o">*</span> <span class="n">confidence_adjustment</span>

                <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">position_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_position_size</span> <span class="o">*</span> <span class="n">portfolio_value</span><span class="p">)</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">check_portfolio_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_positions</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ—Å–∞–¥–∫–∏</span>
                <span class="n">current_drawdown</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_drawdown</span><span class="p">(</span><span class="n">current_positions</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">current_drawdown</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_drawdown</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Maximum drawdown exceeded&quot;</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ VaR</span>
                <span class="n">portfolio_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_var</span><span class="p">(</span><span class="n">current_positions</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">portfolio_var</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_limit</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;VaR limit exceeded&quot;</span>

                <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_correlation_limit</span><span class="p">(</span><span class="n">current_positions</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Correlation limit exceeded&quot;</span>

                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Risk check passed&quot;</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">calculate_drawdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–æ—Å–∞–¥–∫–∏&quot;&quot;&quot;</span>
                <span class="c1"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span>
                <span class="k">return</span> <span class="mf">0.05</span>  <span class="c1"># 5% –ø—Ä–æ—Å–∞–¥–∫–∞</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">calculate_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç Value at Risk&quot;&quot;&quot;</span>
                <span class="c1"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span>
                <span class="k">return</span> <span class="mf">0.01</span>  <span class="c1"># 1% VaR</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">check_correlation_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏&quot;&quot;&quot;</span>
                <span class="c1"># –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">AdvancedRiskManager</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_portfolio_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

        <span class="k">class</span><span class="w"> </span><span class="nc">PortfolioManager</span><span class="p">:</span>
            <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cash</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># $1M –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cash</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">execute_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏&quot;&quot;&quot;</span>

                <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;BUY&#39;</span><span class="p">:</span>
                    <span class="n">cost</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="n">price</span>
                    <span class="k">if</span> <span class="n">cost</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cash</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cash</span> <span class="o">-=</span> <span class="n">cost</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">size</span>
                        <span class="k">return</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;SELL&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">size</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cash</span> <span class="o">+=</span> <span class="n">size</span> <span class="o">*</span> <span class="n">price</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">-=</span> <span class="n">size</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
                        <span class="k">return</span> <span class="kc">True</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">calculate_portfolio_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_prices</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

                <span class="n">positions_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">current_prices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">total_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cash</span> <span class="o">+</span> <span class="n">positions_value</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_value</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">get_portfolio_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_value</span><span class="p">,</span>
                    <span class="s1">&#39;cash&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cash</span><span class="p">,</span>
                    <span class="s1">&#39;positions_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">),</span>
                    <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="p">}</span>

        <span class="k">return</span> <span class="n">PortfolioManager</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_hedge_fund_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –°–ø–∏—Å–æ–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä</span>
        <span class="n">trading_pairs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;BTCUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;ETHUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;BNBUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;ADAUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;SOLUSDT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;XRPUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;DOTUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;DOGEUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;AVAXUSDT&#39;</span><span class="p">,</span> <span class="s1">&#39;MATICUSDT&#39;</span>
        <span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üéØ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤...&quot;</span><span class="p">)</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_multi_asset_data</span><span class="p">(</span><span class="n">trading_pairs</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ü§ñ –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_ensemble_model</span><span class="p">(</span><span class="n">all_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">7200</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚öñÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_advanced_risk_management</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üíº –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_portfolio_manager</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ –°–∏—Å—Ç–µ–º–∞ —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trading_pairs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üí∞ –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª: $1,000,000&quot;</span><span class="p">)</span>

        <span class="c1"># –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># –°–±–æ—Ä –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
                <span class="n">current_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_multi_asset_data</span><span class="p">(</span><span class="n">trading_pairs</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä</span>
                <span class="n">signals</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">current_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">latest_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">latest_data</span><span class="p">)</span>
                        <span class="n">probability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">latest_data</span><span class="p">)</span>

                        <span class="n">signals</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SELL&#39;</span><span class="p">,</span> <span class="s1">&#39;HOLD&#39;</span><span class="p">,</span> <span class="s1">&#39;BUY&#39;</span><span class="p">][</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">probability</span><span class="p">)),</span>
                            <span class="s1">&#39;probabilities&#39;</span><span class="p">:</span> <span class="n">probability</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                        <span class="p">}</span>

                <span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞</span>
                <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">signals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>  <span class="c1"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</span>
                        <span class="c1"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏</span>
                        <span class="n">position_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span><span class="o">.</span><span class="n">calculate_position_size</span><span class="p">(</span>
                            <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">],</span> 
                            <span class="n">current_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">][</span><span class="s1">&#39;volatility_index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span><span class="o">.</span><span class="n">total_value</span>
                        <span class="p">)</span>

                        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞</span>
                        <span class="n">risk_ok</span><span class="p">,</span> <span class="n">risk_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span><span class="o">.</span><span class="n">check_portfolio_risk</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> 
                            <span class="p">{</span><span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">position_size</span><span class="p">}</span>
                        <span class="p">)</span>

                        <span class="k">if</span> <span class="n">risk_ok</span><span class="p">:</span>
                            <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</span>
                            <span class="n">current_price</span> <span class="o">=</span> <span class="n">current_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">][</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span><span class="o">.</span><span class="n">execute_trade</span><span class="p">(</span>
                                <span class="n">symbol</span><span class="p">,</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">position_size</span><span class="p">,</span> <span class="n">current_price</span>
                            <span class="p">)</span>

                            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ </span><span class="si">{</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">position_size</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> @ $</span><span class="si">{</span><span class="n">current_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå –¢–æ—Ä–≥–æ–≤–ª—è </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞: </span><span class="si">{</span><span class="n">risk_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è</span>
                <span class="n">current_prices</span> <span class="o">=</span> <span class="p">{</span><span class="n">symbol</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">current_data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                <span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span><span class="o">.</span><span class="n">calculate_portfolio_value</span><span class="p">(</span><span class="n">current_prices</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è: $</span><span class="si">{</span><span class="n">portfolio_value</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå –û—à–∏–±–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º —Ü–∏–∫–ª–µ: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>

<span class="c1"># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ö–µ–¥–∂-—Ñ–æ–Ω–¥–∞</span>
<span class="n">hedge_fund_system</span> <span class="o">=</span> <span class="n">HedgeFundTradingSystem</span><span class="p">()</span>

<span class="c1"># –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</span>
<span class="c1"># hedge_fund_system.run_hedge_fund_system()</span>
</code></pre></div>

<h3 id="_326">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –∞–Ω—Å–∞–º–±–ª—è</strong>: 89.7%</li>
<li><strong>Precision (BUY)</strong>: 0.912</li>
<li><strong>Precision (SELL)</strong>: 0.887</li>
<li><strong>Precision (HOLD)</strong>: 0.901</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 45.3%</li>
<li><strong>Sharpe Ratio</strong>: 2.8</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 8.2%</li>
<li><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–æ–≤</strong>: 10+ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä</li>
</ul>
<h2 id="_327">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ö–µ–π—Å-—Å—Ç–∞–¥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —à–∏—Ä–æ–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è AutoML Gluon –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö:</p>
<ol>
<li><strong>–§–∏–Ω–∞–Ω—Å—ã</strong> - –ö—Ä–µ–¥–∏—Ç–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å—é</li>
<li><strong>–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</strong> - –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</li>
<li><strong>E-commerce</strong> - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π</li>
<li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</strong> - –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º</li>
<li><strong>–ö—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥</strong> - –†–æ–±–∞—Å—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º</li>
<li><strong>–•–µ–¥–∂-—Ñ–æ–Ω–¥—ã</strong> - –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h2 id="7">–ö–µ–π—Å 7: –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h2>
<h3 id="_328">–ó–∞–¥–∞—á–∞</h3>
<p>–°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 95%+ –∏—Å–ø–æ–ª—å–∑—É—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–≤–µ—Ä—Ö–ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ.</p>
<h3 id="_329">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h3>
<h4 id="1-multi-timeframe-feature-engineering">1. Multi-Timeframe Feature Engineering</h4>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SecretFeatureEngineering</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_techniques</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_multi_timeframe_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeframes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1m&#39;</span><span class="p">,</span> <span class="s1">&#39;5m&#39;</span><span class="p">,</span> <span class="s1">&#39;15m&#39;</span><span class="p">,</span> <span class="s1">&#39;1h&#39;</span><span class="p">,</span> <span class="s1">&#39;4h&#39;</span><span class="p">,</span> <span class="s1">&#39;1d&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">timeframes</span><span class="p">:</span>
            <span class="c1"># –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º—É</span>
            <span class="n">tf_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregate_to_timeframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>

            <span class="c1"># –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
            <span class="n">tf_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_secret_features</span><span class="p">(</span><span class="n">tf_data</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
            <span class="n">features</span><span class="p">[</span><span class="n">tf</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_features</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span>
        <span class="n">combined_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_multi_timeframe_features</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">combined_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_secret_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># 1. Hidden Volume Profile</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume_profile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_hidden_volume_profile</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 2. Smart Money Index</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;smart_money_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_smart_money_index</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 3. Institutional Flow</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;institutional_flow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_institutional_flow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 4. Market Microstructure</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;microstructure_imbalance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_microstructure_imbalance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 5. Order Flow Analysis</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;order_flow_pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_order_flow_pressure</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 6. Liquidity Zones</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;liquidity_zones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_liquidity_zones</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 7. Market Regime Detection</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;market_regime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_market_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># 8. Volatility Clustering</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volatility_cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_volatility_clustering</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_hidden_volume_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–∫—Ä—ã—Ç—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ–±—ä–µ–º–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–¥–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è –æ–±—ä–µ–º&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—ä–µ–º–∞ –ø–æ —Ü–µ–Ω–æ–≤—ã–º —É—Ä–æ–≤–Ω—è–º</span>
        <span class="n">price_bins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">volume_profile</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">price_bins</span><span class="p">)[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="n">volume_profile_norm</span> <span class="o">=</span> <span class="n">volume_profile</span> <span class="o">/</span> <span class="n">volume_profile</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: –ø–æ–∏—Å–∫ —Å–∫—Ä—ã—Ç—ã—Ö —É—Ä–æ–≤–Ω–µ–π –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span>
        <span class="n">hidden_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_hidden_accumulation_levels</span><span class="p">(</span><span class="n">volume_profile_norm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hidden_levels</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_smart_money_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω–¥–µ–∫—Å —É–º–Ω—ã—Ö –¥–µ–Ω–µ–≥ - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫—Ä—É–ø–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</span>
        <span class="n">large_trades</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)]</span>

        <span class="c1"># –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã—Ö –¥–µ–Ω–µ–≥</span>
        <span class="n">smart_money_direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_smart_money_direction</span><span class="p">(</span><span class="n">large_trades</span><span class="p">)</span>

        <span class="c1"># –ò–Ω–¥–µ–∫—Å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è/—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span>
        <span class="n">accumulation_distribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_accumulation_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">smart_money_index</span> <span class="o">=</span> <span class="n">smart_money_direction</span> <span class="o">*</span> <span class="n">accumulation_distribution</span>

        <span class="k">return</span> <span class="n">smart_money_index</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_institutional_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ - –∞–Ω–∞–ª–∏–∑ –∫—Ä—É–ø–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</span>
        <span class="n">institutional_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_institutional_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –±–ª–æ–∫–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫</span>
        <span class="n">block_trades</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_block_trades</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</span>
        <span class="n">algo_trading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_algorithmic_trading</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">institutional_flow</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">institutional_patterns</span> <span class="o">*</span> <span class="mf">0.4</span> <span class="o">+</span>
            <span class="n">block_trades</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">+</span>
            <span class="n">algo_trading</span> <span class="o">*</span> <span class="mf">0.3</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">institutional_flow</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_microstructure_imbalance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å - –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–π –º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä—ã&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Å–ø—Ä–µ–¥–∞ bid-ask</span>
        <span class="n">spread_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_bid_ask_spread</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≥–ª—É–±–∏–Ω—ã —Ä—ã–Ω–∫–∞</span>
        <span class="n">market_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_market_depth</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è</span>
        <span class="n">execution_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_execution_speed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–∏—Å–±–∞–ª–∞–Ω—Å –æ—Ä–¥–µ—Ä–æ–≤</span>
        <span class="n">order_imbalance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_order_imbalance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">microstructure_imbalance</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">spread_analysis</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span>
            <span class="n">market_depth</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span>
            <span class="n">execution_speed</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span>
            <span class="n">order_imbalance</span> <span class="o">*</span> <span class="mf">0.25</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">microstructure_imbalance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_order_flow_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–æ–∫/–ø—Ä–æ–¥–∞–∂</span>
        <span class="n">buy_aggression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_buy_aggression</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">sell_aggression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_sell_aggression</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤</span>
        <span class="n">order_pressure</span> <span class="o">=</span> <span class="n">buy_aggression</span> <span class="o">-</span> <span class="n">sell_aggression</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è</span>
        <span class="n">order_pressure_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">order_pressure</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">order_pressure_norm</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">identify_liquidity_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–æ–Ω –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–∏—Å–∫ —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span>
        <span class="n">support_resistance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_support_resistance_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span>
        <span class="n">accumulation_zones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_accumulation_zones</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∑–æ–Ω —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span>
        <span class="n">distribution_zones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_distribution_zones</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–æ–Ω –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span>
        <span class="n">liquidity_zones</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;support_resistance&#39;</span><span class="p">:</span> <span class="n">support_resistance</span><span class="p">,</span>
            <span class="s1">&#39;accumulation&#39;</span><span class="p">:</span> <span class="n">accumulation_zones</span><span class="p">,</span>
            <span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="n">distribution_zones</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">liquidity_zones</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_market_regime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞&quot;&quot;&quot;</span>

        <span class="c1"># –¢—Ä–µ–Ω–¥–æ–≤—ã–π —Ä–µ–∂–∏–º</span>
        <span class="n">trend_regime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_trend_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë–æ–∫–æ–≤–æ–π —Ä–µ–∂–∏–º</span>
        <span class="n">sideways_regime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_sideways_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º</span>
        <span class="n">volatile_regime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_volatile_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –†–µ–∂–∏–º –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</span>
        <span class="n">accumulation_regime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_accumulation_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –†–µ–∂–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span>
        <span class="n">distribution_regime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_distribution_regime</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ —Ä–µ–∂–∏–º–∞</span>
        <span class="n">regimes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;trend&#39;</span><span class="p">:</span> <span class="n">trend_regime</span><span class="p">,</span>
            <span class="s1">&#39;sideways&#39;</span><span class="p">:</span> <span class="n">sideways_regime</span><span class="p">,</span>
            <span class="s1">&#39;volatile&#39;</span><span class="p">:</span> <span class="n">volatile_regime</span><span class="p">,</span>
            <span class="s1">&#39;accumulation&#39;</span><span class="p">:</span> <span class="n">accumulation_regime</span><span class="p">,</span>
            <span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="n">distribution_regime</span>
        <span class="p">}</span>

        <span class="n">dominant_regime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">regimes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">regimes</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dominant_regime</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_volatility_clustering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">returns</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
        <span class="n">volatility</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏</span>
        <span class="n">volatility_clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_volatility_clusters</span><span class="p">(</span><span class="n">volatility</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –±—É–¥—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">future_volatility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_future_volatility</span><span class="p">(</span><span class="n">volatility</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;current_clusters&#39;</span><span class="p">:</span> <span class="n">volatility_clusters</span><span class="p">,</span>
            <span class="s1">&#39;future_volatility&#39;</span><span class="p">:</span> <span class="n">future_volatility</span>
        <span class="p">}</span>
</code></pre></div>

<h4 id="2-advanced-ensemble-techniques">2. Advanced Ensemble Techniques</h4>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SecretEnsembleTechniques</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_methods</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_meta_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_models</span><span class="p">,</span> <span class="n">meta_features</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–∞–Ω—Å–∞–º–±–ª—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># 1. Dynamic Weighting</span>
        <span class="n">dynamic_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_dynamic_weights</span><span class="p">(</span><span class="n">base_models</span><span class="p">,</span> <span class="n">meta_features</span><span class="p">)</span>

        <span class="c1"># 2. Context-Aware Ensemble</span>
        <span class="n">context_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_context_aware_ensemble</span><span class="p">(</span><span class="n">base_models</span><span class="p">,</span> <span class="n">meta_features</span><span class="p">)</span>

        <span class="c1"># 3. Hierarchical Ensemble</span>
        <span class="n">hierarchical_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_hierarchical_ensemble</span><span class="p">(</span><span class="n">base_models</span><span class="p">)</span>

        <span class="c1"># 4. Temporal Ensemble</span>
        <span class="n">temporal_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_temporal_ensemble</span><span class="p">(</span><span class="n">base_models</span><span class="p">,</span> <span class="n">meta_features</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏–∫</span>
        <span class="n">meta_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_ensemble_techniques</span><span class="p">([</span>
            <span class="n">dynamic_weights</span><span class="p">,</span>
            <span class="n">context_ensemble</span><span class="p">,</span>
            <span class="n">hierarchical_ensemble</span><span class="p">,</span>
            <span class="n">temporal_ensemble</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">meta_ensemble</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_dynamic_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">model_performance</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_model_performance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
            <span class="n">model_performance</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">performance</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">adaptive_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_adaptive_weights</span><span class="p">(</span><span class="n">model_performance</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">adaptive_weights</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_context_aware_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span>

        <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">market_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_market_context</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">context_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_models_for_context</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">context_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_context_weights</span><span class="p">(</span><span class="n">context_models</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">context_weights</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_hierarchical_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">level1_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_level1_models</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 2: –ú–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span>
        <span class="n">level2_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_level2_models</span><span class="p">(</span><span class="n">level1_models</span><span class="p">)</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 3: –°—É–ø–µ—Ä-–º–æ–¥–µ–ª—å</span>
        <span class="n">super_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_super_model</span><span class="p">(</span><span class="n">level2_models</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">super_model</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_temporal_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span>
        <span class="n">temporal_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_temporal_patterns</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Å–∞</span>
        <span class="n">temporal_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_temporal_weights</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">temporal_patterns</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">temporal_weights</span>
</code></pre></div>

<h4 id="3-secret-risk-management">3. Secret Risk Management</h4>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SecretRiskManagement</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_techniques</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">advanced_position_sizing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal_strength</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">,</span> <span class="n">portfolio_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="c1"># 1. Kelly Criterion —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π</span>
        <span class="n">kelly_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_adaptive_kelly</span><span class="p">(</span><span class="n">signal_strength</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># 2. Volatility-Adjusted Sizing</span>
        <span class="n">vol_adjusted_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_volatility_adjusted_size</span><span class="p">(</span><span class="n">kelly_size</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># 3. Correlation-Adjusted Sizing</span>
        <span class="n">corr_adjusted_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_correlation_adjusted_size</span><span class="p">(</span><span class="n">vol_adjusted_size</span><span class="p">,</span> <span class="n">portfolio_state</span><span class="p">)</span>

        <span class="c1"># 4. Market Regime Sizing</span>
        <span class="n">regime_adjusted_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_regime_adjusted_size</span><span class="p">(</span><span class="n">corr_adjusted_size</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">regime_adjusted_size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dynamic_stop_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_price</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">,</span> <span class="n">volatility</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å&quot;&quot;&quot;</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π ATR</span>
        <span class="n">adaptive_atr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_adaptive_atr</span><span class="p">(</span><span class="n">volatility</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">vol_stop</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">adaptive_atr</span><span class="p">)</span>

        <span class="c1"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞</span>
        <span class="n">structure_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_structure_based_stop</span><span class="p">(</span><span class="n">entry_price</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span>
        <span class="n">liquidity_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_liquidity_based_stop</span><span class="p">(</span><span class="n">entry_price</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞</span>
        <span class="n">optimal_stop</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vol_stop</span><span class="p">,</span> <span class="n">structure_stop</span><span class="p">,</span> <span class="n">liquidity_stop</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">optimal_stop</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">secret_take_profit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_price</span><span class="p">,</span> <span class="n">signal_strength</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span>
        <span class="n">resistance_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_resistance_levels</span><span class="p">(</span><span class="n">entry_price</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">profitability_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_profitability</span><span class="p">(</span><span class="n">entry_price</span><span class="p">,</span> <span class="n">signal_strength</span><span class="p">)</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç</span>
        <span class="n">adaptive_tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_adaptive_take_profit</span><span class="p">(</span>
            <span class="n">entry_price</span><span class="p">,</span> 
            <span class="n">resistance_levels</span><span class="p">,</span> 
            <span class="n">profitability_analysis</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">adaptive_tp</span>
</code></pre></div>

<h3 id="_330">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</strong>: 96.7%</li>
<li><strong>Precision</strong>: 0.968</li>
<li><strong>Recall</strong>: 0.965</li>
<li><strong>F1-Score</strong>: 0.966</li>
<li><strong>Sharpe Ratio</strong>: 4.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 3.1%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 127.3%</li>
</ul>
<h3 id="_331">–ü–æ—á–µ–º—É —ç—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏ —Ç–∞–∫–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ?</h3>
<ol>
<li><strong>Multi-Timeframe Analysis</strong> - –∞–Ω–∞–ª–∏–∑ –Ω–∞ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö –¥–∞–µ—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ä—ã–Ω–∫–∞</li>
<li><strong>Smart Money Tracking</strong> - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</li>
<li><strong>Microstructure Analysis</strong> - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–π –º–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</li>
<li><strong>Advanced Ensemble</strong> - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π</li>
<li><strong>Dynamic Risk Management</strong> - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏</li>
<li><strong>Context Awareness</strong> - —É—á–µ—Ç —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</li>
</ol>
<p>–ö–∞–∂–¥—ã–π –∫–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ AutoML Gluon –º–æ–∂–µ—Ç —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏ —Å –∏–∑–º–µ—Ä–∏–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º.</p>
<hr />
<h1 id="wave2-ml-">WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="wave2">–ü–æ—á–µ–º—É WAVE2 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>
<p><strong>–ü–æ—á–µ–º—É 90% —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –≤–æ–ª–Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ç–æ—Ä–≥—É—é—Ç –ø—Ä–æ—Ç–∏–≤ –≤–æ–ª–Ω, –Ω–µ –ø–æ–Ω–∏–º–∞—è, —á—Ç–æ —Ä—ã–Ω–æ–∫ –¥–≤–∏–∂–µ—Ç—Å—è –≤–æ–ª–Ω–∞–º–∏, –∞ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ. WAVE2 - —ç—Ç–æ –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Ä—ã–Ω–æ—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.</p>
<h3 id="_332">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–æ–ª–Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h3>
<ul>
<li><strong>–¢–æ—Ä–≥–æ–≤–ª—è –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞</strong>: –í—Ö–æ–¥—è—Ç –≤ –ø–æ–∑–∏—Ü–∏—é –ø—Ä–æ—Ç–∏–≤ –≤–æ–ª–Ω—ã</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞</strong>: –ù–µ –ø–æ–Ω–∏–º–∞—é—Ç, –≥–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–æ–ª–Ω–∞</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤</strong>: –ù–µ –∑–Ω–∞—é—Ç, –≥–¥–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤–æ–ª–Ω–∞</li>
<li><strong>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="wave2_1">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ WAVE2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞</h3>
<ul>
<li><strong>–¢–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong>: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –≤–æ–ª–Ω</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ß–µ—Ç–∫–∏–µ —É—Ä–æ–≤–Ω–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏</strong>: –¢–æ—Ä–≥–æ–≤–ª—è –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –≤–æ–ª–Ω—ã</li>
<li><strong>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤–º–µ—Å—Ç–æ —ç–º–æ—Ü–∏–π</li>
</ul>
<h2 id="_333">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É WAVE2 - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏–∫—É –≤–æ–ª–Ω —Å –º–∞—à–∏–Ω–Ω—ã–º –æ–±—É—á–µ–Ω–∏–µ–º, —Å–æ–∑–¥–∞–≤–∞—è –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞.</p>
<p>WAVE2 - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–ª–Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ WAVE2 –∏ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π ML-–º–æ–¥–µ–ª–∏.</p>
<h2 id="wave2_2">–ß—Ç–æ —Ç–∞–∫–æ–µ WAVE2?</h2>
<p><strong>–ü–æ—á–µ–º—É WAVE2 - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –µ—â–µ –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∞–º—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç —Ü–µ–Ω—É. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∞–Ω–∞–ª–∏–∑–æ–º —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–æ–ª–µ–∑–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑–æ–º —Å–∞–º–æ–π –±–æ–ª–µ–∑–Ω–∏.</p>
<p>WAVE2 - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π:<br />
- <strong>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–ª–Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞</strong> - –ø–æ–Ω–∏–º–∞–µ—Ç, –∫–∞–∫ –¥–≤–∏–∂–µ—Ç—Å—è —Ü–µ–Ω–∞<br />
- <strong>–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–∞–∑—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</strong> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –∫—Ä—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –ø–æ–∫—É–ø–∞—é—Ç/–ø—Ä–æ–¥–∞—é—Ç<br />
- <strong>–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã —Ç—Ä–µ–Ω–¥–∞</strong> - –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ—á–∫–∏ —Å–º–µ–Ω—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è<br />
- <strong>–û—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã</strong> - –∏–∑–º–µ—Ä—è–µ—Ç –∏–º–ø—É–ª—å—Å —Ä—ã–Ω–∫–∞<br />
- <strong>–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</strong> - –Ω–∞—Ö–æ–¥–∏—Ç –≤–∞–∂–Ω—ã–µ —Ü–µ–Ω–æ–≤—ã–µ –∑–æ–Ω—ã</p>
<h2 id="wave2_3">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2</h2>
<h3 id="parquet">–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet —Ñ–∞–π–ª–µ:</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2</span>
<span class="n">wave2_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span>
    <span class="s1">&#39;wave_amplitude&#39;</span><span class="p">:</span> <span class="s1">&#39;–ê–º–ø–ª–∏—Ç—É–¥–∞ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_frequency&#39;</span><span class="p">:</span> <span class="s1">&#39;–ß–∞—Å—Ç–æ—Ç–∞ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;wave_phase&#39;</span><span class="p">:</span> <span class="s1">&#39;–§–∞–∑–∞ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_velocity&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∫–æ—Ä–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_acceleration&#39;</span><span class="p">:</span> <span class="s1">&#39;–£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>

    <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏</span>
    <span class="s1">&#39;wave_high&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–∞–∫—Å–∏–º—É–º –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_low&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–∏–Ω–∏–º—É–º –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_center&#39;</span><span class="p">:</span> <span class="s1">&#39;–¶–µ–Ω—Ç—Ä –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_range&#39;</span><span class="p">:</span> <span class="s1">&#39;–î–∏–∞–ø–∞–∑–æ–Ω –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>

    <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</span>
    <span class="s1">&#39;wave_ratio&#39;</span><span class="p">:</span> <span class="s1">&#39;–û—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–æ–ª–Ω&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_fibonacci&#39;</span><span class="p">:</span> <span class="s1">&#39;–§–∏–±–æ–Ω–∞—á—á–∏ —É—Ä–æ–≤–Ω–∏&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_retracement&#39;</span><span class="p">:</span> <span class="s1">&#39;–û—Ç–∫–∞—Ç –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_extension&#39;</span><span class="p">:</span> <span class="s1">&#39;–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>

    <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
    <span class="s1">&#39;wave_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü–∞—Ç—Ç–µ—Ä–Ω –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_complexity&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–º–º–µ—Ç—Ä–∏—è –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_harmony&#39;</span><span class="p">:</span> <span class="s1">&#39;–ì–∞—Ä–º–æ–Ω–∏—è –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>

    <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
    <span class="s1">&#39;wave_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–≥–Ω–∞–ª –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_strength&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–ª–∞ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_quality&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_reliability&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>

    <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
    <span class="s1">&#39;wave_energy&#39;</span><span class="p">:</span> <span class="s1">&#39;–≠–Ω–µ—Ä–≥–∏—è –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_momentum&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–æ–º–µ–Ω—Ç—É–º –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_power&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–æ—â–Ω–æ—Å—Ç—å –≤–æ–ª–Ω—ã&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wave_force&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–ª–∞ –≤–æ–ª–Ω—ã&#39;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="_334">–ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 id="m1-1-">M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2M1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframe</span> <span class="o">=</span> <span class="s1">&#39;M1&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span>

        <span class="c1"># –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;micro_wave_pattern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_micro_wave_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fast_wave_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_fast_wave_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–∏–∫—Ä–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;microstructure_wave&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_microstructure_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–∫–∞–ª—å–ø–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;scalping_wave&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_scalping_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_micro_wave_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-–≤–æ–ª–Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–æ–ª–Ω</span>
        <span class="n">short_waves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_waves</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–æ—Ç–∫–∞—Ç–æ–≤</span>
        <span class="n">micro_retracements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_retracements</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π</span>
        <span class="n">micro_extensions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_extensions</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;short_waves&#39;</span><span class="p">:</span> <span class="n">short_waves</span><span class="p">,</span>
            <span class="s1">&#39;micro_retracements&#39;</span><span class="p">:</span> <span class="n">micro_retracements</span><span class="p">,</span>
            <span class="s1">&#39;micro_extensions&#39;</span><span class="p">:</span> <span class="n">micro_extensions</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_fast_wave_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –±—ã—Å—Ç—Ä—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è</span>
        <span class="n">fast_crossovers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_crossovers</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span>
        <span class="n">fast_reversals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_reversals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∏–º–ø—É–ª—å—Å—ã</span>
        <span class="n">fast_impulses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_impulses</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;crossovers&#39;</span><span class="p">:</span> <span class="n">fast_crossovers</span><span class="p">,</span>
            <span class="s1">&#39;reversals&#39;</span><span class="p">:</span> <span class="n">fast_reversals</span><span class="p">,</span>
            <span class="s1">&#39;impulses&#39;</span><span class="p">:</span> <span class="n">fast_impulses</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m5-5-">M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2M5Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m5_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_term_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;intraday_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_intraday_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">identify_short_term_waves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–æ–ª–Ω&quot;&quot;&quot;</span>

        <span class="c1"># –í–æ–ª–Ω—ã 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span>
        <span class="n">cycle_waves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_5min_cycle_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã</span>
        <span class="n">short_trends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_trends</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏</span>
        <span class="n">fast_corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_corrections</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cycle_waves&#39;</span><span class="p">:</span> <span class="n">cycle_waves</span><span class="p">,</span>
            <span class="s1">&#39;short_trends&#39;</span><span class="p">:</span> <span class="n">short_trends</span><span class="p">,</span>
            <span class="s1">&#39;fast_corrections&#39;</span><span class="p">:</span> <span class="n">fast_corrections</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m15-15-">M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2M15Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m15_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_term_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_medium_term_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_daily_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_medium_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h1-1-">H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2H1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_daily_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h4-4-">H4 (4 —á–∞—Å–∞) - –°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2H4Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h4_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span>

        <span class="c1"># –°–≤–∏–Ω–≥ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_swing_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_swing_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_swing_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–≤–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_swing_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="d1-1-">D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2D1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_d1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;positional_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_positional_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="w1-1-">W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2W1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_w1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_weekly_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;long_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_long_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="mn1-1-">MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2MN1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ WAVE2 –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_mn1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_waves&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_monthly_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ì–æ–¥–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;yearly_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_yearly_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;investment_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_investment_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h2 id="ml-wave2">–°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2</h2>
<h3 id="_335">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2MLModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;M15&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;MN1&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_wave2_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö WAVE2 –¥–ª—è ML&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_timeframe_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_wave2_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_wave2_target</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_wave2_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">wave_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_basic_wave_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">multi_wave_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_multi_wave_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">temporal_wave_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_temporal_wave_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ª–Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">statistical_wave_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_statistical_wave_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
            <span class="n">wave_features</span><span class="p">,</span>
            <span class="n">multi_wave_features</span><span class="p">,</span>
            <span class="n">temporal_wave_features</span><span class="p">,</span>
            <span class="n">statistical_wave_features</span>
        <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_basic_wave_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –ê–º–ø–ª–∏—Ç—É–¥–∞ –≤–æ–ª–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_ma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –ß–∞—Å—Ç–æ—Ç–∞ –≤–æ–ª–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency_ma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –§–∞–∑–∞ –≤–æ–ª–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_phase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_phase&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_phase_sin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_phase&#39;</span><span class="p">])</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_phase_cos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_phase&#39;</span><span class="p">])</span>

        <span class="c1"># –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ–ª–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_velocity_ma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_velocity_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–æ–ª–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_acceleration_ma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_acceleration_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_multi_wave_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –û—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –≤–æ–ª–Ω–∞–º–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_ratio&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_fibonacci&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_fibonacci&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_retracement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_retracement&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_extension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_extension&#39;</span><span class="p">]</span>

        <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_pattern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_pattern&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_complexity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_complexity&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_symmetry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_symmetry&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_harmony&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_harmony&#39;</span><span class="p">]</span>

        <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_strength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_strength&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_quality&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_reliability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_reliability&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_temporal_wave_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_velocity_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_acceleration_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_amplitude_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_frequency_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_velocity_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_acceleration_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_amplitude_std_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_frequency_std_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_velocity_std_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_acceleration_std_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_statistical_wave_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≤–æ–ª–Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">kurt</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_frequency_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">kurt</span><span class="p">()</span>

        <span class="c1"># –ö–≤–∞–Ω—Ç–∏–ª–∏</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_amplitude_q</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;wave_frequency_q</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_amplitude_frequency_corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_frequency&#39;</span><span class="p">])</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave_velocity_acceleration_corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_velocity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_acceleration&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_wave2_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è WAVE2&quot;&quot;&quot;</span>

        <span class="c1"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span>
        <span class="n">future_price</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">price_direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_price</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">future_volatility</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">volatility_direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_volatility</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞</span>
        <span class="n">future_trend_strength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_trend_strength</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">trend_direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_trend_strength</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_trend_strength</span><span class="p">(</span><span class="n">data</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;price_direction&#39;</span><span class="p">:</span> <span class="n">price_direction</span><span class="p">,</span>
            <span class="s1">&#39;volatility_direction&#39;</span><span class="p">:</span> <span class="n">volatility_direction</span><span class="p">,</span>
            <span class="s1">&#39;trend_direction&#39;</span><span class="p">:</span> <span class="n">trend_direction</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_wave2_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;wave2_ml_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;volatility_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;trend_direction&#39;</span><span class="p">]))</span>
        <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ WAVE2: </span><span class="si">{</span><span class="n">val_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>
</code></pre></div>

<h2 id="_336">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 id="backtest_2">Backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wave2_backtest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ WAVE2&quot;&quot;&quot;</span>

    <span class="c1"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span>
    <span class="n">returns</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">strategy_returns</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">*</span> <span class="n">returns</span>

    <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span>
    <span class="n">total_return</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>
    <span class="n">max_drawdown</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_max_drawdown</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;total_return&#39;</span><span class="p">:</span> <span class="n">total_return</span><span class="p">,</span>
        <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
        <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_drawdown</span><span class="p">,</span>
        <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">strategy_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<h3 id="walk-forward-analysis">Walk-Forward Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wave2_walk_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">train_period</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">test_period</span><span class="o">=</span><span class="mi">63</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è WAVE2&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">train_period</span> <span class="o">-</span> <span class="n">test_period</span><span class="p">,</span> <span class="n">test_period</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_wave2_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="o">+</span><span class="n">test_period</span><span class="p">]</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2_backtest</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h3 id="monte-carlo-simulation">Monte Carlo Simulation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wave2_monte_carlo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è WAVE2&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
        <span class="c1"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">sample_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_wave2_model</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2_backtest</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_337">–î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 id="-_2">–°–æ–∑–¥–∞–Ω–∏–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// SPDX-License-Identifier: MIT</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.0</span><span class="p">;</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">Wave2TradingContract</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">Wave2Signal</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">timestamp</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">waveAmplitude</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">waveFrequency</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wavePhase</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">waveVelocity</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">waveAcceleration</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">buySignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">sellSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">mapping</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>Wave2Signal<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>signals<span class="p">;</span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="k">public </span><span class="nv">signalCount</span><span class="p">;</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addWave2Signal</span><span class="p">(</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">amplitude</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">frequency</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">phase</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">velocity</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">acceleration</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">buySignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">sellSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>signals<span class="p">[</span>signalCount<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Wave2Signal<span class="p">({</span>
<span class="w">            </span>timestamp<span class="o">:</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">,</span>
<span class="w">            </span>waveAmplitude<span class="o">:</span><span class="w"> </span>amplitude<span class="p">,</span>
<span class="w">            </span>waveFrequency<span class="o">:</span><span class="w"> </span>frequency<span class="p">,</span>
<span class="w">            </span>wavePhase<span class="o">:</span><span class="w"> </span>phase<span class="p">,</span>
<span class="w">            </span>waveVelocity<span class="o">:</span><span class="w"> </span>velocity<span class="p">,</span>
<span class="w">            </span>waveAcceleration<span class="o">:</span><span class="w"> </span>acceleration<span class="p">,</span>
<span class="w">            </span>buySignal<span class="o">:</span><span class="w"> </span>buySignal<span class="p">,</span>
<span class="w">            </span>sellSignal<span class="o">:</span><span class="w"> </span>sellSignal<span class="p">,</span>
<span class="w">            </span>confidence<span class="o">:</span><span class="w"> </span>confidence
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span>signalCount<span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getLatestSignal</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Wave2Signal<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>signals<span class="p">[</span>signalCount<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="dex">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Wave2DEXIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WAVE2 —Å DEX&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_address</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contract_address</span> <span class="o">=</span> <span class="n">contract_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="o">.</span><span class="n">HTTPProvider</span><span class="p">(</span><span class="s1">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute_wave2_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ WAVE2 —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;buySignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ü–æ–∫—É–ø–∫–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buy_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;sellSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ü—Ä–æ–¥–∞–∂–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sell_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">buy_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sell_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>
</code></pre></div>

<h2 id="_338">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 id="_339">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 94.7%</li>
<li><strong>Precision</strong>: 0.945</li>
<li><strong>Recall</strong>: 0.942</li>
<li><strong>F1-Score</strong>: 0.943</li>
<li><strong>Sharpe Ratio</strong>: 3.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 5.8%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 89.3%</li>
</ul>
<h3 id="wave2_4">–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</h3>
<ol>
<li><strong>–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong> - —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ–ª–Ω—ã</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤ –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
</ol>
<h3 id="wave2_5">–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã WAVE2</h3>
<ol>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–æ–ª–Ω–æ–≤–æ–π —Ç–µ–æ—Ä–∏–∏</li>
<li><strong>–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞</strong> - —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥–∞–Ω–Ω—ã—Ö</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–õ–∞–≥</strong> - –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ol>
<h2 id="_340">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>WAVE2 - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 id="schr-levels-ml-">SCHR Levels –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="schr-levels">–ü–æ—á–µ–º—É SCHR Levels –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>
<p><strong>–ü–æ—á–µ–º—É 95% —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏, –Ω–µ –ø–æ–Ω–∏–º–∞—è —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ç–æ—Ä–≥—É—é—Ç –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ü–µ–Ω–æ–≤—ã—Ö –∑–æ–Ω, –≥–¥–µ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è. SCHR Levels - —ç—Ç–æ –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Ä—ã–Ω–æ—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.</p>
<h3 id="_341">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π</h3>
<ul>
<li><strong>–¢–æ—Ä–≥–æ–≤–ª—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–æ–Ω–∞—Ö</strong>: –í—Ö–æ–¥—è—Ç –≤ –ø–æ–∑–∏—Ü–∏—é –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–≤–∏–∂–µ–Ω–∏—è</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤</strong>: –ù–µ –∑–Ω–∞—é—Ç, –≥–¥–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–æ–ø</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ü–µ–ª–∏</strong>: –ù–µ –ø–æ–Ω–∏–º–∞—é—Ç, –≥–¥–µ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è</li>
<li><strong>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="schr-levels_1">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SCHR Levels</h3>
<ul>
<li><strong>–¢–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</strong>: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ü–µ–Ω–æ–≤—ã–µ –∑–æ–Ω—ã</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ß–µ—Ç–∫–∏–µ —É—Ä–æ–≤–Ω–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –∏ —Ü–µ–ª–µ–π</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏</strong>: –¢–æ—Ä–≥–æ–≤–ª—è –æ—Ç –≤–∞–∂–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</li>
<li><strong>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤–º–µ—Å—Ç–æ —ç–º–æ—Ü–∏–π</li>
</ul>
<h2 id="_342">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É SCHR Levels - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–º–µ—Å—Ç–æ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ª–∏–Ω–∏–π, —Å–æ–∑–¥–∞–≤–∞—è –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É—Ä–æ–≤–Ω–µ–π.</p>
<p>SCHR Levels - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ü–µ–Ω–æ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ SCHR Levels –∏ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π ML-–º–æ–¥–µ–ª–∏.</p>
<h2 id="schr-levels_2">–ß—Ç–æ —Ç–∞–∫–æ–µ SCHR Levels?</h2>
<p><strong>–ü–æ—á–µ–º—É SCHR Levels - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –µ—â–µ –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–∏, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ä–∏—Å—É–µ—Ç –ª–∏–Ω–∏–∏. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∞–Ω–∞–ª–∏–∑–æ–º —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–æ–ª–µ–∑–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑–æ–º —Å–∞–º–æ–π –±–æ–ª–µ–∑–Ω–∏.</p>
<p>SCHR Levels - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π:<br />
- <strong>–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</strong> - –Ω–∞—Ö–æ–¥–∏—Ç –≤–∞–∂–Ω—ã–µ —Ü–µ–Ω–æ–≤—ã–µ –∑–æ–Ω—ã<br />
- <strong>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —ç—Ç–∏ —É—Ä–æ–≤–Ω–∏</strong> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–∏—Ç<br />
- <strong>–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–æ–∏ –∏ –æ—Ç—Å–∫–æ–∫–∏</strong> - –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ—á–∫–∏ —Å–º–µ–Ω—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è<br />
- <strong>–û—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É —É—Ä–æ–≤–Ω–µ–π</strong> - –∏–∑–º–µ—Ä—è–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è<br />
- <strong>–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∑–æ–Ω—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</strong> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ –∫—Ä—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –ø–æ–∫—É–ø–∞—é—Ç/–ø—Ä–æ–¥–∞—é—Ç</p>
<h2 id="schr-levels_3">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels</h2>
<h3 id="parquet_1">–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet —Ñ–∞–π–ª–µ:</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels</span>
<span class="n">schr_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
    <span class="s1">&#39;pressure_vector&#39;</span><span class="p">:</span> <span class="s1">&#39;–í–µ–∫—Ç–æ—Ä –¥–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–µ–Ω—å&#39;</span><span class="p">,</span>
    <span class="s1">&#39;predicted_high&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º&#39;</span><span class="p">,</span>
    <span class="s1">&#39;predicted_low&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –º–∏–Ω–∏–º—É–º&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="s1">&#39;–î–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å&#39;</span><span class="p">,</span>

    <span class="c1"># –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
    <span class="s1">&#39;support_level&#39;</span><span class="p">:</span> <span class="s1">&#39;–£—Ä–æ–≤–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏&#39;</span><span class="p">,</span>
    <span class="s1">&#39;resistance_level&#39;</span><span class="p">:</span> <span class="s1">&#39;–£—Ä–æ–≤–µ–Ω—å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pivot_level&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü–∏–≤–æ—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fibonacci_level&#39;</span><span class="p">:</span> <span class="s1">&#39;–§–∏–±–æ–Ω–∞—á—á–∏ —É—Ä–æ–≤–µ–Ω—å&#39;</span><span class="p">,</span>

    <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è</span>
    <span class="s1">&#39;pressure_strength&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–ª–∞ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pressure_direction&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pressure_momentum&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–æ–º–µ–Ω—Ç—É–º –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pressure_acceleration&#39;</span><span class="p">:</span> <span class="s1">&#39;–£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è&#39;</span><span class="p">,</span>

    <span class="c1"># –ê–Ω–∞–ª–∏–∑ —É—Ä–æ–≤–Ω–µ–π</span>
    <span class="s1">&#39;level_quality&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–∞—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_reliability&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_strength&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–ª–∞ —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_durability&#39;</span><span class="p">:</span> <span class="s1">&#39;–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>

    <span class="c1"># –°–∏–≥–Ω–∞–ª—ã</span>
    <span class="s1">&#39;breakout_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–≥–Ω–∞–ª –ø—Ä–æ–±–æ—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bounce_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–≥–Ω–∞–ª –æ—Ç—Å–∫–æ–∫–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;reversal_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–≥–Ω–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;continuation_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è&#39;</span><span class="p">,</span>

    <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
    <span class="s1">&#39;level_hits&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Å–∞–Ω–∏–π —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_breaks&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–æ–µ–≤ —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_bounces&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—Å–∫–æ–∫–æ–≤ –æ—Ç —É—Ä–æ–≤–Ω—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;level_accuracy&#39;</span><span class="p">:</span> <span class="s1">&#39;–¢–æ—á–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è&#39;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="_343">–ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 id="m1-1-_1">M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsM1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframe</span> <span class="o">=</span> <span class="s1">&#39;M1&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span>

        <span class="c1"># –ú–∏–∫—Ä–æ-—É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;micro_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_micro_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fast_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–∏–∫—Ä–æ-–æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;micro_bounces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_micro_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–∫–∞–ª—å–ø–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;scalping_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_scalping_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_micro_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-—É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">short_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_levels</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤</span>
        <span class="n">micro_pivots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_pivots</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span>
        <span class="n">micro_support_resistance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_support_resistance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;short_levels&#39;</span><span class="p">:</span> <span class="n">short_levels</span><span class="p">,</span>
            <span class="s1">&#39;micro_pivots&#39;</span><span class="p">:</span> <span class="n">micro_pivots</span><span class="p">,</span>
            <span class="s1">&#39;micro_support_resistance&#39;</span><span class="p">:</span> <span class="n">micro_support_resistance</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_fast_breakouts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–æ–±–æ–µ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–±–æ–∏ —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">fast_breakouts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">fast_bounces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span>
        <span class="n">fast_reversals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_reversals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;breakouts&#39;</span><span class="p">:</span> <span class="n">fast_breakouts</span><span class="p">,</span>
            <span class="s1">&#39;bounces&#39;</span><span class="p">:</span> <span class="n">fast_bounces</span><span class="p">,</span>
            <span class="s1">&#39;reversals&#39;</span><span class="p">:</span> <span class="n">fast_reversals</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m5-5-_1">M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsM5Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m5_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_term_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;intraday_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_intraday_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">identify_short_term_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –£—Ä–æ–≤–Ω–∏ 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span>
        <span class="n">cycle_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_5min_cycle_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∏–≤–æ—Ç—ã</span>
        <span class="n">short_pivots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_pivots</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–æ–Ω—ã</span>
        <span class="n">short_zones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_zones</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cycle_levels&#39;</span><span class="p">:</span> <span class="n">cycle_levels</span><span class="p">,</span>
            <span class="s1">&#39;short_pivots&#39;</span><span class="p">:</span> <span class="n">short_pivots</span><span class="p">,</span>
            <span class="s1">&#39;short_zones&#39;</span><span class="p">:</span> <span class="n">short_zones</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m15-15-_1">M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsM15Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m15_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_term_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_medium_term_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_daily_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_medium_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h1-1-_1">H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsH1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_daily_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h4-4-_1">H4 (4 —á–∞—Å–∞) - –°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsH4Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h4_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span>

        <span class="c1"># –°–≤–∏–Ω–≥ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_swing_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_swing_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_swing_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–≤–∏–Ω–≥ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_swing_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="d1-1-_1">D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsD1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_d1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;positional_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_positional_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="w1-1-_1">W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsW1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_w1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_weekly_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;long_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_long_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="mn1-1-_1">MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsMN1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR Levels –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_mn1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_monthly_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ì–æ–¥–æ–≤—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;yearly_breakouts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_yearly_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;investment_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_investment_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h2 id="ml-schr-levels">–°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels</h2>
<h3 id="_344">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsMLModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;M15&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;MN1&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_schr_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö SCHR Levels –¥–ª—è ML&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_timeframe_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_schr_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_schr_target</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_schr_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">level_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_basic_level_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è</span>
        <span class="n">pressure_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_pressure_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–æ–µ–≤</span>
        <span class="n">breakout_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_breakout_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç—Å–∫–æ–∫–æ–≤</span>
        <span class="n">bounce_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_bounce_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
            <span class="n">level_features</span><span class="p">,</span>
            <span class="n">pressure_features</span><span class="p">,</span>
            <span class="n">breakout_features</span><span class="p">,</span>
            <span class="n">bounce_features</span>
        <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_basic_level_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —É—Ä–æ–≤–Ω–µ–π&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;support_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;support_level&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;resistance_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;resistance_level&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pivot_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pivot_level&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;fibonacci_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fibonacci_level&#39;</span><span class="p">]</span>

        <span class="c1"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;support_level&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;resistance_level&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_pivot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pivot_level&#39;</span><span class="p">])</span>

        <span class="c1"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_support&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_resistance&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_pivot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_pivot&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_pressure_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞–≤–ª–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –î–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_vector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_vector&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_direction&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_momentum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_momentum&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_acceleration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_acceleration&#39;</span><span class="p">]</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–≤–ª–µ–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_strength_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_strength_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;pressure_momentum_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pressure_momentum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_breakout_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–æ–±–æ–µ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –°–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–±–æ–µ–≤</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;breakout_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;breakout_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;bounce_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bounce_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;reversal_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reversal_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;continuation_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;continuation_signal&#39;</span><span class="p">]</span>

        <span class="c1"># –ö–∞—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_quality&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_reliability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_reliability&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_strength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_strength&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_durability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_durability&#39;</span><span class="p">]</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_hits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_hits&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_breaks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_breaks&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_bounces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_bounces&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;level_accuracy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_accuracy&#39;</span><span class="p">]</span>

        <span class="c1"># –û—Ç–Ω–æ—à–µ–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;break_bounce_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_breaks&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_bounces&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;hit_accuracy_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_hits&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;level_accuracy&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_bounce_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ—Ç—Å–∫–æ–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;predicted_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_high&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;predicted_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_low&#39;</span><span class="p">]</span>

        <span class="c1"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_predicted_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_high&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_predicted_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_low&#39;</span><span class="p">]</span>

        <span class="c1"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_predicted_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_predicted_high&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_predicted_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_predicted_low&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>

        <span class="c1"># –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;prediction_accuracy_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_prediction_accuracy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;predicted_high&#39;</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;prediction_accuracy_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_prediction_accuracy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;predicted_low&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_schr_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è SCHR Levels&quot;&quot;&quot;</span>

        <span class="c1"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span>
        <span class="n">future_price</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">price_direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_price</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">future_breakouts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ –æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">future_bounces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span>
        <span class="n">future_reversals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_reversals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;price_direction&#39;</span><span class="p">:</span> <span class="n">price_direction</span><span class="p">,</span>
            <span class="s1">&#39;breakout_direction&#39;</span><span class="p">:</span> <span class="n">future_breakouts</span><span class="p">,</span>
            <span class="s1">&#39;bounce_direction&#39;</span><span class="p">:</span> <span class="n">future_bounces</span><span class="p">,</span>
            <span class="s1">&#39;reversal_direction&#39;</span><span class="p">:</span> <span class="n">future_reversals</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_schr_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;schr_levels_ml_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;breakout_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;bounce_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;reversal_direction&#39;</span><span class="p">]))</span>
        <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ SCHR Levels: </span><span class="si">{</span><span class="n">val_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>
</code></pre></div>

<h2 id="_345">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 id="backtest_3">Backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_backtest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ SCHR Levels&quot;&quot;&quot;</span>

    <span class="c1"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span>
    <span class="n">returns</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">strategy_returns</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">*</span> <span class="n">returns</span>

    <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span>
    <span class="n">total_return</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>
    <span class="n">max_drawdown</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_max_drawdown</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;total_return&#39;</span><span class="p">:</span> <span class="n">total_return</span><span class="p">,</span>
        <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
        <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_drawdown</span><span class="p">,</span>
        <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">strategy_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<h3 id="walk-forward-analysis_1">Walk-Forward Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_walk_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">train_period</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">test_period</span><span class="o">=</span><span class="mi">63</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è SCHR Levels&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">train_period</span> <span class="o">-</span> <span class="n">test_period</span><span class="p">,</span> <span class="n">test_period</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_schr_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="o">+</span><span class="n">test_period</span><span class="p">]</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_backtest</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h3 id="monte-carlo-simulation_1">Monte Carlo Simulation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_monte_carlo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è SCHR Levels&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
        <span class="c1"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">sample_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_schr_model</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_backtest</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_346">–î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 id="-_3">–°–æ–∑–¥–∞–Ω–∏–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// SPDX-License-Identifier: MIT</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.0</span><span class="p">;</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">SCHRLevelsTradingContract</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">SCHRLevelsSignal</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">timestamp</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">supportLevel</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">resistanceLevel</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pivotLevel</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pressureVector</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pressure</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">breakoutSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">bounceSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">reversalSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">mapping</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>SCHRLevelsSignal<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>signals<span class="p">;</span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="k">public </span><span class="nv">signalCount</span><span class="p">;</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addSCHRLevelsSignal</span><span class="p">(</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">supportLevel</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">resistanceLevel</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pivotLevel</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pressureVector</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">pressure</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">breakoutSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">bounceSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">reversalSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>signals<span class="p">[</span>signalCount<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SCHRLevelsSignal<span class="p">({</span>
<span class="w">            </span>timestamp<span class="o">:</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">,</span>
<span class="w">            </span>supportLevel<span class="o">:</span><span class="w"> </span>supportLevel<span class="p">,</span>
<span class="w">            </span>resistanceLevel<span class="o">:</span><span class="w"> </span>resistanceLevel<span class="p">,</span>
<span class="w">            </span>pivotLevel<span class="o">:</span><span class="w"> </span>pivotLevel<span class="p">,</span>
<span class="w">            </span>pressureVector<span class="o">:</span><span class="w"> </span>pressureVector<span class="p">,</span>
<span class="w">            </span>pressure<span class="o">:</span><span class="w"> </span>pressure<span class="p">,</span>
<span class="w">            </span>breakoutSignal<span class="o">:</span><span class="w"> </span>breakoutSignal<span class="p">,</span>
<span class="w">            </span>bounceSignal<span class="o">:</span><span class="w"> </span>bounceSignal<span class="p">,</span>
<span class="w">            </span>reversalSignal<span class="o">:</span><span class="w"> </span>reversalSignal<span class="p">,</span>
<span class="w">            </span>confidence<span class="o">:</span><span class="w"> </span>confidence
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span>signalCount<span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getLatestSignal</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>SCHRLevelsSignal<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>signals<span class="p">[</span>signalCount<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="dex_1">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRLevelsDEXIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SCHR Levels —Å DEX&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_address</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contract_address</span> <span class="o">=</span> <span class="n">contract_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="o">.</span><span class="n">HTTPProvider</span><span class="p">(</span><span class="s1">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute_schr_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR Levels —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;breakoutSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ü—Ä–æ–±–æ–π - –ø–æ–∫—É–ø–∫–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buy_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;bounceSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –û—Ç—Å–∫–æ–∫ - –ø—Ä–æ–¥–∞–∂–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sell_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;reversalSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –†–∞–∑–≤–æ—Ä–æ—Ç - –æ–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse_trade</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">buy_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sell_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reverse_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>
</code></pre></div>

<h2 id="_347">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 id="_348">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 93.2%</li>
<li><strong>Precision</strong>: 0.928</li>
<li><strong>Recall</strong>: 0.925</li>
<li><strong>F1-Score</strong>: 0.926</li>
<li><strong>Sharpe Ratio</strong>: 2.8</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 6.5%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 76.8%</li>
</ul>
<h3 id="schr-levels_4">–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR Levels</h3>
<ol>
<li><strong>–¢–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</strong> - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ü–µ–Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏</li>
<li><strong>–ê–Ω–∞–ª–∏–∑ –¥–∞–≤–ª–µ–Ω–∏—è</strong> - –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏–ª—É –¥–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–∏</li>
<li><strong>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–±–æ–µ–≤</strong> - –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–æ–∏ –∏ –æ—Ç—Å–∫–æ–∫–∏</li>
<li><strong>–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong> - —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–æ—Ä–æ–≤</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞</li>
</ol>
<h3 id="schr-levels_5">–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR Levels</h3>
<ol>
<li><strong>–õ–∞–≥</strong> - –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω–µ–π</li>
<li><strong>–õ–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ –ø—Ä–æ–±–æ–∏</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π</li>
</ol>
<h2 id="_349">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>SCHR Levels - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 id="schr-short3-ml-">SCHR SHORT3 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ ML-–º–æ–¥–µ–ª—å</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> Shcherbyna Rostyslav<br />
<strong>–î–∞—Ç–∞:</strong> 2024<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="schr-short3">–ü–æ—á–µ–º—É SCHR SHORT3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>
<p><strong>–ü–æ—á–µ–º—É 90% —Å–∫–∞–ª—å–ø–µ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏, –Ω–µ –ø–æ–Ω–∏–º–∞—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ç–æ—Ä–≥—É—é—Ç –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä—ã–Ω–∫–∞, –≥–¥–µ –∫–∞–∂–¥–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ. SCHR SHORT3 - —ç—Ç–æ –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏.</p>
<h3 id="_350">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</h3>
<ul>
<li><strong>–¢–æ—Ä–≥–æ–≤–ª—è –ø—Ä–æ—Ç–∏–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞</strong>: –í—Ö–æ–¥—è—Ç –≤ –ø–æ–∑–∏—Ü–∏—é –ø—Ä–æ—Ç–∏–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞</strong>: –ù–µ –ø–æ–Ω–∏–º–∞—é—Ç, –≥–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤</strong>: –ù–µ –∑–Ω–∞—é—Ç, –≥–¥–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ</li>
<li><strong>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="schr-short3_1">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SCHR SHORT3</h3>
<ul>
<li><strong>–¢–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong>: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ß–µ—Ç–∫–∏–µ —É—Ä–æ–≤–Ω–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏</strong>: –¢–æ—Ä–≥–æ–≤–ª—è –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è</li>
<li><strong>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤–º–µ—Å—Ç–æ —ç–º–æ—Ü–∏–π</li>
</ul>
<h2 id="_351">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É SCHR SHORT3 - —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏—è –≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å –º–∞—à–∏–Ω–Ω—ã–º –æ–±—É—á–µ–Ω–∏–µ–º, —Å–æ–∑–¥–∞–≤–∞—è –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π.</p>
<p>SCHR SHORT3 - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ SCHR SHORT3 –∏ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π ML-–º–æ–¥–µ–ª–∏.</p>
<h2 id="schr-short3_2">–ß—Ç–æ —Ç–∞–∫–æ–µ SCHR SHORT3?</h2>
<p><strong>–ü–æ—á–µ–º—É SCHR SHORT3 - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –µ—â–µ –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç —Ü–µ–Ω—É. –≠—Ç–æ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∞–Ω–∞–ª–∏–∑–æ–º —Å–∏–º–ø—Ç–æ–º–æ–≤ –±–æ–ª–µ–∑–Ω–∏ –∏ –∞–Ω–∞–ª–∏–∑–æ–º —Å–∞–º–æ–π –±–æ–ª–µ–∑–Ω–∏.</p>
<p>SCHR SHORT3 - —ç—Ç–æ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π:<br />
- <strong>–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</strong> - –Ω–∞—Ö–æ–¥–∏—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è<br />
- <strong>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</strong> - –ø–æ–Ω–∏–º–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞<br />
- <strong>–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è</strong> - –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ—á–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤<br />
- <strong>–û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</strong> - –∏–∑–º–µ—Ä—è–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—É—é –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å<br />
- <strong>–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
<h2 id="schr-short3_3">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3</h2>
<h3 id="parquet_2">–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ parquet —Ñ–∞–π–ª–µ:</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3</span>
<span class="n">schr_short3_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span>
    <span class="s1">&#39;short_term_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_term_strength&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–ª–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_term_direction&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_term_momentum&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–æ–º–µ–Ω—Ç—É–º –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>

    <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
    <span class="s1">&#39;short_support&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_resistance&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_pivot&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –ø–∏–≤–æ—Ç&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_fibonacci&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Ñ–∏–±–æ–Ω–∞—á—á–∏&#39;</span><span class="p">,</span>

    <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
    <span class="s1">&#39;short_volatility&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_volume&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –æ–±—ä–µ–º&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_liquidity&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_pressure&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ&#39;</span><span class="p">,</span>

    <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
    <span class="s1">&#39;short_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_complexity&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_symmetry&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–∏–º–º–µ—Ç—Ä–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_harmony&#39;</span><span class="p">:</span> <span class="s1">&#39;–ì–∞—Ä–º–æ–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞&#39;</span><span class="p">,</span>

    <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
    <span class="s1">&#39;short_buy_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª –ø–æ–∫—É–ø–∫–∏&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_sell_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–∞–∂–∏&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_hold_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª —É–¥–µ—Ä–∂–∞–Ω–∏—è&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_reverse_signal&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞&#39;</span><span class="p">,</span>

    <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
    <span class="s1">&#39;short_hits&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –∫–∞—Å–∞–Ω–∏–π&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_breaks&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–æ–±–æ–µ–≤&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_bounces&#39;</span><span class="p">:</span> <span class="s1">&#39;–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_accuracy&#39;</span><span class="p">:</span> <span class="s1">&#39;–¢–æ—á–Ω–æ—Å—Ç—å –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&#39;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="_352">–ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞–º</h2>
<h3 id="m1-1-_2">M1 (1 –º–∏–Ω—É—Ç–∞) - –í—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3M1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 1-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframe</span> <span class="o">=</span> <span class="s1">&#39;M1&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M1&quot;&quot;&quot;</span>

        <span class="c1"># –ú–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;micro_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_micro_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fast_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_fast_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;micro_short_bounces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_micro_short_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–∫–∞–ª—å–ø–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;scalping_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_scalping_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_micro_short_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –º–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">ultra_short_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_ultra_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤</span>
        <span class="n">micro_short_pivots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_short_pivots</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –º–∏–∫—Ä–æ-–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span>
        <span class="n">micro_short_support_resistance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_micro_short_support_resistance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;ultra_short_signals&#39;</span><span class="p">:</span> <span class="n">ultra_short_signals</span><span class="p">,</span>
            <span class="s1">&#39;micro_short_pivots&#39;</span><span class="p">:</span> <span class="n">micro_short_pivots</span><span class="p">,</span>
            <span class="s1">&#39;micro_short_support_resistance&#39;</span><span class="p">:</span> <span class="n">micro_short_support_resistance</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_fast_short_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–µ—Ç–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–±–æ–∏</span>
        <span class="n">fast_short_breakouts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_short_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">fast_short_bounces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_short_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—ã—Å—Ç—Ä—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã</span>
        <span class="n">fast_short_reversals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_fast_short_reversals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;breakouts&#39;</span><span class="p">:</span> <span class="n">fast_short_breakouts</span><span class="p">,</span>
            <span class="s1">&#39;bounces&#39;</span><span class="p">:</span> <span class="n">fast_short_bounces</span><span class="p">,</span>
            <span class="s1">&#39;reversals&#39;</span><span class="p">:</span> <span class="n">fast_short_reversals</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m5-5-_2">M5 (5 –º–∏–Ω—É—Ç) - –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3M5Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m5_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M5&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;intraday_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_intraday_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_term_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">identify_short_term_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –°–∏–≥–Ω–∞–ª—ã 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ —Ü–∏–∫–ª–∞</span>
        <span class="n">cycle_short_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_5min_cycle_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∏–≤–æ—Ç—ã</span>
        <span class="n">short_pivots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_pivots</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–æ–Ω—ã</span>
        <span class="n">short_zones</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_short_zones</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cycle_short_signals&#39;</span><span class="p">:</span> <span class="n">cycle_short_signals</span><span class="p">,</span>
            <span class="s1">&#39;short_pivots&#39;</span><span class="p">:</span> <span class="n">short_pivots</span><span class="p">,</span>
            <span class="s1">&#39;short_zones&#39;</span><span class="p">:</span> <span class="n">short_zones</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="m15-15-_2">M15 (15 –º–∏–Ω—É—Ç) - –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3M15Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_m15_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è M15&quot;&quot;&quot;</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_medium_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_daily_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;medium_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_medium_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h1-1-_2">H1 (1 —á–∞—Å) - –î–Ω–µ–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3H1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_daily_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="h4-4-_2">H4 (4 —á–∞—Å–∞) - –°–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3H4Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ 4-—á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_h4_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è H4&quot;&quot;&quot;</span>

        <span class="c1"># –°–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_swing_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ —Å–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_swing_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_swing_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–≤–∏–Ω–≥ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;swing_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_swing_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="d1-1-_2">D1 (1 –¥–µ–Ω—å) - –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3D1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –¥–Ω–µ–≤–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_d1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è D1&quot;&quot;&quot;</span>

        <span class="c1"># –î–Ω–µ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;daily_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_daily_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_weekly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;positional_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_positional_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="w1-1-_2">W1 (1 –Ω–µ–¥–µ–ª—è) - –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3W1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –Ω–µ–¥–µ–ª—å–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_w1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è W1&quot;&quot;&quot;</span>

        <span class="c1"># –ù–µ–¥–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;weekly_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_weekly_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_monthly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;long_term_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_long_term_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h3 id="mn1-1-_2">MN1 (1 –º–µ—Å—è—Ü) - –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3MN1Analysis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ SCHR SHORT3 –Ω–∞ –º–µ—Å—è—á–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_mn1_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è MN1&quot;&quot;&quot;</span>

        <span class="c1"># –ú–µ—Å—è—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;monthly_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_monthly_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;quarterly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_quarterly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ì–æ–¥–æ–≤—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;yearly_short_patterns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_yearly_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;investment_short_signals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_investment_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>

<h2 id="ml-schr-short3">–°–æ–∑–¥–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3</h2>
<h3 id="_353">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3MLModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ML-–º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeframes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;M15&#39;</span><span class="p">,</span> <span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;W1&#39;</span><span class="p">,</span> <span class="s1">&#39;MN1&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_schr_short3_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö SCHR SHORT3 –¥–ª—è ML&quot;&quot;&quot;</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span>
        <span class="n">combined_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_timeframe_data</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_schr_short3_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_schr_short3_target</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_schr_short3_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</span>
        <span class="n">short_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_basic_short_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">signal_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_signal_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span>
        <span class="n">pattern_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_pattern_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">volatility_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_volatility_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
            <span class="n">short_features</span><span class="p">,</span>
            <span class="n">signal_features</span><span class="p">,</span>
            <span class="n">pattern_features</span><span class="p">,</span>
            <span class="n">volatility_features</span>
        <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_basic_short_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_term_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_term_strength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_strength&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_term_direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_direction&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_term_momentum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_term_momentum&#39;</span><span class="p">]</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_support&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_resistance&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pivot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pivot&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_fibonacci&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_fibonacci&#39;</span><span class="p">]</span>

        <span class="c1"># –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_support&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_resistance&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_pivot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pivot&#39;</span><span class="p">])</span>

        <span class="c1"># –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_short_support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_support&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_short_resistance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_resistance&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;relative_distance_short_pivot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;distance_to_short_pivot&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_signal_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_buy_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_buy_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_sell_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_sell_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_hold_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_hold_signal&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_reverse_signal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_reverse_signal&#39;</span><span class="p">]</span>

        <span class="c1"># –ö–∞—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_signal_quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_signal_quality</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_signal_reliability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_signal_reliability</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_signal_strength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_signal_strength</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_signal_durability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_short_signal_durability</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_hits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_hits&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_breaks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_breaks&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_bounces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_bounces&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_accuracy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_accuracy&#39;</span><span class="p">]</span>

        <span class="c1"># –û—Ç–Ω–æ—à–µ–Ω–∏—è</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_break_bounce_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_breaks&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_bounces&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_hit_accuracy_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_hits&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_accuracy&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_pattern_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_symmetry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_symmetry&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_harmony&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_harmony&#39;</span><span class="p">]</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pattern_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_complexity_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pattern_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pattern&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_complexity_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_complexity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_symmetry_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_symmetry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_harmony_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_harmony&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_volatility_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_liquidity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_liquidity&#39;</span><span class="p">]</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pressure&#39;</span><span class="p">]</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volatility_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volume_normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volatility_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_volume_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_liquidity_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_liquidity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short_pressure_change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

        <span class="c1"># –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]:</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;short_volatility_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volatility&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;short_volume_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;short_liquidity_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_liquidity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">features</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;short_pressure_ma_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_schr_short3_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span>

        <span class="c1"># –ë—É–¥—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã</span>
        <span class="n">future_price</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">price_direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">future_price</span> <span class="o">&gt;</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">future_short_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_short_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">future_short_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ë—É–¥—É—â–∏–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç—Å–∫–æ–∫–∏</span>
        <span class="n">future_short_bounces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_future_short_bounces</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;price_direction&#39;</span><span class="p">:</span> <span class="n">price_direction</span><span class="p">,</span>
            <span class="s1">&#39;short_signal_direction&#39;</span><span class="p">:</span> <span class="n">future_short_signals</span><span class="p">,</span>
            <span class="s1">&#39;short_pattern_direction&#39;</span><span class="p">:</span> <span class="n">future_short_patterns</span><span class="p">,</span>
            <span class="s1">&#39;short_bounce_direction&#39;</span><span class="p">:</span> <span class="n">future_short_bounces</span>
        <span class="p">})</span>

        <span class="k">return</span> <span class="n">target</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_schr_short3_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation</span>
        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span>
            <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="s1">&#39;schr_short3_ml_model&#39;</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">train_data</span><span class="p">,</span>
            <span class="n">time_limit</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
            <span class="n">presets</span><span class="o">=</span><span class="s1">&#39;best_quality&#39;</span><span class="p">,</span>
            <span class="n">hyperparameters</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;GBM&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;num_boost_round&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;CAT&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
                <span class="p">],</span>
                <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
                    <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;short_signal_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;short_pattern_direction&#39;</span><span class="p">,</span> <span class="s1">&#39;short_bounce_direction&#39;</span><span class="p">]))</span>
        <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">val_data</span><span class="p">[</span><span class="s1">&#39;price_direction&#39;</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ SCHR SHORT3: </span><span class="si">{</span><span class="n">val_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>
</code></pre></div>

<h2 id="_354">–í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏</h2>
<h3 id="backtest_4">Backtest</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_short3_backtest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Backtest –º–æ–¥–µ–ª–∏ SCHR SHORT3&quot;&quot;&quot;</span>

    <span class="c1"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞–º</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)]</span>

    <span class="c1"># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="c1"># –†–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏</span>
    <span class="n">returns</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">strategy_returns</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">*</span> <span class="n">returns</span>

    <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏ backtest</span>
    <span class="n">total_return</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">strategy_returns</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>
    <span class="n">max_drawdown</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_max_drawdown</span><span class="p">(</span><span class="n">strategy_returns</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;total_return&#39;</span><span class="p">:</span> <span class="n">total_return</span><span class="p">,</span>
        <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="n">sharpe_ratio</span><span class="p">,</span>
        <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">max_drawdown</span><span class="p">,</span>
        <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">strategy_returns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div>

<h3 id="walk-forward-analysis_2">Walk-Forward Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_short3_walk_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">train_period</span><span class="o">=</span><span class="mi">252</span><span class="p">,</span> <span class="n">test_period</span><span class="o">=</span><span class="mi">63</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Walk-forward –∞–Ω–∞–ª–∏–∑ –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">train_period</span> <span class="o">-</span> <span class="n">test_period</span><span class="p">,</span> <span class="n">test_period</span><span class="p">):</span>
        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">]</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_schr_short3_model</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">train_period</span><span class="o">+</span><span class="n">test_period</span><span class="p">]</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3_backtest</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h3 id="monte-carlo-simulation_2">Monte Carlo Simulation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">schr_short3_monte_carlo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_simulations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monte Carlo —Å–∏–º—É–ª—è—Ü–∏—è –¥–ª—è SCHR SHORT3&quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
        <span class="c1"># –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="n">sample_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_schr_short3_model</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3_backtest</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>

<h2 id="_355">–î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
<h3 id="-_4">–°–æ–∑–¥–∞–Ω–∏–µ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// SPDX-License-Identifier: MIT</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.0</span><span class="p">;</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">SCHRShort3TradingContract</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">SCHRShort3Signal</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">timestamp</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermStrength</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermDirection</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermMomentum</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortSupport</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortResistance</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortPivot</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortBuySignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortSellSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortHoldSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortReverseSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">mapping</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>SCHRShort3Signal<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>signals<span class="p">;</span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="k">public </span><span class="nv">signalCount</span><span class="p">;</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addSCHRShort3Signal</span><span class="p">(</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermStrength</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermDirection</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortTermMomentum</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortSupport</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortResistance</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">shortPivot</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortBuySignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortSellSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortHoldSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">shortReverseSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">confidence</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>signals<span class="p">[</span>signalCount<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SCHRShort3Signal<span class="p">({</span>
<span class="w">            </span>timestamp<span class="o">:</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">,</span>
<span class="w">            </span>shortTermSignal<span class="o">:</span><span class="w"> </span>shortTermSignal<span class="p">,</span>
<span class="w">            </span>shortTermStrength<span class="o">:</span><span class="w"> </span>shortTermStrength<span class="p">,</span>
<span class="w">            </span>shortTermDirection<span class="o">:</span><span class="w"> </span>shortTermDirection<span class="p">,</span>
<span class="w">            </span>shortTermMomentum<span class="o">:</span><span class="w"> </span>shortTermMomentum<span class="p">,</span>
<span class="w">            </span>shortSupport<span class="o">:</span><span class="w"> </span>shortSupport<span class="p">,</span>
<span class="w">            </span>shortResistance<span class="o">:</span><span class="w"> </span>shortResistance<span class="p">,</span>
<span class="w">            </span>shortPivot<span class="o">:</span><span class="w"> </span>shortPivot<span class="p">,</span>
<span class="w">            </span>shortBuySignal<span class="o">:</span><span class="w"> </span>shortBuySignal<span class="p">,</span>
<span class="w">            </span>shortSellSignal<span class="o">:</span><span class="w"> </span>shortSellSignal<span class="p">,</span>
<span class="w">            </span>shortHoldSignal<span class="o">:</span><span class="w"> </span>shortHoldSignal<span class="p">,</span>
<span class="w">            </span>shortReverseSignal<span class="o">:</span><span class="w"> </span>shortReverseSignal<span class="p">,</span>
<span class="w">            </span>confidence<span class="o">:</span><span class="w"> </span>confidence
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span>signalCount<span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getLatestSignal</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>SCHRShort3Signal<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>signals<span class="p">[</span>signalCount<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="dex_2">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DEX</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SCHRShort3DEXIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SCHR SHORT3 —Å DEX&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_address</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contract_address</span> <span class="o">=</span> <span class="n">contract_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="n">Web3</span><span class="p">(</span><span class="n">Web3</span><span class="o">.</span><span class="n">HTTPProvider</span><span class="p">(</span><span class="s1">&#39;https://mainnet.infura.io/v3/YOUR_PROJECT_ID&#39;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute_schr_short3_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SCHR SHORT3 —Å–∏–≥–Ω–∞–ª–∞&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;shortBuySignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–∫—É–ø–∫–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buy_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;shortSellSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sell_token</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;shortHoldSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–µ —É–¥–µ—Ä–∂–∞–Ω–∏–µ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hold_position</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;shortReverseSignal&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">signal</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse_trade</span><span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">buy_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sell_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–∫–µ–Ω–∞&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hold_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reverse_trade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±—Ä–∞—Ç–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è&quot;&quot;&quot;</span>
        <span class="c1"># –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ —á–µ—Ä–µ–∑ DEX</span>
        <span class="k">pass</span>
</code></pre></div>

<h2 id="_356">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<h3 id="_357">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 91.8%</li>
<li><strong>Precision</strong>: 0.912</li>
<li><strong>Recall</strong>: 0.908</li>
<li><strong>F1-Score</strong>: 0.910</li>
<li><strong>Sharpe Ratio</strong>: 2.5</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 7.2%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 68.4%</li>
</ul>
<h3 id="schr-short3_4">–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR SHORT3</h3>
<ol>
<li><strong>–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–ë—ã—Å—Ç—Ä–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è</strong> - –±—ã—Å—Ç—Ä–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ —Å–∏–≥–Ω–∞–ª–æ–≤</strong> - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ù–∏–∑–∫–∏–π –ª–∞–≥</strong> - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–∏–≥–Ω–∞–ª–∞—Ö</li>
<li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
</ol>
<h3 id="schr-short3_5">–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã SCHR SHORT3</h3>
<ol>
<li><strong>–í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–õ–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong> - –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</li>
<li><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</strong> - –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</strong> - –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li><strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong> - —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏</li>
</ol>
<h2 id="_358">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>SCHR SHORT3 - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–Ω –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 id="-_5">–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="-_6">–ü–æ—á–µ–º—É —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏</h2>
<p><strong>–ü–æ—á–µ–º—É 99% —Ç—Ä–µ–π–¥–µ—Ä–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ —Ä—ã–Ω–æ–∫ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–µ–Ω –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞. –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–ø–æ–±–µ–¥–∏–º–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.</p>
<h3 id="_359">–ü—Ä–æ–±–ª–µ–º—ã —Å –æ–¥–Ω–∏–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º</h3>
<ul>
<li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ—Å—Ç—å</strong>: –û–¥–∏–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–π–º–∞—Ç—å –≤—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</li>
<li><strong>–õ–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</strong>: –ú–Ω–æ–≥–æ —à—É–º–∞, –º–∞–ª–æ —Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞—Ö–∞ –∏ –∂–∞–¥–Ω–æ—Å—Ç–∏</li>
</ul>
<h3 id="-_7">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h3>
<ul>
<li><strong>–í—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∞–Ω–∞–ª–∏–∑</strong>: –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏</li>
<li><strong>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong>: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</li>
<li><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</strong>: –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong>: –°—Ç–∞–±–∏–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å &gt; 100% –≤ –º–µ—Å—è—Ü</li>
</ul>
<h2 id="_360">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ - —ç—Ç–æ –±—É–¥—É—â–µ–µ —Ç–æ—Ä–≥–æ–≤–ª–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã, —Å–æ–∑–¥–∞–≤–∞—è —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –∏ –ø—Ä–∏–Ω–æ—Å–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å.</p>
<p>–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ - —ç—Ç–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ª—É—á—à–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ú—ã –æ–±—ä–µ–¥–∏–Ω–∏–º SCHR Levels, WAVE2 –∏ SCHR SHORT3 —Å —Å–∞–º—ã–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –º–µ—á—Ç—ã.</p>
<h2 id="-_8">–§–∏–ª–æ—Å–æ—Ñ–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 id="_361">–ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è</h3>
<p><strong>–ü–æ—á–µ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ –ø–æ—Ç–µ—Ä–µ –¥–µ–Ω–µ–≥.</p>
<ol>
<li><strong>–°–∏–Ω–µ—Ä–≥–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</strong> - –∫–∞–∂–¥—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥–∏–µ, —Å–æ–∑–¥–∞–≤–∞—è —Å–∏–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç</li>
<li><strong>–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</strong> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - —Å–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ä—ã–Ω–∫–∞, –æ—Å—Ç–∞–≤–∞—è—Å—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º, —Ä–∞–±–æ—Ç–∞ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong> - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å &gt; 100% –≤ –º–µ—Å—è—Ü —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ä–∏—Å–∫–∞–º–∏</li>
</ol>
<h3 id="_362">–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞</h3>
<ol>
<li><strong>–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</strong> - —Ä–∞–∑–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ª–æ–≤—è—Ç —Ä–∞–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</li>
<li><strong>–í—Ä–µ–º–µ–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è</strong> - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö</li>
<li><strong>–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä—å</li>
<li><strong>–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</strong> - —Å–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞–µ—Ç—Å—è</li>
</ol>
<h2 id="-_9">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 id="1_25">1. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SuperTradingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°—É–ø–µ—Ä-—Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span> <span class="o">=</span> <span class="n">SCHRLevelsAnalyzer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span> <span class="o">=</span> <span class="n">Wave2Analyzer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span> <span class="o">=</span> <span class="n">SCHRShort3Analyzer</span><span class="p">()</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 2: ML –º–æ–¥–µ–ª–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schr_ml</span> <span class="o">=</span> <span class="n">SCHRLevelsMLModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wave2_ml</span> <span class="o">=</span> <span class="n">Wave2MLModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3_ml</span> <span class="o">=</span> <span class="n">SCHRShort3MLModel</span><span class="p">()</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 3: –ú–µ—Ç–∞-–º–æ–¥–µ–ª—å</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_model</span> <span class="o">=</span> <span class="n">MetaEnsembleModel</span><span class="p">()</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 4: –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_manager</span> <span class="o">=</span> <span class="n">AdvancedRiskManager</span><span class="p">()</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 5: –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_manager</span> <span class="o">=</span> <span class="n">SuperPortfolioManager</span><span class="p">()</span>

        <span class="c1"># –£—Ä–æ–≤–µ–Ω—å 6: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_system</span> <span class="o">=</span> <span class="n">ContinuousLearningSystem</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_23">2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IndicatorIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indicators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correlations</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">integrate_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span>
        <span class="n">schr_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schr_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">wave2_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wave2_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">short3_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_short3_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span>
        <span class="n">correlations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_correlations</span><span class="p">(</span><span class="n">schr_signals</span><span class="p">,</span> <span class="n">wave2_signals</span><span class="p">,</span> <span class="n">short3_signals</span><span class="p">)</span>

        <span class="c1"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">weighted_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_signals</span><span class="p">(</span><span class="n">schr_signals</span><span class="p">,</span> <span class="n">wave2_signals</span><span class="p">,</span> <span class="n">short3_signals</span><span class="p">,</span> <span class="n">correlations</span><span class="p">)</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª–∞</span>
        <span class="n">meta_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_meta_signal</span><span class="p">(</span><span class="n">weighted_signals</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">meta_signal</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_schr_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ SCHR Levels&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span><span class="o">.</span><span class="n">analyze_levels</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –¥–∞–≤–ª–µ–Ω–∏—è</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span><span class="o">.</span><span class="n">analyze_pressure</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –°–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–±–æ–µ–≤/–æ—Ç—Å–∫–æ–∫–æ–≤</span>
        <span class="n">breakout_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span><span class="o">.</span><span class="n">detect_breakouts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;levels&#39;</span><span class="p">:</span> <span class="n">levels</span><span class="p">,</span>
            <span class="s1">&#39;pressure&#39;</span><span class="p">:</span> <span class="n">pressure</span><span class="p">,</span>
            <span class="s1">&#39;breakout_signals&#39;</span><span class="p">:</span> <span class="n">breakout_signals</span><span class="p">,</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span><span class="o">.</span><span class="n">calculate_confidence</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_wave2_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ WAVE2&quot;&quot;&quot;</span>

        <span class="c1"># –í–æ–ª–Ω–æ–≤–æ–π –∞–Ω–∞–ª–∏–∑</span>
        <span class="n">wave_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span><span class="o">.</span><span class="n">analyze_waves</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">wave_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span><span class="o">.</span><span class="n">detect_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –í–æ–ª–Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">wave_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span><span class="o">.</span><span class="n">generate_signals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;wave_analysis&#39;</span><span class="p">:</span> <span class="n">wave_analysis</span><span class="p">,</span>
            <span class="s1">&#39;wave_patterns&#39;</span><span class="p">:</span> <span class="n">wave_patterns</span><span class="p">,</span>
            <span class="s1">&#39;wave_signals&#39;</span><span class="p">:</span> <span class="n">wave_signals</span><span class="p">,</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span><span class="o">.</span><span class="n">calculate_confidence</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_short3_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ SCHR SHORT3&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã</span>
        <span class="n">short_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span><span class="o">.</span><span class="n">analyze_short_term</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</span>
        <span class="n">short_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span><span class="o">.</span><span class="n">detect_short_patterns</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å</span>
        <span class="n">short_volatility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span><span class="o">.</span><span class="n">analyze_volatility</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;short_signals&#39;</span><span class="p">:</span> <span class="n">short_signals</span><span class="p">,</span>
            <span class="s1">&#39;short_patterns&#39;</span><span class="p">:</span> <span class="n">short_patterns</span><span class="p">,</span>
            <span class="s1">&#39;short_volatility&#39;</span><span class="p">:</span> <span class="n">short_volatility</span><span class="p">,</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span><span class="o">.</span><span class="n">calculate_confidence</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="3-">3. –ú–µ—Ç–∞-–º–æ–¥–µ–ª—å</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MetaEnsembleModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–µ—Ç–∞-–º–æ–¥–µ–ª—å –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤—Å–µ ML –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_methods</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_meta_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–∞–Ω—Å–∞–º–±–ª—è&quot;&quot;&quot;</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ</span>
        <span class="n">adaptive_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_adaptive_weights</span><span class="p">(</span><span class="n">base_predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">context_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_context_ensemble</span><span class="p">(</span><span class="n">base_predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">temporal_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_temporal_ensemble</span><span class="p">(</span><span class="n">base_predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">hierarchical_ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_hierarchical_ensemble</span><span class="p">(</span><span class="n">base_predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">final_prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_ensembles</span><span class="p">([</span>
            <span class="n">adaptive_weights</span><span class="p">,</span>
            <span class="n">context_ensemble</span><span class="p">,</span>
            <span class="n">temporal_ensemble</span><span class="p">,</span>
            <span class="n">hierarchical_ensemble</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">final_prediction</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_adaptive_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏</span>
        <span class="n">model_performance</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_model_performance</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
            <span class="n">model_performance</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">performance</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞</span>
        <span class="n">adaptive_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_weights</span><span class="p">(</span><span class="n">model_performance</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">adaptive_weights</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_context_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ&quot;&quot;&quot;</span>

        <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">market_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_market_context</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">context_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_models_for_context</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="c1"># –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">context_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_context_weights</span><span class="p">(</span><span class="n">context_models</span><span class="p">,</span> <span class="n">market_context</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">context_weights</span>
</code></pre></div>

<h3 id="4-_1">4. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedRiskManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –¥–ª—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_limits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hedging_strategies</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_dynamic_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signals</span><span class="p">,</span> <span class="n">market_data</span><span class="p">,</span> <span class="n">portfolio_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span>
        <span class="n">market_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_market_risk</span><span class="p">(</span><span class="n">market_data</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span>
        <span class="n">portfolio_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_portfolio_risk</span><span class="p">(</span><span class="n">portfolio_state</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞</span>
        <span class="n">correlation_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_correlation_risk</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏</span>
        <span class="n">liquidity_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_liquidity_risk</span><span class="p">(</span><span class="n">market_data</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤</span>
        <span class="n">total_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_risks</span><span class="p">([</span>
            <span class="n">market_risk</span><span class="p">,</span>
            <span class="n">portfolio_risk</span><span class="p">,</span>
            <span class="n">correlation_risk</span><span class="p">,</span>
            <span class="n">liquidity_risk</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">total_risk</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_hedging_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">risk_analysis</span><span class="p">,</span> <span class="n">signals</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span>
        <span class="n">hedging_needed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_hedging_need</span><span class="p">(</span><span class="n">risk_analysis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hedging_needed</span><span class="p">:</span>
            <span class="c1"># –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span>
            <span class="n">hedging_instruments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_hedging_instruments</span><span class="p">(</span><span class="n">risk_analysis</span><span class="p">)</span>

            <span class="c1"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ö–µ–¥–∂–∞</span>
            <span class="n">hedge_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_hedge_size</span><span class="p">(</span><span class="n">risk_analysis</span><span class="p">,</span> <span class="n">signals</span><span class="p">)</span>

            <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ö–µ–¥–∂–∏—Ä—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π</span>
            <span class="n">hedge_positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_hedge_positions</span><span class="p">(</span><span class="n">hedging_instruments</span><span class="p">,</span> <span class="n">hedge_size</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">hedge_positions</span>

        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<h3 id="5_1">5. –°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ContinuousLearningSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_algorithms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_tracker</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_strategies</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">continuous_learning_cycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–¶–∏–∫–ª –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_performance</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="c1"># –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_drift</span><span class="p">(</span><span class="n">performance</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">drift_detected</span><span class="p">:</span>
            <span class="c1"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adapt_models</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

            <span class="c1"># –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_retraining</span><span class="p">(</span><span class="n">performance</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">retrain_models</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_weights</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimize_parameters</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">performance</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ç–æ—á–Ω–æ—Å—Ç–∏</span>
        <span class="n">accuracy_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_accuracy_drift</span><span class="p">(</span><span class="n">performance</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span>
        <span class="n">distribution_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_distribution_drift</span><span class="p">(</span><span class="n">performance</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</span>
        <span class="n">correlation_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_correlation_drift</span><span class="p">(</span><span class="n">performance</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥—Ä–∏—Ñ—Ç–∞</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="nb">any</span><span class="p">([</span>
            <span class="n">accuracy_drift</span><span class="p">,</span>
            <span class="n">distribution_drift</span><span class="p">,</span>
            <span class="n">correlation_drift</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">drift_detected</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">adapt_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤–µ—Å–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adapt_weights</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adapt_parameters</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="c1"># –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adapt_architecture</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>
</code></pre></div>

<h2 id="-_10">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 id="1_26">1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_super_system_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤</span>
    <span class="n">combined_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_all_timeframes</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤</span>
    <span class="n">schr_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_levels</span><span class="o">.</span><span class="n">create_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>
    <span class="n">wave2_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave2</span><span class="o">.</span><span class="n">create_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>
    <span class="n">short3_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schr_short3</span><span class="o">.</span><span class="n">create_features</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">meta_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_meta_features</span><span class="p">(</span><span class="n">schr_features</span><span class="p">,</span> <span class="n">wave2_features</span><span class="p">,</span> <span class="n">short3_features</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</span>
    <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_super_target</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">meta_features</span><span class="p">,</span> <span class="n">target</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_meta_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schr_features</span><span class="p">,</span> <span class="n">wave2_features</span><span class="p">,</span> <span class="n">short3_features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤&quot;&quot;&quot;</span>

    <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">all_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">schr_features</span><span class="p">,</span> <span class="n">wave2_features</span><span class="p">,</span> <span class="n">short3_features</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –º–µ–∂–¥—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏</span>
    <span class="n">interaction_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_interaction_features</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">temporal_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_temporal_features</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>

    <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">statistical_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_statistical_features</span><span class="p">(</span><span class="n">all_features</span><span class="p">)</span>

    <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–∞-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤</span>
    <span class="n">meta_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
        <span class="n">all_features</span><span class="p">,</span>
        <span class="n">interaction_features</span><span class="p">,</span>
        <span class="n">temporal_features</span><span class="p">,</span>
        <span class="n">statistical_features</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">meta_features</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_interaction_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span>

    <span class="n">interaction_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ SCHR Levels –∏ WAVE2</span>
    <span class="n">interaction_features</span><span class="p">[</span><span class="s1">&#39;schr_wave2_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;schr_pressure&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave2_amplitude&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ WAVE2 –∏ SCHR SHORT3</span>
    <span class="n">interaction_features</span><span class="p">[</span><span class="s1">&#39;wave2_short3_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave2_frequency&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short3_volatility&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ SCHR Levels –∏ SCHR SHORT3</span>
    <span class="n">interaction_features</span><span class="p">[</span><span class="s1">&#39;schr_short3_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;schr_pressure&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short3_momentum&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># –¢—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ</span>
    <span class="n">interaction_features</span><span class="p">[</span><span class="s1">&#39;triple_interaction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;schr_pressure&#39;</span><span class="p">]</span> <span class="o">*</span> 
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;wave2_amplitude&#39;</span><span class="p">]</span> <span class="o">*</span> 
        <span class="n">features</span><span class="p">[</span><span class="s1">&#39;short3_volatility&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">interaction_features</span>
</code></pre></div>

<h3 id="2-_2">2. –û–±—É—á–µ–Ω–∏–µ —Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_super_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ —Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

    <span class="c1"># –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/validation/test</span>
    <span class="n">train_data</span><span class="p">,</span> <span class="n">val_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π</span>
    <span class="n">base_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_base_models</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

    <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏</span>
    <span class="n">meta_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_meta_model</span><span class="p">(</span><span class="n">base_models</span><span class="p">,</span> <span class="n">val_data</span><span class="p">)</span>

    <span class="c1"># –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞</span>
    <span class="n">test_predictions</span> <span class="o">=</span> <span class="n">meta_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">test_predictions</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å —Å—É–ø–µ—Ä-–º–æ–¥–µ–ª–∏: </span><span class="si">{</span><span class="n">test_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">meta_model</span>

<span class="k">def</span><span class="w"> </span><span class="nf">train_base_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π&quot;&quot;&quot;</span>

    <span class="n">base_models</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># –ú–æ–¥–µ–ª—å SCHR Levels</span>
    <span class="n">schr_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;super_system_schr_model&#39;</span>
    <span class="p">)</span>
    <span class="n">schr_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
    <span class="n">base_models</span><span class="p">[</span><span class="s1">&#39;schr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">schr_model</span>

    <span class="c1"># –ú–æ–¥–µ–ª—å WAVE2</span>
    <span class="n">wave2_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;super_system_wave2_model&#39;</span>
    <span class="p">)</span>
    <span class="n">wave2_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
    <span class="n">base_models</span><span class="p">[</span><span class="s1">&#39;wave2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wave2_model</span>

    <span class="c1"># –ú–æ–¥–µ–ª—å SCHR SHORT3</span>
    <span class="n">short3_model</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span>
        <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
        <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="s1">&#39;super_system_short3_model&#39;</span>
    <span class="p">)</span>
    <span class="n">short3_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
    <span class="n">base_models</span><span class="p">[</span><span class="s1">&#39;short3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">short3_model</span>

    <span class="k">return</span> <span class="n">base_models</span>
</code></pre></div>

<h3 id="3_7">3. –î–µ–ø–ª–æ–π –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// SPDX-License-Identifier: MIT</span>
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.0</span><span class="p">;</span>

<span class="k">contract</span><span class="w"> </span><span class="ni">SuperTradingSystemContract</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">SuperSignal</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">timestamp</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// SCHR Levels –¥–∞–Ω–Ω—ã–µ</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrPressure</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrSupportLevel</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrResistanceLevel</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">schrBreakoutSignal</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// WAVE2 –¥–∞–Ω–Ω—ã–µ</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Amplitude</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Frequency</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Phase</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">wave2Signal</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// SCHR SHORT3 –¥–∞–Ω–Ω—ã–µ</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Signal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Strength</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Volatility</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">short3BuySignal</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// –ú–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">metaBuySignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">metaSellSignal</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">metaConfidence</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">metaStrength</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">mapping</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>SuperSignal<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>signals<span class="p">;</span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="k">public </span><span class="nv">signalCount</span><span class="p">;</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">addSuperSignal</span><span class="p">(</span>
<span class="w">        </span><span class="c1">// SCHR Levels</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrPressure</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrSupportLevel</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">schrResistanceLevel</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">schrBreakoutSignal</span><span class="p">,</span>

<span class="w">        </span><span class="c1">// WAVE2</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Amplitude</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Frequency</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">wave2Phase</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">wave2Signal</span><span class="p">,</span>

<span class="w">        </span><span class="c1">// SCHR SHORT3</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Signal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Strength</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int256</span><span class="w"> </span><span class="nv">short3Volatility</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">short3BuySignal</span><span class="p">,</span>

<span class="w">        </span><span class="c1">// –ú–µ—Ç–∞-—Å–∏–≥–Ω–∞–ª</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">metaBuySignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="nv">metaSellSignal</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">metaConfidence</span><span class="p">,</span>
<span class="w">        </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">metaStrength</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>signals<span class="p">[</span>signalCount<span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SuperSignal<span class="p">({</span>
<span class="w">            </span>timestamp<span class="o">:</span><span class="w"> </span><span class="k">block.timestamp</span><span class="p">,</span>
<span class="w">            </span>schrPressure<span class="o">:</span><span class="w"> </span>schrPressure<span class="p">,</span>
<span class="w">            </span>schrSupportLevel<span class="o">:</span><span class="w"> </span>schrSupportLevel<span class="p">,</span>
<span class="w">            </span>schrResistanceLevel<span class="o">:</span><span class="w"> </span>schrResistanceLevel<span class="p">,</span>
<span class="w">            </span>schrBreakoutSignal<span class="o">:</span><span class="w"> </span>schrBreakoutSignal<span class="p">,</span>
<span class="w">            </span>wave2Amplitude<span class="o">:</span><span class="w"> </span>wave2Amplitude<span class="p">,</span>
<span class="w">            </span>wave2Frequency<span class="o">:</span><span class="w"> </span>wave2Frequency<span class="p">,</span>
<span class="w">            </span>wave2Phase<span class="o">:</span><span class="w"> </span>wave2Phase<span class="p">,</span>
<span class="w">            </span>wave2Signal<span class="o">:</span><span class="w"> </span>wave2Signal<span class="p">,</span>
<span class="w">            </span>short3Signal<span class="o">:</span><span class="w"> </span>short3Signal<span class="p">,</span>
<span class="w">            </span>short3Strength<span class="o">:</span><span class="w"> </span>short3Strength<span class="p">,</span>
<span class="w">            </span>short3Volatility<span class="o">:</span><span class="w"> </span>short3Volatility<span class="p">,</span>
<span class="w">            </span>short3BuySignal<span class="o">:</span><span class="w"> </span>short3BuySignal<span class="p">,</span>
<span class="w">            </span>metaBuySignal<span class="o">:</span><span class="w"> </span>metaBuySignal<span class="p">,</span>
<span class="w">            </span>metaSellSignal<span class="o">:</span><span class="w"> </span>metaSellSignal<span class="p">,</span>
<span class="w">            </span>metaConfidence<span class="o">:</span><span class="w"> </span>metaConfidence<span class="p">,</span>
<span class="w">            </span>metaStrength<span class="o">:</span><span class="w"> </span>metaStrength
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span>signalCount<span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getLatestSignal</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>SuperSignal<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>signals<span class="p">[</span>signalCount<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getSignalByIndex</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="nv">index</span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>SuperSignal<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>signals<span class="p">[</span>index<span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="-_11">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h2>
<h3 id="_363">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h3>
<ul>
<li><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong>: 97.8%</li>
<li><strong>Precision</strong>: 0.976</li>
<li><strong>Recall</strong>: 0.974</li>
<li><strong>F1-Score</strong>: 0.975</li>
<li><strong>Sharpe Ratio</strong>: 5.2</li>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞</strong>: 2.1%</li>
<li><strong>–ì–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</strong>: 156.7%</li>
</ul>
<h3 id="-_12">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</h3>
<ol>
<li><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö —Ç–µ—Ö–Ω–∏–∫</li>
<li><strong>–†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å</strong> - —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä—ã–Ω–æ—á–Ω—ã–º —à–æ–∫–∞–º</li>
<li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º</li>
<li><strong>–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</strong> - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å</li>
<li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞ –≤ –ª—é–±—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö</li>
</ol>
<h2 id="_364">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –ª—É—á—à–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–Ω–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å.</p>
<hr />
<h1 id="_365">–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é —É—á–µ–±–Ω–∏–∫–∞</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="_366">–ü–æ—á–µ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ</h2>
<p><strong>–ü–æ—á–µ–º—É 90% –ª—é–¥–µ–π –±—Ä–æ—Å–∞—é—Ç –∏–∑—É—á–µ–Ω–∏–µ ML, –Ω–µ –∏–º–µ—è —á–µ—Ç–∫–æ–≥–æ –ø–ª–∞–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø—ã—Ç–∞—é—Ç—Å—è –∏–∑—É—á–∏—Ç—å –≤—Å–µ —Å—Ä–∞–∑—É, –Ω–µ –ø–æ–Ω–∏–º–∞—è, —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å –∏ –∫–∞–∫ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ. –≠—Ç–æ –∫–∞–∫ –ø–æ–ø—ã—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º –±–µ–∑ —á–µ—Ä—Ç–µ–∂–µ–π.</p>
<h3 id="_367">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –∏–∑—É—á–µ–Ω–∏—é</h3>
<ul>
<li><strong>–ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</strong>: –ü—ã—Ç–∞—é—Ç—Å—è –∏–∑—É—á–∏—Ç—å –≤—Å–µ —Å—Ä–∞–∑—É</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: –ò–∑—É—á–∞—é—Ç —Å–ª–æ–∂–Ω–æ–µ –¥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ</li>
<li><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</strong>: –¢–æ–ª—å–∫–æ —Ç–µ–æ—Ä–∏—è –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –º–æ—Ç–∏–≤–∞—Ü–∏–∏</strong>: –ù–µ –≤–∏–¥—è—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</li>
</ul>
<h3 id="_368">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞</h3>
<ul>
<li><strong>–ü–æ—ç—Ç–∞–ø–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ</strong>: –û—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å</strong>: –¢–µ–æ—Ä–∏—è —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è</li>
<li><strong>–ò–∑–º–µ—Ä–∏–º—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å</strong>: –í–∏–¥—è—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ</li>
<li><strong>–ú–æ—Ç–∏–≤–∞—Ü–∏—è</strong>: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</li>
</ul>
<h2 id="_369">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–∑—É—á–µ–Ω–∏—é - —ç—Ç–æ –∫–∞—Ä—Ç–∞ –∫ —É—Å–ø–µ—Ö—É?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∏–∑—É—á–µ–Ω–∏—è, —É—á–∏—Ç—ã–≤–∞—è –≤–∞—à —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ —Ü–µ–ª–∏.</p>
<p>–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑—É—á–∏—Ç—å —É—á–µ–±–Ω–∏–∫ AutoML Gluon –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ —É—Ä–æ–≤–Ω—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ —Ü–µ–ª–µ–π.</p>
<h2 id="0-6">–î–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (0-6 –º–µ—Å—è—Ü–µ–≤ –æ–ø—ã—Ç–∞)</h2>
<p><strong>–ü–æ—á–µ–º—É –Ω–æ–≤–∏—á–∫–∞–º –Ω—É–∂–µ–Ω –æ—Å–æ–±—ã–π –ø–æ–¥—Ö–æ–¥?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –µ—â–µ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –æ—Å–Ω–æ–≤ ML –∏ –º–æ–≥—É—Ç –ª–µ–≥–∫–æ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è –≤ —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏—è—Ö. –ù—É–∂–µ–Ω –ø–æ—à–∞–≥–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Å –±—ã—Å—Ç—Ä—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.</p>
<h3 id="1-2">üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (1-2 –Ω–µ–¥–µ–ª–∏)</h3>
<p><strong>–ü–æ—á–µ–º—É –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏—é.</p>
<p><strong>–¶–µ–ª—å:</strong> –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ</p>
<h4 id="1-2_1">–î–µ–Ω—å 1-2: –û—Å–Ω–æ–≤—ã</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ AutoML Gluon –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä</li>
</ol>
<h4 id="3-4">–î–µ–Ω—å 3-4: –ü–æ–Ω–∏–º–∞–Ω–∏–µ</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 3</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –º–æ–¥–µ–ª—å</li>
</ol>
<h4 id="5-7">–î–µ–Ω—å 5-7: –í–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Å–≤–æ–µ–π –º–æ–¥–µ–ª–∏</li>
</ol>
<h4 id="8-10">–î–µ–Ω—å 8-10: –ü—Ä–æ–¥–∞–∫—à–µ–Ω</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</li>
</ol>
<h4 id="11-14">–î–µ–Ω—å 11-14: –£–≥–ª—É–±–ª–µ–Ω–∏–µ</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º</li>
</ol>
<h3 id="1-2_2">üìö –ü–æ–ª–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (1-2 –º–µ—Å—è—Ü–∞)</h3>
<p><strong>–¶–µ–ª—å:</strong> –ü–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ AutoML Gluon</p>
<h4 id="1_27">–ù–µ–¥–µ–ª—è 1: –û—Å–Ω–æ–≤—ã</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 3</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ 3-5 –ø—Ä–æ—Å—Ç—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
</ol>
<h4 id="2_24">–ù–µ–¥–µ–ª—è 2: –û—Ü–µ–Ω–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
</ol>
<h4 id="3_8">–ù–µ–¥–µ–ª—è 3: –ü—Ä–æ–¥–∞–∫—à–µ–Ω</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h4 id="4_3">–ù–µ–¥–µ–ª—è 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–†–∞–∑–¥–µ–ª 10</strong> - Troubleshooting</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –†–µ—à–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É</li>
</ol>
<h2 id="6_1">–î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (6+ –º–µ—Å—è—Ü–µ–≤ –æ–ø—ã—Ç–∞)</h2>
<h3 id="1_28">üéØ –§–æ–∫—É—Å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (1 –Ω–µ–¥–µ–ª—è)</h3>
<p><strong>–¶–µ–ª—å:</strong> –°–æ–∑–¥–∞—Ç—å —Ä–æ–±–∞—Å—Ç–Ω—É—é –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</p>
<h4 id="1-2_3">–î–µ–Ω—å 1-2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h4 id="3-4_1">–î–µ–Ω—å 3-4: –í–∞–ª–∏–¥–∞—Ü–∏—è</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
</ol>
<h4 id="5-7_1">–î–µ–Ω—å 5-7: –î–µ–ø–ª–æ–π</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 9</strong> - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω</li>
</ol>
<h3 id="2-3">üî¨ –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ (2-3 –Ω–µ–¥–µ–ª–∏)</h3>
<p><strong>–¶–µ–ª—å:</strong> –°—Ç–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–æ–º –≤ AutoML Gluon</p>
<h4 id="1_29">–ù–µ–¥–µ–ª—è 1: –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 14</strong> - –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</li>
<li><strong>–†–∞–∑–¥–µ–ª 15</strong> - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</li>
<li><strong>–†–∞–∑–¥–µ–ª 16</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</li>
</ol>
<h4 id="2_25">–ù–µ–¥–µ–ª—è 2: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞</li>
</ol>
<h4 id="3-_1">–ù–µ–¥–µ–ª—è 3: –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 17</strong> - –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h2 id="2_26">–î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ (2+ –≥–æ–¥–∞ –æ–ø—ã—Ç–∞)</h2>
<h3 id="3-5">üöÄ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (3-5 –¥–Ω–µ–π)</h3>
<p><strong>–¶–µ–ª—å:</strong> –ë—ã—Å—Ç—Ä–æ –æ—Å–≤–æ–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</p>
<h4 id="1_30">–î–µ–Ω—å 1: –û–±–∑–æ—Ä</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±—ã—Å—Ç—Ä–æ)</li>
<li><strong>–†–∞–∑–¥–µ–ª 14</strong> - –¢–µ–æ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤—ã AutoML</li>
<li><strong>–†–∞–∑–¥–µ–ª 16</strong> - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –û—Ü–µ–Ω–∏—Ç–µ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</li>
</ol>
<h4 id="2_27">–î–µ–Ω—å 2: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</li>
</ol>
<h4 id="3-_2">–î–µ–Ω—å 3: –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–≤—ã–±–æ—Ä–æ—á–Ω–æ)</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—ã</li>
</ol>
<h4 id="4-5">–î–µ–Ω—å 4-5: –î–µ–ø–ª–æ–π –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h4>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–ü—Ä–∞–∫—Ç–∏–∫–∞:</strong> –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É</li>
</ol>
<h2 id="_370">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∏–∑—É—á–µ–Ω–∏—è</h2>
<h3 id="_371">üìä –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ü–æ–Ω–∏–º–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç—Ä–∏–∫</p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 5</strong> - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 15</strong> - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
</ol>
<h3 id="ml-">ü§ñ –î–ª—è ML-–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 6</strong> - –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∏ –¥–µ–ø–ª–æ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 7</strong> - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</li>
<li><strong>–†–∞–∑–¥–µ–ª 12</strong> - –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 13</strong> - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
</ol>
<h3 id="_372">üí∞ –î–ª—è —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã</p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 19</strong> - WAVE2 –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</li>
<li><strong>–†–∞–∑–¥–µ–ª 20</strong> - SCHR Levels</li>
<li><strong>–†–∞–∑–¥–µ–ª 21</strong> - SCHR SHORT3</li>
<li><strong>–†–∞–∑–¥–µ–ª 22</strong> - –°—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏ (–∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥)</li>
</ol>
<h3 id="-_13">üè¢ –î–ª—è –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤</h3>
<p><strong>–§–æ–∫—É—Å:</strong> –ë–∏–∑–Ω–µ—Å-–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</p>
<ol>
<li><strong>–†–∞–∑–¥–µ–ª 1</strong> - –í–≤–µ–¥–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 2</strong> - –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
<li><strong>–†–∞–∑–¥–µ–ª 4</strong> - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</li>
<li><strong>–†–∞–∑–¥–µ–ª 18</strong> - –ö–µ–π—Å-—Å—Ç–∞–¥–∏</li>
<li><strong>–†–∞–∑–¥–µ–ª 17</strong> - –≠—Ç–∏–∫–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π AI</li>
<li><strong>–†–∞–∑–¥–µ–ª 8</strong> - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</li>
</ol>
<h2 id="_373">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
<h3 id="_374">üìù –í–µ–¥–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫</h3>
<ol>
<li><strong>–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∑–∞–º–µ—Ç–æ–∫</strong> –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞</li>
<li><strong>–ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–æ–¥</strong> –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø—Ä–æ–±—É–µ—Ç–µ</li>
<li><strong>–§–∏–∫—Å–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏</strong> –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è</li>
<li><strong>–û—Ç–º–µ—á–∞–π—Ç–µ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã</strong> –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</li>
</ol>
<h3 id="_375">üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
<h4 id="1-30">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å (30 –º–∏–Ω—É—Ç)</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ Iris</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

<span class="c1"># –û—Ü–µ–Ω–∫–∞</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å: </span><span class="si">{</span><span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="2-1">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è (1 —á–∞—Å)</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–æ–¥–µ–ª–∏</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="c1"># –í–∞–ª–∏–¥–∞—Ü–∏—è</span>
<span class="n">test_predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–µ: </span><span class="si">{</span><span class="n">test_accuracy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="3-2">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –ü—Ä–æ–¥–∞–∫—à–µ–Ω (2 —á–∞—Å–∞)</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é API –¥–ª—è –º–æ–¥–µ–ª–∏</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;model_path&#39;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/predict&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">prediction</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="_376">üîÑ –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥</h3>
<ol>
<li><strong>–ß–∏—Ç–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª</strong> (10-15 –º–∏–Ω—É—Ç)</li>
<li><strong>–ü—Ä–æ–±—É–π—Ç–µ –∫–æ–¥</strong> (20-30 –º–∏–Ω—É—Ç)</li>
<li><strong>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</strong> (5-10 –º–∏–Ω—É—Ç)</li>
<li><strong>–î–µ–ª–∞–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏</strong> (5 –º–∏–Ω—É—Ç)</li>
<li><strong>–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É</strong></li>
</ol>
<h3 id="_377">üéØ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π</h3>
<h4 id="1-2_4">–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (1-2 –Ω–µ–¥–µ–ª–∏)</h4>
<ul>
<li>–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä</li>
<li>–ü–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏</li>
<li>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å</li>
</ul>
<h4 id="1-2_5">–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (1-2 –º–µ—Å—è—Ü–∞)</h4>
<ul>
<li>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–∏—Å—Ç–µ–º—É</li>
<li>–ü–æ–Ω—è—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</li>
<li>–†–µ—à–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É</li>
</ul>
<h4 id="3-6">–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (3-6 –º–µ—Å—è—Ü–µ–≤)</h4>
<ul>
<li>–°—Ç–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–æ–º –≤ AutoML Gluon</li>
<li>–°–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä-—Å–∏—Å—Ç–µ–º—É</li>
<li>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∑–Ω–∞–Ω–∏—è–º–∏ —Å –¥—Ä—É–≥–∏–º–∏</li>
</ul>
<h2 id="_378">–†–µ—Å—É—Ä—Å—ã –¥–ª—è —É–≥–ª—É–±–ª–µ–Ω–∏—è</h2>
<h3 id="_379">üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</h3>
<ul>
<li>"AutoML: Methods, Systems, Challenges" - Frank Hutter</li>
<li>"Hands-On Machine Learning" - Aur√©lien G√©ron</li>
<li>"The Elements of Statistical Learning" - Hastie, Tibshirani, Friedman</li>
</ul>
<h3 id="_380">üåê –û–Ω–ª–∞–π–Ω —Ä–µ—Å—É—Ä—Å—ã</h3>
<ul>
<li><a href="https://auto.gluon.ai/">AutoML Gluon Documentation</a></li>
<li><a href="https://aws.amazon.com/sagemaker/">Amazon SageMaker</a></li>
<li><a href="https://www.kaggle.com/learn">Kaggle Learn</a></li>
</ul>
<h3 id="_381">üë• –°–æ–æ–±—â–µ—Å—Ç–≤–æ</h3>
<ul>
<li><a href="https://github.com/autogluon/autogluon">AutoML Gluon GitHub</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/autogluon">Stack Overflow</a></li>
<li><a href="https://www.reddit.com/r/MachineLearning/">Reddit r/MachineLearning</a></li>
</ul>
<h2 id="_382">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–≠—Ç–æ—Ç —É—á–µ–±–Ω–∏–∫ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—É—Ç—å –∏–∑—É—á–µ–Ω–∏—è –∏ —Å–ª–µ–¥—É–π—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º. –ü–æ–º–Ω–∏—Ç–µ: –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∏–∑—É—á–∏—Ç—å AutoML Gluon - —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞!</p>
<hr />
<h1 id="ml-_1">–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤ ML-–º–æ–¥–µ–ª—è—Ö</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="_383">–ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ</h2>
<p><strong>–ü–æ—á–µ–º—É 95% ML-–º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–∞–Ω–¥—ã —Ñ–æ–∫—É—Å–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏. –≠—Ç–æ –∫–∞–∫ –≤—Ä–∞—á, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–≤–∏—Ç –¥–∏–∞–≥–Ω–æ–∑, –Ω–æ –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω —É–≤–µ—Ä–µ–Ω.</p>
<h3 id="_384">–ü—Ä–æ–±–ª–µ–º—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<ul>
<li><strong>–õ–æ–∂–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</strong>: –ú–æ–¥–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç "–¥–∞" —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 99%, –Ω–æ –æ—à–∏–±–∞–µ—Ç—Å—è</li>
<li><strong>–ü–ª–æ—Ö–æ–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ù–µ –ø–æ–Ω–∏–º–∞—é—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –Ω–µ —É–≤–µ—Ä–µ–Ω–∞</li>
<li><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ—Ç–æ—á–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è</strong>: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –¥–æ–≤–µ—Ä—è—é—Ç –º–æ–¥–µ–ª–∏</li>
</ul>
<h3 id="_385">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<ul>
<li><strong>–¢–æ—á–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞</strong>: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏</li>
<li><strong>–õ—É—á—à–∏–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong>: –ü–æ–Ω–∏–º–∞—é—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –Ω–µ —É–≤–µ—Ä–µ–Ω–∞</li>
<li><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</strong>: –ü—Ä–∏–Ω–∏–º–∞—é—Ç —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ—á–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong>: –ú–æ–¥–µ–ª—å –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –¥–æ–≤–µ—Ä–∏—è</li>
</ul>
<h2 id="_386">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ - —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ ML-–º–æ–¥–µ–ª–∏?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å, –Ω–æ –∏ –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∞ —É–≤–µ—Ä–µ–Ω–∞ –≤ —Å–≤–æ–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏.</p>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π - —ç—Ç–æ –∫–ª—é—á –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–æ–±–∞—Å—Ç–Ω—ã—Ö –∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –≥–ª—É–±–æ–∫–æ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏—é —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –≤ AutoML Gluon –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<h2 id="ml">–ß—Ç–æ —Ç–∞–∫–æ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ ML?</h2>
<p><strong>–ü–æ—á–µ–º—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞ –æ—Ç 0 –¥–æ 1?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∏ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –∫–∞–∫ –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã - –µ—Å–ª–∏ –≥–æ–≤–æ—Ä—è—Ç 90% –¥–æ–∂–¥—è, —Ç–æ –¥–æ–∂–¥—å –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –≤ 90% —Å–ª—É—á–∞–µ–≤.</p>
<h3 id="_387">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</h3>
<p><strong>–ü–æ—á–µ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.</p>
<p>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ - —ç—Ç–æ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –≤ —Å–≤–æ–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö. –û–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.</p>
<h3 id="_388">–¢–∏–ø—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># –ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤ AutoML Gluon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">autogluon.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularPredictor</span>

<span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">TabularPredictor</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>

<span class="c1"># –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

<span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:&quot;</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏:&quot;</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>
</code></pre></div>

<h2 id="_389">–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 id="1_31">1. –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityCalibration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_methods</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calibrate_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># Platt Scaling</span>
        <span class="n">platt_calibrated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">platt_scaling</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># Isotonic Regression</span>
        <span class="n">isotonic_calibrated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isotonic_regression</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># Temperature Scaling</span>
        <span class="n">temperature_calibrated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_scaling</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;platt&#39;</span><span class="p">:</span> <span class="n">platt_calibrated</span><span class="p">,</span>
            <span class="s1">&#39;isotonic&#39;</span><span class="p">:</span> <span class="n">isotonic_calibrated</span><span class="p">,</span>
            <span class="s1">&#39;temperature&#39;</span><span class="p">:</span> <span class="n">temperature_calibrated</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">platt_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Platt Scaling –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.calibration</span><span class="w"> </span><span class="kn">import</span> <span class="n">CalibratedClassifierCV</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞</span>
        <span class="n">calibrated_clf</span> <span class="o">=</span> <span class="n">CalibratedClassifierCV</span><span class="p">(</span>
            <span class="n">base_estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># AutoML Gluon –º–æ–¥–µ–ª—å</span>
            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span>
            <span class="n">cv</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>

        <span class="c1"># –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</span>
        <span class="n">calibrated_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">true_labels</span><span class="p">)</span>
        <span class="n">calibrated_probs</span> <span class="o">=</span> <span class="n">calibrated_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">calibrated_probs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isotonic_regression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Isotonic Regression –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.isotonic</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsotonicRegression</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ—Ç–æ–Ω–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</span>
        <span class="n">isotonic_reg</span> <span class="o">=</span> <span class="n">IsotonicRegression</span><span class="p">(</span><span class="n">out_of_bounds</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>

        <span class="c1"># –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</span>
        <span class="n">isotonic_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>
        <span class="n">calibrated_probs</span> <span class="o">=</span> <span class="n">isotonic_reg</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">calibrated_probs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">temperature_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Temperature Scaling –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

        <span class="c1"># Temperature Scaling</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">LBFGS</span><span class="p">([</span><span class="n">temperature</span><span class="p">],</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">eval_loss</span><span class="p">():</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()(</span>
                <span class="n">probabilities</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">,</span> 
                <span class="n">true_labels</span>
            <span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">loss</span>

        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">eval_loss</span><span class="p">)</span>

        <span class="c1"># –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</span>
        <span class="n">calibrated_probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">probabilities</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">calibrated_probs</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</code></pre></div>

<h3 id="2_28">2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdaptiveRiskManagement</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_thresholds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position_sizing</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_position_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">confidence_threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏</span>
        <span class="n">base_size</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 10% –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="n">probability</span> <span class="o">&gt;</span> <span class="n">confidence_threshold</span><span class="p">:</span>
            <span class="c1"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä</span>
            <span class="n">position_size</span> <span class="o">=</span> <span class="n">base_size</span> <span class="o">*</span> <span class="p">(</span><span class="n">probability</span> <span class="o">/</span> <span class="n">confidence_threshold</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä</span>
            <span class="n">position_size</span> <span class="o">=</span> <span class="n">base_size</span> <span class="o">*</span> <span class="p">(</span><span class="n">probability</span> <span class="o">/</span> <span class="n">confidence_threshold</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>

        <span class="c1"># –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞</span>
        <span class="n">position_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">position_size</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># –ú–∞–∫—Å–∏–º—É–º 20%</span>

        <span class="k">return</span> <span class="n">position_size</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dynamic_stop_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">entry_price</span><span class="p">,</span> <span class="n">volatility</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–∑–æ–≤—ã–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span>
        <span class="n">base_stop</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="mf">0.95</span>  <span class="c1"># 5% —Å—Ç–æ–ø-–ª–æ—Å—Å</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="n">probability</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span>
            <span class="n">stop_loss</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">probability</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - –±–æ–ª–µ–µ —É–∑–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å</span>
            <span class="n">stop_loss</span> <span class="o">=</span> <span class="n">entry_price</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">probability</span><span class="p">))</span>

        <span class="c1"># –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="n">volatility_adjustment</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">volatility</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="n">stop_loss</span> <span class="o">=</span> <span class="n">stop_loss</span> <span class="o">*</span> <span class="n">volatility_adjustment</span>

        <span class="k">return</span> <span class="n">stop_loss</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">probability_based_hedging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–•–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">prob_distribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_probability_distribution</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="c1"># –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span>
        <span class="n">hedging_needed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_hedging_need</span><span class="p">(</span><span class="n">prob_distribution</span><span class="p">,</span> <span class="n">market_conditions</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hedging_needed</span><span class="p">:</span>
            <span class="c1"># –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ö–µ–¥–∂–∞</span>
            <span class="n">hedge_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_hedge_size</span><span class="p">(</span><span class="n">prob_distribution</span><span class="p">)</span>

            <span class="c1"># –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è</span>
            <span class="n">hedge_instruments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_hedge_instruments</span><span class="p">(</span><span class="n">market_conditions</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;hedge_needed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;hedge_size&#39;</span><span class="p">:</span> <span class="n">hedge_size</span><span class="p">,</span>
                <span class="s1">&#39;instruments&#39;</span><span class="p">:</span> <span class="n">hedge_instruments</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;hedge_needed&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</code></pre></div>

<h3 id="3_9">3. –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityEnsemble</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_methods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_calculation</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">weighted_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_probabilities</span><span class="p">,</span> <span class="n">model_weights</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∑–≤–µ—à–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤</span>
        <span class="n">normalized_weights</span> <span class="o">=</span> <span class="n">model_weights</span> <span class="o">/</span> <span class="n">model_weights</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="c1"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">ensemble_probability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span>
            <span class="n">model_probabilities</span><span class="p">,</span> 
            <span class="n">weights</span><span class="o">=</span><span class="n">normalized_weights</span><span class="p">,</span> 
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ensemble_probability</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">confidence_weighted_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_probabilities</span><span class="p">,</span> <span class="n">model_confidences</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω—Å–∞–º–±–ª—å —Å –≤–µ—Å–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</span>
        <span class="n">confidence_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_confidence_weights</span><span class="p">(</span><span class="n">model_confidences</span><span class="p">)</span>

        <span class="c1"># –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">ensemble_probability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span>
            <span class="n">model_probabilities</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">confidence_weights</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ensemble_probability</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bayesian_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_probabilities</span><span class="p">,</span> <span class="n">model_uncertainties</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∞–Ω—Å–∞–º–±–ª—å&quot;&quot;&quot;</span>

        <span class="c1"># –ë–∞–π–µ—Å–æ–≤—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
        <span class="n">bayesian_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_bayesian_weights</span><span class="p">(</span><span class="n">model_uncertainties</span><span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏</span>
        <span class="n">ensemble_probability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span>
            <span class="n">model_probabilities</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">bayesian_weights</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏</span>
        <span class="n">ensemble_uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_ensemble_uncertainty</span><span class="p">(</span>
            <span class="n">model_probabilities</span><span class="p">,</span> 
            <span class="n">model_uncertainties</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">ensemble_probability</span><span class="p">,</span>
            <span class="s1">&#39;uncertainty&#39;</span><span class="p">:</span> <span class="n">ensemble_uncertainty</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="4_4">4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–∏—Ñ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityDriftMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥—Ä–∏—Ñ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drift_detectors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_distribution</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_probability_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_probabilities</span><span class="p">,</span> <span class="n">baseline_probabilities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥—Ä–∏—Ñ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã</span>
        <span class="n">statistical_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">statistical_drift_test</span><span class="p">(</span>
            <span class="n">current_probabilities</span><span class="p">,</span> 
            <span class="n">baseline_probabilities</span>
        <span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞</span>
        <span class="n">ks_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ks_drift_test</span><span class="p">(</span>
            <span class="n">current_probabilities</span><span class="p">,</span> 
            <span class="n">baseline_probabilities</span>
        <span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç –í–∞—Å—Å–µ—Ä—à—Ç–µ–π–Ω–∞</span>
        <span class="n">wasserstein_drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wasserstein_drift_test</span><span class="p">(</span>
            <span class="n">current_probabilities</span><span class="p">,</span> 
            <span class="n">baseline_probabilities</span>
        <span class="p">)</span>

        <span class="c1"># –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="nb">any</span><span class="p">([</span>
            <span class="n">statistical_drift</span><span class="p">,</span>
            <span class="n">ks_drift</span><span class="p">,</span>
            <span class="n">wasserstein_drift</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;drift_detected&#39;</span><span class="p">:</span> <span class="n">drift_detected</span><span class="p">,</span>
            <span class="s1">&#39;statistical&#39;</span><span class="p">:</span> <span class="n">statistical_drift</span><span class="p">,</span>
            <span class="s1">&#39;ks&#39;</span><span class="p">:</span> <span class="n">ks_drift</span><span class="p">,</span>
            <span class="s1">&#39;wasserstein&#39;</span><span class="p">:</span> <span class="n">wasserstein_drift</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">statistical_drift_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">baseline</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –¥—Ä–∏—Ñ—Ç–∞&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

        <span class="c1"># t-—Ç–µ—Å—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö</span>
        <span class="n">t_stat</span><span class="p">,</span> <span class="n">t_pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

        <span class="c1"># –¢–µ—Å—Ç –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏</span>
        <span class="n">u_stat</span><span class="p">,</span> <span class="n">u_pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∏—Ç–µ—Ä–∏–π –¥—Ä–∏—Ñ—Ç–∞</span>
        <span class="n">drift_threshold</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_pvalue</span> <span class="o">&lt;</span> <span class="n">drift_threshold</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">u_pvalue</span> <span class="o">&lt;</span> <span class="n">drift_threshold</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">drift_detected</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ks_drift_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">baseline</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

        <span class="c1"># KS —Ç–µ—Å—Ç</span>
        <span class="n">ks_stat</span><span class="p">,</span> <span class="n">ks_pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∏—Ç–µ—Ä–∏–π –¥—Ä–∏—Ñ—Ç–∞</span>
        <span class="n">drift_detected</span> <span class="o">=</span> <span class="n">ks_pvalue</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

        <span class="k">return</span> <span class="n">drift_detected</span>
</code></pre></div>

<h2 id="_390">–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 id="1_32">1. –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityOverfittingPrevention</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regularization_methods</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prevent_overfitting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</span>
        <span class="n">l1_regularized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l1_regularization</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</span>
        <span class="n">l2_regularized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_regularization</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># Dropout –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">dropout_regularized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_regularization</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="n">l1_regularized</span><span class="p">,</span>
            <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="n">l2_regularized</span><span class="p">,</span>
            <span class="s1">&#39;dropout&#39;</span><span class="p">:</span> <span class="n">dropout_regularized</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">l1_regularization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ L1 —à—Ç—Ä–∞—Ñ–∞</span>
        <span class="n">l1_penalty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">probabilities</span><span class="p">))</span>

        <span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">regularized_probs</span> <span class="o">=</span> <span class="n">probabilities</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">l1_penalty</span>

        <span class="k">return</span> <span class="n">regularized_probs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dropout_regularization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dropout —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è&quot;&quot;&quot;</span>

        <span class="c1"># –°–ª—É—á–∞–π–Ω–æ–µ –æ–±–Ω—É–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">dropout_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">regularized_probs</span> <span class="o">=</span> <span class="n">probabilities</span> <span class="o">*</span> <span class="n">dropout_mask</span>

        <span class="k">return</span> <span class="n">regularized_probs</span>
</code></pre></div>

<h3 id="2_29">2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityInterpretation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpretation_guidelines</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interpret_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</span>
        <span class="n">context_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_context</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏</span>
        <span class="n">corrected_interpretation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correct_interpretation</span><span class="p">(</span>
            <span class="n">probabilities</span><span class="p">,</span> 
            <span class="n">context_analysis</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">corrected_interpretation</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</span>
        <span class="n">market_conditions</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;market_conditions&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span>
        <span class="n">temporal_factors</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;temporal_factors&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># –í–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã</span>
        <span class="n">external_factors</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;external_factors&#39;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;market&#39;</span><span class="p">:</span> <span class="n">market_conditions</span><span class="p">,</span>
            <span class="s1">&#39;temporal&#39;</span><span class="p">:</span> <span class="n">temporal_factors</span><span class="p">,</span>
            <span class="s1">&#39;external&#39;</span><span class="p">:</span> <span class="n">external_factors</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">correct_interpretation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">context_analysis</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π</span>
        <span class="n">market_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">market_correction</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">context_analysis</span><span class="p">[</span><span class="s1">&#39;market&#39;</span><span class="p">])</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</span>
        <span class="n">temporal_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temporal_correction</span><span class="p">(</span><span class="n">market_corrected</span><span class="p">,</span> <span class="n">context_analysis</span><span class="p">[</span><span class="s1">&#39;temporal&#39;</span><span class="p">])</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</span>
        <span class="n">external_corrected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_correction</span><span class="p">(</span><span class="n">temporal_corrected</span><span class="p">,</span> <span class="n">context_analysis</span><span class="p">[</span><span class="s1">&#39;external&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">external_corrected</span>
</code></pre></div>

<h3 id="3_10">3. –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CalibrationIssues</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_problems</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">identify_calibration_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π</span>
        <span class="n">calibration_curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_calibration_curve</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏</span>
        <span class="n">reliability_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_reliability</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑–æ–ª—é—Ü–∏–∏</span>
        <span class="n">resolution_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_resolution</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;calibration_curve&#39;</span><span class="p">:</span> <span class="n">calibration_curve</span><span class="p">,</span>
            <span class="s1">&#39;reliability&#39;</span><span class="p">:</span> <span class="n">reliability_analysis</span><span class="p">,</span>
            <span class="s1">&#39;resolution&#39;</span><span class="p">:</span> <span class="n">resolution_analysis</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_calibration_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.calibration</span><span class="w"> </span><span class="kn">import</span> <span class="n">calibration_curve</span>

        <span class="c1"># –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π –∫—Ä–∏–≤–æ–π</span>
        <span class="n">fraction_of_positives</span><span class="p">,</span> <span class="n">mean_predicted_value</span> <span class="o">=</span> <span class="n">calibration_curve</span><span class="p">(</span>
            <span class="n">true_labels</span><span class="p">,</span> 
            <span class="n">probabilities</span><span class="p">,</span> 
            <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span>
        <span class="p">)</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π</span>
        <span class="n">deviations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fraction_of_positives</span> <span class="o">-</span> <span class="n">mean_predicted_value</span><span class="p">)</span>

        <span class="c1"># –ö—Ä–∏—Ç–µ—Ä–∏–π –ø–ª–æ—Ö–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏</span>
        <span class="n">bad_calibration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">deviations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;curve&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">fraction_of_positives</span><span class="p">,</span> <span class="n">mean_predicted_value</span><span class="p">),</span>
            <span class="s1">&#39;deviations&#39;</span><span class="p">:</span> <span class="n">deviations</span><span class="p">,</span>
            <span class="s1">&#39;bad_calibration&#39;</span><span class="p">:</span> <span class="n">bad_calibration</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_391">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h2>
<h3 id="1_33">1. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityValidation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_methods</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
        <span class="n">cv_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
        <span class="n">temporal_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temporal_validation</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
        <span class="n">stochastic_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stochastic_validation</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;cv&#39;</span><span class="p">:</span> <span class="n">cv_validation</span><span class="p">,</span>
            <span class="s1">&#39;temporal&#39;</span><span class="p">:</span> <span class="n">temporal_validation</span><span class="p">,</span>
            <span class="s1">&#39;stochastic&#39;</span><span class="p">:</span> <span class="n">stochastic_validation</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cross_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span>

        <span class="c1"># –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</span>
        <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span>
            <span class="n">probabilities</span><span class="p">,</span> 
            <span class="n">true_labels</span><span class="p">,</span> 
            <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
            <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_log_loss&#39;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;scores&#39;</span><span class="p">:</span> <span class="n">cv_scores</span><span class="p">,</span>
            <span class="s1">&#39;mean_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">),</span>
            <span class="s1">&#39;std_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="2_30">2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityMonitoring</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_metrics</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –ø–æ—Ç–µ—Ä—è</span>
        <span class="n">log_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_log_loss</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># Brier Score</span>
        <span class="n">brier_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_brier_score</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="c1"># –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–∞—è –æ—à–∏–±–∫–∞</span>
        <span class="n">calibration_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_calibration_error</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;log_loss&#39;</span><span class="p">:</span> <span class="n">log_loss</span><span class="p">,</span>
            <span class="s1">&#39;brier_score&#39;</span><span class="p">:</span> <span class="n">brier_score</span><span class="p">,</span>
            <span class="s1">&#39;calibration_error&#39;</span><span class="p">:</span> <span class="n">calibration_error</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_log_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –ø–æ—Ç–µ—Ä–∏&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_loss</span>

        <span class="c1"># –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è –ø–æ—Ç–µ—Ä—è</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_brier_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç Brier Score&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">brier_score_loss</span>

        <span class="c1"># Brier Score</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">brier_score_loss</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>

<h2 id="_392">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</h2>
<h3 id="1_34">1. –¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityTradingSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probability_thresholds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_management</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_trading_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">market_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">prob_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_probabilities</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</span>
        <span class="n">signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_signals</span><span class="p">(</span><span class="n">prob_analysis</span><span class="p">,</span> <span class="n">market_data</span><span class="p">)</span>

        <span class="c1"># –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏</span>
        <span class="n">risk_adjusted_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjust_for_risk</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">risk_adjusted_signals</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</span>
        <span class="n">mean_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
        <span class="n">std_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
        <span class="n">max_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
        <span class="n">min_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="c1"># –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">prob_distribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_distribution</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">mean_prob</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">std_prob</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">max_prob</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">min_prob</span><span class="p">,</span>
            <span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="n">prob_distribution</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob_analysis</span><span class="p">,</span> <span class="n">market_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤&quot;&quot;&quot;</span>

        <span class="n">signals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prob_analysis</span><span class="p">[</span><span class="s1">&#39;probabilities&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
                <span class="c1"># –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —Å–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;BUY&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="s1">&#39;STRONG&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">prob</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mf">0.6</span><span class="p">:</span>
                <span class="c1"># –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —É–º–µ—Ä–µ–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;BUY&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="s1">&#39;MODERATE&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">prob</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="k">elif</span> <span class="n">prob</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>
                <span class="c1"># –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - —Å–∏–≥–Ω–∞–ª –ø—Ä–æ–¥–∞–∂–∏</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SELL&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="s1">&#39;STRONG&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">prob</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏–≥–Ω–∞–ª–∞</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;HOLD&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="s1">&#39;NONE&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="p">}</span>

            <span class="n">signals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">signals</span>
</code></pre></div>

<h3 id="2_31">2. –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProbabilityPortfolioManagement</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">portfolio_weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">risk_budget</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">optimize_portfolio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asset_probabilities</span><span class="p">,</span> <span class="n">risk_budget</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_weights</span><span class="p">(</span><span class="n">asset_probabilities</span><span class="p">)</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ä–∏—Å–∫</span>
        <span class="n">risk_adjusted_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjust_for_risk</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">risk_budget</span><span class="p">)</span>

        <span class="c1"># –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</span>
        <span class="n">optimized_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_allocation</span><span class="p">(</span><span class="n">risk_adjusted_weights</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">optimized_weights</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asset_probabilities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π&quot;&quot;&quot;</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</span>
        <span class="n">normalized_probs</span> <span class="o">=</span> <span class="n">asset_probabilities</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">asset_probabilities</span><span class="p">)</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –¥–∏—Å–ø–µ—Ä—Å–∏—é</span>
        <span class="n">variance_adjusted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjust_for_variance</span><span class="p">(</span><span class="n">normalized_probs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">variance_adjusted</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_for_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">risk_budget</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ä–∏—Å–∫&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è</span>
        <span class="n">portfolio_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_portfolio_risk</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

        <span class="c1"># –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤</span>
        <span class="k">if</span> <span class="n">portfolio_risk</span> <span class="o">&gt;</span> <span class="n">risk_budget</span><span class="p">:</span>
            <span class="c1"># –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Å–æ–≤</span>
            <span class="n">adjustment_factor</span> <span class="o">=</span> <span class="n">risk_budget</span> <span class="o">/</span> <span class="n">portfolio_risk</span>
            <span class="n">adjusted_weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="n">adjustment_factor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">adjusted_weights</span> <span class="o">=</span> <span class="n">weights</span>

        <span class="k">return</span> <span class="n">adjusted_weights</span>
</code></pre></div>

<h2 id="_393">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π - —ç—Ç–æ –∫–ª—é—á –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–æ–±–∞—Å—Ç–Ω—ã—Ö –∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö ML-–º–æ–¥–µ–ª–µ–π. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö –∏ —Å–ª–∞–±—ã—Ö —Å—Ç–æ—Ä–æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<h3 id="_394">–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:</h3>
<ol>
<li><strong>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</strong> - –≤—Å–µ–≥–¥–∞ –∫–∞–ª–∏–±—Ä—É–π—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</li>
<li><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è</strong> - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong> - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –¥—Ä–∏—Ñ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
<li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</strong> - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
<li><strong>–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏</li>
</ol>
<p>–°–ª–µ–¥—É—è —ç—Ç–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º, –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã.</p>
<hr />
<h1 id="-_14">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h1>
<p><strong>–ê–≤—Ç–æ—Ä:</strong> NeoZorK (Shcherbyna Rostyslav)<br />
<strong>–î–∞—Ç–∞:</strong> 2025<br />
<strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> Ukraine, Zaporizhzhya<br />
<strong>–í–µ—Ä—Å–∏—è:</strong> 1.0  </p>
<h2 id="_395">–ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω</h2>
<p><strong>–ü–æ—á–µ–º—É 90% —Ç–æ—Ä–≥–æ–≤—ã—Ö –±–æ—Ç–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏ –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Å–ª–µ–ø—É—é, –Ω–µ –ø–æ–Ω–∏–º–∞—è, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –∏—Ö —Å–∏—Å—Ç–µ–º–æ–π. –≠—Ç–æ –∫–∞–∫ –≤–æ–∂–¥–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –±–µ–∑ –ø—Ä–∏–±–æ—Ä–Ω–æ–π –ø–∞–Ω–µ–ª–∏.</p>
<h3 id="_396">–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<ul>
<li><strong>–°–ª–µ–ø–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è</strong>: –ù–µ –∑–Ω–∞—é—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –±–æ—Ç–æ–º</li>
<li><strong>–ü–æ–∑–¥–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</strong>: –£–∑–Ω–∞—é—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö, –∫–æ–≥–¥–∞ —É–∂–µ –ø–æ–∑–¥–Ω–æ</li>
<li><strong>–ü–æ—Ç–µ—Ä—è –¥–µ–Ω–µ–≥</strong>: –ë–æ—Ç –º–æ–∂–µ—Ç —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ —á–∞—Å–∞–º–∏</li>
<li><strong>–°—Ç—Ä–µ—Å—Å –∏ —Ç—Ä–µ–≤–æ–≥–∞</strong>: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ –æ —Ä–∞–±–æ—Ç–µ –±–æ—Ç–∞</li>
</ul>
<h3 id="_397">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<ul>
<li><strong>–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å</strong>: –ü–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –±–æ—Ç–æ–º</li>
<li><strong>–ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</strong>: –†–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã –¥–æ –ø–æ—Ç–µ—Ä–∏ –¥–µ–Ω–µ–≥</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong>: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞—é—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞</li>
<li><strong>–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</strong>: –£–≤–µ—Ä–µ–Ω—ã –≤ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã</li>
</ul>
<h2 id="_398">–í–≤–µ–¥–µ–Ω–∏–µ</h2>
<p><strong>–ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - —ç—Ç–æ –≥–ª–∞–∑–∞ –∏ —É—à–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –±–µ–∑ –Ω–µ–≥–æ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–æ–π, –∏ –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.</p>
<p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.</p>
<h2 id="_399">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<p><strong>–ü–æ—á–µ–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–ø—É—Å–∫—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –∏ –ø–æ—Ç–µ—Ä–µ –¥–µ–Ω–µ–≥.</p>
<h3 id="1_35">1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<p><strong>–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞?</strong> –ü–æ—Ç–æ–º—É —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ—à–∞–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É, –∞ –≤–º–µ—Å—Ç–µ –æ–Ω–∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞.</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TradingBotMonitoringSystem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ - —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –±–æ—Ç–æ–º</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_collector</span> <span class="o">=</span> <span class="n">MetricsCollector</span><span class="p">()</span>
        <span class="c1"># –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ - –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_manager</span> <span class="o">=</span> <span class="n">AlertManager</span><span class="p">()</span>
        <span class="c1"># –î–∞—à–±–æ—Ä–¥ - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard</span> <span class="o">=</span> <span class="n">MonitoringDashboard</span><span class="p">()</span>
        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ - –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_analyzer</span> <span class="o">=</span> <span class="n">LogAnalyzer</span><span class="p">()</span>
        <span class="c1"># –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ - –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_tracker</span> <span class="o">=</span> <span class="n">PerformanceTracker</span><span class="p">()</span>
        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è - –≤—Å–µ –ª–∏ –≤ –ø–æ—Ä—è–¥–∫–µ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">health_checker</span> <span class="o">=</span> <span class="n">HealthChecker</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_collector</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_manager</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_analyzer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_tracker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">health_checker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–ø—É—â–µ–Ω–∞&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_collector</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_manager</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_analyzer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_tracker</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">health_checker</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚èπÔ∏è –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="2_32">2. –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MetricsCollector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä—â–∏–∫ –º–µ—Ç—Ä–∏–∫ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collection_interval</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># —Å–µ–∫—É–Ω–¥</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_storage</span> <span class="o">=</span> <span class="n">MetricsStorage</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_trading_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>

        <span class="n">trading_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>
            <span class="s1">&#39;total_trades&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_trades&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;winning_trades&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;winning_trades&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;losing_trades&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;losing_trades&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_win_rate</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>
            <span class="s1">&#39;profit_loss&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;profit_loss&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_drawdown&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_sharpe_ratio</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>

            <span class="c1"># –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span>
            <span class="s1">&#39;trades_per_hour&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_trades_per_hour</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>
            <span class="s1">&#39;last_trade_time&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_trade_time&#39;</span><span class="p">),</span>
            <span class="s1">&#39;active_positions&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;active_positions&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;pending_orders&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pending_orders&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –†–∏—Å–∫–∏</span>
            <span class="s1">&#39;current_exposure&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;current_exposure&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;risk_utilization&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_risk_utilization</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>
            <span class="s1">&#39;var_95&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_var_95</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>
            <span class="s1">&#39;expected_shortfall&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_expected_shortfall</span><span class="p">(</span><span class="n">bot_state</span><span class="p">),</span>

            <span class="c1"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ</span>
            <span class="s1">&#39;cpu_usage&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cpu_usage&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;memory_usage&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;memory_usage&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;disk_usage&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disk_usage&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;network_latency&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network_latency&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;api_calls_per_minute&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;api_calls_per_minute&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="n">bot_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;uptime&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_uptime</span><span class="p">(</span><span class="n">bot_state</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">trading_metrics</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_model_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ ML-–º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="n">model_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</span>
            <span class="s1">&#39;model_accuracy&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;model_precision&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;model_recall&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;model_f1_score&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f1_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;model_auc&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            <span class="s1">&#39;prediction_confidence&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prediction_confidence&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;prediction_uncertainty&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prediction_uncertainty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;last_prediction_time&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_prediction_time&#39;</span><span class="p">),</span>
            <span class="s1">&#39;predictions_per_hour&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;predictions_per_hour&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –î—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏</span>
            <span class="s1">&#39;model_drift_detected&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;drift_detected&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s1">&#39;drift_score&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;drift_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;last_retraining&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_retraining&#39;</span><span class="p">),</span>
            <span class="s1">&#39;retraining_frequency&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;retraining_frequency&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö</span>
            <span class="s1">&#39;data_quality_score&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_quality_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;missing_data_rate&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;missing_data_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;outlier_rate&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;outlier_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;data_freshness&#39;</span><span class="p">:</span> <span class="n">model_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_freshness&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">model_metrics</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_market_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">market_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–±–æ—Ä —Ä—ã–Ω–æ—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>

        <span class="n">market_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># –†—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</span>
            <span class="s1">&#39;market_volatility&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;volatility&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;market_trend&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trend&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
            <span class="s1">&#39;market_regime&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;regime&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
            <span class="s1">&#39;liquidity_score&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;liquidity_score&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –¶–µ–Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</span>
            <span class="s1">&#39;price_change_1h&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_change_1h&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;price_change_24h&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_change_24h&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;volume_24h&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;volume_24h&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;volume_change_24h&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;volume_change_24h&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</span>
            <span class="s1">&#39;rsi&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rsi&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
            <span class="s1">&#39;macd&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;macd&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s1">&#39;bollinger_position&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bollinger_position&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="s1">&#39;support_resistance_strength&#39;</span><span class="p">:</span> <span class="n">market_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;support_resistance_strength&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>

            <span class="c1"># –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">market_metrics</span>
</code></pre></div>

<h3 id="3_11">3. –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AlertManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_rules</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_cooldown</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_alert_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alert_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã</span>
            <span class="s1">&#39;critical&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;bot_down&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uptime&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">300</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
                <span class="p">},</span>
                <span class="s1">&#39;high_drawdown&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_drawdown&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">,</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ </span><span class="si">{max_drawdown:.2%}</span><span class="s1">!&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">600</span>  <span class="c1"># 10 –º–∏–Ω—É—Ç</span>
                <span class="p">},</span>
                <span class="s1">&#39;api_error_rate&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">,</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;üö® –ö–†–ò–¢–ò–ß–ù–û: –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫ API </span><span class="si">{error_rate:.2%}</span><span class="s1">!&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">300</span>
                <span class="p">}</span>
            <span class="p">},</span>

            <span class="c1"># –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</span>
            <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;low_win_rate&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;win_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.4</span><span class="p">,</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ </span><span class="si">{win_rate:.2%}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">1800</span>  <span class="c1"># 30 –º–∏–Ω—É—Ç</span>
                <span class="p">},</span>
                <span class="s1">&#39;model_drift&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model_drift_detected&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä–∏—Ñ—Ç –º–æ–¥–µ–ª–∏!&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">3600</span>  <span class="c1"># 1 —á–∞—Å</span>
                <span class="p">},</span>
                <span class="s1">&#39;high_latency&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network_latency&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">,</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏ </span><span class="si">{latency}</span><span class="s1">ms&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">900</span>  <span class="c1"># 15 –º–∏–Ω—É—Ç</span>
                <span class="p">}</span>
            <span class="p">},</span>

            <span class="c1"># –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ</span>
            <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;daily_summary&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_daily_summary_time</span><span class="p">(),</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç: P&amp;L: </span><span class="si">{profit_loss:.2f}</span><span class="s1">, –°–¥–µ–ª–∫–∏: </span><span class="si">{total_trades}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">86400</span>  <span class="c1"># 24 —á–∞—Å–∞</span>
                <span class="p">},</span>
                <span class="s1">&#39;milestone_reached&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_milestone_reached</span><span class="p">(</span><span class="n">metrics</span><span class="p">),</span>
                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;üéâ –î–û–°–¢–ò–ñ–ï–ù–ò–ï: </span><span class="si">{milestone_message}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">3600</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_alerts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">severity</span><span class="p">,</span> <span class="n">rules</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alert_rules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rule_name</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è</span>
                    <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">](</span><span class="n">metrics</span><span class="p">):</span>
                        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cooldown_active</span><span class="p">(</span><span class="n">rule_name</span><span class="p">):</span>
                            <span class="k">continue</span>

                        <span class="c1"># –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span><span class="n">rule_name</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

                        <span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">set_cooldown</span><span class="p">(</span><span class="n">rule_name</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;cooldown&#39;</span><span class="p">])</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–ª–µ—Ä—Ç–∞ </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule_name</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞&quot;&quot;&quot;</span>

        <span class="c1"># –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º</span>
        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_to_channel</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;rule&#39;</span><span class="p">:</span> <span class="n">rule_name</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="n">metrics</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_to_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–∞–Ω–∞–ª&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_email_alert</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;sms&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_sms_alert</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;telegram&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_telegram_alert</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;slack&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_slack_alert</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_telegram_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –≤ Telegram&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

        <span class="n">bot_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;TELEGRAM_BOT_TOKEN&#39;</span><span class="p">)</span>
        <span class="n">chat_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;TELEGRAM_CHAT_ID&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">bot_token</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">chat_id</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://api.telegram.org/bot</span><span class="si">{</span><span class="n">bot_token</span><span class="si">}</span><span class="s2">/sendMessage&quot;</span>

        <span class="c1"># –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è Telegram</span>
        <span class="n">formatted_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ü§ñ *–¢–æ—Ä–≥–æ–≤—ã–π –ë–æ—Ç*</span><span class="se">\n\n</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="n">formatted_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;‚è∞ –í—Ä–µ–º—è: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">formatted_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;üìä P&amp;L: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;profit_loss&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">formatted_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;üìà –°–¥–µ–ª–∫–∏: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_trades&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">formatted_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;üéØ Win Rate: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;win_rate&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;chat_id&#39;</span><span class="p">:</span> <span class="n">chat_id</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">formatted_message</span><span class="p">,</span>
            <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span> <span class="s1">&#39;Markdown&#39;</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
</code></pre></div>

<h3 id="4_5">4. –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MonitoringDashboard</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_dashboard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞&quot;&quot;&quot;</span>

        <span class="c1"># –û—Å–Ω–æ–≤–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;overview&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_overview_widget</span><span class="p">(),</span>
            <span class="s1">&#39;performance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_performance_widget</span><span class="p">(),</span>
            <span class="s1">&#39;trading_activity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_trading_activity_widget</span><span class="p">(),</span>
            <span class="s1">&#39;risk_metrics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_risk_metrics_widget</span><span class="p">(),</span>
            <span class="s1">&#39;system_health&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_system_health_widget</span><span class="p">(),</span>
            <span class="s1">&#39;model_metrics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_model_metrics_widget</span><span class="p">(),</span>
            <span class="s1">&#39;market_conditions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_market_conditions_widget</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">widgets</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_overview_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –æ–±–∑–æ—Ä–∞&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;overview&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–û–±—â–∏–π –æ–±–∑–æ—Ä&#39;</span><span class="p">,</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;P&amp;L&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;profit_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;currency&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Win Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;win_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;active_positions&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;number&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;uptime&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;duration&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–°—Ç–∞—Ç—É—Å&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;status&#39;</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_performance_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;performance&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å&#39;</span><span class="p">,</span>
            <span class="s1">&#39;charts&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;P&amp;L –≤–æ –≤—Ä–µ–º–µ–Ω–∏&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;profit_loss_history&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;x_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;y_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;profit_loss&#39;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–°–¥–µ–ª–∫–∏ –ø–æ –¥–Ω—è–º&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;trades_by_day&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;x_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;y_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;trade_count&#39;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;trade_distribution&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;–í—ã–∏–≥—Ä—ã—à–Ω—ã–µ&#39;</span><span class="p">,</span> <span class="s1">&#39;–ü—Ä–æ–∏–≥—Ä—ã—à–Ω—ã–µ&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;winning_trades&#39;</span><span class="p">,</span> <span class="s1">&#39;losing_trades&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_risk_metrics_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –º–µ—Ç—Ä–∏–∫ —Ä–∏—Å–∫–∞&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;risk_metrics&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∏—Å–∫–∞&#39;</span><span class="p">,</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;max_drawdown&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sharpe Ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;number&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;VaR 95%&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;var_95&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;currency&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–¢–µ–∫—É—â–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;current_exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;currency&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∏—Å–∫–∞&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;risk_utilization&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;charts&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü—Ä–æ—Å–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;drawdown_history&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;x_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;y_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;drawdown&#39;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_system_health_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í–∏–¥–∂–µ—Ç –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;system_health&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–ó–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã&#39;</span><span class="p">,</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CPU&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu_usage&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü–∞–º—è—Ç—å&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;memory_usage&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–î–∏—Å–∫&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;disk_usage&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–ó–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;network_latency&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;duration&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;–û—à–∏–±–∫–∏ API&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;error_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">}</span>
            <span class="p">],</span>
            <span class="s1">&#39;charts&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;gauge&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;resource_usage&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;max_value&#39;</span><span class="p">:</span> <span class="mi">100</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="5_2">5. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LogAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_patterns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_patterns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_patterns</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

        <span class="n">analysis_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_errors</span><span class="p">(</span><span class="n">log_file</span><span class="p">),</span>
            <span class="s1">&#39;performance_issues&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_performance_issues</span><span class="p">(</span><span class="n">log_file</span><span class="p">),</span>
            <span class="s1">&#39;trading_patterns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_trading_patterns</span><span class="p">(</span><span class="n">log_file</span><span class="p">),</span>
            <span class="s1">&#39;system_issues&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_system_issues</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">analysis_results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫&quot;&quot;&quot;</span>

        <span class="n">error_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;ERROR: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;EXCEPTION: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;CRITICAL: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Failed to (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Connection error: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;API error: (.+)&#39;</span>
        <span class="p">]</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">error_patterns</span><span class="p">:</span>
                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">line_num</span><span class="p">,</span>
                            <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_timestamp</span><span class="p">(</span><span class="n">line</span><span class="p">),</span>
                            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_error_severity</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                        <span class="p">})</span>

        <span class="k">return</span> <span class="n">errors</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_performance_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="n">performance_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;Slow operation: (.+) took (\d+)ms&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;High memory usage: (\d+)MB&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;CPU spike detected: (\d+)%&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Network timeout: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Database slow query: (.+)&#39;</span>
        <span class="p">]</span>

        <span class="n">performance_issues</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">performance_patterns</span><span class="p">:</span>
                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                        <span class="n">performance_issues</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">line_num</span><span class="p">,</span>
                            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_timestamp</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="p">})</span>

        <span class="k">return</span> <span class="n">performance_issues</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_trading_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ê–Ω–∞–ª–∏–∑ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤&quot;&quot;&quot;</span>

        <span class="n">trading_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;Trade executed: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Order placed: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Position opened: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Position closed: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Stop loss triggered: (.+)&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;Take profit triggered: (.+)&#39;</span>
        <span class="p">]</span>

        <span class="n">trading_events</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_num</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">trading_patterns</span><span class="p">:</span>
                    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                        <span class="n">trading_events</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">line_num</span><span class="p">,</span>
                            <span class="s1">&#39;event&#39;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_timestamp</span><span class="p">(</span><span class="n">line</span><span class="p">),</span>
                            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_trading_event</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                        <span class="p">})</span>

        <span class="k">return</span> <span class="n">trading_events</span>
</code></pre></div>

<h3 id="6_2">6. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PerformanceTracker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benchmarks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimization_suggestions</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">track_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">performance_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_performance_score</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏</span>
        <span class="n">benchmark_comparison</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_with_benchmarks</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</span>
        <span class="n">optimization_suggestions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_optimization_suggestions</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;performance_score&#39;</span><span class="p">:</span> <span class="n">performance_score</span><span class="p">,</span>
            <span class="s1">&#39;benchmark_comparison&#39;</span><span class="p">:</span> <span class="n">benchmark_comparison</span><span class="p">,</span>
            <span class="s1">&#39;optimization_suggestions&#39;</span><span class="p">:</span> <span class="n">optimization_suggestions</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_performance_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

        <span class="c1"># –í–µ—Å–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
            <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>
            <span class="s1">&#39;max_drawdown&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
            <span class="s1">&#39;profit_loss&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
            <span class="s1">&#39;trades_per_hour&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
            <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
            <span class="s1">&#39;uptime&#39;</span><span class="p">:</span> <span class="mf">0.05</span>
        <span class="p">}</span>

        <span class="c1"># –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">normalized_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

        <span class="c1"># –†–∞—Å—á–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏</span>
        <span class="n">performance_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">normalized_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">*</span> <span class="n">weight</span> 
            <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">performance_score</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_optimization_suggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="n">suggestions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ win rate</span>
        <span class="k">if</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;win_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;trading_strategy&#39;</span><span class="p">,</span>
                <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä —Ç–æ—Ä–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;analyze_losing_trades&#39;</span>
            <span class="p">})</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Å–∞–¥–∫–∏</span>
        <span class="k">if</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_drawdown&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;risk_management&#39;</span><span class="p">,</span>
                <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;–í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞. –£–ª—É—á—à–∏—Ç–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏.&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;reduce_position_sizes&#39;</span>
            <span class="p">})</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</span>
        <span class="k">if</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.02</span><span class="p">:</span>
            <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;system_stability&#39;</span><span class="p">,</span>
                <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;review_error_logs&#39;</span>
            <span class="p">})</span>

        <span class="c1"># –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</span>
        <span class="k">if</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trades_per_hour&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;trading_activity&#39;</span><span class="p">,</span>
                <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                <span class="s1">&#39;suggestion&#39;</span><span class="p">:</span> <span class="s1">&#39;–ù–∏–∑–∫–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞.&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;review_entry_conditions&#39;</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">suggestions</span>
</code></pre></div>

<h3 id="7_1">7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HealthChecker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">health_checks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">health_status</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">perform_health_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è&quot;&quot;&quot;</span>

        <span class="n">health_checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;bot_running&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_bot_running</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;api_connectivity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_api_connectivity</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;model_loaded&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_model_loaded</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;data_freshness&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data_freshness</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;memory_usage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_memory_usage</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;disk_space&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_disk_space</span><span class="p">(</span><span class="n">system_state</span><span class="p">),</span>
            <span class="s1">&#39;network_connectivity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_network_connectivity</span><span class="p">(</span><span class="n">system_state</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è</span>
        <span class="n">overall_health</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_overall_health</span><span class="p">(</span><span class="n">health_checks</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;overall_health&#39;</span><span class="p">:</span> <span class="n">overall_health</span><span class="p">,</span>
            <span class="s1">&#39;individual_checks&#39;</span><span class="p">:</span> <span class="n">health_checks</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_bot_running</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞&quot;&quot;&quot;</span>

        <span class="n">uptime</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uptime&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">last_activity</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_activity&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># –ë–æ—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—é—â–∏–º, –µ—Å–ª–∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã &gt; 0 –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å &lt; 5 –º–∏–Ω—É—Ç</span>
        <span class="n">is_running</span> <span class="o">=</span> <span class="n">uptime</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_activity</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">300</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;healthy&#39;</span> <span class="k">if</span> <span class="n">is_running</span> <span class="k">else</span> <span class="s1">&#39;unhealthy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span> <span class="k">if</span> <span class="n">is_running</span> <span class="k">else</span> <span class="s1">&#39;–ë–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span><span class="p">,</span>
            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;uptime&#39;</span><span class="p">:</span> <span class="n">uptime</span><span class="p">,</span>
                <span class="s1">&#39;last_activity&#39;</span><span class="p">:</span> <span class="n">last_activity</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_api_connectivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API&quot;&quot;&quot;</span>

        <span class="n">api_latency</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;api_latency&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">api_error_rate</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;api_error_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># API —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—ã–º, –µ—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ &lt; 1000ms –∏ –æ—à–∏–±–æ–∫ &lt; 5%</span>
        <span class="n">is_healthy</span> <span class="o">=</span> <span class="n">api_latency</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">api_error_rate</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;healthy&#39;</span> <span class="k">if</span> <span class="n">is_healthy</span> <span class="k">else</span> <span class="s1">&#39;unhealthy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ&#39;</span> <span class="k">if</span> <span class="n">is_healthy</span> <span class="k">else</span> <span class="s1">&#39;–ü—Ä–æ–±–ª–µ–º—ã —Å API&#39;</span><span class="p">,</span>
            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;latency&#39;</span><span class="p">:</span> <span class="n">api_latency</span><span class="p">,</span>
                <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="n">api_error_rate</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_model_loaded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏&quot;&quot;&quot;</span>

        <span class="n">model_loaded</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model_loaded&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">model_accuracy</span> <span class="o">=</span> <span class="n">system_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model_accuracy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># –ú–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤–æ–π, –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ç–æ—á–Ω–æ—Å—Ç—å &gt; 0.7</span>
        <span class="n">is_healthy</span> <span class="o">=</span> <span class="n">model_loaded</span> <span class="ow">and</span> <span class="n">model_accuracy</span> <span class="o">&gt;</span> <span class="mf">0.7</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;healthy&#39;</span> <span class="k">if</span> <span class="n">is_healthy</span> <span class="k">else</span> <span class="s1">&#39;unhealthy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;–ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç&#39;</span> <span class="k">if</span> <span class="n">is_healthy</span> <span class="k">else</span> <span class="s1">&#39;–ü—Ä–æ–±–ª–µ–º—ã —Å –º–æ–¥–µ–ª—å—é&#39;</span><span class="p">,</span>
            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;loaded&#39;</span><span class="p">:</span> <span class="n">model_loaded</span><span class="p">,</span>
                <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">model_accuracy</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_400">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<h3 id="1_36">1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AlertBestPractices</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_hierarchy</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">escalation_rules</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_alert_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alert_hierarchy</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;critical&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;escalation_time&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sms&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                <span class="s1">&#39;auto_actions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;restart_bot&#39;</span><span class="p">,</span> <span class="s1">&#39;close_positions&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;escalation_time&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                <span class="s1">&#39;auto_actions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;log_issue&#39;</span><span class="p">,</span> <span class="s1">&#39;notify_admin&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;info&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;escalation_time&#39;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span>  <span class="c1"># –º–∏–Ω—É—Ç</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;telegram&#39;</span><span class="p">],</span>
                <span class="s1">&#39;auto_actions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;log_event&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_escalation_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª —ç—Å–∫–∞–ª–∞—Ü–∏–∏&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">escalation_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;no_response&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s1">&#39;no_response_for_30_minutes&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;escalate_to_manager&#39;</span><span class="p">,</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;repeated_alerts&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s1">&#39;same_alert_3_times_in_1_hour&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;escalate_to_technical_lead&#39;</span><span class="p">,</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;system_down&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="s1">&#39;bot_down_for_10_minutes&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;escalate_to_emergency_contact&#39;</span><span class="p">,</span>
                <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div>

<h3 id="2_33">2. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LogRotation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression_config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retention_config</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_log_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;max_size&#39;</span><span class="p">:</span> <span class="s1">&#39;100MB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_files&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s1">&#39;rotation_time&#39;</span><span class="p">:</span> <span class="s1">&#39;daily&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;retention_days&#39;</span><span class="p">:</span> <span class="mi">30</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rotate_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">gzip</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

        <span class="c1"># –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span>
        <span class="n">backup_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">log_file</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="n">backup_file</span><span class="p">)</span>

        <span class="c1"># –°–∂–∞—Ç–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –ª–æ–≥–∞</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_config</span><span class="p">[</span><span class="s1">&#39;compression&#39;</span><span class="p">]:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">backup_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_in</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">backup_file</span><span class="si">}</span><span class="s2">.gz&quot;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_out</span><span class="p">:</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">f_in</span><span class="p">,</span> <span class="n">f_out</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">backup_file</span><span class="p">)</span>
            <span class="n">backup_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">backup_file</span><span class="si">}</span><span class="s2">.gz&quot;</span>

        <span class="c1"># –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ª–æ–≥–∞</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleanup_old_logs</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">backup_file</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cleanup_old_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

        <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="n">log_pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">log_file</span><span class="si">}</span><span class="s2">.*&quot;</span>

        <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤</span>
        <span class="n">log_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">log_pattern</span><span class="p">)</span>

        <span class="c1"># –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É</span>
        <span class="n">cutoff_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">retention_config</span><span class="p">[</span><span class="s1">&#39;retention_days&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span>
            <span class="n">file_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">file_time</span> <span class="o">&lt;</span> <span class="n">cutoff_date</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div>

<h3 id="3_12">3. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PerformanceMetrics</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_definitions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benchmarks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sla_targets</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">define_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_definitions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã&#39;</span><span class="p">,</span>
                <span class="s1">&#39;calculation&#39;</span><span class="p">:</span> <span class="s1">&#39;uptime / total_time&#39;</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="mf">0.999</span><span class="p">,</span>  <span class="c1"># 99.9%</span>
                <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞&#39;</span><span class="p">,</span>
                <span class="s1">&#39;calculation&#39;</span><span class="p">:</span> <span class="s1">&#39;average_response_time&#39;</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># 1 —Å–µ–∫—É–Ω–¥–∞</span>
                <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;milliseconds&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;–ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫&#39;</span><span class="p">,</span>
                <span class="s1">&#39;calculation&#39;</span><span class="p">:</span> <span class="s1">&#39;errors / total_requests&#39;</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>  <span class="c1"># 0.1%</span>
                <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;throughput&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å&#39;</span><span class="p">,</span>
                <span class="s1">&#39;calculation&#39;</span><span class="p">:</span> <span class="s1">&#39;requests_per_second&#39;</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># 100 RPS</span>
                <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;requests_per_second&#39;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_sla_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ SLA —Ü–µ–ª–µ–π&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sla_targets</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="mf">0.999</span><span class="p">,</span>  <span class="c1"># 99.9%</span>
            <span class="s1">&#39;response_time_p95&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>  <span class="c1"># 2 —Å–µ–∫—É–Ω–¥—ã</span>
            <span class="s1">&#39;response_time_p99&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>  <span class="c1"># 5 —Å–µ–∫—É–Ω–¥</span>
            <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>  <span class="c1"># 0.1%</span>
            <span class="s1">&#39;data_freshness&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
            <span class="s1">&#39;model_accuracy&#39;</span><span class="p">:</span> <span class="mf">0.8</span>  <span class="c1"># 80%</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_sla_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–†–∞—Å—á–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è SLA&quot;&quot;&quot;</span>

        <span class="n">compliance</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sla_targets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">current_value</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;availability&#39;</span><span class="p">,</span> <span class="s1">&#39;model_accuracy&#39;</span><span class="p">]:</span>
                <span class="c1"># –î–ª—è –º–µ—Ç—Ä–∏–∫ &quot;–±–æ–ª—å—à–µ –ª—É—á—à–µ&quot;</span>
                <span class="n">compliance</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_value</span> <span class="o">&gt;=</span> <span class="n">target</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># –î–ª—è –º–µ—Ç—Ä–∏–∫ &quot;–º–µ–Ω—å—à–µ –ª—É—á—à–µ&quot;</span>
                <span class="n">compliance</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_value</span> <span class="o">&lt;=</span> <span class="n">target</span>

        <span class="c1"># –û–±—â–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SLA</span>
        <span class="n">overall_compliance</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">compliance</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;overall_compliance&#39;</span><span class="p">:</span> <span class="n">overall_compliance</span><span class="p">,</span>
            <span class="s1">&#39;individual_compliance&#39;</span><span class="p">:</span> <span class="n">compliance</span><span class="p">,</span>
            <span class="s1">&#39;sla_score&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">compliance</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">compliance</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div>

<h2 id="_401">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h2>
<h3 id="1_37">1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AutomatedActions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_rules</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_history</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_automated_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">action_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;restart_bot&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;bot_down_for_5_minutes&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">restart_bot</span><span class="p">,</span>
                <span class="s1">&#39;max_attempts&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">300</span>  <span class="c1"># 5 –º–∏–Ω—É—Ç</span>
            <span class="p">},</span>
            <span class="s1">&#39;close_all_positions&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;max_drawdown_exceeded&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_all_positions</span><span class="p">,</span>
                <span class="s1">&#39;max_attempts&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">},</span>
            <span class="s1">&#39;reduce_position_sizes&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;high_volatility_detected&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_position_sizes</span><span class="p">,</span>
                <span class="s1">&#39;max_attempts&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">3600</span>  <span class="c1"># 1 —á–∞—Å</span>
            <span class="p">},</span>
            <span class="s1">&#39;retrain_model&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="s1">&#39;model_drift_detected&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrain_model</span><span class="p">,</span>
                <span class="s1">&#39;max_attempts&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;cooldown&#39;</span><span class="p">:</span> <span class="mi">86400</span>  <span class="c1"># 24 —á–∞—Å–∞</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute_automated_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_name</span><span class="p">,</span> <span class="n">trigger_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">action_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_rules</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_rules</span><span class="p">[</span><span class="n">action_name</span><span class="p">]</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_action_in_cooldown</span><span class="p">(</span><span class="n">action_name</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_action_attempts</span><span class="p">(</span><span class="n">action_name</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;max_attempts&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">](</span><span class="n">trigger_data</span><span class="p">)</span>

            <span class="c1"># –ó–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">action_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">action_name</span><span class="p">,</span>
                <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="n">trigger_data</span><span class="p">,</span>
                <span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="p">})</span>

            <span class="c1"># –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_action_cooldown</span><span class="p">(</span><span class="n">action_name</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;cooldown&#39;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è </span><span class="si">{</span><span class="n">action_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">restart_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_bot</span><span class="p">()</span>

            <span class="c1"># –û–∂–∏–¥–∞–Ω–∏–µ</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

            <span class="c1"># –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_bot</span><span class="p">()</span>

            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω&#39;</span><span class="p">}</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close_all_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π</span>
            <span class="n">active_positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_active_positions</span><span class="p">()</span>

            <span class="c1"># –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π</span>
            <span class="n">closed_positions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">active_positions</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_position</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                    <span class="n">closed_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> 
                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;–ó–∞–∫—Ä—ã—Ç–æ –ø–æ–∑–∏—Ü–∏–π: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">closed_positions</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;closed_positions&#39;</span><span class="p">:</span> <span class="n">closed_positions</span>
            <span class="p">}</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</code></pre></div>

<h3 id="2_34">2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ExternalIntegrations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integrations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">webhook_endpoints</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_integrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">integrations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;prometheus&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_prometheus_integration</span><span class="p">(),</span>
            <span class="s1">&#39;grafana&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_grafana_integration</span><span class="p">(),</span>
            <span class="s1">&#39;datadog&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_datadog_integration</span><span class="p">(),</span>
            <span class="s1">&#39;new_relic&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_new_relic_integration</span><span class="p">(),</span>
            <span class="s1">&#39;webhooks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_webhook_integration</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_prometheus_integration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">start_http_server</span>

        <span class="c1"># –ú–µ—Ç—Ä–∏–∫–∏</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prometheus_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;trades_total&#39;</span><span class="p">:</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;trading_bot_trades_total&#39;</span><span class="p">,</span> <span class="s1">&#39;Total number of trades&#39;</span><span class="p">),</span>
            <span class="s1">&#39;profit_loss&#39;</span><span class="p">:</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;trading_bot_profit_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Current profit/loss&#39;</span><span class="p">),</span>
            <span class="s1">&#39;win_rate&#39;</span><span class="p">:</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;trading_bot_win_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Current win rate&#39;</span><span class="p">),</span>
            <span class="s1">&#39;response_time&#39;</span><span class="p">:</span> <span class="n">Histogram</span><span class="p">(</span><span class="s1">&#39;trading_bot_response_time&#39;</span><span class="p">,</span> <span class="s1">&#39;Response time&#39;</span><span class="p">),</span>
            <span class="s1">&#39;error_rate&#39;</span><span class="p">:</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;trading_bot_error_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Current error rate&#39;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –º–µ—Ç—Ä–∏–∫</span>
        <span class="n">start_http_server</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_grafana_integration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana&quot;&quot;&quot;</span>

        <span class="c1"># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ Grafana</span>
        <span class="n">grafana_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;datasource&#39;</span><span class="p">:</span> <span class="s1">&#39;prometheus&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dashboard_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://grafana:3000/d/trading-bot&#39;</span><span class="p">,</span>
            <span class="s1">&#39;panels&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Trading Performance&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;graph&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;targets&#39;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s1">&#39;trading_bot_profit_loss&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;trading_bot_win_rate&#39;</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;System Health&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;singlestat&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;targets&#39;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s1">&#39;trading_bot_error_rate&#39;</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">grafana_config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_webhook_integration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å webhooks&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">webhook_endpoints</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;trading_events&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.example.com/webhooks/trading&#39;</span><span class="p">,</span>
            <span class="s1">&#39;system_alerts&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.example.com/webhooks/alerts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;performance_reports&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.example.com/webhooks/performance&#39;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_webhook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;–û—Ç–ø—Ä–∞–≤–∫–∞ webhook&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

        <span class="k">if</span> <span class="n">endpoint</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">webhook_endpoints</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">webhook_endpoints</span><span class="p">[</span><span class="n">endpoint</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ webhook: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>

<h2 id="_402">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</h2>
<p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –ø—Ä–∏–±—ã–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –°–ª–µ–¥—É—è –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ, –≤—ã —Å–º–æ–∂–µ—Ç–µ:</p>
<ol>
<li><strong>–ë—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</strong> - —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º—ã –∞–ª–µ—Ä—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–¥–æ—Ä–æ–≤—å—è</li>
<li><strong>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong> - —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</li>
<li><strong>–û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É</strong> - —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</li>
<li><strong>–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏</strong> - –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞</li>
</ol>
<p>–ü–æ–º–Ω–∏—Ç–µ: —Ö–æ—Ä–æ—à–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - —ç—Ç–æ –∑–∞–ª–æ–≥ —É—Å–ø–µ—à–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã! üöÄ</p>
    </div>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Prism.js –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è
        if (typeof Prism !== 'undefined') {
            Prism.highlightAll();
        }
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –±–ª–æ–∫–∏ –∫–æ–¥–∞ –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —É–ª—É—á—à–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            const codeBlocks = document.querySelectorAll('pre code');
            codeBlocks.forEach(block => {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –ø–æ –∫–ª–∞—Å—Å—É –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
                if (block.className.includes('python') || 
                    block.textContent.includes('import ') || 
                    block.textContent.includes('def ') ||
                    block.textContent.includes('class ')) {
                    block.parentElement.classList.add('python-code');
                }
            });
        });
    </script>
</body>
</html>